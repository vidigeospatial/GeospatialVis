function Q8(t,e){for(var n=0;n<e.length;n++){const i=e[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in t)){const o=Object.getOwnPropertyDescriptor(i,r);o&&Object.defineProperty(t,r,o.get?o:{enumerable:!0,get:()=>i[r]})}}}return Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();function r2(t,e){const n=Object.create(null),i=t.split(",");for(let r=0;r<i.length;r++)n[i[r]]=!0;return e?r=>!!n[r.toLowerCase()]:r=>!!n[r]}const _r={},am=[],Tl=()=>{},BH=()=>!1,zH=/^on[^a-z]/,t_=t=>zH.test(t),xI=t=>t.startsWith("onUpdate:"),Hr=Object.assign,wI=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},NH=Object.prototype.hasOwnProperty,Gi=(t,e)=>NH.call(t,e),Dn=Array.isArray,lm=t=>Ym(t)==="[object Map]",vf=t=>Ym(t)==="[object Set]",VO=t=>Ym(t)==="[object Date]",UH=t=>Ym(t)==="[object RegExp]",pi=t=>typeof t=="function",Wr=t=>typeof t=="string",H0=t=>typeof t=="symbol",br=t=>t!==null&&typeof t=="object",EI=t=>(br(t)||pi(t))&&pi(t.then)&&pi(t.catch),eB=Object.prototype.toString,Ym=t=>eB.call(t),VH=t=>Ym(t).slice(8,-1),tB=t=>Ym(t)==="[object Object]",TI=t=>Wr(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,v0=r2(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),o2=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},jH=/-(\w)/g,qs=o2(t=>t.replace(jH,(e,n)=>n?n.toUpperCase():"")),$H=/\B([A-Z])/g,ja=o2(t=>t.replace($H,"-$1").toLowerCase()),n_=o2(t=>t.charAt(0).toUpperCase()+t.slice(1)),_0=o2(t=>t?`on${n_(t)}`:""),Ah=(t,e)=>!Object.is(t,e),cm=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},Zx=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},qx=t=>{const e=parseFloat(t);return isNaN(e)?t:e},Yx=t=>{const e=Wr(t)?Number(t):NaN;return isNaN(e)?t:e};let jO;const KC=()=>jO||(jO=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),GH="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,console",HH=r2(GH);function tf(t){if(Dn(t)){const e={};for(let n=0;n<t.length;n++){const i=t[n],r=Wr(i)?ZH(i):tf(i);if(r)for(const o in r)e[o]=r[o]}return e}else if(Wr(t)||br(t))return t}const WH=/;(?![^(]*\))/g,KH=/:([^]+)/,XH=/\/\*[^]*?\*\//g;function ZH(t){const e={};return t.replace(XH,"").split(WH).forEach(n=>{if(n){const i=n.split(KH);i.length>1&&(e[i[0].trim()]=i[1].trim())}}),e}function ri(t){let e="";if(Wr(t))e=t;else if(Dn(t))for(let n=0;n<t.length;n++){const i=ri(t[n]);i&&(e+=i+" ")}else if(br(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}function um(t){if(!t)return null;let{class:e,style:n}=t;return e&&!Wr(e)&&(t.class=ri(e)),n&&(t.style=tf(n)),t}const qH="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",YH=r2(qH);function nB(t){return!!t||t===""}function JH(t,e){if(t.length!==e.length)return!1;let n=!0;for(let i=0;n&&i<t.length;i++)n=Ph(t[i],e[i]);return n}function Ph(t,e){if(t===e)return!0;let n=VO(t),i=VO(e);if(n||i)return n&&i?t.getTime()===e.getTime():!1;if(n=H0(t),i=H0(e),n||i)return t===e;if(n=Dn(t),i=Dn(e),n||i)return n&&i?JH(t,e):!1;if(n=br(t),i=br(e),n||i){if(!n||!i)return!1;const r=Object.keys(t).length,o=Object.keys(e).length;if(r!==o)return!1;for(const l in t){const s=t.hasOwnProperty(l),d=e.hasOwnProperty(l);if(s&&!d||!s&&d||!Ph(t[l],e[l]))return!1}}return String(t)===String(e)}function s2(t,e){return t.findIndex(n=>Ph(n,e))}const ki=t=>Wr(t)?t:t==null?"":Dn(t)||br(t)&&(t.toString===eB||!pi(t.toString))?JSON.stringify(t,iB,2):String(t),iB=(t,e)=>e&&e.__v_isRef?iB(t,e.value):lm(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[i,r])=>(n[`${i} =>`]=r,n),{})}:vf(e)?{[`Set(${e.size})`]:[...e.values()]}:br(e)&&!Dn(e)&&!tB(e)?String(e):e;let ga;class SI{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=ga,!e&&ga&&(this.index=(ga.scopes||(ga.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const n=ga;try{return ga=this,e()}finally{ga=n}}}on(){ga=this}off(){ga=this.parent}stop(e){if(this._active){let n,i;for(n=0,i=this.effects.length;n<i;n++)this.effects[n].stop();for(n=0,i=this.cleanups.length;n<i;n++)this.cleanups[n]();if(this.scopes)for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0,this._active=!1}}}function CI(t){return new SI(t)}function rB(t,e=ga){e&&e.active&&e.effects.push(t)}function AI(){return ga}function oB(t){ga&&ga.cleanups.push(t)}const PI=t=>{const e=new Set(t);return e.w=0,e.n=0,e},sB=t=>(t.w&Ih)>0,aB=t=>(t.n&Ih)>0,QH=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=Ih},eW=t=>{const{deps:e}=t;if(e.length){let n=0;for(let i=0;i<e.length;i++){const r=e[i];sB(r)&&!aB(r)?r.delete(t):e[n++]=r,r.w&=~Ih,r.n&=~Ih}e.length=n}},Jx=new WeakMap;let Jy=0,Ih=1;const XC=30;let vl;const Xd=Symbol(""),ZC=Symbol("");class Cm{constructor(e,n=null,i){this.fn=e,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,rB(this,i)}run(){if(!this.active)return this.fn();let e=vl,n=wh;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=vl,vl=this,wh=!0,Ih=1<<++Jy,Jy<=XC?QH(this):$O(this),this.fn()}finally{Jy<=XC&&eW(this),Ih=1<<--Jy,vl=this.parent,wh=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){vl===this?this.deferStop=!0:this.active&&($O(this),this.onStop&&this.onStop(),this.active=!1)}}function $O(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}function tW(t,e){t.effect instanceof Cm&&(t=t.effect.fn);const n=new Cm(t);e&&(Hr(n,e),e.scope&&rB(n,e.scope)),(!e||!e.lazy)&&n.run();const i=n.run.bind(n);return i.effect=n,i}function nW(t){t.effect.stop()}let wh=!0;const lB=[];function Jm(){lB.push(wh),wh=!1}function Qm(){const t=lB.pop();wh=t===void 0?!0:t}function Qs(t,e,n){if(wh&&vl){let i=Jx.get(t);i||Jx.set(t,i=new Map);let r=i.get(n);r||i.set(n,r=PI()),cB(r)}}function cB(t,e){let n=!1;Jy<=XC?aB(t)||(t.n|=Ih,n=!sB(t)):n=!t.has(vl),n&&(t.add(vl),vl.deps.push(t))}function Kc(t,e,n,i,r,o){const l=Jx.get(t);if(!l)return;let s=[];if(e==="clear")s=[...l.values()];else if(n==="length"&&Dn(t)){const d=Number(i);l.forEach((p,y)=>{(y==="length"||y>=d)&&s.push(p)})}else switch(n!==void 0&&s.push(l.get(n)),e){case"add":Dn(t)?TI(n)&&s.push(l.get("length")):(s.push(l.get(Xd)),lm(t)&&s.push(l.get(ZC)));break;case"delete":Dn(t)||(s.push(l.get(Xd)),lm(t)&&s.push(l.get(ZC)));break;case"set":lm(t)&&s.push(l.get(Xd));break}if(s.length===1)s[0]&&qC(s[0]);else{const d=[];for(const p of s)p&&d.push(...p);qC(PI(d))}}function qC(t,e){const n=Dn(t)?t:[...t];for(const i of n)i.computed&&GO(i);for(const i of n)i.computed||GO(i)}function GO(t,e){(t!==vl||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}function iW(t,e){var n;return(n=Jx.get(t))==null?void 0:n.get(e)}const rW=r2("__proto__,__v_isRef,__isVue"),uB=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(H0)),HO=oW();function oW(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const i=zi(this);for(let o=0,l=this.length;o<l;o++)Qs(i,"get",o+"");const r=i[e](...n);return r===-1||r===!1?i[e](...n.map(zi)):r}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){Jm();const i=zi(this)[e].apply(this,n);return Qm(),i}}),t}function sW(t){const e=zi(this);return Qs(e,"has",t),e.hasOwnProperty(t)}class hB{constructor(e=!1,n=!1){this._isReadonly=e,this._shallow=n}get(e,n,i){const r=this._isReadonly,o=this._shallow;if(n==="__v_isReactive")return!r;if(n==="__v_isReadonly")return r;if(n==="__v_isShallow")return o;if(n==="__v_raw"&&i===(r?o?yB:gB:o?mB:pB).get(e))return e;const l=Dn(e);if(!r){if(l&&Gi(HO,n))return Reflect.get(HO,n,i);if(n==="hasOwnProperty")return sW}const s=Reflect.get(e,n,i);return(H0(n)?uB.has(n):rW(n))||(r||Qs(e,"get",n),o)?s:Rr(s)?l&&TI(n)?s:s.value:br(s)?r?c2(s):Ao(s):s}}class dB extends hB{constructor(e=!1){super(!1,e)}set(e,n,i,r){let o=e[n];if(nf(o)&&Rr(o)&&!Rr(i))return!1;if(!this._shallow&&(!W0(i)&&!nf(i)&&(o=zi(o),i=zi(i)),!Dn(e)&&Rr(o)&&!Rr(i)))return o.value=i,!0;const l=Dn(e)&&TI(n)?Number(n)<e.length:Gi(e,n),s=Reflect.set(e,n,i,r);return e===zi(r)&&(l?Ah(i,o)&&Kc(e,"set",n,i):Kc(e,"add",n,i)),s}deleteProperty(e,n){const i=Gi(e,n);e[n];const r=Reflect.deleteProperty(e,n);return r&&i&&Kc(e,"delete",n,void 0),r}has(e,n){const i=Reflect.has(e,n);return(!H0(n)||!uB.has(n))&&Qs(e,"has",n),i}ownKeys(e){return Qs(e,"iterate",Dn(e)?"length":Xd),Reflect.ownKeys(e)}}class fB extends hB{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const aW=new dB,lW=new fB,cW=new dB(!0),uW=new fB(!0),II=t=>t,a2=t=>Reflect.getPrototypeOf(t);function nb(t,e,n=!1,i=!1){t=t.__v_raw;const r=zi(t),o=zi(e);n||(Ah(e,o)&&Qs(r,"get",e),Qs(r,"get",o));const{has:l}=a2(r),s=i?II:n?LI:K0;if(l.call(r,e))return s(t.get(e));if(l.call(r,o))return s(t.get(o));t!==r&&t.get(e)}function ib(t,e=!1){const n=this.__v_raw,i=zi(n),r=zi(t);return e||(Ah(t,r)&&Qs(i,"has",t),Qs(i,"has",r)),t===r?n.has(t):n.has(t)||n.has(r)}function rb(t,e=!1){return t=t.__v_raw,!e&&Qs(zi(t),"iterate",Xd),Reflect.get(t,"size",t)}function WO(t){t=zi(t);const e=zi(this);return a2(e).has.call(e,t)||(e.add(t),Kc(e,"add",t,t)),this}function KO(t,e){e=zi(e);const n=zi(this),{has:i,get:r}=a2(n);let o=i.call(n,t);o||(t=zi(t),o=i.call(n,t));const l=r.call(n,t);return n.set(t,e),o?Ah(e,l)&&Kc(n,"set",t,e):Kc(n,"add",t,e),this}function XO(t){const e=zi(this),{has:n,get:i}=a2(e);let r=n.call(e,t);r||(t=zi(t),r=n.call(e,t)),i&&i.call(e,t);const o=e.delete(t);return r&&Kc(e,"delete",t,void 0),o}function ZO(){const t=zi(this),e=t.size!==0,n=t.clear();return e&&Kc(t,"clear",void 0,void 0),n}function ob(t,e){return function(i,r){const o=this,l=o.__v_raw,s=zi(l),d=e?II:t?LI:K0;return!t&&Qs(s,"iterate",Xd),l.forEach((p,y)=>i.call(r,d(p),d(y),o))}}function sb(t,e,n){return function(...i){const r=this.__v_raw,o=zi(r),l=lm(o),s=t==="entries"||t===Symbol.iterator&&l,d=t==="keys"&&l,p=r[t](...i),y=n?II:e?LI:K0;return!e&&Qs(o,"iterate",d?ZC:Xd),{next(){const{value:v,done:w}=p.next();return w?{value:v,done:w}:{value:s?[y(v[0]),y(v[1])]:y(v),done:w}},[Symbol.iterator](){return this}}}}function Xu(t){return function(...e){return t==="delete"?!1:this}}function hW(){const t={get(o){return nb(this,o)},get size(){return rb(this)},has:ib,add:WO,set:KO,delete:XO,clear:ZO,forEach:ob(!1,!1)},e={get(o){return nb(this,o,!1,!0)},get size(){return rb(this)},has:ib,add:WO,set:KO,delete:XO,clear:ZO,forEach:ob(!1,!0)},n={get(o){return nb(this,o,!0)},get size(){return rb(this,!0)},has(o){return ib.call(this,o,!0)},add:Xu("add"),set:Xu("set"),delete:Xu("delete"),clear:Xu("clear"),forEach:ob(!0,!1)},i={get(o){return nb(this,o,!0,!0)},get size(){return rb(this,!0)},has(o){return ib.call(this,o,!0)},add:Xu("add"),set:Xu("set"),delete:Xu("delete"),clear:Xu("clear"),forEach:ob(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(o=>{t[o]=sb(o,!1,!1),n[o]=sb(o,!0,!1),e[o]=sb(o,!1,!0),i[o]=sb(o,!0,!0)}),[t,n,e,i]}const[dW,fW,pW,mW]=hW();function l2(t,e){const n=e?t?mW:pW:t?fW:dW;return(i,r,o)=>r==="__v_isReactive"?!t:r==="__v_isReadonly"?t:r==="__v_raw"?i:Reflect.get(Gi(n,r)&&r in i?n:i,r,o)}const gW={get:l2(!1,!1)},yW={get:l2(!1,!0)},vW={get:l2(!0,!1)},_W={get:l2(!0,!0)},pB=new WeakMap,mB=new WeakMap,gB=new WeakMap,yB=new WeakMap;function bW(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function xW(t){return t.__v_skip||!Object.isExtensible(t)?0:bW(VH(t))}function Ao(t){return nf(t)?t:u2(t,!1,aW,gW,pB)}function MI(t){return u2(t,!1,cW,yW,mB)}function c2(t){return u2(t,!0,lW,vW,gB)}function wW(t){return u2(t,!0,uW,_W,yB)}function u2(t,e,n,i,r){if(!br(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const o=r.get(t);if(o)return o;const l=xW(t);if(l===0)return t;const s=new Proxy(t,l===2?i:n);return r.set(t,s),s}function Xc(t){return nf(t)?Xc(t.__v_raw):!!(t&&t.__v_isReactive)}function nf(t){return!!(t&&t.__v_isReadonly)}function W0(t){return!!(t&&t.__v_isShallow)}function RI(t){return Xc(t)||nf(t)}function zi(t){const e=t&&t.__v_raw;return e?zi(e):t}function i_(t){return Zx(t,"__v_skip",!0),t}const K0=t=>br(t)?Ao(t):t,LI=t=>br(t)?c2(t):t;function OI(t){wh&&vl&&(t=zi(t),cB(t.dep||(t.dep=PI())))}function h2(t,e){t=zi(t);const n=t.dep;n&&qC(n)}function Rr(t){return!!(t&&t.__v_isRef===!0)}function $n(t){return _B(t,!1)}function vB(t){return _B(t,!0)}function _B(t,e){return Rr(t)?t:new EW(t,e)}class EW{constructor(e,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?e:zi(e),this._value=n?e:K0(e)}get value(){return OI(this),this._value}set value(e){const n=this.__v_isShallow||W0(e)||nf(e);e=n?e:zi(e),Ah(e,this._rawValue)&&(this._rawValue=e,this._value=n?e:K0(e),h2(this))}}function TW(t){h2(t)}function Yt(t){return Rr(t)?t.value:t}function SW(t){return pi(t)?t():Yt(t)}const CW={get:(t,e,n)=>Yt(Reflect.get(t,e,n)),set:(t,e,n,i)=>{const r=t[e];return Rr(r)&&!Rr(n)?(r.value=n,!0):Reflect.set(t,e,n,i)}};function DI(t){return Xc(t)?t:new Proxy(t,CW)}class AW{constructor(e){this.dep=void 0,this.__v_isRef=!0;const{get:n,set:i}=e(()=>OI(this),()=>h2(this));this._get=n,this._set=i}get value(){return this._get()}set value(e){this._set(e)}}function PW(t){return new AW(t)}function Wp(t){const e=Dn(t)?new Array(t.length):{};for(const n in t)e[n]=bB(t,n);return e}class IW{constructor(e,n,i){this._object=e,this._key=n,this._defaultValue=i,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return iW(zi(this._object),this._key)}}class MW{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function RW(t,e,n){return Rr(t)?t:pi(t)?new MW(t):br(t)&&arguments.length>1?bB(t,e,n):$n(t)}function bB(t,e,n){const i=t[e];return Rr(i)?i:new IW(t,e,n)}class LW{constructor(e,n,i,r){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new Cm(e,()=>{this._dirty||(this._dirty=!0,h2(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!r,this.__v_isReadonly=i}get value(){const e=zi(this);return OI(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function OW(t,e,n=!1){let i,r;const o=pi(t);return o?(i=t,r=Tl):(i=t.get,r=t.set),new LW(i,r,o||!r,n)}function DW(t,...e){}function kW(t,e){}function Zc(t,e,n,i){let r;try{r=i?t(...i):t()}catch(o){_f(o,e,n)}return r}function Ta(t,e,n,i){if(pi(t)){const o=Zc(t,e,n,i);return o&&EI(o)&&o.catch(l=>{_f(l,e,n)}),o}const r=[];for(let o=0;o<t.length;o++)r.push(Ta(t[o],e,n,i));return r}function _f(t,e,n,i=!0){const r=e?e.vnode:null;if(e){let o=e.parent;const l=e.proxy,s=n;for(;o;){const p=o.ec;if(p){for(let y=0;y<p.length;y++)if(p[y](t,l,s)===!1)return}o=o.parent}const d=e.appContext.config.errorHandler;if(d){Zc(d,null,10,[t,l,s]);return}}FW(t,n,r,i)}function FW(t,e,n,i=!0){console.error(t)}let X0=!1,YC=!1;const ys=[];let ec=0;const hm=[];let zc=null,Nd=0;const xB=Promise.resolve();let kI=null;function Ys(t){const e=kI||xB;return t?e.then(this?t.bind(this):t):e}function BW(t){let e=ec+1,n=ys.length;for(;e<n;){const i=e+n>>>1;Z0(ys[i])<t?e=i+1:n=i}return e}function d2(t){(!ys.length||!ys.includes(t,X0&&t.allowRecurse?ec+1:ec))&&(t.id==null?ys.push(t):ys.splice(BW(t.id),0,t),wB())}function wB(){!X0&&!YC&&(YC=!0,kI=xB.then(EB))}function zW(t){const e=ys.indexOf(t);e>ec&&ys.splice(e,1)}function FI(t){Dn(t)?hm.push(...t):(!zc||!zc.includes(t,t.allowRecurse?Nd+1:Nd))&&hm.push(t),wB()}function qO(t,e=X0?ec+1:0){for(;e<ys.length;e++){const n=ys[e];n&&n.pre&&(ys.splice(e,1),e--,n())}}function Qx(t){if(hm.length){const e=[...new Set(hm)];if(hm.length=0,zc){zc.push(...e);return}for(zc=e,zc.sort((n,i)=>Z0(n)-Z0(i)),Nd=0;Nd<zc.length;Nd++)zc[Nd]();zc=null,Nd=0}}const Z0=t=>t.id==null?1/0:t.id,NW=(t,e)=>{const n=Z0(t)-Z0(e);if(n===0){if(t.pre&&!e.pre)return-1;if(e.pre&&!t.pre)return 1}return n};function EB(t){YC=!1,X0=!0,ys.sort(NW);const e=Tl;try{for(ec=0;ec<ys.length;ec++){const n=ys[ec];n&&n.active!==!1&&Zc(n,null,14)}}finally{ec=0,ys.length=0,Qx(),X0=!1,kI=null,(ys.length||hm.length)&&EB()}}let jp,ab=[];function TB(t,e){var n,i;jp=t,jp?(jp.enabled=!0,ab.forEach(({event:r,args:o})=>jp.emit(r,...o)),ab=[]):typeof window<"u"&&window.HTMLElement&&!((i=(n=window.navigator)==null?void 0:n.userAgent)!=null&&i.includes("jsdom"))?((e.__VUE_DEVTOOLS_HOOK_REPLAY__=e.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(o=>{TB(o,e)}),setTimeout(()=>{jp||(e.__VUE_DEVTOOLS_HOOK_REPLAY__=null,ab=[])},3e3)):ab=[]}function UW(t,e,...n){if(t.isUnmounted)return;const i=t.vnode.props||_r;let r=n;const o=e.startsWith("update:"),l=o&&e.slice(7);if(l&&l in i){const y=`${l==="modelValue"?"model":l}Modifiers`,{number:v,trim:w}=i[y]||_r;w&&(r=n.map(T=>Wr(T)?T.trim():T)),v&&(r=n.map(qx))}let s,d=i[s=_0(e)]||i[s=_0(qs(e))];!d&&o&&(d=i[s=_0(ja(e))]),d&&Ta(d,t,6,r);const p=i[s+"Once"];if(p){if(!t.emitted)t.emitted={};else if(t.emitted[s])return;t.emitted[s]=!0,Ta(p,t,6,r)}}function SB(t,e,n=!1){const i=e.emitsCache,r=i.get(t);if(r!==void 0)return r;const o=t.emits;let l={},s=!1;if(!pi(t)){const d=p=>{const y=SB(p,e,!0);y&&(s=!0,Hr(l,y))};!n&&e.mixins.length&&e.mixins.forEach(d),t.extends&&d(t.extends),t.mixins&&t.mixins.forEach(d)}return!o&&!s?(br(t)&&i.set(t,null),null):(Dn(o)?o.forEach(d=>l[d]=null):Hr(l,o),br(t)&&i.set(t,l),l)}function f2(t,e){return!t||!t_(e)?!1:(e=e.slice(2).replace(/Once$/,""),Gi(t,e[0].toLowerCase()+e.slice(1))||Gi(t,ja(e))||Gi(t,e))}let Ho=null,p2=null;function q0(t){const e=Ho;return Ho=t,p2=t&&t.type.__scopeId||null,e}function lu(t){p2=t}function cu(){p2=null}const VW=t=>Cn;function Cn(t,e=Ho,n){if(!e||t._n)return t;const i=(...r)=>{i._d&&rA(-1);const o=q0(e);let l;try{l=t(...r)}finally{q0(o),i._d&&rA(1)}return l};return i._n=!0,i._c=!0,i._d=!0,i}function mx(t){const{type:e,vnode:n,proxy:i,withProxy:r,props:o,propsOptions:[l],slots:s,attrs:d,emit:p,render:y,renderCache:v,data:w,setupState:T,ctx:I,inheritAttrs:L}=t;let k,F;const B=q0(t);try{if(n.shapeFlag&4){const U=r||i;k=_a(y.call(U,U,v,o,T,w,I)),F=d}else{const U=e;k=_a(U.length>1?U(o,{attrs:d,slots:s,emit:p}):U(o,null)),F=e.props?d:$W(d)}}catch(U){w0.length=0,_f(U,t,1),k=Lt(xs)}let G=k;if(F&&L!==!1){const U=Object.keys(F),{shapeFlag:ee}=G;U.length&&ee&7&&(l&&U.some(xI)&&(F=GW(F,l)),G=hc(G,F))}return n.dirs&&(G=hc(G),G.dirs=G.dirs?G.dirs.concat(n.dirs):n.dirs),n.transition&&(G.transition=n.transition),k=G,q0(B),k}function jW(t){let e;for(let n=0;n<t.length;n++){const i=t[n];if(Mh(i)){if(i.type!==xs||i.children==="v-if"){if(e)return;e=i}}else return}return e}const $W=t=>{let e;for(const n in t)(n==="class"||n==="style"||t_(n))&&((e||(e={}))[n]=t[n]);return e},GW=(t,e)=>{const n={};for(const i in t)(!xI(i)||!(i.slice(9)in e))&&(n[i]=t[i]);return n};function HW(t,e,n){const{props:i,children:r,component:o}=t,{props:l,children:s,patchFlag:d}=e,p=o.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&d>=0){if(d&1024)return!0;if(d&16)return i?YO(i,l,p):!!l;if(d&8){const y=e.dynamicProps;for(let v=0;v<y.length;v++){const w=y[v];if(l[w]!==i[w]&&!f2(p,w))return!0}}}else return(r||s)&&(!s||!s.$stable)?!0:i===l?!1:i?l?YO(i,l,p):!0:!!l;return!1}function YO(t,e,n){const i=Object.keys(e);if(i.length!==Object.keys(t).length)return!0;for(let r=0;r<i.length;r++){const o=i[r];if(e[o]!==t[o]&&!f2(n,o))return!0}return!1}function BI({vnode:t,parent:e},n){for(;e&&e.subTree===t;)(t=e.vnode).el=n,e=e.parent}const CB=t=>t.__isSuspense,WW={name:"Suspense",__isSuspense:!0,process(t,e,n,i,r,o,l,s,d,p){t==null?XW(e,n,i,r,o,l,s,d,p):ZW(t,e,n,i,r,l,s,d,p)},hydrate:qW,create:zI,normalize:YW},KW=WW;function Y0(t,e){const n=t.props&&t.props[e];pi(n)&&n()}function XW(t,e,n,i,r,o,l,s,d){const{p,o:{createElement:y}}=d,v=y("div"),w=t.suspense=zI(t,r,i,e,v,n,o,l,s,d);p(null,w.pendingBranch=t.ssContent,v,null,i,w,o,l),w.deps>0?(Y0(t,"onPending"),Y0(t,"onFallback"),p(null,t.ssFallback,e,n,i,null,o,l),dm(w,t.ssFallback)):w.resolve(!1,!0)}function ZW(t,e,n,i,r,o,l,s,{p:d,um:p,o:{createElement:y}}){const v=e.suspense=t.suspense;v.vnode=e,e.el=t.el;const w=e.ssContent,T=e.ssFallback,{activeBranch:I,pendingBranch:L,isInFallback:k,isHydrating:F}=v;if(L)v.pendingBranch=w,_l(w,L)?(d(L,w,v.hiddenContainer,null,r,v,o,l,s),v.deps<=0?v.resolve():k&&(d(I,T,n,i,r,null,o,l,s),dm(v,T))):(v.pendingId++,F?(v.isHydrating=!1,v.activeBranch=L):p(L,r,v),v.deps=0,v.effects.length=0,v.hiddenContainer=y("div"),k?(d(null,w,v.hiddenContainer,null,r,v,o,l,s),v.deps<=0?v.resolve():(d(I,T,n,i,r,null,o,l,s),dm(v,T))):I&&_l(w,I)?(d(I,w,n,i,r,v,o,l,s),v.resolve(!0)):(d(null,w,v.hiddenContainer,null,r,v,o,l,s),v.deps<=0&&v.resolve()));else if(I&&_l(w,I))d(I,w,n,i,r,v,o,l,s),dm(v,w);else if(Y0(e,"onPending"),v.pendingBranch=w,v.pendingId++,d(null,w,v.hiddenContainer,null,r,v,o,l,s),v.deps<=0)v.resolve();else{const{timeout:B,pendingId:G}=v;B>0?setTimeout(()=>{v.pendingId===G&&v.fallback(T)},B):B===0&&v.fallback(T)}}function zI(t,e,n,i,r,o,l,s,d,p,y=!1){const{p:v,m:w,um:T,n:I,o:{parentNode:L,remove:k}}=p;let F;const B=JW(t);B&&e!=null&&e.pendingBranch&&(F=e.pendingId,e.deps++);const G=t.props?Yx(t.props.timeout):void 0,U={vnode:t,parent:e,parentComponent:n,isSVG:l,container:i,hiddenContainer:r,anchor:o,deps:0,pendingId:0,timeout:typeof G=="number"?G:-1,activeBranch:null,pendingBranch:null,isInFallback:!0,isHydrating:y,isUnmounted:!1,effects:[],resolve(ee=!1,ne=!1){const{vnode:ye,activeBranch:fe,pendingBranch:J,pendingId:Ce,effects:me,parentComponent:be,container:Te}=U;if(U.isHydrating)U.isHydrating=!1;else if(!ee){const et=fe&&J.transition&&J.transition.mode==="out-in";et&&(fe.transition.afterLeave=()=>{Ce===U.pendingId&&w(J,Te,Et,0)});let{anchor:Et}=U;fe&&(Et=I(fe),T(fe,be,U,!0)),et||w(J,Te,Et,0)}dm(U,J),U.pendingBranch=null,U.isInFallback=!1;let ke=U.parent,ut=!1;for(;ke;){if(ke.pendingBranch){ke.effects.push(...me),ut=!0;break}ke=ke.parent}ut||FI(me),U.effects=[],B&&e&&e.pendingBranch&&F===e.pendingId&&(e.deps--,e.deps===0&&!ne&&e.resolve()),Y0(ye,"onResolve")},fallback(ee){if(!U.pendingBranch)return;const{vnode:ne,activeBranch:ye,parentComponent:fe,container:J,isSVG:Ce}=U;Y0(ne,"onFallback");const me=I(ye),be=()=>{U.isInFallback&&(v(null,ee,J,me,fe,null,Ce,s,d),dm(U,ee))},Te=ee.transition&&ee.transition.mode==="out-in";Te&&(ye.transition.afterLeave=be),U.isInFallback=!0,T(ye,fe,null,!0),Te||be()},move(ee,ne,ye){U.activeBranch&&w(U.activeBranch,ee,ne,ye),U.container=ee},next(){return U.activeBranch&&I(U.activeBranch)},registerDep(ee,ne){const ye=!!U.pendingBranch;ye&&U.deps++;const fe=ee.vnode.el;ee.asyncDep.catch(J=>{_f(J,ee,0)}).then(J=>{if(ee.isUnmounted||U.isUnmounted||U.pendingId!==ee.suspenseId)return;ee.asyncResolved=!0;const{vnode:Ce}=ee;oA(ee,J,!1),fe&&(Ce.el=fe);const me=!fe&&ee.subTree.el;ne(ee,Ce,L(fe||ee.subTree.el),fe?null:I(ee.subTree),U,l,d),me&&k(me),BI(ee,Ce.el),ye&&--U.deps===0&&U.resolve()})},unmount(ee,ne){U.isUnmounted=!0,U.activeBranch&&T(U.activeBranch,n,ee,ne),U.pendingBranch&&T(U.pendingBranch,n,ee,ne)}};return U}function qW(t,e,n,i,r,o,l,s,d){const p=e.suspense=zI(e,i,n,t.parentNode,document.createElement("div"),null,r,o,l,s,!0),y=d(t,p.pendingBranch=e.ssContent,n,p,o,l);return p.deps===0&&p.resolve(!1,!0),y}function YW(t){const{shapeFlag:e,children:n}=t,i=e&32;t.ssContent=JO(i?n.default:n),t.ssFallback=i?JO(n.fallback):Lt(xs)}function JO(t){let e;if(pi(t)){const n=sf&&t._c;n&&(t._d=!1,le()),t=t(),n&&(t._d=!0,e=Zs,rz())}return Dn(t)&&(t=jW(t)),t=_a(t),e&&!t.dynamicChildren&&(t.dynamicChildren=e.filter(n=>n!==t)),t}function AB(t,e){e&&e.pendingBranch?Dn(t)?e.effects.push(...t):e.effects.push(t):FI(t)}function dm(t,e){t.activeBranch=e;const{vnode:n,parentComponent:i}=t,r=n.el=e.el;i&&i.subTree===n&&(i.vnode.el=r,BI(i,r))}function JW(t){var e;return((e=t.props)==null?void 0:e.suspensible)!=null&&t.props.suspensible!==!1}function QW(t,e){return r_(t,null,e)}function PB(t,e){return r_(t,null,{flush:"post"})}function eK(t,e){return r_(t,null,{flush:"sync"})}const lb={};function Ri(t,e,n){return r_(t,e,n)}function r_(t,e,{immediate:n,deep:i,flush:r,onTrack:o,onTrigger:l}=_r){var s;const d=AI()===((s=Po)==null?void 0:s.scope)?Po:null;let p,y=!1,v=!1;if(Rr(t)?(p=()=>t.value,y=W0(t)):Xc(t)?(p=()=>t,i=!0):Dn(t)?(v=!0,y=t.some(U=>Xc(U)||W0(U)),p=()=>t.map(U=>{if(Rr(U))return U.value;if(Xc(U))return Vd(U);if(pi(U))return Zc(U,d,2)})):pi(t)?e?p=()=>Zc(t,d,2):p=()=>{if(!(d&&d.isUnmounted))return w&&w(),Ta(t,d,3,[T])}:p=Tl,e&&i){const U=p;p=()=>Vd(U())}let w,T=U=>{w=B.onStop=()=>{Zc(U,d,4)}},I;if(Im)if(T=Tl,e?n&&Ta(e,d,3,[p(),v?[]:void 0,T]):p(),r==="sync"){const U=fz();I=U.__watcherHandles||(U.__watcherHandles=[])}else return Tl;let L=v?new Array(t.length).fill(lb):lb;const k=()=>{if(B.active)if(e){const U=B.run();(i||y||(v?U.some((ee,ne)=>Ah(ee,L[ne])):Ah(U,L)))&&(w&&w(),Ta(e,d,3,[U,L===lb?void 0:v&&L[0]===lb?[]:L,T]),L=U)}else B.run()};k.allowRecurse=!!e;let F;r==="sync"?F=k:r==="post"?F=()=>es(k,d&&d.suspense):(k.pre=!0,d&&(k.id=d.uid),F=()=>d2(k));const B=new Cm(p,F);e?n?k():L=B.run():r==="post"?es(B.run.bind(B),d&&d.suspense):B.run();const G=()=>{B.stop(),d&&d.scope&&wI(d.scope.effects,B)};return I&&I.push(G),G}function tK(t,e,n){const i=this.proxy,r=Wr(t)?t.includes(".")?IB(i,t):()=>i[t]:t.bind(i,i);let o;pi(e)?o=e:(o=e.handler,n=e);const l=Po;Rh(this);const s=r_(r,o.bind(i),n);return l?Rh(l):Eh(),s}function IB(t,e){const n=e.split(".");return()=>{let i=t;for(let r=0;r<n.length&&i;r++)i=i[n[r]];return i}}function Vd(t,e){if(!br(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),Rr(t))Vd(t.value,e);else if(Dn(t))for(let n=0;n<t.length;n++)Vd(t[n],e);else if(vf(t)||lm(t))t.forEach(n=>{Vd(n,e)});else if(tB(t))for(const n in t)Vd(t[n],e);return t}function fo(t,e){const n=Ho;if(n===null)return t;const i=b2(n)||n.proxy,r=t.dirs||(t.dirs=[]);for(let o=0;o<e.length;o++){let[l,s,d,p=_r]=e[o];l&&(pi(l)&&(l={mounted:l,updated:l}),l.deep&&Vd(s),r.push({dir:l,instance:i,value:s,oldValue:void 0,arg:d,modifiers:p}))}return t}function Ql(t,e,n,i){const r=t.dirs,o=e&&e.dirs;for(let l=0;l<r.length;l++){const s=r[l];o&&(s.oldValue=o[l].value);let d=s.dir[i];d&&(Jm(),Ta(d,n,8,[t.el,s,t,e]),Qm())}}const hh=Symbol("_leaveCb"),cb=Symbol("_enterCb");function NI(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Ds(()=>{t.isMounted=!0}),v2(()=>{t.isUnmounting=!0}),t}const ka=[Function,Array],UI={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:ka,onEnter:ka,onAfterEnter:ka,onEnterCancelled:ka,onBeforeLeave:ka,onLeave:ka,onAfterLeave:ka,onLeaveCancelled:ka,onBeforeAppear:ka,onAppear:ka,onAfterAppear:ka,onAppearCancelled:ka},nK={name:"BaseTransition",props:UI,setup(t,{slots:e}){const n=pc(),i=NI();let r;return()=>{const o=e.default&&m2(e.default(),!0);if(!o||!o.length)return;let l=o[0];if(o.length>1){for(const L of o)if(L.type!==xs){l=L;break}}const s=zi(t),{mode:d}=s;if(i.isLeaving)return $T(l);const p=QO(l);if(!p)return $T(l);const y=Am(p,s,i,n);rf(p,y);const v=n.subTree,w=v&&QO(v);let T=!1;const{getTransitionKey:I}=p.type;if(I){const L=I();r===void 0?r=L:L!==r&&(r=L,T=!0)}if(w&&w.type!==xs&&(!_l(p,w)||T)){const L=Am(w,s,i,n);if(rf(w,L),d==="out-in")return i.isLeaving=!0,L.afterLeave=()=>{i.isLeaving=!1,n.update.active!==!1&&n.update()},$T(l);d==="in-out"&&p.type!==xs&&(L.delayLeave=(k,F,B)=>{const G=RB(i,w);G[String(w.key)]=w,k[hh]=()=>{F(),k[hh]=void 0,delete y.delayedLeave},y.delayedLeave=B})}return l}}},MB=nK;function RB(t,e){const{leavingVNodes:n}=t;let i=n.get(e.type);return i||(i=Object.create(null),n.set(e.type,i)),i}function Am(t,e,n,i){const{appear:r,mode:o,persisted:l=!1,onBeforeEnter:s,onEnter:d,onAfterEnter:p,onEnterCancelled:y,onBeforeLeave:v,onLeave:w,onAfterLeave:T,onLeaveCancelled:I,onBeforeAppear:L,onAppear:k,onAfterAppear:F,onAppearCancelled:B}=e,G=String(t.key),U=RB(n,t),ee=(fe,J)=>{fe&&Ta(fe,i,9,J)},ne=(fe,J)=>{const Ce=J[1];ee(fe,J),Dn(fe)?fe.every(me=>me.length<=1)&&Ce():fe.length<=1&&Ce()},ye={mode:o,persisted:l,beforeEnter(fe){let J=s;if(!n.isMounted)if(r)J=L||s;else return;fe[hh]&&fe[hh](!0);const Ce=U[G];Ce&&_l(t,Ce)&&Ce.el[hh]&&Ce.el[hh](),ee(J,[fe])},enter(fe){let J=d,Ce=p,me=y;if(!n.isMounted)if(r)J=k||d,Ce=F||p,me=B||y;else return;let be=!1;const Te=fe[cb]=ke=>{be||(be=!0,ke?ee(me,[fe]):ee(Ce,[fe]),ye.delayedLeave&&ye.delayedLeave(),fe[cb]=void 0)};J?ne(J,[fe,Te]):Te()},leave(fe,J){const Ce=String(t.key);if(fe[cb]&&fe[cb](!0),n.isUnmounting)return J();ee(v,[fe]);let me=!1;const be=fe[hh]=Te=>{me||(me=!0,J(),Te?ee(I,[fe]):ee(T,[fe]),fe[hh]=void 0,U[Ce]===t&&delete U[Ce])};U[Ce]=t,w?ne(w,[fe,be]):be()},clone(fe){return Am(fe,e,n,i)}};return ye}function $T(t){if(o_(t))return t=hc(t),t.children=null,t}function QO(t){return o_(t)?t.children?t.children[0]:void 0:t}function rf(t,e){t.shapeFlag&6&&t.component?rf(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function m2(t,e=!1,n){let i=[],r=0;for(let o=0;o<t.length;o++){let l=t[o];const s=n==null?l.key:String(n)+String(l.key!=null?l.key:o);l.type===_n?(l.patchFlag&128&&r++,i=i.concat(m2(l.children,e,s))):(e||l.type!==xs)&&i.push(s!=null?hc(l,{key:s}):l)}if(r>1)for(let o=0;o<i.length;o++)i[o].patchFlag=-2;return i}/*! #__NO_SIDE_EFFECTS__ */function pr(t,e){return pi(t)?(()=>Hr({name:t.name},e,{setup:t}))():t}const Zd=t=>!!t.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function iK(t){pi(t)&&(t={loader:t});const{loader:e,loadingComponent:n,errorComponent:i,delay:r=200,timeout:o,suspensible:l=!0,onError:s}=t;let d=null,p,y=0;const v=()=>(y++,d=null,w()),w=()=>{let T;return d||(T=d=e().catch(I=>{if(I=I instanceof Error?I:new Error(String(I)),s)return new Promise((L,k)=>{s(I,()=>L(v()),()=>k(I),y+1)});throw I}).then(I=>T!==d&&d?d:(I&&(I.__esModule||I[Symbol.toStringTag]==="Module")&&(I=I.default),p=I,I)))};return pr({name:"AsyncComponentWrapper",__asyncLoader:w,get __asyncResolved(){return p},setup(){const T=Po;if(p)return()=>GT(p,T);const I=B=>{d=null,_f(B,T,13,!i)};if(l&&T.suspense||Im)return w().then(B=>()=>GT(B,T)).catch(B=>(I(B),()=>i?Lt(i,{error:B}):null));const L=$n(!1),k=$n(),F=$n(!!r);return r&&setTimeout(()=>{F.value=!1},r),o!=null&&setTimeout(()=>{if(!L.value&&!k.value){const B=new Error(`Async component timed out after ${o}ms.`);I(B),k.value=B}},o),w().then(()=>{L.value=!0,T.parent&&o_(T.parent.vnode)&&d2(T.parent.update)}).catch(B=>{I(B),k.value=B}),()=>{if(L.value&&p)return GT(p,T);if(k.value&&i)return Lt(i,{error:k.value});if(n&&!F.value)return Lt(n)}}})}function GT(t,e){const{ref:n,props:i,children:r,ce:o}=e.vnode,l=Lt(t,i,r);return l.ref=n,l.ce=o,delete e.vnode.ce,l}const o_=t=>t.type.__isKeepAlive,rK={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(t,{slots:e}){const n=pc(),i=n.ctx;if(!i.renderer)return()=>{const B=e.default&&e.default();return B&&B.length===1?B[0]:B};const r=new Map,o=new Set;let l=null;const s=n.suspense,{renderer:{p:d,m:p,um:y,o:{createElement:v}}}=i,w=v("div");i.activate=(B,G,U,ee,ne)=>{const ye=B.component;p(B,G,U,0,s),d(ye.vnode,B,G,U,ye,s,ee,B.slotScopeIds,ne),es(()=>{ye.isDeactivated=!1,ye.a&&cm(ye.a);const fe=B.props&&B.props.onVnodeMounted;fe&&Xs(fe,ye.parent,B)},s)},i.deactivate=B=>{const G=B.component;p(B,w,null,1,s),es(()=>{G.da&&cm(G.da);const U=B.props&&B.props.onVnodeUnmounted;U&&Xs(U,G.parent,B),G.isDeactivated=!0},s)};function T(B){HT(B),y(B,n,s,!0)}function I(B){r.forEach((G,U)=>{const ee=aA(G.type);ee&&(!B||!B(ee))&&L(U)})}function L(B){const G=r.get(B);!l||!_l(G,l)?T(G):l&&HT(l),r.delete(B),o.delete(B)}Ri(()=>[t.include,t.exclude],([B,G])=>{B&&I(U=>Qy(B,U)),G&&I(U=>!Qy(G,U))},{flush:"post",deep:!0});let k=null;const F=()=>{k!=null&&r.set(k,WT(n.subTree))};return Ds(F),y2(F),v2(()=>{r.forEach(B=>{const{subTree:G,suspense:U}=n,ee=WT(G);if(B.type===ee.type&&B.key===ee.key){HT(ee);const ne=ee.component.da;ne&&es(ne,U);return}T(B)})}),()=>{if(k=null,!e.default)return null;const B=e.default(),G=B[0];if(B.length>1)return l=null,B;if(!Mh(G)||!(G.shapeFlag&4)&&!(G.shapeFlag&128))return l=null,G;let U=WT(G);const ee=U.type,ne=aA(Zd(U)?U.type.__asyncResolved||{}:ee),{include:ye,exclude:fe,max:J}=t;if(ye&&(!ne||!Qy(ye,ne))||fe&&ne&&Qy(fe,ne))return l=U,G;const Ce=U.key==null?ee:U.key,me=r.get(Ce);return U.el&&(U=hc(U),G.shapeFlag&128&&(G.ssContent=U)),k=Ce,me?(U.el=me.el,U.component=me.component,U.transition&&rf(U,U.transition),U.shapeFlag|=512,o.delete(Ce),o.add(Ce)):(o.add(Ce),J&&o.size>parseInt(J,10)&&L(o.values().next().value)),U.shapeFlag|=256,l=U,CB(G.type)?G:U}}},LB=rK;function Qy(t,e){return Dn(t)?t.some(n=>Qy(n,e)):Wr(t)?t.split(",").includes(e):UH(t)?t.test(e):!1}function OB(t,e){kB(t,"a",e)}function DB(t,e){kB(t,"da",e)}function kB(t,e,n=Po){const i=t.__wdc||(t.__wdc=()=>{let r=n;for(;r;){if(r.isDeactivated)return;r=r.parent}return t()});if(g2(e,i,n),n){let r=n.parent;for(;r&&r.parent;)o_(r.parent.vnode)&&oK(i,e,n,r),r=r.parent}}function oK(t,e,n,i){const r=g2(e,t,i,!0);bf(()=>{wI(i[e],r)},n)}function HT(t){t.shapeFlag&=-257,t.shapeFlag&=-513}function WT(t){return t.shapeFlag&128?t.ssContent:t}function g2(t,e,n=Po,i=!1){if(n){const r=n[t]||(n[t]=[]),o=e.__weh||(e.__weh=(...l)=>{if(n.isUnmounted)return;Jm(),Rh(n);const s=Ta(e,n,t,l);return Eh(),Qm(),s});return i?r.unshift(o):r.push(o),o}}const uu=t=>(e,n=Po)=>(!Im||t==="sp")&&g2(t,(...i)=>e(...i),n),FB=uu("bm"),Ds=uu("m"),BB=uu("bu"),y2=uu("u"),v2=uu("bum"),bf=uu("um"),zB=uu("sp"),NB=uu("rtg"),UB=uu("rtc");function VB(t,e=Po){g2("ec",t,e)}const VI="components",sK="directives";function Gn(t,e){return jI(VI,t,!0,e)||t}const jB=Symbol.for("v-ndc");function Zn(t){return Wr(t)?jI(VI,t,!1)||t:t||jB}function ea(t){return jI(sK,t)}function jI(t,e,n=!0,i=!1){const r=Ho||Po;if(r){const o=r.type;if(t===VI){const s=aA(o,!1);if(s&&(s===e||s===qs(e)||s===n_(qs(e))))return o}const l=eD(r[t]||o[t],e)||eD(r.appContext[t],e);return!l&&i?o:l}}function eD(t,e){return t&&(t[e]||t[qs(e)]||t[n_(qs(e))])}function or(t,e,n,i){let r;const o=n&&n[i];if(Dn(t)||Wr(t)){r=new Array(t.length);for(let l=0,s=t.length;l<s;l++)r[l]=e(t[l],l,void 0,o&&o[l])}else if(typeof t=="number"){r=new Array(t);for(let l=0;l<t;l++)r[l]=e(l+1,l,void 0,o&&o[l])}else if(br(t))if(t[Symbol.iterator])r=Array.from(t,(l,s)=>e(l,s,void 0,o&&o[s]));else{const l=Object.keys(t);r=new Array(l.length);for(let s=0,d=l.length;s<d;s++){const p=l[s];r[s]=e(t[p],p,s,o&&o[s])}}else r=[];return n&&(n[i]=r),r}function Pm(t,e){for(let n=0;n<e.length;n++){const i=e[n];if(Dn(i))for(let r=0;r<i.length;r++)t[i[r].name]=i[r].fn;else i&&(t[i.name]=i.key?(...r)=>{const o=i.fn(...r);return o&&(o.key=i.key),o}:i.fn)}return t}function Xn(t,e,n={},i,r){if(Ho.isCE||Ho.parent&&Zd(Ho.parent)&&Ho.parent.isCE)return e!=="default"&&(n.name=e),Lt("slot",n,i&&i());let o=t[e];o&&o._c&&(o._d=!1),le();const l=o&&$B(o(n)),s=Rt(_n,{key:n.key||l&&l.key||`_${e}`},l||(i?i():[]),l&&t._===1?64:-2);return!r&&s.scopeId&&(s.slotScopeIds=[s.scopeId+"-s"]),o&&o._c&&(o._d=!0),s}function $B(t){return t.some(e=>Mh(e)?!(e.type===xs||e.type===_n&&!$B(e.children)):!0)?t:null}function e0(t,e){const n={};for(const i in t)n[e&&/[A-Z]/.test(i)?`on:${i}`:_0(i)]=t[i];return n}const JC=t=>t?lz(t)?b2(t)||t.proxy:JC(t.parent):null,b0=Hr(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>JC(t.parent),$root:t=>JC(t.root),$emit:t=>t.emit,$options:t=>$I(t),$forceUpdate:t=>t.f||(t.f=()=>d2(t.update)),$nextTick:t=>t.n||(t.n=Ys.bind(t.proxy)),$watch:t=>tK.bind(t)}),KT=(t,e)=>t!==_r&&!t.__isScriptSetup&&Gi(t,e),QC={get({_:t},e){const{ctx:n,setupState:i,data:r,props:o,accessCache:l,type:s,appContext:d}=t;let p;if(e[0]!=="$"){const T=l[e];if(T!==void 0)switch(T){case 1:return i[e];case 2:return r[e];case 4:return n[e];case 3:return o[e]}else{if(KT(i,e))return l[e]=1,i[e];if(r!==_r&&Gi(r,e))return l[e]=2,r[e];if((p=t.propsOptions[0])&&Gi(p,e))return l[e]=3,o[e];if(n!==_r&&Gi(n,e))return l[e]=4,n[e];eA&&(l[e]=0)}}const y=b0[e];let v,w;if(y)return e==="$attrs"&&Qs(t,"get",e),y(t);if((v=s.__cssModules)&&(v=v[e]))return v;if(n!==_r&&Gi(n,e))return l[e]=4,n[e];if(w=d.config.globalProperties,Gi(w,e))return w[e]},set({_:t},e,n){const{data:i,setupState:r,ctx:o}=t;return KT(r,e)?(r[e]=n,!0):i!==_r&&Gi(i,e)?(i[e]=n,!0):Gi(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(o[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:i,appContext:r,propsOptions:o}},l){let s;return!!n[l]||t!==_r&&Gi(t,l)||KT(e,l)||(s=o[0])&&Gi(s,l)||Gi(i,l)||Gi(b0,l)||Gi(r.config.globalProperties,l)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:Gi(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}},aK=Hr({},QC,{get(t,e){if(e!==Symbol.unscopables)return QC.get(t,e,t)},has(t,e){return e[0]!=="_"&&!HH(e)}});function lK(){return null}function cK(){return null}function uK(t){}function hK(t){}function dK(){return null}function fK(){}function pK(t,e){return null}function mK(){return GB().slots}function s_(){return GB().attrs}function gK(t,e,n){const i=pc();if(n&&n.local){const r=$n(t[e]);return Ri(()=>t[e],o=>r.value=o),Ri(r,o=>{o!==t[e]&&i.emit(`update:${e}`,o)}),r}else return{__v_isRef:!0,get value(){return t[e]},set value(r){i.emit(`update:${e}`,r)}}}function GB(){const t=pc();return t.setupContext||(t.setupContext=hz(t))}function J0(t){return Dn(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}function yK(t,e){const n=J0(t);for(const i in e){if(i.startsWith("__skip"))continue;let r=n[i];r?Dn(r)||pi(r)?r=n[i]={type:r,default:e[i]}:r.default=e[i]:r===null&&(r=n[i]={default:e[i]}),r&&e[`__skip_${i}`]&&(r.skipFactory=!0)}return n}function vK(t,e){return!t||!e?t||e:Dn(t)&&Dn(e)?t.concat(e):Hr({},J0(t),J0(e))}function _K(t,e){const n={};for(const i in t)e.includes(i)||Object.defineProperty(n,i,{enumerable:!0,get:()=>t[i]});return n}function bK(t){const e=pc();let n=t();return Eh(),EI(n)&&(n=n.catch(i=>{throw Rh(e),i})),[n,()=>Rh(e)]}let eA=!0;function xK(t){const e=$I(t),n=t.proxy,i=t.ctx;eA=!1,e.beforeCreate&&tD(e.beforeCreate,t,"bc");const{data:r,computed:o,methods:l,watch:s,provide:d,inject:p,created:y,beforeMount:v,mounted:w,beforeUpdate:T,updated:I,activated:L,deactivated:k,beforeDestroy:F,beforeUnmount:B,destroyed:G,unmounted:U,render:ee,renderTracked:ne,renderTriggered:ye,errorCaptured:fe,serverPrefetch:J,expose:Ce,inheritAttrs:me,components:be,directives:Te,filters:ke}=e;if(p&&wK(p,i,null),l)for(const Et in l){const bt=l[Et];pi(bt)&&(i[Et]=bt.bind(n))}if(r){const Et=r.call(n,n);br(Et)&&(t.data=Ao(Et))}if(eA=!0,o)for(const Et in o){const bt=o[Et],Qt=pi(bt)?bt.bind(n,n):pi(bt.get)?bt.get.bind(n,n):Tl,cn=!pi(bt)&&pi(bt.set)?bt.set.bind(n):Tl,pn=ur({get:Qt,set:cn});Object.defineProperty(i,Et,{enumerable:!0,configurable:!0,get:()=>pn.value,set:xn=>pn.value=xn})}if(s)for(const Et in s)HB(s[Et],i,n,Et);if(d){const Et=pi(d)?d.call(n):d;Reflect.ownKeys(Et).forEach(bt=>{Os(bt,Et[bt])})}y&&tD(y,t,"c");function et(Et,bt){Dn(bt)?bt.forEach(Qt=>Et(Qt.bind(n))):bt&&Et(bt.bind(n))}if(et(FB,v),et(Ds,w),et(BB,T),et(y2,I),et(OB,L),et(DB,k),et(VB,fe),et(UB,ne),et(NB,ye),et(v2,B),et(bf,U),et(zB,J),Dn(Ce))if(Ce.length){const Et=t.exposed||(t.exposed={});Ce.forEach(bt=>{Object.defineProperty(Et,bt,{get:()=>n[bt],set:Qt=>n[bt]=Qt})})}else t.exposed||(t.exposed={});ee&&t.render===Tl&&(t.render=ee),me!=null&&(t.inheritAttrs=me),be&&(t.components=be),Te&&(t.directives=Te)}function wK(t,e,n=Tl){Dn(t)&&(t=tA(t));for(const i in t){const r=t[i];let o;br(r)?"default"in r?o=$r(r.from||i,r.default,!0):o=$r(r.from||i):o=$r(r),Rr(o)?Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:()=>o.value,set:l=>o.value=l}):e[i]=o}}function tD(t,e,n){Ta(Dn(t)?t.map(i=>i.bind(e.proxy)):t.bind(e.proxy),e,n)}function HB(t,e,n,i){const r=i.includes(".")?IB(n,i):()=>n[i];if(Wr(t)){const o=e[t];pi(o)&&Ri(r,o)}else if(pi(t))Ri(r,t.bind(n));else if(br(t))if(Dn(t))t.forEach(o=>HB(o,e,n,i));else{const o=pi(t.handler)?t.handler.bind(n):e[t.handler];pi(o)&&Ri(r,o,t)}}function $I(t){const e=t.type,{mixins:n,extends:i}=e,{mixins:r,optionsCache:o,config:{optionMergeStrategies:l}}=t.appContext,s=o.get(e);let d;return s?d=s:!r.length&&!n&&!i?d=e:(d={},r.length&&r.forEach(p=>ew(d,p,l,!0)),ew(d,e,l)),br(e)&&o.set(e,d),d}function ew(t,e,n,i=!1){const{mixins:r,extends:o}=e;o&&ew(t,o,n,!0),r&&r.forEach(l=>ew(t,l,n,!0));for(const l in e)if(!(i&&l==="expose")){const s=EK[l]||n&&n[l];t[l]=s?s(t[l],e[l]):e[l]}return t}const EK={data:nD,props:iD,emits:iD,methods:t0,computed:t0,beforeCreate:As,created:As,beforeMount:As,mounted:As,beforeUpdate:As,updated:As,beforeDestroy:As,beforeUnmount:As,destroyed:As,unmounted:As,activated:As,deactivated:As,errorCaptured:As,serverPrefetch:As,components:t0,directives:t0,watch:SK,provide:nD,inject:TK};function nD(t,e){return e?t?function(){return Hr(pi(t)?t.call(this,this):t,pi(e)?e.call(this,this):e)}:e:t}function TK(t,e){return t0(tA(t),tA(e))}function tA(t){if(Dn(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function As(t,e){return t?[...new Set([].concat(t,e))]:e}function t0(t,e){return t?Hr(Object.create(null),t,e):e}function iD(t,e){return t?Dn(t)&&Dn(e)?[...new Set([...t,...e])]:Hr(Object.create(null),J0(t),J0(e??{})):e}function SK(t,e){if(!t)return e;if(!e)return t;const n=Hr(Object.create(null),t);for(const i in e)n[i]=As(t[i],e[i]);return n}function WB(){return{app:null,config:{isNativeTag:BH,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let CK=0;function AK(t,e){return function(i,r=null){pi(i)||(i=Hr({},i)),r!=null&&!br(r)&&(r=null);const o=WB(),l=new WeakSet;let s=!1;const d=o.app={_uid:CK++,_component:i,_props:r,_container:null,_context:o,_instance:null,version:mz,get config(){return o.config},set config(p){},use(p,...y){return l.has(p)||(p&&pi(p.install)?(l.add(p),p.install(d,...y)):pi(p)&&(l.add(p),p(d,...y))),d},mixin(p){return o.mixins.includes(p)||o.mixins.push(p),d},component(p,y){return y?(o.components[p]=y,d):o.components[p]},directive(p,y){return y?(o.directives[p]=y,d):o.directives[p]},mount(p,y,v){if(!s){const w=Lt(i,r);return w.appContext=o,y&&e?e(w,p):t(w,p,v),s=!0,d._container=p,p.__vue_app__=d,b2(w.component)||w.component.proxy}},unmount(){s&&(t(null,d._container),delete d._container.__vue_app__)},provide(p,y){return o.provides[p]=y,d},runWithContext(p){Q0=d;try{return p()}finally{Q0=null}}};return d}}let Q0=null;function Os(t,e){if(Po){let n=Po.provides;const i=Po.parent&&Po.parent.provides;i===n&&(n=Po.provides=Object.create(i)),n[t]=e}}function $r(t,e,n=!1){const i=Po||Ho;if(i||Q0){const r=i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:Q0._context.provides;if(r&&t in r)return r[t];if(arguments.length>1)return n&&pi(e)?e.call(i&&i.proxy):e}}function KB(){return!!(Po||Ho||Q0)}function PK(t,e,n,i=!1){const r={},o={};Zx(o,_2,1),t.propsDefaults=Object.create(null),XB(t,e,r,o);for(const l in t.propsOptions[0])l in r||(r[l]=void 0);n?t.props=i?r:MI(r):t.type.props?t.props=r:t.props=o,t.attrs=o}function IK(t,e,n,i){const{props:r,attrs:o,vnode:{patchFlag:l}}=t,s=zi(r),[d]=t.propsOptions;let p=!1;if((i||l>0)&&!(l&16)){if(l&8){const y=t.vnode.dynamicProps;for(let v=0;v<y.length;v++){let w=y[v];if(f2(t.emitsOptions,w))continue;const T=e[w];if(d)if(Gi(o,w))T!==o[w]&&(o[w]=T,p=!0);else{const I=qs(w);r[I]=nA(d,s,I,T,t,!1)}else T!==o[w]&&(o[w]=T,p=!0)}}}else{XB(t,e,r,o)&&(p=!0);let y;for(const v in s)(!e||!Gi(e,v)&&((y=ja(v))===v||!Gi(e,y)))&&(d?n&&(n[v]!==void 0||n[y]!==void 0)&&(r[v]=nA(d,s,v,void 0,t,!0)):delete r[v]);if(o!==s)for(const v in o)(!e||!Gi(e,v))&&(delete o[v],p=!0)}p&&Kc(t,"set","$attrs")}function XB(t,e,n,i){const[r,o]=t.propsOptions;let l=!1,s;if(e)for(let d in e){if(v0(d))continue;const p=e[d];let y;r&&Gi(r,y=qs(d))?!o||!o.includes(y)?n[y]=p:(s||(s={}))[y]=p:f2(t.emitsOptions,d)||(!(d in i)||p!==i[d])&&(i[d]=p,l=!0)}if(o){const d=zi(n),p=s||_r;for(let y=0;y<o.length;y++){const v=o[y];n[v]=nA(r,d,v,p[v],t,!Gi(p,v))}}return l}function nA(t,e,n,i,r,o){const l=t[n];if(l!=null){const s=Gi(l,"default");if(s&&i===void 0){const d=l.default;if(l.type!==Function&&!l.skipFactory&&pi(d)){const{propsDefaults:p}=r;n in p?i=p[n]:(Rh(r),i=p[n]=d.call(null,e),Eh())}else i=d}l[0]&&(o&&!s?i=!1:l[1]&&(i===""||i===ja(n))&&(i=!0))}return i}function ZB(t,e,n=!1){const i=e.propsCache,r=i.get(t);if(r)return r;const o=t.props,l={},s=[];let d=!1;if(!pi(t)){const y=v=>{d=!0;const[w,T]=ZB(v,e,!0);Hr(l,w),T&&s.push(...T)};!n&&e.mixins.length&&e.mixins.forEach(y),t.extends&&y(t.extends),t.mixins&&t.mixins.forEach(y)}if(!o&&!d)return br(t)&&i.set(t,am),am;if(Dn(o))for(let y=0;y<o.length;y++){const v=qs(o[y]);rD(v)&&(l[v]=_r)}else if(o)for(const y in o){const v=qs(y);if(rD(v)){const w=o[y],T=l[v]=Dn(w)||pi(w)?{type:w}:Hr({},w);if(T){const I=aD(Boolean,T.type),L=aD(String,T.type);T[0]=I>-1,T[1]=L<0||I<L,(I>-1||Gi(T,"default"))&&s.push(v)}}}const p=[l,s];return br(t)&&i.set(t,p),p}function rD(t){return t[0]!=="$"}function oD(t){const e=t&&t.toString().match(/^\s*(function|class) (\w+)/);return e?e[2]:t===null?"null":""}function sD(t,e){return oD(t)===oD(e)}function aD(t,e){return Dn(e)?e.findIndex(n=>sD(n,t)):pi(e)&&sD(e,t)?0:-1}const qB=t=>t[0]==="_"||t==="$stable",GI=t=>Dn(t)?t.map(_a):[_a(t)],MK=(t,e,n)=>{if(e._n)return e;const i=Cn((...r)=>GI(e(...r)),n);return i._c=!1,i},YB=(t,e,n)=>{const i=t._ctx;for(const r in t){if(qB(r))continue;const o=t[r];if(pi(o))e[r]=MK(r,o,i);else if(o!=null){const l=GI(o);e[r]=()=>l}}},JB=(t,e)=>{const n=GI(e);t.slots.default=()=>n},RK=(t,e)=>{if(t.vnode.shapeFlag&32){const n=e._;n?(t.slots=zi(e),Zx(e,"_",n)):YB(e,t.slots={})}else t.slots={},e&&JB(t,e);Zx(t.slots,_2,1)},LK=(t,e,n)=>{const{vnode:i,slots:r}=t;let o=!0,l=_r;if(i.shapeFlag&32){const s=e._;s?n&&s===1?o=!1:(Hr(r,e),!n&&s===1&&delete r._):(o=!e.$stable,YB(e,r)),l=e}else e&&(JB(t,e),l={default:1});if(o)for(const s in r)!qB(s)&&l[s]==null&&delete r[s]};function tw(t,e,n,i,r=!1){if(Dn(t)){t.forEach((w,T)=>tw(w,e&&(Dn(e)?e[T]:e),n,i,r));return}if(Zd(i)&&!r)return;const o=i.shapeFlag&4?b2(i.component)||i.component.proxy:i.el,l=r?null:o,{i:s,r:d}=t,p=e&&e.r,y=s.refs===_r?s.refs={}:s.refs,v=s.setupState;if(p!=null&&p!==d&&(Wr(p)?(y[p]=null,Gi(v,p)&&(v[p]=null)):Rr(p)&&(p.value=null)),pi(d))Zc(d,s,12,[l,y]);else{const w=Wr(d),T=Rr(d);if(w||T){const I=()=>{if(t.f){const L=w?Gi(v,d)?v[d]:y[d]:d.value;r?Dn(L)&&wI(L,o):Dn(L)?L.includes(o)||L.push(o):w?(y[d]=[o],Gi(v,d)&&(v[d]=y[d])):(d.value=[o],t.k&&(y[t.k]=d.value))}else w?(y[d]=l,Gi(v,d)&&(v[d]=l)):T&&(d.value=l,t.k&&(y[t.k]=l))};l?(I.id=-1,es(I,n)):I()}}}let Zu=!1;const ub=t=>/svg/.test(t.namespaceURI)&&t.tagName!=="foreignObject",hb=t=>t.nodeType===8;function OK(t){const{mt:e,p:n,o:{patchProp:i,createText:r,nextSibling:o,parentNode:l,remove:s,insert:d,createComment:p}}=t,y=(F,B)=>{if(!B.hasChildNodes()){n(null,F,B),Qx(),B._vnode=F;return}Zu=!1,v(B.firstChild,F,null,null,null),Qx(),B._vnode=F,Zu&&console.error("Hydration completed but contains mismatches.")},v=(F,B,G,U,ee,ne=!1)=>{const ye=hb(F)&&F.data==="[",fe=()=>L(F,B,G,U,ee,ye),{type:J,ref:Ce,shapeFlag:me,patchFlag:be}=B;let Te=F.nodeType;B.el=F,be===-2&&(ne=!1,B.dynamicChildren=null);let ke=null;switch(J){case of:Te!==3?B.children===""?(d(B.el=r(""),l(F),F),ke=F):ke=fe():(F.data!==B.children&&(Zu=!0,F.data=B.children),ke=o(F));break;case xs:Te!==8||ye?ke=fe():ke=o(F);break;case qd:if(ye&&(F=o(F),Te=F.nodeType),Te===1||Te===3){ke=F;const ut=!B.children.length;for(let et=0;et<B.staticCount;et++)ut&&(B.children+=ke.nodeType===1?ke.outerHTML:ke.data),et===B.staticCount-1&&(B.anchor=ke),ke=o(ke);return ye?o(ke):ke}else fe();break;case _n:ye?ke=I(F,B,G,U,ee,ne):ke=fe();break;default:if(me&1)Te!==1||B.type.toLowerCase()!==F.tagName.toLowerCase()?ke=fe():ke=w(F,B,G,U,ee,ne);else if(me&6){B.slotScopeIds=ee;const ut=l(F);if(e(B,ut,null,G,U,ub(ut),ne),ke=ye?k(F):o(F),ke&&hb(ke)&&ke.data==="teleport end"&&(ke=o(ke)),Zd(B)){let et;ye?(et=Lt(_n),et.anchor=ke?ke.previousSibling:ut.lastChild):et=F.nodeType===3?vo(""):Lt("div"),et.el=F,B.component.subTree=et}}else me&64?Te!==8?ke=fe():ke=B.type.hydrate(F,B,G,U,ee,ne,t,T):me&128&&(ke=B.type.hydrate(F,B,G,U,ub(l(F)),ee,ne,t,v))}return Ce!=null&&tw(Ce,null,U,B),ke},w=(F,B,G,U,ee,ne)=>{ne=ne||!!B.dynamicChildren;const{type:ye,props:fe,patchFlag:J,shapeFlag:Ce,dirs:me}=B,be=ye==="input"&&me||ye==="option";if(be||J!==-1){if(me&&Ql(B,null,G,"created"),fe)if(be||!ne||J&48)for(const ke in fe)(be&&ke.endsWith("value")||t_(ke)&&!v0(ke))&&i(F,ke,null,fe[ke],!1,void 0,G);else fe.onClick&&i(F,"onClick",null,fe.onClick,!1,void 0,G);let Te;if((Te=fe&&fe.onVnodeBeforeMount)&&Xs(Te,G,B),me&&Ql(B,null,G,"beforeMount"),((Te=fe&&fe.onVnodeMounted)||me)&&AB(()=>{Te&&Xs(Te,G,B),me&&Ql(B,null,G,"mounted")},U),Ce&16&&!(fe&&(fe.innerHTML||fe.textContent))){let ke=T(F.firstChild,B,F,G,U,ee,ne);for(;ke;){Zu=!0;const ut=ke;ke=ke.nextSibling,s(ut)}}else Ce&8&&F.textContent!==B.children&&(Zu=!0,F.textContent=B.children)}return F.nextSibling},T=(F,B,G,U,ee,ne,ye)=>{ye=ye||!!B.dynamicChildren;const fe=B.children,J=fe.length;for(let Ce=0;Ce<J;Ce++){const me=ye?fe[Ce]:fe[Ce]=_a(fe[Ce]);if(F)F=v(F,me,U,ee,ne,ye);else{if(me.type===of&&!me.children)continue;Zu=!0,n(null,me,G,null,U,ee,ub(G),ne)}}return F},I=(F,B,G,U,ee,ne)=>{const{slotScopeIds:ye}=B;ye&&(ee=ee?ee.concat(ye):ye);const fe=l(F),J=T(o(F),B,fe,G,U,ee,ne);return J&&hb(J)&&J.data==="]"?o(B.anchor=J):(Zu=!0,d(B.anchor=p("]"),fe,J),J)},L=(F,B,G,U,ee,ne)=>{if(Zu=!0,B.el=null,ne){const J=k(F);for(;;){const Ce=o(F);if(Ce&&Ce!==J)s(Ce);else break}}const ye=o(F),fe=l(F);return s(F),n(null,B,fe,ye,G,U,ub(fe),ee),ye},k=F=>{let B=0;for(;F;)if(F=o(F),F&&hb(F)&&(F.data==="["&&B++,F.data==="]")){if(B===0)return o(F);B--}return F};return[y,v]}const es=AB;function QB(t){return tz(t)}function ez(t){return tz(t,OK)}function tz(t,e){const n=KC();n.__VUE__=!0;const{insert:i,remove:r,patchProp:o,createElement:l,createText:s,createComment:d,setText:p,setElementText:y,parentNode:v,nextSibling:w,setScopeId:T=Tl,insertStaticContent:I}=t,L=(ae,Ae,je,tt=null,pt=null,Tt=null,tn=!1,Wt=null,qt=!!Ae.dynamicChildren)=>{if(ae===Ae)return;ae&&!_l(ae,Ae)&&(tt=We(ae),xn(ae,pt,Tt,!0),ae=null),Ae.patchFlag===-2&&(qt=!1,Ae.dynamicChildren=null);const{type:It,ref:wn,shapeFlag:hn}=Ae;switch(It){case of:k(ae,Ae,je,tt);break;case xs:F(ae,Ae,je,tt);break;case qd:ae==null&&B(Ae,je,tt,tn);break;case _n:be(ae,Ae,je,tt,pt,Tt,tn,Wt,qt);break;default:hn&1?ee(ae,Ae,je,tt,pt,Tt,tn,Wt,qt):hn&6?Te(ae,Ae,je,tt,pt,Tt,tn,Wt,qt):(hn&64||hn&128)&&It.process(ae,Ae,je,tt,pt,Tt,tn,Wt,qt,Ke)}wn!=null&&pt&&tw(wn,ae&&ae.ref,Tt,Ae||ae,!Ae)},k=(ae,Ae,je,tt)=>{if(ae==null)i(Ae.el=s(Ae.children),je,tt);else{const pt=Ae.el=ae.el;Ae.children!==ae.children&&p(pt,Ae.children)}},F=(ae,Ae,je,tt)=>{ae==null?i(Ae.el=d(Ae.children||""),je,tt):Ae.el=ae.el},B=(ae,Ae,je,tt)=>{[ae.el,ae.anchor]=I(ae.children,Ae,je,tt,ae.el,ae.anchor)},G=({el:ae,anchor:Ae},je,tt)=>{let pt;for(;ae&&ae!==Ae;)pt=w(ae),i(ae,je,tt),ae=pt;i(Ae,je,tt)},U=({el:ae,anchor:Ae})=>{let je;for(;ae&&ae!==Ae;)je=w(ae),r(ae),ae=je;r(Ae)},ee=(ae,Ae,je,tt,pt,Tt,tn,Wt,qt)=>{tn=tn||Ae.type==="svg",ae==null?ne(Ae,je,tt,pt,Tt,tn,Wt,qt):J(ae,Ae,pt,Tt,tn,Wt,qt)},ne=(ae,Ae,je,tt,pt,Tt,tn,Wt)=>{let qt,It;const{type:wn,props:hn,shapeFlag:En,transition:zn,dirs:ei}=ae;if(qt=ae.el=l(ae.type,Tt,hn&&hn.is,hn),En&8?y(qt,ae.children):En&16&&fe(ae.children,qt,null,tt,pt,Tt&&wn!=="foreignObject",tn,Wt),ei&&Ql(ae,null,tt,"created"),ye(qt,ae,ae.scopeId,tn,tt),hn){for(const li in hn)li!=="value"&&!v0(li)&&o(qt,li,null,hn[li],Tt,ae.children,tt,pt,Nt);"value"in hn&&o(qt,"value",null,hn.value),(It=hn.onVnodeBeforeMount)&&Xs(It,tt,ae)}ei&&Ql(ae,null,tt,"beforeMount");const ti=(!pt||pt&&!pt.pendingBranch)&&zn&&!zn.persisted;ti&&zn.beforeEnter(qt),i(qt,Ae,je),((It=hn&&hn.onVnodeMounted)||ti||ei)&&es(()=>{It&&Xs(It,tt,ae),ti&&zn.enter(qt),ei&&Ql(ae,null,tt,"mounted")},pt)},ye=(ae,Ae,je,tt,pt)=>{if(je&&T(ae,je),tt)for(let Tt=0;Tt<tt.length;Tt++)T(ae,tt[Tt]);if(pt){let Tt=pt.subTree;if(Ae===Tt){const tn=pt.vnode;ye(ae,tn,tn.scopeId,tn.slotScopeIds,pt.parent)}}},fe=(ae,Ae,je,tt,pt,Tt,tn,Wt,qt=0)=>{for(let It=qt;It<ae.length;It++){const wn=ae[It]=Wt?dh(ae[It]):_a(ae[It]);L(null,wn,Ae,je,tt,pt,Tt,tn,Wt)}},J=(ae,Ae,je,tt,pt,Tt,tn)=>{const Wt=Ae.el=ae.el;let{patchFlag:qt,dynamicChildren:It,dirs:wn}=Ae;qt|=ae.patchFlag&16;const hn=ae.props||_r,En=Ae.props||_r;let zn;je&&Td(je,!1),(zn=En.onVnodeBeforeUpdate)&&Xs(zn,je,Ae,ae),wn&&Ql(Ae,ae,je,"beforeUpdate"),je&&Td(je,!0);const ei=pt&&Ae.type!=="foreignObject";if(It?Ce(ae.dynamicChildren,It,Wt,je,tt,ei,Tt):tn||bt(ae,Ae,Wt,null,je,tt,ei,Tt,!1),qt>0){if(qt&16)me(Wt,Ae,hn,En,je,tt,pt);else if(qt&2&&hn.class!==En.class&&o(Wt,"class",null,En.class,pt),qt&4&&o(Wt,"style",hn.style,En.style,pt),qt&8){const ti=Ae.dynamicProps;for(let li=0;li<ti.length;li++){const ie=ti[li],K=hn[ie],Be=En[ie];(Be!==K||ie==="value")&&o(Wt,ie,K,Be,pt,ae.children,je,tt,Nt)}}qt&1&&ae.children!==Ae.children&&y(Wt,Ae.children)}else!tn&&It==null&&me(Wt,Ae,hn,En,je,tt,pt);((zn=En.onVnodeUpdated)||wn)&&es(()=>{zn&&Xs(zn,je,Ae,ae),wn&&Ql(Ae,ae,je,"updated")},tt)},Ce=(ae,Ae,je,tt,pt,Tt,tn)=>{for(let Wt=0;Wt<Ae.length;Wt++){const qt=ae[Wt],It=Ae[Wt],wn=qt.el&&(qt.type===_n||!_l(qt,It)||qt.shapeFlag&70)?v(qt.el):je;L(qt,It,wn,null,tt,pt,Tt,tn,!0)}},me=(ae,Ae,je,tt,pt,Tt,tn)=>{if(je!==tt){if(je!==_r)for(const Wt in je)!v0(Wt)&&!(Wt in tt)&&o(ae,Wt,je[Wt],null,tn,Ae.children,pt,Tt,Nt);for(const Wt in tt){if(v0(Wt))continue;const qt=tt[Wt],It=je[Wt];qt!==It&&Wt!=="value"&&o(ae,Wt,It,qt,tn,Ae.children,pt,Tt,Nt)}"value"in tt&&o(ae,"value",je.value,tt.value)}},be=(ae,Ae,je,tt,pt,Tt,tn,Wt,qt)=>{const It=Ae.el=ae?ae.el:s(""),wn=Ae.anchor=ae?ae.anchor:s("");let{patchFlag:hn,dynamicChildren:En,slotScopeIds:zn}=Ae;zn&&(Wt=Wt?Wt.concat(zn):zn),ae==null?(i(It,je,tt),i(wn,je,tt),fe(Ae.children,je,wn,pt,Tt,tn,Wt,qt)):hn>0&&hn&64&&En&&ae.dynamicChildren?(Ce(ae.dynamicChildren,En,je,pt,Tt,tn,Wt),(Ae.key!=null||pt&&Ae===pt.subTree)&&HI(ae,Ae,!0)):bt(ae,Ae,je,wn,pt,Tt,tn,Wt,qt)},Te=(ae,Ae,je,tt,pt,Tt,tn,Wt,qt)=>{Ae.slotScopeIds=Wt,ae==null?Ae.shapeFlag&512?pt.ctx.activate(Ae,je,tt,tn,qt):ke(Ae,je,tt,pt,Tt,tn,qt):ut(ae,Ae,qt)},ke=(ae,Ae,je,tt,pt,Tt,tn)=>{const Wt=ae.component=az(ae,tt,pt);if(o_(ae)&&(Wt.ctx.renderer=Ke),cz(Wt),Wt.asyncDep){if(pt&&pt.registerDep(Wt,et),!ae.el){const qt=Wt.subTree=Lt(xs);F(null,qt,Ae,je)}return}et(Wt,ae,Ae,je,pt,Tt,tn)},ut=(ae,Ae,je)=>{const tt=Ae.component=ae.component;if(HW(ae,Ae,je))if(tt.asyncDep&&!tt.asyncResolved){Et(tt,Ae,je);return}else tt.next=Ae,zW(tt.update),tt.update();else Ae.el=ae.el,tt.vnode=Ae},et=(ae,Ae,je,tt,pt,Tt,tn)=>{const Wt=()=>{if(ae.isMounted){let{next:wn,bu:hn,u:En,parent:zn,vnode:ei}=ae,ti=wn,li;Td(ae,!1),wn?(wn.el=ei.el,Et(ae,wn,tn)):wn=ei,hn&&cm(hn),(li=wn.props&&wn.props.onVnodeBeforeUpdate)&&Xs(li,zn,wn,ei),Td(ae,!0);const ie=mx(ae),K=ae.subTree;ae.subTree=ie,L(K,ie,v(K.el),We(K),ae,pt,Tt),wn.el=ie.el,ti===null&&BI(ae,ie.el),En&&es(En,pt),(li=wn.props&&wn.props.onVnodeUpdated)&&es(()=>Xs(li,zn,wn,ei),pt)}else{let wn;const{el:hn,props:En}=Ae,{bm:zn,m:ei,parent:ti}=ae,li=Zd(Ae);if(Td(ae,!1),zn&&cm(zn),!li&&(wn=En&&En.onVnodeBeforeMount)&&Xs(wn,ti,Ae),Td(ae,!0),hn&&Pt){const ie=()=>{ae.subTree=mx(ae),Pt(hn,ae.subTree,ae,pt,null)};li?Ae.type.__asyncLoader().then(()=>!ae.isUnmounted&&ie()):ie()}else{const ie=ae.subTree=mx(ae);L(null,ie,je,tt,ae,pt,Tt),Ae.el=ie.el}if(ei&&es(ei,pt),!li&&(wn=En&&En.onVnodeMounted)){const ie=Ae;es(()=>Xs(wn,ti,ie),pt)}(Ae.shapeFlag&256||ti&&Zd(ti.vnode)&&ti.vnode.shapeFlag&256)&&ae.a&&es(ae.a,pt),ae.isMounted=!0,Ae=je=tt=null}},qt=ae.effect=new Cm(Wt,()=>d2(It),ae.scope),It=ae.update=()=>qt.run();It.id=ae.uid,Td(ae,!0),It()},Et=(ae,Ae,je)=>{Ae.component=ae;const tt=ae.vnode.props;ae.vnode=Ae,ae.next=null,IK(ae,Ae.props,tt,je),LK(ae,Ae.children,je),Jm(),qO(),Qm()},bt=(ae,Ae,je,tt,pt,Tt,tn,Wt,qt=!1)=>{const It=ae&&ae.children,wn=ae?ae.shapeFlag:0,hn=Ae.children,{patchFlag:En,shapeFlag:zn}=Ae;if(En>0){if(En&128){cn(It,hn,je,tt,pt,Tt,tn,Wt,qt);return}else if(En&256){Qt(It,hn,je,tt,pt,Tt,tn,Wt,qt);return}}zn&8?(wn&16&&Nt(It,pt,Tt),hn!==It&&y(je,hn)):wn&16?zn&16?cn(It,hn,je,tt,pt,Tt,tn,Wt,qt):Nt(It,pt,Tt,!0):(wn&8&&y(je,""),zn&16&&fe(hn,je,tt,pt,Tt,tn,Wt,qt))},Qt=(ae,Ae,je,tt,pt,Tt,tn,Wt,qt)=>{ae=ae||am,Ae=Ae||am;const It=ae.length,wn=Ae.length,hn=Math.min(It,wn);let En;for(En=0;En<hn;En++){const zn=Ae[En]=qt?dh(Ae[En]):_a(Ae[En]);L(ae[En],zn,je,null,pt,Tt,tn,Wt,qt)}It>wn?Nt(ae,pt,Tt,!0,!1,hn):fe(Ae,je,tt,pt,Tt,tn,Wt,qt,hn)},cn=(ae,Ae,je,tt,pt,Tt,tn,Wt,qt)=>{let It=0;const wn=Ae.length;let hn=ae.length-1,En=wn-1;for(;It<=hn&&It<=En;){const zn=ae[It],ei=Ae[It]=qt?dh(Ae[It]):_a(Ae[It]);if(_l(zn,ei))L(zn,ei,je,null,pt,Tt,tn,Wt,qt);else break;It++}for(;It<=hn&&It<=En;){const zn=ae[hn],ei=Ae[En]=qt?dh(Ae[En]):_a(Ae[En]);if(_l(zn,ei))L(zn,ei,je,null,pt,Tt,tn,Wt,qt);else break;hn--,En--}if(It>hn){if(It<=En){const zn=En+1,ei=zn<wn?Ae[zn].el:tt;for(;It<=En;)L(null,Ae[It]=qt?dh(Ae[It]):_a(Ae[It]),je,ei,pt,Tt,tn,Wt,qt),It++}}else if(It>En)for(;It<=hn;)xn(ae[It],pt,Tt,!0),It++;else{const zn=It,ei=It,ti=new Map;for(It=ei;It<=En;It++){const en=Ae[It]=qt?dh(Ae[It]):_a(Ae[It]);en.key!=null&&ti.set(en.key,It)}let li,ie=0;const K=En-ei+1;let Be=!1,rt=0;const mt=new Array(K);for(It=0;It<K;It++)mt[It]=0;for(It=zn;It<=hn;It++){const en=ae[It];if(ie>=K){xn(en,pt,Tt,!0);continue}let bn;if(en.key!=null)bn=ti.get(en.key);else for(li=ei;li<=En;li++)if(mt[li-ei]===0&&_l(en,Ae[li])){bn=li;break}bn===void 0?xn(en,pt,Tt,!0):(mt[bn-ei]=It+1,bn>=rt?rt=bn:Be=!0,L(en,Ae[bn],je,null,pt,Tt,tn,Wt,qt),ie++)}const zt=Be?DK(mt):am;for(li=zt.length-1,It=K-1;It>=0;It--){const en=ei+It,bn=Ae[en],Hn=en+1<wn?Ae[en+1].el:tt;mt[It]===0?L(null,bn,je,Hn,pt,Tt,tn,Wt,qt):Be&&(li<0||It!==zt[li]?pn(bn,je,Hn,2):li--)}}},pn=(ae,Ae,je,tt,pt=null)=>{const{el:Tt,type:tn,transition:Wt,children:qt,shapeFlag:It}=ae;if(It&6){pn(ae.component.subTree,Ae,je,tt);return}if(It&128){ae.suspense.move(Ae,je,tt);return}if(It&64){tn.move(ae,Ae,je,Ke);return}if(tn===_n){i(Tt,Ae,je);for(let hn=0;hn<qt.length;hn++)pn(qt[hn],Ae,je,tt);i(ae.anchor,Ae,je);return}if(tn===qd){G(ae,Ae,je);return}if(tt!==2&&It&1&&Wt)if(tt===0)Wt.beforeEnter(Tt),i(Tt,Ae,je),es(()=>Wt.enter(Tt),pt);else{const{leave:hn,delayLeave:En,afterLeave:zn}=Wt,ei=()=>i(Tt,Ae,je),ti=()=>{hn(Tt,()=>{ei(),zn&&zn()})};En?En(Tt,ei,ti):ti()}else i(Tt,Ae,je)},xn=(ae,Ae,je,tt=!1,pt=!1)=>{const{type:Tt,props:tn,ref:Wt,children:qt,dynamicChildren:It,shapeFlag:wn,patchFlag:hn,dirs:En}=ae;if(Wt!=null&&tw(Wt,null,je,ae,!0),wn&256){Ae.ctx.deactivate(ae);return}const zn=wn&1&&En,ei=!Zd(ae);let ti;if(ei&&(ti=tn&&tn.onVnodeBeforeUnmount)&&Xs(ti,Ae,ae),wn&6)Bn(ae.component,je,tt);else{if(wn&128){ae.suspense.unmount(je,tt);return}zn&&Ql(ae,null,Ae,"beforeUnmount"),wn&64?ae.type.remove(ae,Ae,je,pt,Ke,tt):It&&(Tt!==_n||hn>0&&hn&64)?Nt(It,Ae,je,!1,!0):(Tt===_n&&hn&384||!pt&&wn&16)&&Nt(qt,Ae,je),tt&&An(ae)}(ei&&(ti=tn&&tn.onVnodeUnmounted)||zn)&&es(()=>{ti&&Xs(ti,Ae,ae),zn&&Ql(ae,null,Ae,"unmounted")},je)},An=ae=>{const{type:Ae,el:je,anchor:tt,transition:pt}=ae;if(Ae===_n){kn(je,tt);return}if(Ae===qd){U(ae);return}const Tt=()=>{r(je),pt&&!pt.persisted&&pt.afterLeave&&pt.afterLeave()};if(ae.shapeFlag&1&&pt&&!pt.persisted){const{leave:tn,delayLeave:Wt}=pt,qt=()=>tn(je,Tt);Wt?Wt(ae.el,Tt,qt):qt()}else Tt()},kn=(ae,Ae)=>{let je;for(;ae!==Ae;)je=w(ae),r(ae),ae=je;r(Ae)},Bn=(ae,Ae,je)=>{const{bum:tt,scope:pt,update:Tt,subTree:tn,um:Wt}=ae;tt&&cm(tt),pt.stop(),Tt&&(Tt.active=!1,xn(tn,ae,Ae,je)),Wt&&es(Wt,Ae),es(()=>{ae.isUnmounted=!0},Ae),Ae&&Ae.pendingBranch&&!Ae.isUnmounted&&ae.asyncDep&&!ae.asyncResolved&&ae.suspenseId===Ae.pendingId&&(Ae.deps--,Ae.deps===0&&Ae.resolve())},Nt=(ae,Ae,je,tt=!1,pt=!1,Tt=0)=>{for(let tn=Tt;tn<ae.length;tn++)xn(ae[tn],Ae,je,tt,pt)},We=ae=>ae.shapeFlag&6?We(ae.component.subTree):ae.shapeFlag&128?ae.suspense.next():w(ae.anchor||ae.el),kt=(ae,Ae,je)=>{ae==null?Ae._vnode&&xn(Ae._vnode,null,null,!0):L(Ae._vnode||null,ae,Ae,null,null,null,je),qO(),Qx(),Ae._vnode=ae},Ke={p:L,um:xn,m:pn,r:An,mt:ke,mc:fe,pc:bt,pbc:Ce,n:We,o:t};let ht,Pt;return e&&([ht,Pt]=e(Ke)),{render:kt,hydrate:ht,createApp:AK(kt,ht)}}function Td({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function HI(t,e,n=!1){const i=t.children,r=e.children;if(Dn(i)&&Dn(r))for(let o=0;o<i.length;o++){const l=i[o];let s=r[o];s.shapeFlag&1&&!s.dynamicChildren&&((s.patchFlag<=0||s.patchFlag===32)&&(s=r[o]=dh(r[o]),s.el=l.el),n||HI(l,s)),s.type===of&&(s.el=l.el)}}function DK(t){const e=t.slice(),n=[0];let i,r,o,l,s;const d=t.length;for(i=0;i<d;i++){const p=t[i];if(p!==0){if(r=n[n.length-1],t[r]<p){e[i]=r,n.push(i);continue}for(o=0,l=n.length-1;o<l;)s=o+l>>1,t[n[s]]<p?o=s+1:l=s;p<t[n[o]]&&(o>0&&(e[i]=n[o-1]),n[o]=i)}}for(o=n.length,l=n[o-1];o-- >0;)n[o]=l,l=e[l];return n}const kK=t=>t.__isTeleport,x0=t=>t&&(t.disabled||t.disabled===""),lD=t=>typeof SVGElement<"u"&&t instanceof SVGElement,iA=(t,e)=>{const n=t&&t.to;return Wr(n)?e?e(n):null:n},FK={__isTeleport:!0,process(t,e,n,i,r,o,l,s,d,p){const{mc:y,pc:v,pbc:w,o:{insert:T,querySelector:I,createText:L,createComment:k}}=p,F=x0(e.props);let{shapeFlag:B,children:G,dynamicChildren:U}=e;if(t==null){const ee=e.el=L(""),ne=e.anchor=L("");T(ee,n,i),T(ne,n,i);const ye=e.target=iA(e.props,I),fe=e.targetAnchor=L("");ye&&(T(fe,ye),l=l||lD(ye));const J=(Ce,me)=>{B&16&&y(G,Ce,me,r,o,l,s,d)};F?J(n,ne):ye&&J(ye,fe)}else{e.el=t.el;const ee=e.anchor=t.anchor,ne=e.target=t.target,ye=e.targetAnchor=t.targetAnchor,fe=x0(t.props),J=fe?n:ne,Ce=fe?ee:ye;if(l=l||lD(ne),U?(w(t.dynamicChildren,U,J,r,o,l,s),HI(t,e,!0)):d||v(t,e,J,Ce,r,o,l,s,!1),F)fe?e.props&&t.props&&e.props.to!==t.props.to&&(e.props.to=t.props.to):db(e,n,ee,p,1);else if((e.props&&e.props.to)!==(t.props&&t.props.to)){const me=e.target=iA(e.props,I);me&&db(e,me,null,p,0)}else fe&&db(e,ne,ye,p,1)}iz(e)},remove(t,e,n,i,{um:r,o:{remove:o}},l){const{shapeFlag:s,children:d,anchor:p,targetAnchor:y,target:v,props:w}=t;if(v&&o(y),l&&o(p),s&16){const T=l||!x0(w);for(let I=0;I<d.length;I++){const L=d[I];r(L,e,n,T,!!L.dynamicChildren)}}},move:db,hydrate:BK};function db(t,e,n,{o:{insert:i},m:r},o=2){o===0&&i(t.targetAnchor,e,n);const{el:l,anchor:s,shapeFlag:d,children:p,props:y}=t,v=o===2;if(v&&i(l,e,n),(!v||x0(y))&&d&16)for(let w=0;w<p.length;w++)r(p[w],e,n,2);v&&i(s,e,n)}function BK(t,e,n,i,r,o,{o:{nextSibling:l,parentNode:s,querySelector:d}},p){const y=e.target=iA(e.props,d);if(y){const v=y._lpa||y.firstChild;if(e.shapeFlag&16)if(x0(e.props))e.anchor=p(l(t),e,s(t),n,i,r,o),e.targetAnchor=v;else{e.anchor=l(t);let w=v;for(;w;)if(w=l(w),w&&w.nodeType===8&&w.data==="teleport anchor"){e.targetAnchor=w,y._lpa=e.targetAnchor&&l(e.targetAnchor);break}p(v,e,y,n,i,r,o)}iz(e)}return e.anchor&&l(e.anchor)}const nz=FK;function iz(t){const e=t.ctx;if(e&&e.ut){let n=t.children[0].el;for(;n&&n!==t.targetAnchor;)n.nodeType===1&&n.setAttribute("data-v-owner",e.uid),n=n.nextSibling;e.ut()}}const _n=Symbol.for("v-fgt"),of=Symbol.for("v-txt"),xs=Symbol.for("v-cmt"),qd=Symbol.for("v-stc"),w0=[];let Zs=null;function le(t=!1){w0.push(Zs=t?null:[])}function rz(){w0.pop(),Zs=w0[w0.length-1]||null}let sf=1;function rA(t){sf+=t}function oz(t){return t.dynamicChildren=sf>0?Zs||am:null,rz(),sf>0&&Zs&&Zs.push(t),t}function Ue(t,e,n,i,r,o){return oz(Qe(t,e,n,i,r,o,!0))}function Rt(t,e,n,i,r){return oz(Lt(t,e,n,i,r,!0))}function Mh(t){return t?t.__v_isVNode===!0:!1}function _l(t,e){return t.type===e.type&&t.key===e.key}function zK(t){}const _2="__vInternal",sz=({key:t})=>t??null,gx=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?Wr(t)||Rr(t)||pi(t)?{i:Ho,r:t,k:e,f:!!n}:t:null);function Qe(t,e=null,n=null,i=0,r=null,o=t===_n?0:1,l=!1,s=!1){const d={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&sz(e),ref:e&&gx(e),scopeId:p2,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:i,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:Ho};return s?(KI(d,n),o&128&&t.normalize(d)):n&&(d.shapeFlag|=Wr(n)?8:16),sf>0&&!l&&Zs&&(d.patchFlag>0||o&6)&&d.patchFlag!==32&&Zs.push(d),d}const Lt=NK;function NK(t,e=null,n=null,i=0,r=null,o=!1){if((!t||t===jB)&&(t=xs),Mh(t)){const s=hc(t,e,!0);return n&&KI(s,n),sf>0&&!o&&Zs&&(s.shapeFlag&6?Zs[Zs.indexOf(t)]=s:Zs.push(s)),s.patchFlag|=-2,s}if(WK(t)&&(t=t.__vccOpts),e){e=E0(e);let{class:s,style:d}=e;s&&!Wr(s)&&(e.class=ri(s)),br(d)&&(RI(d)&&!Dn(d)&&(d=Hr({},d)),e.style=tf(d))}const l=Wr(t)?1:CB(t)?128:kK(t)?64:br(t)?4:pi(t)?2:0;return Qe(t,e,n,i,r,l,o,!0)}function E0(t){return t?RI(t)||_2 in t?Hr({},t):t:null}function hc(t,e,n=!1){const{props:i,ref:r,patchFlag:o,children:l}=t,s=e?Le(i||{},e):i;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:s,key:s&&sz(s),ref:e&&e.ref?n&&r?Dn(r)?r.concat(gx(e)):[r,gx(e)]:gx(e):r,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:l,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==_n?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&hc(t.ssContent),ssFallback:t.ssFallback&&hc(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce}}function vo(t=" ",e=0){return Lt(of,null,t,e)}function WI(t,e){const n=Lt(qd,null,t);return n.staticCount=e,n}function Jt(t="",e=!1){return e?(le(),Rt(xs,null,t)):Lt(xs,null,t)}function _a(t){return t==null||typeof t=="boolean"?Lt(xs):Dn(t)?Lt(_n,null,t.slice()):typeof t=="object"?dh(t):Lt(of,null,String(t))}function dh(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:hc(t)}function KI(t,e){let n=0;const{shapeFlag:i}=t;if(e==null)e=null;else if(Dn(e))n=16;else if(typeof e=="object")if(i&65){const r=e.default;r&&(r._c&&(r._d=!1),KI(t,r()),r._c&&(r._d=!0));return}else{n=32;const r=e._;!r&&!(_2 in e)?e._ctx=Ho:r===3&&Ho&&(Ho.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else pi(e)?(e={default:e,_ctx:Ho},n=32):(e=String(e),i&64?(n=16,e=[vo(e)]):n=8);t.children=e,t.shapeFlag|=n}function Le(...t){const e={};for(let n=0;n<t.length;n++){const i=t[n];for(const r in i)if(r==="class")e.class!==i.class&&(e.class=ri([e.class,i.class]));else if(r==="style")e.style=tf([e.style,i.style]);else if(t_(r)){const o=e[r],l=i[r];l&&o!==l&&!(Dn(o)&&o.includes(l))&&(e[r]=o?[].concat(o,l):l)}else r!==""&&(e[r]=i[r])}return e}function Xs(t,e,n,i=null){Ta(t,e,7,[n,i])}const UK=WB();let VK=0;function az(t,e,n){const i=t.type,r=(e?e.appContext:t.appContext)||UK,o={uid:VK++,vnode:t,type:i,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,scope:new SI(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:ZB(i,r),emitsOptions:SB(i,r),emit:null,emitted:null,propsDefaults:_r,inheritAttrs:i.inheritAttrs,ctx:_r,data:_r,props:_r,attrs:_r,slots:_r,refs:_r,setupState:_r,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return o.ctx={_:o},o.root=e?e.root:o,o.emit=UW.bind(null,o),t.ce&&t.ce(o),o}let Po=null;const pc=()=>Po||Ho;let XI,Ep,cD="__VUE_INSTANCE_SETTERS__";(Ep=KC()[cD])||(Ep=KC()[cD]=[]),Ep.push(t=>Po=t),XI=t=>{Ep.length>1?Ep.forEach(e=>e(t)):Ep[0](t)};const Rh=t=>{XI(t),t.scope.on()},Eh=()=>{Po&&Po.scope.off(),XI(null)};function lz(t){return t.vnode.shapeFlag&4}let Im=!1;function cz(t,e=!1){Im=e;const{props:n,children:i}=t.vnode,r=lz(t);PK(t,n,r,e),RK(t,i);const o=r?jK(t,e):void 0;return Im=!1,o}function jK(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=i_(new Proxy(t.ctx,QC));const{setup:i}=n;if(i){const r=t.setupContext=i.length>1?hz(t):null;Rh(t),Jm();const o=Zc(i,t,0,[t.props,r]);if(Qm(),Eh(),EI(o)){if(o.then(Eh,Eh),e)return o.then(l=>{oA(t,l,e)}).catch(l=>{_f(l,t,0)});t.asyncDep=o}else oA(t,o,e)}else uz(t,e)}function oA(t,e,n){pi(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:br(e)&&(t.setupState=DI(e)),uz(t,n)}let nw,sA;function $K(t){nw=t,sA=e=>{e.render._rc&&(e.withProxy=new Proxy(e.ctx,aK))}}const GK=()=>!nw;function uz(t,e,n){const i=t.type;if(!t.render){if(!e&&nw&&!i.render){const r=i.template||$I(t).template;if(r){const{isCustomElement:o,compilerOptions:l}=t.appContext.config,{delimiters:s,compilerOptions:d}=i,p=Hr(Hr({isCustomElement:o,delimiters:s},l),d);i.render=nw(r,p)}}t.render=i.render||Tl,sA&&sA(t)}{Rh(t),Jm();try{xK(t)}finally{Qm(),Eh()}}}function HK(t){return t.attrsProxy||(t.attrsProxy=new Proxy(t.attrs,{get(e,n){return Qs(t,"get","$attrs"),e[n]}}))}function hz(t){const e=n=>{t.exposed=n||{}};return{get attrs(){return HK(t)},slots:t.slots,emit:t.emit,expose:e}}function b2(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(DI(i_(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in b0)return b0[n](t)},has(e,n){return n in e||n in b0}}))}function aA(t,e=!0){return pi(t)?t.displayName||t.name:t.name||e&&t.__name}function WK(t){return pi(t)&&"__vccOpts"in t}const ur=(t,e)=>OW(t,e,Im);function a_(t,e,n){const i=arguments.length;return i===2?br(e)&&!Dn(e)?Mh(e)?Lt(t,null,[e]):Lt(t,e):Lt(t,null,e):(i>3?n=Array.prototype.slice.call(arguments,2):i===3&&Mh(n)&&(n=[n]),Lt(t,e,n))}const dz=Symbol.for("v-scx"),fz=()=>$r(dz);function KK(){}function XK(t,e,n,i){const r=n[i];if(r&&pz(r,t))return r;const o=e();return o.memo=t.slice(),n[i]=o}function pz(t,e){const n=t.memo;if(n.length!=e.length)return!1;for(let i=0;i<n.length;i++)if(Ah(n[i],e[i]))return!1;return sf>0&&Zs&&Zs.push(t),!0}const mz="3.3.6",ZK={createComponentInstance:az,setupComponent:cz,renderComponentRoot:mx,setCurrentRenderingInstance:q0,isVNode:Mh,normalizeVNode:_a},qK=ZK,YK=null,JK=null,QK="http://www.w3.org/2000/svg",Ud=typeof document<"u"?document:null,uD=Ud&&Ud.createElement("template"),eX={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,i)=>{const r=e?Ud.createElementNS(QK,t):Ud.createElement(t,n?{is:n}:void 0);return t==="select"&&i&&i.multiple!=null&&r.setAttribute("multiple",i.multiple),r},createText:t=>Ud.createTextNode(t),createComment:t=>Ud.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Ud.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,i,r,o){const l=n?n.previousSibling:e.lastChild;if(r&&(r===o||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),n),!(r===o||!(r=r.nextSibling)););else{uD.innerHTML=i?`<svg>${t}</svg>`:t;const s=uD.content;if(i){const d=s.firstChild;for(;d.firstChild;)s.appendChild(d.firstChild);s.removeChild(d)}e.insertBefore(s,n)}return[l?l.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},qu="transition",Cy="animation",Mm=Symbol("_vtc"),xf=(t,{slots:e})=>a_(MB,yz(t),e);xf.displayName="Transition";const gz={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},tX=xf.props=Hr({},UI,gz),Sd=(t,e=[])=>{Dn(t)?t.forEach(n=>n(...e)):t&&t(...e)},hD=t=>t?Dn(t)?t.some(e=>e.length>1):t.length>1:!1;function yz(t){const e={};for(const be in t)be in gz||(e[be]=t[be]);if(t.css===!1)return e;const{name:n="v",type:i,duration:r,enterFromClass:o=`${n}-enter-from`,enterActiveClass:l=`${n}-enter-active`,enterToClass:s=`${n}-enter-to`,appearFromClass:d=o,appearActiveClass:p=l,appearToClass:y=s,leaveFromClass:v=`${n}-leave-from`,leaveActiveClass:w=`${n}-leave-active`,leaveToClass:T=`${n}-leave-to`}=t,I=nX(r),L=I&&I[0],k=I&&I[1],{onBeforeEnter:F,onEnter:B,onEnterCancelled:G,onLeave:U,onLeaveCancelled:ee,onBeforeAppear:ne=F,onAppear:ye=B,onAppearCancelled:fe=G}=e,J=(be,Te,ke)=>{ch(be,Te?y:s),ch(be,Te?p:l),ke&&ke()},Ce=(be,Te)=>{be._isLeaving=!1,ch(be,v),ch(be,T),ch(be,w),Te&&Te()},me=be=>(Te,ke)=>{const ut=be?ye:B,et=()=>J(Te,be,ke);Sd(ut,[Te,et]),dD(()=>{ch(Te,be?d:o),Bc(Te,be?y:s),hD(ut)||fD(Te,i,L,et)})};return Hr(e,{onBeforeEnter(be){Sd(F,[be]),Bc(be,o),Bc(be,l)},onBeforeAppear(be){Sd(ne,[be]),Bc(be,d),Bc(be,p)},onEnter:me(!1),onAppear:me(!0),onLeave(be,Te){be._isLeaving=!0;const ke=()=>Ce(be,Te);Bc(be,v),_z(),Bc(be,w),dD(()=>{be._isLeaving&&(ch(be,v),Bc(be,T),hD(U)||fD(be,i,k,ke))}),Sd(U,[be,ke])},onEnterCancelled(be){J(be,!1),Sd(G,[be])},onAppearCancelled(be){J(be,!0),Sd(fe,[be])},onLeaveCancelled(be){Ce(be),Sd(ee,[be])}})}function nX(t){if(t==null)return null;if(br(t))return[XT(t.enter),XT(t.leave)];{const e=XT(t);return[e,e]}}function XT(t){return Yx(t)}function Bc(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t[Mm]||(t[Mm]=new Set)).add(e)}function ch(t,e){e.split(/\s+/).forEach(i=>i&&t.classList.remove(i));const n=t[Mm];n&&(n.delete(e),n.size||(t[Mm]=void 0))}function dD(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let iX=0;function fD(t,e,n,i){const r=t._endId=++iX,o=()=>{r===t._endId&&i()};if(n)return setTimeout(o,n);const{type:l,timeout:s,propCount:d}=vz(t,e);if(!l)return i();const p=l+"end";let y=0;const v=()=>{t.removeEventListener(p,w),o()},w=T=>{T.target===t&&++y>=d&&v()};setTimeout(()=>{y<d&&v()},s+1),t.addEventListener(p,w)}function vz(t,e){const n=window.getComputedStyle(t),i=I=>(n[I]||"").split(", "),r=i(`${qu}Delay`),o=i(`${qu}Duration`),l=pD(r,o),s=i(`${Cy}Delay`),d=i(`${Cy}Duration`),p=pD(s,d);let y=null,v=0,w=0;e===qu?l>0&&(y=qu,v=l,w=o.length):e===Cy?p>0&&(y=Cy,v=p,w=d.length):(v=Math.max(l,p),y=v>0?l>p?qu:Cy:null,w=y?y===qu?o.length:d.length:0);const T=y===qu&&/\b(transform|all)(,|$)/.test(i(`${qu}Property`).toString());return{type:y,timeout:v,propCount:w,hasTransform:T}}function pD(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,i)=>mD(n)+mD(t[i])))}function mD(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function _z(){return document.body.offsetHeight}function rX(t,e,n){const i=t[Mm];i&&(e=(e?[e,...i]:[...i]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const ZI=Symbol("_vod"),l_={beforeMount(t,{value:e},{transition:n}){t[ZI]=t.style.display==="none"?"":t.style.display,n&&e?n.beforeEnter(t):Ay(t,e)},mounted(t,{value:e},{transition:n}){n&&e&&n.enter(t)},updated(t,{value:e,oldValue:n},{transition:i}){!e!=!n&&(i?e?(i.beforeEnter(t),Ay(t,!0),i.enter(t)):i.leave(t,()=>{Ay(t,!1)}):Ay(t,e))},beforeUnmount(t,{value:e}){Ay(t,e)}};function Ay(t,e){t.style.display=e?t[ZI]:"none"}function oX(){l_.getSSRProps=({value:t})=>{if(!t)return{style:{display:"none"}}}}function sX(t,e,n){const i=t.style,r=Wr(n);if(n&&!r){if(e&&!Wr(e))for(const o in e)n[o]==null&&lA(i,o,"");for(const o in n)lA(i,o,n[o])}else{const o=i.display;r?e!==n&&(i.cssText=n):e&&t.removeAttribute("style"),ZI in t&&(i.display=o)}}const gD=/\s*!important$/;function lA(t,e,n){if(Dn(n))n.forEach(i=>lA(t,e,i));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const i=aX(t,e);gD.test(n)?t.setProperty(ja(i),n.replace(gD,""),"important"):t[i]=n}}const yD=["Webkit","Moz","ms"],ZT={};function aX(t,e){const n=ZT[e];if(n)return n;let i=qs(e);if(i!=="filter"&&i in t)return ZT[e]=i;i=n_(i);for(let r=0;r<yD.length;r++){const o=yD[r]+i;if(o in t)return ZT[e]=o}return e}const vD="http://www.w3.org/1999/xlink";function lX(t,e,n,i,r){if(i&&e.startsWith("xlink:"))n==null?t.removeAttributeNS(vD,e.slice(6,e.length)):t.setAttributeNS(vD,e,n);else{const o=YH(e);n==null||o&&!nB(n)?t.removeAttribute(e):t.setAttribute(e,o?"":n)}}function cX(t,e,n,i,r,o,l){if(e==="innerHTML"||e==="textContent"){i&&l(i,r,o),t[e]=n??"";return}const s=t.tagName;if(e==="value"&&s!=="PROGRESS"&&!s.includes("-")){t._value=n;const p=s==="OPTION"?t.getAttribute("value"):t.value,y=n??"";p!==y&&(t.value=y),n==null&&t.removeAttribute(e);return}let d=!1;if(n===""||n==null){const p=typeof t[e];p==="boolean"?n=nB(n):n==null&&p==="string"?(n="",d=!0):p==="number"&&(n=0,d=!0)}try{t[e]=n}catch{}d&&t.removeAttribute(e)}function Nc(t,e,n,i){t.addEventListener(e,n,i)}function uX(t,e,n,i){t.removeEventListener(e,n,i)}const _D=Symbol("_vei");function hX(t,e,n,i,r=null){const o=t[_D]||(t[_D]={}),l=o[e];if(i&&l)l.value=i;else{const[s,d]=dX(e);if(i){const p=o[e]=mX(i,r);Nc(t,s,p,d)}else l&&(uX(t,s,l,d),o[e]=void 0)}}const bD=/(?:Once|Passive|Capture)$/;function dX(t){let e;if(bD.test(t)){e={};let i;for(;i=t.match(bD);)t=t.slice(0,t.length-i[0].length),e[i[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):ja(t.slice(2)),e]}let qT=0;const fX=Promise.resolve(),pX=()=>qT||(fX.then(()=>qT=0),qT=Date.now());function mX(t,e){const n=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=n.attached)return;Ta(gX(i,n.value),e,5,[i])};return n.value=t,n.attached=pX(),n}function gX(t,e){if(Dn(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(i=>r=>!r._stopped&&i&&i(r))}else return e}const xD=/^on[a-z]/,yX=(t,e,n,i,r=!1,o,l,s,d)=>{e==="class"?rX(t,i,r):e==="style"?sX(t,n,i):t_(e)?xI(e)||hX(t,e,n,i,l):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):vX(t,e,i,r))?cX(t,e,i,o,l,s,d):(e==="true-value"?t._trueValue=i:e==="false-value"&&(t._falseValue=i),lX(t,e,i,r))};function vX(t,e,n,i){return i?!!(e==="innerHTML"||e==="textContent"||e in t&&xD.test(e)&&pi(n)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||xD.test(e)&&Wr(n)?!1:e in t}/*! #__NO_SIDE_EFFECTS__ */function bz(t,e){const n=pr(t);class i extends x2{constructor(o){super(n,o,e)}}return i.def=n,i}/*! #__NO_SIDE_EFFECTS__ */const _X=t=>bz(t,Lz),bX=typeof HTMLElement<"u"?HTMLElement:class{};class x2 extends bX{constructor(e,n={},i){super(),this._def=e,this._props=n,this._instance=null,this._connected=!1,this._resolved=!1,this._numberProps=null,this._ob=null,this.shadowRoot&&i?i(this._createVNode(),this.shadowRoot):(this.attachShadow({mode:"open"}),this._def.__asyncLoader||this._resolveProps(this._def))}connectedCallback(){this._connected=!0,this._instance||(this._resolved?this._update():this._resolveDef())}disconnectedCallback(){this._connected=!1,this._ob&&(this._ob.disconnect(),this._ob=null),Ys(()=>{this._connected||(hA(null,this.shadowRoot),this._instance=null)})}_resolveDef(){this._resolved=!0;for(let i=0;i<this.attributes.length;i++)this._setAttr(this.attributes[i].name);this._ob=new MutationObserver(i=>{for(const r of i)this._setAttr(r.attributeName)}),this._ob.observe(this,{attributes:!0});const e=(i,r=!1)=>{const{props:o,styles:l}=i;let s;if(o&&!Dn(o))for(const d in o){const p=o[d];(p===Number||p&&p.type===Number)&&(d in this._props&&(this._props[d]=Yx(this._props[d])),(s||(s=Object.create(null)))[qs(d)]=!0)}this._numberProps=s,r&&this._resolveProps(i),this._applyStyles(l),this._update()},n=this._def.__asyncLoader;n?n().then(i=>e(i,!0)):e(this._def)}_resolveProps(e){const{props:n}=e,i=Dn(n)?n:Object.keys(n||{});for(const r of Object.keys(this))r[0]!=="_"&&i.includes(r)&&this._setProp(r,this[r],!0,!1);for(const r of i.map(qs))Object.defineProperty(this,r,{get(){return this._getProp(r)},set(o){this._setProp(r,o)}})}_setAttr(e){let n=this.getAttribute(e);const i=qs(e);this._numberProps&&this._numberProps[i]&&(n=Yx(n)),this._setProp(i,n,!1)}_getProp(e){return this._props[e]}_setProp(e,n,i=!0,r=!0){n!==this._props[e]&&(this._props[e]=n,r&&this._instance&&this._update(),i&&(n===!0?this.setAttribute(ja(e),""):typeof n=="string"||typeof n=="number"?this.setAttribute(ja(e),n+""):n||this.removeAttribute(ja(e))))}_update(){hA(this._createVNode(),this.shadowRoot)}_createVNode(){const e=Lt(this._def,Hr({},this._props));return this._instance||(e.ce=n=>{this._instance=n,n.isCE=!0;const i=(o,l)=>{this.dispatchEvent(new CustomEvent(o,{detail:l}))};n.emit=(o,...l)=>{i(o,l),ja(o)!==o&&i(ja(o),l)};let r=this;for(;r=r&&(r.parentNode||r.host);)if(r instanceof x2){n.parent=r._instance,n.provides=r._instance.provides;break}}),e}_applyStyles(e){e&&e.forEach(n=>{const i=document.createElement("style");i.textContent=n,this.shadowRoot.appendChild(i)})}}function xX(t="$style"){{const e=pc();if(!e)return _r;const n=e.type.__cssModules;if(!n)return _r;const i=n[t];return i||_r}}function xz(t){const e=pc();if(!e)return;const n=e.ut=(r=t(e.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${e.uid}"]`)).forEach(o=>uA(o,r))},i=()=>{const r=t(e.proxy);cA(e.subTree,r),n(r)};PB(i),Ds(()=>{const r=new MutationObserver(i);r.observe(e.subTree.el.parentNode,{childList:!0}),bf(()=>r.disconnect())})}function cA(t,e){if(t.shapeFlag&128){const n=t.suspense;t=n.activeBranch,n.pendingBranch&&!n.isHydrating&&n.effects.push(()=>{cA(n.activeBranch,e)})}for(;t.component;)t=t.component.subTree;if(t.shapeFlag&1&&t.el)uA(t.el,e);else if(t.type===_n)t.children.forEach(n=>cA(n,e));else if(t.type===qd){let{el:n,anchor:i}=t;for(;n&&(uA(n,e),n!==i);)n=n.nextSibling}}function uA(t,e){if(t.nodeType===1){const n=t.style;for(const i in e)n.setProperty(`--${i}`,e[i])}}const wz=new WeakMap,Ez=new WeakMap,iw=Symbol("_moveCb"),wD=Symbol("_enterCb"),Tz={name:"TransitionGroup",props:Hr({},tX,{tag:String,moveClass:String}),setup(t,{slots:e}){const n=pc(),i=NI();let r,o;return y2(()=>{if(!r.length)return;const l=t.moveClass||`${t.name||"v"}-move`;if(!AX(r[0].el,n.vnode.el,l))return;r.forEach(TX),r.forEach(SX);const s=r.filter(CX);_z(),s.forEach(d=>{const p=d.el,y=p.style;Bc(p,l),y.transform=y.webkitTransform=y.transitionDuration="";const v=p[iw]=w=>{w&&w.target!==p||(!w||/transform$/.test(w.propertyName))&&(p.removeEventListener("transitionend",v),p[iw]=null,ch(p,l))};p.addEventListener("transitionend",v)})}),()=>{const l=zi(t),s=yz(l);let d=l.tag||_n;r=o,o=e.default?m2(e.default()):[];for(let p=0;p<o.length;p++){const y=o[p];y.key!=null&&rf(y,Am(y,s,i,n))}if(r)for(let p=0;p<r.length;p++){const y=r[p];rf(y,Am(y,s,i,n)),wz.set(y,y.el.getBoundingClientRect())}return Lt(d,null,o)}}},wX=t=>delete t.mode;Tz.props;const EX=Tz;function TX(t){const e=t.el;e[iw]&&e[iw](),e[wD]&&e[wD]()}function SX(t){Ez.set(t,t.el.getBoundingClientRect())}function CX(t){const e=wz.get(t),n=Ez.get(t),i=e.left-n.left,r=e.top-n.top;if(i||r){const o=t.el.style;return o.transform=o.webkitTransform=`translate(${i}px,${r}px)`,o.transitionDuration="0s",t}}function AX(t,e,n){const i=t.cloneNode(),r=t[Mm];r&&r.forEach(s=>{s.split(/\s+/).forEach(d=>d&&i.classList.remove(d))}),n.split(/\s+/).forEach(s=>s&&i.classList.add(s)),i.style.display="none";const o=e.nodeType===1?e:e.parentNode;o.appendChild(i);const{hasTransform:l}=vz(i);return o.removeChild(i),l}const Lh=t=>{const e=t.props["onUpdate:modelValue"]||!1;return Dn(e)?n=>cm(e,n):e};function PX(t){t.target.composing=!0}function ED(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const $a=Symbol("_assign"),rw={created(t,{modifiers:{lazy:e,trim:n,number:i}},r){t[$a]=Lh(r);const o=i||r.props&&r.props.type==="number";Nc(t,e?"change":"input",l=>{if(l.target.composing)return;let s=t.value;n&&(s=s.trim()),o&&(s=qx(s)),t[$a](s)}),n&&Nc(t,"change",()=>{t.value=t.value.trim()}),e||(Nc(t,"compositionstart",PX),Nc(t,"compositionend",ED),Nc(t,"change",ED))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,modifiers:{lazy:n,trim:i,number:r}},o){if(t[$a]=Lh(o),t.composing||document.activeElement===t&&t.type!=="range"&&(n||i&&t.value.trim()===e||(r||t.type==="number")&&qx(t.value)===e))return;const l=e??"";t.value!==l&&(t.value=l)}},qI={deep:!0,created(t,e,n){t[$a]=Lh(n),Nc(t,"change",()=>{const i=t._modelValue,r=Rm(t),o=t.checked,l=t[$a];if(Dn(i)){const s=s2(i,r),d=s!==-1;if(o&&!d)l(i.concat(r));else if(!o&&d){const p=[...i];p.splice(s,1),l(p)}}else if(vf(i)){const s=new Set(i);o?s.add(r):s.delete(r),l(s)}else l(Cz(t,o))})},mounted:TD,beforeUpdate(t,e,n){t[$a]=Lh(n),TD(t,e,n)}};function TD(t,{value:e,oldValue:n},i){t._modelValue=e,Dn(e)?t.checked=s2(e,i.props.value)>-1:vf(e)?t.checked=e.has(i.props.value):e!==n&&(t.checked=Ph(e,Cz(t,!0)))}const YI={created(t,{value:e},n){t.checked=Ph(e,n.props.value),t[$a]=Lh(n),Nc(t,"change",()=>{t[$a](Rm(t))})},beforeUpdate(t,{value:e,oldValue:n},i){t[$a]=Lh(i),e!==n&&(t.checked=Ph(e,i.props.value))}},Sz={deep:!0,created(t,{value:e,modifiers:{number:n}},i){const r=vf(e);Nc(t,"change",()=>{const o=Array.prototype.filter.call(t.options,l=>l.selected).map(l=>n?qx(Rm(l)):Rm(l));t[$a](t.multiple?r?new Set(o):o:o[0])}),t[$a]=Lh(i)},mounted(t,{value:e}){SD(t,e)},beforeUpdate(t,e,n){t[$a]=Lh(n)},updated(t,{value:e}){SD(t,e)}};function SD(t,e){const n=t.multiple;if(!(n&&!Dn(e)&&!vf(e))){for(let i=0,r=t.options.length;i<r;i++){const o=t.options[i],l=Rm(o);if(n)Dn(e)?o.selected=s2(e,l)>-1:o.selected=e.has(l);else if(Ph(Rm(o),e)){t.selectedIndex!==i&&(t.selectedIndex=i);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function Rm(t){return"_value"in t?t._value:t.value}function Cz(t,e){const n=e?"_trueValue":"_falseValue";return n in t?t[n]:e}const Az={created(t,e,n){fb(t,e,n,null,"created")},mounted(t,e,n){fb(t,e,n,null,"mounted")},beforeUpdate(t,e,n,i){fb(t,e,n,i,"beforeUpdate")},updated(t,e,n,i){fb(t,e,n,i,"updated")}};function Pz(t,e){switch(t){case"SELECT":return Sz;case"TEXTAREA":return rw;default:switch(e){case"checkbox":return qI;case"radio":return YI;default:return rw}}}function fb(t,e,n,i,r){const l=Pz(t.tagName,n.props&&n.props.type)[r];l&&l(t,e,n,i)}function IX(){rw.getSSRProps=({value:t})=>({value:t}),YI.getSSRProps=({value:t},e)=>{if(e.props&&Ph(e.props.value,t))return{checked:!0}},qI.getSSRProps=({value:t},e)=>{if(Dn(t)){if(e.props&&s2(t,e.props.value)>-1)return{checked:!0}}else if(vf(t)){if(e.props&&t.has(e.props.value))return{checked:!0}}else if(t)return{checked:!0}},Az.getSSRProps=(t,e)=>{if(typeof e.type!="string")return;const n=Pz(e.type.toUpperCase(),e.props&&e.props.type);if(n.getSSRProps)return n.getSSRProps(t,e)}}const MX=["ctrl","shift","alt","meta"],RX={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>MX.some(n=>t[`${n}Key`]&&!e.includes(n))},c_=(t,e)=>(n,...i)=>{for(let r=0;r<e.length;r++){const o=RX[e[r]];if(o&&o(n,e))return}return t(n,...i)},LX={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},fm=(t,e)=>n=>{if(!("key"in n))return;const i=ja(n.key);if(e.some(r=>r===i||LX[r]===i))return t(n)},Iz=Hr({patchProp:yX},eX);let T0,CD=!1;function Mz(){return T0||(T0=QB(Iz))}function Rz(){return T0=CD?T0:ez(Iz),CD=!0,T0}const hA=(...t)=>{Mz().render(...t)},Lz=(...t)=>{Rz().hydrate(...t)},Oz=(...t)=>{const e=Mz().createApp(...t),{mount:n}=e;return e.mount=i=>{const r=Dz(i);if(!r)return;const o=e._component;!pi(o)&&!o.render&&!o.template&&(o.template=r.innerHTML),r.innerHTML="";const l=n(r,!1,r instanceof SVGElement);return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),l},e},OX=(...t)=>{const e=Rz().createApp(...t),{mount:n}=e;return e.mount=i=>{const r=Dz(i);if(r)return n(r,!0,r instanceof SVGElement)},e};function Dz(t){return Wr(t)?document.querySelector(t):t}let AD=!1;const DX=()=>{AD||(AD=!0,IX(),oX())},kX=()=>{},FX=Object.defineProperty({__proto__:null,BaseTransition:MB,BaseTransitionPropsValidators:UI,Comment:xs,EffectScope:SI,Fragment:_n,KeepAlive:LB,ReactiveEffect:Cm,Static:qd,Suspense:KW,Teleport:nz,Text:of,Transition:xf,TransitionGroup:EX,VueElement:x2,assertNumber:kW,callWithAsyncErrorHandling:Ta,callWithErrorHandling:Zc,camelize:qs,capitalize:n_,cloneVNode:hc,compatUtils:JK,compile:kX,computed:ur,createApp:Oz,createBlock:Rt,createCommentVNode:Jt,createElementBlock:Ue,createElementVNode:Qe,createHydrationRenderer:ez,createPropsRestProxy:_K,createRenderer:QB,createSSRApp:OX,createSlots:Pm,createStaticVNode:WI,createTextVNode:vo,createVNode:Lt,customRef:PW,defineAsyncComponent:iK,defineComponent:pr,defineCustomElement:bz,defineEmits:cK,defineExpose:uK,defineModel:fK,defineOptions:hK,defineProps:lK,defineSSRCustomElement:_X,defineSlots:dK,get devtools(){return jp},effect:tW,effectScope:CI,getCurrentInstance:pc,getCurrentScope:AI,getTransitionRawChildren:m2,guardReactiveProps:E0,h:a_,handleError:_f,hasInjectionContext:KB,hydrate:Lz,initCustomFormatter:KK,initDirectivesForSSR:DX,inject:$r,isMemoSame:pz,isProxy:RI,isReactive:Xc,isReadonly:nf,isRef:Rr,isRuntimeOnly:GK,isShallow:W0,isVNode:Mh,markRaw:i_,mergeDefaults:yK,mergeModels:vK,mergeProps:Le,nextTick:Ys,normalizeClass:ri,normalizeProps:um,normalizeStyle:tf,onActivated:OB,onBeforeMount:FB,onBeforeUnmount:v2,onBeforeUpdate:BB,onDeactivated:DB,onErrorCaptured:VB,onMounted:Ds,onRenderTracked:UB,onRenderTriggered:NB,onScopeDispose:oB,onServerPrefetch:zB,onUnmounted:bf,onUpdated:y2,openBlock:le,popScopeId:cu,provide:Os,proxyRefs:DI,pushScopeId:lu,queuePostFlushCb:FI,reactive:Ao,readonly:c2,ref:$n,registerRuntimeCompiler:$K,render:hA,renderList:or,renderSlot:Xn,resolveComponent:Gn,resolveDirective:ea,resolveDynamicComponent:Zn,resolveFilter:YK,resolveTransitionHooks:Am,setBlockTracking:rA,setDevtoolsHook:TB,setTransitionHooks:rf,shallowReactive:MI,shallowReadonly:wW,shallowRef:vB,ssrContextKey:dz,ssrUtils:qK,stop:nW,toDisplayString:ki,toHandlerKey:_0,toHandlers:e0,toRaw:zi,toRef:RW,toRefs:Wp,toValue:SW,transformVNodeArgs:zK,triggerRef:TW,unref:Yt,useAttrs:s_,useCssModule:xX,useCssVars:xz,useModel:gK,useSSRContext:fz,useSlots:mK,useTransitionState:NI,vModelCheckbox:qI,vModelDynamic:Az,vModelRadio:YI,vModelSelect:Sz,vModelText:rw,vShow:l_,version:mz,warn:DW,watch:Ri,watchEffect:QW,watchPostEffect:PB,watchSyncEffect:eK,withAsyncContext:bK,withCtx:Cn,withDefaults:pK,withDirectives:fo,withKeys:fm,withMemo:XK,withModifiers:c_,withScopeId:VW},Symbol.toStringTag,{value:"Module"});var BX=!1;/*!
 * pinia v2.1.7
 * (c) 2023 Eduardo San Martin Morote
 * @license MIT
 */let kz;const w2=t=>kz=t,Fz=Symbol();function dA(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var S0;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(S0||(S0={}));function zX(){const t=CI(!0),e=t.run(()=>$n({}));let n=[],i=[];const r=i_({install(o){w2(r),r._a=o,o.provide(Fz,r),o.config.globalProperties.$pinia=r,i.forEach(l=>n.push(l)),i=[]},use(o){return!this._a&&!BX?i.push(o):n.push(o),this},_p:n,_a:null,_e:t,_s:new Map,state:e});return r}const Bz=()=>{};function PD(t,e,n,i=Bz){t.push(e);const r=()=>{const o=t.indexOf(e);o>-1&&(t.splice(o,1),i())};return!n&&AI()&&oB(r),r}function Tp(t,...e){t.slice().forEach(n=>{n(...e)})}const NX=t=>t();function fA(t,e){t instanceof Map&&e instanceof Map&&e.forEach((n,i)=>t.set(i,n)),t instanceof Set&&e instanceof Set&&e.forEach(t.add,t);for(const n in e){if(!e.hasOwnProperty(n))continue;const i=e[n],r=t[n];dA(r)&&dA(i)&&t.hasOwnProperty(n)&&!Rr(i)&&!Xc(i)?t[n]=fA(r,i):t[n]=i}return t}const UX=Symbol();function VX(t){return!dA(t)||!t.hasOwnProperty(UX)}const{assign:uh}=Object;function jX(t){return!!(Rr(t)&&t.effect)}function $X(t,e,n,i){const{state:r,actions:o,getters:l}=e,s=n.state.value[t];let d;function p(){s||(n.state.value[t]=r?r():{});const y=Wp(n.state.value[t]);return uh(y,o,Object.keys(l||{}).reduce((v,w)=>(v[w]=i_(ur(()=>{w2(n);const T=n._s.get(t);return l[w].call(T,T)})),v),{}))}return d=zz(t,p,e,n,i,!0),d}function zz(t,e,n={},i,r,o){let l;const s=uh({actions:{}},n),d={deep:!0};let p,y,v=[],w=[],T;const I=i.state.value[t];!o&&!I&&(i.state.value[t]={}),$n({});let L;function k(fe){let J;p=y=!1,typeof fe=="function"?(fe(i.state.value[t]),J={type:S0.patchFunction,storeId:t,events:T}):(fA(i.state.value[t],fe),J={type:S0.patchObject,payload:fe,storeId:t,events:T});const Ce=L=Symbol();Ys().then(()=>{L===Ce&&(p=!0)}),y=!0,Tp(v,J,i.state.value[t])}const F=o?function(){const{state:J}=n,Ce=J?J():{};this.$patch(me=>{uh(me,Ce)})}:Bz;function B(){l.stop(),v=[],w=[],i._s.delete(t)}function G(fe,J){return function(){w2(i);const Ce=Array.from(arguments),me=[],be=[];function Te(et){me.push(et)}function ke(et){be.push(et)}Tp(w,{args:Ce,name:fe,store:ee,after:Te,onError:ke});let ut;try{ut=J.apply(this&&this.$id===t?this:ee,Ce)}catch(et){throw Tp(be,et),et}return ut instanceof Promise?ut.then(et=>(Tp(me,et),et)).catch(et=>(Tp(be,et),Promise.reject(et))):(Tp(me,ut),ut)}}const U={_p:i,$id:t,$onAction:PD.bind(null,w),$patch:k,$reset:F,$subscribe(fe,J={}){const Ce=PD(v,fe,J.detached,()=>me()),me=l.run(()=>Ri(()=>i.state.value[t],be=>{(J.flush==="sync"?y:p)&&fe({storeId:t,type:S0.direct,events:T},be)},uh({},d,J)));return Ce},$dispose:B},ee=Ao(U);i._s.set(t,ee);const ye=(i._a&&i._a.runWithContext||NX)(()=>i._e.run(()=>(l=CI()).run(e)));for(const fe in ye){const J=ye[fe];if(Rr(J)&&!jX(J)||Xc(J))o||(I&&VX(J)&&(Rr(J)?J.value=I[fe]:fA(J,I[fe])),i.state.value[t][fe]=J);else if(typeof J=="function"){const Ce=G(fe,J);ye[fe]=Ce,s.actions[fe]=J}}return uh(ee,ye),uh(zi(ee),ye),Object.defineProperty(ee,"$state",{get:()=>i.state.value[t],set:fe=>{k(J=>{uh(J,fe)})}}),i._p.forEach(fe=>{uh(ee,l.run(()=>fe({store:ee,app:i._a,pinia:i,options:s})))}),I&&o&&n.hydrate&&n.hydrate(ee.$state,I),p=!0,y=!0,ee}function E2(t,e,n){let i,r;const o=typeof e=="function";typeof t=="string"?(i=t,r=o?n:e):(r=t,i=t.id);function l(s,d){const p=KB();return s=s||(p?$r(Fz,null):null),s&&w2(s),s=kz,s._s.has(i)||(o?zz(i,e,r,s):$X(i,r,s)),s._s.get(i)}return l.$id=i,l}function yx(t,e){return Array.isArray(e)?e.reduce((n,i)=>(n[i]=function(){return t(this.$pinia)[i]},n),{}):Object.keys(e).reduce((n,i)=>(n[i]=function(){const r=t(this.$pinia),o=e[i];return typeof o=="function"?o.call(this,r):r[o]},n),{})}var Nz=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function u_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Uz(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var r=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(n,i,r.get?r:{enumerable:!0,get:function(){return t[i]}})}),n}var JI={exports:{}},Vz=function(e,n){return function(){for(var r=new Array(arguments.length),o=0;o<r.length;o++)r[o]=arguments[o];return e.apply(n,r)}},GX=Vz,jh=Object.prototype.toString;function QI(t){return Array.isArray(t)}function pA(t){return typeof t>"u"}function HX(t){return t!==null&&!pA(t)&&t.constructor!==null&&!pA(t.constructor)&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}function jz(t){return jh.call(t)==="[object ArrayBuffer]"}function WX(t){return jh.call(t)==="[object FormData]"}function KX(t){var e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&jz(t.buffer),e}function XX(t){return typeof t=="string"}function ZX(t){return typeof t=="number"}function $z(t){return t!==null&&typeof t=="object"}function vx(t){if(jh.call(t)!=="[object Object]")return!1;var e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}function qX(t){return jh.call(t)==="[object Date]"}function YX(t){return jh.call(t)==="[object File]"}function JX(t){return jh.call(t)==="[object Blob]"}function Gz(t){return jh.call(t)==="[object Function]"}function QX(t){return $z(t)&&Gz(t.pipe)}function eZ(t){return jh.call(t)==="[object URLSearchParams]"}function tZ(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function nZ(){return typeof navigator<"u"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window<"u"&&typeof document<"u"}function eM(t,e){if(!(t===null||typeof t>"u"))if(typeof t!="object"&&(t=[t]),QI(t))for(var n=0,i=t.length;n<i;n++)e.call(null,t[n],n,t);else for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.call(null,t[r],r,t)}function mA(){var t={};function e(r,o){vx(t[o])&&vx(r)?t[o]=mA(t[o],r):vx(r)?t[o]=mA({},r):QI(r)?t[o]=r.slice():t[o]=r}for(var n=0,i=arguments.length;n<i;n++)eM(arguments[n],e);return t}function iZ(t,e,n){return eM(e,function(r,o){n&&typeof r=="function"?t[o]=GX(r,n):t[o]=r}),t}function rZ(t){return t.charCodeAt(0)===65279&&(t=t.slice(1)),t}var ta={isArray:QI,isArrayBuffer:jz,isBuffer:HX,isFormData:WX,isArrayBufferView:KX,isString:XX,isNumber:ZX,isObject:$z,isPlainObject:vx,isUndefined:pA,isDate:qX,isFile:YX,isBlob:JX,isFunction:Gz,isStream:QX,isURLSearchParams:eZ,isStandardBrowserEnv:nZ,forEach:eM,merge:mA,extend:iZ,trim:tZ,stripBOM:rZ},Sp=ta;function ID(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var Hz=function(e,n,i){if(!n)return e;var r;if(i)r=i(n);else if(Sp.isURLSearchParams(n))r=n.toString();else{var o=[];Sp.forEach(n,function(d,p){d===null||typeof d>"u"||(Sp.isArray(d)?p=p+"[]":d=[d],Sp.forEach(d,function(v){Sp.isDate(v)?v=v.toISOString():Sp.isObject(v)&&(v=JSON.stringify(v)),o.push(ID(p)+"="+ID(v))}))}),r=o.join("&")}if(r){var l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+r}return e},oZ=ta;function T2(){this.handlers=[]}T2.prototype.use=function(e,n,i){return this.handlers.push({fulfilled:e,rejected:n,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1};T2.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)};T2.prototype.forEach=function(e){oZ.forEach(this.handlers,function(i){i!==null&&e(i)})};var sZ=T2,aZ=ta,lZ=function(e,n){aZ.forEach(e,function(r,o){o!==n&&o.toUpperCase()===n.toUpperCase()&&(e[n]=r,delete e[o])})},Wz=function(e,n,i,r,o){return e.config=n,i&&(e.code=i),e.request=r,e.response=o,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},e},Kz={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},YT,MD;function Xz(){if(MD)return YT;MD=1;var t=Wz;return YT=function(n,i,r,o,l){var s=new Error(n);return t(s,i,r,o,l)},YT}var JT,RD;function cZ(){if(RD)return JT;RD=1;var t=Xz();return JT=function(n,i,r){var o=r.config.validateStatus;!r.status||!o||o(r.status)?n(r):i(t("Request failed with status code "+r.status,r.config,null,r.request,r))},JT}var QT,LD;function uZ(){if(LD)return QT;LD=1;var t=ta;return QT=t.isStandardBrowserEnv()?function(){return{write:function(i,r,o,l,s,d){var p=[];p.push(i+"="+encodeURIComponent(r)),t.isNumber(o)&&p.push("expires="+new Date(o).toGMTString()),t.isString(l)&&p.push("path="+l),t.isString(s)&&p.push("domain="+s),d===!0&&p.push("secure"),document.cookie=p.join("; ")},read:function(i){var r=document.cookie.match(new RegExp("(^|;\\s*)("+i+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove:function(i){this.write(i,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),QT}var eS,OD;function hZ(){return OD||(OD=1,eS=function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}),eS}var tS,DD;function dZ(){return DD||(DD=1,tS=function(e,n){return n?e.replace(/\/+$/,"")+"/"+n.replace(/^\/+/,""):e}),tS}var nS,kD;function fZ(){if(kD)return nS;kD=1;var t=hZ(),e=dZ();return nS=function(i,r){return i&&!t(r)?e(i,r):r},nS}var iS,FD;function pZ(){if(FD)return iS;FD=1;var t=ta,e=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];return iS=function(i){var r={},o,l,s;return i&&t.forEach(i.split(`
`),function(p){if(s=p.indexOf(":"),o=t.trim(p.substr(0,s)).toLowerCase(),l=t.trim(p.substr(s+1)),o){if(r[o]&&e.indexOf(o)>=0)return;o==="set-cookie"?r[o]=(r[o]?r[o]:[]).concat([l]):r[o]=r[o]?r[o]+", "+l:l}}),r},iS}var rS,BD;function mZ(){if(BD)return rS;BD=1;var t=ta;return rS=t.isStandardBrowserEnv()?function(){var n=/(msie|trident)/i.test(navigator.userAgent),i=document.createElement("a"),r;function o(l){var s=l;return n&&(i.setAttribute("href",s),s=i.href),i.setAttribute("href",s),{href:i.href,protocol:i.protocol?i.protocol.replace(/:$/,""):"",host:i.host,search:i.search?i.search.replace(/^\?/,""):"",hash:i.hash?i.hash.replace(/^#/,""):"",hostname:i.hostname,port:i.port,pathname:i.pathname.charAt(0)==="/"?i.pathname:"/"+i.pathname}}return r=o(window.location.href),function(s){var d=t.isString(s)?o(s):s;return d.protocol===r.protocol&&d.host===r.host}}():function(){return function(){return!0}}(),rS}var oS,zD;function S2(){if(zD)return oS;zD=1;function t(e){this.message=e}return t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,oS=t,oS}var sS,ND;function UD(){if(ND)return sS;ND=1;var t=ta,e=cZ(),n=uZ(),i=Hz,r=fZ(),o=pZ(),l=mZ(),s=Xz(),d=Kz,p=S2();return sS=function(v){return new Promise(function(T,I){var L=v.data,k=v.headers,F=v.responseType,B;function G(){v.cancelToken&&v.cancelToken.unsubscribe(B),v.signal&&v.signal.removeEventListener("abort",B)}t.isFormData(L)&&delete k["Content-Type"];var U=new XMLHttpRequest;if(v.auth){var ee=v.auth.username||"",ne=v.auth.password?unescape(encodeURIComponent(v.auth.password)):"";k.Authorization="Basic "+btoa(ee+":"+ne)}var ye=r(v.baseURL,v.url);U.open(v.method.toUpperCase(),i(ye,v.params,v.paramsSerializer),!0),U.timeout=v.timeout;function fe(){if(U){var Ce="getAllResponseHeaders"in U?o(U.getAllResponseHeaders()):null,me=!F||F==="text"||F==="json"?U.responseText:U.response,be={data:me,status:U.status,statusText:U.statusText,headers:Ce,config:v,request:U};e(function(ke){T(ke),G()},function(ke){I(ke),G()},be),U=null}}if("onloadend"in U?U.onloadend=fe:U.onreadystatechange=function(){!U||U.readyState!==4||U.status===0&&!(U.responseURL&&U.responseURL.indexOf("file:")===0)||setTimeout(fe)},U.onabort=function(){U&&(I(s("Request aborted",v,"ECONNABORTED",U)),U=null)},U.onerror=function(){I(s("Network Error",v,null,U)),U=null},U.ontimeout=function(){var me=v.timeout?"timeout of "+v.timeout+"ms exceeded":"timeout exceeded",be=v.transitional||d;v.timeoutErrorMessage&&(me=v.timeoutErrorMessage),I(s(me,v,be.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",U)),U=null},t.isStandardBrowserEnv()){var J=(v.withCredentials||l(ye))&&v.xsrfCookieName?n.read(v.xsrfCookieName):void 0;J&&(k[v.xsrfHeaderName]=J)}"setRequestHeader"in U&&t.forEach(k,function(me,be){typeof L>"u"&&be.toLowerCase()==="content-type"?delete k[be]:U.setRequestHeader(be,me)}),t.isUndefined(v.withCredentials)||(U.withCredentials=!!v.withCredentials),F&&F!=="json"&&(U.responseType=v.responseType),typeof v.onDownloadProgress=="function"&&U.addEventListener("progress",v.onDownloadProgress),typeof v.onUploadProgress=="function"&&U.upload&&U.upload.addEventListener("progress",v.onUploadProgress),(v.cancelToken||v.signal)&&(B=function(Ce){U&&(I(!Ce||Ce&&Ce.type?new p("canceled"):Ce),U.abort(),U=null)},v.cancelToken&&v.cancelToken.subscribe(B),v.signal&&(v.signal.aborted?B():v.signal.addEventListener("abort",B))),L||(L=null),U.send(L)})},sS}var ts=ta,VD=lZ,gZ=Wz,yZ=Kz,vZ={"Content-Type":"application/x-www-form-urlencoded"};function jD(t,e){!ts.isUndefined(t)&&ts.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}function _Z(){var t;return(typeof XMLHttpRequest<"u"||typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]")&&(t=UD()),t}function bZ(t,e,n){if(ts.isString(t))try{return(e||JSON.parse)(t),ts.trim(t)}catch(i){if(i.name!=="SyntaxError")throw i}return(n||JSON.stringify)(t)}var C2={transitional:yZ,adapter:_Z(),transformRequest:[function(e,n){return VD(n,"Accept"),VD(n,"Content-Type"),ts.isFormData(e)||ts.isArrayBuffer(e)||ts.isBuffer(e)||ts.isStream(e)||ts.isFile(e)||ts.isBlob(e)?e:ts.isArrayBufferView(e)?e.buffer:ts.isURLSearchParams(e)?(jD(n,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):ts.isObject(e)||n&&n["Content-Type"]==="application/json"?(jD(n,"application/json"),bZ(e)):e}],transformResponse:[function(e){var n=this.transitional||C2.transitional,i=n&&n.silentJSONParsing,r=n&&n.forcedJSONParsing,o=!i&&this.responseType==="json";if(o||r&&ts.isString(e)&&e.length)try{return JSON.parse(e)}catch(l){if(o)throw l.name==="SyntaxError"?gZ(l,this,"E_JSON_PARSE"):l}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};ts.forEach(["delete","get","head"],function(e){C2.headers[e]={}});ts.forEach(["post","put","patch"],function(e){C2.headers[e]=ts.merge(vZ)});var tM=C2,xZ=ta,wZ=tM,EZ=function(e,n,i){var r=this||wZ;return xZ.forEach(i,function(l){e=l.call(r,e,n)}),e},aS,$D;function Zz(){return $D||($D=1,aS=function(e){return!!(e&&e.__CANCEL__)}),aS}var GD=ta,lS=EZ,TZ=Zz(),SZ=tM,CZ=S2();function cS(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new CZ("canceled")}var AZ=function(e){cS(e),e.headers=e.headers||{},e.data=lS.call(e,e.data,e.headers,e.transformRequest),e.headers=GD.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),GD.forEach(["delete","get","head","post","put","patch","common"],function(r){delete e.headers[r]});var n=e.adapter||SZ.adapter;return n(e).then(function(r){return cS(e),r.data=lS.call(e,r.data,r.headers,e.transformResponse),r},function(r){return TZ(r)||(cS(e),r&&r.response&&(r.response.data=lS.call(e,r.response.data,r.response.headers,e.transformResponse))),Promise.reject(r)})},ha=ta,qz=function(e,n){n=n||{};var i={};function r(y,v){return ha.isPlainObject(y)&&ha.isPlainObject(v)?ha.merge(y,v):ha.isPlainObject(v)?ha.merge({},v):ha.isArray(v)?v.slice():v}function o(y){if(ha.isUndefined(n[y])){if(!ha.isUndefined(e[y]))return r(void 0,e[y])}else return r(e[y],n[y])}function l(y){if(!ha.isUndefined(n[y]))return r(void 0,n[y])}function s(y){if(ha.isUndefined(n[y])){if(!ha.isUndefined(e[y]))return r(void 0,e[y])}else return r(void 0,n[y])}function d(y){if(y in n)return r(e[y],n[y]);if(y in e)return r(void 0,e[y])}var p={url:l,method:l,data:l,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:d};return ha.forEach(Object.keys(e).concat(Object.keys(n)),function(v){var w=p[v]||o,T=w(v);ha.isUndefined(T)&&w!==d||(i[v]=T)}),i},uS,HD;function Yz(){return HD||(HD=1,uS={version:"0.26.1"}),uS}var PZ=Yz().version,nM={};["object","boolean","number","function","string","symbol"].forEach(function(t,e){nM[t]=function(i){return typeof i===t||"a"+(e<1?"n ":" ")+t}});var WD={};nM.transitional=function(e,n,i){function r(o,l){return"[Axios v"+PZ+"] Transitional option '"+o+"'"+l+(i?". "+i:"")}return function(o,l,s){if(e===!1)throw new Error(r(l," has been removed"+(n?" in "+n:"")));return n&&!WD[l]&&(WD[l]=!0,console.warn(r(l," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(o,l,s):!0}};function IZ(t,e,n){if(typeof t!="object")throw new TypeError("options must be an object");for(var i=Object.keys(t),r=i.length;r-- >0;){var o=i[r],l=e[o];if(l){var s=t[o],d=s===void 0||l(s,o,t);if(d!==!0)throw new TypeError("option "+o+" must be "+d);continue}if(n!==!0)throw Error("Unknown option "+o)}}var MZ={assertOptions:IZ,validators:nM},Jz=ta,RZ=Hz,KD=sZ,XD=AZ,A2=qz,Qz=MZ,Cp=Qz.validators;function h_(t){this.defaults=t,this.interceptors={request:new KD,response:new KD}}h_.prototype.request=function(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=A2(this.defaults,n),n.method?n.method=n.method.toLowerCase():this.defaults.method?n.method=this.defaults.method.toLowerCase():n.method="get";var i=n.transitional;i!==void 0&&Qz.assertOptions(i,{silentJSONParsing:Cp.transitional(Cp.boolean),forcedJSONParsing:Cp.transitional(Cp.boolean),clarifyTimeoutError:Cp.transitional(Cp.boolean)},!1);var r=[],o=!0;this.interceptors.request.forEach(function(T){typeof T.runWhen=="function"&&T.runWhen(n)===!1||(o=o&&T.synchronous,r.unshift(T.fulfilled,T.rejected))});var l=[];this.interceptors.response.forEach(function(T){l.push(T.fulfilled,T.rejected)});var s;if(!o){var d=[XD,void 0];for(Array.prototype.unshift.apply(d,r),d=d.concat(l),s=Promise.resolve(n);d.length;)s=s.then(d.shift(),d.shift());return s}for(var p=n;r.length;){var y=r.shift(),v=r.shift();try{p=y(p)}catch(w){v(w);break}}try{s=XD(p)}catch(w){return Promise.reject(w)}for(;l.length;)s=s.then(l.shift(),l.shift());return s};h_.prototype.getUri=function(e){return e=A2(this.defaults,e),RZ(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")};Jz.forEach(["delete","get","head","options"],function(e){h_.prototype[e]=function(n,i){return this.request(A2(i||{},{method:e,url:n,data:(i||{}).data}))}});Jz.forEach(["post","put","patch"],function(e){h_.prototype[e]=function(n,i,r){return this.request(A2(r||{},{method:e,url:n,data:i}))}});var LZ=h_,hS,ZD;function OZ(){if(ZD)return hS;ZD=1;var t=S2();function e(n){if(typeof n!="function")throw new TypeError("executor must be a function.");var i;this.promise=new Promise(function(l){i=l});var r=this;this.promise.then(function(o){if(r._listeners){var l,s=r._listeners.length;for(l=0;l<s;l++)r._listeners[l](o);r._listeners=null}}),this.promise.then=function(o){var l,s=new Promise(function(d){r.subscribe(d),l=d}).then(o);return s.cancel=function(){r.unsubscribe(l)},s},n(function(l){r.reason||(r.reason=new t(l),i(r.reason))})}return e.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},e.prototype.subscribe=function(i){if(this.reason){i(this.reason);return}this._listeners?this._listeners.push(i):this._listeners=[i]},e.prototype.unsubscribe=function(i){if(this._listeners){var r=this._listeners.indexOf(i);r!==-1&&this._listeners.splice(r,1)}},e.source=function(){var i,r=new e(function(l){i=l});return{token:r,cancel:i}},hS=e,hS}var dS,qD;function DZ(){return qD||(qD=1,dS=function(e){return function(i){return e.apply(null,i)}}),dS}var fS,YD;function kZ(){if(YD)return fS;YD=1;var t=ta;return fS=function(n){return t.isObject(n)&&n.isAxiosError===!0},fS}var JD=ta,FZ=Vz,_x=LZ,BZ=qz,zZ=tM;function eN(t){var e=new _x(t),n=FZ(_x.prototype.request,e);return JD.extend(n,_x.prototype,e),JD.extend(n,e),n.create=function(r){return eN(BZ(t,r))},n}var mc=eN(zZ);mc.Axios=_x;mc.Cancel=S2();mc.CancelToken=OZ();mc.isCancel=Zz();mc.VERSION=Yz().version;mc.all=function(e){return Promise.all(e)};mc.spread=DZ();mc.isAxiosError=kZ();JI.exports=mc;JI.exports.default=mc;var NZ=JI.exports,UZ=NZ;const ps=u_(UZ);function ow(t){return ow=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ow(t)}function bx(t,e){if(!t.vueAxiosInstalled){var n=tN(e)?$Z(e):e;if(GZ(n)){var i=HZ(t);if(i){var r=i<3?VZ:jZ;Object.keys(n).forEach(function(o){r(t,o,n[o])}),t.vueAxiosInstalled=!0}else console.error("[vue-axios] unknown Vue version")}else console.error("[vue-axios] configuration is invalid, expected options are either <axios_instance> or { <registration_key>: <axios_instance> }")}}function VZ(t,e,n){Object.defineProperty(t.prototype,e,{get:function(){return n}}),t[e]=n}function jZ(t,e,n){t.config.globalProperties[e]=n,t[e]=n}function tN(t){return t&&typeof t.get=="function"&&typeof t.post=="function"}function $Z(t){return{axios:t,$http:t}}function GZ(t){return ow(t)==="object"&&Object.keys(t).every(function(e){return tN(t[e])})}function HZ(t){return t&&t.version&&Number(t.version.split(".")[0])}(typeof exports>"u"?"undefined":ow(exports))=="object"?module.exports=bx:typeof define=="function"&&define.amd?define([],function(){return bx}):window.Vue&&window.axios&&window.Vue.use&&Vue.use(bx,window.axios);function pS(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=iM(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(p){throw p},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,l=!1,s;return{s:function(){n=n.call(t)},n:function(){var p=n.next();return o=p.done,p},e:function(p){l=!0,s=p},f:function(){try{!o&&n.return!=null&&n.return()}finally{if(l)throw s}}}}function WZ(t){return ZZ(t)||XZ(t)||iM(t)||KZ()}function KZ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XZ(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function ZZ(t){if(Array.isArray(t))return gA(t)}function C0(t){"@babel/helpers - typeof";return C0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C0(t)}function mS(t,e){return JZ(t)||YZ(t,e)||iM(t,e)||qZ()}function qZ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iM(t,e){if(t){if(typeof t=="string")return gA(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gA(t,e)}}function gA(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function YZ(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,o,l,s=[],d=!0,p=!1;try{if(o=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;d=!1}else for(;!(d=(i=o.call(n)).done)&&(s.push(i.value),s.length!==e);d=!0);}catch(y){p=!0,r=y}finally{try{if(!d&&n.return!=null&&(l=n.return(),Object(l)!==l))return}finally{if(p)throw r}}return s}}function JZ(t){if(Array.isArray(t))return t}var He={innerWidth:function(e){if(e){var n=e.offsetWidth,i=getComputedStyle(e);return n+=parseFloat(i.paddingLeft)+parseFloat(i.paddingRight),n}return 0},width:function(e){if(e){var n=e.offsetWidth,i=getComputedStyle(e);return n-=parseFloat(i.paddingLeft)+parseFloat(i.paddingRight),n}return 0},getWindowScrollTop:function(){var e=document.documentElement;return(window.pageYOffset||e.scrollTop)-(e.clientTop||0)},getWindowScrollLeft:function(){var e=document.documentElement;return(window.pageXOffset||e.scrollLeft)-(e.clientLeft||0)},getOuterWidth:function(e,n){if(e){var i=e.offsetWidth;if(n){var r=getComputedStyle(e);i+=parseFloat(r.marginLeft)+parseFloat(r.marginRight)}return i}return 0},getOuterHeight:function(e,n){if(e){var i=e.offsetHeight;if(n){var r=getComputedStyle(e);i+=parseFloat(r.marginTop)+parseFloat(r.marginBottom)}return i}return 0},getClientHeight:function(e,n){if(e){var i=e.clientHeight;if(n){var r=getComputedStyle(e);i+=parseFloat(r.marginTop)+parseFloat(r.marginBottom)}return i}return 0},getViewport:function(){var e=window,n=document,i=n.documentElement,r=n.getElementsByTagName("body")[0],o=e.innerWidth||i.clientWidth||r.clientWidth,l=e.innerHeight||i.clientHeight||r.clientHeight;return{width:o,height:l}},getOffset:function(e){if(e){var n=e.getBoundingClientRect();return{top:n.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:n.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0)}}return{top:"auto",left:"auto"}},index:function(e){if(e)for(var n=e.parentNode.childNodes,i=0,r=0;r<n.length;r++){if(n[r]===e)return i;n[r].nodeType===1&&i++}return-1},addMultipleClasses:function(e,n){var i=this;e&&n&&n.split(" ").forEach(function(r){return i.addClass(e,r)})},addClass:function(e,n){e&&n&&!this.hasClass(e,n)&&(e.classList?e.classList.add(n):e.className+=" "+n)},removeClass:function(e,n){e&&n&&(e.classList?e.classList.remove(n):e.className=e.className.replace(new RegExp("(^|\\b)"+n.split(" ").join("|")+"(\\b|$)","gi")," "))},hasClass:function(e,n){return e?e.classList?e.classList.contains(n):new RegExp("(^| )"+n+"( |$)","gi").test(e.className):!1},addStyles:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e&&Object.entries(n).forEach(function(i){var r=mS(i,2),o=r[0],l=r[1];return e.style[o]=l})},find:function(e,n){return this.isElement(e)?e.querySelectorAll(n):[]},findSingle:function(e,n){return this.isElement(e)?e.querySelector(n):null},createElement:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e){var i=document.createElement(e);this.setAttributes(i,n);for(var r=arguments.length,o=new Array(r>2?r-2:0),l=2;l<r;l++)o[l-2]=arguments[l];return i.append.apply(i,o),i}},setAttribute:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",i=arguments.length>2?arguments[2]:void 0;this.isElement(e)&&i!==null&&i!==void 0&&e.setAttribute(n,i)},setAttributes:function(e){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.isElement(e)){var r=function o(l,s){var d,p,y=e!=null&&(d=e.$attrs)!==null&&d!==void 0&&d[l]?[e==null||(p=e.$attrs)===null||p===void 0?void 0:p[l]]:[];return[s].flat().reduce(function(v,w){if(w!=null){var T=C0(w);if(T==="string"||T==="number")v.push(w);else if(T==="object"){var I=Array.isArray(w)?o(l,w):Object.entries(w).map(function(L){var k=mS(L,2),F=k[0],B=k[1];return l==="style"&&(B||B===0)?"".concat(F.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),":").concat(B):B?F:void 0});v=I.length?v.concat(I.filter(function(L){return!!L})):v}}return v},y)};Object.entries(i).forEach(function(o){var l=mS(o,2),s=l[0],d=l[1];if(d!=null){var p=s.match(/^on(.+)/);p?e.addEventListener(p[1].toLowerCase(),d):s==="p-bind"?n.setAttributes(e,d):(d=s==="class"?WZ(new Set(r("class",d))).join(" ").trim():s==="style"?r("style",d).join(";").trim():d,(e.$attrs=e.$attrs||{})&&(e.$attrs[s]=d),e.setAttribute(s,d))}})}},getAttribute:function(e,n){if(this.isElement(e)){var i=e.getAttribute(n);return isNaN(i)?i==="true"||i==="false"?i==="true":i:+i}},isAttributeEquals:function(e,n,i){return this.isElement(e)?this.getAttribute(e,n)===i:!1},isAttributeNotEquals:function(e,n,i){return!this.isAttributeEquals(e,n,i)},getHeight:function(e){if(e){var n=e.offsetHeight,i=getComputedStyle(e);return n-=parseFloat(i.paddingTop)+parseFloat(i.paddingBottom)+parseFloat(i.borderTopWidth)+parseFloat(i.borderBottomWidth),n}return 0},getWidth:function(e){if(e){var n=e.offsetWidth,i=getComputedStyle(e);return n-=parseFloat(i.paddingLeft)+parseFloat(i.paddingRight)+parseFloat(i.borderLeftWidth)+parseFloat(i.borderRightWidth),n}return 0},absolutePosition:function(e,n){if(e){var i=e.offsetParent?{width:e.offsetWidth,height:e.offsetHeight}:this.getHiddenElementDimensions(e),r=i.height,o=i.width,l=n.offsetHeight,s=n.offsetWidth,d=n.getBoundingClientRect(),p=this.getWindowScrollTop(),y=this.getWindowScrollLeft(),v=this.getViewport(),w,T;d.top+l+r>v.height?(w=d.top+p-r,e.style.transformOrigin="bottom",w<0&&(w=p)):(w=l+d.top+p,e.style.transformOrigin="top"),d.left+o>v.width?T=Math.max(0,d.left+y+s-o):T=d.left+y,e.style.top=w+"px",e.style.left=T+"px"}},relativePosition:function(e,n){if(e){var i=e.offsetParent?{width:e.offsetWidth,height:e.offsetHeight}:this.getHiddenElementDimensions(e),r=n.offsetHeight,o=n.getBoundingClientRect(),l=this.getViewport(),s,d;o.top+r+i.height>l.height?(s=-1*i.height,e.style.transformOrigin="bottom",o.top+s<0&&(s=-1*o.top)):(s=r,e.style.transformOrigin="top"),i.width>l.width?d=o.left*-1:o.left+i.width>l.width?d=(o.left+i.width-l.width)*-1:d=0,e.style.top=s+"px",e.style.left=d+"px"}},getParents:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return e.parentNode===null?n:this.getParents(e.parentNode,n.concat([e.parentNode]))},getScrollableParents:function(e){var n=[];if(e){var i=this.getParents(e),r=/(auto|scroll)/,o=function(k){try{var F=window.getComputedStyle(k,null);return r.test(F.getPropertyValue("overflow"))||r.test(F.getPropertyValue("overflowX"))||r.test(F.getPropertyValue("overflowY"))}catch{return!1}},l=pS(i),s;try{for(l.s();!(s=l.n()).done;){var d=s.value,p=d.nodeType===1&&d.dataset.scrollselectors;if(p){var y=p.split(","),v=pS(y),w;try{for(v.s();!(w=v.n()).done;){var T=w.value,I=this.findSingle(d,T);I&&o(I)&&n.push(I)}}catch(L){v.e(L)}finally{v.f()}}d.nodeType!==9&&o(d)&&n.push(d)}}catch(L){l.e(L)}finally{l.f()}}return n},getHiddenElementOuterHeight:function(e){if(e){e.style.visibility="hidden",e.style.display="block";var n=e.offsetHeight;return e.style.display="none",e.style.visibility="visible",n}return 0},getHiddenElementOuterWidth:function(e){if(e){e.style.visibility="hidden",e.style.display="block";var n=e.offsetWidth;return e.style.display="none",e.style.visibility="visible",n}return 0},getHiddenElementDimensions:function(e){if(e){var n={};return e.style.visibility="hidden",e.style.display="block",n.width=e.offsetWidth,n.height=e.offsetHeight,e.style.display="none",e.style.visibility="visible",n}return 0},fadeIn:function(e,n){if(e){e.style.opacity=0;var i=+new Date,r=0,o=function l(){r=+e.style.opacity+(new Date().getTime()-i)/n,e.style.opacity=r,i=+new Date,+r<1&&(window.requestAnimationFrame&&requestAnimationFrame(l)||setTimeout(l,16))};o()}},fadeOut:function(e,n){if(e)var i=1,r=50,o=n,l=r/o,s=setInterval(function(){i-=l,i<=0&&(i=0,clearInterval(s)),e.style.opacity=i},r)},getUserAgent:function(){return navigator.userAgent},appendChild:function(e,n){if(this.isElement(n))n.appendChild(e);else if(n.el&&n.elElement)n.elElement.appendChild(e);else throw new Error("Cannot append "+n+" to "+e)},isElement:function(e){return(typeof HTMLElement>"u"?"undefined":C0(HTMLElement))==="object"?e instanceof HTMLElement:e&&C0(e)==="object"&&e!==null&&e.nodeType===1&&typeof e.nodeName=="string"},scrollInView:function(e,n){var i=getComputedStyle(e).getPropertyValue("borderTopWidth"),r=i?parseFloat(i):0,o=getComputedStyle(e).getPropertyValue("paddingTop"),l=o?parseFloat(o):0,s=e.getBoundingClientRect(),d=n.getBoundingClientRect(),p=d.top+document.body.scrollTop-(s.top+document.body.scrollTop)-r-l,y=e.scrollTop,v=e.clientHeight,w=this.getOuterHeight(n);p<0?e.scrollTop=y+p:p+w>v&&(e.scrollTop=y+p-v+w)},clearSelection:function(){if(window.getSelection)window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().rangeCount>0&&window.getSelection().getRangeAt(0).getClientRects().length>0&&window.getSelection().removeAllRanges();else if(document.selection&&document.selection.empty)try{document.selection.empty()}catch{}},getSelection:function(){return window.getSelection?window.getSelection().toString():document.getSelection?document.getSelection().toString():document.selection?document.selection.createRange().text:null},calculateScrollbarWidth:function(){if(this.calculatedScrollbarWidth!=null)return this.calculatedScrollbarWidth;var e=document.createElement("div");this.addStyles(e,{width:"100px",height:"100px",overflow:"scroll",position:"absolute",top:"-9999px"}),document.body.appendChild(e);var n=e.offsetWidth-e.clientWidth;return document.body.removeChild(e),this.calculatedScrollbarWidth=n,n},calculateBodyScrollbarWidth:function(){return window.innerWidth-document.documentElement.offsetWidth},getBrowser:function(){if(!this.browser){var e=this.resolveUserAgent();this.browser={},e.browser&&(this.browser[e.browser]=!0,this.browser.version=e.version),this.browser.chrome?this.browser.webkit=!0:this.browser.webkit&&(this.browser.safari=!0)}return this.browser},resolveUserAgent:function(){var e=navigator.userAgent.toLowerCase(),n=/(chrome)[ ]([\w.]+)/.exec(e)||/(webkit)[ ]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ ]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:n[1]||"",version:n[2]||"0"}},isVisible:function(e){return e&&e.offsetParent!=null},invokeElementMethod:function(e,n,i){e[n].apply(e,i)},isExist:function(e){return!!(e!==null&&typeof e<"u"&&e.nodeName&&e.parentNode)},isClient:function(){return!!(typeof window<"u"&&window.document&&window.document.createElement)},focus:function(e,n){e&&document.activeElement!==e&&e.focus(n)},isFocusableElement:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return this.isElement(e)?e.matches('button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])'.concat(n,`,
                [href][clientHeight][clientWidth]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])`).concat(n,`,
                input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])`).concat(n,`,
                select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])`).concat(n,`,
                textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])`).concat(n,`,
                [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])`).concat(n,`,
                [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])`).concat(n)):!1},getFocusableElements:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",i=this.find(e,'button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])'.concat(n,`,
                [href][clientHeight][clientWidth]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])`).concat(n,`,
                input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])`).concat(n,`,
                select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])`).concat(n,`,
                textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])`).concat(n,`,
                [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])`).concat(n,`,
                [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])`).concat(n)),r=[],o=pS(i),l;try{for(o.s();!(l=o.n()).done;){var s=l.value;getComputedStyle(s).display!="none"&&getComputedStyle(s).visibility!="hidden"&&r.push(s)}}catch(d){o.e(d)}finally{o.f()}return r},getFirstFocusableElement:function(e,n){var i=this.getFocusableElements(e,n);return i.length>0?i[0]:null},getLastFocusableElement:function(e,n){var i=this.getFocusableElements(e,n);return i.length>0?i[i.length-1]:null},getNextFocusableElement:function(e,n,i){var r=this.getFocusableElements(e,i),o=r.length>0?r.findIndex(function(s){return s===n}):-1,l=o>-1&&r.length>=o+1?o+1:-1;return l>-1?r[l]:null},isClickable:function(e){if(e){var n=e.nodeName,i=e.parentElement&&e.parentElement.nodeName;return n==="INPUT"||n==="TEXTAREA"||n==="BUTTON"||n==="A"||i==="INPUT"||i==="TEXTAREA"||i==="BUTTON"||i==="A"||!!e.closest(".p-button, .p-checkbox, .p-radiobutton")}return!1},applyStyle:function(e,n){if(typeof n=="string")e.style.cssText=n;else for(var i in n)e.style[i]=n[i]},isIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream},isAndroid:function(){return/(android)/i.test(navigator.userAgent)},isTouchDevice:function(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0},hasCSSAnimation:function(e){if(e){var n=getComputedStyle(e),i=parseFloat(n.getPropertyValue("animation-duration")||"0");return i>0}return!1},hasCSSTransition:function(e){if(e){var n=getComputedStyle(e),i=parseFloat(n.getPropertyValue("transition-duration")||"0");return i>0}return!1},exportCSV:function(e,n){var i=new Blob([e],{type:"application/csv;charset=utf-8;"});if(window.navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(i,n+".csv");else{var r=document.createElement("a");r.download!==void 0?(r.setAttribute("href",URL.createObjectURL(i)),r.setAttribute("download",n+".csv"),r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r)):(e="data:text/csv;charset=utf-8,"+e,window.open(encodeURI(e)))}},blockBodyScroll:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"p-overflow-hidden";document.body.style.setProperty("--scrollbar-width",this.calculateBodyScrollbarWidth()+"px"),this.addClass(document.body,e)},unblockBodyScroll:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"p-overflow-hidden";document.body.style.removeProperty("--scrollbar-width"),this.removeClass(document.body,e)}};function ev(t){"@babel/helpers - typeof";return ev=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ev(t)}function QZ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function QD(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,tq(i.key),i)}}function eq(t,e,n){return e&&QD(t.prototype,e),n&&QD(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function tq(t){var e=nq(t,"string");return ev(e)==="symbol"?e:String(e)}function nq(t,e){if(ev(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(ev(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var rM=function(){function t(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){};QZ(this,t),this.element=e,this.listener=n}return eq(t,[{key:"bindScrollListener",value:function(){this.scrollableParents=He.getScrollableParents(this.element);for(var n=0;n<this.scrollableParents.length;n++)this.scrollableParents[n].addEventListener("scroll",this.listener)}},{key:"unbindScrollListener",value:function(){if(this.scrollableParents)for(var n=0;n<this.scrollableParents.length;n++)this.scrollableParents[n].removeEventListener("scroll",this.listener)}},{key:"destroy",value:function(){this.unbindScrollListener(),this.element=null,this.listener=null,this.scrollableParents=null}}]),t}();function nN(){var t=new Map;return{on:function(n,i){var r=t.get(n);r?r.push(i):r=[i],t.set(n,r)},off:function(n,i){var r=t.get(n);r&&r.splice(r.indexOf(i)>>>0,1)},emit:function(n,i){var r=t.get(n);r&&r.slice().map(function(o){o(i)})}}}function iq(t,e){return sq(t)||oq(t,e)||oM(t,e)||rq()}function rq(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oq(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,o,l,s=[],d=!0,p=!1;try{if(o=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;d=!1}else for(;!(d=(i=o.call(n)).done)&&(s.push(i.value),s.length!==e);d=!0);}catch(y){p=!0,r=y}finally{try{if(!d&&n.return!=null&&(l=n.return(),Object(l)!==l))return}finally{if(p)throw r}}return s}}function sq(t){if(Array.isArray(t))return t}function e4(t){return cq(t)||lq(t)||oM(t)||aq()}function aq(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lq(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function cq(t){if(Array.isArray(t))return yA(t)}function gS(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=oM(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(p){throw p},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,l=!1,s;return{s:function(){n=n.call(t)},n:function(){var p=n.next();return o=p.done,p},e:function(p){l=!0,s=p},f:function(){try{!o&&n.return!=null&&n.return()}finally{if(l)throw s}}}}function oM(t,e){if(t){if(typeof t=="string")return yA(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yA(t,e)}}function yA(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function A0(t){"@babel/helpers - typeof";return A0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A0(t)}var At={equals:function(e,n,i){return i?this.resolveFieldData(e,i)===this.resolveFieldData(n,i):this.deepEquals(e,n)},deepEquals:function(e,n){if(e===n)return!0;if(e&&n&&A0(e)=="object"&&A0(n)=="object"){var i=Array.isArray(e),r=Array.isArray(n),o,l,s;if(i&&r){if(l=e.length,l!=n.length)return!1;for(o=l;o--!==0;)if(!this.deepEquals(e[o],n[o]))return!1;return!0}if(i!=r)return!1;var d=e instanceof Date,p=n instanceof Date;if(d!=p)return!1;if(d&&p)return e.getTime()==n.getTime();var y=e instanceof RegExp,v=n instanceof RegExp;if(y!=v)return!1;if(y&&v)return e.toString()==n.toString();var w=Object.keys(e);if(l=w.length,l!==Object.keys(n).length)return!1;for(o=l;o--!==0;)if(!Object.prototype.hasOwnProperty.call(n,w[o]))return!1;for(o=l;o--!==0;)if(s=w[o],!this.deepEquals(e[s],n[s]))return!1;return!0}return e!==e&&n!==n},resolveFieldData:function(e,n){if(!e||!n)return null;try{var i=e[n];if(this.isNotEmpty(i))return i}catch{}if(Object.keys(e).length){if(this.isFunction(n))return n(e);if(n.indexOf(".")===-1)return e[n];for(var r=n.split("."),o=e,l=0,s=r.length;l<s;++l){if(o==null)return null;o=o[r[l]]}return o}return null},getItemValue:function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return this.isFunction(e)?e.apply(void 0,i):e},filter:function(e,n,i){var r=[];if(e){var o=gS(e),l;try{for(o.s();!(l=o.n()).done;){var s=l.value,d=gS(n),p;try{for(d.s();!(p=d.n()).done;){var y=p.value;if(String(this.resolveFieldData(s,y)).toLowerCase().indexOf(i.toLowerCase())>-1){r.push(s);break}}}catch(v){d.e(v)}finally{d.f()}}}catch(v){o.e(v)}finally{o.f()}}return r},reorderArray:function(e,n,i){e&&n!==i&&(i>=e.length&&(i%=e.length,n%=e.length),e.splice(i,0,e.splice(n,1)[0]))},findIndexInList:function(e,n){var i=-1;if(n){for(var r=0;r<n.length;r++)if(n[r]===e){i=r;break}}return i},contains:function(e,n){if(e!=null&&n&&n.length){var i=gS(n),r;try{for(i.s();!(r=i.n()).done;){var o=r.value;if(this.equals(e,o))return!0}}catch(l){i.e(l)}finally{i.f()}}return!1},insertIntoOrderedArray:function(e,n,i,r){if(i.length>0){for(var o=!1,l=0;l<i.length;l++){var s=this.findIndexInList(i[l],r);if(s>n){i.splice(l,0,e),o=!0;break}}o||i.push(e)}else i.push(e)},removeAccents:function(e){return e&&e.search(/[\xC0-\xFF]/g)>-1&&(e=e.replace(/[\xC0-\xC5]/g,"A").replace(/[\xC6]/g,"AE").replace(/[\xC7]/g,"C").replace(/[\xC8-\xCB]/g,"E").replace(/[\xCC-\xCF]/g,"I").replace(/[\xD0]/g,"D").replace(/[\xD1]/g,"N").replace(/[\xD2-\xD6\xD8]/g,"O").replace(/[\xD9-\xDC]/g,"U").replace(/[\xDD]/g,"Y").replace(/[\xDE]/g,"P").replace(/[\xE0-\xE5]/g,"a").replace(/[\xE6]/g,"ae").replace(/[\xE7]/g,"c").replace(/[\xE8-\xEB]/g,"e").replace(/[\xEC-\xEF]/g,"i").replace(/[\xF1]/g,"n").replace(/[\xF2-\xF6\xF8]/g,"o").replace(/[\xF9-\xFC]/g,"u").replace(/[\xFE]/g,"p").replace(/[\xFD\xFF]/g,"y")),e},getVNodeProp:function(e,n){var i=e.props;if(i){var r=n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),o=Object.prototype.hasOwnProperty.call(i,r)?r:n;return e.type.extends.props[n].type===Boolean&&i[o]===""?!0:i[o]}return null},toFlatCase:function(e){return this.isString(e)?e.replace(/(-|_)/g,"").toLowerCase():e},toKebabCase:function(e){return this.isString(e)?e.replace(/(_)/g,"-").replace(/[A-Z]/g,function(n,i){return i===0?n:"-"+n.toLowerCase()}).toLowerCase():e},toCapitalCase:function(e){return this.isString(e,{empty:!1})?e[0].toUpperCase()+e.slice(1):e},isEmpty:function(e){return e==null||e===""||Array.isArray(e)&&e.length===0||!(e instanceof Date)&&A0(e)==="object"&&Object.keys(e).length===0},isNotEmpty:function(e){return!this.isEmpty(e)},isFunction:function(e){return!!(e&&e.constructor&&e.call&&e.apply)},isObject:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return e instanceof Object&&e.constructor===Object&&(n||Object.keys(e).length!==0)},isDate:function(e){return e instanceof Date&&e.constructor===Date},isArray:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Array.isArray(e)&&(n||e.length!==0)},isString:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return typeof e=="string"&&(n||e!=="")},isPrintableCharacter:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return this.isNotEmpty(e)&&e.length===1&&e.match(/\S| /)},findLast:function(e,n){var i;if(this.isNotEmpty(e))try{i=e.findLast(n)}catch{i=e4(e).reverse().find(n)}return i},findLastIndex:function(e,n){var i=-1;if(this.isNotEmpty(e))try{i=e.findLastIndex(n)}catch{i=e.lastIndexOf(e4(e).reverse().find(n))}return i},sort:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1,l=this.compare(e,n,r,i),s=i;return(this.isEmpty(e)||this.isEmpty(n))&&(s=o===1?i:o),s*l},compare:function(e,n,i){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,o=-1,l=this.isEmpty(e),s=this.isEmpty(n);return l&&s?o=0:l?o=r:s?o=-r:typeof e=="string"&&typeof n=="string"?o=i(e,n):o=e<n?-1:e>n?1:0,o},localeComparator:function(){return new Intl.Collator(void 0,{numeric:!0}).compare},nestedKeys:function(){var e=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return Object.entries(n).reduce(function(r,o){var l=iq(o,2),s=l[0],d=l[1],p=i?"".concat(i,".").concat(s):s;return e.isObject(d)?r=r.concat(e.nestedKeys(d,p)):r.push(p),r},[])}},t4=0;function Gr(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"pv_id_";return t4++,"".concat(t).concat(t4)}function uq(t){return pq(t)||fq(t)||dq(t)||hq()}function hq(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dq(t,e){if(t){if(typeof t=="string")return vA(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vA(t,e)}}function fq(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function pq(t){if(Array.isArray(t))return vA(t)}function vA(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function mq(){var t=[],e=function(s,d){var p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:999,y=r(s,d,p),v=y.value+(y.key===s?0:p)+1;return t.push({key:s,value:v}),v},n=function(s){t=t.filter(function(d){return d.value!==s})},i=function(s,d){return r(s,d).value},r=function(s,d){var p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return uq(t).reverse().find(function(y){return d?!0:y.key===s})||{key:s,value:p}},o=function(s){return s&&parseInt(s.style.zIndex,10)||0};return{get:o,set:function(s,d,p){d&&(d.style.zIndex=String(e(s,!0,p)))},clear:function(s){s&&(n(o(s)),s.style.zIndex="")},getCurrent:function(s){return i(s,!0)}}}var Sl=mq(),vr={STARTS_WITH:"startsWith",CONTAINS:"contains",NOT_CONTAINS:"notContains",ENDS_WITH:"endsWith",EQUALS:"equals",NOT_EQUALS:"notEquals",IN:"in",LESS_THAN:"lt",LESS_THAN_OR_EQUAL_TO:"lte",GREATER_THAN:"gt",GREATER_THAN_OR_EQUAL_TO:"gte",BETWEEN:"between",DATE_IS:"dateIs",DATE_IS_NOT:"dateIsNot",DATE_BEFORE:"dateBefore",DATE_AFTER:"dateAfter"},za={AND:"and",OR:"or"};function n4(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=gq(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(p){throw p},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,l=!1,s;return{s:function(){n=n.call(t)},n:function(){var p=n.next();return o=p.done,p},e:function(p){l=!0,s=p},f:function(){try{!o&&n.return!=null&&n.return()}finally{if(l)throw s}}}}function gq(t,e){if(t){if(typeof t=="string")return i4(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i4(t,e)}}function i4(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var _A={filter:function(e,n,i,r,o){var l=[];if(!e)return l;var s=n4(e),d;try{for(s.s();!(d=s.n()).done;){var p=d.value;if(typeof p=="string"){if(this.filters[r](p,i,o)){l.push(p);continue}}else{var y=n4(n),v;try{for(y.s();!(v=y.n()).done;){var w=v.value,T=At.resolveFieldData(p,w);if(this.filters[r](T,i,o)){l.push(p);break}}}catch(I){y.e(I)}finally{y.f()}}}}catch(I){s.e(I)}finally{s.f()}return l},filters:{startsWith:function(e,n,i){if(n==null||n.trim()==="")return!0;if(e==null)return!1;var r=At.removeAccents(n.toString()).toLocaleLowerCase(i),o=At.removeAccents(e.toString()).toLocaleLowerCase(i);return o.slice(0,r.length)===r},contains:function(e,n,i){if(n==null||typeof n=="string"&&n.trim()==="")return!0;if(e==null)return!1;var r=At.removeAccents(n.toString()).toLocaleLowerCase(i),o=At.removeAccents(e.toString()).toLocaleLowerCase(i);return o.indexOf(r)!==-1},notContains:function(e,n,i){if(n==null||typeof n=="string"&&n.trim()==="")return!0;if(e==null)return!1;var r=At.removeAccents(n.toString()).toLocaleLowerCase(i),o=At.removeAccents(e.toString()).toLocaleLowerCase(i);return o.indexOf(r)===-1},endsWith:function(e,n,i){if(n==null||n.trim()==="")return!0;if(e==null)return!1;var r=At.removeAccents(n.toString()).toLocaleLowerCase(i),o=At.removeAccents(e.toString()).toLocaleLowerCase(i);return o.indexOf(r,o.length-r.length)!==-1},equals:function(e,n,i){return n==null||typeof n=="string"&&n.trim()===""?!0:e==null?!1:e.getTime&&n.getTime?e.getTime()===n.getTime():At.removeAccents(e.toString()).toLocaleLowerCase(i)==At.removeAccents(n.toString()).toLocaleLowerCase(i)},notEquals:function(e,n,i){return n==null||typeof n=="string"&&n.trim()===""?!1:e==null?!0:e.getTime&&n.getTime?e.getTime()!==n.getTime():At.removeAccents(e.toString()).toLocaleLowerCase(i)!=At.removeAccents(n.toString()).toLocaleLowerCase(i)},in:function(e,n){if(n==null||n.length===0)return!0;for(var i=0;i<n.length;i++)if(At.equals(e,n[i]))return!0;return!1},between:function(e,n){return n==null||n[0]==null||n[1]==null?!0:e==null?!1:e.getTime?n[0].getTime()<=e.getTime()&&e.getTime()<=n[1].getTime():n[0]<=e&&e<=n[1]},lt:function(e,n){return n==null?!0:e==null?!1:e.getTime&&n.getTime?e.getTime()<n.getTime():e<n},lte:function(e,n){return n==null?!0:e==null?!1:e.getTime&&n.getTime?e.getTime()<=n.getTime():e<=n},gt:function(e,n){return n==null?!0:e==null?!1:e.getTime&&n.getTime?e.getTime()>n.getTime():e>n},gte:function(e,n){return n==null?!0:e==null?!1:e.getTime&&n.getTime?e.getTime()>=n.getTime():e>=n},dateIs:function(e,n){return n==null?!0:e==null?!1:e.toDateString()===n.toDateString()},dateIsNot:function(e,n){return n==null?!0:e==null?!1:e.toDateString()!==n.toDateString()},dateBefore:function(e,n){return n==null?!0:e==null?!1:e.getTime()<n.getTime()},dateAfter:function(e,n){return n==null?!0:e==null?!1:e.getTime()>n.getTime()}},register:function(e,n){this.filters[e]=n}};function tv(t){"@babel/helpers - typeof";return tv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tv(t)}function r4(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function yS(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?r4(Object(n),!0).forEach(function(i){yq(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r4(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function yq(t,e,n){return e=vq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vq(t){var e=_q(t,"string");return tv(e)==="symbol"?e:String(e)}function _q(t,e){if(tv(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(tv(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var o4={ripple:!1,inputStyle:"outlined",locale:{startsWith:"Starts with",contains:"Contains",notContains:"Not contains",endsWith:"Ends with",equals:"Equals",notEquals:"Not equals",noFilter:"No Filter",lt:"Less than",lte:"Less than or equal to",gt:"Greater than",gte:"Greater than or equal to",dateIs:"Date is",dateIsNot:"Date is not",dateBefore:"Date is before",dateAfter:"Date is after",clear:"Clear",apply:"Apply",matchAll:"Match All",matchAny:"Match Any",addRule:"Add Rule",removeRule:"Remove Rule",accept:"Yes",reject:"No",choose:"Choose",upload:"Upload",cancel:"Cancel",completed:"Completed",pending:"Pending",fileSizeTypes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],chooseYear:"Choose Year",chooseMonth:"Choose Month",chooseDate:"Choose Date",prevDecade:"Previous Decade",nextDecade:"Next Decade",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",prevHour:"Previous Hour",nextHour:"Next Hour",prevMinute:"Previous Minute",nextMinute:"Next Minute",prevSecond:"Previous Second",nextSecond:"Next Second",am:"am",pm:"pm",today:"Today",weekHeader:"Wk",firstDayOfWeek:0,showMonthAfterYear:!1,dateFormat:"mm/dd/yy",weak:"Weak",medium:"Medium",strong:"Strong",passwordPrompt:"Enter a password",emptyFilterMessage:"No results found",searchMessage:"{0} results are available",selectionMessage:"{0} items selected",emptySelectionMessage:"No selected item",emptySearchMessage:"No results found",emptyMessage:"No available options",aria:{trueLabel:"True",falseLabel:"False",nullLabel:"Not Selected",star:"1 star",stars:"{star} stars",selectAll:"All items selected",unselectAll:"All items unselected",close:"Close",previous:"Previous",next:"Next",navigation:"Navigation",scrollTop:"Scroll Top",moveTop:"Move Top",moveUp:"Move Up",moveDown:"Move Down",moveBottom:"Move Bottom",moveToTarget:"Move to Target",moveToSource:"Move to Source",moveAllToTarget:"Move All to Target",moveAllToSource:"Move All to Source",pageLabel:"{page}",firstPageLabel:"First Page",lastPageLabel:"Last Page",nextPageLabel:"Next Page",prevPageLabel:"Previous Page",rowsPerPageLabel:"Rows per page",jumpToPageDropdownLabel:"Jump to Page Dropdown",jumpToPageInputLabel:"Jump to Page Input",selectRow:"Row Selected",unselectRow:"Row Unselected",expandRow:"Row Expanded",collapseRow:"Row Collapsed",showFilterMenu:"Show Filter Menu",hideFilterMenu:"Hide Filter Menu",filterOperator:"Filter Operator",filterConstraint:"Filter Constraint",editRow:"Row Edit",saveEdit:"Save Edit",cancelEdit:"Cancel Edit",listView:"List View",gridView:"Grid View",slide:"Slide",slideNumber:"{slideNumber}",zoomImage:"Zoom Image",zoomIn:"Zoom In",zoomOut:"Zoom Out",rotateRight:"Rotate Right",rotateLeft:"Rotate Left"}},filterMatchModeOptions:{text:[vr.STARTS_WITH,vr.CONTAINS,vr.NOT_CONTAINS,vr.ENDS_WITH,vr.EQUALS,vr.NOT_EQUALS],numeric:[vr.EQUALS,vr.NOT_EQUALS,vr.LESS_THAN,vr.LESS_THAN_OR_EQUAL_TO,vr.GREATER_THAN,vr.GREATER_THAN_OR_EQUAL_TO],date:[vr.DATE_IS,vr.DATE_IS_NOT,vr.DATE_BEFORE,vr.DATE_AFTER]},zIndex:{modal:1100,overlay:1e3,menu:1e3,tooltip:1100},pt:void 0,ptOptions:{mergeSections:!0,mergeProps:!1},unstyled:!1,csp:{nonce:void 0}},bq=Symbol();function xq(t,e,n,i){if(t!==e){var r=document.getElementById(n),o=r.cloneNode(!0),l=r.getAttribute("href").replace(t,e);o.setAttribute("id",n+"-clone"),o.setAttribute("href",l),o.addEventListener("load",function(){r.remove(),o.setAttribute("id",n),i&&i()}),r.parentNode&&r.parentNode.insertBefore(o,r.nextSibling)}}var wq={install:function(e,n){var i=n?yS(yS({},o4),n):yS({},o4),r={config:Ao(i),changeTheme:xq};e.config.globalProperties.$primevue=r,e.provide(bq,r)}};function nv(t){"@babel/helpers - typeof";return nv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nv(t)}function s4(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function a4(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?s4(Object(n),!0).forEach(function(i){Eq(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s4(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Eq(t,e,n){return e=Tq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tq(t){var e=Sq(t,"string");return nv(e)==="symbol"?e:String(e)}function Sq(t,e){if(nv(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(nv(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cq(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;pc()?Ds(t):e?t():Ys(t)}var Aq=0;function iN(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=$n(!1),i=$n(t),r=$n(null),o=He.isClient()?window.document:void 0,l=e.document,s=l===void 0?o:l,d=e.immediate,p=d===void 0?!0:d,y=e.manual,v=y===void 0?!1:y,w=e.name,T=w===void 0?"style_".concat(++Aq):w,I=e.id,L=I===void 0?void 0:I,k=e.media,F=k===void 0?void 0:k,B=e.nonce,G=B===void 0?void 0:B,U=e.props,ee=U===void 0?{}:U,ne=function(){},ye=function(Ce){var me=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(s){var be=a4(a4({},ee),me),Te=be.name||T,ke=be.id||L,ut=be.nonce||G;r.value=s.querySelector('style[data-primevue-style-id="'.concat(Te,'"]'))||s.getElementById(ke)||s.createElement("style"),r.value.isConnected||(i.value=Ce||t,He.setAttributes(r.value,{type:"text/css",id:ke,media:F,nonce:ut}),s.head.appendChild(r.value),He.setAttribute(r.value,"data-primevue-style-id",T),He.setAttributes(r.value,be)),!n.value&&(ne=Ri(i,function(et){r.value.textContent=et},{immediate:!0}),n.value=!0)}},fe=function(){!s||!n.value||(ne(),He.isExist(r.value)&&s.head.removeChild(r.value),n.value=!1)};return p&&!v&&Cq(ye),{id:L,name:T,css:i,unload:fe,load:ye,isLoaded:c2(n)}}function iv(t){"@babel/helpers - typeof";return iv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},iv(t)}function Pq(t,e){return Lq(t)||Rq(t,e)||Mq(t,e)||Iq()}function Iq(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mq(t,e){if(t){if(typeof t=="string")return l4(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l4(t,e)}}function l4(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Rq(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,o,l,s=[],d=!0,p=!1;try{if(o=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;d=!1}else for(;!(d=(i=o.call(n)).done)&&(s.push(i.value),s.length!==e);d=!0);}catch(y){p=!0,r=y}finally{try{if(!d&&n.return!=null&&(l=n.return(),Object(l)!==l))return}finally{if(p)throw r}}return s}}function Lq(t){if(Array.isArray(t))return t}function c4(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function vS(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?c4(Object(n),!0).forEach(function(i){Oq(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c4(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Oq(t,e,n){return e=Dq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dq(t){var e=kq(t,"string");return iv(e)==="symbol"?e:String(e)}function kq(t,e){if(iv(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(iv(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Fq=`
.p-hidden-accessible {
    border: 0;
    clip: rect(0 0 0 0);
    height: 1px;
    margin: -1px;
    overflow: hidden;
    padding: 0;
    position: absolute;
    width: 1px;
}

.p-hidden-accessible input,
.p-hidden-accessible select {
    transform: scale(0);
}

.p-overflow-hidden {
    overflow: hidden;
    padding-right: var(--scrollbar-width);
}
`,Bq={},zq={},_o={name:"base",css:Fq,classes:Bq,inlineStyles:zq,loadStyle:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.css?iN(this.css,vS({name:this.name},e)):{}},getStyleSheet:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.css){var i=Object.entries(n).reduce(function(r,o){var l=Pq(o,2),s=l[0],d=l[1];return r.push("".concat(s,'="').concat(d,'"'))&&r},[]).join(" ");return'<style type="text/css" data-primevue-style-id="'.concat(this.name,'" ').concat(i,">").concat(this.css).concat(e,"</style>")}return""},extend:function(e){return vS(vS({},this),{},{css:void 0},e)}};function rv(t){"@babel/helpers - typeof";return rv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rv(t)}function u4(t,e){return jq(t)||Vq(t,e)||Uq(t,e)||Nq()}function Nq(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Uq(t,e){if(t){if(typeof t=="string")return h4(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h4(t,e)}}function h4(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Vq(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,o,l,s=[],d=!0,p=!1;try{if(o=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;d=!1}else for(;!(d=(i=o.call(n)).done)&&(s.push(i.value),s.length!==e);d=!0);}catch(y){p=!0,r=y}finally{try{if(!d&&n.return!=null&&(l=n.return(),Object(l)!==l))return}finally{if(p)throw r}}return s}}function jq(t){if(Array.isArray(t))return t}function d4(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function to(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?d4(Object(n),!0).forEach(function(i){bA(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d4(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function bA(t,e,n){return e=$q(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $q(t){var e=Gq(t,"string");return rv(e)==="symbol"?e:String(e)}function Gq(t,e){if(rv(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(rv(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var lr={_getMeta:function(){return[At.isObject(arguments.length<=0?void 0:arguments[0])||arguments.length<=0?void 0:arguments[0],At.getItemValue(At.isObject(arguments.length<=0?void 0:arguments[0])?arguments.length<=0?void 0:arguments[0]:arguments.length<=1?void 0:arguments[1])]},_getConfig:function(e,n){var i,r,o;return(i=(e==null||(r=e.instance)===null||r===void 0?void 0:r.$primevue)||(n==null||(o=n.ctx)===null||o===void 0||(o=o.appContext)===null||o===void 0||(o=o.config)===null||o===void 0||(o=o.globalProperties)===null||o===void 0?void 0:o.$primevue))===null||i===void 0?void 0:i.config},_getOptionValue:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=At.toFlatCase(n).split("."),o=r.shift();return o?At.isObject(e)?lr._getOptionValue(At.getItemValue(e[Object.keys(e).find(function(l){return At.toFlatCase(l)===o})||""],i),r.join("."),i):void 0:At.getItemValue(e,i)},_getPTValue:function(){var e,n,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"",l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,d=function(){var G=lr._getOptionValue.apply(lr,arguments);return At.isString(G)||At.isArray(G)?{class:G}:G},p="data-pc-",y=((e=i.binding)===null||e===void 0||(e=e.value)===null||e===void 0?void 0:e.ptOptions)||((n=i.$config)===null||n===void 0?void 0:n.ptOptions)||{},v=y.mergeSections,w=v===void 0?!0:v,T=y.mergeProps,I=T===void 0?!1:T,L=s?lr._useDefaultPT(i,i.defaultPT(),d,o,l):void 0,k=lr._usePT(i,lr._getPT(r,i.$name),d,o,to(to({},l),{},{global:L||{}})),F=to(to({},o==="root"&&bA({},"".concat(p,"name"),At.toFlatCase(i.$name))),{},bA({},"".concat(p,"section"),At.toFlatCase(o)));return w||!w&&k?I?Le(L,k,F):to(to(to({},L),k),F):to(to({},k),F)},_getPT:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",i=arguments.length>2?arguments[2]:void 0,r=function(l){var s,d=i?i(l):l,p=At.toFlatCase(n);return(s=d==null?void 0:d[p])!==null&&s!==void 0?s:d};return e!=null&&e.hasOwnProperty("_usept")?{_usept:e._usept,originalValue:r(e.originalValue),value:r(e.value)}:r(e)},_usePT:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,l=function(k){return i(k,r,o)};if(n!=null&&n.hasOwnProperty("_usept")){var s,d=n._usept||((s=e.$config)===null||s===void 0?void 0:s.ptOptions)||{},p=d.mergeSections,y=p===void 0?!0:p,v=d.mergeProps,w=v===void 0?!1:v,T=l(n.originalValue),I=l(n.value);return T===void 0&&I===void 0?void 0:At.isString(I)?I:At.isString(T)?T:y||!y&&I?w?Le(T,I):to(to({},T),I):I}return l(n)},_useDefaultPT:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;return lr._usePT(e,n,i,r,o)},_hook:function(e,n,i,r,o,l){var s,d,p="on".concat(At.toCapitalCase(n)),y=lr._getConfig(r,o),v=i==null?void 0:i.$instance,w=lr._usePT(v,lr._getPT(r==null||(s=r.value)===null||s===void 0?void 0:s.pt,e),lr._getOptionValue,"hooks.".concat(p)),T=lr._useDefaultPT(v,y==null||(d=y.pt)===null||d===void 0||(d=d.directives)===null||d===void 0?void 0:d[e],lr._getOptionValue,"hooks.".concat(p)),I={el:i,binding:r,vnode:o,prevVnode:l};w==null||w(v,I),T==null||T(v,I)},_extend:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=function(o,l,s,d,p){var y,v;l._$instances=l._$instances||{};var w=lr._getConfig(s,d),T=l._$instances[e]||{},I=At.isEmpty(T)?to(to({},n),n==null?void 0:n.methods):{};l._$instances[e]=to(to({},T),{},{$name:e,$host:l,$binding:s,$el:T.$el||void 0,$style:to({classes:void 0,inlineStyles:void 0,loadStyle:function(){}},n==null?void 0:n.style),$config:w,defaultPT:function(){return lr._getPT(w==null?void 0:w.pt,void 0,function(k){var F;return k==null||(F=k.directives)===null||F===void 0?void 0:F[e]})},isUnstyled:function(){var k,F;return((k=l.$instance)===null||k===void 0||(k=k.$binding)===null||k===void 0||(k=k.value)===null||k===void 0?void 0:k.unstyled)!==void 0?(F=l.$instance)===null||F===void 0||(F=F.$binding)===null||F===void 0||(F=F.value)===null||F===void 0?void 0:F.unstyled:w==null?void 0:w.unstyled},ptm:function(){var k,F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return lr._getPTValue(l.$instance,(k=l.$instance)===null||k===void 0||(k=k.$binding)===null||k===void 0||(k=k.value)===null||k===void 0?void 0:k.pt,F,to({},B))},ptmo:function(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",B=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return lr._getPTValue(l.$instance,k,F,B,!1)},cx:function(){var k,F,B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(k=l.$instance)!==null&&k!==void 0&&k.isUnstyled()?void 0:lr._getOptionValue((F=l.$instance)===null||F===void 0||(F=F.$style)===null||F===void 0?void 0:F.classes,B,to({},G))},sx:function(){var k,F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,G=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return B?lr._getOptionValue((k=l.$instance)===null||k===void 0||(k=k.$style)===null||k===void 0?void 0:k.inlineStyles,F,to({},G)):void 0}},I),l.$instance=l._$instances[e],(y=(v=l.$instance)[o])===null||y===void 0||y.call(v,l,s,d,p),lr._hook(e,o,l,s,d,p)};return{created:function(o,l,s,d){i("created",o,l,s,d)},beforeMount:function(o,l,s,d){var p,y,v,w,T=lr._getConfig(l,s);_o.loadStyle(void 0,{nonce:T==null||(p=T.csp)===null||p===void 0?void 0:p.nonce}),!((y=o.$instance)!==null&&y!==void 0&&y.isUnstyled())&&((v=o.$instance)===null||v===void 0||(v=v.$style)===null||v===void 0||v.loadStyle(void 0,{nonce:T==null||(w=T.csp)===null||w===void 0?void 0:w.nonce})),i("beforeMount",o,l,s,d)},mounted:function(o,l,s,d){i("mounted",o,l,s,d)},beforeUpdate:function(o,l,s,d){i("beforeUpdate",o,l,s,d)},updated:function(o,l,s,d){i("updated",o,l,s,d)},beforeUnmount:function(o,l,s,d){i("beforeUnmount",o,l,s,d)},unmounted:function(o,l,s,d){i("unmounted",o,l,s,d)}}},extend:function(){var e=lr._getMeta.apply(lr,arguments),n=u4(e,2),i=n[0],r=n[1];return to({extend:function(){var l=lr._getMeta.apply(lr,arguments),s=u4(l,2),d=s[0],p=s[1];return lr.extend(d,to(to(to({},r),r==null?void 0:r.methods),p))}},lr._extend(i,r))}},Hq=`
@layer primevue {
    .p-tooltip {
        position:absolute;
        display:none;
        padding: .25em .5rem;
        max-width: 12.5rem;
    }

    .p-tooltip.p-tooltip-right,
    .p-tooltip.p-tooltip-left {
        padding: 0 .25rem;
    }

    .p-tooltip.p-tooltip-top,
    .p-tooltip.p-tooltip-bottom {
        padding:.25em 0;
    }

    .p-tooltip .p-tooltip-text {
        white-space: pre-line;
        word-break: break-word;
    }

    .p-tooltip-arrow {
        position: absolute;
        width: 0;
        height: 0;
        border-color: transparent;
        border-style: solid;
    }

    .p-tooltip-right .p-tooltip-arrow {
        margin-top: -.25rem;
        border-width: .25em .25em .25em 0;
    }

    .p-tooltip-left .p-tooltip-arrow {
        margin-top: -.25rem;
        border-width: .25em 0 .25em .25rem;
    }

    .p-tooltip.p-tooltip-top {
        padding: .25em 0;
    }

    .p-tooltip-top .p-tooltip-arrow {
        margin-left: -.25rem;
        border-width: .25em .25em 0;
    }

    .p-tooltip-bottom .p-tooltip-arrow {
        margin-left: -.25rem;
        border-width: 0 .25em .25rem;
    }
}
`,Wq={root:"p-tooltip p-component",arrow:"p-tooltip-arrow",text:"p-tooltip-text"},Kq=_o.extend({name:"tooltip",css:Hq,classes:Wq}),Xq=lr.extend({style:Kq});function Zq(t,e){return Qq(t)||Jq(t,e)||Yq(t,e)||qq()}function qq(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yq(t,e){if(t){if(typeof t=="string")return f4(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f4(t,e)}}function f4(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Jq(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,o,l,s=[],d=!0,p=!1;try{if(o=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;d=!1}else for(;!(d=(i=o.call(n)).done)&&(s.push(i.value),s.length!==e);d=!0);}catch(y){p=!0,r=y}finally{try{if(!d&&n.return!=null&&(l=n.return(),Object(l)!==l))return}finally{if(p)throw r}}return s}}function Qq(t){if(Array.isArray(t))return t}function P0(t){"@babel/helpers - typeof";return P0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P0(t)}var eY=Xq.extend("tooltip",{beforeMount:function(e,n){var i,r=this.getTarget(e);if(r.$_ptooltipModifiers=this.getModifiers(n),n.value){if(typeof n.value=="string")r.$_ptooltipValue=n.value,r.$_ptooltipDisabled=!1,r.$_ptooltipEscape=!1,r.$_ptooltipClass=null,r.$_ptooltipFitContent=!0,r.$_ptooltipIdAttr=Gr()+"_tooltip",r.$_ptooltipShowDelay=0,r.$_ptooltipHideDelay=0,r.$_ptooltipAutoHide=!0;else if(P0(n.value)==="object"&&n.value){if(At.isEmpty(n.value.value)||n.value.value.trim()==="")return;r.$_ptooltipValue=n.value.value,r.$_ptooltipDisabled=!!n.value.disabled===n.value.disabled?n.value.disabled:!1,r.$_ptooltipEscape=!!n.value.escape===n.value.escape?n.value.escape:!1,r.$_ptooltipClass=n.value.class||"",r.$_ptooltipFitContent=!!n.value.fitContent===n.value.fitContent?n.value.fitContent:!0,r.$_ptooltipIdAttr=n.value.id||Gr()+"_tooltip",r.$_ptooltipShowDelay=n.value.showDelay||0,r.$_ptooltipHideDelay=n.value.hideDelay||0,r.$_ptooltipAutoHide=!!n.value.autoHide===n.value.autoHide?n.value.autoHide:!0}}else return;r.$_ptooltipZIndex=(i=n.instance.$primevue)===null||i===void 0||(i=i.config)===null||i===void 0||(i=i.zIndex)===null||i===void 0?void 0:i.tooltip,this.bindEvents(r,n),e.setAttribute("data-pd-tooltip",!0)},updated:function(e,n){var i=this.getTarget(e);if(i.$_ptooltipModifiers=this.getModifiers(n),this.unbindEvents(i),!!n.value){if(typeof n.value=="string")i.$_ptooltipValue=n.value,i.$_ptooltipDisabled=!1,i.$_ptooltipEscape=!1,i.$_ptooltipClass=null,i.$_ptooltipIdAttr=i.$_ptooltipIdAttr||Gr()+"_tooltip",i.$_ptooltipShowDelay=0,i.$_ptooltipHideDelay=0,i.$_ptooltipAutoHide=!0,this.bindEvents(i,n);else if(P0(n.value)==="object"&&n.value)if(At.isEmpty(n.value.value)||n.value.value.trim()===""){this.unbindEvents(i,n);return}else i.$_ptooltipValue=n.value.value,i.$_ptooltipDisabled=!!n.value.disabled===n.value.disabled?n.value.disabled:!1,i.$_ptooltipEscape=!!n.value.escape===n.value.escape?n.value.escape:!1,i.$_ptooltipClass=n.value.class||"",i.$_ptooltipFitContent=!!n.value.fitContent===n.value.fitContent?n.value.fitContent:!0,i.$_ptooltipIdAttr=n.value.id||i.$_ptooltipIdAttr||Gr()+"_tooltip",i.$_ptooltipShowDelay=n.value.showDelay||0,i.$_ptooltipHideDelay=n.value.hideDelay||0,i.$_ptooltipAutoHide=!!n.value.autoHide===n.value.autoHide?n.value.autoHide:!0,this.bindEvents(i,n)}},unmounted:function(e,n){var i=this.getTarget(e);this.remove(i),this.unbindEvents(i,n),i.$_ptooltipScrollHandler&&(i.$_ptooltipScrollHandler.destroy(),i.$_ptooltipScrollHandler=null)},timer:void 0,methods:{bindEvents:function(e,n){var i=this,r=e.$_ptooltipModifiers;r.focus?(e.$_focusevent=function(o){return i.onFocus(o,n)},e.addEventListener("focus",e.$_focusevent),e.addEventListener("blur",this.onBlur.bind(this))):(e.$_mouseenterevent=function(o){return i.onMouseEnter(o,n)},e.addEventListener("mouseenter",e.$_mouseenterevent),e.addEventListener("mouseleave",this.onMouseLeave.bind(this)),e.addEventListener("click",this.onClick.bind(this))),e.addEventListener("keydown",this.onKeydown.bind(this))},unbindEvents:function(e){var n=e.$_ptooltipModifiers;n.focus?(e.removeEventListener("focus",e.$_focusevent),e.$_focusevent=null,e.removeEventListener("blur",this.onBlur.bind(this))):(e.removeEventListener("mouseenter",e.$_mouseenterevent),e.$_mouseenterevent=null,e.removeEventListener("mouseleave",this.onMouseLeave.bind(this)),e.removeEventListener("click",this.onClick.bind(this))),e.removeEventListener("keydown",this.onKeydown.bind(this))},bindScrollListener:function(e){var n=this;e.$_ptooltipScrollHandler||(e.$_ptooltipScrollHandler=new rM(e,function(){n.hide(e)})),e.$_ptooltipScrollHandler.bindScrollListener()},unbindScrollListener:function(e){e.$_ptooltipScrollHandler&&e.$_ptooltipScrollHandler.unbindScrollListener()},onMouseEnter:function(e,n){var i=e.currentTarget,r=i.$_ptooltipShowDelay;this.show(i,n,r)},onMouseLeave:function(e){var n=e.currentTarget,i=n.$_ptooltipHideDelay,r=n.$_ptooltipAutoHide;if(r)this.hide(n,i);else{var o=He.getAttribute(e.target,"data-pc-name")==="tooltip"||He.getAttribute(e.target,"data-pc-section")==="arrow"||He.getAttribute(e.target,"data-pc-section")==="text"||He.getAttribute(e.relatedTarget,"data-pc-name")==="tooltip"||He.getAttribute(e.relatedTarget,"data-pc-section")==="arrow"||He.getAttribute(e.relatedTarget,"data-pc-section")==="text";!o&&this.hide(n,i)}},onFocus:function(e,n){var i=e.currentTarget,r=i.$_ptooltipShowDelay;this.show(i,n,r)},onBlur:function(e){var n=e.currentTarget,i=n.$_ptooltipHideDelay;this.hide(n,i)},onClick:function(e){var n=e.currentTarget,i=n.$_ptooltipHideDelay;this.hide(n,i)},onKeydown:function(e){var n=e.currentTarget,i=n.$_ptooltipHideDelay;e.code==="Escape"&&this.hide(e.currentTarget,i)},tooltipActions:function(e,n){if(!(e.$_ptooltipDisabled||!He.isExist(e))){var i=this.create(e,n);this.align(e),!this.isUnstyled()&&He.fadeIn(i,250);var r=this;window.addEventListener("resize",function o(){He.isTouchDevice()||r.hide(e),window.removeEventListener("resize",o)}),i.addEventListener("mouseleave",function o(){r.hide(e),i.removeEventListener("mouseleave",o)}),this.bindScrollListener(e),Sl.set("tooltip",i,e.$_ptooltipZIndex)}},show:function(e,n,i){var r=this;i!==void 0?this.timer=setTimeout(function(){return r.tooltipActions(e,n)},i):this.tooltipActions(e,n)},tooltipRemoval:function(e){this.remove(e),this.unbindScrollListener(e)},hide:function(e,n){var i=this;clearTimeout(this.timer),n!==void 0?setTimeout(function(){return i.tooltipRemoval(e)},n):this.tooltipRemoval(e)},getTooltipElement:function(e){return document.getElementById(e.$_ptooltipId)},create:function(e,n){var i=e.$_ptooltipModifiers,r=He.createElement("div",{class:!this.isUnstyled()&&this.cx("arrow"),style:{top:i!=null&&i.bottom?"0":i!=null&&i.right||i!=null&&i.left||!(i!=null&&i.right)&&!(i!=null&&i.left)&&!(i!=null&&i.top)&&!(i!=null&&i.bottom)?"50%":null,bottom:i!=null&&i.top?"0":null,left:i!=null&&i.right||!(i!=null&&i.right)&&!(i!=null&&i.left)&&!(i!=null&&i.top)&&!(i!=null&&i.bottom)?"0":i!=null&&i.top||i!=null&&i.bottom?"50%":null,right:i!=null&&i.left?"0":null},"p-bind":this.ptm("arrow",{context:i})}),o=He.createElement("div",{class:!this.isUnstyled()&&this.cx("text"),"p-bind":this.ptm("text",{context:i})});e.$_ptooltipEscape?o.innerHTML=e.$_ptooltipValue:(o.innerHTML="",o.appendChild(document.createTextNode(e.$_ptooltipValue)));var l=He.createElement("div",{id:e.$_ptooltipIdAttr,role:"tooltip",style:{display:"inline-block",width:e.$_ptooltipFitContent?"fit-content":void 0},class:[!this.isUnstyled()&&this.cx("root"),e.$_ptooltipClass],"p-bind":this.ptm("root",{context:i})},r,o);return document.body.appendChild(l),e.$_ptooltipId=l.id,this.$el=l,l},remove:function(e){if(e){var n=this.getTooltipElement(e);n&&n.parentElement&&(Sl.clear(n),document.body.removeChild(n)),e.$_ptooltipId=null}},align:function(e){var n=e.$_ptooltipModifiers;n.top?(this.alignTop(e),this.isOutOfBounds(e)&&(this.alignBottom(e),this.isOutOfBounds(e)&&this.alignTop(e))):n.left?(this.alignLeft(e),this.isOutOfBounds(e)&&(this.alignRight(e),this.isOutOfBounds(e)&&(this.alignTop(e),this.isOutOfBounds(e)&&(this.alignBottom(e),this.isOutOfBounds(e)&&this.alignLeft(e))))):n.bottom?(this.alignBottom(e),this.isOutOfBounds(e)&&(this.alignTop(e),this.isOutOfBounds(e)&&this.alignBottom(e))):(this.alignRight(e),this.isOutOfBounds(e)&&(this.alignLeft(e),this.isOutOfBounds(e)&&(this.alignTop(e),this.isOutOfBounds(e)&&(this.alignBottom(e),this.isOutOfBounds(e)&&this.alignRight(e)))))},getHostOffset:function(e){var n=e.getBoundingClientRect(),i=n.left+He.getWindowScrollLeft(),r=n.top+He.getWindowScrollTop();return{left:i,top:r}},alignRight:function(e){this.preAlign(e,"right");var n=this.getTooltipElement(e),i=this.getHostOffset(e),r=i.left+He.getOuterWidth(e),o=i.top+(He.getOuterHeight(e)-He.getOuterHeight(n))/2;n.style.left=r+"px",n.style.top=o+"px"},alignLeft:function(e){this.preAlign(e,"left");var n=this.getTooltipElement(e),i=this.getHostOffset(e),r=i.left-He.getOuterWidth(n),o=i.top+(He.getOuterHeight(e)-He.getOuterHeight(n))/2;n.style.left=r+"px",n.style.top=o+"px"},alignTop:function(e){this.preAlign(e,"top");var n=this.getTooltipElement(e),i=this.getHostOffset(e),r=i.left+(He.getOuterWidth(e)-He.getOuterWidth(n))/2,o=i.top-He.getOuterHeight(n);n.style.left=r+"px",n.style.top=o+"px"},alignBottom:function(e){this.preAlign(e,"bottom");var n=this.getTooltipElement(e),i=this.getHostOffset(e),r=i.left+(He.getOuterWidth(e)-He.getOuterWidth(n))/2,o=i.top+He.getOuterHeight(e);n.style.left=r+"px",n.style.top=o+"px"},preAlign:function(e,n){var i=this.getTooltipElement(e);i.style.left="-999px",i.style.top="-999px",He.removeClass(i,"p-tooltip-".concat(i.$_ptooltipPosition)),!this.isUnstyled()&&He.addClass(i,"p-tooltip-".concat(n)),i.$_ptooltipPosition=n,i.setAttribute("data-p-position",n)},isOutOfBounds:function(e){var n=this.getTooltipElement(e),i=n.getBoundingClientRect(),r=i.top,o=i.left,l=He.getOuterWidth(n),s=He.getOuterHeight(n),d=He.getViewport();return o+l>d.width||o<0||r<0||r+s>d.height},getTarget:function(e){return He.hasClass(e,"p-inputwrapper")?He.findSingle(e,"input"):e},getModifiers:function(e){return e.modifiers&&Object.keys(e.modifiers).length?e.modifiers:e.arg&&P0(e.arg)==="object"?Object.entries(e.arg).reduce(function(n,i){var r=Zq(i,2),o=r[0],l=r[1];return(o==="event"||o==="position")&&(n[l]=!0),n},{}):{}}}});function p4(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Ln(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?p4(Object(n),!0).forEach(function(i){Fo(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p4(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function sw(t){"@babel/helpers - typeof";return sw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sw(t)}function tY(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m4(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function nY(t,e,n){return e&&m4(t.prototype,e),n&&m4(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Fo(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sM(t,e){return rY(t)||sY(t,e)||rN(t,e)||lY()}function d_(t){return iY(t)||oY(t)||rN(t)||aY()}function iY(t){if(Array.isArray(t))return xA(t)}function rY(t){if(Array.isArray(t))return t}function oY(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function sY(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i=[],r=!0,o=!1,l,s;try{for(n=n.call(t);!(r=(l=n.next()).done)&&(i.push(l.value),!(e&&i.length===e));r=!0);}catch(d){o=!0,s=d}finally{try{!r&&n.return!=null&&n.return()}finally{if(o)throw s}}return i}}function rN(t,e){if(t){if(typeof t=="string")return xA(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xA(t,e)}}function xA(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function aY(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var g4=function(){},aM={},oN={},sN=null,aN={mark:g4,measure:g4};try{typeof window<"u"&&(aM=window),typeof document<"u"&&(oN=document),typeof MutationObserver<"u"&&(sN=MutationObserver),typeof performance<"u"&&(aN=performance)}catch{}var cY=aM.navigator||{},y4=cY.userAgent,v4=y4===void 0?"":y4,Oh=aM,kr=oN,_4=sN,pb=aN;Oh.document;var hu=!!kr.documentElement&&!!kr.head&&typeof kr.addEventListener=="function"&&typeof kr.createElement=="function",lN=~v4.indexOf("MSIE")||~v4.indexOf("Trident/"),mb,gb,yb,vb,_b,Jc="___FONT_AWESOME___",wA=16,cN="fa",uN="svg-inline--fa",af="data-fa-i2svg",EA="data-fa-pseudo-element",uY="data-fa-pseudo-element-pending",lM="data-prefix",cM="data-icon",b4="fontawesome-i2svg",hY="async",dY=["HTML","HEAD","STYLE","SCRIPT"],hN=function(){try{return!0}catch{return!1}}(),Dr="classic",ho="sharp",uM=[Dr,ho];function f_(t){return new Proxy(t,{get:function(n,i){return i in n?n[i]:n[Dr]}})}var ov=f_((mb={},Fo(mb,Dr,{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands",fak:"kit","fa-kit":"kit"}),Fo(mb,ho,{fa:"solid",fass:"solid","fa-solid":"solid",fasr:"regular","fa-regular":"regular",fasl:"light","fa-light":"light"}),mb)),sv=f_((gb={},Fo(gb,Dr,{solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab",kit:"fak"}),Fo(gb,ho,{solid:"fass",regular:"fasr",light:"fasl"}),gb)),av=f_((yb={},Fo(yb,Dr,{fab:"fa-brands",fad:"fa-duotone",fak:"fa-kit",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"}),Fo(yb,ho,{fass:"fa-solid",fasr:"fa-regular",fasl:"fa-light"}),yb)),fY=f_((vb={},Fo(vb,Dr,{"fa-brands":"fab","fa-duotone":"fad","fa-kit":"fak","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"}),Fo(vb,ho,{"fa-solid":"fass","fa-regular":"fasr","fa-light":"fasl"}),vb)),pY=/fa(s|r|l|t|d|b|k|ss|sr|sl)?[\-\ ]/,dN="fa-layers-text",mY=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp|Kit)?.*/i,gY=f_((_b={},Fo(_b,Dr,{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"}),Fo(_b,ho,{900:"fass",400:"fasr",300:"fasl"}),_b)),fN=[1,2,3,4,5,6,7,8,9,10],yY=fN.concat([11,12,13,14,15,16,17,18,19,20]),vY=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],jd={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},lv=new Set;Object.keys(sv[Dr]).map(lv.add.bind(lv));Object.keys(sv[ho]).map(lv.add.bind(lv));var _Y=[].concat(uM,d_(lv),["2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",jd.GROUP,jd.SWAP_OPACITY,jd.PRIMARY,jd.SECONDARY]).concat(fN.map(function(t){return"".concat(t,"x")})).concat(yY.map(function(t){return"w-".concat(t)})),I0=Oh.FontAwesomeConfig||{};function bY(t){var e=kr.querySelector("script["+t+"]");if(e)return e.getAttribute(t)}function xY(t){return t===""?!0:t==="false"?!1:t==="true"?!0:t}if(kr&&typeof kr.querySelector=="function"){var wY=[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]];wY.forEach(function(t){var e=sM(t,2),n=e[0],i=e[1],r=xY(bY(n));r!=null&&(I0[i]=r)})}var pN={styleDefault:"solid",familyDefault:"classic",cssPrefix:cN,replacementClass:uN,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};I0.familyPrefix&&(I0.cssPrefix=I0.familyPrefix);var Lm=Ln(Ln({},pN),I0);Lm.autoReplaceSvg||(Lm.observeMutations=!1);var Vn={};Object.keys(pN).forEach(function(t){Object.defineProperty(Vn,t,{enumerable:!0,set:function(n){Lm[t]=n,M0.forEach(function(i){return i(Vn)})},get:function(){return Lm[t]}})});Object.defineProperty(Vn,"familyPrefix",{enumerable:!0,set:function(e){Lm.cssPrefix=e,M0.forEach(function(n){return n(Vn)})},get:function(){return Lm.cssPrefix}});Oh.FontAwesomeConfig=Vn;var M0=[];function EY(t){return M0.push(t),function(){M0.splice(M0.indexOf(t),1)}}var Yu=wA,rc={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function TY(t){if(!(!t||!hu)){var e=kr.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=t;for(var n=kr.head.childNodes,i=null,r=n.length-1;r>-1;r--){var o=n[r],l=(o.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(l)>-1&&(i=o)}return kr.head.insertBefore(e,i),t}}var SY="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function cv(){for(var t=12,e="";t-- >0;)e+=SY[Math.random()*62|0];return e}function eg(t){for(var e=[],n=(t||[]).length>>>0;n--;)e[n]=t[n];return e}function hM(t){return t.classList?eg(t.classList):(t.getAttribute("class")||"").split(" ").filter(function(e){return e})}function mN(t){return"".concat(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function CY(t){return Object.keys(t||{}).reduce(function(e,n){return e+"".concat(n,'="').concat(mN(t[n]),'" ')},"").trim()}function P2(t){return Object.keys(t||{}).reduce(function(e,n){return e+"".concat(n,": ").concat(t[n].trim(),";")},"")}function dM(t){return t.size!==rc.size||t.x!==rc.x||t.y!==rc.y||t.rotate!==rc.rotate||t.flipX||t.flipY}function AY(t){var e=t.transform,n=t.containerWidth,i=t.iconWidth,r={transform:"translate(".concat(n/2," 256)")},o="translate(".concat(e.x*32,", ").concat(e.y*32,") "),l="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "),s="rotate(".concat(e.rotate," 0 0)"),d={transform:"".concat(o," ").concat(l," ").concat(s)},p={transform:"translate(".concat(i/2*-1," -256)")};return{outer:r,inner:d,path:p}}function PY(t){var e=t.transform,n=t.width,i=n===void 0?wA:n,r=t.height,o=r===void 0?wA:r,l=t.startCentered,s=l===void 0?!1:l,d="";return s&&lN?d+="translate(".concat(e.x/Yu-i/2,"em, ").concat(e.y/Yu-o/2,"em) "):s?d+="translate(calc(-50% + ".concat(e.x/Yu,"em), calc(-50% + ").concat(e.y/Yu,"em)) "):d+="translate(".concat(e.x/Yu,"em, ").concat(e.y/Yu,"em) "),d+="scale(".concat(e.size/Yu*(e.flipX?-1:1),", ").concat(e.size/Yu*(e.flipY?-1:1),") "),d+="rotate(".concat(e.rotate,"deg) "),d}var IY=`:root, :host {
  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Solid";
  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Regular";
  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Light";
  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Thin";
  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";
  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-regular: normal 400 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-light: normal 300 1em/1 "Font Awesome 6 Sharp";
  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";
}

svg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {
  overflow: visible;
  box-sizing: content-box;
}

.svg-inline--fa {
  display: var(--fa-display, inline-block);
  height: 1em;
  overflow: visible;
  vertical-align: -0.125em;
}
.svg-inline--fa.fa-2xs {
  vertical-align: 0.1em;
}
.svg-inline--fa.fa-xs {
  vertical-align: 0em;
}
.svg-inline--fa.fa-sm {
  vertical-align: -0.0714285705em;
}
.svg-inline--fa.fa-lg {
  vertical-align: -0.2em;
}
.svg-inline--fa.fa-xl {
  vertical-align: -0.25em;
}
.svg-inline--fa.fa-2xl {
  vertical-align: -0.3125em;
}
.svg-inline--fa.fa-pull-left {
  margin-right: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-pull-right {
  margin-left: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-li {
  width: var(--fa-li-width, 2em);
  top: 0.25em;
}
.svg-inline--fa.fa-fw {
  width: var(--fa-fw-width, 1.25em);
}

.fa-layers svg.svg-inline--fa {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
}

.fa-layers-counter, .fa-layers-text {
  display: inline-block;
  position: absolute;
  text-align: center;
}

.fa-layers {
  display: inline-block;
  height: 1em;
  position: relative;
  text-align: center;
  vertical-align: -0.125em;
  width: 1em;
}
.fa-layers svg.svg-inline--fa {
  -webkit-transform-origin: center center;
          transform-origin: center center;
}

.fa-layers-text {
  left: 50%;
  top: 50%;
  -webkit-transform: translate(-50%, -50%);
          transform: translate(-50%, -50%);
  -webkit-transform-origin: center center;
          transform-origin: center center;
}

.fa-layers-counter {
  background-color: var(--fa-counter-background-color, #ff253a);
  border-radius: var(--fa-counter-border-radius, 1em);
  box-sizing: border-box;
  color: var(--fa-inverse, #fff);
  line-height: var(--fa-counter-line-height, 1);
  max-width: var(--fa-counter-max-width, 5em);
  min-width: var(--fa-counter-min-width, 1.5em);
  overflow: hidden;
  padding: var(--fa-counter-padding, 0.25em 0.5em);
  right: var(--fa-right, 0);
  text-overflow: ellipsis;
  top: var(--fa-top, 0);
  -webkit-transform: scale(var(--fa-counter-scale, 0.25));
          transform: scale(var(--fa-counter-scale, 0.25));
  -webkit-transform-origin: top right;
          transform-origin: top right;
}

.fa-layers-bottom-right {
  bottom: var(--fa-bottom, 0);
  right: var(--fa-right, 0);
  top: auto;
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: bottom right;
          transform-origin: bottom right;
}

.fa-layers-bottom-left {
  bottom: var(--fa-bottom, 0);
  left: var(--fa-left, 0);
  right: auto;
  top: auto;
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: bottom left;
          transform-origin: bottom left;
}

.fa-layers-top-right {
  top: var(--fa-top, 0);
  right: var(--fa-right, 0);
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: top right;
          transform-origin: top right;
}

.fa-layers-top-left {
  left: var(--fa-left, 0);
  right: auto;
  top: var(--fa-top, 0);
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: top left;
          transform-origin: top left;
}

.fa-1x {
  font-size: 1em;
}

.fa-2x {
  font-size: 2em;
}

.fa-3x {
  font-size: 3em;
}

.fa-4x {
  font-size: 4em;
}

.fa-5x {
  font-size: 5em;
}

.fa-6x {
  font-size: 6em;
}

.fa-7x {
  font-size: 7em;
}

.fa-8x {
  font-size: 8em;
}

.fa-9x {
  font-size: 9em;
}

.fa-10x {
  font-size: 10em;
}

.fa-2xs {
  font-size: 0.625em;
  line-height: 0.1em;
  vertical-align: 0.225em;
}

.fa-xs {
  font-size: 0.75em;
  line-height: 0.0833333337em;
  vertical-align: 0.125em;
}

.fa-sm {
  font-size: 0.875em;
  line-height: 0.0714285718em;
  vertical-align: 0.0535714295em;
}

.fa-lg {
  font-size: 1.25em;
  line-height: 0.05em;
  vertical-align: -0.075em;
}

.fa-xl {
  font-size: 1.5em;
  line-height: 0.0416666682em;
  vertical-align: -0.125em;
}

.fa-2xl {
  font-size: 2em;
  line-height: 0.03125em;
  vertical-align: -0.1875em;
}

.fa-fw {
  text-align: center;
  width: 1.25em;
}

.fa-ul {
  list-style-type: none;
  margin-left: var(--fa-li-margin, 2.5em);
  padding-left: 0;
}
.fa-ul > li {
  position: relative;
}

.fa-li {
  left: calc(var(--fa-li-width, 2em) * -1);
  position: absolute;
  text-align: center;
  width: var(--fa-li-width, 2em);
  line-height: inherit;
}

.fa-border {
  border-color: var(--fa-border-color, #eee);
  border-radius: var(--fa-border-radius, 0.1em);
  border-style: var(--fa-border-style, solid);
  border-width: var(--fa-border-width, 0.08em);
  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);
}

.fa-pull-left {
  float: left;
  margin-right: var(--fa-pull-margin, 0.3em);
}

.fa-pull-right {
  float: right;
  margin-left: var(--fa-pull-margin, 0.3em);
}

.fa-beat {
  -webkit-animation-name: fa-beat;
          animation-name: fa-beat;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);
          animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-bounce {
  -webkit-animation-name: fa-bounce;
          animation-name: fa-bounce;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
}

.fa-fade {
  -webkit-animation-name: fa-fade;
          animation-name: fa-fade;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-beat-fade {
  -webkit-animation-name: fa-beat-fade;
          animation-name: fa-beat-fade;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-flip {
  -webkit-animation-name: fa-flip;
          animation-name: fa-flip;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);
          animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-shake {
  -webkit-animation-name: fa-shake;
          animation-name: fa-shake;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, linear);
          animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin {
  -webkit-animation-name: fa-spin;
          animation-name: fa-spin;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 2s);
          animation-duration: var(--fa-animation-duration, 2s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, linear);
          animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin-reverse {
  --fa-animation-direction: reverse;
}

.fa-pulse,
.fa-spin-pulse {
  -webkit-animation-name: fa-spin;
          animation-name: fa-spin;
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));
          animation-timing-function: var(--fa-animation-timing, steps(8));
}

@media (prefers-reduced-motion: reduce) {
  .fa-beat,
.fa-bounce,
.fa-fade,
.fa-beat-fade,
.fa-flip,
.fa-pulse,
.fa-shake,
.fa-spin,
.fa-spin-pulse {
    -webkit-animation-delay: -1ms;
            animation-delay: -1ms;
    -webkit-animation-duration: 1ms;
            animation-duration: 1ms;
    -webkit-animation-iteration-count: 1;
            animation-iteration-count: 1;
    -webkit-transition-delay: 0s;
            transition-delay: 0s;
    -webkit-transition-duration: 0s;
            transition-duration: 0s;
  }
}
@-webkit-keyframes fa-beat {
  0%, 90% {
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  45% {
    -webkit-transform: scale(var(--fa-beat-scale, 1.25));
            transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@keyframes fa-beat {
  0%, 90% {
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  45% {
    -webkit-transform: scale(var(--fa-beat-scale, 1.25));
            transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@-webkit-keyframes fa-bounce {
  0% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  10% {
    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  100% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
}
@keyframes fa-bounce {
  0% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  10% {
    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  100% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
}
@-webkit-keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@-webkit-keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  50% {
    opacity: 1;
    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));
            transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  50% {
    opacity: 1;
    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));
            transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@-webkit-keyframes fa-flip {
  50% {
    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@keyframes fa-flip {
  50% {
    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@-webkit-keyframes fa-shake {
  0% {
    -webkit-transform: rotate(-15deg);
            transform: rotate(-15deg);
  }
  4% {
    -webkit-transform: rotate(15deg);
            transform: rotate(15deg);
  }
  8%, 24% {
    -webkit-transform: rotate(-18deg);
            transform: rotate(-18deg);
  }
  12%, 28% {
    -webkit-transform: rotate(18deg);
            transform: rotate(18deg);
  }
  16% {
    -webkit-transform: rotate(-22deg);
            transform: rotate(-22deg);
  }
  20% {
    -webkit-transform: rotate(22deg);
            transform: rotate(22deg);
  }
  32% {
    -webkit-transform: rotate(-12deg);
            transform: rotate(-12deg);
  }
  36% {
    -webkit-transform: rotate(12deg);
            transform: rotate(12deg);
  }
  40%, 100% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
}
@keyframes fa-shake {
  0% {
    -webkit-transform: rotate(-15deg);
            transform: rotate(-15deg);
  }
  4% {
    -webkit-transform: rotate(15deg);
            transform: rotate(15deg);
  }
  8%, 24% {
    -webkit-transform: rotate(-18deg);
            transform: rotate(-18deg);
  }
  12%, 28% {
    -webkit-transform: rotate(18deg);
            transform: rotate(18deg);
  }
  16% {
    -webkit-transform: rotate(-22deg);
            transform: rotate(-22deg);
  }
  20% {
    -webkit-transform: rotate(22deg);
            transform: rotate(22deg);
  }
  32% {
    -webkit-transform: rotate(-12deg);
            transform: rotate(-12deg);
  }
  36% {
    -webkit-transform: rotate(12deg);
            transform: rotate(12deg);
  }
  40%, 100% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
}
@-webkit-keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
            transform: rotate(360deg);
  }
}
@keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
            transform: rotate(360deg);
  }
}
.fa-rotate-90 {
  -webkit-transform: rotate(90deg);
          transform: rotate(90deg);
}

.fa-rotate-180 {
  -webkit-transform: rotate(180deg);
          transform: rotate(180deg);
}

.fa-rotate-270 {
  -webkit-transform: rotate(270deg);
          transform: rotate(270deg);
}

.fa-flip-horizontal {
  -webkit-transform: scale(-1, 1);
          transform: scale(-1, 1);
}

.fa-flip-vertical {
  -webkit-transform: scale(1, -1);
          transform: scale(1, -1);
}

.fa-flip-both,
.fa-flip-horizontal.fa-flip-vertical {
  -webkit-transform: scale(-1, -1);
          transform: scale(-1, -1);
}

.fa-rotate-by {
  -webkit-transform: rotate(var(--fa-rotate-angle, none));
          transform: rotate(var(--fa-rotate-angle, none));
}

.fa-stack {
  display: inline-block;
  vertical-align: middle;
  height: 2em;
  position: relative;
  width: 2.5em;
}

.fa-stack-1x,
.fa-stack-2x {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
  z-index: var(--fa-stack-z-index, auto);
}

.svg-inline--fa.fa-stack-1x {
  height: 1em;
  width: 1.25em;
}
.svg-inline--fa.fa-stack-2x {
  height: 2em;
  width: 2.5em;
}

.fa-inverse {
  color: var(--fa-inverse, #fff);
}

.sr-only,
.fa-sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.sr-only-focusable:not(:focus),
.fa-sr-only-focusable:not(:focus) {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.svg-inline--fa .fa-primary {
  fill: var(--fa-primary-color, currentColor);
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa .fa-secondary {
  fill: var(--fa-secondary-color, currentColor);
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-primary {
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-secondary {
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa mask .fa-primary,
.svg-inline--fa mask .fa-secondary {
  fill: black;
}

.fad.fa-inverse,
.fa-duotone.fa-inverse {
  color: var(--fa-inverse, #fff);
}`;function gN(){var t=cN,e=uN,n=Vn.cssPrefix,i=Vn.replacementClass,r=IY;if(n!==t||i!==e){var o=new RegExp("\\.".concat(t,"\\-"),"g"),l=new RegExp("\\--".concat(t,"\\-"),"g"),s=new RegExp("\\.".concat(e),"g");r=r.replace(o,".".concat(n,"-")).replace(l,"--".concat(n,"-")).replace(s,".".concat(i))}return r}var x4=!1;function _S(){Vn.autoAddCss&&!x4&&(TY(gN()),x4=!0)}var MY={mixout:function(){return{dom:{css:gN,insertCss:_S}}},hooks:function(){return{beforeDOMElementCreation:function(){_S()},beforeI2svg:function(){_S()}}}},Qc=Oh||{};Qc[Jc]||(Qc[Jc]={});Qc[Jc].styles||(Qc[Jc].styles={});Qc[Jc].hooks||(Qc[Jc].hooks={});Qc[Jc].shims||(Qc[Jc].shims=[]);var bl=Qc[Jc],yN=[],RY=function t(){kr.removeEventListener("DOMContentLoaded",t),aw=1,yN.map(function(e){return e()})},aw=!1;hu&&(aw=(kr.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(kr.readyState),aw||kr.addEventListener("DOMContentLoaded",RY));function LY(t){hu&&(aw?setTimeout(t,0):yN.push(t))}function p_(t){var e=t.tag,n=t.attributes,i=n===void 0?{}:n,r=t.children,o=r===void 0?[]:r;return typeof t=="string"?mN(t):"<".concat(e," ").concat(CY(i),">").concat(o.map(p_).join(""),"</").concat(e,">")}function w4(t,e,n){if(t&&t[e]&&t[e][n])return{prefix:e,iconName:n,icon:t[e][n]}}var OY=function(e,n){return function(i,r,o,l){return e.call(n,i,r,o,l)}},bS=function(e,n,i,r){var o=Object.keys(e),l=o.length,s=r!==void 0?OY(n,r):n,d,p,y;for(i===void 0?(d=1,y=e[o[0]]):(d=0,y=i);d<l;d++)p=o[d],y=s(y,e[p],p,e);return y};function DY(t){for(var e=[],n=0,i=t.length;n<i;){var r=t.charCodeAt(n++);if(r>=55296&&r<=56319&&n<i){var o=t.charCodeAt(n++);(o&64512)==56320?e.push(((r&1023)<<10)+(o&1023)+65536):(e.push(r),n--)}else e.push(r)}return e}function TA(t){var e=DY(t);return e.length===1?e[0].toString(16):null}function kY(t,e){var n=t.length,i=t.charCodeAt(e),r;return i>=55296&&i<=56319&&n>e+1&&(r=t.charCodeAt(e+1),r>=56320&&r<=57343)?(i-55296)*1024+r-56320+65536:i}function E4(t){return Object.keys(t).reduce(function(e,n){var i=t[n],r=!!i.icon;return r?e[i.iconName]=i.icon:e[n]=i,e},{})}function SA(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=n.skipHooks,r=i===void 0?!1:i,o=E4(e);typeof bl.hooks.addPack=="function"&&!r?bl.hooks.addPack(t,E4(e)):bl.styles[t]=Ln(Ln({},bl.styles[t]||{}),o),t==="fas"&&SA("fa",e)}var bb,xb,wb,Kp=bl.styles,FY=bl.shims,BY=(bb={},Fo(bb,Dr,Object.values(av[Dr])),Fo(bb,ho,Object.values(av[ho])),bb),fM=null,vN={},_N={},bN={},xN={},wN={},zY=(xb={},Fo(xb,Dr,Object.keys(ov[Dr])),Fo(xb,ho,Object.keys(ov[ho])),xb);function NY(t){return~_Y.indexOf(t)}function UY(t,e){var n=e.split("-"),i=n[0],r=n.slice(1).join("-");return i===t&&r!==""&&!NY(r)?r:null}var EN=function(){var e=function(o){return bS(Kp,function(l,s,d){return l[d]=bS(s,o,{}),l},{})};vN=e(function(r,o,l){if(o[3]&&(r[o[3]]=l),o[2]){var s=o[2].filter(function(d){return typeof d=="number"});s.forEach(function(d){r[d.toString(16)]=l})}return r}),_N=e(function(r,o,l){if(r[l]=l,o[2]){var s=o[2].filter(function(d){return typeof d=="string"});s.forEach(function(d){r[d]=l})}return r}),wN=e(function(r,o,l){var s=o[2];return r[l]=l,s.forEach(function(d){r[d]=l}),r});var n="far"in Kp||Vn.autoFetchSvg,i=bS(FY,function(r,o){var l=o[0],s=o[1],d=o[2];return s==="far"&&!n&&(s="fas"),typeof l=="string"&&(r.names[l]={prefix:s,iconName:d}),typeof l=="number"&&(r.unicodes[l.toString(16)]={prefix:s,iconName:d}),r},{names:{},unicodes:{}});bN=i.names,xN=i.unicodes,fM=I2(Vn.styleDefault,{family:Vn.familyDefault})};EY(function(t){fM=I2(t.styleDefault,{family:Vn.familyDefault})});EN();function pM(t,e){return(vN[t]||{})[e]}function VY(t,e){return(_N[t]||{})[e]}function $d(t,e){return(wN[t]||{})[e]}function TN(t){return bN[t]||{prefix:null,iconName:null}}function jY(t){var e=xN[t],n=pM("fas",t);return e||(n?{prefix:"fas",iconName:n}:null)||{prefix:null,iconName:null}}function Dh(){return fM}var mM=function(){return{prefix:null,iconName:null,rest:[]}};function I2(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.family,i=n===void 0?Dr:n,r=ov[i][t],o=sv[i][t]||sv[i][r],l=t in bl.styles?t:null;return o||l||null}var T4=(wb={},Fo(wb,Dr,Object.keys(av[Dr])),Fo(wb,ho,Object.keys(av[ho])),wb);function M2(t){var e,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.skipLookups,r=i===void 0?!1:i,o=(e={},Fo(e,Dr,"".concat(Vn.cssPrefix,"-").concat(Dr)),Fo(e,ho,"".concat(Vn.cssPrefix,"-").concat(ho)),e),l=null,s=Dr;(t.includes(o[Dr])||t.some(function(p){return T4[Dr].includes(p)}))&&(s=Dr),(t.includes(o[ho])||t.some(function(p){return T4[ho].includes(p)}))&&(s=ho);var d=t.reduce(function(p,y){var v=UY(Vn.cssPrefix,y);if(Kp[y]?(y=BY[s].includes(y)?fY[s][y]:y,l=y,p.prefix=y):zY[s].indexOf(y)>-1?(l=y,p.prefix=I2(y,{family:s})):v?p.iconName=v:y!==Vn.replacementClass&&y!==o[Dr]&&y!==o[ho]&&p.rest.push(y),!r&&p.prefix&&p.iconName){var w=l==="fa"?TN(p.iconName):{},T=$d(p.prefix,p.iconName);w.prefix&&(l=null),p.iconName=w.iconName||T||p.iconName,p.prefix=w.prefix||p.prefix,p.prefix==="far"&&!Kp.far&&Kp.fas&&!Vn.autoFetchSvg&&(p.prefix="fas")}return p},mM());return(t.includes("fa-brands")||t.includes("fab"))&&(d.prefix="fab"),(t.includes("fa-duotone")||t.includes("fad"))&&(d.prefix="fad"),!d.prefix&&s===ho&&(Kp.fass||Vn.autoFetchSvg)&&(d.prefix="fass",d.iconName=$d(d.prefix,d.iconName)||d.iconName),(d.prefix==="fa"||l==="fa")&&(d.prefix=Dh()||"fas"),d}var $Y=function(){function t(){tY(this,t),this.definitions={}}return nY(t,[{key:"add",value:function(){for(var n=this,i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];var l=r.reduce(this._pullDefinitions,{});Object.keys(l).forEach(function(s){n.definitions[s]=Ln(Ln({},n.definitions[s]||{}),l[s]),SA(s,l[s]);var d=av[Dr][s];d&&SA(d,l[s]),EN()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(n,i){var r=i.prefix&&i.iconName&&i.icon?{0:i}:i;return Object.keys(r).map(function(o){var l=r[o],s=l.prefix,d=l.iconName,p=l.icon,y=p[2];n[s]||(n[s]={}),y.length>0&&y.forEach(function(v){typeof v=="string"&&(n[s][v]=p)}),n[s][d]=p}),n}}]),t}(),S4=[],Xp={},pm={},GY=Object.keys(pm);function HY(t,e){var n=e.mixoutsTo;return S4=t,Xp={},Object.keys(pm).forEach(function(i){GY.indexOf(i)===-1&&delete pm[i]}),S4.forEach(function(i){var r=i.mixout?i.mixout():{};if(Object.keys(r).forEach(function(l){typeof r[l]=="function"&&(n[l]=r[l]),sw(r[l])==="object"&&Object.keys(r[l]).forEach(function(s){n[l]||(n[l]={}),n[l][s]=r[l][s]})}),i.hooks){var o=i.hooks();Object.keys(o).forEach(function(l){Xp[l]||(Xp[l]=[]),Xp[l].push(o[l])})}i.provides&&i.provides(pm)}),n}function CA(t,e){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];var o=Xp[t]||[];return o.forEach(function(l){e=l.apply(null,[e].concat(i))}),e}function lf(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];var r=Xp[t]||[];r.forEach(function(o){o.apply(null,n)})}function eu(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);return pm[t]?pm[t].apply(null,e):void 0}function AA(t){t.prefix==="fa"&&(t.prefix="fas");var e=t.iconName,n=t.prefix||Dh();if(e)return e=$d(n,e)||e,w4(SN.definitions,n,e)||w4(bl.styles,n,e)}var SN=new $Y,WY=function(){Vn.autoReplaceSvg=!1,Vn.observeMutations=!1,lf("noAuto")},KY={i2svg:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return hu?(lf("beforeI2svg",e),eu("pseudoElements2svg",e),eu("i2svg",e)):Promise.reject("Operation requires a DOM of some kind.")},watch:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.autoReplaceSvgRoot;Vn.autoReplaceSvg===!1&&(Vn.autoReplaceSvg=!0),Vn.observeMutations=!0,LY(function(){ZY({autoReplaceSvgRoot:n}),lf("watch",e)})}},XY={icon:function(e){if(e===null)return null;if(sw(e)==="object"&&e.prefix&&e.iconName)return{prefix:e.prefix,iconName:$d(e.prefix,e.iconName)||e.iconName};if(Array.isArray(e)&&e.length===2){var n=e[1].indexOf("fa-")===0?e[1].slice(3):e[1],i=I2(e[0]);return{prefix:i,iconName:$d(i,n)||n}}if(typeof e=="string"&&(e.indexOf("".concat(Vn.cssPrefix,"-"))>-1||e.match(pY))){var r=M2(e.split(" "),{skipLookups:!0});return{prefix:r.prefix||Dh(),iconName:$d(r.prefix,r.iconName)||r.iconName}}if(typeof e=="string"){var o=Dh();return{prefix:o,iconName:$d(o,e)||e}}}},Ca={noAuto:WY,config:Vn,dom:KY,parse:XY,library:SN,findIconDefinition:AA,toHtml:p_},ZY=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.autoReplaceSvgRoot,i=n===void 0?kr:n;(Object.keys(bl.styles).length>0||Vn.autoFetchSvg)&&hu&&Vn.autoReplaceSvg&&Ca.dom.i2svg({node:i})};function R2(t,e){return Object.defineProperty(t,"abstract",{get:e}),Object.defineProperty(t,"html",{get:function(){return t.abstract.map(function(i){return p_(i)})}}),Object.defineProperty(t,"node",{get:function(){if(hu){var i=kr.createElement("div");return i.innerHTML=t.html,i.children}}}),t}function qY(t){var e=t.children,n=t.main,i=t.mask,r=t.attributes,o=t.styles,l=t.transform;if(dM(l)&&n.found&&!i.found){var s=n.width,d=n.height,p={x:s/d/2,y:.5};r.style=P2(Ln(Ln({},o),{},{"transform-origin":"".concat(p.x+l.x/16,"em ").concat(p.y+l.y/16,"em")}))}return[{tag:"svg",attributes:r,children:e}]}function YY(t){var e=t.prefix,n=t.iconName,i=t.children,r=t.attributes,o=t.symbol,l=o===!0?"".concat(e,"-").concat(Vn.cssPrefix,"-").concat(n):o;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:Ln(Ln({},r),{},{id:l}),children:i}]}]}function gM(t){var e=t.icons,n=e.main,i=e.mask,r=t.prefix,o=t.iconName,l=t.transform,s=t.symbol,d=t.title,p=t.maskId,y=t.titleId,v=t.extra,w=t.watchable,T=w===void 0?!1:w,I=i.found?i:n,L=I.width,k=I.height,F=r==="fak",B=[Vn.replacementClass,o?"".concat(Vn.cssPrefix,"-").concat(o):""].filter(function(J){return v.classes.indexOf(J)===-1}).filter(function(J){return J!==""||!!J}).concat(v.classes).join(" "),G={children:[],attributes:Ln(Ln({},v.attributes),{},{"data-prefix":r,"data-icon":o,class:B,role:v.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(L," ").concat(k)})},U=F&&!~v.classes.indexOf("fa-fw")?{width:"".concat(L/k*16*.0625,"em")}:{};T&&(G.attributes[af]=""),d&&(G.children.push({tag:"title",attributes:{id:G.attributes["aria-labelledby"]||"title-".concat(y||cv())},children:[d]}),delete G.attributes.title);var ee=Ln(Ln({},G),{},{prefix:r,iconName:o,main:n,mask:i,maskId:p,transform:l,symbol:s,styles:Ln(Ln({},U),v.styles)}),ne=i.found&&n.found?eu("generateAbstractMask",ee)||{children:[],attributes:{}}:eu("generateAbstractIcon",ee)||{children:[],attributes:{}},ye=ne.children,fe=ne.attributes;return ee.children=ye,ee.attributes=fe,s?YY(ee):qY(ee)}function C4(t){var e=t.content,n=t.width,i=t.height,r=t.transform,o=t.title,l=t.extra,s=t.watchable,d=s===void 0?!1:s,p=Ln(Ln(Ln({},l.attributes),o?{title:o}:{}),{},{class:l.classes.join(" ")});d&&(p[af]="");var y=Ln({},l.styles);dM(r)&&(y.transform=PY({transform:r,startCentered:!0,width:n,height:i}),y["-webkit-transform"]=y.transform);var v=P2(y);v.length>0&&(p.style=v);var w=[];return w.push({tag:"span",attributes:p,children:[e]}),o&&w.push({tag:"span",attributes:{class:"sr-only"},children:[o]}),w}function JY(t){var e=t.content,n=t.title,i=t.extra,r=Ln(Ln(Ln({},i.attributes),n?{title:n}:{}),{},{class:i.classes.join(" ")}),o=P2(i.styles);o.length>0&&(r.style=o);var l=[];return l.push({tag:"span",attributes:r,children:[e]}),n&&l.push({tag:"span",attributes:{class:"sr-only"},children:[n]}),l}var xS=bl.styles;function PA(t){var e=t[0],n=t[1],i=t.slice(4),r=sM(i,1),o=r[0],l=null;return Array.isArray(o)?l={tag:"g",attributes:{class:"".concat(Vn.cssPrefix,"-").concat(jd.GROUP)},children:[{tag:"path",attributes:{class:"".concat(Vn.cssPrefix,"-").concat(jd.SECONDARY),fill:"currentColor",d:o[0]}},{tag:"path",attributes:{class:"".concat(Vn.cssPrefix,"-").concat(jd.PRIMARY),fill:"currentColor",d:o[1]}}]}:l={tag:"path",attributes:{fill:"currentColor",d:o}},{found:!0,width:e,height:n,icon:l}}var QY={found:!1,width:512,height:512};function eJ(t,e){!hN&&!Vn.showMissingIcons&&t&&console.error('Icon with name "'.concat(t,'" and prefix "').concat(e,'" is missing.'))}function IA(t,e){var n=e;return e==="fa"&&Vn.styleDefault!==null&&(e=Dh()),new Promise(function(i,r){if(eu("missingIconAbstract"),n==="fa"){var o=TN(t)||{};t=o.iconName||t,e=o.prefix||e}if(t&&e&&xS[e]&&xS[e][t]){var l=xS[e][t];return i(PA(l))}eJ(t,e),i(Ln(Ln({},QY),{},{icon:Vn.showMissingIcons&&t?eu("missingIconAbstract")||{}:{}}))})}var A4=function(){},MA=Vn.measurePerformance&&pb&&pb.mark&&pb.measure?pb:{mark:A4,measure:A4},n0='FA "6.4.2"',tJ=function(e){return MA.mark("".concat(n0," ").concat(e," begins")),function(){return CN(e)}},CN=function(e){MA.mark("".concat(n0," ").concat(e," ends")),MA.measure("".concat(n0," ").concat(e),"".concat(n0," ").concat(e," begins"),"".concat(n0," ").concat(e," ends"))},yM={begin:tJ,end:CN},xx=function(){};function P4(t){var e=t.getAttribute?t.getAttribute(af):null;return typeof e=="string"}function nJ(t){var e=t.getAttribute?t.getAttribute(lM):null,n=t.getAttribute?t.getAttribute(cM):null;return e&&n}function iJ(t){return t&&t.classList&&t.classList.contains&&t.classList.contains(Vn.replacementClass)}function rJ(){if(Vn.autoReplaceSvg===!0)return wx.replace;var t=wx[Vn.autoReplaceSvg];return t||wx.replace}function oJ(t){return kr.createElementNS("http://www.w3.org/2000/svg",t)}function sJ(t){return kr.createElement(t)}function AN(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.ceFn,i=n===void 0?t.tag==="svg"?oJ:sJ:n;if(typeof t=="string")return kr.createTextNode(t);var r=i(t.tag);Object.keys(t.attributes||[]).forEach(function(l){r.setAttribute(l,t.attributes[l])});var o=t.children||[];return o.forEach(function(l){r.appendChild(AN(l,{ceFn:i}))}),r}function aJ(t){var e=" ".concat(t.outerHTML," ");return e="".concat(e,"Font Awesome fontawesome.com "),e}var wx={replace:function(e){var n=e[0];if(n.parentNode)if(e[1].forEach(function(r){n.parentNode.insertBefore(AN(r),n)}),n.getAttribute(af)===null&&Vn.keepOriginalSource){var i=kr.createComment(aJ(n));n.parentNode.replaceChild(i,n)}else n.remove()},nest:function(e){var n=e[0],i=e[1];if(~hM(n).indexOf(Vn.replacementClass))return wx.replace(e);var r=new RegExp("".concat(Vn.cssPrefix,"-.*"));if(delete i[0].attributes.id,i[0].attributes.class){var o=i[0].attributes.class.split(" ").reduce(function(s,d){return d===Vn.replacementClass||d.match(r)?s.toSvg.push(d):s.toNode.push(d),s},{toNode:[],toSvg:[]});i[0].attributes.class=o.toSvg.join(" "),o.toNode.length===0?n.removeAttribute("class"):n.setAttribute("class",o.toNode.join(" "))}var l=i.map(function(s){return p_(s)}).join(`
`);n.setAttribute(af,""),n.innerHTML=l}};function I4(t){t()}function PN(t,e){var n=typeof e=="function"?e:xx;if(t.length===0)n();else{var i=I4;Vn.mutateApproach===hY&&(i=Oh.requestAnimationFrame||I4),i(function(){var r=rJ(),o=yM.begin("mutate");t.map(r),o(),n()})}}var vM=!1;function IN(){vM=!0}function RA(){vM=!1}var lw=null;function M4(t){if(_4&&Vn.observeMutations){var e=t.treeCallback,n=e===void 0?xx:e,i=t.nodeCallback,r=i===void 0?xx:i,o=t.pseudoElementsCallback,l=o===void 0?xx:o,s=t.observeMutationsRoot,d=s===void 0?kr:s;lw=new _4(function(p){if(!vM){var y=Dh();eg(p).forEach(function(v){if(v.type==="childList"&&v.addedNodes.length>0&&!P4(v.addedNodes[0])&&(Vn.searchPseudoElements&&l(v.target),n(v.target)),v.type==="attributes"&&v.target.parentNode&&Vn.searchPseudoElements&&l(v.target.parentNode),v.type==="attributes"&&P4(v.target)&&~vY.indexOf(v.attributeName))if(v.attributeName==="class"&&nJ(v.target)){var w=M2(hM(v.target)),T=w.prefix,I=w.iconName;v.target.setAttribute(lM,T||y),I&&v.target.setAttribute(cM,I)}else iJ(v.target)&&r(v.target)})}}),hu&&lw.observe(d,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}}function lJ(){lw&&lw.disconnect()}function cJ(t){var e=t.getAttribute("style"),n=[];return e&&(n=e.split(";").reduce(function(i,r){var o=r.split(":"),l=o[0],s=o.slice(1);return l&&s.length>0&&(i[l]=s.join(":").trim()),i},{})),n}function uJ(t){var e=t.getAttribute("data-prefix"),n=t.getAttribute("data-icon"),i=t.innerText!==void 0?t.innerText.trim():"",r=M2(hM(t));return r.prefix||(r.prefix=Dh()),e&&n&&(r.prefix=e,r.iconName=n),r.iconName&&r.prefix||(r.prefix&&i.length>0&&(r.iconName=VY(r.prefix,t.innerText)||pM(r.prefix,TA(t.innerText))),!r.iconName&&Vn.autoFetchSvg&&t.firstChild&&t.firstChild.nodeType===Node.TEXT_NODE&&(r.iconName=t.firstChild.data)),r}function hJ(t){var e=eg(t.attributes).reduce(function(r,o){return r.name!=="class"&&r.name!=="style"&&(r[o.name]=o.value),r},{}),n=t.getAttribute("title"),i=t.getAttribute("data-fa-title-id");return Vn.autoA11y&&(n?e["aria-labelledby"]="".concat(Vn.replacementClass,"-title-").concat(i||cv()):(e["aria-hidden"]="true",e.focusable="false")),e}function dJ(){return{iconName:null,title:null,titleId:null,prefix:null,transform:rc,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}function R4(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{styleParser:!0},n=uJ(t),i=n.iconName,r=n.prefix,o=n.rest,l=hJ(t),s=CA("parseNodeAttributes",{},t),d=e.styleParser?cJ(t):[];return Ln({iconName:i,title:t.getAttribute("title"),titleId:t.getAttribute("data-fa-title-id"),prefix:r,transform:rc,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:o,styles:d,attributes:l}},s)}var fJ=bl.styles;function MN(t){var e=Vn.autoReplaceSvg==="nest"?R4(t,{styleParser:!1}):R4(t);return~e.extra.classes.indexOf(dN)?eu("generateLayersText",t,e):eu("generateSvgReplacementMutation",t,e)}var kh=new Set;uM.map(function(t){kh.add("fa-".concat(t))});Object.keys(ov[Dr]).map(kh.add.bind(kh));Object.keys(ov[ho]).map(kh.add.bind(kh));kh=d_(kh);function L4(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!hu)return Promise.resolve();var n=kr.documentElement.classList,i=function(v){return n.add("".concat(b4,"-").concat(v))},r=function(v){return n.remove("".concat(b4,"-").concat(v))},o=Vn.autoFetchSvg?kh:uM.map(function(y){return"fa-".concat(y)}).concat(Object.keys(fJ));o.includes("fa")||o.push("fa");var l=[".".concat(dN,":not([").concat(af,"])")].concat(o.map(function(y){return".".concat(y,":not([").concat(af,"])")})).join(", ");if(l.length===0)return Promise.resolve();var s=[];try{s=eg(t.querySelectorAll(l))}catch{}if(s.length>0)i("pending"),r("complete");else return Promise.resolve();var d=yM.begin("onTree"),p=s.reduce(function(y,v){try{var w=MN(v);w&&y.push(w)}catch(T){hN||T.name==="MissingIcon"&&console.error(T)}return y},[]);return new Promise(function(y,v){Promise.all(p).then(function(w){PN(w,function(){i("active"),i("complete"),r("pending"),typeof e=="function"&&e(),d(),y()})}).catch(function(w){d(),v(w)})})}function pJ(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;MN(t).then(function(n){n&&PN([n],e)})}function mJ(t){return function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=(e||{}).icon?e:AA(e||{}),r=n.mask;return r&&(r=(r||{}).icon?r:AA(r||{})),t(i,Ln(Ln({},n),{},{mask:r}))}}var gJ=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.transform,r=i===void 0?rc:i,o=n.symbol,l=o===void 0?!1:o,s=n.mask,d=s===void 0?null:s,p=n.maskId,y=p===void 0?null:p,v=n.title,w=v===void 0?null:v,T=n.titleId,I=T===void 0?null:T,L=n.classes,k=L===void 0?[]:L,F=n.attributes,B=F===void 0?{}:F,G=n.styles,U=G===void 0?{}:G;if(e){var ee=e.prefix,ne=e.iconName,ye=e.icon;return R2(Ln({type:"icon"},e),function(){return lf("beforeDOMElementCreation",{iconDefinition:e,params:n}),Vn.autoA11y&&(w?B["aria-labelledby"]="".concat(Vn.replacementClass,"-title-").concat(I||cv()):(B["aria-hidden"]="true",B.focusable="false")),gM({icons:{main:PA(ye),mask:d?PA(d.icon):{found:!1,width:null,height:null,icon:{}}},prefix:ee,iconName:ne,transform:Ln(Ln({},rc),r),symbol:l,title:w,maskId:y,titleId:I,extra:{attributes:B,styles:U,classes:k}})})}},yJ={mixout:function(){return{icon:mJ(gJ)}},hooks:function(){return{mutationObserverCallbacks:function(n){return n.treeCallback=L4,n.nodeCallback=pJ,n}}},provides:function(e){e.i2svg=function(n){var i=n.node,r=i===void 0?kr:i,o=n.callback,l=o===void 0?function(){}:o;return L4(r,l)},e.generateSvgReplacementMutation=function(n,i){var r=i.iconName,o=i.title,l=i.titleId,s=i.prefix,d=i.transform,p=i.symbol,y=i.mask,v=i.maskId,w=i.extra;return new Promise(function(T,I){Promise.all([IA(r,s),y.iconName?IA(y.iconName,y.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(function(L){var k=sM(L,2),F=k[0],B=k[1];T([n,gM({icons:{main:F,mask:B},prefix:s,iconName:r,transform:d,symbol:p,maskId:v,title:o,titleId:l,extra:w,watchable:!0})])}).catch(I)})},e.generateAbstractIcon=function(n){var i=n.children,r=n.attributes,o=n.main,l=n.transform,s=n.styles,d=P2(s);d.length>0&&(r.style=d);var p;return dM(l)&&(p=eu("generateAbstractTransformGrouping",{main:o,transform:l,containerWidth:o.width,iconWidth:o.width})),i.push(p||o.icon),{children:i,attributes:r}}}},vJ={mixout:function(){return{layer:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=i.classes,o=r===void 0?[]:r;return R2({type:"layer"},function(){lf("beforeDOMElementCreation",{assembler:n,params:i});var l=[];return n(function(s){Array.isArray(s)?s.map(function(d){l=l.concat(d.abstract)}):l=l.concat(s.abstract)}),[{tag:"span",attributes:{class:["".concat(Vn.cssPrefix,"-layers")].concat(d_(o)).join(" ")},children:l}]})}}}},_J={mixout:function(){return{counter:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=i.title,o=r===void 0?null:r,l=i.classes,s=l===void 0?[]:l,d=i.attributes,p=d===void 0?{}:d,y=i.styles,v=y===void 0?{}:y;return R2({type:"counter",content:n},function(){return lf("beforeDOMElementCreation",{content:n,params:i}),JY({content:n.toString(),title:o,extra:{attributes:p,styles:v,classes:["".concat(Vn.cssPrefix,"-layers-counter")].concat(d_(s))}})})}}}},bJ={mixout:function(){return{text:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=i.transform,o=r===void 0?rc:r,l=i.title,s=l===void 0?null:l,d=i.classes,p=d===void 0?[]:d,y=i.attributes,v=y===void 0?{}:y,w=i.styles,T=w===void 0?{}:w;return R2({type:"text",content:n},function(){return lf("beforeDOMElementCreation",{content:n,params:i}),C4({content:n,transform:Ln(Ln({},rc),o),title:s,extra:{attributes:v,styles:T,classes:["".concat(Vn.cssPrefix,"-layers-text")].concat(d_(p))}})})}}},provides:function(e){e.generateLayersText=function(n,i){var r=i.title,o=i.transform,l=i.extra,s=null,d=null;if(lN){var p=parseInt(getComputedStyle(n).fontSize,10),y=n.getBoundingClientRect();s=y.width/p,d=y.height/p}return Vn.autoA11y&&!r&&(l.attributes["aria-hidden"]="true"),Promise.resolve([n,C4({content:n.innerHTML,width:s,height:d,transform:o,title:r,extra:l,watchable:!0})])}}},xJ=new RegExp('"',"ug"),O4=[1105920,1112319];function wJ(t){var e=t.replace(xJ,""),n=kY(e,0),i=n>=O4[0]&&n<=O4[1],r=e.length===2?e[0]===e[1]:!1;return{value:TA(r?e[0]:e),isSecondary:i||r}}function D4(t,e){var n="".concat(uY).concat(e.replace(":","-"));return new Promise(function(i,r){if(t.getAttribute(n)!==null)return i();var o=eg(t.children),l=o.filter(function(ye){return ye.getAttribute(EA)===e})[0],s=Oh.getComputedStyle(t,e),d=s.getPropertyValue("font-family").match(mY),p=s.getPropertyValue("font-weight"),y=s.getPropertyValue("content");if(l&&!d)return t.removeChild(l),i();if(d&&y!=="none"&&y!==""){var v=s.getPropertyValue("content"),w=~["Sharp"].indexOf(d[2])?ho:Dr,T=~["Solid","Regular","Light","Thin","Duotone","Brands","Kit"].indexOf(d[2])?sv[w][d[2].toLowerCase()]:gY[w][p],I=wJ(v),L=I.value,k=I.isSecondary,F=d[0].startsWith("FontAwesome"),B=pM(T,L),G=B;if(F){var U=jY(L);U.iconName&&U.prefix&&(B=U.iconName,T=U.prefix)}if(B&&!k&&(!l||l.getAttribute(lM)!==T||l.getAttribute(cM)!==G)){t.setAttribute(n,G),l&&t.removeChild(l);var ee=dJ(),ne=ee.extra;ne.attributes[EA]=e,IA(B,T).then(function(ye){var fe=gM(Ln(Ln({},ee),{},{icons:{main:ye,mask:mM()},prefix:T,iconName:G,extra:ne,watchable:!0})),J=kr.createElementNS("http://www.w3.org/2000/svg","svg");e==="::before"?t.insertBefore(J,t.firstChild):t.appendChild(J),J.outerHTML=fe.map(function(Ce){return p_(Ce)}).join(`
`),t.removeAttribute(n),i()}).catch(r)}else i()}else i()})}function EJ(t){return Promise.all([D4(t,"::before"),D4(t,"::after")])}function TJ(t){return t.parentNode!==document.head&&!~dY.indexOf(t.tagName.toUpperCase())&&!t.getAttribute(EA)&&(!t.parentNode||t.parentNode.tagName!=="svg")}function k4(t){if(hu)return new Promise(function(e,n){var i=eg(t.querySelectorAll("*")).filter(TJ).map(EJ),r=yM.begin("searchPseudoElements");IN(),Promise.all(i).then(function(){r(),RA(),e()}).catch(function(){r(),RA(),n()})})}var SJ={hooks:function(){return{mutationObserverCallbacks:function(n){return n.pseudoElementsCallback=k4,n}}},provides:function(e){e.pseudoElements2svg=function(n){var i=n.node,r=i===void 0?kr:i;Vn.searchPseudoElements&&k4(r)}}},F4=!1,CJ={mixout:function(){return{dom:{unwatch:function(){IN(),F4=!0}}}},hooks:function(){return{bootstrap:function(){M4(CA("mutationObserverCallbacks",{}))},noAuto:function(){lJ()},watch:function(n){var i=n.observeMutationsRoot;F4?RA():M4(CA("mutationObserverCallbacks",{observeMutationsRoot:i}))}}}},B4=function(e){var n={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return e.toLowerCase().split(" ").reduce(function(i,r){var o=r.toLowerCase().split("-"),l=o[0],s=o.slice(1).join("-");if(l&&s==="h")return i.flipX=!0,i;if(l&&s==="v")return i.flipY=!0,i;if(s=parseFloat(s),isNaN(s))return i;switch(l){case"grow":i.size=i.size+s;break;case"shrink":i.size=i.size-s;break;case"left":i.x=i.x-s;break;case"right":i.x=i.x+s;break;case"up":i.y=i.y-s;break;case"down":i.y=i.y+s;break;case"rotate":i.rotate=i.rotate+s;break}return i},n)},AJ={mixout:function(){return{parse:{transform:function(n){return B4(n)}}}},hooks:function(){return{parseNodeAttributes:function(n,i){var r=i.getAttribute("data-fa-transform");return r&&(n.transform=B4(r)),n}}},provides:function(e){e.generateAbstractTransformGrouping=function(n){var i=n.main,r=n.transform,o=n.containerWidth,l=n.iconWidth,s={transform:"translate(".concat(o/2," 256)")},d="translate(".concat(r.x*32,", ").concat(r.y*32,") "),p="scale(".concat(r.size/16*(r.flipX?-1:1),", ").concat(r.size/16*(r.flipY?-1:1),") "),y="rotate(".concat(r.rotate," 0 0)"),v={transform:"".concat(d," ").concat(p," ").concat(y)},w={transform:"translate(".concat(l/2*-1," -256)")},T={outer:s,inner:v,path:w};return{tag:"g",attributes:Ln({},T.outer),children:[{tag:"g",attributes:Ln({},T.inner),children:[{tag:i.icon.tag,children:i.icon.children,attributes:Ln(Ln({},i.icon.attributes),T.path)}]}]}}}},wS={x:0,y:0,width:"100%",height:"100%"};function z4(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return t.attributes&&(t.attributes.fill||e)&&(t.attributes.fill="black"),t}function PJ(t){return t.tag==="g"?t.children:[t]}var IJ={hooks:function(){return{parseNodeAttributes:function(n,i){var r=i.getAttribute("data-fa-mask"),o=r?M2(r.split(" ").map(function(l){return l.trim()})):mM();return o.prefix||(o.prefix=Dh()),n.mask=o,n.maskId=i.getAttribute("data-fa-mask-id"),n}}},provides:function(e){e.generateAbstractMask=function(n){var i=n.children,r=n.attributes,o=n.main,l=n.mask,s=n.maskId,d=n.transform,p=o.width,y=o.icon,v=l.width,w=l.icon,T=AY({transform:d,containerWidth:v,iconWidth:p}),I={tag:"rect",attributes:Ln(Ln({},wS),{},{fill:"white"})},L=y.children?{children:y.children.map(z4)}:{},k={tag:"g",attributes:Ln({},T.inner),children:[z4(Ln({tag:y.tag,attributes:Ln(Ln({},y.attributes),T.path)},L))]},F={tag:"g",attributes:Ln({},T.outer),children:[k]},B="mask-".concat(s||cv()),G="clip-".concat(s||cv()),U={tag:"mask",attributes:Ln(Ln({},wS),{},{id:B,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[I,F]},ee={tag:"defs",children:[{tag:"clipPath",attributes:{id:G},children:PJ(w)},U]};return i.push(ee,{tag:"rect",attributes:Ln({fill:"currentColor","clip-path":"url(#".concat(G,")"),mask:"url(#".concat(B,")")},wS)}),{children:i,attributes:r}}}},MJ={provides:function(e){var n=!1;Oh.matchMedia&&(n=Oh.matchMedia("(prefers-reduced-motion: reduce)").matches),e.missingIconAbstract=function(){var i=[],r={fill:"currentColor"},o={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};i.push({tag:"path",attributes:Ln(Ln({},r),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});var l=Ln(Ln({},o),{},{attributeName:"opacity"}),s={tag:"circle",attributes:Ln(Ln({},r),{},{cx:"256",cy:"364",r:"28"}),children:[]};return n||s.children.push({tag:"animate",attributes:Ln(Ln({},o),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:Ln(Ln({},l),{},{values:"1;0;1;1;0;1;"})}),i.push(s),i.push({tag:"path",attributes:Ln(Ln({},r),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:n?[]:[{tag:"animate",attributes:Ln(Ln({},l),{},{values:"1;0;0;0;0;1;"})}]}),n||i.push({tag:"path",attributes:Ln(Ln({},r),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:Ln(Ln({},l),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:i}}}},RJ={hooks:function(){return{parseNodeAttributes:function(n,i){var r=i.getAttribute("data-fa-symbol"),o=r===null?!1:r===""?!0:r;return n.symbol=o,n}}}},LJ=[MY,yJ,vJ,_J,bJ,SJ,CJ,AJ,IJ,MJ,RJ];HY(LJ,{mixoutsTo:Ca});Ca.noAuto;Ca.config;var OJ=Ca.library;Ca.dom;var LA=Ca.parse;Ca.findIconDefinition;Ca.toHtml;var DJ=Ca.icon;Ca.layer;Ca.text;Ca.counter;function N4(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Uc(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?N4(Object(n),!0).forEach(function(i){Ks(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):N4(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function cw(t){"@babel/helpers - typeof";return cw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cw(t)}function Ks(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kJ(t,e){if(t==null)return{};var n={},i=Object.keys(t),r,o;for(o=0;o<i.length;o++)r=i[o],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}function FJ(t,e){if(t==null)return{};var n=kJ(t,e),i,r;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)i=o[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}var BJ=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},RN={exports:{}};(function(t){(function(e){var n=function(F,B,G){if(!p(B)||v(B)||w(B)||T(B)||d(B))return B;var U,ee=0,ne=0;if(y(B))for(U=[],ne=B.length;ee<ne;ee++)U.push(n(F,B[ee],G));else{U={};for(var ye in B)Object.prototype.hasOwnProperty.call(B,ye)&&(U[F(ye,G)]=n(F,B[ye],G))}return U},i=function(F,B){B=B||{};var G=B.separator||"_",U=B.split||/(?=[A-Z])/;return F.split(U).join(G)},r=function(F){return I(F)?F:(F=F.replace(/[\-_\s]+(.)?/g,function(B,G){return G?G.toUpperCase():""}),F.substr(0,1).toLowerCase()+F.substr(1))},o=function(F){var B=r(F);return B.substr(0,1).toUpperCase()+B.substr(1)},l=function(F,B){return i(F,B).toLowerCase()},s=Object.prototype.toString,d=function(F){return typeof F=="function"},p=function(F){return F===Object(F)},y=function(F){return s.call(F)=="[object Array]"},v=function(F){return s.call(F)=="[object Date]"},w=function(F){return s.call(F)=="[object RegExp]"},T=function(F){return s.call(F)=="[object Boolean]"},I=function(F){return F=F-0,F===F},L=function(F,B){var G=B&&"process"in B?B.process:B;return typeof G!="function"?F:function(U,ee){return G(U,F,ee)}},k={camelize:r,decamelize:l,pascalize:o,depascalize:l,camelizeKeys:function(F,B){return n(L(r,B),F)},decamelizeKeys:function(F,B){return n(L(l,B),F,B)},pascalizeKeys:function(F,B){return n(L(o,B),F)},depascalizeKeys:function(){return this.decamelizeKeys.apply(this,arguments)}};t.exports?t.exports=k:e.humps=k})(BJ)})(RN);var zJ=RN.exports,NJ=["class","style"];function UJ(t){return t.split(";").map(function(e){return e.trim()}).filter(function(e){return e}).reduce(function(e,n){var i=n.indexOf(":"),r=zJ.camelize(n.slice(0,i)),o=n.slice(i+1).trim();return e[r]=o,e},{})}function VJ(t){return t.split(/\s+/).reduce(function(e,n){return e[n]=!0,e},{})}function LN(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof t=="string")return t;var i=(t.children||[]).map(function(d){return LN(d)}),r=Object.keys(t.attributes||{}).reduce(function(d,p){var y=t.attributes[p];switch(p){case"class":d.class=VJ(y);break;case"style":d.style=UJ(y);break;default:d.attrs[p]=y}return d},{attrs:{},class:{},style:{}});n.class;var o=n.style,l=o===void 0?{}:o,s=FJ(n,NJ);return a_(t.tag,Uc(Uc(Uc({},e),{},{class:r.class,style:Uc(Uc({},r.style),l)},r.attrs),s),i)}var ON=!1;try{ON=!0}catch{}function jJ(){if(!ON&&console&&typeof console.error=="function"){var t;(t=console).error.apply(t,arguments)}}function ES(t,e){return Array.isArray(e)&&e.length>0||!Array.isArray(e)&&e?Ks({},t,e):{}}function $J(t){var e,n=(e={"fa-spin":t.spin,"fa-pulse":t.pulse,"fa-fw":t.fixedWidth,"fa-border":t.border,"fa-li":t.listItem,"fa-inverse":t.inverse,"fa-flip":t.flip===!0,"fa-flip-horizontal":t.flip==="horizontal"||t.flip==="both","fa-flip-vertical":t.flip==="vertical"||t.flip==="both"},Ks(e,"fa-".concat(t.size),t.size!==null),Ks(e,"fa-rotate-".concat(t.rotation),t.rotation!==null),Ks(e,"fa-pull-".concat(t.pull),t.pull!==null),Ks(e,"fa-swap-opacity",t.swapOpacity),Ks(e,"fa-bounce",t.bounce),Ks(e,"fa-shake",t.shake),Ks(e,"fa-beat",t.beat),Ks(e,"fa-fade",t.fade),Ks(e,"fa-beat-fade",t.beatFade),Ks(e,"fa-flash",t.flash),Ks(e,"fa-spin-pulse",t.spinPulse),Ks(e,"fa-spin-reverse",t.spinReverse),e);return Object.keys(n).map(function(i){return n[i]?i:null}).filter(function(i){return i})}function U4(t){if(t&&cw(t)==="object"&&t.prefix&&t.iconName&&t.icon)return t;if(LA.icon)return LA.icon(t);if(t===null)return null;if(cw(t)==="object"&&t.prefix&&t.iconName)return t;if(Array.isArray(t)&&t.length===2)return{prefix:t[0],iconName:t[1]};if(typeof t=="string")return{prefix:"fas",iconName:t}}var GJ=pr({name:"FontAwesomeIcon",props:{border:{type:Boolean,default:!1},fixedWidth:{type:Boolean,default:!1},flip:{type:[Boolean,String],default:!1,validator:function(e){return[!0,!1,"horizontal","vertical","both"].indexOf(e)>-1}},icon:{type:[Object,Array,String],required:!0},mask:{type:[Object,Array,String],default:null},listItem:{type:Boolean,default:!1},pull:{type:String,default:null,validator:function(e){return["right","left"].indexOf(e)>-1}},pulse:{type:Boolean,default:!1},rotation:{type:[String,Number],default:null,validator:function(e){return[90,180,270].indexOf(Number.parseInt(e,10))>-1}},swapOpacity:{type:Boolean,default:!1},size:{type:String,default:null,validator:function(e){return["2xs","xs","sm","lg","xl","2xl","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"].indexOf(e)>-1}},spin:{type:Boolean,default:!1},transform:{type:[String,Object],default:null},symbol:{type:[Boolean,String],default:!1},title:{type:String,default:null},inverse:{type:Boolean,default:!1},bounce:{type:Boolean,default:!1},shake:{type:Boolean,default:!1},beat:{type:Boolean,default:!1},fade:{type:Boolean,default:!1},beatFade:{type:Boolean,default:!1},flash:{type:Boolean,default:!1},spinPulse:{type:Boolean,default:!1},spinReverse:{type:Boolean,default:!1}},setup:function(e,n){var i=n.attrs,r=ur(function(){return U4(e.icon)}),o=ur(function(){return ES("classes",$J(e))}),l=ur(function(){return ES("transform",typeof e.transform=="string"?LA.transform(e.transform):e.transform)}),s=ur(function(){return ES("mask",U4(e.mask))}),d=ur(function(){return DJ(r.value,Uc(Uc(Uc(Uc({},o.value),l.value),s.value),{},{symbol:e.symbol,title:e.title}))});Ri(d,function(y){if(!y)return jJ("Could not find one or more icon(s)",r.value,s.value)},{immediate:!0});var p=ur(function(){return d.value?LN(d.value.abstract[0],{},i):null});return function(){return p.value}}});/*!
  * vue-router v4.2.5
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */const $p=typeof window<"u";function HJ(t){return t.__esModule||t[Symbol.toStringTag]==="Module"}const fr=Object.assign;function TS(t,e){const n={};for(const i in e){const r=e[i];n[i]=Cl(r)?r.map(t):t(r)}return n}const R0=()=>{},Cl=Array.isArray,WJ=/\/$/,KJ=t=>t.replace(WJ,"");function SS(t,e,n="/"){let i,r={},o="",l="";const s=e.indexOf("#");let d=e.indexOf("?");return s<d&&s>=0&&(d=-1),d>-1&&(i=e.slice(0,d),o=e.slice(d+1,s>-1?s:e.length),r=t(o)),s>-1&&(i=i||e.slice(0,s),l=e.slice(s,e.length)),i=YJ(i??e,n),{fullPath:i+(o&&"?")+o+l,path:i,query:r,hash:l}}function XJ(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function V4(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function ZJ(t,e,n){const i=e.matched.length-1,r=n.matched.length-1;return i>-1&&i===r&&Om(e.matched[i],n.matched[r])&&DN(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function Om(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function DN(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!qJ(t[n],e[n]))return!1;return!0}function qJ(t,e){return Cl(t)?j4(t,e):Cl(e)?j4(e,t):t===e}function j4(t,e){return Cl(e)?t.length===e.length&&t.every((n,i)=>n===e[i]):t.length===1&&t[0]===e}function YJ(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),i=t.split("/"),r=i[i.length-1];(r===".."||r===".")&&i.push("");let o=n.length-1,l,s;for(l=0;l<i.length;l++)if(s=i[l],s!==".")if(s==="..")o>1&&o--;else break;return n.slice(0,o).join("/")+"/"+i.slice(l-(l===i.length?1:0)).join("/")}var uv;(function(t){t.pop="pop",t.push="push"})(uv||(uv={}));var L0;(function(t){t.back="back",t.forward="forward",t.unknown=""})(L0||(L0={}));function JJ(t){if(!t)if($p){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),KJ(t)}const QJ=/^[^#]+#/;function eQ(t,e){return t.replace(QJ,"#")+e}function tQ(t,e){const n=document.documentElement.getBoundingClientRect(),i=t.getBoundingClientRect();return{behavior:e.behavior,left:i.left-n.left-(e.left||0),top:i.top-n.top-(e.top||0)}}const L2=()=>({left:window.pageXOffset,top:window.pageYOffset});function nQ(t){let e;if("el"in t){const n=t.el,i=typeof n=="string"&&n.startsWith("#"),r=typeof n=="string"?i?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!r)return;e=tQ(r,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function $4(t,e){return(history.state?history.state.position-e:-1)+t}const OA=new Map;function iQ(t,e){OA.set(t,e)}function rQ(t){const e=OA.get(t);return OA.delete(t),e}let oQ=()=>location.protocol+"//"+location.host;function kN(t,e){const{pathname:n,search:i,hash:r}=e,o=t.indexOf("#");if(o>-1){let s=r.includes(t.slice(o))?t.slice(o).length:1,d=r.slice(s);return d[0]!=="/"&&(d="/"+d),V4(d,"")}return V4(n,t)+i+r}function sQ(t,e,n,i){let r=[],o=[],l=null;const s=({state:w})=>{const T=kN(t,location),I=n.value,L=e.value;let k=0;if(w){if(n.value=T,e.value=w,l&&l===I){l=null;return}k=L?w.position-L.position:0}else i(T);r.forEach(F=>{F(n.value,I,{delta:k,type:uv.pop,direction:k?k>0?L0.forward:L0.back:L0.unknown})})};function d(){l=n.value}function p(w){r.push(w);const T=()=>{const I=r.indexOf(w);I>-1&&r.splice(I,1)};return o.push(T),T}function y(){const{history:w}=window;w.state&&w.replaceState(fr({},w.state,{scroll:L2()}),"")}function v(){for(const w of o)w();o=[],window.removeEventListener("popstate",s),window.removeEventListener("beforeunload",y)}return window.addEventListener("popstate",s),window.addEventListener("beforeunload",y,{passive:!0}),{pauseListeners:d,listen:p,destroy:v}}function G4(t,e,n,i=!1,r=!1){return{back:t,current:e,forward:n,replaced:i,position:window.history.length,scroll:r?L2():null}}function aQ(t){const{history:e,location:n}=window,i={value:kN(t,n)},r={value:e.state};r.value||o(i.value,{back:null,current:i.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function o(d,p,y){const v=t.indexOf("#"),w=v>-1?(n.host&&document.querySelector("base")?t:t.slice(v))+d:oQ()+t+d;try{e[y?"replaceState":"pushState"](p,"",w),r.value=p}catch(T){console.error(T),n[y?"replace":"assign"](w)}}function l(d,p){const y=fr({},e.state,G4(r.value.back,d,r.value.forward,!0),p,{position:r.value.position});o(d,y,!0),i.value=d}function s(d,p){const y=fr({},r.value,e.state,{forward:d,scroll:L2()});o(y.current,y,!0);const v=fr({},G4(i.value,d,null),{position:y.position+1},p);o(d,v,!1),i.value=d}return{location:i,state:r,push:s,replace:l}}function lQ(t){t=JJ(t);const e=aQ(t),n=sQ(t,e.state,e.location,e.replace);function i(o,l=!0){l||n.pauseListeners(),history.go(o)}const r=fr({location:"",base:t,go:i,createHref:eQ.bind(null,t)},e,n);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>e.state.value}),r}function cQ(t){return typeof t=="string"||t&&typeof t=="object"}function FN(t){return typeof t=="string"||typeof t=="symbol"}const Ju={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},BN=Symbol("");var H4;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(H4||(H4={}));function Dm(t,e){return fr(new Error,{type:t,[BN]:!0},e)}function Dc(t,e){return t instanceof Error&&BN in t&&(e==null||!!(t.type&e))}const W4="[^/]+?",uQ={sensitive:!1,strict:!1,start:!0,end:!0},hQ=/[.+*?^${}()[\]/\\]/g;function dQ(t,e){const n=fr({},uQ,e),i=[];let r=n.start?"^":"";const o=[];for(const p of t){const y=p.length?[]:[90];n.strict&&!p.length&&(r+="/");for(let v=0;v<p.length;v++){const w=p[v];let T=40+(n.sensitive?.25:0);if(w.type===0)v||(r+="/"),r+=w.value.replace(hQ,"\\$&"),T+=40;else if(w.type===1){const{value:I,repeatable:L,optional:k,regexp:F}=w;o.push({name:I,repeatable:L,optional:k});const B=F||W4;if(B!==W4){T+=10;try{new RegExp(`(${B})`)}catch(U){throw new Error(`Invalid custom RegExp for param "${I}" (${B}): `+U.message)}}let G=L?`((?:${B})(?:/(?:${B}))*)`:`(${B})`;v||(G=k&&p.length<2?`(?:/${G})`:"/"+G),k&&(G+="?"),r+=G,T+=20,k&&(T+=-8),L&&(T+=-20),B===".*"&&(T+=-50)}y.push(T)}i.push(y)}if(n.strict&&n.end){const p=i.length-1;i[p][i[p].length-1]+=.7000000000000001}n.strict||(r+="/?"),n.end?r+="$":n.strict&&(r+="(?:/|$)");const l=new RegExp(r,n.sensitive?"":"i");function s(p){const y=p.match(l),v={};if(!y)return null;for(let w=1;w<y.length;w++){const T=y[w]||"",I=o[w-1];v[I.name]=T&&I.repeatable?T.split("/"):T}return v}function d(p){let y="",v=!1;for(const w of t){(!v||!y.endsWith("/"))&&(y+="/"),v=!1;for(const T of w)if(T.type===0)y+=T.value;else if(T.type===1){const{value:I,repeatable:L,optional:k}=T,F=I in p?p[I]:"";if(Cl(F)&&!L)throw new Error(`Provided param "${I}" is an array but it is not repeatable (* or + modifiers)`);const B=Cl(F)?F.join("/"):F;if(!B)if(k)w.length<2&&(y.endsWith("/")?y=y.slice(0,-1):v=!0);else throw new Error(`Missing required param "${I}"`);y+=B}}return y||"/"}return{re:l,score:i,keys:o,parse:s,stringify:d}}function fQ(t,e){let n=0;for(;n<t.length&&n<e.length;){const i=e[n]-t[n];if(i)return i;n++}return t.length<e.length?t.length===1&&t[0]===40+40?-1:1:t.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function pQ(t,e){let n=0;const i=t.score,r=e.score;for(;n<i.length&&n<r.length;){const o=fQ(i[n],r[n]);if(o)return o;n++}if(Math.abs(r.length-i.length)===1){if(K4(i))return 1;if(K4(r))return-1}return r.length-i.length}function K4(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const mQ={type:0,value:""},gQ=/[a-zA-Z0-9_]/;function yQ(t){if(!t)return[[]];if(t==="/")return[[mQ]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(T){throw new Error(`ERR (${n})/"${p}": ${T}`)}let n=0,i=n;const r=[];let o;function l(){o&&r.push(o),o=[]}let s=0,d,p="",y="";function v(){p&&(n===0?o.push({type:0,value:p}):n===1||n===2||n===3?(o.length>1&&(d==="*"||d==="+")&&e(`A repeatable param (${p}) must be alone in its segment. eg: '/:ids+.`),o.push({type:1,value:p,regexp:y,repeatable:d==="*"||d==="+",optional:d==="*"||d==="?"})):e("Invalid state to consume buffer"),p="")}function w(){p+=d}for(;s<t.length;){if(d=t[s++],d==="\\"&&n!==2){i=n,n=4;continue}switch(n){case 0:d==="/"?(p&&v(),l()):d===":"?(v(),n=1):w();break;case 4:w(),n=i;break;case 1:d==="("?n=2:gQ.test(d)?w():(v(),n=0,d!=="*"&&d!=="?"&&d!=="+"&&s--);break;case 2:d===")"?y[y.length-1]=="\\"?y=y.slice(0,-1)+d:n=3:y+=d;break;case 3:v(),n=0,d!=="*"&&d!=="?"&&d!=="+"&&s--,y="";break;default:e("Unknown state");break}}return n===2&&e(`Unfinished custom RegExp for param "${p}"`),v(),l(),r}function vQ(t,e,n){const i=dQ(yQ(t.path),n),r=fr(i,{record:t,parent:e,children:[],alias:[]});return e&&!r.record.aliasOf==!e.record.aliasOf&&e.children.push(r),r}function _Q(t,e){const n=[],i=new Map;e=q4({strict:!1,end:!0,sensitive:!1},e);function r(y){return i.get(y)}function o(y,v,w){const T=!w,I=bQ(y);I.aliasOf=w&&w.record;const L=q4(e,y),k=[I];if("alias"in y){const G=typeof y.alias=="string"?[y.alias]:y.alias;for(const U of G)k.push(fr({},I,{components:w?w.record.components:I.components,path:U,aliasOf:w?w.record:I}))}let F,B;for(const G of k){const{path:U}=G;if(v&&U[0]!=="/"){const ee=v.record.path,ne=ee[ee.length-1]==="/"?"":"/";G.path=v.record.path+(U&&ne+U)}if(F=vQ(G,v,L),w?w.alias.push(F):(B=B||F,B!==F&&B.alias.push(F),T&&y.name&&!Z4(F)&&l(y.name)),I.children){const ee=I.children;for(let ne=0;ne<ee.length;ne++)o(ee[ne],F,w&&w.children[ne])}w=w||F,(F.record.components&&Object.keys(F.record.components).length||F.record.name||F.record.redirect)&&d(F)}return B?()=>{l(B)}:R0}function l(y){if(FN(y)){const v=i.get(y);v&&(i.delete(y),n.splice(n.indexOf(v),1),v.children.forEach(l),v.alias.forEach(l))}else{const v=n.indexOf(y);v>-1&&(n.splice(v,1),y.record.name&&i.delete(y.record.name),y.children.forEach(l),y.alias.forEach(l))}}function s(){return n}function d(y){let v=0;for(;v<n.length&&pQ(y,n[v])>=0&&(y.record.path!==n[v].record.path||!zN(y,n[v]));)v++;n.splice(v,0,y),y.record.name&&!Z4(y)&&i.set(y.record.name,y)}function p(y,v){let w,T={},I,L;if("name"in y&&y.name){if(w=i.get(y.name),!w)throw Dm(1,{location:y});L=w.record.name,T=fr(X4(v.params,w.keys.filter(B=>!B.optional).map(B=>B.name)),y.params&&X4(y.params,w.keys.map(B=>B.name))),I=w.stringify(T)}else if("path"in y)I=y.path,w=n.find(B=>B.re.test(I)),w&&(T=w.parse(I),L=w.record.name);else{if(w=v.name?i.get(v.name):n.find(B=>B.re.test(v.path)),!w)throw Dm(1,{location:y,currentLocation:v});L=w.record.name,T=fr({},v.params,y.params),I=w.stringify(T)}const k=[];let F=w;for(;F;)k.unshift(F.record),F=F.parent;return{name:L,path:I,params:T,matched:k,meta:wQ(k)}}return t.forEach(y=>o(y)),{addRoute:o,resolve:p,removeRoute:l,getRoutes:s,getRecordMatcher:r}}function X4(t,e){const n={};for(const i of e)i in t&&(n[i]=t[i]);return n}function bQ(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:xQ(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}}}function xQ(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const i in t.components)e[i]=typeof n=="object"?n[i]:n;return e}function Z4(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function wQ(t){return t.reduce((e,n)=>fr(e,n.meta),{})}function q4(t,e){const n={};for(const i in t)n[i]=i in e?e[i]:t[i];return n}function zN(t,e){return e.children.some(n=>n===t||zN(t,n))}const NN=/#/g,EQ=/&/g,TQ=/\//g,SQ=/=/g,CQ=/\?/g,UN=/\+/g,AQ=/%5B/g,PQ=/%5D/g,VN=/%5E/g,IQ=/%60/g,jN=/%7B/g,MQ=/%7C/g,$N=/%7D/g,RQ=/%20/g;function _M(t){return encodeURI(""+t).replace(MQ,"|").replace(AQ,"[").replace(PQ,"]")}function LQ(t){return _M(t).replace(jN,"{").replace($N,"}").replace(VN,"^")}function DA(t){return _M(t).replace(UN,"%2B").replace(RQ,"+").replace(NN,"%23").replace(EQ,"%26").replace(IQ,"`").replace(jN,"{").replace($N,"}").replace(VN,"^")}function OQ(t){return DA(t).replace(SQ,"%3D")}function DQ(t){return _M(t).replace(NN,"%23").replace(CQ,"%3F")}function kQ(t){return t==null?"":DQ(t).replace(TQ,"%2F")}function uw(t){try{return decodeURIComponent(""+t)}catch{}return""+t}function FQ(t){const e={};if(t===""||t==="?")return e;const i=(t[0]==="?"?t.slice(1):t).split("&");for(let r=0;r<i.length;++r){const o=i[r].replace(UN," "),l=o.indexOf("="),s=uw(l<0?o:o.slice(0,l)),d=l<0?null:uw(o.slice(l+1));if(s in e){let p=e[s];Cl(p)||(p=e[s]=[p]),p.push(d)}else e[s]=d}return e}function Y4(t){let e="";for(let n in t){const i=t[n];if(n=OQ(n),i==null){i!==void 0&&(e+=(e.length?"&":"")+n);continue}(Cl(i)?i.map(o=>o&&DA(o)):[i&&DA(i)]).forEach(o=>{o!==void 0&&(e+=(e.length?"&":"")+n,o!=null&&(e+="="+o))})}return e}function BQ(t){const e={};for(const n in t){const i=t[n];i!==void 0&&(e[n]=Cl(i)?i.map(r=>r==null?null:""+r):i==null?i:""+i)}return e}const zQ=Symbol(""),J4=Symbol(""),bM=Symbol(""),GN=Symbol(""),kA=Symbol("");function Py(){let t=[];function e(i){return t.push(i),()=>{const r=t.indexOf(i);r>-1&&t.splice(r,1)}}function n(){t=[]}return{add:e,list:()=>t.slice(),reset:n}}function fh(t,e,n,i,r){const o=i&&(i.enterCallbacks[r]=i.enterCallbacks[r]||[]);return()=>new Promise((l,s)=>{const d=v=>{v===!1?s(Dm(4,{from:n,to:e})):v instanceof Error?s(v):cQ(v)?s(Dm(2,{from:e,to:v})):(o&&i.enterCallbacks[r]===o&&typeof v=="function"&&o.push(v),l())},p=t.call(i&&i.instances[r],e,n,d);let y=Promise.resolve(p);t.length<3&&(y=y.then(d)),y.catch(v=>s(v))})}function CS(t,e,n,i){const r=[];for(const o of t)for(const l in o.components){let s=o.components[l];if(!(e!=="beforeRouteEnter"&&!o.instances[l]))if(NQ(s)){const p=(s.__vccOpts||s)[e];p&&r.push(fh(p,n,i,o,l))}else{let d=s();r.push(()=>d.then(p=>{if(!p)return Promise.reject(new Error(`Couldn't resolve component "${l}" at "${o.path}"`));const y=HJ(p)?p.default:p;o.components[l]=y;const w=(y.__vccOpts||y)[e];return w&&fh(w,n,i,o,l)()}))}}return r}function NQ(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function Q4(t){const e=$r(bM),n=$r(GN),i=ur(()=>e.resolve(Yt(t.to))),r=ur(()=>{const{matched:d}=i.value,{length:p}=d,y=d[p-1],v=n.matched;if(!y||!v.length)return-1;const w=v.findIndex(Om.bind(null,y));if(w>-1)return w;const T=ek(d[p-2]);return p>1&&ek(y)===T&&v[v.length-1].path!==T?v.findIndex(Om.bind(null,d[p-2])):w}),o=ur(()=>r.value>-1&&$Q(n.params,i.value.params)),l=ur(()=>r.value>-1&&r.value===n.matched.length-1&&DN(n.params,i.value.params));function s(d={}){return jQ(d)?e[Yt(t.replace)?"replace":"push"](Yt(t.to)).catch(R0):Promise.resolve()}return{route:i,href:ur(()=>i.value.href),isActive:o,isExactActive:l,navigate:s}}const UQ=pr({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Q4,setup(t,{slots:e}){const n=Ao(Q4(t)),{options:i}=$r(bM),r=ur(()=>({[tk(t.activeClass,i.linkActiveClass,"router-link-active")]:n.isActive,[tk(t.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const o=e.default&&e.default(n);return t.custom?o:a_("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:r.value},o)}}}),VQ=UQ;function jQ(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function $Q(t,e){for(const n in e){const i=e[n],r=t[n];if(typeof i=="string"){if(i!==r)return!1}else if(!Cl(r)||r.length!==i.length||i.some((o,l)=>o!==r[l]))return!1}return!0}function ek(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const tk=(t,e,n)=>t??e??n,GQ=pr({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:n}){const i=$r(kA),r=ur(()=>t.route||i.value),o=$r(J4,0),l=ur(()=>{let p=Yt(o);const{matched:y}=r.value;let v;for(;(v=y[p])&&!v.components;)p++;return p}),s=ur(()=>r.value.matched[l.value]);Os(J4,ur(()=>l.value+1)),Os(zQ,s),Os(kA,r);const d=$n();return Ri(()=>[d.value,s.value,t.name],([p,y,v],[w,T,I])=>{y&&(y.instances[v]=p,T&&T!==y&&p&&p===w&&(y.leaveGuards.size||(y.leaveGuards=T.leaveGuards),y.updateGuards.size||(y.updateGuards=T.updateGuards))),p&&y&&(!T||!Om(y,T)||!w)&&(y.enterCallbacks[v]||[]).forEach(L=>L(p))},{flush:"post"}),()=>{const p=r.value,y=t.name,v=s.value,w=v&&v.components[y];if(!w)return nk(n.default,{Component:w,route:p});const T=v.props[y],I=T?T===!0?p.params:typeof T=="function"?T(p):T:null,k=a_(w,fr({},I,e,{onVnodeUnmounted:F=>{F.component.isUnmounted&&(v.instances[y]=null)},ref:d}));return nk(n.default,{Component:k,route:p})||k}}});function nk(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const HQ=GQ;function WQ(t){const e=_Q(t.routes,t),n=t.parseQuery||FQ,i=t.stringifyQuery||Y4,r=t.history,o=Py(),l=Py(),s=Py(),d=vB(Ju);let p=Ju;$p&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const y=TS.bind(null,We=>""+We),v=TS.bind(null,kQ),w=TS.bind(null,uw);function T(We,kt){let Ke,ht;return FN(We)?(Ke=e.getRecordMatcher(We),ht=kt):ht=We,e.addRoute(ht,Ke)}function I(We){const kt=e.getRecordMatcher(We);kt&&e.removeRoute(kt)}function L(){return e.getRoutes().map(We=>We.record)}function k(We){return!!e.getRecordMatcher(We)}function F(We,kt){if(kt=fr({},kt||d.value),typeof We=="string"){const je=SS(n,We,kt.path),tt=e.resolve({path:je.path},kt),pt=r.createHref(je.fullPath);return fr(je,tt,{params:w(tt.params),hash:uw(je.hash),redirectedFrom:void 0,href:pt})}let Ke;if("path"in We)Ke=fr({},We,{path:SS(n,We.path,kt.path).path});else{const je=fr({},We.params);for(const tt in je)je[tt]==null&&delete je[tt];Ke=fr({},We,{params:v(je)}),kt.params=v(kt.params)}const ht=e.resolve(Ke,kt),Pt=We.hash||"";ht.params=y(w(ht.params));const ae=XJ(i,fr({},We,{hash:LQ(Pt),path:ht.path})),Ae=r.createHref(ae);return fr({fullPath:ae,hash:Pt,query:i===Y4?BQ(We.query):We.query||{}},ht,{redirectedFrom:void 0,href:Ae})}function B(We){return typeof We=="string"?SS(n,We,d.value.path):fr({},We)}function G(We,kt){if(p!==We)return Dm(8,{from:kt,to:We})}function U(We){return ye(We)}function ee(We){return U(fr(B(We),{replace:!0}))}function ne(We){const kt=We.matched[We.matched.length-1];if(kt&&kt.redirect){const{redirect:Ke}=kt;let ht=typeof Ke=="function"?Ke(We):Ke;return typeof ht=="string"&&(ht=ht.includes("?")||ht.includes("#")?ht=B(ht):{path:ht},ht.params={}),fr({query:We.query,hash:We.hash,params:"path"in ht?{}:We.params},ht)}}function ye(We,kt){const Ke=p=F(We),ht=d.value,Pt=We.state,ae=We.force,Ae=We.replace===!0,je=ne(Ke);if(je)return ye(fr(B(je),{state:typeof je=="object"?fr({},Pt,je.state):Pt,force:ae,replace:Ae}),kt||Ke);const tt=Ke;tt.redirectedFrom=kt;let pt;return!ae&&ZJ(i,ht,Ke)&&(pt=Dm(16,{to:tt,from:ht}),pn(ht,ht,!0,!1)),(pt?Promise.resolve(pt):Ce(tt,ht)).catch(Tt=>Dc(Tt)?Dc(Tt,2)?Tt:cn(Tt):bt(Tt,tt,ht)).then(Tt=>{if(Tt){if(Dc(Tt,2))return ye(fr({replace:Ae},B(Tt.to),{state:typeof Tt.to=="object"?fr({},Pt,Tt.to.state):Pt,force:ae}),kt||tt)}else Tt=be(tt,ht,!0,Ae,Pt);return me(tt,ht,Tt),Tt})}function fe(We,kt){const Ke=G(We,kt);return Ke?Promise.reject(Ke):Promise.resolve()}function J(We){const kt=kn.values().next().value;return kt&&typeof kt.runWithContext=="function"?kt.runWithContext(We):We()}function Ce(We,kt){let Ke;const[ht,Pt,ae]=KQ(We,kt);Ke=CS(ht.reverse(),"beforeRouteLeave",We,kt);for(const je of ht)je.leaveGuards.forEach(tt=>{Ke.push(fh(tt,We,kt))});const Ae=fe.bind(null,We,kt);return Ke.push(Ae),Nt(Ke).then(()=>{Ke=[];for(const je of o.list())Ke.push(fh(je,We,kt));return Ke.push(Ae),Nt(Ke)}).then(()=>{Ke=CS(Pt,"beforeRouteUpdate",We,kt);for(const je of Pt)je.updateGuards.forEach(tt=>{Ke.push(fh(tt,We,kt))});return Ke.push(Ae),Nt(Ke)}).then(()=>{Ke=[];for(const je of ae)if(je.beforeEnter)if(Cl(je.beforeEnter))for(const tt of je.beforeEnter)Ke.push(fh(tt,We,kt));else Ke.push(fh(je.beforeEnter,We,kt));return Ke.push(Ae),Nt(Ke)}).then(()=>(We.matched.forEach(je=>je.enterCallbacks={}),Ke=CS(ae,"beforeRouteEnter",We,kt),Ke.push(Ae),Nt(Ke))).then(()=>{Ke=[];for(const je of l.list())Ke.push(fh(je,We,kt));return Ke.push(Ae),Nt(Ke)}).catch(je=>Dc(je,8)?je:Promise.reject(je))}function me(We,kt,Ke){s.list().forEach(ht=>J(()=>ht(We,kt,Ke)))}function be(We,kt,Ke,ht,Pt){const ae=G(We,kt);if(ae)return ae;const Ae=kt===Ju,je=$p?history.state:{};Ke&&(ht||Ae?r.replace(We.fullPath,fr({scroll:Ae&&je&&je.scroll},Pt)):r.push(We.fullPath,Pt)),d.value=We,pn(We,kt,Ke,Ae),cn()}let Te;function ke(){Te||(Te=r.listen((We,kt,Ke)=>{if(!Bn.listening)return;const ht=F(We),Pt=ne(ht);if(Pt){ye(fr(Pt,{replace:!0}),ht).catch(R0);return}p=ht;const ae=d.value;$p&&iQ($4(ae.fullPath,Ke.delta),L2()),Ce(ht,ae).catch(Ae=>Dc(Ae,12)?Ae:Dc(Ae,2)?(ye(Ae.to,ht).then(je=>{Dc(je,20)&&!Ke.delta&&Ke.type===uv.pop&&r.go(-1,!1)}).catch(R0),Promise.reject()):(Ke.delta&&r.go(-Ke.delta,!1),bt(Ae,ht,ae))).then(Ae=>{Ae=Ae||be(ht,ae,!1),Ae&&(Ke.delta&&!Dc(Ae,8)?r.go(-Ke.delta,!1):Ke.type===uv.pop&&Dc(Ae,20)&&r.go(-1,!1)),me(ht,ae,Ae)}).catch(R0)}))}let ut=Py(),et=Py(),Et;function bt(We,kt,Ke){cn(We);const ht=et.list();return ht.length?ht.forEach(Pt=>Pt(We,kt,Ke)):console.error(We),Promise.reject(We)}function Qt(){return Et&&d.value!==Ju?Promise.resolve():new Promise((We,kt)=>{ut.add([We,kt])})}function cn(We){return Et||(Et=!We,ke(),ut.list().forEach(([kt,Ke])=>We?Ke(We):kt()),ut.reset()),We}function pn(We,kt,Ke,ht){const{scrollBehavior:Pt}=t;if(!$p||!Pt)return Promise.resolve();const ae=!Ke&&rQ($4(We.fullPath,0))||(ht||!Ke)&&history.state&&history.state.scroll||null;return Ys().then(()=>Pt(We,kt,ae)).then(Ae=>Ae&&nQ(Ae)).catch(Ae=>bt(Ae,We,kt))}const xn=We=>r.go(We);let An;const kn=new Set,Bn={currentRoute:d,listening:!0,addRoute:T,removeRoute:I,hasRoute:k,getRoutes:L,resolve:F,options:t,push:U,replace:ee,go:xn,back:()=>xn(-1),forward:()=>xn(1),beforeEach:o.add,beforeResolve:l.add,afterEach:s.add,onError:et.add,isReady:Qt,install(We){const kt=this;We.component("RouterLink",VQ),We.component("RouterView",HQ),We.config.globalProperties.$router=kt,Object.defineProperty(We.config.globalProperties,"$route",{enumerable:!0,get:()=>Yt(d)}),$p&&!An&&d.value===Ju&&(An=!0,U(r.location).catch(Pt=>{}));const Ke={};for(const Pt in Ju)Object.defineProperty(Ke,Pt,{get:()=>d.value[Pt],enumerable:!0});We.provide(bM,kt),We.provide(GN,MI(Ke)),We.provide(kA,d);const ht=We.unmount;kn.add(We),We.unmount=function(){kn.delete(We),kn.size<1&&(p=Ju,Te&&Te(),Te=null,d.value=Ju,An=!1,Et=!1),ht()}}};function Nt(We){return We.reduce((kt,Ke)=>kt.then(()=>J(Ke)),Promise.resolve())}return Bn}function KQ(t,e){const n=[],i=[],r=[],o=Math.max(e.matched.length,t.matched.length);for(let l=0;l<o;l++){const s=e.matched[l];s&&(t.matched.find(p=>Om(p,s))?i.push(s):n.push(s));const d=t.matched[l];d&&(e.matched.find(p=>Om(p,d))||r.push(d))}return[n,i,r]}const XQ={class:"mb-2 text-3xl font-bold tracking-tight text-gray-700 dark:text-white"},ZQ={class:"font-normal text-gray-700 dark:text-gray-400"},qQ=pr({__name:"PageCard",props:{text:{type:String,default:"Default Text"},smalltext:{type:String,default:"Default Small Text"},link:{type:String,default:"/"}},setup(t){const e=t,n=()=>{uR.push(e.link)};return(i,r)=>(le(),Ue("div",{onClick:n,class:"no-underline block max-w-sm p-6 m-6 bg-white border border-gray-200 rounded-lg shadow hover:bg-gray-100 dark:bg-gray-700 dark:border-gray-700 dark:hover:bg-gray-600"},[Qe("div",XQ,ki(t.text||"Default Text"),1),Qe("p",ZQ,ki(t.smalltext||"Default Small Text"),1)]))}}),YQ={class:"h-screen flex items-center justify-center text-black flex-col"},JQ=Qe("div",{class:"text-5xl m-5 font-bold"}," Geospatial Data Vis Demos (WIP) ",-1),QQ={class:"mx-auto grid grid-cols-2"},eee=pr({__name:"Home",setup(t){let e=[{link:"/watercomparison",text:"Two maps with CalSim output",smalltext:"Data from James Gilbert (NOAA)"},{link:"/water",text:"One map with CalSim output",smalltext:"Data from James Gilbert (NOAA)"},{link:"/singlefire",text:"Wildfire data",smalltext:"Data from ?"}];return(n,i)=>(le(),Ue("div",YQ,[JQ,Qe("div",QQ,[(le(!0),Ue(_n,null,or(Yt(e),r=>(le(),Rt(qQ,{key:r.text,text:r.text,smalltext:r.smalltext,link:r.link},null,8,["text","smalltext","link"]))),128))])]))}});function hv(t){"@babel/helpers - typeof";return hv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hv(t)}function ik(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function tee(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ik(Object(n),!0).forEach(function(i){nee(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ik(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function nee(t,e,n){return e=iee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iee(t){var e=ree(t,"string");return hv(e)==="symbol"?e:String(e)}function ree(t,e){if(hv(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(hv(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var oee=`
.p-button {
    display: inline-flex;
    cursor: pointer;
    user-select: none;
    align-items: center;
    vertical-align: bottom;
    text-align: center;
    overflow: hidden;
    position: relative;
}

.p-button-label {
    flex: 1 1 auto;
}

.p-button-icon-right {
    order: 1;
}

.p-button:disabled {
    cursor: default;
}

.p-button-icon-only {
    justify-content: center;
}

.p-button-icon-only .p-button-label {
    visibility: hidden;
    width: 0;
    flex: 0 0 auto;
}

.p-button-vertical {
    flex-direction: column;
}

.p-button-icon-bottom {
    order: 2;
}

.p-buttonset .p-button {
    margin: 0;
}

.p-buttonset .p-button:not(:last-child), .p-buttonset .p-button:not(:last-child):hover {
    border-right: 0 none;
}

.p-buttonset .p-button:not(:first-of-type):not(:last-of-type) {
    border-radius: 0;
}

.p-buttonset .p-button:first-of-type:not(:only-of-type) {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
}

.p-buttonset .p-button:last-of-type:not(:only-of-type) {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
}

.p-buttonset .p-button:focus {
    position: relative;
    z-index: 1;
}
`,see=`
.p-checkbox {
    display: inline-flex;
    cursor: pointer;
    user-select: none;
    vertical-align: bottom;
    position: relative;
}

.p-checkbox.p-checkbox-disabled {
    cursor: default;
}

.p-checkbox-box {
    display: flex;
    justify-content: center;
    align-items: center;
}
`,aee=`
.p-fluid .p-inputtext {
    width: 100%;
}

/* InputGroup */
.p-inputgroup {
    display: flex;
    align-items: stretch;
    width: 100%;
}

.p-inputgroup-addon {
    display: flex;
    align-items: center;
    justify-content: center;
}

.p-inputgroup .p-float-label {
    display: flex;
    align-items: stretch;
    width: 100%;
}

.p-inputgroup .p-inputtext,
.p-fluid .p-inputgroup .p-inputtext,
.p-inputgroup .p-inputwrapper,
.p-fluid .p-inputgroup .p-input {
    flex: 1 1 auto;
    width: 1%;
}

/* Floating Label */
.p-float-label {
    display: block;
    position: relative;
}

.p-float-label label {
    position: absolute;
    pointer-events: none;
    top: 50%;
    margin-top: -.5rem;
    transition-property: all;
    transition-timing-function: ease;
    line-height: 1;
}

.p-float-label textarea ~ label {
    top: 1rem;
}

.p-float-label input:focus ~ label,
.p-float-label input.p-filled ~ label,
.p-float-label input:-webkit-autofill ~ label,
.p-float-label textarea:focus ~ label,
.p-float-label textarea.p-filled ~ label,
.p-float-label .p-inputwrapper-focus ~ label,
.p-float-label .p-inputwrapper-filled ~ label {
    top: -.75rem;
    font-size: 12px;
}


.p-float-label .p-placeholder,
.p-float-label input::placeholder,
.p-float-label .p-inputtext::placeholder {
    opacity: 0;
    transition-property: all;
    transition-timing-function: ease;
}

.p-float-label .p-focus .p-placeholder,
.p-float-label input:focus::placeholder,
.p-float-label .p-inputtext:focus::placeholder {
    opacity: 1;
    transition-property: all;
    transition-timing-function: ease;
}

.p-input-icon-left,
.p-input-icon-right {
    position: relative;
    display: inline-block;
}

.p-input-icon-left > i,
.p-input-icon-left > svg,
.p-input-icon-right > i,
.p-input-icon-right > svg {
    position: absolute;
    top: 50%;
    margin-top: -.5rem;
}

.p-fluid .p-input-icon-left,
.p-fluid .p-input-icon-right {
    display: block;
    width: 100%;
}
`,lee=`
.p-radiobutton {
    position: relative;
    display: inline-flex;
    cursor: pointer;
    user-select: none;
    vertical-align: bottom;
}

.p-radiobutton.p-radiobutton-disabled {
    cursor: default;
}

.p-radiobutton-box {
    display: flex;
    justify-content: center;
    align-items: center;
}

.p-radiobutton-icon {
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
    transform: translateZ(0) scale(.1);
    border-radius: 50%;
    visibility: hidden;
}

.p-radiobutton-box.p-highlight .p-radiobutton-icon {
    transform: translateZ(0) scale(1.0, 1.0);
    visibility: visible;
}
`,cee=`
@layer primevue {
.p-component, .p-component * {
    box-sizing: border-box;
}

.p-hidden-space {
    visibility: hidden;
}

.p-reset {
    margin: 0;
    padding: 0;
    border: 0;
    outline: 0;
    text-decoration: none;
    font-size: 100%;
    list-style: none;
}

.p-disabled, .p-disabled * {
    cursor: default !important;
    pointer-events: none;
    user-select: none;
}

.p-component-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

.p-unselectable-text {
    user-select: none;
}

.p-sr-only {
    border: 0;
    clip: rect(1px, 1px, 1px, 1px);
    clip-path: inset(50%);
    height: 1px;
    margin: -1px;
    overflow: hidden;
    padding: 0;
    position: absolute;
    width: 1px;
    word-wrap: normal !important;
}

.p-link {
	text-align: left;
	background-color: transparent;
	margin: 0;
	padding: 0;
	border: none;
    cursor: pointer;
    user-select: none;
}

.p-link:disabled {
	cursor: default;
}

/* Non vue overlay animations */
.p-connected-overlay {
    opacity: 0;
    transform: scaleY(0.8);
    transition: transform .12s cubic-bezier(0, 0, 0.2, 1), opacity .12s cubic-bezier(0, 0, 0.2, 1);
}

.p-connected-overlay-visible {
    opacity: 1;
    transform: scaleY(1);
}

.p-connected-overlay-hidden {
    opacity: 0;
    transform: scaleY(1);
    transition: opacity .1s linear;
}

/* Vue based overlay animations */
.p-connected-overlay-enter-from {
    opacity: 0;
    transform: scaleY(0.8);
}

.p-connected-overlay-leave-to {
    opacity: 0;
}

.p-connected-overlay-enter-active {
    transition: transform .12s cubic-bezier(0, 0, 0.2, 1), opacity .12s cubic-bezier(0, 0, 0.2, 1);
}

.p-connected-overlay-leave-active {
    transition: opacity .1s linear;
}

/* Toggleable Content */
.p-toggleable-content-enter-from,
.p-toggleable-content-leave-to {
    max-height: 0;
}

.p-toggleable-content-enter-to,
.p-toggleable-content-leave-from {
    max-height: 1000px;
}

.p-toggleable-content-leave-active {
    overflow: hidden;
    transition: max-height 0.45s cubic-bezier(0, 1, 0, 1);
}

.p-toggleable-content-enter-active {
    overflow: hidden;
    transition: max-height 1s ease-in-out;
}
`.concat(oee,`
`).concat(see,`
`).concat(aee,`
`).concat(lee,`
}
`),AS=_o.extend({name:"common",css:cee,loadGlobalStyle:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return iN(e,tee({name:"global"},n))}});function dv(t){"@babel/helpers - typeof";return dv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dv(t)}function rk(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Nr(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?rk(Object(n),!0).forEach(function(i){FA(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rk(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function FA(t,e,n){return e=uee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uee(t){var e=hee(t,"string");return dv(e)==="symbol"?e:String(e)}function hee(t,e){if(dv(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(dv(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ni={name:"BaseComponent",props:{pt:{type:Object,default:void 0},ptOptions:{type:Object,default:void 0},unstyled:{type:Boolean,default:void 0}},inject:{$parentInstance:{default:void 0}},watch:{isUnstyled:{immediate:!0,handler:function(e){if(!e){var n,i;AS.loadStyle({nonce:(n=this.$config)===null||n===void 0||(n=n.csp)===null||n===void 0?void 0:n.nonce}),this.$options.style&&this.$style.loadStyle({nonce:(i=this.$config)===null||i===void 0||(i=i.csp)===null||i===void 0?void 0:i.nonce})}}}},beforeCreate:function(){var e,n,i,r,o,l,s,d,p,y,v,w=(e=this.pt)===null||e===void 0?void 0:e._usept,T=w?(n=this.pt)===null||n===void 0||(n=n.originalValue)===null||n===void 0?void 0:n[this.$.type.name]:void 0,I=w?(i=this.pt)===null||i===void 0||(i=i.value)===null||i===void 0?void 0:i[this.$.type.name]:this.pt;(r=I||T)===null||r===void 0||(r=r.hooks)===null||r===void 0||(o=r.onBeforeCreate)===null||o===void 0||o.call(r);var L=(l=this.$config)===null||l===void 0||(l=l.pt)===null||l===void 0?void 0:l._usept,k=L?(s=this.$primevue)===null||s===void 0||(s=s.config)===null||s===void 0||(s=s.pt)===null||s===void 0?void 0:s.originalValue:void 0,F=L?(d=this.$primevue)===null||d===void 0||(d=d.config)===null||d===void 0||(d=d.pt)===null||d===void 0?void 0:d.value:(p=this.$primevue)===null||p===void 0||(p=p.config)===null||p===void 0?void 0:p.pt;(y=F||k)===null||y===void 0||(y=y[this.$.type.name])===null||y===void 0||(y=y.hooks)===null||y===void 0||(v=y.onBeforeCreate)===null||v===void 0||v.call(y)},created:function(){this._hook("onCreated")},beforeMount:function(){var e;_o.loadStyle({nonce:(e=this.$config)===null||e===void 0||(e=e.csp)===null||e===void 0?void 0:e.nonce}),this._loadGlobalStyles(),this._hook("onBeforeMount")},mounted:function(){this._hook("onMounted")},beforeUpdate:function(){this._hook("onBeforeUpdate")},updated:function(){this._hook("onUpdated")},beforeUnmount:function(){this._hook("onBeforeUnmount")},unmounted:function(){this._hook("onUnmounted")},methods:{_hook:function(e){if(!this.$options.hostName){var n=this._usePT(this._getPT(this.pt,this.$.type.name),this._getOptionValue,"hooks.".concat(e)),i=this._useDefaultPT(this._getOptionValue,"hooks.".concat(e));n==null||n(),i==null||i()}},_loadGlobalStyles:function(){var e,n=this._useGlobalPT(this._getOptionValue,"global.css",this.$params);At.isNotEmpty(n)&&AS.loadGlobalStyle(n,{nonce:(e=this.$config)===null||e===void 0||(e=e.csp)===null||e===void 0?void 0:e.nonce})},_getHostInstance:function(e){return e?this.$options.hostName?e.$.type.name===this.$options.hostName?e:this._getHostInstance(e.$parentInstance):e.$parentInstance:void 0},_getPropValue:function(e){var n;return this[e]||((n=this._getHostInstance(this))===null||n===void 0?void 0:n[e])},_getOptionValue:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=At.toFlatCase(n).split("."),o=r.shift();return o?At.isObject(e)?this._getOptionValue(At.getItemValue(e[Object.keys(e).find(function(l){return At.toFlatCase(l)===o})||""],i),r.join("."),i):void 0:At.getItemValue(e,i)},_getPTValue:function(){var e,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,l="data-pc-",s=/./g.test(i)&&!!r[i.split(".")[0]],d=this._getPropValue("ptOptions")||((e=this.$config)===null||e===void 0?void 0:e.ptOptions)||{},p=d.mergeSections,y=p===void 0?!0:p,v=d.mergeProps,w=v===void 0?!1:v,T=o?s?this._useGlobalPT(this._getPTClassValue,i,r):this._useDefaultPT(this._getPTClassValue,i,r):void 0,I=s?void 0:this._usePT(this._getPT(n,this.$name),this._getPTClassValue,i,Nr(Nr({},r),{},{global:T||{}})),L=i!=="transition"&&Nr(Nr({},i==="root"&&FA({},"".concat(l,"name"),At.toFlatCase(this.$.type.name))),{},FA({},"".concat(l,"section"),At.toFlatCase(i)));return y||!y&&I?w?Le(T,I,L):Nr(Nr(Nr({},T),I),L):Nr(Nr({},I),L)},_getPTClassValue:function(){var e=this._getOptionValue.apply(this,arguments);return At.isString(e)||At.isArray(e)?{class:e}:e},_getPT:function(e){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0,o=function(s){var d,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,y=r?r(s):s,v=At.toFlatCase(i),w=At.toFlatCase(n.$name);return(d=p?v!==w?y==null?void 0:y[v]:void 0:y==null?void 0:y[v])!==null&&d!==void 0?d:y};return e!=null&&e.hasOwnProperty("_usept")?{_usept:e._usept,originalValue:o(e.originalValue),value:o(e.value)}:o(e,!0)},_usePT:function(e,n,i,r){var o=function(L){return n(L,i,r)};if(e!=null&&e.hasOwnProperty("_usept")){var l,s=e._usept||((l=this.$config)===null||l===void 0?void 0:l.ptOptions)||{},d=s.mergeSections,p=d===void 0?!0:d,y=s.mergeProps,v=y===void 0?!1:y,w=o(e.originalValue),T=o(e.value);return w===void 0&&T===void 0?void 0:At.isString(T)?T:At.isString(w)?w:p||!p&&T?v?Le(w,T):Nr(Nr({},w),T):T}return o(e)},_useGlobalPT:function(e,n,i){return this._usePT(this.globalPT,e,n,i)},_useDefaultPT:function(e,n,i){return this._usePT(this.defaultPT,e,n,i)},ptm:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._getPTValue(this.pt,e,Nr(Nr({},this.$params),n))},ptmo:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this._getPTValue(e,n,Nr({instance:this},i),!1)},cx:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.isUnstyled?void 0:this._getOptionValue(this.$style.classes,e,Nr(Nr({},this.$params),n))},sx:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n){var r=this._getOptionValue(this.$style.inlineStyles,e,Nr(Nr({},this.$params),i)),o=this._getOptionValue(AS.inlineStyles,e,Nr(Nr({},this.$params),i));return[o,r]}}},computed:{globalPT:function(){var e,n=this;return this._getPT((e=this.$config)===null||e===void 0?void 0:e.pt,void 0,function(i){return At.getItemValue(i,{instance:n})})},defaultPT:function(){var e,n=this;return this._getPT((e=this.$config)===null||e===void 0?void 0:e.pt,void 0,function(i){return n._getOptionValue(i,n.$name,Nr({},n.$params))||At.getItemValue(i,Nr({},n.$params))})},isUnstyled:function(){var e;return this.unstyled!==void 0?this.unstyled:(e=this.$config)===null||e===void 0?void 0:e.unstyled},$params:function(){return{instance:this,props:this.$props,state:this.$data,parentInstance:this.$parentInstance}},$style:function(){return Nr(Nr({classes:void 0,inlineStyles:void 0,loadStyle:function(){},loadCustomStyle:function(){}},(this._getHostInstance(this)||{}).$style),this.$options.style)},$config:function(){var e;return(e=this.$primevue)===null||e===void 0?void 0:e.config},$name:function(){return this.$options.hostName||this.$.type.name}}},dee=`
@layer primevue {
    .p-splitter {
        display: flex;
        flex-wrap: nowrap;
    }

    .p-splitter-vertical {
        flex-direction: column;
    }

    .p-splitter-gutter {
        flex-grow: 0;
        flex-shrink: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: col-resize;
    }

    .p-splitter-horizontal.p-splitter-resizing {
        cursor: col-resize;
        user-select: none;
    }

    .p-splitter-horizontal > .p-splitter-gutter > .p-splitter-gutter-handle {
        height: 24px;
        width: 100%;
    }

    .p-splitter-horizontal > .p-splitter-gutter {
        cursor: col-resize;
    }

    .p-splitter-vertical.p-splitter-resizing {
        cursor: row-resize;
        user-select: none;
    }

    .p-splitter-vertical > .p-splitter-gutter {
        cursor: row-resize;
    }

    .p-splitter-vertical > .p-splitter-gutter > .p-splitter-gutter-handle {
        width: 24px;
        height: 100%;
    }
}
`,fee={root:function(e){var n=e.props;return["p-splitter p-component","p-splitter-"+n.layout]},gutter:"p-splitter-gutter",gutterHandler:"p-splitter-gutter-handle"},pee={root:function(e){var n=e.props;return[{display:"flex","flex-wrap":"nowrap"},n.layout==="vertical"?{"flex-direction":"column"}:""]}},mee=_o.extend({name:"splitter",css:dee,classes:fee,inlineStyles:pee}),gee={name:"BaseSplitter",extends:Ni,props:{layout:{type:String,default:"horizontal"},gutterSize:{type:Number,default:4},stateKey:{type:String,default:null},stateStorage:{type:String,default:"session"},step:{type:Number,default:5}},style:mee,provide:function(){return{$parentInstance:this}}};function ok(t){return bee(t)||_ee(t)||vee(t)||yee()}function yee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vee(t,e){if(t){if(typeof t=="string")return BA(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return BA(t,e)}}function _ee(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function bee(t){if(Array.isArray(t))return BA(t)}function BA(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var mm={name:"Splitter",extends:gee,emits:["resizestart","resizeend","resize"],dragging:!1,mouseMoveListener:null,mouseUpListener:null,touchMoveListener:null,touchEndListener:null,size:null,gutterElement:null,startPos:null,prevPanelElement:null,nextPanelElement:null,nextPanelSize:null,prevPanelSize:null,panelSizes:null,prevPanelIndex:null,timer:null,data:function(){return{prevSize:null}},mounted:function(){var e=this;if(this.panels&&this.panels.length){var n=!1;if(this.isStateful()&&(n=this.restoreState()),!n){var i=ok(this.$el.children).filter(function(o){return o.getAttribute("data-pc-name")==="splitterpanel"}),r=[];this.panels.map(function(o,l){var s=o.props&&o.props.size?o.props.size:null,d=s||100/e.panels.length;r[l]=d,i[l].style.flexBasis="calc("+d+"% - "+(e.panels.length-1)*e.gutterSize+"px)"}),this.panelSizes=r,this.prevSize=parseFloat(r[0]).toFixed(4)}}},beforeUnmount:function(){this.clear(),this.unbindMouseListeners()},methods:{getPTOptions:function(){var e;return{context:{nested:He.getAttribute((e=this.$parentInstance)===null||e===void 0?void 0:e.$el,"data-pc-name")==="splitterpanel"}}},isSplitterPanel:function(e){return e.type.name==="SplitterPanel"},onResizeStart:function(e,n,i){this.gutterElement=e.currentTarget||e.target.parentElement,this.size=this.horizontal?He.getWidth(this.$el):He.getHeight(this.$el),i||(this.dragging=!0,this.startPos=this.layout==="horizontal"?e.pageX||e.changedTouches[0].pageX:e.pageY||e.changedTouches[0].pageY),this.prevPanelElement=this.gutterElement.previousElementSibling,this.nextPanelElement=this.gutterElement.nextElementSibling,i?(this.prevPanelSize=this.horizontal?He.getOuterWidth(this.prevPanelElement,!0):He.getOuterHeight(this.prevPanelElement,!0),this.nextPanelSize=this.horizontal?He.getOuterWidth(this.nextPanelElement,!0):He.getOuterHeight(this.nextPanelElement,!0)):(this.prevPanelSize=100*(this.horizontal?He.getOuterWidth(this.prevPanelElement,!0):He.getOuterHeight(this.prevPanelElement,!0))/this.size,this.nextPanelSize=100*(this.horizontal?He.getOuterWidth(this.nextPanelElement,!0):He.getOuterHeight(this.nextPanelElement,!0))/this.size),this.prevPanelIndex=n,this.$emit("resizestart",{originalEvent:e,sizes:this.panelSizes}),this.$refs.gutter[n].setAttribute("data-p-gutter-resizing",!0),this.$el.setAttribute("data-p-resizing",!0)},onResize:function(e,n,i){var r,o,l;i?this.horizontal?(o=100*(this.prevPanelSize+n)/this.size,l=100*(this.nextPanelSize-n)/this.size):(o=100*(this.prevPanelSize-n)/this.size,l=100*(this.nextPanelSize+n)/this.size):(this.horizontal?r=e.pageX*100/this.size-this.startPos*100/this.size:r=e.pageY*100/this.size-this.startPos*100/this.size,o=this.prevPanelSize+r,l=this.nextPanelSize-r),this.prevSize=parseFloat(o).toFixed(4),this.validateResize(o,l)&&(this.prevPanelElement.style.flexBasis="calc("+o+"% - "+(this.panels.length-1)*this.gutterSize+"px)",this.nextPanelElement.style.flexBasis="calc("+l+"% - "+(this.panels.length-1)*this.gutterSize+"px)",this.panelSizes[this.prevPanelIndex]=o,this.panelSizes[this.prevPanelIndex+1]=l),this.$emit("resize",{originalEvent:e,sizes:this.panelSizes})},onResizeEnd:function(e){this.isStateful()&&this.saveState(),this.$emit("resizeend",{originalEvent:e,sizes:this.panelSizes}),this.$refs.gutter.forEach(function(n){return n.setAttribute("data-p-gutter-resizing",!1)}),this.$el.setAttribute("data-p-resizing",!1),this.clear()},repeat:function(e,n,i){this.onResizeStart(e,n,!0),this.onResize(e,i,!0)},setTimer:function(e,n,i){var r=this;this.clearTimer(),this.timer=setTimeout(function(){r.repeat(e,n,i)},40)},clearTimer:function(){this.timer&&clearTimeout(this.timer)},onGutterKeyUp:function(){this.clearTimer(),this.onResizeEnd()},onGutterKeyDown:function(e,n){switch(e.code){case"ArrowLeft":{this.layout==="horizontal"&&this.setTimer(e,n,this.step*-1),e.preventDefault();break}case"ArrowRight":{this.layout==="horizontal"&&this.setTimer(e,n,this.step),e.preventDefault();break}case"ArrowDown":{this.layout==="vertical"&&this.setTimer(e,n,this.step*-1),e.preventDefault();break}case"ArrowUp":{this.layout==="vertical"&&this.setTimer(e,n,this.step),e.preventDefault();break}}},onGutterMouseDown:function(e,n){this.onResizeStart(e,n),this.bindMouseListeners()},onGutterTouchStart:function(e,n){this.onResizeStart(e,n),this.bindTouchListeners(),e.preventDefault()},onGutterTouchMove:function(e){this.onResize(e),e.preventDefault()},onGutterTouchEnd:function(e){this.onResizeEnd(e),this.unbindTouchListeners(),e.preventDefault()},bindMouseListeners:function(){var e=this;this.mouseMoveListener||(this.mouseMoveListener=function(n){return e.onResize(n)},document.addEventListener("mousemove",this.mouseMoveListener)),this.mouseUpListener||(this.mouseUpListener=function(n){e.onResizeEnd(n),e.unbindMouseListeners()},document.addEventListener("mouseup",this.mouseUpListener))},bindTouchListeners:function(){var e=this;this.touchMoveListener||(this.touchMoveListener=function(n){return e.onResize(n.changedTouches[0])},document.addEventListener("touchmove",this.touchMoveListener)),this.touchEndListener||(this.touchEndListener=function(n){e.resizeEnd(n),e.unbindTouchListeners()},document.addEventListener("touchend",this.touchEndListener))},validateResize:function(e,n){var i=At.getVNodeProp(this.panels[0],"minSize");if(this.panels[0].props&&i&&i>e)return!1;var r=At.getVNodeProp(this.panels[1],"minSize");return!(this.panels[1].props&&r&&r>n)},unbindMouseListeners:function(){this.mouseMoveListener&&(document.removeEventListener("mousemove",this.mouseMoveListener),this.mouseMoveListener=null),this.mouseUpListener&&(document.removeEventListener("mouseup",this.mouseUpListener),this.mouseUpListener=null)},unbindTouchListeners:function(){this.touchMoveListener&&(document.removeEventListener("touchmove",this.touchMoveListener),this.touchMoveListener=null),this.touchEndListener&&(document.removeEventListener("touchend",this.touchEndListener),this.touchEndListener=null)},clear:function(){this.dragging=!1,this.size=null,this.startPos=null,this.prevPanelElement=null,this.nextPanelElement=null,this.prevPanelSize=null,this.nextPanelSize=null,this.gutterElement=null,this.prevPanelIndex=null},isStateful:function(){return this.stateKey!=null},getStorage:function(){switch(this.stateStorage){case"local":return window.localStorage;case"session":return window.sessionStorage;default:throw new Error(this.stateStorage+' is not a valid value for the state storage, supported values are "local" and "session".')}},saveState:function(){this.getStorage().setItem(this.stateKey,JSON.stringify(this.panelSizes))},restoreState:function(){var e=this,n=this.getStorage(),i=n.getItem(this.stateKey);if(i){this.panelSizes=JSON.parse(i);var r=ok(this.$el.children).filter(function(o){return o.getAttribute("data-pc-name")==="splitterpanel"});return r.forEach(function(o,l){o.style.flexBasis="calc("+e.panelSizes[l]+"% - "+(e.panels.length-1)*e.gutterSize+"px)"}),!0}return!1}},computed:{panels:function(){var e=this,n=[];return this.$slots.default().forEach(function(i){e.isSplitterPanel(i)?n.push(i):i.children instanceof Array&&i.children.forEach(function(r){e.isSplitterPanel(r)&&n.push(r)})}),n},gutterStyle:function(){return this.horizontal?{width:this.gutterSize+"px"}:{height:this.gutterSize+"px"}},horizontal:function(){return this.layout==="horizontal"}}},xee=["onMousedown","onTouchstart","onTouchmove","onTouchend"],wee=["aria-orientation","aria-valuenow","onKeydown"];function Eee(t,e,n,i,r,o){return le(),Ue("div",Le({class:t.cx("root"),style:t.sx("root"),"data-p-resizing":!1},t.ptm("root",o.getPTOptions()),{"data-pc-name":"splitter"}),[(le(!0),Ue(_n,null,or(o.panels,function(l,s){return le(),Ue(_n,{key:s},[(le(),Rt(Zn(l),{tabindex:"-1"})),s!==o.panels.length-1?(le(),Ue("div",Le({key:0,ref_for:!0,ref:"gutter",class:t.cx("gutter"),role:"separator",tabindex:"-1",onMousedown:function(p){return o.onGutterMouseDown(p,s)},onTouchstart:function(p){return o.onGutterTouchStart(p,s)},onTouchmove:function(p){return o.onGutterTouchMove(p,s)},onTouchend:function(p){return o.onGutterTouchEnd(p,s)},"data-p-gutter-resizing":!1},t.ptm("gutter")),[Qe("div",Le({class:t.cx("gutterHandler"),tabindex:"0",style:[o.gutterStyle],"aria-orientation":t.layout,"aria-valuenow":r.prevSize,onKeyup:e[0]||(e[0]=function(){return o.onGutterKeyUp&&o.onGutterKeyUp.apply(o,arguments)}),onKeydown:function(p){return o.onGutterKeyDown(p,s)}},t.ptm("gutterHandler")),null,16,wee)],16,xee)):Jt("",!0)],64)}),128))],16)}mm.render=Eee;var Tee=`
@layer primevue {
    .p-splitter-panel {
        flex-grow: 1;
    }

    .p-splitter-panel-nested {
        display: flex;
    }

    .p-splitter-panel .p-splitter {
        flex-grow: 1;
        border: 0 none;
    }
}
`,See={root:function(e){var n=e.instance;return["p-splitter-panel",{"p-splitter-panel-nested":n.isNested}]}},Cee=_o.extend({name:"splitterpanel",css:Tee,classes:See}),Aee={name:"BaseSplitterPanel",extends:Ni,props:{size:{type:Number,default:null},minSize:{type:Number,default:null}},style:Cee,provide:function(){return{$parentInstance:this}}},gl={name:"SplitterPanel",extends:Aee,computed:{isNested:function(){return this.$slots.default().some(function(e){return e.type.name==="Splitter"})},getPTOptions:function(){return{context:{nested:this.isNested}}}}};function Pee(t,e,n,i,r,o){return le(),Ue("div",Le({ref:"container",class:t.cx("root")},t.ptm("root",o.getPTOptions),{"data-pc-name":"splitterpanel"}),[Xn(t.$slots,"default")],16)}gl.render=Pee;var Iee=`
@keyframes ripple {
    100% {
        opacity: 0;
        transform: scale(2.5);
    }
}

@layer primevue {
    .p-ripple {
        overflow: hidden;
        position: relative;
    }

    .p-ink {
        display: block;
        position: absolute;
        background: rgba(255, 255, 255, 0.5);
        border-radius: 100%;
        transform: scale(0);
        pointer-events: none;
    }

    .p-ink-active {
        animation: ripple 0.4s linear;
    }

    .p-ripple-disabled .p-ink {
        display: none !important;
    }
}
`,Mee={root:"p-ink"},Ree=_o.extend({name:"ripple",css:Iee,classes:Mee}),Lee=lr.extend({style:Ree});function Oee(t){return Bee(t)||Fee(t)||kee(t)||Dee()}function Dee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kee(t,e){if(t){if(typeof t=="string")return zA(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zA(t,e)}}function Fee(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Bee(t){if(Array.isArray(t))return zA(t)}function zA(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var Rl=Lee.extend("ripple",{mounted:function(e){var n,i=e==null||(n=e.$instance)===null||n===void 0?void 0:n.$config;i&&i.ripple&&(this.create(e),this.bindEvents(e),e.setAttribute("data-pd-ripple",!0))},unmounted:function(e){this.remove(e)},timeout:void 0,methods:{bindEvents:function(e){e.addEventListener("mousedown",this.onMouseDown.bind(this))},unbindEvents:function(e){e.removeEventListener("mousedown",this.onMouseDown.bind(this))},create:function(e){var n=He.createElement("span",{role:"presentation","aria-hidden":!0,"data-p-ink":!0,"data-p-ink-active":!1,class:!this.isUnstyled()&&this.cx("root"),onAnimationEnd:this.onAnimationEnd.bind(this),"p-bind":this.ptm("root")});e.appendChild(n),this.$el=n},remove:function(e){var n=this.getInk(e);n&&(this.unbindEvents(e),n.removeEventListener("animationend",this.onAnimationEnd),n.remove())},onMouseDown:function(e){var n=this,i=e.currentTarget,r=this.getInk(i);if(!(!r||getComputedStyle(r,null).display==="none")){if(!this.isUnstyled()&&He.removeClass(r,"p-ink-active"),r.setAttribute("data-p-ink-active","false"),!He.getHeight(r)&&!He.getWidth(r)){var o=Math.max(He.getOuterWidth(i),He.getOuterHeight(i));r.style.height=o+"px",r.style.width=o+"px"}var l=He.getOffset(i),s=e.pageX-l.left+document.body.scrollTop-He.getWidth(r)/2,d=e.pageY-l.top+document.body.scrollLeft-He.getHeight(r)/2;r.style.top=d+"px",r.style.left=s+"px",!this.isUnstyled()&&He.addClass(r,"p-ink-active"),r.setAttribute("data-p-ink-active","true"),this.timeout=setTimeout(function(){r&&(!n.isUnstyled()&&He.removeClass(r,"p-ink-active"),r.setAttribute("data-p-ink-active","false"))},401)}},onAnimationEnd:function(e){this.timeout&&clearTimeout(this.timeout),!this.isUnstyled()&&He.removeClass(e.currentTarget,"p-ink-active"),e.currentTarget.setAttribute("data-p-ink-active","false")},getInk:function(e){return e&&e.children?Oee(e.children).find(function(n){return He.getAttribute(n,"data-pc-name")==="ripple"}):void 0}}}),zee={root:function(e){var n=e.instance,i=e.props;return["p-button p-togglebutton p-component",{"p-focus":n.focused,"p-button-icon-only":n.hasIcon&&!n.hasLabel,"p-disabled":i.disabled,"p-highlight":i.modelValue===!0}]},icon:function(e){var n=e.instance,i=e.props;return["p-button-icon",{"p-button-icon-left":i.iconPos==="left"&&n.label,"p-button-icon-right":i.iconPos==="right"&&n.label}]},label:"p-button-label"},Nee=_o.extend({name:"accordion",classes:zee}),Uee={name:"BaseToggleButton",extends:Ni,props:{modelValue:Boolean,onIcon:String,offIcon:String,onLabel:{type:String,default:"Yes"},offLabel:{type:String,default:"No"},iconPos:{type:String,default:"left"},disabled:{type:Boolean,default:!1},tabindex:{type:Number,default:null},inputId:{type:String,default:null},inputClass:{type:[String,Object],default:null},inputStyle:{type:Object,default:null},inputProps:{type:null,default:null},"aria-labelledby":{type:String,default:null},"aria-label":{type:String,default:null}},style:Nee,provide:function(){return{$parentInstance:this}}},NA={name:"ToggleButton",extends:Uee,emits:["update:modelValue","change","click","focus","blur"],outsideClickListener:null,data:function(){return{focused:!1}},mounted:function(){this.bindOutsideClickListener()},beforeUnmount:function(){this.unbindOutsideClickListener()},methods:{onClick:function(e){this.disabled||(this.$emit("update:modelValue",!this.modelValue),this.$emit("change",e),this.$emit("click",e),this.focused=!0)},onFocus:function(e){this.focused=!0,this.$emit("focus",e)},onBlur:function(e){this.focused=!1,this.$emit("blur",e)},bindOutsideClickListener:function(){var e=this;this.outsideClickListener||(this.outsideClickListener=function(n){e.focused&&!e.$refs.container.contains(n.target)&&(e.focused=!1)},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener:function(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)}},computed:{hasLabel:function(){return this.onLabel&&this.onLabel.length>0&&this.offLabel&&this.offLabel.length>0},hasIcon:function(){return this.$slots.icon||this.onIcon&&this.offIcon},label:function(){return this.hasLabel?this.modelValue?this.onLabel:this.offLabel:"&nbsp;"},getPTOptions:function(){return{context:{focused:this.focused,disabled:this.disabled,highlighted:this.modelValue===!0}}}},directives:{ripple:Rl}};function fv(t){"@babel/helpers - typeof";return fv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fv(t)}function sk(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function ak(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?sk(Object(n),!0).forEach(function(i){Vee(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):sk(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Vee(t,e,n){return e=jee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jee(t){var e=$ee(t,"string");return fv(e)==="symbol"?e:String(e)}function $ee(t,e){if(fv(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(fv(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Gee=["data-p-active"],Hee=["id","checked","value","aria-labelledby","aria-label"];function Wee(t,e,n,i,r,o){var l=ea("ripple");return fo((le(),Ue("div",Le({ref:"container",class:t.cx("root"),onClick:e[2]||(e[2]=function(s){return o.onClick(s)})},t.ptm("root",o.getPTOptions),{"data-p-active":t.modelValue===!0,"data-pc-name":"togglebutton"}),[Qe("span",Le({class:"p-hidden-accessible"},t.ptm("hiddenInputWrapper"),{"data-p-hidden-accessible":!0}),[Qe("input",Le({id:t.inputId,type:"checkbox",role:"switch",class:t.inputClass,style:t.inputStyle,checked:t.modelValue,value:t.modelValue,"aria-labelledby":t.ariaLabelledby,"aria-label":t.ariaLabel,onFocus:e[0]||(e[0]=function(s){return o.onFocus(s)}),onBlur:e[1]||(e[1]=function(s){return o.onBlur(s)})},ak(ak({},t.inputProps),t.ptm("hiddenInput"))),null,16,Hee)],16),Xn(t.$slots,"icon",{value:t.modelValue,class:ri(t.cx("icon"))},function(){return[t.onIcon||t.offIcon?(le(),Ue("span",Le({key:0,class:[t.cx("icon"),t.modelValue?t.onIcon:t.offIcon]},t.ptm("icon",o.getPTOptions)),null,16)):Jt("",!0)]}),Qe("span",Le({class:t.cx("label")},t.ptm("label",o.getPTOptions)),ki(o.label),17)],16,Gee)),[[l]])}NA.render=Wee;const po=(t,e)=>{const n=t.__vccOpts||t;for(const[i,r]of e)n[i]=r;return n},Kee={name:"Tooltip",props:{targetID:String,direction:String,description:String},data:()=>({}),computed:{},watch:{},created(){},mounted(){},methods:{}},Xee={id:"info-container"};function Zee(t,e,n,i,r,o){const l=Gn("font-awesome-icon"),s=ea("tooltip");return le(),Ue("div",Xee,[fo((le(),Ue("div",null,[Lt(l,{class:"infoIcon",icon:["fas","circle-info"],"fixed-width":""})])),[[s,n.description]])])}const m_=po(Kee,[["render",Zee],["__scopeId","data-v-24bd57d7"]]);function hw(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const xM=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),lk=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);lk&&parseFloat(lk[1]);const qee="3.4.14";function tu(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const Ex=typeof process!="object"||String(process)!=="[object process]"||process.browser,Yee=typeof window<"u"&&typeof window.orientation<"u",ck=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);ck&&parseFloat(ck[1]);function pv(t){"@babel/helpers - typeof";return pv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pv(t)}function Jee(t,e){if(pv(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(pv(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qee(t){var e=Jee(t,"string");return pv(e)==="symbol"?e:String(e)}function q(t,e,n){return e=Qee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class ete{constructor(e,n){q(this,"name",void 0),q(this,"workerThread",void 0),q(this,"isRunning",!0),q(this,"result",void 0),q(this,"_resolve",()=>{}),q(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((i,r)=>{this._resolve=i,this._reject=r})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){tu(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){tu(this.isRunning),this.isRunning=!1,this._reject(e)}}let PS=class{terminate(){}};const IS=new Map;function tte(t){tu(t.source&&!t.url||!t.source&&t.url);let e=IS.get(t.source||t.url);return e||(t.url&&(e=nte(t.url),IS.set(t.url,e)),t.source&&(e=HN(t.source),IS.set(t.source,e))),tu(e),e}function nte(t){if(!t.startsWith("http"))return t;const e=ite(t);return HN(e)}function HN(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function ite(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function WN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2?arguments[2]:void 0;const i=n||new Set;if(t){if(uk(t))i.add(t);else if(uk(t.buffer))i.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const r in t)WN(t[r],e,i)}}return n===void 0?Array.from(i):[]}function uk(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const MS=()=>{};class UA{static isSupported(){return typeof Worker<"u"&&Ex||typeof PS<"u"&&!Ex}constructor(e){q(this,"name",void 0),q(this,"source",void 0),q(this,"url",void 0),q(this,"terminated",!1),q(this,"worker",void 0),q(this,"onMessage",void 0),q(this,"onError",void 0),q(this,"_loadableURL","");const{name:n,source:i,url:r}=e;tu(i||r),this.name=n,this.source=i,this.url=r,this.onMessage=MS,this.onError=o=>console.log(o),this.worker=Ex?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=MS,this.onError=MS,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||WN(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=tte({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const i=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new PS(i,{eval:!1})}else if(this.source)e=new PS(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class rte{static isSupported(){return UA.isSupported()}constructor(e){q(this,"name","unnamed"),q(this,"source",void 0),q(this,"url",void 0),q(this,"maxConcurrency",1),q(this,"maxMobileConcurrency",1),q(this,"onDebug",()=>{}),q(this,"reuseWorkers",!0),q(this,"props",{}),q(this,"jobQueue",[]),q(this,"idleQueue",[]),q(this,"count",0),q(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(o,l,s)=>o.done(s),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(o,l)=>o.error(l);const r=new Promise(o=>(this.jobQueue.push({name:e,onMessage:n,onError:i,onStart:o}),this));return this._startQueuedJob(),await r}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const i=new ete(n.name,e);e.onMessage=r=>n.onMessage(i,r.type,r.payload),e.onError=r=>n.onError(i,r),n.onStart(i);try{await i.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new UA({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return Yee?this.maxMobileConcurrency:this.maxConcurrency}}const ote={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class Vc{static isSupported(){return UA.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Vc._workerFarm=Vc._workerFarm||new Vc({}),Vc._workerFarm.setProps(e),Vc._workerFarm}constructor(e){q(this,"props",void 0),q(this,"workerPools",new Map),this.props={...ote},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:i,url:r}=e;let o=this.workerPools.get(n);return o||(o=new rte({name:n,source:i,url:r}),o.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,o)),o}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}q(Vc,"_workerFarm",void 0);const ste="latest";function ate(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e[t.id]||{},i="".concat(t.id,"-worker.js");let r=n.workerUrl;if(!r&&t.id==="compression"&&(r=e.workerUrl),e._workerType==="test"&&(r="modules/".concat(t.module,"/dist/").concat(i)),!r){let o=t.version;o==="latest"&&(o=ste);const l=o?"@".concat(o):"";r="https://unpkg.com/@loaders.gl/".concat(t.module).concat(l,"/dist/").concat(i)}return tu(r),r}function lte(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:qee;tu(t,"no worker provided");const n=t.version;return!(!e||!n)}function cte(t,e){return!Vc.isSupported()||!Ex&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&(e==null?void 0:e.worker)}async function ute(t,e,n,i,r){const o=t.id,l=ate(t,n),d=Vc.getWorkerFarm(n).getWorkerPool({name:o,url:l});n=JSON.parse(JSON.stringify(n)),i=JSON.parse(JSON.stringify(i||{}));const p=await d.startJob("process-on-worker",hte.bind(null,r));return p.postMessage("process",{input:e,options:n,context:i}),await(await p.result).result}async function hte(t,e,n,i){switch(n){case"done":e.done(i);break;case"error":e.error(new Error(i.error));break;case"process":const{id:r,input:o,options:l}=i;try{const s=await t(o,l);e.postMessage("done",{id:r,result:s})}catch(s){const d=s instanceof Error?s.message:"unknown error";e.postMessage("error",{id:r,error:d})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function dte(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const i=new Uint8Array(t),r=new Uint8Array(e);for(let o=0;o<i.length;++o)if(i[o]!==r[o])return!1;return!0}function fte(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i=e.map(s=>s instanceof ArrayBuffer?new Uint8Array(s):s),r=i.reduce((s,d)=>s+d.byteLength,0),o=new Uint8Array(r);let l=0;for(const s of i)o.set(s,l),l+=s.byteLength;return o.buffer}async function pte(t){const e=[];for await(const n of t)e.push(n);return fte(...e)}function hk(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}let dk=class{constructor(e,n){this.name=void 0,this.type=void 0,this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=n,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=hk(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(hk()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},mte=class{constructor(e){this.id=void 0,this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const n of Object.values(this.stats))e(n)}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){const{name:n,type:i}=e;let r=this.stats[n];return r||(e instanceof dk?r=e:r=new dk(n,i),this.stats[n]=r),r}};const gte="Queued Requests",yte="Active Requests",vte="Cancelled Requests",_te="Queued Requests Ever",bte="Active Requests Ever",xte={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class wte{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};q(this,"props",void 0),q(this,"stats",void 0),q(this,"activeRequestCount",0),q(this,"requestQueue",[]),q(this,"requestMap",new Map),q(this,"deferredUpdate",null),this.props={...xte,...e},this.stats=new mte({id:this.props.id}),this.stats.get(gte),this.stats.get(yte),this.stats.get(vte),this.stats.get(_te),this.stats.get(bte)}scheduleRequest(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>0;if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);const i={handle:e,priority:0,getPriority:n},r=new Promise(o=>(i.resolve=o,i));return this.requestQueue.push(i),this.requestMap.set(e,r),this._issueNewRequests(),r}_issueRequest(e){const{handle:n,resolve:i}=e;let r=!1;const o=()=>{r||(r=!0,this.requestMap.delete(n),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,i?i({done:o}):Promise.resolve({done:o})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout(()=>this._issueNewRequestsAsync(),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(e!==0){this._updateAllRequests();for(let n=0;n<e;++n){const i=this.requestQueue.shift();i&&this._issueRequest(i)}}}_updateAllRequests(){const e=this.requestQueue;for(let n=0;n<e.length;++n){const i=e[n];this._updateRequest(i)||(e.splice(n,1),this.requestMap.delete(i.handle),n--)}e.sort((n,i)=>n.priority-i.priority)}_updateRequest(e){return e.priority=e.getPriority(e.handle),e.priority<0?(e.resolve(null),!1):!0}}let Ete="";const fk={};function Tte(t){for(const e in fk)if(t.startsWith(e)){const n=fk[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(Ete).concat(t)),t}function Ste(t){return t&&typeof t=="object"&&t.isBuffer}function KN(t){if(Ste(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function XN(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function Cte(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const Ate=t=>typeof t=="boolean",O0=t=>typeof t=="function",g_=t=>t!==null&&typeof t=="object",pk=t=>g_(t)&&t.constructor==={}.constructor,Pte=t=>t&&typeof t[Symbol.iterator]=="function",Ite=t=>t&&typeof t[Symbol.asyncIterator]=="function",wf=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,Ef=t=>typeof Blob<"u"&&t instanceof Blob,Mte=t=>t&&typeof t=="object"&&t.isBuffer,Rte=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||g_(t)&&O0(t.tee)&&O0(t.cancel)&&O0(t.getReader),Lte=t=>g_(t)&&O0(t.read)&&O0(t.pipe)&&Ate(t.readable),ZN=t=>Rte(t)||Lte(t),Ote=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,Dte=/^([-\w.]+\/[-\w.+]+)/;function kte(t){const e=Dte.exec(t);return e?e[1]:t}function mk(t){const e=Ote.exec(t);return e?e[1]:""}const qN=/\?.*/;function Fte(t){const e=t.match(qN);return e&&e[0]}function wM(t){return t.replace(qN,"")}function O2(t){return wf(t)?t.url:Ef(t)?t.name||"":typeof t=="string"?t:""}function EM(t){if(wf(t)){const e=t,n=e.headers.get("content-type")||"",i=wM(e.url);return kte(n)||mk(i)}return Ef(t)?t.type||"":typeof t=="string"?mk(t):""}function Bte(t){return wf(t)?t.headers["content-length"]||-1:Ef(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function YN(t){if(wf(t))return t;const e={},n=Bte(t);n>=0&&(e["content-length"]=String(n));const i=O2(t),r=EM(t);r&&(e["content-type"]=r);const o=await Ute(t);o&&(e["x-first-bytes"]=o),typeof t=="string"&&(t=new TextEncoder().encode(t));const l=new Response(t,{headers:e});return Object.defineProperty(l,"url",{value:i}),l}async function zte(t){if(!t.ok){const e=await Nte(t);throw new Error(e)}}async function Nte(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let i=t.statusText;n.includes("application/json")&&(i+=" ".concat(await t.text())),e+=i,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function Ute(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(i=>{const r=new FileReader;r.onload=o=>{var l;return i(o==null||(l=o.target)===null||l===void 0?void 0:l.result)},r.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),i=Vte(n);return"data:base64,".concat(i)}return null}function Vte(t){let e="";const n=new Uint8Array(t);for(let i=0;i<n.byteLength;i++)e+=String.fromCharCode(n[i]);return btoa(e)}async function gk(t,e){if(typeof t=="string"){t=Tte(t);let n=e;return e!=null&&e.fetch&&typeof(e==null?void 0:e.fetch)!="function"&&(n=e.fetch),await fetch(t,n)}return await YN(t)}function jte(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function y_(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||jte()}const Eb=globalThis.window||globalThis.self||globalThis.global,Iy=globalThis.process||{},JN=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";y_();function $te(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let Gte=class{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";this.storage=void 0,this.id=void 0,this.config=void 0,this.storage=$te(i),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function Hte(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function Wte(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function RS(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const r=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>i&&(n=Math.min(n,i/t.width));const o=t.width*n,l=t.height*n,s=["font-size:1px;","padding:".concat(Math.floor(l/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(l,"px;"),"background:url(".concat(r,");"),"background-size:".concat(o,"px ").concat(l,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),s]}let dw;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(dw||(dw={}));const Kte=10;function yk(t){return typeof t!="string"?t:(t=t.toUpperCase(),dw[t]||dw.WHITE)}function Xte(t,e,n){if(!y_&&typeof t=="string"){if(e){const i=yk(e);t="\x1B[".concat(i,"m").concat(t,"\x1B[39m")}if(n){const i=yk(n);t="\x1B[".concat(i+Kte,"m").concat(t,"\x1B[49m")}}return t}function Zte(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),i=Object.getOwnPropertyNames(n),r=t;for(const o of i){const l=r[o];typeof l=="function"&&(e.find(s=>o===s)||(r[o]=l.bind(t)))}}function fw(t,e){if(!t)throw new Error(e||"Assertion failed")}function Ap(){let t;if(y_()&&Eb.performance){var e,n;t=Eb==null||(e=Eb.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in Iy){var i;const r=Iy==null||(i=Iy.hrtime)===null||i===void 0?void 0:i.call(Iy);t=r[0]*1e3+r[1]/1e6}else t=Date.now();return t}const Pp={debug:y_()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},qte={enabled:!0,level:0};function Na(){}const vk={},_k={once:!0};let TM=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};this.id=void 0,this.VERSION=JN,this._startTs=Ap(),this._deltaTs=Ap(),this._storage=void 0,this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new Gte("__probe-".concat(this.id,"__"),qte),this.timeStamp("".concat(this.id," started")),Zte(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Ap()-this._startTs).toPrecision(10))}getDelta(){return Number((Ap()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){fw(e,n)}warn(e){return this._getLogFunction(0,e,Pp.warn,arguments,_k)}error(e){return this._getLogFunction(0,e,Pp.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,Pp.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,Pp.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){return this._getLogFunction(e,n,Pp.debug||Pp.info,arguments,_k)}table(e,n,i){return n?this._getLogFunction(e,n,console.table||Na,i&&[i],{tag:ene(n)}):Na}image(e){let{logLevel:n,priority:i,image:r,message:o="",scale:l=1}=e;return this._shouldLog(n||i)?y_()?Qte({image:r,message:o,scale:l}):Jte():Na}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Na)}group(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const r=bk({logLevel:e,message:n,opts:i}),{collapsed:o}=i;return r.method=(o?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},i,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Na)}withGroup(e,n,i){this.group(e,n)();try{i()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=QN(e)}_getLogFunction(e,n,i,r,o){if(this._shouldLog(e)){o=bk({logLevel:e,message:n,args:r,opts:o}),i=i||o.method,fw(i),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=Ap();const l=o.tag||o.message;if(o.once&&l)if(!vk[l])vk[l]=Ap();else return Na;return n=Yte(this.id,o.message,o),i.bind(console,n,...o.args)}return Na}};TM.VERSION=JN;function QN(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return fw(Number.isFinite(e)&&e>=0),e}function bk(t){const{logLevel:e,message:n}=t;t.logLevel=QN(e);const i=t.args?Array.from(t.args):[];for(;i.length&&i.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&i.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const r=typeof t.message;return fw(r==="string"||r==="object"),Object.assign(t,{args:i},t.opts)}function Yte(t,e,n){if(typeof e=="string"){const i=n.time?Wte(Hte(n.total)):"";e=n.time?"".concat(t,": ").concat(i,"  ").concat(e):"".concat(t,": ").concat(e),e=Xte(e,n.color,n.background)}return e}function Jte(t){return console.warn("removed"),Na}function Qte(t){let{image:e,message:n="",scale:i=1}=t;if(typeof e=="string"){const o=new Image;return o.onload=()=>{const l=RS(o,n,i);console.log(...l)},o.src=e,Na}const r=e.nodeName||"";if(r.toLowerCase()==="img")return console.log(...RS(e,n,i)),Na;if(r.toLowerCase()==="canvas"){const o=new Image;return o.onload=()=>console.log(...RS(o,n,i)),o.src=e.toDataURL(),Na}return Na}function ene(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const xk=new TM({id:"loaders.gl"});class tne{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class nne{constructor(){q(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.console.log.bind(this.console,...n)}info(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.console.info.bind(this.console,...n)}warn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.console.warn.bind(this.console,...n)}error(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.console.error.bind(this.console,...n)}}const e9={fetch:null,mimeType:void 0,nothrow:!1,log:new nne,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:xM,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},ine={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function t9(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const n9=()=>{const t=t9();return t.globalOptions=t.globalOptions||{...e9},t.globalOptions};function rne(t,e,n,i){return n=n||[],n=Array.isArray(n)?n:[n],one(t,n),ane(e,t,i)}function one(t,e){wk(t,null,e9,ine,e);for(const n of e){const i=t&&t[n.id]||{},r=n.options&&n.options[n.id]||{},o=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};wk(i,n.id,r,o,e)}}function wk(t,e,n,i,r){const o=e||"Top level",l=e?"".concat(e,"."):"";for(const s in t){const d=!e&&g_(t[s]),p=s==="baseUri"&&!e,y=s==="workerUrl"&&e;if(!(s in n)&&!p&&!y){if(s in i)xk.warn("".concat(o," loader option '").concat(l).concat(s,"' no longer supported, use '").concat(i[s],"'"))();else if(!d){const v=sne(s,r);xk.warn("".concat(o," loader option '").concat(l).concat(s,"' not recognized. ").concat(v))()}}}}function sne(t,e){const n=t.toLowerCase();let i="";for(const r of e)for(const o in r.options){if(t===o)return"Did you mean '".concat(r.id,".").concat(o,"'?");const l=o.toLowerCase();(n.startsWith(l)||l.startsWith(n))&&(i=i||"Did you mean '".concat(r.id,".").concat(o,"'?"))}return i}function ane(t,e,n){const r={...t.options||{}};return lne(r,n),r.log===null&&(r.log=new tne),Ek(r,n9()),Ek(r,e),r}function Ek(t,e){for(const n in e)if(n in e){const i=e[n];pk(i)&&pk(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function lne(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function SM(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function CM(t){var e,n;hw(t,"null loader"),hw(SM(t),"invalid loader");let i;return Array.isArray(t)&&(i=t[1],t=t[0],t={...t,options:{...t.options,...i}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const i9=()=>{const t=t9();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function cne(t){const e=i9();t=Array.isArray(t)?t:[t];for(const n of t){const i=CM(n);e.find(r=>i===r)||e.unshift(i)}}function une(){return i9()}const hne=new TM({id:"loaders.gl"}),dne=/\.([^.]+)$/;async function fne(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(!r9(t))return null;let r=Tk(t,e,{...n,nothrow:!0},i);if(r)return r;if(Ef(t)&&(t=await t.slice(0,10).arrayBuffer(),r=Tk(t,e,n,i)),!r&&!(n!=null&&n.nothrow))throw new Error(o9(t));return r}function Tk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(!r9(t))return null;if(e&&!Array.isArray(e))return CM(e);let r=[];e&&(r=r.concat(e)),n!=null&&n.ignoreRegisteredLoaders||r.push(...une()),mne(r);const o=pne(t,r,n,i);if(!o&&!(n!=null&&n.nothrow))throw new Error(o9(t));return o}function pne(t,e,n,i){const r=O2(t),o=EM(t),l=wM(r)||(i==null?void 0:i.url);let s=null,d="";if(n!=null&&n.mimeType&&(s=LS(e,n==null?void 0:n.mimeType),d="match forced by supplied MIME type ".concat(n==null?void 0:n.mimeType)),s=s||gne(e,l),d=d||(s?"matched url ".concat(l):""),s=s||LS(e,o),d=d||(s?"matched MIME type ".concat(o):""),s=s||vne(e,t),d=d||(s?"matched initial data ".concat(s9(t)):""),s=s||LS(e,n==null?void 0:n.fallbackMimeType),d=d||(s?"matched fallback MIME type ".concat(o):""),d){var p;hne.log(1,"selectLoader selected ".concat((p=s)===null||p===void 0?void 0:p.name,": ").concat(d,"."))}return s}function r9(t){return!(t instanceof Response&&t.status===204)}function o9(t){const e=O2(t),n=EM(t);let i="No valid loader found (";i+=e?"".concat(XN(e),", "):"no url provided, ",i+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const r=t?s9(t):"";return i+=r?' first bytes: "'.concat(r,'"'):"first bytes: not available",i+=")",i}function mne(t){for(const e of t)CM(e)}function gne(t,e){const n=e&&dne.exec(e),i=n&&n[1];return i?yne(t,i):null}function yne(t,e){e=e.toLowerCase();for(const n of t)for(const i of n.extensions)if(i.toLowerCase()===e)return n;return null}function LS(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function vne(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(_ne(e,n))return n}else if(ArrayBuffer.isView(e)){if(Sk(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&Sk(e,0,n))return n;return null}function _ne(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(i=>t.startsWith(i))}function Sk(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(r=>bne(t,e,n,r))}function bne(t,e,n,i){if(i instanceof ArrayBuffer)return dte(i,t,i.byteLength);switch(typeof i){case"function":return i(t,n);case"string":const r=VA(t,e,i.length);return i===r;default:return!1}}function s9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?VA(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?VA(t,0,e):""}function VA(t,e,n){if(t.byteLength<e+n)return"";const i=new DataView(t);let r="";for(let o=0;o<n;o++)r+=String.fromCharCode(i.getUint8(e+o));return r}const xne=256*1024;function*wne(t,e){const n=(e==null?void 0:e.chunkSize)||xne;let i=0;const r=new TextEncoder;for(;i<t.length;){const o=Math.min(t.length-i,n),l=t.slice(i,i+o);i+=o,yield r.encode(l)}}const Ene=256*1024;function Tne(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const{chunkSize:n=Ene}=e;let i=0;for(;i<t.byteLength;){const r=Math.min(t.byteLength-i,n),o=new ArrayBuffer(r),l=new Uint8Array(t,i,r);new Uint8Array(o).set(l),i+=r,yield o}}()}const Sne=1024*1024;async function*Cne(t,e){const n=(e==null?void 0:e.chunkSize)||Sne;let i=0;for(;i<t.size;){const r=i+n,o=await t.slice(i,r).arrayBuffer();i=r,yield o}}function Ck(t,e){return xM?Ane(t,e):Pne(t)}async function*Ane(t,e){const n=t.getReader();let i;try{for(;;){const r=i||n.read();e!=null&&e._streamReadAhead&&(i=n.read());const{done:o,value:l}=await r;if(o)return;yield KN(l)}}catch{n.releaseLock()}}async function*Pne(t,e){for await(const n of t)yield KN(n)}function Ine(t,e){if(typeof t=="string")return wne(t,e);if(t instanceof ArrayBuffer)return Tne(t,e);if(Ef(t))return Cne(t,e);if(ZN(t))return Ck(t,e);if(wf(t))return Ck(t.body,e);throw new Error("makeIterator")}const a9="Cannot convert supplied data type";function Mne(t,e,n){if(e.text&&typeof t=="string")return t;if(Mte(t)&&(t=t.buffer),t instanceof ArrayBuffer){const i=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(i):i}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let i=t.buffer;const r=t.byteLength||t.length;return(t.byteOffset!==0||r!==i.byteLength)&&(i=i.slice(t.byteOffset,t.byteOffset+r)),i}throw new Error(a9)}async function Rne(t,e,n){const i=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||i)return Mne(t,e);if(Ef(t)&&(t=await YN(t)),wf(t)){const r=t;return await zte(r),e.binary?await r.arrayBuffer():await r.text()}if(ZN(t)&&(t=Ine(t,n)),Pte(t)||Ite(t))return pte(t);throw new Error(a9)}function l9(t,e){const n=n9(),i=t||n;return typeof i.fetch=="function"?i.fetch:g_(i.fetch)?r=>gk(r,i):e!=null&&e.fetch?e==null?void 0:e.fetch:gk}function Lne(t,e,n){if(n)return n;const i={fetch:l9(e,t),...t};if(i.url){const r=wM(i.url);i.baseUrl=r,i.queryString=Fte(i.url),i.filename=XN(r),i.baseUrl=Cte(r)}return Array.isArray(i.loaders)||(i.loaders=null),i}function One(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const i=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...i]:i}return n&&n.length?n:null}async function AM(t,e,n,i){tu(!i||typeof i=="object"),e&&!Array.isArray(e)&&!SM(e)&&(i=void 0,n=e,e=void 0),t=await t,n=n||{};const r=O2(t),l=One(e,i),s=await fne(t,l,n);return s?(n=rne(n,s,l,r),i=Lne({url:r,parse:AM,loaders:l},n,i||null),await Dne(s,t,n,i)):null}async function Dne(t,e,n,i){if(lte(t),wf(e)){const r=e,{ok:o,redirected:l,status:s,statusText:d,type:p,url:y}=r,v=Object.fromEntries(r.headers.entries());i.response={headers:v,ok:o,redirected:l,status:s,statusText:d,type:p,url:y}}if(e=await Rne(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,i,t);if(cte(t,n))return await ute(t,e,n,i,AM);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,i,t);if(t.parse)return await t.parse(e,n,i,t);throw tu(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function mv(t,e,n,i){!Array.isArray(e)&&!SM(e)&&(n=e,e=void 0);const r=l9(n);let o=t;return typeof t=="string"&&(o=await r(t)),Ef(t)&&(o=await r(t)),await AM(o,e,n)}const kne="3.4.14",{_parseImageNode:Fne}=globalThis,jA=typeof Image<"u",$A=typeof ImageBitmap<"u",Bne=!!Fne,GA=xM?!0:Bne;function zne(t){switch(t){case"auto":return $A||jA||GA;case"imagebitmap":return $A;case"image":return jA;case"data":return GA;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function Nne(){if($A)return"imagebitmap";if(jA)return"image";if(GA)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function Une(t){const e=jne(t);if(!e)throw new Error("Not an image");return e}function Vne(t){switch(Une(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function jne(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const $ne=/^data:image\/svg\+xml/,Gne=/\.svg((\?|#).*)?$/;function PM(t){return t&&($ne.test(t)||Gne.test(t))}function Hne(t,e){if(PM(e)){let i=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(i=unescape(encodeURIComponent(i)))}catch(o){throw new Error(o.message)}return"data:image/svg+xml;base64,".concat(btoa(i))}return c9(t,e)}function c9(t,e){if(PM(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function u9(t,e,n){const i=Hne(t,n),r=self.URL||self.webkitURL,o=typeof i!="string"&&r.createObjectURL(i);try{return await Wne(o||i,e)}finally{o&&r.revokeObjectURL(o)}}async function Wne(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((i,r)=>{try{n.onload=()=>i(n),n.onerror=o=>r(new Error("Could not load image ".concat(t,": ").concat(o)))}catch(o){r(o)}})}const Kne={};let Ak=!0;async function Xne(t,e,n){let i;PM(n)?i=await u9(t,e,n):i=c9(t,n);const r=e&&e.imagebitmap;return await Zne(i,r)}async function Zne(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((qne(e)||!Ak)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),Ak=!1}return await createImageBitmap(t)}function qne(t){for(const e in t||Kne)return!1;return!0}function Yne(t){return!tie(t,"ftyp",4)||!(t[8]&96)?null:Jne(t)}function Jne(t){switch(Qne(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function Qne(t,e,n){return String.fromCharCode(...t.slice(e,n))}function eie(t){return[...t].map(e=>e.charCodeAt(0))}function tie(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=eie(e);for(let r=0;r<i.length;++r)if(i[r]!==t[r+n])return!1;return!0}const tc=!1,D0=!0;function h9(t){const e=v_(t);return iie(e)||sie(e)||rie(e)||oie(e)||nie(e)}function nie(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=Yne(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function iie(t){const e=v_(t);return e.byteLength>=24&&e.getUint32(0,tc)===2303741511?{mimeType:"image/png",width:e.getUint32(16,tc),height:e.getUint32(20,tc)}:null}function rie(t){const e=v_(t);return e.byteLength>=10&&e.getUint32(0,tc)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,D0),height:e.getUint16(8,D0)}:null}function oie(t){const e=v_(t);return e.byteLength>=14&&e.getUint16(0,tc)===16973&&e.getUint32(2,D0)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,D0),height:e.getUint32(22,D0)}:null}function sie(t){const e=v_(t);if(!(e.byteLength>=3&&e.getUint16(0,tc)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:i,sofMarkers:r}=aie();let o=2;for(;o+9<e.byteLength;){const l=e.getUint16(o,tc);if(r.has(l))return{mimeType:"image/jpeg",height:e.getUint16(o+5,tc),width:e.getUint16(o+7,tc)};if(!i.has(l))return null;o+=2,o+=e.getUint16(o,tc)}return null}function aie(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function v_(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function lie(t,e){const{mimeType:n}=h9(t)||{},i=globalThis._parseImageNode;return hw(i),await i(t,n)}async function cie(t,e,n){e=e||{};const r=(e.image||{}).type||"auto",{url:o}=n||{},l=uie(r);let s;switch(l){case"imagebitmap":s=await Xne(t,e,o);break;case"image":s=await u9(t,e,o);break;case"data":s=await lie(t);break;default:hw(!1)}return r==="data"&&(s=Vne(s)),s}function uie(t){switch(t){case"auto":case"data":return Nne();default:return zne(t),t}}const hie=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],die=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],fie={image:{type:"auto",decode:!0}},pie={id:"image",module:"images",name:"Images",version:kne,mimeTypes:die,extensions:hie,parse:cie,tests:[t=>!!h9(new DataView(t))],options:fie};function d9(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function du(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||d9()}const Tx={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},Tb=Tx.window||Tx.self||Tx.global,My=Tx.process||{},f9=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";du();const OS=globalThis;function p9(t){if(!t&&!du())return"Node";if(d9(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const i=n.indexOf("MSIE ")!==-1,r=n.indexOf("Trident/")!==-1;return i||r?"IE":OS.chrome?"Chrome":OS.safari?"Safari":OS.mozInnerScreenX?"Firefox":"Unknown"}function mie(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class gie{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";q(this,"storage",void 0),q(this,"id",void 0),q(this,"config",void 0),this.storage=mie(i),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function yie(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function vie(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function DS(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const r=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>i&&(n=Math.min(n,i/t.width));const o=t.width*n,l=t.height*n,s=["font-size:1px;","padding:".concat(Math.floor(l/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(l,"px;"),"background:url(".concat(r,");"),"background-size:".concat(o,"px ").concat(l,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),s]}let pw;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(pw||(pw={}));function Pk(t){return typeof t=="string"?pw[t.toUpperCase()]||pw.WHITE:t}function _ie(t,e,n){return!du&&typeof t=="string"&&(e&&(e=Pk(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=Pk(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function bie(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),i=Object.getOwnPropertyNames(n);for(const r of i)typeof t[r]=="function"&&(e.find(o=>r===o)||(t[r]=t[r].bind(t)))}function mw(t,e){if(!t)throw new Error(e||"Assertion failed")}function Ip(){let t;if(du&&"performance"in Tb){var e,n;t=Tb==null||(e=Tb.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in My){var i;const r=My==null||(i=My.hrtime)===null||i===void 0?void 0:i.call(My);t=r[0]*1e3+r[1]/1e6}else t=Date.now();return t}const Mp={debug:du&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},xie={enabled:!0,level:0};function Ua(){}const Ik={},Mk={once:!0};class IM{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};q(this,"id",void 0),q(this,"VERSION",f9),q(this,"_startTs",Ip()),q(this,"_deltaTs",Ip()),q(this,"_storage",void 0),q(this,"userData",{}),q(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new gie("__probe-".concat(this.id,"__"),xie),this.timeStamp("".concat(this.id," started")),bie(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Ip()-this._startTs).toPrecision(10))}getDelta(){return Number((Ip()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){mw(e,n)}warn(e){return this._getLogFunction(0,e,Mp.warn,arguments,Mk)}error(e){return this._getLogFunction(0,e,Mp.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,Mp.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,Mp.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];return this._getLogFunction(e,n,Mp.debug||Mp.info,arguments,Mk)}table(e,n,i){return n?this._getLogFunction(e,n,console.table||Ua,i&&[i],{tag:Sie(n)}):Ua}image(e){let{logLevel:n,priority:i,image:r,message:o="",scale:l=1}=e;return this._shouldLog(n||i)?du?Tie({image:r,message:o,scale:l}):Eie():Ua}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Ua)}group(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const r=Rk({logLevel:e,message:n,opts:i}),{collapsed:o}=i;return r.method=(o?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},i,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Ua)}withGroup(e,n,i){this.group(e,n)();try{i()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=m9(e)}_getLogFunction(e,n,i,r,o){if(this._shouldLog(e)){o=Rk({logLevel:e,message:n,args:r,opts:o}),i=i||o.method,mw(i),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=Ip();const l=o.tag||o.message;if(o.once)if(!Ik[l])Ik[l]=Ip();else return Ua;return n=wie(this.id,o.message,o),i.bind(console,n,...o.args)}return Ua}}q(IM,"VERSION",f9);function m9(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return mw(Number.isFinite(e)&&e>=0),e}function Rk(t){const{logLevel:e,message:n}=t;t.logLevel=m9(e);const i=t.args?Array.from(t.args):[];for(;i.length&&i.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&i.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const r=typeof t.message;return mw(r==="string"||r==="object"),Object.assign(t,{args:i},t.opts)}function wie(t,e,n){if(typeof e=="string"){const i=n.time?vie(yie(n.total)):"";e=n.time?"".concat(t,": ").concat(i,"  ").concat(e):"".concat(t,": ").concat(e),e=_ie(e,n.color,n.background)}return e}function Eie(t){return console.warn("removed"),Ua}function Tie(t){let{image:e,message:n="",scale:i=1}=t;if(typeof e=="string"){const o=new Image;return o.onload=()=>{const l=DS(o,n,i);console.log(...l)},o.src=e,Ua}const r=e.nodeName||"";if(r.toLowerCase()==="img")return console.log(...DS(e,n,i)),Ua;if(r.toLowerCase()==="canvas"){const o=new Image;return o.onload=()=>console.log(...DS(o,n,i)),o.src=e.toDataURL(),Ua}return Ua}function Sie(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const Ti=new IM({id:"deck"});let HA={};function Cie(t){HA=t}function ms(t,e,n,i){Ti.level>0&&HA[t]&&HA[t].call(null,e,n,i)}function Aie(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const Pie={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:Aie,parseTextSync:JSON.parse};function Iie(){const t="8.9.31",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error("deck.gl - multiple versions detected: ".concat(e," vs ").concat(t));return e||(Ti.log(1,"deck.gl ".concat(t))(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:Ti,_registerLoggers:Cie},cne([Pie,[pie,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const Mie=Iie(),Li={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Li,"IDENTITY",{get:()=>(Ti.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const xl={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Al={common:0,meters:1,pixels:2},Lk={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},Wn=new IM({id:"luma.gl"});function Is(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const Rie="Invalid WebGLRenderingContext",Lie="Requires WebGL2";function D2(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function bi(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function Oie(t){return bi(t)?t:null}function k2(t){return Is(D2(t),Rie),t}function vs(t){return Is(bi(t),Lie),t}const i0={};function Die(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function kie(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function Fie(t,e){i0[t]=!0,e!==void 0&&Die(e)}function Bie(t){const e=t.getError;t.getError=function(){let i;do i=e.apply(t),i!==0&&(i0[i]=!0);while(i!==0);for(i in i0)if(i0[i])return delete i0[i],parseInt(i,10);return 0}}const __=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let i=0;i<this.attribs.length;i++){const r=new t.VertexAttrib(n);this.attribs[i]=r}this.maxAttrib=0};__.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};__.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const Tf=function(e){const n=this;this.gl=e,Bie(e);const i=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(o){return o===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:i.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(o){const l=n.currentVertexArrayObject;l.maxAttrib=Math.max(l.maxAttrib,o);const s=l.attribs[o];return s.enabled=!0,i.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(o){const l=n.currentVertexArrayObject;l.maxAttrib=Math.max(l.maxAttrib,o);const s=l.attribs[o];return s.enabled=!1,i.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(o,l){switch(o){case 34962:n.currentArrayBuffer=l;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=l;break}return i.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(o,l){const d=n.currentVertexArrayObject.attribs[o];switch(l){case 34975:return d.buffer;case 34338:return d.enabled;case 34339:return d.size;case 34340:return d.stride;case 34341:return d.type;case 34922:return d.normalized;default:return i.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(o,l,s,d,p,y){const v=n.currentVertexArrayObject;v.maxAttrib=Math.max(v.maxAttrib,o);const w=v.attribs[o];return w.buffer=n.currentArrayBuffer,w.size=l,w.type=s,w.normalized=d,w.stride=p,w.offset=y,w.recache(),i.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{kie("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};Tf.prototype.VERTEX_ARRAY_BINDING_OES=34229;Tf.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let i=0;i<this.vertexArrayObjects.length;++i)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new __(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};Tf.prototype.createVertexArrayOES=function(){const e=new __(this);return this.vertexArrayObjects.push(e),e};Tf.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};Tf.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof __&&e.hasBeenBound&&e.ext===this)};Tf.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){Fie(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const i=this.original,r=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const o=this.currentVertexArrayObject;if(r===o)return;(!r||o.elementArrayBuffer!==r.elementArrayBuffer)&&i.bindBuffer.call(n,34963,o.elementArrayBuffer);let l=this.currentArrayBuffer;const s=Math.max(r?r.maxAttrib:0,o.maxAttrib);for(let d=0;d<=s;d++){const p=o.attribs[d],y=r?r.attribs[d]:null;if((!r||p.enabled!==y.enabled)&&(p.enabled?i.enableVertexAttribArray.call(n,d):i.disableVertexAttribArray.call(n,d)),p.enabled){let v=!1;(!r||p.buffer!==y.buffer)&&(l!==p.buffer&&(i.bindBuffer.call(n,34962,p.buffer),l=p.buffer),v=!0),(v||p.cached!==y.cached)&&i.vertexAttribPointer.call(n,d,p.size,p.type,p.normalized,p.stride,p.offset)}}this.currentArrayBuffer!==l&&i.bindBuffer.call(n,34962,this.currentArrayBuffer)};function zie(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const r=e.call(this)||[];return r.indexOf("OES_vertex_array_object")<0&&r.push("OES_vertex_array_object"),r};const n=t.getExtension;t.getExtension=function(r){const o=n.call(this,r);return o||(r!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new Tf(this)),this.__OESVertexArrayObject))}}const Ok="OES_element_index",Dk="WEBGL_draw_buffers",Nie="EXT_disjoint_timer_query",Uie="EXT_disjoint_timer_query_webgl2",Vie="EXT_texture_filter_anisotropic",kk="WEBGL_debug_renderer_info",jie=35723,$ie=4352,Gie=36795,Hie=34047,Wie=37445,Kie=37446,Ir=t=>bi(t)?void 0:0,Xie={3074:t=>bi(t)?void 0:36064,[jie]:t=>bi(t)?void 0:$ie,35977:Ir,32937:Ir,[Gie]:(t,e)=>{const n=bi(t)?t.getExtension(Uie):t.getExtension(Nie);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[Wie]:(t,e)=>{const n=t.getExtension(kk);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[Kie]:(t,e)=>{const n=t.getExtension(kk);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[Hie]:(t,e)=>{const n=t.luma.extensions[Vie];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:Ir,35071:Ir,37447:Ir,36063:(t,e)=>{if(!bi(t)){const n=t.getExtension(Dk);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:Ir,35374:Ir,35377:Ir,34852:t=>{if(!bi(t)){const e=t.getExtension(Dk);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(Ok)?2147483647:65535,33001:t=>t.getExtension(Ok)?16777216:65535,33e3:t=>16777216,37157:Ir,35373:Ir,35657:Ir,36183:Ir,37137:Ir,34045:Ir,35978:Ir,35979:Ir,35968:Ir,35376:Ir,35375:Ir,35659:Ir,37154:Ir,35371:Ir,35658:Ir,35076:Ir,35077:Ir,35380:Ir};function Zie(t,e,n){const i=Xie[n],r=typeof i=="function"?i(t,e,n):i;return r!==void 0?r:e(n)}const qie="OES_vertex_array_object",g9="ANGLE_instanced_arrays",Yie="WEBGL_draw_buffers",Jie="EXT_disjoint_timer_query",Qie="EXT_texture_filter_anisotropic",ere="VertexArray requires WebGL2 or OES_vertex_array_object extension";function tre(t,e){return{webgl2:bi(t),ext:t.getExtension(e)}}const y9={[qie]:{meta:{suffix:"OES"},createVertexArray:()=>{Is(!1,ere)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[g9]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){Is(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[Yie]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Is(!1)}},[Jie]:{meta:{suffix:"EXT"},createQuery:()=>{Is(!1)},deleteQuery:()=>{Is(!1)},beginQuery:()=>{Is(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},kS={readBuffer:(t,e,n)=>{bi(t)&&e(n)},getVertexAttrib:(t,e,n,i)=>{const{webgl2:r,ext:o}=tre(t,g9);let l;switch(i){case 35069:l=r?void 0:!1;break;case 35070:l=!r&&!o?0:void 0;break}return l!==void 0?l:e(n,i)},getProgramParameter:(t,e,n,i)=>{if(!bi(t))switch(i){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,i)},getInternalformatParameter:(t,e,n,i,r)=>{if(!bi(t))switch(r){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,i,r)},getTexParameter(t,e,n,i){switch(i){case 34046:const{extensions:r}=t.luma,o=r[Qie];i=o&&o.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,i)},getParameter:Zie,hint(t,e,n,i){return e(n,i)}};function nre(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(zie(t),ire(t),ore(t,y9),rre(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=nre;function ire(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function rre(t,e){let{target:n,target2:i}=e;Object.keys(kS).forEach(r=>{if(typeof kS[r]=="function"){const o=t[r]?t[r].bind(t):()=>{},l=kS[r].bind(null,t,o);n[r]=l,i[r]=l}})}function ore(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&sre(t,{extension:n,target:t.luma,target2:t})}function sre(t,e){let{extension:n,target:i,target2:r}=e;const o=y9[n];Is(o);const{meta:l={}}=o,{suffix:s=""}=l,d=t.getExtension(n);for(const p of Object.keys(o)){const y="".concat(p).concat(s);let v=null;p==="meta"||typeof t[p]=="function"||(d&&typeof d[y]=="function"?v=function(){return d[y](...arguments)}:typeof o[p]=="function"&&(v=o[p].bind(i))),v&&(i[p]=v,r[p]=v)}}const MM={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},Qu=(t,e,n)=>e?t.enable(n):t.disable(n),Fk=(t,e,n)=>t.hint(n,e),da=(t,e,n)=>t.pixelStorei(n,e),are=(t,e)=>{const n=bi(t)?36009:36160;return t.bindFramebuffer(n,e)},lre=(t,e)=>t.bindFramebuffer(36008,e);function Ry(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const cre={3042:Qu,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:Qu,2885:(t,e)=>t.cullFace(e),2929:Qu,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:Qu,35723:Fk,36006:are,2886:(t,e)=>t.frontFace(e),33170:Fk,2849:(t,e)=>t.lineWidth(e),32823:Qu,32824:"polygonOffset",10752:"polygonOffset",35977:Qu,32938:"sampleCoverage",32939:"sampleCoverage",3089:Qu,3088:(t,e)=>t.scissor(...e),2960:Qu,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:da,3317:da,37440:da,37441:da,37443:da,3330:da,3332:da,3331:da,36010:lre,3314:da,32878:da,3316:da,3315:da,32877:da,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=Ry(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=Ry(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=Ry(e)?e:[e,e];const[n,i]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,i)},stencilFunc:(t,e)=>{e=Ry(e)&&e.length===3?[...e,...e]:e;const[n,i,r,o,l,s]=e;t.stencilFuncSeparate(1028,n,i,r),t.stencilFuncSeparate(1029,o,l,s)},stencilOp:(t,e)=>{e=Ry(e)&&e.length===3?[...e,...e]:e;const[n,i,r,o,l,s]=e;t.stencilOpSeparate(1028,n,i,r),t.stencilOpSeparate(1029,o,l,s)},viewport:(t,e)=>t.viewport(...e)};function so(t,e,n){return e[t]!==void 0?e[t]:n[t]}const ure={blendEquation:(t,e,n)=>t.blendEquationSeparate(so(32777,e,n),so(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(so(32969,e,n),so(32968,e,n),so(32971,e,n),so(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(so(32824,e,n),so(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(so(32938,e,n),so(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,so(2962,e,n),so(2967,e,n),so(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,so(34816,e,n),so(36003,e,n),so(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,so(2964,e,n),so(2965,e,n),so(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,so(34817,e,n),so(34818,e,n),so(34819,e,n))},Bk={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,i,r)=>t({32773:new Float32Array([e,n,i,r])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,i,r)=>t({32969:e,32968:n,32971:i,32970:r}),clearColor:(t,e,n,i,r)=>t({3106:new Float32Array([e,n,i,r])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,i,r)=>t({3107:[e,n,i,r]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,i,r)=>t({3088:new Int32Array([e,n,i,r])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,i)=>t({2962:e,2967:n,2963:i,34816:e,36003:n,36004:i}),stencilFuncSeparate:(t,e,n,i,r)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:i,[e===1028?2963:36004]:r}),stencilOp:(t,e,n,i)=>t({2964:e,2965:n,2966:i,34817:e,34818:n,34819:i}),stencilOpSeparate:(t,e,n,i,r)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:i,[e===1028?2966:34819]:r}),viewport:(t,e,n,i,r)=>t({2978:[e,n,i,r]})},Hl=(t,e)=>t.isEnabled(e),zk={3042:Hl,2884:Hl,2929:Hl,3024:Hl,32823:Hl,32926:Hl,32928:Hl,3089:Hl,2960:Hl,35977:Hl};function v9(t){for(const e in t)return!1;return!0}function hre(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),i=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&i&&t.length===e.length){for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}return!1}function Nk(t,e){const n=t[e].bind(t);t[e]=function(){const r=arguments.length<=0?void 0:arguments[0];return r in t.state.cache?t.state.enable?t.state.cache[r]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function dre(t,e,n){const i=t[e].bind(t);t[e]=function(){for(var o=arguments.length,l=new Array(o),s=0;s<o;s++)l[s]=arguments[s];const{valueChanged:d,oldValue:p}=n(t.state._updateCache,...l);return d&&i(...l),p},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function fre(t){const e=t.useProgram.bind(t);t.useProgram=function(i){t.state.program!==i&&(e(i),t.state.program=i)}}class pre{constructor(e){let{copyState:n=!1,log:i=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?b9(e):Object.assign({},MM),this.log=i,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){Is(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];nu(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,i;const r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const o in e){Is(o!==void 0);const l=e[o],s=this.cache[o];hre(l,s)||(n=!0,i=s,r&&!(o in r)&&(r[o]=s),this.cache[o]=l)}return{valueChanged:n,oldValue:i}}}function _9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:i}=e;if(Is(i!==void 0),!t.state){const{polyfillContext:r}=globalThis;r&&r(t),t.state=new pre(t,{copyState:i}),fre(t);for(const o in Bk){const l=Bk[o];dre(t,o,l)}Nk(t,"getParameter"),Nk(t,"isEnabled")}return t.state.enable=n,t}function mre(t){t.state||_9(t,{copyState:!1}),t.state.push()}function Uk(t){Is(t.state),t.state.pop()}function nu(t,e){if(Is(D2(t),"setParameters requires a WebGL context"),v9(e))return;const n={};for(const r in e){const o=Number(r),l=cre[r];l&&(typeof l=="string"?n[l]=!0:l(t,e[r],o))}const i=t.state&&t.state.cache;if(i)for(const r in n){const o=ure[r];o(t,e,i)}}function b9(t,e){if(e=e||MM,typeof e=="number"){const r=e,o=zk[r];return o?o(t,r):t.getParameter(r)}const n=Array.isArray(e)?e:Object.keys(e),i={};for(const r of n){const o=zk[r];i[r]=o?o(t,Number(r)):t.getParameter(Number(r))}return i}function gre(t){nu(t,MM)}function Ga(t,e,n){if(v9(e))return n(t);const{nocatch:i=!0}=e;mre(t),nu(t,e);let r;if(i)r=n(t),Uk(t);else try{r=n(t)}finally{Uk(t)}return r}function cf(t){const{luma:e}=t;if(t.canvas&&e){const n=e.canvasSizeInfo,i="clientWidth"in n?n.clientWidth:t.canvas.clientWidth;return i?t.drawingBufferWidth/i:1}return 1}function FS(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=cf(t),r=t.drawingBufferWidth,o=t.drawingBufferHeight;return vre(e,i,r,o,n)}function yre(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function vre(t,e,n,i,r){const o=Vk(t[0],e,n);let l=jk(t[1],e,i,r),s=Vk(t[0]+1,e,n);const d=s===n-1?s:s-1;s=jk(t[1]+1,e,i,r);let p;return r?(s=s===0?s:s+1,p=l,l=s):p=s===i-1?s:s-1,{x:o,y:l,width:Math.max(d-o+1,1),height:Math.max(p-l+1,1)}}function Vk(t,e,n){return Math.min(Math.round(t*e),n-1)}function jk(t,e,n,i){return i?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const RM=du(),_re=RM&&typeof document<"u",x9={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function w9(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Is(RM,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},x9,t);const{width:e,height:n}=t;function i(s){if(t.throwOnError)throw new Error(s);return console.error(s),null}t.onError=i;let r;const{canvas:o}=t,l=Ere({canvas:o,width:e,height:n,onError:i});return r=wre(l,t),r?(r=LM(r,t),Tre(r),r):null}function LM(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||Sre(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},x9,e);const{manageState:n,debug:i}=e;return n&&_9(t,{copyState:!1,log:function(){for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return Wn.log(1,...o)()}}),RM&&i&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),Wn.level=Math.max(Wn.level,1)):Wn.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function bre(t){const e=t.getParameter(7936),n=t.getParameter(7937),i=t.getExtension("WEBGL_debug_renderer_info"),r=i&&t.getParameter(i.UNMASKED_VENDOR_WEBGL||7936),o=i&&t.getParameter(i.UNMASKED_RENDERER_WEBGL||7937);return{vendor:r||e,renderer:o||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function xre(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const i=yre(e.useDevicePixels);Cre(t,i,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function wre(t,e){const{onError:n}=e;let i=null;const r=d=>i=d.statusMessage||i;t.addEventListener("webglcontextcreationerror",r,!1);const{webgl1:o=!0,webgl2:l=!0}=e;let s=null;return l&&(s=s||t.getContext("webgl2",e),s=s||t.getContext("experimental-webgl2",e)),o&&(s=s||t.getContext("webgl",e),s=s||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",r,!1),s?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),s):n("Failed to create ".concat(l&&!o?"WebGL2":"WebGL"," context: ").concat(i||"Unknown error"))}function Ere(t){let{canvas:e,width:n=800,height:i=600,onError:r}=t,o;return typeof e=="string"?(_re&&document.readyState==="complete"||r("createGLContext called on canvas '".concat(e,"' before page was loaded")),o=document.getElementById(e)):e?o=e:(o=document.createElement("canvas"),o.id="lumagl-canvas",o.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",o.style.height=Number.isFinite(i)?"".concat(i,"px"):"100%",document.body.insertBefore(o,document.body.firstChild)),o}function Tre(t){const e=bi(t)?"WebGL2":"WebGL1",n=bre(t),i=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",r=t.debug?" debug":"";Wn.info(1,"".concat(e).concat(r," context ").concat(i))()}function Sre(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function Cre(t,e,n){let i="width"in n?n.width:t.canvas.clientWidth,r="height"in n?n.height:t.canvas.clientHeight;(!i||!r)&&(Wn.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,i=t.canvas.width||1,r=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const o=t.luma.canvasSizeInfo;if(o.clientWidth!==i||o.clientHeight!==r||o.devicePixelRatio!==e){let l=e;const s=Math.floor(i*l),d=Math.floor(r*l);t.canvas.width=s,t.canvas.height=d,(t.drawingBufferWidth!==s||t.drawingBufferHeight!==d)&&(Wn.warn("Device pixel ratio clamped")(),l=Math.min(t.drawingBufferWidth/i,t.drawingBufferHeight/r),t.canvas.width=Math.floor(i*l),t.canvas.height=Math.floor(r*l)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:i,clientHeight:r,devicePixelRatio:e})}}function $k(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class Gk{constructor(e,n){q(this,"name",void 0),q(this,"type",void 0),q(this,"sampleSize",1),q(this,"time",void 0),q(this,"count",void 0),q(this,"samples",void 0),q(this,"lastTiming",void 0),q(this,"lastSampleTime",void 0),q(this,"lastSampleCount",void 0),q(this,"_count",0),q(this,"_time",0),q(this,"_samples",0),q(this,"_startTime",0),q(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=$k(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime($k()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class OM{constructor(e){q(this,"id",void 0),q(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:i}=e;return this.stats[n]||(e instanceof Gk?this.stats[n]=e:this.stats[n]=new Gk(n,i)),this.stats[n]}}const k0="8.5.21",Are="set luma.log.level=1 (or higher) to trace rendering";class Pre{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new OM({id:e})),this.stats.get(e)}}const Gd=new Pre;if(globalThis.luma&&globalThis.luma.VERSION!==k0)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(k0));globalThis.luma||(du()&&Wn.log(1,"luma.gl ".concat(k0," - ").concat(Are))(),globalThis.luma=globalThis.luma||{VERSION:k0,version:k0,log:Wn,stats:Gd,globals:{modules:{},nodeIO:{}}});function Ire(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function Mre(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function Tn(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function BS(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const i=t[e];return Tn(i!==void 0,"Accessing undefined constant GL.".concat(e)),i}function Th(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const zS={};function dc(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";zS[t]=zS[t]||1;const e=zS[t]++;return"".concat(t,"-").concat(e)}function Hk(t){return Tn(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function km(t){let e=!0;for(const n in t){e=!1;break}return e}function E9(t,e,n,i){const r="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),o=Object.getPrototypeOf(t);i.forEach(l=>{o.methodName||(o[l]=()=>{throw Wn.removed("Calling removed method ".concat(e,".").concat(l,": "),r)(),new Error(l)})})}const Rp="Resource subclass must define virtual methods";let fu=class{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};k2(e);const{id:i,userData:r={}}=n;this.gl=e,this.gl2=e,this.id=i||dc(this[Symbol.toStringTag]),this.userData=r,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(i=>i.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=BS(this.gl,e),Tn(e);const r=(this.constructor.PARAMETERS||{})[e];if(r){const o=bi(this.gl);if(!((!("webgl2"in r)||o)&&(!("extension"in r)||this.gl.getExtension(r.extension)))){const s=r.webgl1,d="webgl2"in r?r.webgl2:r.webgl1;return o?d:s}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:i}=e,r=this.constructor.PARAMETERS||{},o=bi(this.gl),l={},s=n||Object.keys(r);for(const d of s){const p=r[d];if(p&&(!("webgl2"in p)||o)&&(!("extension"in p)||this.gl.getExtension(p.extension))){const v=i?Th(this.gl,d):d;l[v]=this.getParameter(d,e),i&&p.type==="GLenum"&&(l[v]=Th(this.gl,l[v]))}}return l}setParameter(e,n){e=BS(this.gl,e),Tn(e);const r=(this.constructor.PARAMETERS||{})[e];if(r){const o=bi(this.gl);if(!((!("webgl2"in r)||o)&&(!("extension"in r)||this.gl.getExtension(r.extension))))throw new Error("Parameter not available on this platform");r.type==="GLenum"&&(n=BS(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,i){return E9(this,e,n,i)}initialize(e){}_createHandle(){throw new Error(Rp)}_deleteHandle(){throw new Error(Rp)}_bindHandle(e){throw new Error(Rp)}_getOptsFromHandle(){throw new Error(Rp)}_getParameter(e,n){throw new Error(Rp)}_setParameter(e,n){throw new Error(Rp)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=Gd.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];Gd.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const r=Gd.get("Memory Usage".concat(i));r.get("GPU Memory").addCount(e),r.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const i=Gd.get("Memory Usage".concat(n));i.get("GPU Memory").subtractCount(this.byteLength),i.get("".concat(e," Memory")).subtractCount(this.byteLength)}};const Rre="Failed to deduce GL constant from typed array";function WA(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(Rre)}}function gv(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function Lre(t){let{data:e,width:n,height:i,bytesPerPixel:r=4,temp:o}=t;const l=n*r;o=o||new Uint8Array(l);for(let s=0;s<i/2;++s){const d=s*l,p=(i-s-1)*l;o.set(e.subarray(d,d+l)),e.copyWithin(d,p,p+l),e.set(o,p)}}function Ore(t){let{data:e,width:n,height:i}=t;const r=Math.round(n/2),o=Math.round(i/2),l=new Uint8Array(r*o*4);for(let s=0;s<o;s++)for(let d=0;d<r;d++)for(let p=0;p<4;p++)l[(s*r+d)*4+p]=e[(s*2*n+d*2)*4+p];return{data:l,width:r,height:o}}function KA(t,e,n){const{removedProps:i={},deprecatedProps:r={},replacedProps:o={}}=n;for(const s in i)if(s in e){const p=i[s]?"".concat(t,".").concat(i[s]):"N/A";Wn.removed("".concat(t,".").concat(s),p)()}for(const s in r)if(s in e){const d=r[s];Wn.deprecated("".concat(t,".").concat(s),"".concat(t,".").concat(d))()}let l=null;for(const s in o)if(s in e){const d=o[s];Wn.deprecated("".concat(t,".").concat(s),"".concat(t,".").concat(d))(),l=l||Object.assign({},e),l[d]=e[s],delete l[s]}return l||e}const Dre={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},kre={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class ba{static getBytesPerElement(e){return gv(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return Tn(e.size),gv(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new ba(Dre,...n)}constructor(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];n.forEach(r=>this._assign(r)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return ba.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return ba.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=KA("Accessor",e,kre),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const Wk=10,T9={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},Fre={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:T9},Bre={removedProps:T9};class $i extends fu{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/ba.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/ba.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=KA("Buffer",e,Fre),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=KA("Buffer",e,Bre),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new ba(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:i=0,srcOffset:r=0}=e,o=e.byteLength||e.length;Tn(n);const l=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(l,this.handle),r!==0||o!==void 0?(vs(this.gl),this.gl.bufferSubData(this.target,i,n,r,o)):this.gl.bufferSubData(l,i,n),this.gl.bindBuffer(l,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:i=0,writeOffset:r=0,size:o}=e;const{gl:l}=this;return vs(l),l.bindBuffer(36662,n.handle),l.bindBuffer(36663,this.handle),l.copyBufferSubData(36662,36663,i,r,o),l.bindBuffer(36662,null),l.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:i=0,length:r=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};vs(this.gl);const o=gv(this.accessor.type||5126,{clamped:!1}),l=this._getAvailableElementCount(n),s=i;let d,p;e?(p=e.length,d=p-s):(d=Math.min(l,r||l),p=s+d);const y=Math.min(l,d);return r=r||y,Tn(r<=y),e=e||new o(p),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,i,r),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:i=0,size:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?r!==void 0?this.gl.bindBufferRange(e,n,this.handle,i,r):(Tn(i===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(Wk,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;Tn(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const r=this._getTarget();this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,this.usage),this.gl.bufferSubData(r,n,e),this.gl.bindBuffer(r,null),this.debugData=e.slice(0,Wk),this.bytesUsed=i,this._trackAllocatedMemory(i);const o=WA(e);return Tn(o),this.setAccessor(new ba(this.accessor,{type:o})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;Tn(e>=0),this._trackDeallocatedMemory();let i=e;e===0&&(i=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,n),this.gl.bindBuffer(r,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=gv(this.accessor.type||5126,{clamped:!1}),i=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-i}_inferType(e){this.accessor.type||this.setAccessor(new ba(this.accessor,{type:WA(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return Wn.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return Wn.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return Wn.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return Wn.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new ba(this.accessor,e),this}}const DM={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},S9={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},C9={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function zre(t,e){const n=DM[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const i=bi(t)&&n.gl2||n.gl1;return typeof i=="string"?t.getExtension(i):i}function Nre(t,e){const n=DM[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const Ure=[9729,9728],Kk=globalThis.WebGLBuffer||function(){};class uf extends fu{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:i,linearFiltering:r}=n;let o=!0;return i&&(o=o&&zre(e,i),o=o&&(!r||Nre(e,i))),o}constructor(e,n){const{id:i=dc("texture"),handle:r,target:o}=n;super(e,{id:i,handle:r}),this.target=o,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(B=>this.initialize(Object.assign({},e,{pixels:B,data:B}))),this;const i=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(i&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:r=null,format:o=6408,border:l=0,recreate:s=!1,parameters:d={},pixelStore:p={},textureUnit:y=void 0}=e;n||(n=r);let{width:v,height:w,dataFormat:T,type:I,compressed:L=!1,mipmaps:k=!0}=e;const{depth:F=0}=e;return{width:v,height:w,compressed:L,dataFormat:T,type:I}=this._deduceParameters({format:o,type:I,dataFormat:T,compressed:L,data:n,width:v,height:w}),this.width=v,this.height=w,this.depth=F,this.format=o,this.type=I,this.dataFormat=T,this.border=l,this.textureUnit=y,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),k&&this._isNPOT()&&(Wn.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),k=!1,this._updateForNPOT(d)),this.mipmaps=k,this.setImageData({data:n,width:v,height:w,depth:F,format:o,type:I,dataFormat:T,border:l,mipmaps:k,parameters:p,compressed:L}),k&&this.generateMipmap(),this.setParameters(d),s&&(this.data=n),i&&(this._video={video:n,parameters:d,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:i}=this._video;if(i===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:i,mipmaps:r=!1}=e;return i!==this.width||n!==this.height?this.initialize({width:i,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:r}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(Wn.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Ga(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:i=null,level:r=0,format:o=this.format,border:l=this.border,offset:s=0,parameters:d={}}=e;let{data:p=null,type:y=this.type,width:v=this.width,height:w=this.height,dataFormat:T=this.dataFormat,compressed:I=!1}=e;p||(p=i),{type:y,dataFormat:T,compressed:I,width:v,height:w}=this._deduceParameters({format:o,type:y,dataFormat:T,compressed:I,data:p,width:v,height:w});const{gl:L}=this;L.bindTexture(this.target,this.handle);let k=null;({data:p,dataType:k}=this._getDataType({data:p,compressed:I}));let F,B=0;if(Ga(this.gl,d,()=>{switch(k){case"null":L.texImage2D(n,r,o,v,w,l,T,y,p);break;case"typed-array":L.texImage2D(n,r,o,v,w,l,T,y,p,s);break;case"buffer":F=vs(L),F.bindBuffer(35052,p.handle||p),F.texImage2D(n,r,o,v,w,l,T,y,s),F.bindBuffer(35052,null);break;case"browser-object":bi(L)?L.texImage2D(n,r,o,v,w,l,T,y,p):L.texImage2D(n,r,o,T,y,p);break;case"compressed":for(const[G,U]of p.entries())L.compressedTexImage2D(n,G,U.format,U.width,U.height,l,U.data),B+=U.levelSize;break;default:Tn(!1,"Unknown image data type")}}),k==="compressed")this._trackAllocatedMemory(B,"Texture");else if(p&&p.byteLength)this._trackAllocatedMemory(p.byteLength,"Texture");else{const G=S9[this.dataFormat]||4,U=C9[this.type]||1;this._trackAllocatedMemory(this.width*this.height*G*U,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:i=null,data:r=null,x:o=0,y:l=0,width:s=this.width,height:d=this.height,level:p=0,format:y=this.format,type:v=this.type,dataFormat:w=this.dataFormat,compressed:T=!1,offset:I=0,border:L=this.border,parameters:k={}}=e;if({type:v,dataFormat:w,compressed:T,width:s,height:d}=this._deduceParameters({format:y,type:v,dataFormat:w,compressed:T,data:r,width:s,height:d}),Tn(this.depth===0,"texSubImage not supported for 3D textures"),r||(r=i),r&&r.data){const F=r;r=F.data,s=F.shape[0],d=F.shape[1]}r instanceof $i&&(r=r.handle),this.gl.bindTexture(this.target,this.handle),Ga(this.gl,k,()=>{if(T)this.gl.compressedTexSubImage2D(n,p,o,l,s,d,y,r);else if(r===null)this.gl.texSubImage2D(n,p,o,l,s,d,w,v,null);else if(ArrayBuffer.isView(r))this.gl.texSubImage2D(n,p,o,l,s,d,w,v,r,I);else if(r instanceof Kk){const F=vs(this.gl);F.bindBuffer(35052,r),F.texSubImage2D(n,p,o,l,s,d,w,v,I),F.bindBuffer(35052,null)}else bi(this.gl)?vs(this.gl).texSubImage2D(n,p,o,l,s,d,w,v,r):this.gl.texSubImage2D(n,p,o,l,w,v,r)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return Wn.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:i=!1}=e;return i?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof $i?{data:n.handle,dataType:"buffer"}:n instanceof Kk?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:i}=e;let{width:r,height:o,dataFormat:l,type:s,compressed:d}=e;const p=DM[n];return l=l||p&&p.dataFormat,s=s||p&&p.types[0],d=d||p&&p.compressed,{width:r,height:o}=this._deduceImageSize(i,r,o),{dataFormat:l,type:s,compressed:d,width:r,height:o,format:n,data:i}}_deduceImageSize(e,n,i){let r;return typeof ImageData<"u"&&e instanceof ImageData?r={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?r={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?r={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?r={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?r={width:e.videoWidth,height:e.videoHeight}:e?r={width:n,height:i}:r={width:n>=0?n:1,height:i>=0?i:1},Tn(r,"Could not deduced texture size"),Tn(n===void 0||r.width===n,"Deduced texture width does not match supplied width"),Tn(i===void 0||r.height===i,"Deduced texture height does not match supplied height"),r}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:Tn(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return bi(this.gl)||!this.width||!this.height?!1:!Hk(this.width)||!Hk(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:Ure.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let Vre="";function jre(t,e){return Tn(typeof t=="string"),t=Vre+t,new Promise((n,i)=>{try{const r=new Image;r.onload=()=>n(r),r.onerror=()=>i(new Error("Could not load image ".concat(t,"."))),r.crossOrigin=e&&e.crossOrigin||"anonymous",r.src=t}catch(r){i(r)}})}class ws extends uf{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return uf.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};k2(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:jre(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const XA=[34069,34070,34071,34072,34073,34074];class A9 extends uf{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};k2(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:i={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(i)}),this}subImage(e){let{face:n,data:i,x:r=0,y:o=0,mipmapLevel:l=0}=e;return this._subImage({target:n,data:i,x:r,y:o,mipmapLevel:l})}async setCubeMapImageData(e){let{width:n,height:i,pixels:r,data:o,border:l=0,format:s=6408,type:d=5121}=e;const{gl:p}=this,y=r||o,v=await Promise.all(XA.map(w=>{const T=y[w];return Promise.all(Array.isArray(T)?T:[T])}));this.bind(),XA.forEach((w,T)=>{v[T].length>1&&this.opts.mipmaps!==!1&&Wn.warn("".concat(this.id," has mipmap and multiple LODs."))(),v[T].forEach((I,L)=>{n&&i?p.texImage2D(w,L,s,n,i,l,s,d,I):p.texImage2D(w,L,s,s,d,I)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:i,height:r,pixels:o,data:l,border:s=0,format:d=6408,type:p=5121}=e,{gl:y}=this,v=o||l;return this.bind(),v instanceof Promise?v.then(w=>this.setImageDataForFace(Object.assign({},e,{face:n,data:w,pixels:w}))):this.width||this.height?y.texImage2D(n,0,d,i,r,s,d,p,v):y.texImage2D(n,0,d,d,p,v),this}}A9.FACES=XA;class $re extends uf{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return bi(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};vs(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:i=6408,width:r,height:o,depth:l=1,border:s=0,format:d,type:p=5121,offset:y=0,data:v,parameters:w={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),Ga(this.gl,w,()=>{ArrayBuffer.isView(v)&&this.gl.texImage3D(this.target,n,i,r,o,l,s,d,p,v),v instanceof $i&&(this.gl.bindBuffer(35052,v.handle),this.gl.texImage3D(this.target,n,i,r,o,l,s,d,p,y))}),v&&v.byteLength)this._trackAllocatedMemory(v.byteLength,"Texture");else{const T=S9[this.dataFormat]||4,I=C9[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*T*I,"Texture")}return this.loaded=!0,this}}const Cd="EXT_color_buffer_float",Xk={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:Cd,bpp:2},33327:{gl2:Cd,bpp:4},34842:{gl2:Cd,bpp:8},33326:{gl2:Cd,bpp:4},33328:{gl2:Cd,bpp:8},34836:{gl2:Cd,bpp:16},35898:{gl2:Cd,bpp:4}};function Gre(t,e,n){const i=n[e];if(!i)return!1;const r=bi(t)&&i.gl2||i.gl1;return typeof r=="string"?t.getExtension(r):r}class Zp extends fu{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||Gre(e,n,Xk)}static getSamplesForFormat(e,n){let{format:i}=n;return e.getInternalformatParameter(36161,i,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:i=1,height:r=1,samples:o=0}=e;return Tn(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),o!==0&&bi(this.gl)?this.gl.renderbufferStorageMultisample(36161,o,n,i,r):this.gl.renderbufferStorage(36161,n,i,r),this.format=n,this.width=i,this.height=r,this.samples=o,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*Xk[this.format].bpp),this}resize(e){let{width:n,height:i}=e;return n!==this.width||i!==this.height?this.initialize({width:n,height:i,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const Hre=256,Wre=1024,Kre=16384,Zk=6144,qk=6145,Yk=6146,Jk=34041,P9="clear: bad arguments";function kM(t){let{framebuffer:e=null,color:n=null,depth:i=null,stencil:r=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o={};e&&(o.framebuffer=e);let l=0;n&&(l|=Kre,n!==!0&&(o.clearColor=n)),i&&(l|=Hre,i!==!0&&(o.clearDepth=i)),r&&(l|=Wre,i!==!0&&(o.clearStencil=i)),Tn(l!==0,P9),Ga(t,o,()=>{t.clear(l)})}function Xre(t){let{framebuffer:e=null,buffer:n=Zk,drawBuffer:i=0,value:r=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};vs(t),Ga(t,{framebuffer:e},()=>{switch(n){case Zk:switch(r.constructor){case Int32Array:t.clearBufferiv(n,i,r);break;case Uint32Array:t.clearBufferuiv(n,i,r);break;case Float32Array:default:t.clearBufferfv(n,i,r)}break;case qk:t.clearBufferfv(qk,0,[r]);break;case Yk:t.clearBufferiv(Yk,0,[r]);break;case Jk:const[o,l]=r;t.clearBufferfi(Jk,0,o,l);break;default:Tn(!1,P9)}})}function Zre(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return Tn(!1),0}}function b_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:i=0,sourceFormat:r=6408}=e;let{sourceAttachment:o=36064,target:l=null,sourceWidth:s,sourceHeight:d,sourceType:p}=e;const{framebuffer:y,deleteFramebuffer:v}=I9(t);Tn(y);const{gl:w,handle:T,attachments:I}=y;s=s||y.width,d=d||y.height,o===36064&&T===null&&(o=1028),Tn(I[o]),p=p||I[o].type,l=Yre(l,p,r,s,d),p=p||WA(l);const L=w.bindFramebuffer(36160,T);return w.readPixels(n,i,s,d,r,p,l),w.bindFramebuffer(36160,L||null),v&&y.delete(),l}function Qk(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=b_(t,{sourceAttachment:e}),{width:r,height:o}=t;for(;o>n;)({data:i,width:r,height:o}=Ore({data:i,width:r,height:o}));Lre({data:i,width:r,height:o});const l=document.createElement("canvas");l.width=r,l.height=o;const s=l.getContext("2d"),d=s.createImageData(r,o);return d.data.set(i),s.putImageData(d,0,0),l.toDataURL()}function qre(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{sourceX:i=0,sourceY:r=0,targetMipmaplevel:o=0,targetInternalFormat:l=6408}=n;let{targetX:s,targetY:d,targetZ:p,width:y,height:v}=n;const{framebuffer:w,deleteFramebuffer:T}=I9(t);Tn(w);const{gl:I,handle:L}=w,k=typeof s<"u"||typeof d<"u"||typeof p<"u";s=s||0,d=d||0,p=p||0;const F=I.bindFramebuffer(36160,L);Tn(e);let B=null;if(e instanceof uf&&(B=e,y=Number.isFinite(y)?y:B.width,v=Number.isFinite(v)?v:B.height,B.bind(0),e=B.target),!k)I.copyTexImage2D(e,o,l,i,r,y,v,0);else switch(e){case 3553:case 34067:I.copyTexSubImage2D(e,o,s,d,i,r,y,v);break;case 35866:case 32879:vs(I).copyTexSubImage3D(e,o,s,d,p,i,r,y,v);break}return B&&B.unbind(),I.bindFramebuffer(36160,F||null),T&&w.delete(),B}function I9(t){return t instanceof ko?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:soe(t),deleteFramebuffer:!0}}function Yre(t,e,n,i,r){if(t)return t;e=e||5121;const o=gv(e,{clamped:!1}),l=Zre(n);return new o(i*r*l)}const cr={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function Jre(t){const e=new ws(t,{format:6408,type:5126,dataFormat:6408}),n=new ko(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),i=n.getStatus();return e.delete(),n.delete(),i===36053}const M9={[cr.WEBGL2]:[!1,!0],[cr.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[cr.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[cr.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[cr.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[cr.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[cr.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[cr.FLOAT_BLEND]:["EXT_float_blend"],[cr.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[cr.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[cr.TEXTURE_FLOAT]:["OES_texture_float",!0],[cr.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[cr.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[cr.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[cr.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[cr.COLOR_ATTACHMENT_RGBA32F]:[Jre,"EXT_color_buffer_float"],[cr.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[cr.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[cr.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[cr.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[cr.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[cr.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},Qre=2;function R9(t,e){return yv(t,e)}function yv(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>L9(t,n))}function eoe(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in M9)t.luma.caps[e]===void 0&&(t.luma.caps[e]=L9(t,e));return t.luma.caps}function L9(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=toe(t,e)),t.luma.caps[e]||Wn.log(Qre,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function toe(t,e){const n=M9[e];Tn(n,e);let i;const r=bi(t)&&n[1]||n[0];if(typeof r=="function")i=r(t);else if(Array.isArray(r)){i=!0;for(const o of r)i=i&&!!t.getExtension(o)}else typeof r=="string"?i=!!t.getExtension(r):typeof r=="boolean"?i=r:Tn(!1);return i}const e5="Multiple render targets not supported";class ko extends fu{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:i,colorBufferHalfFloat:r}=n;let o=!0;return i&&(o=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),r&&(o=o&&!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),o}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new ko(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=vs(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=vs(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:i=1,attachments:r=null,color:o=!0,depth:l=!0,stencil:s=!1,check:d=!0,readBuffer:p=void 0,drawBuffers:y=void 0}=e;if(Tn(n>=0&&i>=0,"Width and height need to be integers"),this.width=n,this.height=i,r)for(const v in r){const w=r[v];(Array.isArray(w)?w[0]:w).resize({width:n,height:i})}else r=this._createDefaultAttachments(o,l,s,n,i);this.update({clearAttachments:!0,attachments:r,readBuffer:p,drawBuffers:y}),r&&d&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:i,drawBuffers:r,clearAttachments:o=!1,resizeAttachments:l=!0}=e;this.attach(n,{clearAttachments:o,resizeAttachments:l});const{gl:s}=this,d=s.bindFramebuffer(36160,this.handle);return i&&this._setReadBuffer(i),r&&this._setDrawBuffers(r),s.bindFramebuffer(36160,d||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:i}=e;if(this.handle===null)return Tn(n===void 0&&i===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),i===void 0&&(i=this.gl.drawingBufferHeight),n!==this.width&&i!==this.height&&Wn.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(i))();for(const r in this.attachments)this.attachments[r].resize({width:n,height:i});return this.width=n,this.height=i,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:i=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r={};n&&Object.keys(this.attachments).forEach(l=>{r[l]=null}),Object.assign(r,e);const o=this.gl.bindFramebuffer(36160,this.handle);for(const l in r){Tn(l!==void 0,"Misspelled framebuffer binding point?");const s=Number(l),d=r[s];let p=d;if(!p)this._unattach(s);else if(p instanceof Zp)this._attachRenderbuffer({attachment:s,renderbuffer:p});else if(Array.isArray(d)){const[y,v=0,w=0]=d;p=y,this._attachTexture({attachment:s,texture:y,layer:v,level:w})}else this._attachTexture({attachment:s,texture:p,layer:0,level:0});i&&p&&p.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,o||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(l=>!this.attachments[l]).forEach(l=>{delete this.attachments[l]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(ioe(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),i=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),i}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:i,stencil:r,drawBuffers:o=[]}=e,l=this.gl.bindFramebuffer(36160,this.handle);return(n||i||r)&&kM(this.gl,{color:n,depth:i,stencil:r}),o.forEach((s,d)=>{Xre(this.gl,{drawBuffer:d,value:s})}),this.gl.bindFramebuffer(36160,l||null),this}readPixels(){return Wn.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return Wn.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return Wn.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return Wn.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return Wn.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return Wn.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:i=0,y:r=0,width:o,height:l}=e;const s=vs(this.gl),d=s.bindFramebuffer(36008,this.handle);return i===0&&r===0&&o===void 0&&l===void 0?s.invalidateFramebuffer(36008,n):s.invalidateFramebuffer(36008,n,i,r,o,l),s.bindFramebuffer(36008,d),this}getAttachmentParameter(e,n,i){let r=this._getAttachmentParameterFallback(n);return r===null&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),i&&r>1e3&&(r=Th(this.gl,r)),r}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const r={};for(const o of i){const l=n?Th(this.gl,o):o;r[l]=this.getAttachmentParameter(e,o,n)}return r}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),i={};for(const r of n){const o=Number(r),l=e?Th(this.gl,o):o;i[l]=this.getAttachmentParameters(o,e)}return i}show(){return typeof window<"u"&&window.open(Qk(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>Wn.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const i=Qk(this,{targetMaxHeight:100});return Wn.image({logLevel:e,message:n,image:i},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,i,r,o){let l=null;return e&&(l=l||{},l[36064]=new ws(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:r,height:o,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(l[36064])),n&&i?(l=l||{},l[33306]=new Zp(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:r,height:111}),this.ownResources.push(l[33306])):n?(l=l||{},l[36096]=new Zp(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:r,height:o}),this.ownResources.push(l[36096])):i&&Tn(!1),l}_unattach(e){const n=this.attachments[e];n&&(n instanceof Zp?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:i}=e;const{gl:r}=this;r.framebufferRenderbuffer(36160,n,36161,i.handle),this.attachments[n]=i}_attachTexture(e){let{attachment:n=36064,texture:i,layer:r,level:o}=e;const{gl:l}=this;switch(l.bindTexture(i.target,i.handle),i.target){case 35866:case 32879:vs(l).framebufferTextureLayer(36160,n,i.target,o,r);break;case 34067:const d=noe(r);l.framebufferTexture2D(36160,n,d,i.handle,o);break;case 3553:l.framebufferTexture2D(36160,n,3553,i.handle,o);break;default:Tn(!1,"Illegal texture type")}l.bindTexture(i.target,null),this.attachments[n]=i}_setReadBuffer(e){const n=Oie(this.gl);n?n.readBuffer(e):Tn(e===36064||e===1029,e5),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,i=vs(n);if(i)i.drawBuffers(e);else{const r=n.getExtension("WEBGL_draw_buffers");r?r.drawBuffersWEBGL(e):Tn(e.length===1&&(e[0]===36064||e[0]===1029),e5)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=eoe(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function noe(t){return t<34069?t+34069:t}function ioe(t){return(ko.STATUS||{})[t]||"Framebuffer error ".concat(t)}const roe=[36049,36048,33296,33298,33299,33300,33301,33302,33303];ko.ATTACHMENT_PARAMETERS=roe;function ooe(t,e){Tn(t instanceof ws||t instanceof A9||t instanceof $re);const n=t.constructor,{gl:i,width:r,height:o,format:l,type:s,dataFormat:d,border:p,mipmaps:y}=t,v=Object.assign({width:r,height:o,format:l,type:s,dataFormat:d,border:p,mipmaps:y},e);return new n(i,v)}function soe(t,e){const{gl:n,width:i,height:r,id:o}=t;return new ko(n,Object.assign({},e,{id:"framebuffer-for-".concat(o),width:i,height:r,attachments:{36064:t}}))}function Sx(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,i=t.match(n);return i?i[1]:e}const aoe=35632,loe=35633;function coe(t){switch(t){case aoe:return"fragment";case loe:return"vertex";default:return"unknown type"}}function uoe(t,e,n,i){const r=t.split(/\r?\n/),o={},l={},s=i||Sx(e)||"(unnamed)",d="".concat(coe(n)," shader ").concat(s);for(let y=0;y<r.length;y++){const v=r[y];if(v.length<=1)continue;const w=v.split(":"),T=w[0],I=parseInt(w[2],10);if(isNaN(I))throw new Error("GLSL compilation error in ".concat(d,": ").concat(t));T!=="WARNING"?o[I]=v:l[I]=v}const p=hoe(e);return{shaderName:d,errors:t5(o,p),warnings:t5(l,p)}}function t5(t,e){let n="";for(let i=0;i<e.length;i++){const r=e[i];if(!(!t[i+3]&&!t[i+2]&&!t[i+1])&&(n+="".concat(r,`
`),t[i+1])){const o=t[i+1],l=o.split(":",3),s=l[0],d=parseInt(l[1],10)||0,p=o.substring(l.join(":").length+1).trim();n+=O9("^^^ ".concat(s,": ").concat(p,`

`),d)}}return n}function hoe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const i=t.split(/\r?\n/),r=String(i.length+e-1).length;return i.map((o,l)=>{const s=String(l+e),d=s.length;return O9(s,r-d)+n+o})}function O9(t,e){let n="";for(let i=0;i<e;++i)n+=" ";return"".concat(n).concat(t)}function D9(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const i=parseInt(n[1],10);Number.isFinite(i)&&(e=i)}return e}const doe="Shader: GLSL source code must be a JavaScript string";class vv extends fu{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return Tn(!1),"unknown"}}constructor(e,n){k2(e),Tn(typeof n.source=="string",doe);const i=Sx(n.source,null)||n.id||dc("unnamed ".concat(vv.getTypeName(n.shaderType)));super(e,{id:i}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const i=Sx(n,null);i&&(this.id=dc(i)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(vv.getTypeName(this.shaderType),":").concat(this.id)}getName(){return Sx(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const i=this.gl.getShaderInfoLog(this.handle),{shaderName:r,errors:o,warnings:l}=uoe(i,this.source,this.shaderType,this.id);throw Wn.error("GLSL compilation errors in ".concat(r,`
`).concat(o))(),Wn.warn("GLSL compilation warnings in ".concat(r,`
`).concat(l))(),new Error("GLSL compilation errors in ".concat(r))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class NS extends vv{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class US extends vv{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const foe={5126:Or.bind(null,"uniform1fv",fa,1,cs),35664:Or.bind(null,"uniform2fv",fa,2,cs),35665:Or.bind(null,"uniform3fv",fa,3,cs),35666:Or.bind(null,"uniform4fv",fa,4,cs),5124:Or.bind(null,"uniform1iv",eh,1,cs),35667:Or.bind(null,"uniform2iv",eh,2,cs),35668:Or.bind(null,"uniform3iv",eh,3,cs),35669:Or.bind(null,"uniform4iv",eh,4,cs),35670:Or.bind(null,"uniform1iv",eh,1,cs),35671:Or.bind(null,"uniform2iv",eh,2,cs),35672:Or.bind(null,"uniform3iv",eh,3,cs),35673:Or.bind(null,"uniform4iv",eh,4,cs),35674:Or.bind(null,"uniformMatrix2fv",fa,4,kc),35675:Or.bind(null,"uniformMatrix3fv",fa,9,kc),35676:Or.bind(null,"uniformMatrix4fv",fa,16,kc),35678:Jo,35680:Jo,5125:Or.bind(null,"uniform1uiv",Sb,1,cs),36294:Or.bind(null,"uniform2uiv",Sb,2,cs),36295:Or.bind(null,"uniform3uiv",Sb,3,cs),36296:Or.bind(null,"uniform4uiv",Sb,4,cs),35685:Or.bind(null,"uniformMatrix2x3fv",fa,6,kc),35686:Or.bind(null,"uniformMatrix2x4fv",fa,8,kc),35687:Or.bind(null,"uniformMatrix3x2fv",fa,6,kc),35688:Or.bind(null,"uniformMatrix3x4fv",fa,12,kc),35689:Or.bind(null,"uniformMatrix4x2fv",fa,8,kc),35690:Or.bind(null,"uniformMatrix4x3fv",fa,12,kc),35678:Jo,35680:Jo,35679:Jo,35682:Jo,36289:Jo,36292:Jo,36293:Jo,36298:Jo,36299:Jo,36300:Jo,36303:Jo,36306:Jo,36307:Jo,36308:Jo,36311:Jo},poe={},moe={},goe={},n5=[0];function FM(t,e,n,i){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(n5[0]=t,t=n5);const r=t.length;if(r%e&&Wn.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let o=i[r];o||(o=new n(r),i[r]=o);for(let l=0;l<r;l++)o[l]=t[l];return o}function fa(t,e){return FM(t,e,Float32Array,poe)}function eh(t,e){return FM(t,e,Int32Array,moe)}function Sb(t,e){return FM(t,e,Uint32Array,goe)}function i5(t,e,n){const i=foe[n.type];if(!i)throw new Error("Unknown GLSL uniform type ".concat(n.type));return i().bind(null,t,e)}function yoe(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:!!n[2]}}function voe(t,e,n){for(const i in t){const r=t[i];if((!n||!!n[i])&&!_oe(r))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(i),r),new Error("".concat(e," Bad uniform ").concat(i))}return!0}function _oe(t){return Array.isArray(t)||ArrayBuffer.isView(t)?xoe(t):isFinite(t)||t===!0||t===!1||t instanceof uf||t instanceof Zp?!0:t instanceof ko?!!t.texture:!1}function boe(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const i=t[e];for(let r=0,o=n.length;r<o;++r)i[r]=n[r]}else t[e]=n.slice();else t[e]=n}function xoe(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Jo(){let t=null;return(e,n,i)=>{const r=t!==i;return r&&(e.uniform1i(n,i),t=i),r}}function Or(t,e,n,i){let r=null,o=null;return(l,s,d)=>{const p=e(d,n),y=p.length;let v=!1;if(r===null)r=new Float32Array(y),o=y,v=!0;else{Tn(o===y,"Uniform length cannot change.");for(let w=0;w<y;++w)if(p[w]!==r[w]){v=!0;break}}return v&&(i(l,t,s,p),r.set(p)),v}}function cs(t,e,n,i){t[e](n,i)}function kc(t,e,n,i){t[e](n,!1,i)}const woe=5120,Eoe=5121,Toe=5122,Soe=5123,r5=0,Cb=1,Coe=2,Aoe=3,Ab=4,Poe=5,Ioe=6,Do=5126,Moe=35664,Roe=35665,Loe=35666,Ly=5124,Ooe=35667,Doe=35668,koe=35669,Oy=5125,Foe=36294,Boe=36295,zoe=36296,Noe=35670,Uoe=35671,Voe=35672,joe=35673,$oe=35674,Goe=35675,Hoe=35676,Woe=35685,Koe=35686,Xoe=35687,Zoe=35688,qoe=35689,Yoe=35690,ZA={[Do]:[Do,1,"float"],[Moe]:[Do,2,"vec2"],[Roe]:[Do,3,"vec3"],[Loe]:[Do,4,"vec4"],[Ly]:[Ly,1,"int"],[Ooe]:[Ly,2,"ivec2"],[Doe]:[Ly,3,"ivec3"],[koe]:[Ly,4,"ivec4"],[Oy]:[Oy,1,"uint"],[Foe]:[Oy,2,"uvec2"],[Boe]:[Oy,3,"uvec3"],[zoe]:[Oy,4,"uvec4"],[Noe]:[Do,1,"bool"],[Uoe]:[Do,2,"bvec2"],[Voe]:[Do,3,"bvec3"],[joe]:[Do,4,"bvec4"],[$oe]:[Do,8,"mat2"],[Woe]:[Do,8,"mat2x3"],[Koe]:[Do,8,"mat2x4"],[Goe]:[Do,12,"mat3"],[Xoe]:[Do,12,"mat3x2"],[Zoe]:[Do,12,"mat3x4"],[Hoe]:[Do,16,"mat4"],[qoe]:[Do,16,"mat4x2"],[Yoe]:[Do,16,"mat4x3"]};function Joe(t){switch(t){case r5:return r5;case Cb:return Cb;case Aoe:return Cb;case Coe:return Cb;case Ab:return Ab;case Poe:return Ab;case Ioe:return Ab;default:return Tn(!1),0}}function o5(t){const e=ZA[t];if(!e)return null;const[n,i]=e;return{type:n,components:i}}function k9(t,e){switch(t){case woe:case Eoe:case Toe:case Soe:t=Do;break}for(const n in ZA){const[i,r,o]=ZA[n];if(i===t&&r===e)return{glType:n,name:o}}return null}class Qoe{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,i=n.getProgramParameter(e.handle,35721);for(let r=0;r<i;r++){const{name:o,type:l,size:s}=n.getActiveAttrib(e.handle,r),d=n.getAttribLocation(e.handle,o);d>=0&&this._addAttribute(d,o,l,s)}this.attributeInfos.sort((r,o)=>r.location-o.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!bi(n))return;const i=n.getProgramParameter(e.handle,35971);for(let r=0;r<i;r++){const{name:o,type:l,size:s}=n.getTransformFeedbackVarying(e.handle,r);this._addVarying(r,o,l,s)}this.varyingInfos.sort((r,o)=>r.location-o.location)}_addAttribute(e,n,i,r){const{type:o,components:l}=o5(i),s={type:o,size:r*l};this._inferProperties(e,n,s);const d={location:e,name:n,accessor:new ba(s)};this.attributeInfos.push(d),this.attributeInfosByLocation[e]=d,this.attributeInfosByName[d.name]=d}_inferProperties(e,n,i){/instance/i.test(n)&&(i.divisor=1)}_addVarying(e,n,i,r){const{type:o,components:l}=o5(i),s=new ba({type:o,size:r*l}),d={location:e,name:n,accessor:s};this.varyingInfos.push(d),this.varyingInfosByName[d.name]=d}}const s5=4,ese=35981,tse=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class F9 extends fu{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",tse),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:i,fs:r,varyings:o,bufferMode:l=ese}=e;return this.hash=n||"",this.vs=typeof i=="string"?new NS(this.gl,{id:"".concat(e.id,"-vs"),source:i}):i,this.fs=typeof r=="string"?new US(this.gl,{id:"".concat(e.id,"-fs"),source:r}):r,Tn(this.vs instanceof NS),Tn(this.fs instanceof US),this.uniforms={},this._textureUniforms={},o&&o.length>0&&(vs(this.gl),this.varyings=o,this.gl2.transformFeedbackVaryings(this.handle,o,l)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new Qoe(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:i=4,vertexCount:r,offset:o=0,start:l,end:s,isIndexed:d=!1,indexType:p=5123,instanceCount:y=0,isInstanced:v=y>0,vertexArray:w=null,transformFeedback:T,framebuffer:I,parameters:L={},uniforms:k,samplers:F}=e;if((k||F)&&(Wn.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(k||{})),Wn.priority>=n){const B=I?I.id:"default",G="mode=".concat(Th(this.gl,i)," verts=").concat(r," ")+"instances=".concat(y," indexType=").concat(Th(this.gl,p)," ")+"isInstanced=".concat(v," isIndexed=").concat(d," ")+"Framebuffer=".concat(B);Wn.log(n,G)()}return Tn(w),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||r===0||v&&y===0?!1:(w.bindForDraw(r,y,()=>{if(I!==void 0&&(L=Object.assign({},L,{framebuffer:I})),T){const B=Joe(i);T.begin(B)}this._bindTextures(),Ga(this.gl,L,()=>{d&&v?this.gl2.drawElementsInstanced(i,r,p,o,y):d&&bi(this.gl)&&!isNaN(l)&&!isNaN(s)?this.gl2.drawRangeElements(i,l,s,r,p,o):d?this.gl.drawElements(i,r,p,o):v?this.gl2.drawArraysInstanced(i,o,r,y):this.gl.drawArrays(i,o,r)}),T&&T.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Wn.priority>=2&&voe(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const i=e[n],r=this._uniformSetters[n];if(r){let o=i,l=!1;if(o instanceof ko&&(o=o.texture),o instanceof uf)if(l=this.uniforms[n]!==i,l){r.textureIndex===void 0&&(r.textureIndex=this._textureIndexCounter++);const s=o,{textureIndex:d}=r;s.bind(d),o=d,this._textureUniforms[n]=s}else o=r.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(r(o)||l)&&boe(this.uniforms,n,i)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const i=this._textureUniforms[n];i.update(),e=e&&i.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),i={};for(const r of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:i.vs=new NS({handle:r});break;case 35632:i.fs=new US({handle:r});break}return i}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=dc(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),Wn.time(s5,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),Wn.timeEnd(s5,"linkProgram for ".concat(this._getName()))(),e.debug||Wn.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const i=this.gl.getActiveUniform(this.handle,n),{name:r}=yoe(i.name);let o=e.getUniformLocation(this.handle,r);if(this._uniformSetters[r]=i5(e,o,i),i.size>1)for(let l=0;l<i.size;l++)o=e.getUniformLocation(this.handle,"".concat(r,"[").concat(l,"]")),this._uniformSetters["".concat(r,"[").concat(l,"]")]=i5(e,o,i)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}const nse=34918,ise=34919,rse=35007,ose=36795,sse=35976,ase=35887,lse=36202;class gw extends fu{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=bi(e),r=yv(e,cr.TIMER_QUERY);let o=i||r;for(const l of n)switch(l){case"queries":o=o&&i;break;case"timers":o=o&&r;break;default:Tn(!1)}return o}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(rse)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?lse:ase)}beginTransformFeedbackQuery(){return this.begin(sse)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,ise);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(ose)}getResult(){return this.gl2.getQueryParameter(this.handle,nse)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((i,r)=>{const o=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):n++>e?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(o)};requestAnimationFrame(o)}),this._pollingPromise}_createHandle(){return gw.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class B9 extends fu{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return bi(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};vs(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,km(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const i=this._getVaryingIndex(e),{buffer:r,byteSize:o,byteOffset:l}=this._getBufferParams(n);return i<0?(this.unused[e]=r,Wn.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[i]=n,this.bindOnUse||this._bindBuffer(i,r,l,o),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,i,r;return e instanceof $i?r=e:(r=e.buffer,i=e.byteSize,n=e.byteOffset),(n!==void 0||i!==void 0)&&(n=n||0,i=i||r.byteLength-n),{buffer:r,byteOffset:n,byteSize:i}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:i,byteOffset:r}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,r,i)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0;const o=n&&n.handle;return!o||r===void 0?this.gl.bindBufferBase(35982,e,o):this.gl.bindBufferRange(35982,e,o,i,r),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let Pb=null;function cse(t){return(!Pb||Pb.byteLength<t)&&(Pb=new ArrayBuffer(t)),Pb}function use(t,e){const n=cse(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function hse(t){let{target:e,source:n,start:i=0,count:r=1}=t;const o=n.length,l=r*o;let s=0;for(let d=i;s<o;s++)e[d++]=n[s];for(;s<l;)s<l-s?(e.copyWithin(i+s,i,i+s),s*=2):(e.copyWithin(i+s,i,i+l-s),s=l);return e}const dse="elements must be GL.ELEMENT_ARRAY_BUFFER";class ya extends fu{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?bi(e)||p9()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new ya(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return ya.MAX_ATTRIBUTES=ya.MAX_ATTRIBUTES||e.getParameter(34921),ya.MAX_ATTRIBUTES}static setConstant(e,n,i){switch(i.constructor){case Float32Array:ya._setConstantFloatArray(e,n,i);break;case Int32Array:ya._setConstantIntArray(e,n,i);break;case Uint32Array:ya._setConstantUintArray(e,n,i);break;default:Tn(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:i})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return ya.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Tn(!e||e.target===34963,dse),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,i){if(n.target===34963)return this.setElementBuffer(n,i);const{size:r,type:o,stride:l,offset:s,normalized:d,integer:p,divisor:y}=i,{gl:v,gl2:w}=this;return e=Number(e),this.bind(()=>{v.bindBuffer(34962,n.handle),p?(Tn(bi(v)),w.vertexAttribIPointer(e,r,o,l,s)):v.vertexAttribPointer(e,r,o,d,l,s),v.enableVertexAttribArray(e),w.vertexAttribDivisor(e,y||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!ya.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const i=this._normalizeConstantArrayValue(n),r=i.byteLength*e,o=i.length*e;let l=!this.buffer;if(this.buffer=this.buffer||new $i(this.gl,r),l=l||this.buffer.reallocate(r),l=l||!this._compareConstantArrayValues(i,this.bufferValue),l){const s=use(n.constructor,o);hse({target:s,source:i,start:0,count:o}),this.buffer.subData(s),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let i=0;i<e.length;++i)if(e[i]!==n[i])return!1;return!0}static _setConstantFloatArray(e,n,i){switch(i.length){case 1:e.vertexAttrib1fv(n,i);break;case 2:e.vertexAttrib2fv(n,i);break;case 3:e.vertexAttrib3fv(n,i);break;case 4:e.vertexAttrib4fv(n,i);break;default:Tn(!1)}}static _setConstantIntArray(e,n,i){switch(Tn(bi(e)),i.length){case 1:e.vertexAttribI1iv(n,i);break;case 2:e.vertexAttribI2iv(n,i);break;case 3:e.vertexAttribI3iv(n,i);break;case 4:e.vertexAttribI4iv(n,i);break;default:Tn(!1)}}static _setConstantUintArray(e,n,i){switch(Tn(bi(e)),i.length){case 1:e.vertexAttribI1uiv(n,i);break;case 2:e.vertexAttribI2uiv(n,i);break;case 3:e.vertexAttribI3uiv(n,i);break;case 4:e.vertexAttribI4uiv(n,i);break;default:Tn(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:i}=n;return Tn(Number.isFinite(i)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(i,e);default:return this.gl.getVertexAttrib(i,e)}})}}const fse="VertexArray: attributes must be Buffers or constants (i.e. typed array)",pse=/^(.+)__LOCATION_([0-9]+)$/,mse=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class gse{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=n.id||n.program&&n.program.id;this.id=i,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new ya(e),E9(this,"VertexArray","v6.0",mse),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const i=e[n];this._setAttribute(n,i)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,i);const{location:r,accessor:o}=this._resolveLocationAndAccessor(e,n,n.accessor,i);return r>=0&&(this.values[r]=n,this.accessors[r]=o,this.clearDrawParams(),this.vertexArrayObject.setBuffer(r,n,o)),this}setConstant(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:r,accessor:o}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},i));return r>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[r]=n,this.accessors[r]=o,this.clearDrawParams(),this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new $i(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof $i&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof $i&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,i){let r;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),r=i()}),r}_resolveLocationAndAccessor(e,n,i,r){const o={location:-1,accessor:null},{location:l,name:s}=this._getAttributeIndex(e);if(!Number.isFinite(l)||l<0)return this.unused[e]=n,Wn.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),o;const d=this._getAttributeInfo(s||l);if(!d)return o;const p=this.accessors[l]||{},y=ba.resolve(d.accessor,p,i,r),{size:v,type:w}=y;return Tn(Number.isFinite(v)&&Number.isFinite(w)),{location:l,accessor:y}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const i=pse.exec(e),r=i?i[1]:e,o=i?Number(i[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+o,name:r}:{location:-1}}_setAttribute(e,n){if(n instanceof $i)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof $i){const i=n[0],r=n[1];this.setBuffer(e,i,r)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const i=n;this.setConstant(e,i)}else if(n.buffer instanceof $i){const i=n;this.setBuffer(e,i.buffer,i)}else throw new Error(fse)}_setConstantAttributes(e,n){const i=Math.max(e|0,n|0);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,i);for(let o=1;o<this.vertexArrayObject.MAX_ATTRIBUTES;o++)r=this.values[o],ArrayBuffer.isView(r)&&this._setConstantAttribute(o,r)}_setConstantAttributeZero(e,n){if(ya.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const i=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,i,this.accessors[0])}_setConstantAttribute(e,n){ya.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const i=this.values[n],r=this.accessors[n];if(!i)return;const{divisor:o}=r,l=o>0;if(e.isInstanced=e.isInstanced||l,i instanceof $i){const s=i;if(l){const d=s.getVertexCount(r);e.instanceCount=Math.min(e.instanceCount,d)}else{const d=s.getVertexCount(r);e.vertexCount=Math.min(e.vertexCount,d)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Wn.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function yse(t,e){const{maxElts:n=16,size:i=1}=e;let r="[";for(let l=0;l<t.length&&l<n;++l)l>0&&(r+=",".concat(l%i===0?" ":"")),r+=_v(t[l],e);const o=t.length>n?"...":"]";return"".concat(r).concat(o)}function _v(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:i=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return yse(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return i?"0":"0.";if(i||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const r=t.toPrecision(2);return r.indexOf(".0")===r.length-2?r.slice(0,-1):r}function a5(t){let{header:e="Uniforms",program:n,uniforms:i,undefinedOnly:r=!1}=t;Tn(n);const o=".*_.*",l=".*Matrix",s=n._uniformSetters,d={},p=Object.keys(s).sort();let y=0;for(const T of p)!T.match(o)&&!T.match(l)&&VS({table:d,header:e,uniforms:i,uniformName:T,undefinedOnly:r})&&y++;for(const T of p)T.match(l)&&VS({table:d,header:e,uniforms:i,uniformName:T,undefinedOnly:r})&&y++;for(const T of p)d[T]||VS({table:d,header:e,uniforms:i,uniformName:T,undefinedOnly:r})&&y++;let v=0;const w={};if(!r)for(const T in i){const I=i[T];d[T]||(v++,w[T]={Type:"NOT USED: ".concat(I),[e]:_v(I)})}return{table:d,count:y,unusedTable:w,unusedCount:v}}function VS(t){let{table:e,header:n,uniforms:i,uniformName:r,undefinedOnly:o}=t;const l=i[r],s=vse(l);return!o||!s?(e[r]={[n]:s?_v(l):"N/A","Uniform Type":s?l:"NOT PROVIDED"},!0):!1}function vse(t){return t!=null}function _se(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const i={};e.elements&&(i.ELEMENT_ARRAY_BUFFER=l5(e,e.elements,null,n));const r=e.values;for(const o in r){const l=e._getAttributeInfo(o);if(l){let s="".concat(o,": ").concat(l.name);const d=e.accessors[l.location];d&&(s="".concat(o,": ").concat(bse(l.name,d))),i[s]=l5(e,r[o],d,n)}}return i}function l5(t,e,n,i){const{gl:r}=t;if(!e)return{[i]:"null","Format ":"N/A"};let o="NOT PROVIDED",l=1,s=0,d=0,p,y,v;if(n&&(o=n.type,l=n.size,o=String(o).replace("Array",""),p=o.indexOf("nt")!==-1),e instanceof $i){const w=e,{data:T,changed:I}=w.getDebugData();y=I?"*":"",v=T,d=w.byteLength,s=d/T.BYTES_PER_ELEMENT/l;let L;if(n){const k=n.divisor>0;L="".concat(k?"I ":"P "," ").concat(s," (x").concat(l,"=").concat(d," bytes ").concat(Th(r,o),")")}else p=!0,L="".concat(d," bytes");return{[i]:"".concat(y).concat(_v(v,{size:l,isInteger:p})),"Format ":L}}return v=e,l=e.length,o=String(e.constructor.name).replace("Array",""),p=o.indexOf("nt")!==-1,{[i]:"".concat(_v(v,{size:l,isInteger:p})," (constant)"),"Format ":"".concat(l,"x").concat(o," (constant)")}}function bse(t,e){const{type:n,size:i}=e,r=k9(n,i);return r?"".concat(t," (").concat(r.name,")"):t}function xse(t){const e={},n="Accessors for ".concat(t.id);for(const i of t.attributeInfos)if(i){const r=c5(i);e["in ".concat(r)]={[n]:JSON.stringify(i.accessor)}}for(const i of t.varyingInfos)if(i){const r=c5(i);e["out ".concat(r)]={[n]:JSON.stringify(i.accessor)}}return e}function c5(t){const{type:e,size:n}=t.accessor,i=k9(e,n);return i?"".concat(i.name," ").concat(t.name):t.name}const u5=du()&&typeof document<"u";let wse=0;class Ese{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=k=>w9(k),onAddHTML:i=null,onInitialize:r=()=>{},onRender:o=()=>{},onFinalize:l=()=>{},onError:s,gl:d=null,glOptions:p={},debug:y=!1,createFramebuffer:v=!1,autoResizeViewport:w=!0,autoResizeDrawingBuffer:T=!0,stats:I=Gd.get("animation-loop-".concat(wse++))}=e;let{useDevicePixels:L=!0}=e;"useDevicePixelRatio"in e&&(Wn.deprecated("useDevicePixelRatio","useDevicePixels")(),L=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:i,onInitialize:r,onRender:o,onFinalize:l,onError:s,gl:d,glOptions:p,debug:y,createFramebuffer:v},this.gl=d,this.needsRedraw=null,this.timeline=null,this.stats=I,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:w,autoResizeDrawingBuffer:T,useDevicePixels:L}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return Tn(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=gw.isSupported(this.gl,["timers"])?new gw(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(i=>{this._running&&(this._addCallbackData(i||{}),i!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const i=document.getElementById(e);return i?Number(i.value):n}setViewParameters(){return Wn.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=u5?new Promise((e,n)=>{if(u5&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):Mre(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):Ire(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:i}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),i!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=i,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?LM(this.props.gl,e):this.onCreateContext(e),!D2(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");gre(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const i=this.props.onAddHTML(n);i&&(n.innerHTML=i)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let i=1;const{canvas:r}=this.gl;return r&&r.clientHeight?i=r.clientWidth/r.clientHeight:e>0&&n>0&&(i=e/n),{width:e,height:n,aspect:i}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&xre(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new ko(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const x_="vs",BM="fs";function Sa(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const jS={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function Tse(t){const e={};for(const n in t){const i=t[n],r=Sse(i);e[n]=r}return e}function Sse(t){let e=h5(t);return e==="object"?t?"type"in t?Object.assign({},t,jS[t.type]):"value"in t?(e=h5(t.value),Object.assign({type:e},t,jS[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},jS[e])}function h5(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const Cse="vs",Ase="fs";class d5{constructor(e){let{name:n,vs:i,fs:r,dependencies:o=[],uniforms:l,getUniforms:s,deprecations:d=[],defines:p={},inject:y={},vertexShader:v,fragmentShader:w}=e;Sa(typeof n=="string"),this.name=n,this.vs=i||v,this.fs=r||w,this.getModuleUniforms=s,this.dependencies=o,this.deprecations=this._parseDeprecationDefinitions(d),this.defines=p,this.injections=Pse(y),l&&(this.uniforms=Tse(l))}getModuleSource(e){let n;switch(e){case Cse:n=this.vs||"";break;case Ase:n=this.fs||"";break;default:Sa(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(i=>{i.regex.test(e)&&(i.deprecated?n.deprecated(i.old,i.new)():n.removed(i.old,i.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},i=this.uniforms;for(const r in i){const o=i[r];r in e&&!o.private?(o.validate&&Sa(o.validate(e[r],o),"".concat(this.name,": invalid ").concat(r)),n[r]=e[r]):n[r]=o.value}return n}}function Pse(t){const e={vs:{},fs:{}};for(const n in t){let i=t[n];const r=n.slice(0,2);typeof i=="string"&&(i={order:0,injection:i}),e[r][n]=i}return e}function Ise(t){return Mse(N9(t))}function Mse(t){const e={},n={};return z9({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((i,r)=>n[r]-n[i]).map(i=>e[i])}function z9(t){let{modules:e,level:n,moduleMap:i,moduleDepth:r}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const o of e)i[o.name]=o,(r[o.name]===void 0||r[o.name]<n)&&(r[o.name]=n);for(const o of e)o.dependencies&&z9({modules:o.dependencies,level:n+1,moduleMap:i,moduleDepth:r})}function N9(t,e){return t.map(n=>(n instanceof d5||(Sa(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),Sa(n.name,"shader module has no name"),n=new d5(n),n.dependencies=N9(n.dependencies)),n))}function Rse(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",i=n.indexOf("MSIE ")!==-1,r=n.indexOf("Trident/")!==-1;return i||r}const Lse=7936,Ose=7937,Dse=7938,kse=35724,zM={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Fd={};Object.keys(zM).forEach(t=>{Fd[t]=t});function Fse(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function Bse(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||Lse),i=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||Ose);return{gpuVendor:zse(n,i),vendor:n,renderer:i,version:t.getParameter(Dse),shadingLanguageVersion:t.getParameter(kse)}}function zse(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const $S={};function f5(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=zM[e];if(Sa(i,e),!Rse(n))return!0;if(e in $S)return $S[e];const r=i[0],o=n.behavior||"enable",l="#extension GL_".concat(r," : ").concat(o,`
void main(void) {}`),s=t.createShader(35633);t.shaderSource(s,l),t.compileShader(s);const d=t.getShaderParameter(s,35713);return t.deleteShader(s),$S[e]=d,d}function Nse(t,e){const n=zM[e];Sa(n,e);const i=Fse(t)&&n[1]||n[0],r=typeof i=="string"?!!t.getExtension(i):i;return Sa(r===!1||r===!0),r}function Ib(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>Nse(t,n))}function Use(t){switch(Bse(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function Vse(t,e,n){let i=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return Ib(t,Fd.GLSL_FRAG_DEPTH)&&(i+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),Ib(t,Fd.GLSL_DERIVATIVES)&&f5(t,Fd.GLSL_DERIVATIVES)&&(i+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),Ib(t,Fd.GLSL_FRAG_DATA)&&f5(t,Fd.GLSL_FRAG_DATA,{behavior:"require"})&&(i+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),Ib(t,Fd.GLSL_TEXTURE_LOD)&&(i+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),i}const jse=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,$se=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,Gse={[x_]:jse,[BM]:$se},Cx="__LUMA_INJECT_DECLARATIONS__",p5=/void\s+main\s*\([^)]*\)\s*\{\n?/,m5=/}\n?[^{}]*$/,GS=[];function g5(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const r=e===x_;for(const o in n){const l=n[o];l.sort((d,p)=>d.order-p.order),GS.length=l.length;for(let d=0,p=l.length;d<p;++d)GS[d]=l[d].injection;const s="".concat(GS.join(`
`),`
`);switch(o){case"vs:#decl":r&&(t=t.replace(Cx,s));break;case"vs:#main-start":r&&(t=t.replace(p5,d=>d+s));break;case"vs:#main-end":r&&(t=t.replace(m5,d=>s+d));break;case"fs:#decl":r||(t=t.replace(Cx,s));break;case"fs:#main-start":r||(t=t.replace(p5,d=>d+s));break;case"fs:#main-end":r||(t=t.replace(m5,d=>s+d));break;default:t=t.replace(o,d=>d+s)}}return t=t.replace(Cx,""),i&&(t=t.replace(/\}\s*$/,o=>o+Gse[e])),t}function qA(t){const e={};return Sa(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const i in n)e[i]=e[i]?"".concat(e[i],`
`).concat(n[i]):n[i]}),e}function Fm(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const U9=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],Hse=[...U9,[Fm("attribute"),"in $1"],[Fm("varying"),"out $1"]],Wse=[...U9,[Fm("varying"),"in $1"]],V9=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],Kse=[...V9,[Fm("in"),"attribute $1"],[Fm("out"),"varying $1"]],Xse=[...V9,[Fm("in"),"varying $1"]],YA="gl_FragColor",JA=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,Zse=/void\s+main\s*\([^)]*\)\s*\{\n?/;function qse(t,e,n){switch(e){case 300:return n?yw(t,Hse):Yse(t);case 100:return n?yw(t,Kse):Jse(t);default:throw new Error("unknown GLSL version ".concat(e))}}function yw(t,e){for(const[n,i]of e)t=t.replace(n,i);return t}function Yse(t){t=yw(t,Wse);const e=t.match(JA);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(YA,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(Zse,i=>"out vec4 ".concat(n,`;
`).concat(i)).replace(new RegExp("\\b".concat(YA,"\\b"),"g"),n)}return t}function Jse(t){t=yw(t,Xse);const e=t.match(JA);if(e){const n=e[1];t=t.replace(JA,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),YA)}return t}const Qse=`

`.concat(Cx,`

`),j9={[x_]:"vertex",[BM]:"fragment"},eae=`precision highp float;

`;function tae(t,e){const{vs:n,fs:i}=e,r=Ise(e.modules||[]);return{gl:t,vs:y5(t,Object.assign({},e,{source:n,type:x_,modules:r})),fs:y5(t,Object.assign({},e,{source:i,type:BM,modules:r})),getUniforms:nae(r)}}function y5(t,e){let{id:n,source:i,type:r,modules:o,defines:l={},hookFunctions:s=[],inject:d={},transpileToGLSL100:p=!1,prologue:y=!0,log:v}=e;Sa(typeof i=="string","shader source must be a string");const w=r===x_,T=i.split(`
`);let I=100,L="",k=i;T[0].indexOf("#version ")===0?(I=300,L=T[0],k=T.slice(1).join(`
`)):L="#version ".concat(I);const F={};o.forEach(ye=>{Object.assign(F,ye.getDefines())}),Object.assign(F,l);let B=y?"".concat(L,`
`).concat(rae({id:n,source:i,type:r}),`
`).concat(iae({type:r}),`
`).concat(Use(t),`
`).concat(Vse(t),`
`).concat(oae(F),`
`).concat(w?"":eae,`
`):"".concat(L,`
`);const G=aae(s),U={},ee={},ne={};for(const ye in d){const fe=typeof d[ye]=="string"?{injection:d[ye],order:0}:d[ye],J=ye.match(/^(v|f)s:(#)?([\w-]+)$/);if(J){const Ce=J[2],me=J[3];Ce?me==="decl"?ee[ye]=[fe]:ne[ye]=[fe]:U[ye]=[fe]}else ne[ye]=[fe]}for(const ye of o){v&&ye.checkDeprecations(k,v);const fe=ye.getModuleSource(r,I);B+=fe;const J=ye.injections[r];for(const Ce in J){const me=Ce.match(/^(v|f)s:#([\w-]+)$/);if(me){const Te=me[2]==="decl"?ee:ne;Te[Ce]=Te[Ce]||[],Te[Ce].push(J[Ce])}else U[Ce]=U[Ce]||[],U[Ce].push(J[Ce])}}return B+=Qse,B=g5(B,r,ee),B+=sae(G[r],U),B+=k,B=g5(B,r,ne),B=qse(B,p?100:I,w),B}function nae(t){return function(n){const i={};for(const r of t){const o=r.getUniforms(n,i);Object.assign(i,o)}return i}}function iae(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(j9[e].toUpperCase(),`
`)}function rae(t){let{id:e,source:n,type:i}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(j9[i],`

`):""}function oae(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const i in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const r=t[i];(r||Number.isFinite(r))&&(n+="#define ".concat(i.toUpperCase()," ").concat(t[i],`
`))}return e===0&&(n+=`
`),n}function sae(t,e){let n="";for(const i in t){const r=t[i];if(n+="void ".concat(r.signature,` {
`),r.header&&(n+="  ".concat(r.header)),e[i]){const o=e[i];o.sort((l,s)=>l.order-s.order);for(const l of o)n+="  ".concat(l.injection,`
`)}r.footer&&(n+="  ".concat(r.footer)),n+=`}
`}return n}function aae(t){const e={vs:{},fs:{}};return t.forEach(n=>{let i;typeof n!="string"?(i=n,n=i.hook):i={},n=n.trim();const[r,o]=n.split(":"),l=n.replace(/\(.+/,"");e[r][l]=Object.assign(i,{signature:o})}),e}const lae="void main() {gl_FragColor = vec4(0);}",$9=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,cae=`#version 300 es
`.concat($9);function G9(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[i,r,o]=n;if(!e.includes(i)||!r||!o)return null;const l=o.split(";")[0];return{qualifier:i,type:r,name:l}}function H9(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:i,output:r}=t;if(!n)return e===300?cae:e>300?"#version ".concat(e,`
`).concat($9):lae;const o=dae(n,i);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(i," ").concat(n,`;
out vec4 `).concat(r,`;
void main() {
  `).concat(r," = ").concat(o,`;
}`):"varying ".concat(i," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(o,`;
}`)}function uae(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Sa(!1),null}}function hae(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Sa(!1),null}}function dae(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return Sa(!1),null}}const fae=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,pae={name:"fp32",vs:fae,fs:null};function bv(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const Ms={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function mae(t,{precision:e=Ms.precision}={}){return t=gae(t),"".concat(parseFloat(t.toPrecision(e)))}function hf(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function yh(t,e,n){return vae(t,i=>Math.max(e,Math.min(n,i)))}function Yd(t,e,n){return hf(t)?t.map((i,r)=>Yd(i,e[r],n)):n*e+(1-n)*t}function qc(t,e,n){const i=Ms.EPSILON;n&&(Ms.EPSILON=n);try{if(t===e)return!0;if(hf(t)&&hf(e)){if(t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(!qc(t[r],e[r]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=Ms.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{Ms.EPSILON=i}}function gae(t){return Math.round(t/Ms.EPSILON)*Ms.EPSILON}function yae(t){return t.clone?t.clone():new Array(t.length)}function vae(t,e,n){if(hf(t)){const i=t;n=n||yae(i);for(let r=0;r<n.length&&r<i.length;++r)n[r]=e(t[r],r,n);return n}return e(t)}function _ae(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class NM extends _ae(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let i=0;i<this.ELEMENTS;++i)this[i]=e[i+n];return this.check()}toArray(e=[],n=0){for(let i=0;i<this.ELEMENTS;++i)e[n+i]=this[i];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:hf(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Ms)}formatString(e){let n="";for(let i=0;i<this.ELEMENTS;++i)n+=(i>0?", ":"")+mae(this[i],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!qc(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,i){if(i===void 0)return this.lerp(this,e,n);for(let r=0;r<this.ELEMENTS;++r){const o=e[r];this[r]=o+i*(n[r]-o)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e[i]),n[i]);return this.check()}add(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]+=n[i];return this.check()}subtract(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]-=n[i];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(Ms.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e),n);return this.check()}get elements(){return this}}function bae(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Sr(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function F0(t,e,n=""){if(Ms.debug&&!bae(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class W9 extends NM{get x(){return this[0]}set x(e){this[0]=Sr(e)}get y(){return this[1]}set y(e){this[1]=Sr(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let i=0;i<this.ELEMENTS;++i){const r=this[i]-e[i];n+=r*r}return Sr(n)}dot(e){let n=0;for(let i=0;i<this.ELEMENTS;++i)n+=this[i]*e[i];return Sr(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]*=n[i];return this.check()}divide(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]/=n[i];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return bv(e>=0&&e<this.ELEMENTS,"index is out of range"),Sr(this[e])}setComponent(e,n){return bv(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var B0=1e-6,Pl=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function xae(){var t=new Pl(2);return Pl!=Float32Array&&(t[0]=0,t[1]=0),t}function v5(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function wae(t,e){return t[0]=-e[0],t[1]=-e[1],t}function K9(t,e,n,i){var r=e[0],o=e[1];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t}function Eae(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[3]*r+n[6],t[1]=n[1]*i+n[4]*r+n[7],t}function Tae(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t}(function(){var t=xae();return function(e,n,i,r,o,l){var s,d;for(n||(n=2),i||(i=0),r?d=Math.min(r*n+i,e.length):d=e.length,s=i;s<d;s+=n)t[0]=e[s],t[1]=e[s+1],o(t,t,l),e[s]=t[0],e[s+1]=t[1];return e}})();function Sae(t,e,n){const i=e[0],r=e[1],o=n[3]*i+n[7]*r||1;return t[0]=(n[0]*i+n[4]*r)/o,t[1]=(n[1]*i+n[5]*r)/o,t}function X9(t,e,n){const i=e[0],r=e[1],o=e[2],l=n[3]*i+n[7]*r+n[11]*o||1;return t[0]=(n[0]*i+n[4]*r+n[8]*o)/l,t[1]=(n[1]*i+n[5]*r+n[9]*o)/l,t[2]=(n[2]*i+n[6]*r+n[10]*o)/l,t}function Cae(t,e,n){const i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t[2]=e[2],t}function Aae(t,e,n){const i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t[2]=e[2],t[3]=e[3],t}function Z9(t,e,n){const i=e[0],r=e[1],o=e[2];return t[0]=n[0]*i+n[3]*r+n[6]*o,t[1]=n[1]*i+n[4]*r+n[7]*o,t[2]=n[2]*i+n[5]*r+n[8]*o,t[3]=e[3],t}function q9(){var t=new Pl(3);return Pl!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Pae(t){var e=t[0],n=t[1],i=t[2];return Math.hypot(e,n,i)}function _5(t,e,n){var i=new Pl(3);return i[0]=t,i[1]=e,i[2]=n,i}function Iae(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Mae(t){var e=t[0],n=t[1],i=t[2];return e*e+n*n+i*i}function Rae(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Lae(t,e){var n=e[0],i=e[1],r=e[2],o=n*n+i*i+r*r;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function Y9(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Ax(t,e,n){var i=e[0],r=e[1],o=e[2],l=n[0],s=n[1],d=n[2];return t[0]=r*d-o*s,t[1]=o*l-i*d,t[2]=i*s-r*l,t}function Oae(t,e,n,i){var r=e[0],o=e[1],l=e[2];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t[2]=l+i*(n[2]-l),t}function UM(t,e,n){var i=e[0],r=e[1],o=e[2],l=n[3]*i+n[7]*r+n[11]*o+n[15];return l=l||1,t[0]=(n[0]*i+n[4]*r+n[8]*o+n[12])/l,t[1]=(n[1]*i+n[5]*r+n[9]*o+n[13])/l,t[2]=(n[2]*i+n[6]*r+n[10]*o+n[14])/l,t}function J9(t,e,n){var i=e[0],r=e[1],o=e[2];return t[0]=i*n[0]+r*n[3]+o*n[6],t[1]=i*n[1]+r*n[4]+o*n[7],t[2]=i*n[2]+r*n[5]+o*n[8],t}function Q9(t,e,n){var i=n[0],r=n[1],o=n[2],l=n[3],s=e[0],d=e[1],p=e[2],y=r*p-o*d,v=o*s-i*p,w=i*d-r*s,T=r*w-o*v,I=o*y-i*w,L=i*v-r*y,k=l*2;return y*=k,v*=k,w*=k,T*=2,I*=2,L*=2,t[0]=s+y+T,t[1]=d+v+I,t[2]=p+w+L,t}function Dae(t,e,n,i){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[0],o[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),o[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function kae(t,e,n,i){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),o[1]=r[1],o[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function Fae(t,e,n,i){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),o[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),o[2]=r[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function Bae(t,e){var n=t[0],i=t[1],r=t[2],o=e[0],l=e[1],s=e[2],d=Math.sqrt(n*n+i*i+r*r),p=Math.sqrt(o*o+l*l+s*s),y=d*p,v=y&&Y9(t,e)/y;return Math.acos(Math.min(Math.max(v,-1),1))}var e7=Iae,t7=Pae,HS=Mae;(function(){var t=q9();return function(e,n,i,r,o,l){var s,d;for(n||(n=3),i||(i=0),r?d=Math.min(r*n+i,e.length):d=e.length,s=i;s<d;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],o(t,t,l),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}})();const WS=[0,0,0];let Mb;class Mn extends W9{static get ZERO(){return Mb||(Mb=new Mn(0,0,0),Object.freeze(Mb)),Mb}constructor(e=0,n=0,i=0){super(-0,-0,-0),arguments.length===1&&hf(e)?this.copy(e):(Ms.debug&&(Sr(e),Sr(n),Sr(i)),this[0]=e,this[1]=n,this[2]=i)}set(e,n,i){return this[0]=e,this[1]=n,this[2]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Ms.debug&&(Sr(e.x),Sr(e.y),Sr(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Sr(e)}angle(e){return Bae(this,e)}cross(e){return Ax(this,this,e),this.check()}rotateX({radians:e,origin:n=WS}){return Dae(this,this,n,e),this.check()}rotateY({radians:e,origin:n=WS}){return kae(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=WS}){return Fae(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return UM(this,this,e),this.check()}transformAsVector(e){return X9(this,this,e),this.check()}transformByMatrix3(e){return J9(this,this,e),this.check()}transformByMatrix2(e){return Cae(this,this,e),this.check()}transformByQuaternion(e){return Q9(this,this,e),this.check()}}let Rb;class VM extends W9{static get ZERO(){return Rb||(Rb=new VM(0,0,0,0),Object.freeze(Rb)),Rb}constructor(e=0,n=0,i=0,r=0){super(-0,-0,-0,-0),hf(e)&&arguments.length===1?this.copy(e):(Ms.debug&&(Sr(e),Sr(n),Sr(i),Sr(r)),this[0]=e,this[1]=n,this[2]=i,this[3]=r)}set(e,n,i,r){return this[0]=e,this[1]=n,this[2]=i,this[3]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return Ms.debug&&(Sr(e.x),Sr(e.y),Sr(e.z),Sr(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=Sr(e)}get w(){return this[3]}set w(e){this[3]=Sr(e)}transform(e){return UM(this,this,e),this.check()}transformByMatrix3(e){return Z9(this,this,e),this.check()}transformByMatrix2(e){return Aae(this,this,e),this.check()}transformByQuaternion(e){return Q9(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}class n7 extends NM{toString(){let e="[";if(Ms.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let i=0;i<this.RANK;++i)e+=" ".concat(this[i*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,i){return this[n*this.RANK+e]=Sr(i),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)n[r]=this[i+r];return n}setColumn(e,n){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)this[i+r]=n[r];return this}}function zae(){var t=new Pl(9);return Pl!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Nae(t,e){if(t===e){var n=e[1],i=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=i,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Uae(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],l=e[4],s=e[5],d=e[6],p=e[7],y=e[8],v=y*l-s*p,w=-y*o+s*d,T=p*o-l*d,I=n*v+i*w+r*T;return I?(I=1/I,t[0]=v*I,t[1]=(-y*i+r*p)*I,t[2]=(s*i-r*l)*I,t[3]=w*I,t[4]=(y*n-r*d)*I,t[5]=(-s*n+r*o)*I,t[6]=T*I,t[7]=(-p*n+i*d)*I,t[8]=(l*n-i*o)*I,t):null}function Vae(t){var e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],l=t[5],s=t[6],d=t[7],p=t[8];return e*(p*o-l*d)+n*(-p*r+l*s)+i*(d*r-o*s)}function b5(t,e,n){var i=e[0],r=e[1],o=e[2],l=e[3],s=e[4],d=e[5],p=e[6],y=e[7],v=e[8],w=n[0],T=n[1],I=n[2],L=n[3],k=n[4],F=n[5],B=n[6],G=n[7],U=n[8];return t[0]=w*i+T*l+I*p,t[1]=w*r+T*s+I*y,t[2]=w*o+T*d+I*v,t[3]=L*i+k*l+F*p,t[4]=L*r+k*s+F*y,t[5]=L*o+k*d+F*v,t[6]=B*i+G*l+U*p,t[7]=B*r+G*s+U*y,t[8]=B*o+G*d+U*v,t}function jae(t,e,n){var i=e[0],r=e[1],o=e[2],l=e[3],s=e[4],d=e[5],p=e[6],y=e[7],v=e[8],w=n[0],T=n[1];return t[0]=i,t[1]=r,t[2]=o,t[3]=l,t[4]=s,t[5]=d,t[6]=w*i+T*l+p,t[7]=w*r+T*s+y,t[8]=w*o+T*d+v,t}function $ae(t,e,n){var i=e[0],r=e[1],o=e[2],l=e[3],s=e[4],d=e[5],p=e[6],y=e[7],v=e[8],w=Math.sin(n),T=Math.cos(n);return t[0]=T*i+w*l,t[1]=T*r+w*s,t[2]=T*o+w*d,t[3]=T*l-w*i,t[4]=T*s-w*r,t[5]=T*d-w*o,t[6]=p,t[7]=y,t[8]=v,t}function x5(t,e,n){var i=n[0],r=n[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Gae(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],l=n+n,s=i+i,d=r+r,p=n*l,y=i*l,v=i*s,w=r*l,T=r*s,I=r*d,L=o*l,k=o*s,F=o*d;return t[0]=1-v-I,t[3]=y-F,t[6]=w+k,t[1]=y+F,t[4]=1-p-I,t[7]=T-L,t[2]=w-k,t[5]=T+L,t[8]=1-p-v,t}var QA;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL1ROW0=3]="COL1ROW0",t[t.COL1ROW1=4]="COL1ROW1",t[t.COL1ROW2=5]="COL1ROW2",t[t.COL2ROW0=6]="COL2ROW0",t[t.COL2ROW1=7]="COL2ROW1",t[t.COL2ROW2=8]="COL2ROW2"})(QA||(QA={}));const Hae=Object.freeze([1,0,0,0,1,0,0,0,1]);class ns extends n7{static get IDENTITY(){return Kae()}static get ZERO(){return Wae()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return QA}constructor(e,...n){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):n.length>0?this.copy([e,...n]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(Hae)}fromObject(e){return this.check()}fromQuaternion(e){return Gae(this,e),this.check()}set(e,n,i,r,o,l,s,d,p){return this[0]=e,this[1]=n,this[2]=i,this[3]=r,this[4]=o,this[5]=l,this[6]=s,this[7]=d,this[8]=p,this.check()}setRowMajor(e,n,i,r,o,l,s,d,p){return this[0]=e,this[1]=r,this[2]=s,this[3]=n,this[4]=o,this[5]=d,this[6]=i,this[7]=l,this[8]=p,this.check()}determinant(){return Vae(this)}transpose(){return Nae(this,this),this.check()}invert(){return Uae(this,this),this.check()}multiplyLeft(e){return b5(this,e,this),this.check()}multiplyRight(e){return b5(this,this,e),this.check()}rotate(e){return $ae(this,this,e),this.check()}scale(e){return Array.isArray(e)?x5(this,this,e):x5(this,this,[e,e]),this.check()}translate(e){return jae(this,this,e),this.check()}transform(e,n){let i;switch(e.length){case 2:i=Eae(n||[-0,-0],e,this);break;case 3:i=J9(n||[-0,-0,-0],e,this);break;case 4:i=Z9(n||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return F0(i,e.length),i}transformVector(e,n){return this.transform(e,n)}transformVector2(e,n){return this.transform(e,n)}transformVector3(e,n){return this.transform(e,n)}}let Lb,Ob;function Wae(){return Lb||(Lb=new ns([0,0,0,0,0,0,0,0,0]),Object.freeze(Lb)),Lb}function Kae(){return Ob||(Ob=new ns,Object.freeze(Ob)),Ob}function Xae(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Zae(t,e){if(t===e){var n=e[1],i=e[2],r=e[3],o=e[6],l=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=o,t[11]=e[14],t[12]=r,t[13]=l,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function eP(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],l=e[4],s=e[5],d=e[6],p=e[7],y=e[8],v=e[9],w=e[10],T=e[11],I=e[12],L=e[13],k=e[14],F=e[15],B=n*s-i*l,G=n*d-r*l,U=n*p-o*l,ee=i*d-r*s,ne=i*p-o*s,ye=r*p-o*d,fe=y*L-v*I,J=y*k-w*I,Ce=y*F-T*I,me=v*k-w*L,be=v*F-T*L,Te=w*F-T*k,ke=B*Te-G*be+U*me+ee*Ce-ne*J+ye*fe;return ke?(ke=1/ke,t[0]=(s*Te-d*be+p*me)*ke,t[1]=(r*be-i*Te-o*me)*ke,t[2]=(L*ye-k*ne+F*ee)*ke,t[3]=(w*ne-v*ye-T*ee)*ke,t[4]=(d*Ce-l*Te-p*J)*ke,t[5]=(n*Te-r*Ce+o*J)*ke,t[6]=(k*U-I*ye-F*G)*ke,t[7]=(y*ye-w*U+T*G)*ke,t[8]=(l*be-s*Ce+p*fe)*ke,t[9]=(i*Ce-n*be-o*fe)*ke,t[10]=(I*ne-L*U+F*B)*ke,t[11]=(v*U-y*ne-T*B)*ke,t[12]=(s*J-l*me-d*fe)*ke,t[13]=(n*me-i*J+r*fe)*ke,t[14]=(L*G-I*ee-k*B)*ke,t[15]=(y*ee-v*G+w*B)*ke,t):null}function qae(t){var e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],l=t[5],s=t[6],d=t[7],p=t[8],y=t[9],v=t[10],w=t[11],T=t[12],I=t[13],L=t[14],k=t[15],F=e*l-n*o,B=e*s-i*o,G=e*d-r*o,U=n*s-i*l,ee=n*d-r*l,ne=i*d-r*s,ye=p*I-y*T,fe=p*L-v*T,J=p*k-w*T,Ce=y*L-v*I,me=y*k-w*I,be=v*k-w*L;return F*be-B*me+G*Ce+U*J-ee*fe+ne*ye}function Jd(t,e,n){var i=e[0],r=e[1],o=e[2],l=e[3],s=e[4],d=e[5],p=e[6],y=e[7],v=e[8],w=e[9],T=e[10],I=e[11],L=e[12],k=e[13],F=e[14],B=e[15],G=n[0],U=n[1],ee=n[2],ne=n[3];return t[0]=G*i+U*s+ee*v+ne*L,t[1]=G*r+U*d+ee*w+ne*k,t[2]=G*o+U*p+ee*T+ne*F,t[3]=G*l+U*y+ee*I+ne*B,G=n[4],U=n[5],ee=n[6],ne=n[7],t[4]=G*i+U*s+ee*v+ne*L,t[5]=G*r+U*d+ee*w+ne*k,t[6]=G*o+U*p+ee*T+ne*F,t[7]=G*l+U*y+ee*I+ne*B,G=n[8],U=n[9],ee=n[10],ne=n[11],t[8]=G*i+U*s+ee*v+ne*L,t[9]=G*r+U*d+ee*w+ne*k,t[10]=G*o+U*p+ee*T+ne*F,t[11]=G*l+U*y+ee*I+ne*B,G=n[12],U=n[13],ee=n[14],ne=n[15],t[12]=G*i+U*s+ee*v+ne*L,t[13]=G*r+U*d+ee*w+ne*k,t[14]=G*o+U*p+ee*T+ne*F,t[15]=G*l+U*y+ee*I+ne*B,t}function vw(t,e,n){var i=n[0],r=n[1],o=n[2],l,s,d,p,y,v,w,T,I,L,k,F;return e===t?(t[12]=e[0]*i+e[4]*r+e[8]*o+e[12],t[13]=e[1]*i+e[5]*r+e[9]*o+e[13],t[14]=e[2]*i+e[6]*r+e[10]*o+e[14],t[15]=e[3]*i+e[7]*r+e[11]*o+e[15]):(l=e[0],s=e[1],d=e[2],p=e[3],y=e[4],v=e[5],w=e[6],T=e[7],I=e[8],L=e[9],k=e[10],F=e[11],t[0]=l,t[1]=s,t[2]=d,t[3]=p,t[4]=y,t[5]=v,t[6]=w,t[7]=T,t[8]=I,t[9]=L,t[10]=k,t[11]=F,t[12]=l*i+y*r+I*o+e[12],t[13]=s*i+v*r+L*o+e[13],t[14]=d*i+w*r+k*o+e[14],t[15]=p*i+T*r+F*o+e[15]),t}function jM(t,e,n){var i=n[0],r=n[1],o=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Yae(t,e,n,i){var r=i[0],o=i[1],l=i[2],s=Math.hypot(r,o,l),d,p,y,v,w,T,I,L,k,F,B,G,U,ee,ne,ye,fe,J,Ce,me,be,Te,ke,ut;return s<B0?null:(s=1/s,r*=s,o*=s,l*=s,d=Math.sin(n),p=Math.cos(n),y=1-p,v=e[0],w=e[1],T=e[2],I=e[3],L=e[4],k=e[5],F=e[6],B=e[7],G=e[8],U=e[9],ee=e[10],ne=e[11],ye=r*r*y+p,fe=o*r*y+l*d,J=l*r*y-o*d,Ce=r*o*y-l*d,me=o*o*y+p,be=l*o*y+r*d,Te=r*l*y+o*d,ke=o*l*y-r*d,ut=l*l*y+p,t[0]=v*ye+L*fe+G*J,t[1]=w*ye+k*fe+U*J,t[2]=T*ye+F*fe+ee*J,t[3]=I*ye+B*fe+ne*J,t[4]=v*Ce+L*me+G*be,t[5]=w*Ce+k*me+U*be,t[6]=T*Ce+F*me+ee*be,t[7]=I*Ce+B*me+ne*be,t[8]=v*Te+L*ke+G*ut,t[9]=w*Te+k*ke+U*ut,t[10]=T*Te+F*ke+ee*ut,t[11]=I*Te+B*ke+ne*ut,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function i7(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[4],l=e[5],s=e[6],d=e[7],p=e[8],y=e[9],v=e[10],w=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+p*i,t[5]=l*r+y*i,t[6]=s*r+v*i,t[7]=d*r+w*i,t[8]=p*r-o*i,t[9]=y*r-l*i,t[10]=v*r-s*i,t[11]=w*r-d*i,t}function Jae(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],l=e[1],s=e[2],d=e[3],p=e[8],y=e[9],v=e[10],w=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r-p*i,t[1]=l*r-y*i,t[2]=s*r-v*i,t[3]=d*r-w*i,t[8]=o*i+p*r,t[9]=l*i+y*r,t[10]=s*i+v*r,t[11]=d*i+w*r,t}function r7(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],l=e[1],s=e[2],d=e[3],p=e[4],y=e[5],v=e[6],w=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+p*i,t[1]=l*r+y*i,t[2]=s*r+v*i,t[3]=d*r+w*i,t[4]=p*r-o*i,t[5]=y*r-l*i,t[6]=v*r-s*i,t[7]=w*r-d*i,t}function Qae(t,e){var n=e[0],i=e[1],r=e[2],o=e[4],l=e[5],s=e[6],d=e[8],p=e[9],y=e[10];return t[0]=Math.hypot(n,i,r),t[1]=Math.hypot(o,l,s),t[2]=Math.hypot(d,p,y),t}function ele(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],l=n+n,s=i+i,d=r+r,p=n*l,y=i*l,v=i*s,w=r*l,T=r*s,I=r*d,L=o*l,k=o*s,F=o*d;return t[0]=1-v-I,t[1]=y+F,t[2]=w-k,t[3]=0,t[4]=y-F,t[5]=1-p-I,t[6]=T+L,t[7]=0,t[8]=w+k,t[9]=T-L,t[10]=1-p-v,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function tle(t,e,n,i,r,o,l){var s=1/(n-e),d=1/(r-i),p=1/(o-l);return t[0]=o*2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o*2*d,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(r+i)*d,t[10]=(l+o)*p,t[11]=-1,t[12]=0,t[13]=0,t[14]=l*o*2*p,t[15]=0,t}function nle(t,e,n,i,r){var o=1/Math.tan(e/2),l;return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,r!=null&&r!==1/0?(l=1/(i-r),t[10]=(r+i)*l,t[14]=2*r*i*l):(t[10]=-1,t[14]=-2*i),t}var ile=nle;function rle(t,e,n,i,r,o,l){var s=1/(e-n),d=1/(i-r),p=1/(o-l);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*d,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*p,t[11]=0,t[12]=(e+n)*s,t[13]=(r+i)*d,t[14]=(l+o)*p,t[15]=1,t}var ole=rle;function sle(t,e,n,i){var r,o,l,s,d,p,y,v,w,T,I=e[0],L=e[1],k=e[2],F=i[0],B=i[1],G=i[2],U=n[0],ee=n[1],ne=n[2];return Math.abs(I-U)<B0&&Math.abs(L-ee)<B0&&Math.abs(k-ne)<B0?Xae(t):(y=I-U,v=L-ee,w=k-ne,T=1/Math.hypot(y,v,w),y*=T,v*=T,w*=T,r=B*w-G*v,o=G*y-F*w,l=F*v-B*y,T=Math.hypot(r,o,l),T?(T=1/T,r*=T,o*=T,l*=T):(r=0,o=0,l=0),s=v*l-w*o,d=w*r-y*l,p=y*o-v*r,T=Math.hypot(s,d,p),T?(T=1/T,s*=T,d*=T,p*=T):(s=0,d=0,p=0),t[0]=r,t[1]=s,t[2]=y,t[3]=0,t[4]=o,t[5]=d,t[6]=v,t[7]=0,t[8]=l,t[9]=p,t[10]=w,t[11]=0,t[12]=-(r*I+o*L+l*k),t[13]=-(s*I+d*L+p*k),t[14]=-(y*I+v*L+w*k),t[15]=1,t)}function ale(){var t=new Pl(4);return Pl!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function lle(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function $M(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function cle(t){var e=t[0],n=t[1],i=t[2],r=t[3];return Math.hypot(e,n,i,r)}function ule(t){var e=t[0],n=t[1],i=t[2],r=t[3];return e*e+n*n+i*i+r*r}function hle(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],l=n*n+i*i+r*r+o*o;return l>0&&(l=1/Math.sqrt(l)),t[0]=n*l,t[1]=i*l,t[2]=r*l,t[3]=o*l,t}function dle(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function fle(t,e,n,i){var r=e[0],o=e[1],l=e[2],s=e[3];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t[2]=l+i*(n[2]-l),t[3]=s+i*(n[3]-s),t}function tg(t,e,n){var i=e[0],r=e[1],o=e[2],l=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*o+n[12]*l,t[1]=n[1]*i+n[5]*r+n[9]*o+n[13]*l,t[2]=n[2]*i+n[6]*r+n[10]*o+n[14]*l,t[3]=n[3]*i+n[7]*r+n[11]*o+n[15]*l,t}function ple(t,e,n){var i=e[0],r=e[1],o=e[2],l=n[0],s=n[1],d=n[2],p=n[3],y=p*i+s*o-d*r,v=p*r+d*i-l*o,w=p*o+l*r-s*i,T=-l*i-s*r-d*o;return t[0]=y*p+T*-l+v*-d-w*-s,t[1]=v*p+T*-s+w*-l-y*-d,t[2]=w*p+T*-d+y*-s-v*-l,t[3]=e[3],t}(function(){var t=ale();return function(e,n,i,r,o,l){var s,d;for(n||(n=4),i||(i=0),r?d=Math.min(r*n+i,e.length):d=e.length,s=i;s<d;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],o(t,t,l),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}})();var tP;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(tP||(tP={}));const mle=45*Math.PI/180,gle=1,KS=.1,XS=500,yle=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Js extends n7{static get IDENTITY(){return _le()}static get ZERO(){return vle()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return tP}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,i,r,o,l,s,d,p,y,v,w,T,I,L,k){return this[0]=e,this[1]=n,this[2]=i,this[3]=r,this[4]=o,this[5]=l,this[6]=s,this[7]=d,this[8]=p,this[9]=y,this[10]=v,this[11]=w,this[12]=T,this[13]=I,this[14]=L,this[15]=k,this.check()}setRowMajor(e,n,i,r,o,l,s,d,p,y,v,w,T,I,L,k){return this[0]=e,this[1]=o,this[2]=p,this[3]=T,this[4]=n,this[5]=l,this[6]=y,this[7]=I,this[8]=i,this[9]=s,this[10]=v,this[11]=L,this[12]=r,this[13]=d,this[14]=w,this[15]=k,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(yle)}fromObject(e){return this.check()}fromQuaternion(e){return ele(this,e),this.check()}frustum(e){const{left:n,right:i,bottom:r,top:o,near:l=KS,far:s=XS}=e;return s===1/0?ble(this,n,i,r,o,l):tle(this,n,i,r,o,l,s),this.check()}lookAt(e){const{eye:n,center:i=[0,0,0],up:r=[0,1,0]}=e;return sle(this,n,i,r),this.check()}ortho(e){const{left:n,right:i,bottom:r,top:o,near:l=KS,far:s=XS}=e;return ole(this,n,i,r,o,l,s),this.check()}orthographic(e){const{fovy:n=mle,aspect:i=gle,focalDistance:r=1,near:o=KS,far:l=XS}=e;w5(n);const s=n/2,d=r*Math.tan(s),p=d*i;return this.ortho({left:-p,right:p,bottom:-d,top:d,near:o,far:l})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:i=1,near:r=.1,far:o=500}=e;return w5(n),ile(this,n,i,r,o),this.check()}determinant(){return qae(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const i=this.getScale(n),r=1/i[0],o=1/i[1],l=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*o,e[2]=this[2]*l,e[3]=0,e[4]=this[4]*r,e[5]=this[5]*o,e[6]=this[6]*l,e[7]=0,e[8]=this[8]*r,e[9]=this[9]*o,e[10]=this[10]*l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const i=this.getScale(n),r=1/i[0],o=1/i[1],l=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*o,e[2]=this[2]*l,e[3]=this[4]*r,e[4]=this[5]*o,e[5]=this[6]*l,e[6]=this[8]*r,e[7]=this[9]*o,e[8]=this[10]*l,e}transpose(){return Zae(this,this),this.check()}invert(){return eP(this,this),this.check()}multiplyLeft(e){return Jd(this,e,this),this.check()}multiplyRight(e){return Jd(this,this,e),this.check()}rotateX(e){return i7(this,this,e),this.check()}rotateY(e){return Jae(this,this,e),this.check()}rotateZ(e){return r7(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return Yae(this,this,e,n),this.check()}scale(e){return jM(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return vw(this,this,e),this.check()}transform(e,n){return e.length===4?(n=tg(n||[-0,-0,-0,-0],e,this),F0(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:i}=e;let r;switch(i){case 2:r=Tae(n||[-0,-0],e,this);break;case 3:r=UM(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return F0(r,e.length),r}transformAsVector(e,n){let i;switch(e.length){case 2:i=Sae(n||[-0,-0],e,this);break;case 3:i=X9(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return F0(i,e.length),i}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,i){return this.identity().translate([e,n,i])}}let Db,kb;function vle(){return Db||(Db=new Js([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Db)),Db}function _le(){return kb||(kb=new Js,Object.freeze(kb)),kb}function w5(t){if(t>Math.PI*2)throw Error("expected radians")}function ble(t,e,n,i,r,o){const l=2*o/(n-e),s=2*o/(r-i),d=(n+e)/(n-e),p=(r+i)/(r-i),y=-1,v=-1,w=-2*o;return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=d,t[9]=p,t[10]=y,t[11]=v,t[12]=0,t[13]=0,t[14]=w,t[15]=0,t}function E5(){var t=new Pl(4);return Pl!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function xle(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function o7(t,e,n){n=n*.5;var i=Math.sin(n);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(n),t}function T5(t,e,n){var i=e[0],r=e[1],o=e[2],l=e[3],s=n[0],d=n[1],p=n[2],y=n[3];return t[0]=i*y+l*s+r*p-o*d,t[1]=r*y+l*d+o*s-i*p,t[2]=o*y+l*p+i*d-r*s,t[3]=l*y-i*s-r*d-o*p,t}function wle(t,e,n){n*=.5;var i=e[0],r=e[1],o=e[2],l=e[3],s=Math.sin(n),d=Math.cos(n);return t[0]=i*d+l*s,t[1]=r*d+o*s,t[2]=o*d-r*s,t[3]=l*d-i*s,t}function Ele(t,e,n){n*=.5;var i=e[0],r=e[1],o=e[2],l=e[3],s=Math.sin(n),d=Math.cos(n);return t[0]=i*d-o*s,t[1]=r*d+l*s,t[2]=o*d+i*s,t[3]=l*d-r*s,t}function Tle(t,e,n){n*=.5;var i=e[0],r=e[1],o=e[2],l=e[3],s=Math.sin(n),d=Math.cos(n);return t[0]=i*d+r*s,t[1]=r*d-i*s,t[2]=o*d+l*s,t[3]=l*d-o*s,t}function Sle(t,e){var n=e[0],i=e[1],r=e[2];return t[0]=n,t[1]=i,t[2]=r,t[3]=Math.sqrt(Math.abs(1-n*n-i*i-r*r)),t}function Px(t,e,n,i){var r=e[0],o=e[1],l=e[2],s=e[3],d=n[0],p=n[1],y=n[2],v=n[3],w,T,I,L,k;return T=r*d+o*p+l*y+s*v,T<0&&(T=-T,d=-d,p=-p,y=-y,v=-v),1-T>B0?(w=Math.acos(T),I=Math.sin(w),L=Math.sin((1-i)*w)/I,k=Math.sin(i*w)/I):(L=1-i,k=i),t[0]=L*r+k*d,t[1]=L*o+k*p,t[2]=L*l+k*y,t[3]=L*s+k*v,t}function Cle(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],l=n*n+i*i+r*r+o*o,s=l?1/l:0;return t[0]=-n*s,t[1]=-i*s,t[2]=-r*s,t[3]=o*s,t}function Ale(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function s7(t,e){var n=e[0]+e[4]+e[8],i;if(n>0)i=Math.sqrt(n+1),t[3]=.5*i,i=.5/i,t[0]=(e[5]-e[7])*i,t[1]=(e[6]-e[2])*i,t[2]=(e[1]-e[3])*i;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[r*3+r]&&(r=2);var o=(r+1)%3,l=(r+2)%3;i=Math.sqrt(e[r*3+r]-e[o*3+o]-e[l*3+l]+1),t[r]=.5*i,i=.5/i,t[3]=(e[o*3+l]-e[l*3+o])*i,t[o]=(e[o*3+r]+e[r*3+o])*i,t[l]=(e[l*3+r]+e[r*3+l])*i}return t}var Ple=lle,Ile=$M,Mle=dle,Rle=fle,Lle=cle,Ole=ule,a7=hle,Dle=function(){var t=q9(),e=_5(1,0,0),n=_5(0,1,0);return function(i,r,o){var l=Y9(r,o);return l<-.999999?(Ax(t,e,r),t7(t)<1e-6&&Ax(t,n,r),Lae(t,t),o7(i,t,Math.PI),i):l>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(Ax(t,r,o),i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=1+l,a7(i,i))}}();(function(){var t=E5(),e=E5();return function(n,i,r,o,l,s){return Px(t,i,l,s),Px(e,r,o,s),Px(n,t,e,2*s*(1-s)),n}})();(function(){var t=zae();return function(e,n,i,r){return t[0]=i[0],t[3]=i[1],t[6]=i[2],t[1]=r[0],t[4]=r[1],t[7]=r[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],a7(e,s7(e,t))}})();const kle=[0,0,0,1];class S5 extends NM{constructor(e=0,n=0,i=0,r=1){super(-0,-0,-0,-0),Array.isArray(e)&&arguments.length===1?this.copy(e):this.set(e,n,i,r)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,n,i,r){return this[0]=e,this[1]=n,this[2]=i,this[3]=r,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return s7(this,e),this.check()}fromAxisRotation(e,n){return o7(this,e,n),this.check()}identity(){return xle(this),this.check()}setAxisAngle(e,n){return this.fromAxisRotation(e,n)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=Sr(e)}get y(){return this[1]}set y(e){this[1]=Sr(e)}get z(){return this[2]}set z(e){this[2]=Sr(e)}get w(){return this[3]}set w(e){this[3]=Sr(e)}len(){return Lle(this)}lengthSquared(){return Ole(this)}dot(e){return Mle(this,e)}rotationTo(e,n){return Dle(this,e,n),this.check()}add(e){return Ple(this,this,e),this.check()}calculateW(){return Sle(this,this),this.check()}conjugate(){return Ale(this,this),this.check()}invert(){return Cle(this,this),this.check()}lerp(e,n,i){return i===void 0?this.lerp(this,e,n):(Rle(this,e,n,i),this.check())}multiplyRight(e){return T5(this,this,e),this.check()}multiplyLeft(e){return T5(this,e,this),this.check()}normalize(){const e=this.len(),n=e>0?1/e:0;return this[0]=this[0]*n,this[1]=this[1]*n,this[2]=this[2]*n,this[3]=this[3]*n,e===0&&(this[3]=1),this.check()}rotateX(e){return wle(this,this,e),this.check()}rotateY(e){return Ele(this,this,e),this.check()}rotateZ(e){return Tle(this,this,e),this.check()}scale(e){return Ile(this,this,e),this.check()}slerp(e,n,i){let r,o,l;switch(arguments.length){case 1:({start:r=kle,target:o,ratio:l}=e);break;case 2:r=this,o=e,l=n;break;default:r=e,o=n,l=i}return Px(this,r,o,l),this.check()}transformVector4(e,n=new VM){return ple(n,e,this),F0(n,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,n){return this.setAxisAngle(e,n)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}}const l7={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:Math.PI*2},C5=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,Fle={lightSources:{}};function ZS(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.map(n=>n*e/255)}function Ble(t){let{ambientLight:e,pointLights:n=[],directionalLights:i=[]}=t;const r={};return e?r["lighting_uAmbientLight.color"]=ZS(e):r["lighting_uAmbientLight.color"]=[0,0,0],n.forEach((o,l)=>{r["lighting_uPointLight[".concat(l,"].color")]=ZS(o),r["lighting_uPointLight[".concat(l,"].position")]=o.position,r["lighting_uPointLight[".concat(l,"].attenuation")]=o.attenuation||[1,0,0]}),r.lighting_uPointLightCount=n.length,i.forEach((o,l)=>{r["lighting_uDirectionalLight[".concat(l,"].color")]=ZS(o),r["lighting_uDirectionalLight[".concat(l,"].direction")]=o.direction}),r.lighting_uDirectionalLightCount=i.length,r}function c7(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Fle;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:i}=t.lightSources||{};return e||n&&n.length>0||i&&i.length>0?Object.assign({},Ble({ambientLight:e,pointLights:n,directionalLights:i}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const e={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights.push(n);break;case"point":e.pointLights.push(n);break}return c7({lightSources:e})}return{}}const u7={name:"lights",vs:C5,fs:C5,getUniforms:c7,defines:{MAX_LIGHTS:3}},zle=new Uint8Array([0,255,255,255]),Nle={pickingSelectedColor:null,pickingHighlightColor:zle,pickingActive:!1,pickingAttribute:!1};function Ule(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Nle;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,i=>i/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=!!t.pickingActive,e.picking_uAttribute=!!t.pickingAttribute),e}const Vle=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,jle=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,$le={name:"picking",vs:Vle,fs:jle,getUniforms:Ule},h7=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,Gle={};function Hle(t){const{ambient:e=.35,diffuse:n=.6,shininess:i=32,specularColor:r=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:i,lighting_uSpecularColor:r.map(o=>o/255)}}function d7(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Gle;if(!("material"in t))return{};const{material:e}=t;return e?Hle(e):{lighting_uEnabled:!1}}const f7={name:"gouraud-lighting",dependencies:[u7],vs:h7,defines:{LIGHTING_VERTEX:1},getUniforms:d7},Wle={name:"phong-lighting",dependencies:[u7],fs:h7,defines:{LIGHTING_FRAGMENT:1},getUniforms:d7},Kle=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,Xle={name:"transform",vs:Kle,fs:null};class w_{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new w_(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(i=>i.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:i="",defines:r={},inject:o={},varyings:l=[],bufferMode:s=35981,transpileToGLSL100:d=!1}=e,p=this._getModuleList(e.modules),y=this._getHash(n),v=this._getHash(i),w=p.map(G=>this._getHash(G.name)).sort(),T=l.map(G=>this._getHash(G)),I=Object.keys(r).sort(),L=Object.keys(o).sort(),k=[],F=[];for(const G of I)k.push(this._getHash(G)),k.push(this._getHash(r[G]));for(const G of L)F.push(this._getHash(G)),F.push(this._getHash(o[G]));const B="".concat(y,"/").concat(v,"D").concat(k.join("/"),"M").concat(w.join("/"),"I").concat(F.join("/"),"V").concat(T.join("/"),"H").concat(this.stateHash,"B").concat(s).concat(d?"T":"");if(!this._programCache[B]){const G=tae(this.gl,{vs:n,fs:i,modules:p,inject:o,defines:r,hookFunctions:this._hookFunctions,transpileToGLSL100:d});this._programCache[B]=new F9(this.gl,{hash:B,vs:G.vs,fs:G.fs,varyings:l,bufferMode:s}),this._getUniforms[B]=G.getUniforms||(U=>{}),this._useCounts[B]=0}return this._useCounts[B]++,this._programCache[B]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),i={};let r=0;for(let o=0,l=this._defaultModules.length;o<l;++o){const s=this._defaultModules[o],d=s.name;n[r++]=s,i[d]=!0}for(let o=0,l=e.length;o<l;++o){const s=e[o],d=s.name;i[d]||(n[r++]=s,i[d]=!0)}return n.length=r,n}}const Zle={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function qle(t,e,n){const i={};let r=e.indices;for(const o in e.attributes){const l=e.attributes[o],s=Yle(o,n);if(o==="indices")r=l;else if(l.constant)i[s]=l.value;else{const d=l.value,p={...l};delete p.value,i[s]=[new $i(t,d),p],Jle(o,p)}}if(r){const o=r.value||r;Tn(o instanceof Uint16Array||o instanceof Uint32Array,'attribute array for "indices" must be of integer type');const l={size:1,isIndexed:r.isIndexed===void 0?!0:r.isIndexed};i.indices=[new $i(t,{data:o,target:34963}),l]}return i}function Yle(t,e){const{attributeMap:n=Zle}=e||{};return n&&n[t]||t}function Jle(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}Tn(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const Lp=2,Qle=1e4,ece="Model needs drawMode and vertexCount",A5=()=>{},tce={};class Il{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:i=dc("model")}=n;Tn(D2(e)),this.id=i,this.gl=e,this.id=n.id||dc("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||w_.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:i,fs:r,modules:o,defines:l,inject:s,varyings:d,bufferMode:p,transpileToGLSL100:y}=e;this.programProps={program:n,vs:i,fs:r,modules:o,defines:l,inject:s,varyings:d,bufferMode:p,transpileToGLSL100:y},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},Tn(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),ece)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:i,fs:r,modules:o,defines:l,inject:s,varyings:d,bufferMode:p,transpileToGLSL100:y}=e;this.programProps={program:n,vs:i,fs:r,modules:o,defines:l,inject:s,varyings:d,bufferMode:p,transpileToGLSL100:y},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return Tn(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return Tn(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=qle(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(km(e))return this;const n={};for(const i in e){const r=e[i];n[i]=r.getValue?r.getValue():r}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return kM(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:i,uniforms:r={},attributes:o={},transformFeedback:l=this.transformFeedback,parameters:s={},vertexArray:d=this.vertexArray}=e;this.setAttributes(o),this.updateModuleSettings(n),this.setUniforms(r);let p;Wn.priority>=Lp&&(p=this._logDrawCallStart(Lp));const y=this.vertexArray.getDrawParams(),{isIndexed:v=y.isIndexed,indexType:w=y.indexType,indexOffset:T=y.indexOffset,vertexArrayInstanced:I=y.isInstanced}=this.props;I&&!this.isInstanced&&Wn.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:L,instanceCount:k}=this,{onBeforeRender:F=A5,onAfterRender:B=A5}=this.props;F(),this.program.setUniforms(this.uniforms);const G=this.program.draw(Object.assign(tce,e,{logPriority:p,uniforms:null,framebuffer:i,parameters:s,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:d,transformFeedback:l,isIndexed:v,indexType:w,isInstanced:L,instanceCount:k,offset:v?T:0}));return B(),Wn.priority>=Lp&&this._logDrawCallEnd(p,d,i),G}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:i,unbindModels:r=[]}=e;let{parameters:o}=e;i&&this._setFeedbackBuffers(i),n&&(o=Object.assign({},o,{35977:n})),r.forEach(l=>l.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:o}))}finally{r.forEach(l=>l.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Wn.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:i,fs:r,modules:o,inject:l,defines:s,varyings:d,bufferMode:p,transpileToGLSL100:y}=this.programProps;n=this.programManager.get({vs:i,fs:r,modules:o,inject:l,defines:s,varyings:d,bufferMode:p,transpileToGLSL100:y}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}Tn(n instanceof F9,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new gse(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof $i&&n.delete()}}_setAnimationProps(e){this.animated&&Tn(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(km(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new B9(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:Qle;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),Wn.group(Lp,">>> DRAWING MODEL ".concat(this.id),{collapsed:Wn.level<=2})(),e}_logDrawCallEnd(e,n,i,r){if(e===void 0)return;const o=_se({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:l,unusedTable:s,unusedCount:d}=a5({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,i)}),{table:p,count:y}=a5({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,i),undefinedOnly:!0});y>0&&Wn.log("MISSING UNIFORMS",Object.keys(p))(),d>0&&Wn.log("UNUSED UNIFORMS",Object.keys(s))();const v=xse(this.vertexArray.configuration);Wn.table(e,o)(),Wn.table(e,l)(),Wn.table(e+1,v)(),r&&r.log({logLevel:Lp,message:"Rendered to ".concat(r.id)}),Wn.groupEnd(Lp)()}}class nce{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:i,transformFeedback:r}=n;return{attributes:Object.assign({},i,e.attributes),transformFeedback:r}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],i=e?n[e]:null;return i?i instanceof $i?i:i.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,i=this.getBuffer(n);return i?i.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&Tn(bi(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,i={};if(this.bindings[this.currentIndex]&&Object.assign(i,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const r in this.feedbackMap){const o=this.feedbackMap[r];r in n&&(i[o]=r)}Object.assign(i,e.feedbackBuffers);for(const r in i){const o=i[r];if(typeof o=="string"){const l=n[o],{byteLength:s,usage:d,accessor:p}=l;i[r]=this._createNewBuffer(r,{byteLength:s,usage:d,accessor:p})}}return i}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const i=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:i})}_setupTransformFeedback(e,n){let{model:i}=n;const{program:r}=i;e.transformFeedback=new B9(this.gl,{program:r,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:i}=this._swapBuffers(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceBuffers:n,feedbackBuffers:i})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),i=Object.assign({},e.feedbackBuffers);for(const r in this.feedbackMap){const o=this.feedbackMap[r];n[r]=e.feedbackBuffers[o],i[o]=e.sourceBuffers[r],Tn(i[o]instanceof $i)}return{sourceBuffers:n,feedbackBuffers:i}}_createNewBuffer(e,n){const i=new $i(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=i,i}_getNextIndex(){return(this.currentIndex+1)%2}}const ice="transform_uSampler_",_w="transform_uSize_",P5="transform_position";function rce(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:i,targetTexture:r}=t,l=Object.keys(n).length,s=null;const d={};let p=e,y={};if(l>0||i){const v=p.split(`
`),w=v.slice();if(v.forEach((T,I,L)=>{if(l>0){const k=cce(T,n);if(k){const{updatedLine:F,inject:B}=k;w[I]=F,y=qA([y,B]),Object.assign(d,k.samplerTextureMap),l--}}i&&!s&&(s=lce(T,i))}),i){Tn(r);const T="".concat(_w).concat(i),I="uniform vec2 ".concat(T,`;
`),L="     vec2 ".concat(P5," = transform_getPos(").concat(T,`);
     gl_Position = vec4(`).concat(P5,`, 0, 1.);
`);y=qA([y,{"vs:#decl":I,"vs:#main-start":L}])}p=w.join(`
`)}return{vs:p,targetTextureType:s,inject:y,samplerTextureMap:d}}function oce(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:i}=t;const r={};let o,l;n&&({width:o,height:l}=i,r["".concat(_w).concat(n)]=[o,l]);for(const s in e)({width:o,height:l}=e[s]),r["".concat(_w).concat(s)]=[o,l];return r}function sce(t){return G9(t,["attribute","in"])}function ace(t){const e="".concat(ice).concat(t),n="".concat(_w).concat(t),i="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:i}}function lce(t,e){const n=G9(t,["varying","out"]);return n&&n.name===e?n.type:null}function cce(t,e){const n={},i=sce(t);if(!i)return null;const{type:r,name:o}=i;if(o&&e[o]){const l="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:s,sizeName:d,uniformDeclerations:p}=ace(o),y=uae(r),v="  ".concat(r," ").concat(o," = transform_getInput(").concat(s,", ").concat(d,").").concat(y,`;
`);return n[s]=o,{updatedLine:l,inject:{"vs:#decl":p,"vs:#main-start":v},samplerTextureMap:n}}return null}const uce={10241:9728,10240:9728,10242:33071,10243:33071},hce="transform_output";class dce{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:i,framebuffer:r,targetTexture:o}=this.bindings[this.currentIndex],l=Object.assign({},n,e.attributes),s=Object.assign({},e.uniforms),d=Object.assign({},e.parameters);let p=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){l.transform_elementID=this.elementIDBuffer;for(const v in this.samplerTextureMap){const w=this.samplerTextureMap[v];s[v]=i[w]}this._setSourceTextureParameters();const y=oce({sourceTextureMap:i,targetTextureVarying:this.targetTextureVarying,targetTexture:o});Object.assign(s,y)}return this.hasTargetTexture&&(p=!1,d.viewport=[0,0,r.width,r.height]),{attributes:l,framebuffer:r,uniforms:s,discard:p,parameters:d}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],i=b_(n);if(!e)return i;const r=i.constructor,o=hae(this.targetTextureType),l=new r(i.length*o/4);let s=0;for(let d=0;d<i.length;d+=4)for(let p=0;p<o;p++)l[s++]=i[d+p];return l}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:i}=e;this._swapTexture=i,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:i}=e;if(i instanceof ws)return i;const r=n[i];return r?(this._targetRefTexName=i,this._createNewTexture(r)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:i={},_targetTexture:r}=e,o=this._createTargetTexture({sourceTextures:i,textureOrReference:r});this.hasSourceTextures=this.hasSourceTextures||i&&Object.keys(i).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:i,targetTexture:o}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((i,r,o)=>{o[r]=r}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new $i(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:i}=this._swapTextures(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceTextures:n,targetTexture:i})}}_updateBinding(e,n){const{sourceBuffers:i,sourceTextures:r,targetTexture:o}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,r),Object.assign(e.sourceBuffers,i),o){e.targetTexture=o;const{width:l,height:s}=o,{framebuffer:d}=e;d?(d.update({attachments:{36064:o},resizeAttachments:!1}),d.resize({width:l,height:s})):e.framebuffer=new ko(this.gl,{id:"transform-framebuffer",width:l,height:s,attachments:{36064:o}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const i in n)n[i].setParameters(uce)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const i=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:i}}_createNewTexture(e){const n=ooe(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:i}=this.bindings[this.currentIndex],{vs:r,uniforms:o,targetTextureType:l,inject:s,samplerTextureMap:d}=rce({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:i}),p=qA([e.inject||{},s]);this.targetTextureType=l,this.samplerTextureMap=d;const y=e._fs||H9({version:D9(r),input:this.targetTextureVarying,inputType:l,output:hce}),v=this.hasSourceTextures||this.targetTextureVarying?[Xle].concat(e.modules||[]):e.modules;return{vs:r,fs:y,modules:v,uniforms:o,inject:p}}}let Bm=class{static isSupported(e){return bi(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:i}=this;e&&e.delete(),n&&n.delete(),i&&i.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,i=this._updateDrawOptions(e);n&&i.framebuffer&&i.framebuffer.clear({color:!0}),this.model.transform(i)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)e=e||i.swap();Tn(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n){const r=i.getData(e);if(r)return r}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)i.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new Il(n,Object.assign({},e,{fs:e.fs||H9({version:D9(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)n=r.updateModelProps(n);return n}_buildResourceTransforms(e,n){fce(n)&&(this.bufferTransform=new nce(e,n)),pce(n)&&(this.textureTransform=new dce(e,n)),Tn(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)n=Object.assign(n,r.getDrawOptions(n));return n}};function fce(t){return!!(!km(t.feedbackBuffers)||!km(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function pce(t){return!!(!km(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const I5={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class gc{static get DRAW_MODE(){return I5}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=dc("geometry"),drawMode:i=I5.TRIANGLES,attributes:r={},indices:o=null,vertexCount:l=null}=e;this.id=n,this.drawMode=i|0,this.attributes={},this.userData={},this._setAttributes(r,o),this.vertexCount=l||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const i in e){let r=e[i];r=ArrayBuffer.isView(r)?{value:r}:r,Tn(ArrayBuffer.isView(r.value),"".concat(this._print(i),": must be typed array or object with value as typed array")),(i==="POSITION"||i==="positions")&&!r.size&&(r.size=3),i==="indices"?(Tn(!this.indices),this.indices=r):this.attributes[i]=r}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let i=1/0;for(const r in e){const o=e[r],{value:l,size:s,constant:d}=o;!d&&l&&s>=1&&(i=Math.min(i,l.length/s))}return Tn(Number.isFinite(i)),i}}const mce=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),gce=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),yce=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),vce=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),_ce={POSITION:{size:3,value:new Float32Array(gce)},NORMAL:{size:3,value:new Float32Array(yce)},TEXCOORD_0:{size:2,value:new Float32Array(vce)}};class bce extends gc{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=dc("cube-geometry")}=e;super({...e,id:n,indices:{size:1,value:new Uint16Array(mce)},attributes:{..._ce,...e.attributes}})}}let xce=1,wce=1;class p7{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:i=Number.POSITIVE_INFINITY,rate:r=1,repeat:o=1}=e,l=xce++,s={time:0,delay:n,duration:i,rate:r,repeat:o};return this._setChannelTime(s,this.time),this.channels.set(l,s),l}removeChannel(e){this.channels.delete(e);for(const[n,i]of this.animations)i.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const r of n)this._setChannelTime(r,this.time);const i=this.animations.values();for(const r of i){const{animation:o,channel:l}=r;o.setTime(this.getTime(l))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const i=wce++;return this.animations.set(i,{animation:e,channel:n}),e.setTime(this.getTime(n)),i}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const i=n-e.delay,r=e.duration*e.repeat;i>=r?e.time=e.duration*e.rate:(e.time=Math.max(0,i)%e.duration,e.time*=e.rate)}}const Ece=[255,255,255],Tce=1;let Sce=0;class Cce{constructor(e={}){q(this,"id",void 0),q(this,"color",void 0),q(this,"intensity",void 0),q(this,"type","ambient");const{color:n=Ece}=e,{intensity:i=Tce}=e;this.id=e.id||"ambient-".concat(Sce++),this.color=n,this.intensity=i}}const Ace=[255,255,255],Pce=1,Ice=[0,0,-1];let Mce=0;class M5{constructor(e={}){q(this,"id",void 0),q(this,"color",void 0),q(this,"intensity",void 0),q(this,"type","directional"),q(this,"direction",void 0),q(this,"shadow",void 0);const{color:n=Ace}=e,{intensity:i=Pce}=e,{direction:r=Ice}=e,{_shadow:o=!1}=e;this.id=e.id||"directional-".concat(Mce++),this.color=n,this.intensity=i,this.type="directional",this.direction=new Mn(r).normalize().toArray(),this.shadow=o}getProjectedLight(e){return this}}class Rce{constructor(e,n={id:"pass"}){q(this,"id",void 0),q(this,"gl",void 0),q(this,"props",void 0);const{id:i}=n;this.id=i,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class GM extends Rce{constructor(...e){super(...e),q(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return nu(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:i,viewports:r,views:o,onViewportActive:l,clearStack:s=!0,clearCanvas:d=!0}=e;e.pass=e.pass||"unknown";const p=this.gl;d&&Oce(p,n),s&&(this._lastRenderIndex=-1);const y=[];for(const v of r){const w=o&&o[v.id];l==null||l(v);const T=this._getDrawLayerParams(v,e),I=v.subViewports||[v];for(const L of I){const k=this._drawLayersInViewport(p,{target:n,moduleParameters:i,viewport:L,view:w,pass:e.pass,layers:e.layers},T);y.push(k)}}return y}_getDrawLayerParams(e,{layers:n,pass:i,isPicking:r=!1,layerFilter:o,cullRect:l,effects:s,moduleParameters:d},p=!1){const y=[],v=m7(this._lastRenderIndex+1),w={layer:n[0],viewport:e,isPicking:r,renderPass:i,cullRect:l},T={};for(let I=0;I<n.length;I++){const L=n[I],k=this._shouldDrawLayer(L,w,o,T),F={shouldDrawLayer:k};k&&!p&&(F.layerRenderIndex=v(L,k),F.moduleParameters=this._getModuleParameters(L,s,i,d),F.layerParameters=this.getLayerParameters(L,I,e)),y[I]=F}return y}_drawLayersInViewport(e,{layers:n,moduleParameters:i,pass:r,target:o,viewport:l,view:s},d){const p=Lce(e,{moduleParameters:i,target:o,viewport:l});if(s&&s.props.clear){const v=s.props.clear===!0?{color:!0,depth:!0}:s.props.clear;Ga(e,{scissorTest:!0,scissor:p},()=>kM(e,v))}const y={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};nu(e,{viewport:p});for(let v=0;v<n.length;v++){const w=n[v],{shouldDrawLayer:T,layerRenderIndex:I,moduleParameters:L,layerParameters:k}=d[v];if(T&&w.props.pickable&&y.pickableCount++,w.isComposite)y.compositeCount++;else if(T){y.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,I),L.viewport=l;try{w._drawLayer({moduleParameters:L,uniforms:{layerIndex:I},parameters:k})}catch(F){w.raiseError(F,"drawing ".concat(w," to ").concat(r))}}}return y}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,i){return e.props.parameters}_shouldDrawLayer(e,n,i,r){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let l=e.parent;for(;l;){if(!l.props.visible||!l.filterSubLayer(n))return!1;n.layer=l,l=l.parent}if(i){const s=n.layer.id;if(s in r||(r[s]=i(n)),!r[s])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,i,r){var o;const l=Object.assign(Object.create(((o=e.internalState)===null||o===void 0?void 0:o.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:cf(this.gl)});if(n)for(const d of n){var s;Object.assign(l,(s=d.getModuleParameters)===null||s===void 0?void 0:s.call(d,e))}return Object.assign(l,this.getModuleParameters(e,n),r)}}function m7(t=0,e={}){const n={},i=(r,o)=>{const l=r.props._offset,s=r.id,d=r.parent&&r.parent.id;let p;if(d&&!(d in e)&&i(r.parent,!1),d in n){const y=n[d]=n[d]||m7(e[d],e);p=y(r,o),n[s]=y}else Number.isFinite(l)?(p=l+(e[d]||0),n[s]=null):p=t;return o&&p>=t&&(t=p+1),e[s]=p,p};return i}function Lce(t,{moduleParameters:e,target:n,viewport:i}){const r=n&&n.id!=="default-framebuffer",o=e&&e.devicePixelRatio||cf(t),l=r?n.height:t.drawingBufferHeight,s=i;return[s.x*o,l-(s.y+s.height)*o,s.width*o,s.height*o]}function Oce(t,e){const n=e?e.width:t.drawingBufferWidth,i=e?e.height:t.drawingBufferHeight;nu(t,{viewport:[0,0,n,i]}),t.clear(16640)}class Dce extends GM{constructor(e,n){super(e,n),q(this,"shadowMap",void 0),q(this,"depthBuffer",void 0),q(this,"fbo",void 0),this.shadowMap=new ws(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new Zp(e,{format:33189,width:1,height:1}),this.fbo=new ko(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const n=this.fbo;Ga(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const i=e.viewports[0],r=cf(this.gl),o=i.width*r,l=i.height*r;(o!==n.width||l!==n.height)&&n.resize({width:o,height:l}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const g7="#define SMOOTH_EDGE_RADIUS 0.5",kce=`
`.concat(g7,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),Fce=`
`.concat(g7,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),Bce={name:"geometry",vs:kce,fs:Fce},zce=Object.keys(Li).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(Li[t],";")).join(""),Nce=Object.keys(xl).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(xl[t],";")).join(""),Uce=Object.keys(Al).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(Al[t],";")).join(""),Vce="".concat(zce,`
`).concat(Nce,`
`).concat(Uce,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}
vec3 project_normal(vec3 vector) {
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world.xyz -= project_uCoordinateOrigin;
  }
  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function jce(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}return!1}function E_(t){let e={},n;return i=>{for(const r in i)if(!jce(i[r],e[r])){n=t(i),e=i;break}return n}}const R5=[0,0,0,0],$ce=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],y7=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Gce=[0,0,0],v7=[0,0,0],Hce=E_(Xce);function _7(t,e,n=v7){n.length<3&&(n=[n[0],n[1],0]);let i=n,r,o=!0;switch(e===Li.LNGLAT_OFFSETS||e===Li.METER_OFFSETS?r=n:r=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case xl.WEB_MERCATOR:(e===Li.LNGLAT||e===Li.CARTESIAN)&&(r=[0,0,0],o=!1);break;case xl.WEB_MERCATOR_AUTO_OFFSET:e===Li.LNGLAT?i=r:e===Li.CARTESIAN&&(i=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],r=t.unprojectPosition(i),i[0]-=n[0],i[1]-=n[1],i[2]-=n[2]);break;case xl.IDENTITY:i=t.position.map(Math.fround),i[2]=i[2]||0;break;case xl.GLOBE:o=!1,r=null;break;default:o=!1}return{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:o}}function Wce(t,e,n){const{viewMatrixUncentered:i,projectionMatrix:r}=t;let{viewMatrix:o,viewProjectionMatrix:l}=t,s=R5,d=R5,p=t.cameraPosition;const{geospatialOrigin:y,shaderCoordinateOrigin:v,offsetMode:w}=_7(t,e,n);return w&&(d=t.projectPosition(y||v),p=[p[0]-d[0],p[1]-d[1],p[2]-d[2]],d[3]=1,s=tg([],d,l),o=i||o,l=Jd([],r,o),l=Jd([],l,$ce)),{viewMatrix:o,viewProjectionMatrix:l,projectionCenter:s,originCommon:d,cameraPosCommon:p,shaderCoordinateOrigin:v,geospatialOrigin:y}}function Kce({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:i=Li.DEFAULT,coordinateOrigin:r=v7,autoWrapLongitude:o=!1}){i===Li.DEFAULT&&(i=t.isGeospatial?Li.LNGLAT:Li.CARTESIAN);const l=Hce({viewport:t,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:r});return l.project_uWrapLongitude=o,l.project_uModelMatrix=n||y7,l}function Xce({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:i}){const{projectionCenter:r,viewProjectionMatrix:o,originCommon:l,cameraPosCommon:s,shaderCoordinateOrigin:d,geospatialOrigin:p}=Wce(t,n,i),y=t.getDistanceScales(),v=[t.width*e,t.height*e],w=tg([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,T={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:d,project_uCommonOrigin:l.slice(0,3),project_uCenter:r,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:v,project_uDevicePixelRatio:e,project_uFocalDistance:w,project_uCommonUnitsPerMeter:y.unitsPerMeter,project_uCommonUnitsPerWorldUnit:y.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:Gce,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:o,project_uModelMatrix:y7,project_uCameraPosition:s};if(p){const I=t.getDistanceScales(p);switch(n){case Li.METER_OFFSETS:T.project_uCommonUnitsPerWorldUnit=I.unitsPerMeter,T.project_uCommonUnitsPerWorldUnit2=I.unitsPerMeter2;break;case Li.LNGLAT:case Li.LNGLAT_OFFSETS:t._pseudoMeters||(T.project_uCommonUnitsPerMeter=I.unitsPerMeter),T.project_uCommonUnitsPerWorldUnit=I.unitsPerDegree,T.project_uCommonUnitsPerWorldUnit2=I.unitsPerDegree2;break;case Li.CARTESIAN:T.project_uCommonUnitsPerWorldUnit=[1,1,I.unitsPerMeter[2]],T.project_uCommonUnitsPerWorldUnit2=[0,0,I.unitsPerMeter2[2]];break}}return T}const Zce={};function qce(t=Zce){return"viewport"in t?Kce(t):{}}const HM={name:"project",dependencies:[pae,Bce],vs:Vce,getUniforms:qce};function Yce(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function gm(t,e){const n=tg([],e,t);return $M(n,n,1/n[3]),n}function L5(t,e){const n=t%e;return n<0?e+n:n}function nP(t,e,n){return t<e?e:t>n?n:t}function Jce(t){return Math.log(t)*Math.LOG2E}const WM=Math.log2||Jce;function iu(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const wl=Math.PI,b7=wl/4,Ha=wl/180,iP=180/wl,zm=512,bw=4003e4,Fb=85.051129,Qce=1.5;function eue(t){return WM(t)}function Fh(t){const[e,n]=t;iu(Number.isFinite(e)),iu(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const i=e*Ha,r=n*Ha,o=zm*(i+wl)/(2*wl),l=zm*(wl+Math.log(Math.tan(b7+r*.5)))/(2*wl);return[o,l]}function Nm(t){const[e,n]=t,i=e/zm*(2*wl)-wl,r=2*(Math.atan(Math.exp(n/zm*(2*wl)-wl))-b7);return[i*iP,r*iP]}function tue(t){const{latitude:e}=t;iu(Number.isFinite(e));const n=Math.cos(e*Ha);return eue(bw*n)-9}function qS(t){const e=Math.cos(t*Ha);return zm/bw/e}function rP(t){const{latitude:e,longitude:n,highPrecision:i=!1}=t;iu(Number.isFinite(e)&&Number.isFinite(n));const r=zm,o=Math.cos(e*Ha),l=r/360,s=l/o,d=r/bw/o,p={unitsPerMeter:[d,d,d],metersPerUnit:[1/d,1/d,1/d],unitsPerDegree:[l,s,d],degreesPerUnit:[1/l,1/s,1/d]};if(i){const y=Ha*Math.tan(e*Ha)/o,v=l*y/2,w=r/bw*y,T=w/s*d;p.unitsPerDegree2=[0,v,w],p.unitsPerMeter2=[T,0,T]}return p}function x7(t,e){const[n,i,r]=t,[o,l,s]=e,{unitsPerMeter:d,unitsPerMeter2:p}=rP({longitude:n,latitude:i,highPrecision:!0}),y=Fh(t);y[0]+=o*(d[0]+p[0]*l),y[1]+=l*(d[1]+p[1]*l);const v=Nm(y),w=(r||0)+(s||0);return Number.isFinite(r)||Number.isFinite(s)?[v[0],v[1],w]:v}function nue(t){const{height:e,pitch:n,bearing:i,altitude:r,scale:o,center:l}=t,s=Yce();vw(s,s,[0,0,-r]),i7(s,s,-n*Ha),r7(s,s,i*Ha);const d=o/e;return jM(s,s,[d,d,d]),l&&vw(s,s,Rae([],l)),s}function iue(t){const{width:e,height:n,altitude:i,pitch:r=0,offset:o,center:l,scale:s,nearZMultiplier:d=1,farZMultiplier:p=1}=t;let{fovy:y=xw(Qce)}=t;i!==void 0&&(y=xw(i));const v=y*Ha,w=r*Ha,T=w7(y);let I=T;l&&(I+=l[2]*s/Math.cos(w)/n);const L=v*(.5+(o?o[1]:0)/n),k=Math.sin(L)*I/Math.sin(nP(Math.PI/2-w-L,.01,Math.PI-.01)),F=Math.sin(w)*k+I,B=I*10,G=Math.min(F*p,B);return{fov:v,aspect:e/n,focalDistance:T,near:d,far:G}}function xw(t){return 2*Math.atan(.5/t)*iP}function w7(t){return .5/Math.tan(.5*t*Ha)}function E7(t,e){const[n,i,r=0]=t;return iu(Number.isFinite(n)&&Number.isFinite(i)&&Number.isFinite(r)),gm(e,[n,i,r,1])}function KM(t,e,n=0){const[i,r,o]=t;if(iu(Number.isFinite(i)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(o))return gm(e,[i,r,o,1]);const l=gm(e,[i,r,0,1]),s=gm(e,[i,r,1,1]),d=l[2],p=s[2],y=d===p?0:((n||0)-d)/(p-d);return K9([],l,s,y)}function rue(t){const{width:e,height:n,bounds:i,minExtent:r=0,maxZoom:o=24,offset:l=[0,0]}=t,[[s,d],[p,y]]=i,v=oue(t.padding),w=Fh([s,nP(y,-Fb,Fb)]),T=Fh([p,nP(d,-Fb,Fb)]),I=[Math.max(Math.abs(T[0]-w[0]),r),Math.max(Math.abs(T[1]-w[1]),r)],L=[e-v.left-v.right-Math.abs(l[0])*2,n-v.top-v.bottom-Math.abs(l[1])*2];iu(L[0]>0&&L[1]>0);const k=L[0]/I[0],F=L[1]/I[1],B=(v.right-v.left)/2/k,G=(v.top-v.bottom)/2/F,U=[(T[0]+w[0])/2+B,(T[1]+w[1])/2+G],ee=Nm(U),ne=Math.min(o,WM(Math.abs(Math.min(k,F))));return iu(Number.isFinite(ne)),{longitude:ee[0],latitude:ee[1],zoom:ne}}function oue(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(iu(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const O5=Math.PI/180;function sue(t,e=0){const{width:n,height:i,unproject:r}=t,o={targetZ:e},l=r([0,i],o),s=r([n,i],o);let d,p;const y=t.fovy?.5*t.fovy*O5:Math.atan(.5/t.altitude),v=(90-t.pitch)*O5;return y>v-.01?(d=D5(t,0,e),p=D5(t,n,e)):(d=r([0,0],o),p=r([n,0],o)),[l,s,p,d]}function D5(t,e,n){const{pixelUnprojectionMatrix:i}=t,r=gm(i,[e,0,1,1]),o=gm(i,[e,t.height,1,1]),s=(n*t.distanceScales.unitsPerMeter[2]-r[2])/(o[2]-r[2]),d=K9([],r,o,s),p=Nm(d);return p.push(n),p}const k5=512;function aue(t){const{width:e,height:n,pitch:i=0}=t;let{longitude:r,latitude:o,zoom:l,bearing:s=0}=t;(r<-180||r>180)&&(r=L5(r+180,360)-180),(s<-180||s>180)&&(s=L5(s+180,360)-180);const d=WM(n/k5);if(l<=d)l=d,o=0;else{const p=n/2/Math.pow(2,l),y=Nm([0,p])[1];if(o<y)o=y;else{const v=Nm([0,k5-p])[1];o>v&&(o=v)}}return{width:e,height:n,longitude:r,latitude:o,zoom:l,pitch:i,bearing:s}}const lue=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,cue=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,uue=E_(mue),hue=E_(gue),due=[0,0,0,1],fue=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function pue(t,e){const[n,i,r]=t,o=KM([n,i,r],e);return Number.isFinite(r)?o:[o[0],o[1],0]}function mue({viewport:t,center:e}){return new Js(t.viewProjectionMatrix).invert().transform(e)}function gue({viewport:t,shadowMatrices:e}){const n=[],i=t.pixelUnprojectionMatrix,r=t.isGeospatial?void 0:1,o=[[0,0,r],[t.width,0,r],[0,t.height,r],[t.width,t.height,r],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(l=>pue(l,i));for(const l of e){const s=l.clone().translate(new Mn(t.center).negate()),d=o.map(y=>s.transform(y)),p=new Js().ortho({left:Math.min(...d.map(y=>y[0])),right:Math.max(...d.map(y=>y[0])),bottom:Math.min(...d.map(y=>y[1])),top:Math.max(...d.map(y=>y[1])),near:Math.min(...d.map(y=>-y[2])),far:Math.max(...d.map(y=>-y[2]))});n.push(p.multiplyRight(l))}return n}function yue(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const i={shadow_uDrawShadowMap:!!t.drawToShadowMap,shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||due,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},r=uue({viewport:t.viewport,center:e.project_uCenter}),o=[],l=hue({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let s=0;s<t.shadowMatrices.length;s++){const d=l[s],p=d.clone().translate(new Mn(t.viewport.center).negate());e.project_uCoordinateSystem===Li.LNGLAT&&e.project_uProjectionMode===xl.WEB_MERCATOR?(l[s]=p,o[s]=r):(l[s]=d.clone().multiplyRight(fue),o[s]=p.transform(r))}for(let s=0;s<l.length;s++)i["shadow_uViewProjectionMatrices[".concat(s,"]")]=l[s],i["shadow_uProjectCenters[".concat(s,"]")]=o[s],t.shadowMaps&&t.shadowMaps.length>0?i["shadow_uShadowMap".concat(s)]=t.shadowMaps[s]:i["shadow_uShadowMap".concat(s)]=t.dummyShadowMap;return i}const YS={name:"shadow",dependencies:[HM],vs:lue,fs:cue,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?yue(t,e):{}},vue={color:[255,255,255],intensity:1},F5=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],_ue=[0,0,0,200/255];class T7{constructor(e={}){q(this,"id","lighting-effect"),q(this,"props",void 0),q(this,"shadowColor",_ue),q(this,"shadow",void 0),q(this,"ambientLight",void 0),q(this,"directionalLights",void 0),q(this,"pointLights",void 0),q(this,"shadowPasses",[]),q(this,"shadowMaps",[]),q(this,"dummyShadowMap",null),q(this,"programManager",void 0),q(this,"shadowMatrices",void 0),this.setProps(e)}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const n in e){const i=e[n];switch(i.type){case"ambient":this.ambientLight=i;break;case"directional":this.directionalLights.push(i);break;case"point":this.pointLights.push(i);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.props=e}preRender(e,{layers:n,layerFilter:i,viewports:r,onViewportActive:o,views:l}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=w_.getDefaultProgramManager(e),YS&&this.programManager.addDefaultModule(YS)),this.dummyShadowMap||(this.dummyShadowMap=new ws(e,{width:1,height:1}));for(let s=0;s<this.shadowPasses.length;s++)this.shadowPasses[s].render({layers:n,layerFilter:i,viewports:r,onViewportActive:o,views:l,moduleParameters:{shadowLightId:s,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(i=>i.getProjectedLight({layer:e})),pointLights:this.pointLights.map(i=>i.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(YS),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const i=new Js().lookAt({eye:new Mn(n.direction).negate()});e.push(i)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const i=new Dce(e);this.shadowPasses[n]=i,this.shadowMaps[n]=i.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:i}=this;!e&&n.length===0&&i.length===0&&(this.ambientLight=new Cce(vue),this.directionalLights.push(new M5(F5[0]),new M5(F5[1])))}}class bue{constructor(e={}){q(this,"_pool",[]),q(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:i=1,type:r,padding:o=0,copy:l=!1,initialize:s=!1,maxCount:d}){const p=r||e&&e.constructor||Float32Array,y=n*i+o;if(ArrayBuffer.isView(e)){if(y<=e.length)return e;if(y*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new p(e.buffer,0,y)}let v=1/0;d&&(v=d*i+o);const w=this._allocate(p,y,s,v);return e&&l?w.set(e):s||w.fill(0,0,4),this._release(e),w}release(e){this._release(e)}_allocate(e,n,i,r){let o=Math.max(Math.ceil(n*this.opts.overAlloc),1);o>r&&(o=r);const l=this._pool,s=e.BYTES_PER_ELEMENT*o,d=l.findIndex(p=>p.byteLength>=s);if(d>=0){const p=new e(l.splice(d,1)[0],0,o);return i&&p.fill(0),p}return new e(o)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:i}=e,{byteLength:r}=i,o=n.findIndex(l=>l.byteLength>=r);o<0?n.push(i):(o>0||n.length<this.opts.poolSize)&&n.splice(o,0,i),n.length>this.opts.poolSize&&n.shift()}}const Um=new bue;function r0(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function xue(t){return[t[12],t[13],t[14]]}function wue(t){return{left:Op(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:Op(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:Op(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:Op(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:Op(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:Op(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const B5=new Mn;function Op(t,e,n,i){B5.set(t,e,n);const r=B5.len();return{distance:i/r,normal:new Mn(-t/r,-e/r,-n/r)}}function Eue(t){return t-Math.fround(t)}let Dy;function JS(t,e){const{size:n=1,startIndex:i=0}=e,r=e.endIndex!==void 0?e.endIndex:t.length,o=(r-i)/n;Dy=Um.allocate(Dy,o,{type:Float32Array,size:n*2});let l=i,s=0;for(;l<r;){for(let d=0;d<n;d++){const p=t[l++];Dy[s+d]=p,Dy[s+d+n]=Eue(p)}s+=n*2}return Dy.subarray(0,o*n*2)}function Tue(t){let e=null,n=!1;for(const i of t)i&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],i[0][0]),e[0][1]=Math.min(e[0][1],i[0][1]),e[1][0]=Math.max(e[1][0],i[1][0]),e[1][1]=Math.max(e[1][1],i[1][1])):e=i);return e}const Sue=Math.PI/180,Cue=r0(),z5=[0,0,0],Aue={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function Pue({width:t,height:e,orthographic:n,fovyRadians:i,focalDistance:r,padding:o,near:l,far:s}){const d=t/e,p=n?new Js().orthographic({fovy:i,aspect:d,focalDistance:r,near:l,far:s}):new Js().perspective({fovy:i,aspect:d,near:l,far:s});if(o){const{left:y=0,right:v=0,top:w=0,bottom:T=0}=o,I=yh((y+t-v)/2,0,t)-t/2,L=yh((w+e-T)/2,0,e)-e/2;p[8]-=I*2/t,p[9]+=L*2/e}return p}class Sf{constructor(e={}){q(this,"id",void 0),q(this,"x",void 0),q(this,"y",void 0),q(this,"width",void 0),q(this,"height",void 0),q(this,"padding",void 0),q(this,"isGeospatial",void 0),q(this,"zoom",void 0),q(this,"focalDistance",void 0),q(this,"position",void 0),q(this,"modelMatrix",void 0),q(this,"distanceScales",void 0),q(this,"scale",void 0),q(this,"center",void 0),q(this,"cameraPosition",void 0),q(this,"projectionMatrix",void 0),q(this,"viewMatrix",void 0),q(this,"viewMatrixUncentered",void 0),q(this,"viewMatrixInverse",void 0),q(this,"viewProjectionMatrix",void 0),q(this,"pixelProjectionMatrix",void 0),q(this,"pixelUnprojectionMatrix",void 0),q(this,"resolution",void 0),q(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||Aue,this.focalDistance=e.focalDistance||1,this.position=e.position||z5,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:i}=e;this.isGeospatial=Number.isFinite(i)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?xl.WEB_MERCATOR:xl.WEB_MERCATOR_AUTO_OFFSET:xl.IDENTITY}equals(e){return e instanceof Sf?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&qc(e.projectionMatrix,this.projectionMatrix)&&qc(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const i=this.projectPosition(e),r=E7(i,this.pixelProjectionMatrix),[o,l]=r,s=n?l:this.height-l;return e.length===2?[o,s]:[o,s,r[2]]}unproject(e,{topLeft:n=!0,targetZ:i}={}){const[r,o,l]=e,s=n?o:this.height-o,d=i&&i*this.distanceScales.unitsPerMeter[2],p=KM([r,s,l],this.pixelUnprojectionMatrix,d),[y,v,w]=this.unprojectPosition(p);return Number.isFinite(l)?[y,v,w]:Number.isFinite(i)?[y,v,i]:[y,v]}projectPosition(e){const[n,i]=this.projectFlat(e),r=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,i,r]}unprojectPosition(e){const[n,i]=this.unprojectFlat(e),r=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,i,r]}projectFlat(e){if(this.isGeospatial){const n=Fh(e);return n[1]=yh(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?Nm(e):e}getBounds(e={}){const n={targetZ:e.z||0},i=this.unproject([0,0],n),r=this.unproject([this.width,0],n),o=this.unproject([0,this.height],n),l=this.unproject([this.width,this.height],n);return[Math.min(i[0],r[0],o[0],l[0]),Math.min(i[1],r[1],o[1],l[1]),Math.max(i[0],r[0],o[0],l[0]),Math.max(i[1],r[1],o[1],l[1])]}getDistanceScales(e){return e?rP({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:i=1,height:r=1}){return e<this.x+this.width&&this.x<e+i&&n<this.y+this.height&&this.y<n+r}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,wue(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,i=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=tue({latitude:i})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||rP({latitude:i,longitude:n}));const r=Math.pow(2,this.zoom);this.scale=r;const{position:o,modelMatrix:l}=e;let s=z5;if(o&&(s=l?new Js(l).transformAsVector(o,[]):o),this.isGeospatial){const d=this.projectPosition([n,i,0]);this.center=new Mn(s).scale(this.distanceScales.unitsPerMeter).add(d)}else this.center=this.projectPosition(s)}_initMatrices(e){const{viewMatrix:n=Cue,projectionMatrix:i=null,orthographic:r=!1,fovyRadians:o,fovy:l=75,near:s=.1,far:d=1e3,padding:p=null,focalDistance:y=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new Js().multiplyRight(n).translate(new Mn(this.center).negate()),this.projectionMatrix=i||Pue({width:this.width,height:this.height,orthographic:r,fovyRadians:o||l*Sue,focalDistance:y,padding:p,near:s,far:d});const v=r0();Jd(v,v,this.projectionMatrix),Jd(v,v,this.viewMatrix),this.viewProjectionMatrix=v,this.viewMatrixInverse=eP([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=xue(this.viewMatrixInverse);const w=r0(),T=r0();jM(w,w,[this.width/2,-this.height/2,1]),vw(w,w,[1,-1,0]),Jd(T,w,this.viewProjectionMatrix),this.pixelProjectionMatrix=T,this.pixelUnprojectionMatrix=eP(r0(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Ti.warn("Pixel project matrix not invertible")()}}q(Sf,"displayName","Viewport");class Bh extends Sf{constructor(e={}){const{latitude:n=0,longitude:i=0,zoom:r=0,pitch:o=0,bearing:l=0,nearZMultiplier:s=.1,farZMultiplier:d=1.01,nearZ:p,farZ:y,orthographic:v=!1,projectionMatrix:w,repeat:T=!1,worldOffset:I=0,position:L,padding:k,legacyMeterSizes:F=!1}=e;let{width:B,height:G,altitude:U=1.5}=e;const ee=Math.pow(2,r);B=B||1,G=G||1;let ne,ye=null;if(w)U=w[5]/2,ne=xw(U);else{e.fovy?(ne=e.fovy,U=w7(ne)):ne=xw(U);let J;if(k){const{top:Ce=0,bottom:me=0}=k;J=[0,yh((Ce+G-me)/2,0,G)-G/2]}ye=iue({width:B,height:G,scale:ee,center:L&&[0,0,L[2]*qS(n)],offset:J,pitch:o,fovy:ne,nearZMultiplier:s,farZMultiplier:d}),Number.isFinite(p)&&(ye.near=p),Number.isFinite(y)&&(ye.far=y)}let fe=nue({height:G,pitch:o,bearing:l,scale:ee,altitude:U});I&&(fe=new Js().translate([512*I,0,0]).multiplyLeft(fe)),super({...e,width:B,height:G,viewMatrix:fe,longitude:i,latitude:n,zoom:r,...ye,fovy:ne,focalDistance:U}),q(this,"longitude",void 0),q(this,"latitude",void 0),q(this,"pitch",void 0),q(this,"bearing",void 0),q(this,"altitude",void 0),q(this,"fovy",void 0),q(this,"orthographic",void 0),q(this,"_subViewports",void 0),q(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=i,this.zoom=r,this.pitch=o,this.bearing=l,this.altitude=U,this.fovy=ne,this.orthographic=v,this._subViewports=T?[]:null,this._pseudoMeters=F,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),i=Math.ceil((e[2]-180)/360);for(let r=n;r<=i;r++){const o=r?new Bh({...this,worldOffset:r}):this;this._subViewports.push(o)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,i]=this.projectFlat(e),r=(e[2]||0)*qS(e[1]);return[n,i,r]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,i]=this.unprojectFlat(e),r=(e[2]||0)/qS(i);return[n,i,r]}addMetersToLngLat(e,n){return x7(e,n)}panByPosition(e,n){const i=KM(n,this.pixelUnprojectionMatrix),r=this.projectFlat(e),o=v5([],r,wae([],i)),l=v5([],this.center,o),[s,d]=this.unprojectFlat(l);return{longitude:s,latitude:d}}getBounds(e={}){const n=sue(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:i,height:r}=this,{longitude:o,latitude:l,zoom:s}=rue({width:i,height:r,bounds:e,...n});return new Bh({width:i,height:r,longitude:o,latitude:l,zoom:s})}}q(Bh,"displayName","WebMercatorViewport");const N5=[0,0,0];function QS(t,e,n=!1){const i=e.projectPosition(t);if(n&&e instanceof Bh){const[r,o,l=0]=t,s=e.getDistanceScales([r,o]);i[2]=l*s.unitsPerMeter[2]}return i}function Iue(t){const{viewport:e,modelMatrix:n,coordinateOrigin:i}=t;let{coordinateSystem:r,fromCoordinateSystem:o,fromCoordinateOrigin:l}=t;return r===Li.DEFAULT&&(r=e.isGeospatial?Li.LNGLAT:Li.CARTESIAN),o===void 0&&(o=r),l===void 0&&(l=i),{viewport:e,coordinateSystem:r,coordinateOrigin:i,modelMatrix:n,fromCoordinateSystem:o,fromCoordinateOrigin:l}}function S7(t,{viewport:e,modelMatrix:n,coordinateSystem:i,coordinateOrigin:r,offsetMode:o}){let[l,s,d=0]=t;switch(n&&([l,s,d]=tg([],[l,s,d,1],n)),i){case Li.LNGLAT:return QS([l,s,d],e,o);case Li.LNGLAT_OFFSETS:return QS([l+r[0],s+r[1],d+(r[2]||0)],e,o);case Li.METER_OFFSETS:return QS(x7(r,[l,s,d]),e,o);case Li.CARTESIAN:default:return e.isGeospatial?[l+r[0],s+r[1],d+r[2]]:e.projectPosition([l,s,d])}}function Mue(t,e){const{viewport:n,coordinateSystem:i,coordinateOrigin:r,modelMatrix:o,fromCoordinateSystem:l,fromCoordinateOrigin:s}=Iue(e),{autoOffset:d=!0}=e,{geospatialOrigin:p=N5,shaderCoordinateOrigin:y=N5,offsetMode:v=!1}=d?_7(n,i,r):{},w=S7(t,{viewport:n,modelMatrix:o,coordinateSystem:l,coordinateOrigin:s,offsetMode:v});if(v){const T=n.projectPosition(p||y);e7(w,w,T)}return w}const U5={blendFunc:[1,0,32771,0],blendEquation:32774};class C7 extends GM{constructor(...e){super(...e),q(this,"pickZ",void 0),q(this,"_colorEncoderState",null)}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:i,viewports:r,onViewportActive:o,pickingFBO:l,deviceRect:{x:s,y:d,width:p,height:y},cullRect:v,effects:w,pass:T="picking",pickZ:I,moduleParameters:L}){const k=this.gl;this.pickZ=I;const F=this._resetColorEncoder(I),B=Ga(k,{scissorTest:!0,scissor:[s,d,p,y],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...U5,blend:!I},()=>super.render({target:l,layers:e,layerFilter:n,views:i,viewports:r,onViewportActive:o,cullRect:v,effects:w==null?void 0:w.filter(U=>U.useInPicking),pass:T,isPicking:!0,moduleParameters:L}));return this._colorEncoderState=null,{decodePickingColor:F&&Lue.bind(null,F),stats:B}}shouldDrawLayer(e){const{pickable:n,operation:i}=e.props;return n&&i.includes("draw")||i.includes("terrain")||i.includes("mask")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,i){const r={...e.props.parameters},{pickable:o,operation:l}=e.props;return this._colorEncoderState?o&&l.includes("draw")&&(Object.assign(r,U5),r.blend=!0,r.blendColor=Rue(this._colorEncoderState,e,i)):r.blend=!1,l.includes("terrain")&&(r.blend=!1),r}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function Rue(t,e,n){const{byLayer:i,byAlpha:r}=t;let o,l=i.get(e);return l?(l.viewports.push(n),o=l.a):(o=i.size+1,o<=255?(l={a:o,layer:e,viewports:[n]},i.set(e,l),r[o]=l):(Ti.warn("Too many pickable layers, only picking the first 255")(),o=0)),[0,0,0,o/255]}function Lue(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const Gp={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},ww=Symbol.for("component"),Sh=Symbol.for("propTypes"),eC=Symbol.for("deprecatedProps"),ym=Symbol.for("asyncPropDefaults"),df=Symbol.for("asyncPropOriginal"),vh=Symbol.for("asyncPropResolved");function F2(t,e=()=>!0){return Array.isArray(t)?A7(t,e,[]):e(t)?[t]:[]}function A7(t,e,n){let i=-1;for(;++i<t.length;){const r=t[i];Array.isArray(r)?A7(r,e,n):e(r)&&n.push(r)}return n}function Oue({target:t,source:e,start:n=0,count:i=1}){const r=e.length,o=i*r;let l=0;for(let s=n;l<r;l++)t[s++]=e[l];for(;l<o;)l<o-l?(t.copyWithin(n+l,n,n+l),l*=2):(t.copyWithin(n+l,n,n+o-l),l=o);return t}class Due{constructor(e,n,i){q(this,"id",void 0),q(this,"context",void 0),q(this,"isLoaded",void 0),q(this,"persistent",void 0),q(this,"_loadCount",0),q(this,"_subscribers",new Set),q(this,"_data",void 0),q(this,"_loader",void 0),q(this,"_error",void 0),q(this,"_content",void 0),this.id=e,this.context=i,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const i=++this._loadCount;let r=e;typeof e=="string"&&(r=mv(e)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then(o=>{this._loadCount===i&&(this.isLoaded=!0,this._error=void 0,this._content=o)}).catch(o=>{this._loadCount===i&&(this.isLoaded=!0,this._error=o||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const o of this._subscribers)o.onChange(this.getData())}}class kue{constructor({gl:e,protocol:n}){q(this,"protocol",void 0),q(this,"_context",void 0),q(this,"_resources",void 0),q(this,"_consumers",void 0),q(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:i=!1,persistent:r=!0}){let o=this._resources[e];o?o.setData(n,i):(o=new Due(e,n,this._context),this._resources[e]=o),o.persistent=r}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const i in n){const r=n[i],o=this._resources[r.resourceId];o&&o.unsubscribe(r)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:i,requestId:r="default"}){const{_resources:o,protocol:l}=this;e.startsWith(l)&&(e=e.replace(l,""),o[e]||this.add({resourceId:e,data:null,persistent:!1}));const s=o[e];if(this._track(i,r,s,n),s)return s.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,i,r){const o=this._consumers,l=o[e]=o[e]||{},s=l[n]||{},d=s.resourceId&&this._resources[s.resourceId];d&&(d.unsubscribe(s),this.prune()),i&&(l[n]=s,s.onChange=r,s.resourceId=i.id,i.subscribe(s))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const Fue=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,pu={name:"project32",dependencies:[HM],vs:Fue},$h={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:#decl":`
uniform bool picking_uAttribute;
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...$le},Bue=[HM],zue=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function Nue(t){const e=w_.getDefaultProgramManager(t);for(const n of Bue)e.addDefaultModule(n);for(const n of zue)e.addShaderHook(n);return e}const Uue="layerManager.setLayers",jue="layerManager.activateViewport";class $ue{constructor(e,{deck:n,stats:i,viewport:r,timeline:o}={}){q(this,"layers",void 0),q(this,"context",void 0),q(this,"resourceManager",void 0),q(this,"_lastRenderedLayers",[]),q(this,"_needsRedraw",!1),q(this,"_needsUpdate",!1),q(this,"_nextLayers",null),q(this,"_debug",!1),q(this,"activateViewport",l=>{ms(jue,this,l),l&&(this.context.viewport=l)}),this.layers=[],this.resourceManager=new kue({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&Nue(e),stats:i||new OM({id:"deck.gl"}),viewport:r||new Sf({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:o||new p7,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const i of this.layers){const r=i.getNeedsRedraw(e);n=n||r}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(i=>n.id.indexOf(i)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){ms(Uue,this,n,e),this._lastRenderedLayers=e;const i=F2(e,Boolean);for(const r of i)r.context=this.context;this._updateLayers(this.layers,i)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,i){i.raiseError(n,"".concat(e," of ").concat(i))}_updateLayers(e,n){const i={};for(const l of e)i[l.id]?Ti.warn("Multiple old layers with same id ".concat(l.id))():i[l.id]=l;const r=[];this._updateSublayersRecursively(n,i,r),this._finalizeOldLayers(i);let o=!1;for(const l of r)if(l.hasUniformTransition()){o="Uniform transition in ".concat(l);break}this._needsUpdate=o,this.layers=r}_updateSublayersRecursively(e,n,i){for(const r of e){r.context=this.context;const o=n[r.id];o===null&&Ti.warn("Multiple new layers with same id ".concat(r.id))(),n[r.id]=null;let l=null;try{this._debug&&o!==r&&r.validateProps(),o?(this._transferLayerState(o,r),this._updateLayer(r)):this._initializeLayer(r),i.push(r),l=r.isComposite?r.getSubLayers():null}catch(s){this._handleError("matching",s,r)}l&&this._updateSublayersRecursively(l,n,i)}}_finalizeOldLayers(e){for(const n in e){const i=e[n];i&&this._finalizeLayer(i)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=Gp.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=Gp.MATCHED,n!==e&&(e.lifecycle=Gp.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=Gp.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=Gp.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function oc(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!oc(t[i],e[i],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const i=Object.keys(t),r=Object.keys(e);if(i.length!==r.length)return!1;for(const o of i)if(!e.hasOwnProperty(o)||!oc(t[o],e[o],n-1))return!1;return!0}return!1}class Gue{constructor(e){q(this,"width",void 0),q(this,"height",void 0),q(this,"views",void 0),q(this,"viewState",void 0),q(this,"controllers",void 0),q(this,"timeline",void 0),q(this,"_viewports",void 0),q(this,"_viewportMap",void 0),q(this,"_isUpdating",void 0),q(this,"_needsRedraw",void 0),q(this,"_needsUpdate",void 0),q(this,"_eventManager",void 0),q(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,i=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(i):i}getViewport(e){return this._viewportMap[e]}unproject(e,n){const i=this.getViewports(),r={x:e[0],y:e[1]};for(let o=i.length-1;o>=0;--o){const l=i[o];if(l.containsPixel(r)){const s=e.slice();return s[0]-=l.x,s[1]-=l.y,l.unproject(s,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=F2(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!oc(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):Ti.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const i=n.type;return new i({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:o=>{var l;return(l=this.getView(e.id))===null||l===void 0?void 0:l.makeViewport({viewState:o,width:this.width,height:this.height})}})}_updateController(e,n,i,r){const o=e.controller;if(o&&i){const l={...n,...o,id:e.id,x:i.x,y:i.y,width:i.width,height:i.height};return(!r||r.constructor!==o.type)&&(r=this._createController(e,l)),r&&r.setProps(l),r}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let i=!1;for(let r=e.length;r--;){const o=e[r],l=this.getViewState(o),s=o.makeViewport({viewState:l,width:this.width,height:this.height});let d=n[o.id];const p=!!o.controller;p&&!d&&(i=!0),(i||!p)&&d&&(d.finalize(),d=null),this.controllers[o.id]=this._updateController(o,l,s,d),s&&this._viewports.unshift(s)}for(const r in n){const o=n[r];o&&!this.controllers[r]&&o.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((i,r)=>!e[r].equals(n[r]))}}const Hue=/([0-9]+\.?[0-9]*)(%|px)/;function th(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=Hue.exec(t);if(e&&e.length>=3){const n=e[2]==="%",i=parseFloat(e[1]);return{position:n?i/100:i,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function nh(t,e){return t.relative?Math.round(t.position*e):t.position}function Go(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class Wue{constructor(e){q(this,"id",void 0),q(this,"viewportInstance",void 0),q(this,"_x",void 0),q(this,"_y",void 0),q(this,"_width",void 0),q(this,"_height",void 0),q(this,"_padding",void 0),q(this,"props",void 0);const{id:n,x:i=0,y:r=0,width:o="100%",height:l="100%",padding:s=null,viewportInstance:d}=e||{};Go(!d||d instanceof Sf),this.viewportInstance=d,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=th(i),this._y=th(r),this._width=th(o),this._height=th(l),this._padding=s&&{left:th(s.left||0),right:th(s.right||0),top:th(s.top||0),bottom:th(s.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&oc(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:i}){if(this.viewportInstance)return this.viewportInstance;i=this.filterViewState(i);const r=this.getDimensions({width:e,height:n});return!r.height||!r.width?null:new this.ViewportType({...i,...this.props,...r})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:(e==null?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const i in this.props.viewState)i!=="id"&&(n[i]=this.props.viewState[i]);return n}return e}getDimensions({width:e,height:n}){const i={x:nh(this._x,e),y:nh(this._y,n),width:nh(this._width,e),height:nh(this._height,n)};return this._padding&&(i.padding={left:nh(this._padding.left,e),top:nh(this._padding.top,n),right:nh(this._padding.right,e),bottom:nh(this._padding.bottom,n)}),i}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}let T_=class{constructor(e){q(this,"_inProgress",void 0),q(this,"_handle",void 0),q(this,"_timeline",void 0),q(this,"time",void 0),q(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,i;this.cancel(),this.settings=e,this._inProgress=!0,(n=(i=this.settings).onStart)===null||n===void 0||n.call(i,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:i,settings:r}=this;this._handle=i.addChannel({delay:i.getTime(),duration:r.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}};const V5=()=>{},oP={BREAK:1,SNAP_TO_END:2,IGNORE:3},Kue=t=>t,Xue=oP.BREAK;class Zue{constructor(e){q(this,"getControllerState",void 0),q(this,"props",void 0),q(this,"propsInTransition",void 0),q(this,"transition",void 0),q(this,"onViewStateChange",void 0),q(this,"onStateChange",void 0),q(this,"_onTransitionUpdate",n=>{const{time:i,settings:{interpolator:r,startProps:o,endProps:l,duration:s,easing:d}}=n,p=d(i/s),y=r.interpolateProps(o,l,p);this.propsInTransition=this.getControllerState({...this.props,...y}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new T_(e.timeline),this.onViewStateChange=e.onViewStateChange||V5,this.onStateChange=e.onStateChange||V5}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const i=this.props;if(this.props=e,!i||this._shouldIgnoreViewportChange(i,e))return!1;if(this._isTransitionEnabled(e)){let r=i;if(this.transition.inProgress){const{interruption:o,endProps:l}=this.transition.settings;r={...i,...o===oP.SNAP_TO_END?l:this.propsInTransition||i}}this._triggerTransition(r,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:i}=e;return(n>0||n==="auto")&&!!i}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===oP.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const i=this.getControllerState(e),r=this.getControllerState(n).shortestPathFrom(i),o=n.transitionInterpolator,l=o.getDuration?o.getDuration(e,n):n.transitionDuration;if(l===0)return;const s=o.initializeProps(e,r);this.propsInTransition={};const d={duration:l,easing:n.transitionEasing||Kue,interpolator:o,interruption:n.transitionInterruption||Xue,startProps:s.start,endProps:s.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(d),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e==null||e(n)}}}class que{constructor(e){q(this,"_propsToCompare",void 0),q(this,"_propsToExtract",void 0),q(this,"_requiredProps",void 0);const{compare:n,extract:i,required:r}=e;this._propsToCompare=n,this._propsToExtract=i||n,this._requiredProps=r}arePropsEqual(e,n){for(const i of this._propsToCompare)if(!(i in e)||!(i in n)||!qc(e[i],n[i]))return!1;return!0}initializeProps(e,n){const i={},r={};for(const o of this._propsToExtract)(o in e||o in n)&&(i[o]=e[o],r[o]=n[o]);return this._checkRequiredProps(i),this._checkRequiredProps(r),{start:i,end:r}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const i=e[n];Go(Number.isFinite(i)||Array.isArray(i),"".concat(n," is required for transition"))})}}const Yue=["longitude","latitude","zoom","bearing","pitch"],Jue=["longitude","latitude","zoom"];class P7 extends que{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,i=Array.isArray(e)?{}:e;i.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:Yue,required:Jue},super(i.transitionProps),q(this,"opts",void 0),this.opts=i}initializeProps(e,n){const i=super.initializeProps(e,n),{makeViewport:r,around:o}=this.opts;if(r&&o){const l=r(e),s=r(n),d=l.unproject(o);i.start.around=o,Object.assign(i.end,{around:s.project(d),aroundPosition:d,width:n.width,height:n.height})}return i}interpolateProps(e,n,i){const r={};for(const o of this._propsToExtract)r[o]=Yd(e[o]||0,n[o]||0,i);if(n.aroundPosition&&this.opts.makeViewport){const o=this.opts.makeViewport({...n,...r});Object.assign(r,o.panByPosition(n.aroundPosition,Yd(e.around,n.around,i)))}return r}}const ih={transitionDuration:0},Que=300,Bb=t=>1-(1-t)*(1-t),Dp={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},Ad={};class ehe{constructor(e){q(this,"props",void 0),q(this,"state",{}),q(this,"transitionManager",void 0),q(this,"eventManager",void 0),q(this,"onViewStateChange",void 0),q(this,"onStateChange",void 0),q(this,"makeViewport",void 0),q(this,"_controllerState",void 0),q(this,"_events",{}),q(this,"_interactionState",{isDragging:!1}),q(this,"_customEvents",[]),q(this,"_eventStartBlocked",null),q(this,"_panMove",!1),q(this,"invertPan",!1),q(this,"dragMode","rotate"),q(this,"inertia",0),q(this,"scrollZoom",!0),q(this,"dragPan",!0),q(this,"dragRotate",!0),q(this,"doubleClickZoom",!0),q(this,"touchZoom",!0),q(this,"touchRotate",!1),q(this,"keyboard",!0),this.transitionManager=new Zue({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:i}=this.props,{offsetCenter:r}=e;return[r.x-n,r.y-i]}isPointInBounds(e,n){const{width:i,height:r}=this.props;if(n&&n.handled)return!1;const o=e[0]>=0&&e[0]<=i&&e[1]>=0&&e[1]<=r;return o&&n&&n.stopPropagation(),o}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?Que:0;const{scrollZoom:i=!0,dragPan:r=!0,dragRotate:o=!0,doubleClickZoom:l=!0,touchZoom:s=!0,touchRotate:d=!1,keyboard:p=!0}=e,y=!!this.onViewStateChange;this.toggleEvents(Dp.WHEEL,y&&i),this.toggleEvents(Dp.PAN,y),this.toggleEvents(Dp.PINCH,y&&(s||d)),this.toggleEvents(Dp.TRIPLE_PAN,y&&d),this.toggleEvents(Dp.DOUBLE_TAP,y&&l),this.toggleEvents(Dp.KEYBOARD,y&&p),this.scrollZoom=i,this.dragPan=r,this.dragRotate=o,this.doubleClickZoom=l,this.touchZoom=s,this.touchRotate=d,this.keyboard=p}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(i=>{this._events[i]!==n&&(this._events[i]=n,n?this.eventManager.on(i,this.handleEvent):this.eventManager.off(i,this.handleEvent))})}updateViewport(e,n=null,i={}){const r={...e.getViewportProps(),...n},o=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(i),o){const l=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:l})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let i=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(i=!i);const r=this.controllerState[i?"panStart":"rotateStart"]({pos:n});return this._panMove=i,this.updateViewport(r,ih,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),i=this.controllerState.pan({pos:n});return this.updateViewport(i,ih,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const i=this.getCenter(e),r=[i[0]+e.velocityX*n/2,i[1]+e.velocityY*n/2],o=this.controllerState.pan({pos:r}).panEnd();this.updateViewport(o,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Bb},{isDragging:!1,isPanning:!0})}else{const i=this.controllerState.panEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),i=this.controllerState.rotate({pos:n});return this.updateViewport(i,ih,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const i=this.getCenter(e),r=[i[0]+e.velocityX*n/2,i[1]+e.velocityY*n/2],o=this.controllerState.rotate({pos:r}).rotateEnd();this.updateViewport(o,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Bb},{isDragging:!1,isRotating:!0})}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;e.srcEvent.preventDefault();const{speed:i=.01,smooth:r=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:o}=e;let l=2/(1+Math.exp(-Math.abs(o*i)));o<0&&l!==0&&(l=1/l);const s=this.controllerState.zoom({pos:n,scale:l});return this.updateViewport(s,{...this._getTransitionProps({around:n}),transitionDuration:r?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const i=this.controllerState.rotateStart({pos:n});return this.updateViewport(i,ih,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const i=this.controllerState.rotate({pos:n});return this.updateViewport(i,ih,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const i=this.getCenter(e),r=[i[0],i[1]+=e.velocityY*n/2],o=this.controllerState.rotate({pos:r});this.updateViewport(o,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Bb},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const i=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return Ad._startPinchRotation=e.rotation,Ad._lastPinchEvent=e,this.updateViewport(i,ih,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:i}=e,r=this.getCenter(e);n=n.zoom({pos:r,scale:i})}if(this.touchRotate){const{rotation:i}=e;n=n.rotate({deltaAngleX:Ad._startPinchRotation-i})}return this.updateViewport(n,ih,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Ad._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:i}=Ad;if(this.touchZoom&&n&&i&&e.scale!==i.scale){const r=this.getCenter(e);let o=this.controllerState.rotateEnd();const l=Math.log2(e.scale),s=(l-Math.log2(i.scale))/(e.deltaTime-i.deltaTime),d=Math.pow(2,l+s*n/2);o=o.zoom({pos:r,scale:d}).zoomEnd(),this.updateViewport(o,{...this._getTransitionProps({around:r}),transitionDuration:n,transitionEasing:Bb},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const r=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Ad._startPinchRotation=null,Ad._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const i=this.isFunctionKeyPressed(e),r=this.controllerState.zoom({pos:n,scale:i?.5:2});return this.updateViewport(r,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:i,moveSpeed:r,rotateSpeedX:o,rotateSpeedY:l}=this.keyboard===!0?{}:this.keyboard,{controllerState:s}=this;let d;const p={};switch(e.srcEvent.code){case"Minus":d=n?s.zoomOut(i).zoomOut(i):s.zoomOut(i),p.isZooming=!0;break;case"Equal":d=n?s.zoomIn(i).zoomIn(i):s.zoomIn(i),p.isZooming=!0;break;case"ArrowLeft":n?(d=s.rotateLeft(o),p.isRotating=!0):(d=s.moveLeft(r),p.isPanning=!0);break;case"ArrowRight":n?(d=s.rotateRight(o),p.isRotating=!0):(d=s.moveRight(r),p.isPanning=!0);break;case"ArrowUp":n?(d=s.rotateUp(l),p.isRotating=!0):(d=s.moveUp(r),p.isPanning=!0);break;case"ArrowDown":n?(d=s.rotateDown(l),p.isRotating=!0):(d=s.moveDown(r),p.isPanning=!0);break;default:return!1}return this.updateViewport(d,this._getTransitionProps(),p),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?ih:e?{...n,transitionInterpolator:new P7({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class the{constructor(e,n){q(this,"_viewportProps",void 0),q(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const j5=5,nhe=1.2;class ihe extends the{constructor(e){const{width:n,height:i,latitude:r,longitude:o,zoom:l,bearing:s=0,pitch:d=0,altitude:p=1.5,position:y=[0,0,0],maxZoom:v=20,minZoom:w=0,maxPitch:T=60,minPitch:I=0,startPanLngLat:L,startZoomLngLat:k,startRotatePos:F,startBearing:B,startPitch:G,startZoom:U,normalize:ee=!0}=e;Go(Number.isFinite(o)),Go(Number.isFinite(r)),Go(Number.isFinite(l)),super({width:n,height:i,latitude:r,longitude:o,zoom:l,bearing:s,pitch:d,altitude:p,maxZoom:v,minZoom:w,maxPitch:T,minPitch:I,normalize:ee,position:y},{startPanLngLat:L,startZoomLngLat:k,startRotatePos:F,startBearing:B,startPitch:G,startZoom:U}),q(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const i=this.getState().startPanLngLat||this._unproject(n);if(!i)return this;const o=this.makeViewport(this.getViewportProps()).panByPosition(i,e);return this._getUpdatedState(o)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:i=0}){const{startRotatePos:r,startBearing:o,startPitch:l}=this.getState();if(!r||o===void 0||l===void 0)return this;let s;return e?s=this._getNewRotation(e,r,l,o):s={bearing:o+n,pitch:l+i},this._getUpdatedState(s)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:i}){let{startZoom:r,startZoomLngLat:o}=this.getState();if(o||(r=this.getViewportProps().zoom,o=this._unproject(n)||this._unproject(e)),!o)return this;const{maxZoom:l,minZoom:s}=this.getViewportProps();let d=r+Math.log2(i);d=yh(d,s,l);const p=this.makeViewport({...this.getViewportProps(),zoom:d});return this._getUpdatedState({zoom:d,...p.panByPosition(o,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),i={...this.getViewportProps()},{bearing:r,longitude:o}=i;return Math.abs(r-n.bearing)>180&&(i.bearing=r<0?r+360:r-360),Math.abs(o-n.longitude)>180&&(i.longitude=o<0?o+360:o-360),i}applyConstraints(e){const{maxZoom:n,minZoom:i,zoom:r}=e;e.zoom=yh(r,i,n);const{maxPitch:o,minPitch:l,pitch:s}=e;e.pitch=yh(s,l,o);const{normalize:d=!0}=e;return d&&Object.assign(e,aue(e)),e}_zoomFromCenter(e){const{width:n,height:i}=this.getViewportProps();return this.zoom({pos:[n/2,i/2],scale:e})}_panFromCenter(e){const{width:n,height:i}=this.getViewportProps();return this.pan({startPos:[n/2,i/2],pos:[n/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,i,r){const o=e[0]-n[0],l=e[1]-n[1],s=e[1],d=n[1],{width:p,height:y}=this.getViewportProps(),v=o/p;let w=0;l>0?Math.abs(y-d)>j5&&(w=l/(d-y)*nhe):l<0&&d>j5&&(w=1-s/d),w=yh(w,-1,1);const{minPitch:T,maxPitch:I}=this.getViewportProps(),L=r+180*v;let k=i;return w>0?k=i+w*(I-i):w<0&&(k=i-w*(T-i)),{pitch:k,bearing:L}}}class rhe extends ehe{constructor(...e){super(...e),q(this,"ControllerState",ihe),q(this,"transition",{transitionDuration:300,transitionInterpolator:new P7({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),q(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class I7 extends Wue{get ViewportType(){return Bh}get ControllerType(){return rhe}}q(I7,"displayName","MapView");const ohe=new T7;function she(t,e){var n,i;const r=(n=t.order)!==null&&n!==void 0?n:1/0,o=(i=e.order)!==null&&i!==void 0?i:1/0;return r-o}class ahe{constructor(){q(this,"effects",void 0),q(this,"_resolvedEffects",[]),q(this,"_defaultEffects",[]),q(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(i=>i.id===e.id)){const i=n.findIndex(r=>she(r,e)>0);i<0?n.push(e):n.splice(i,0,e),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(oc(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const r of this.effects)n[r.id]=r;const i=[];for(const r of e){const o=n[r.id];o&&o!==r?o.setProps?(o.setProps(r.props),i.push(o)):(o.cleanup(),i.push(r)):i.push(r),delete n[r.id]}for(const r in n)n[r].cleanup();this.effects=i,this._resolvedEffects=i.concat(this._defaultEffects),e.some(r=>r instanceof T7)||this._resolvedEffects.push(ohe),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class lhe extends GM{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const che="deckRenderer.renderLayers";class uhe{constructor(e){q(this,"gl",void 0),q(this,"layerFilter",void 0),q(this,"drawPickingColors",void 0),q(this,"drawLayersPass",void 0),q(this,"pickLayersPass",void 0),q(this,"renderCount",void 0),q(this,"_needsRedraw",void 0),q(this,"renderBuffers",void 0),q(this,"lastPostProcessEffect",void 0),this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new lhe(e),this.pickLayersPass=new C7(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,i={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e,target:e.target||ko.getDefaultFramebuffer(this.gl)};i.effects&&this._preRender(i.effects,i);const r=this.lastPostProcessEffect?this.renderBuffers[0]:i.target,o=n.render({...i,target:r});i.effects&&this._postRender(i.effects,i),this.renderCount++,ms(che,this,o,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const i of e)n.preRenderStats[i.id]=i.preRender(this.gl,n),i.postRender&&(this.lastPostProcessEffect=i.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new ko(this.gl),new ko(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:i}=this,r={...n,inputBuffer:i[0],swapBuffer:i[1],target:null};for(const o of e)if(o.postRender){if(o.id===this.lastPostProcessEffect){r.target=n.target,o.postRender(this.gl,r);break}const l=o.postRender(this.gl,r);r.inputBuffer=l,r.swapBuffer=l===i[0]?i[1]:i[0]}}}const hhe={pickedColor:null,pickedObjectIndex:-1};function dhe({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:i,deviceRadius:r,deviceRect:o}){const{x:l,y:s,width:d,height:p}=o;let y=r*r,v=-1,w=0;for(let T=0;T<p;T++){const I=T+s-i,L=I*I;if(L>y)w+=4*d;else for(let k=0;k<d;k++){if(t[w+3]-1>=0){const B=k+l-n,G=B*B+L;G<=y&&(y=G,v=w)}w+=4}}if(v>=0){const T=t.slice(v,v+4),I=e(T);if(I){const L=Math.floor(v/4/d),k=v/4-L*d;return{...I,pickedColor:T,pickedX:l+k,pickedY:s+L}}Ti.error("Picked non-existent layer. Is picking buffer corrupt?")()}return hhe}function fhe({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let i=0;i<t.length;i+=4)if(t[i+3]-1>=0){const o=t.slice(i,i+4),l=o.join(",");if(!n.has(l)){const s=e(o);s?n.set(l,{...s,color:o}):Ti.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function M7({pickInfo:t,viewports:e,pixelRatio:n,x:i,y:r,z:o}){let l=e[0];e.length>1&&(l=mhe((t==null?void 0:t.pickedViewports)||e,{x:i,y:r}));let s;if(l){const d=[i-l.x,r-l.y];o!==void 0&&(d[2]=o),s=l.unproject(d)}return{color:null,layer:null,viewport:l,index:-1,picked:!1,x:i,y:r,pixel:[i,r],coordinate:s,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function phe(t){const{pickInfo:e,lastPickedInfo:n,mode:i,layers:r}=t,{pickedColor:o,pickedLayer:l,pickedObjectIndex:s}=e,d=l?[l]:[];if(i==="hover"){const v=n.index,w=n.layerId,T=l?l.props.id:null;if(T!==w||s!==v){if(T!==w){const I=r.find(L=>L.props.id===w);I&&d.unshift(I)}n.layerId=T,n.index=s,n.info=null}}const p=M7(t),y=new Map;return y.set(null,p),d.forEach(v=>{let w={...p};v===l&&(w.color=o,w.index=s,w.picked=!0),w=R7({layer:v,info:w,mode:i});const T=w.layer;v===l&&i==="hover"&&(n.info=w),y.set(T.id,w),i==="hover"&&T.updateAutoHighlight(w)}),y}function R7({layer:t,info:e,mode:n}){for(;t&&e;){const i=e.layer||null;e.sourceLayer=i,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:i}),t=t.parent}return e}function mhe(t,e){for(let n=t.length-1;n>=0;n--){const i=t[n];if(i.containsPixel(e))return i}return t[0]}class ghe{constructor(e){q(this,"gl",void 0),q(this,"pickingFBO",void 0),q(this,"depthFBO",void 0),q(this,"pickLayersPass",void 0),q(this,"layerFilter",void 0),q(this,"lastPickedInfo",void 0),q(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new C7(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:i,viewports:r},o=this.lastPickedInfo.info){const l=o&&o.layer&&o.layer.id,s=o&&o.viewport&&o.viewport.id,d=l?i.find(w=>w.id===l):null,p=s&&r.find(w=>w.id===s)||r[0],y=p&&p.unproject([e-p.x,n-p.y]);return{...o,...{x:e,y:n,viewport:p,coordinate:y,layer:d}}}_resizeBuffer(){var e,n;const{gl:i}=this;if(!this.pickingFBO&&(this.pickingFBO=new ko(i),ko.isSupported(i,{colorBufferFloat:!0}))){const r=new ko(i);r.attach({36064:new ws(i,{format:bi(i)?34836:6408,type:5126})}),this.depthFBO=r}(e=this.pickingFBO)===null||e===void 0||e.resize({width:i.canvas.width,height:i.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:i.canvas.width,height:i.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(i=>this.pickLayersPass.shouldDrawLayer(i)&&!i.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:i,x:r,y:o,radius:l=0,depth:s=1,mode:d="query",unproject3D:p,onViewportActive:y,effects:v}){const w=this._getPickable(e),T=cf(this.gl);if(!w)return{result:[],emptyInfo:M7({viewports:i,x:r,y:o,pixelRatio:T})};this._resizeBuffer();const I=FS(this.gl,[r,o],!0),L=[I.x+Math.floor(I.width/2),I.y+Math.floor(I.height/2)],k=Math.round(l*T),{width:F,height:B}=this.pickingFBO,G=this._getPickingRect({deviceX:L[0],deviceY:L[1],deviceRadius:k,deviceWidth:F,deviceHeight:B}),U={x:r-l,y:o-l,width:l*2+1,height:l*2+1};let ee;const ne=[],ye=new Set;for(let fe=0;fe<s;fe++){let J;if(G){const me=this._drawAndSample({layers:w,views:n,viewports:i,onViewportActive:y,deviceRect:G,cullRect:U,effects:v,pass:"picking:".concat(d)});J=dhe({...me,deviceX:L[0],deviceY:L[1],deviceRadius:k,deviceRect:G})}else J={pickedColor:null,pickedObjectIndex:-1};let Ce;if(J.pickedLayer&&p&&this.depthFBO){const{pickedColors:me}=this._drawAndSample({layers:[J.pickedLayer],views:n,viewports:i,onViewportActive:y,deviceRect:{x:J.pickedX,y:J.pickedY,width:1,height:1},cullRect:U,effects:v,pass:"picking:".concat(d,":z")},!0);me[3]&&(Ce=me[0])}J.pickedLayer&&fe+1<s&&(ye.add(J.pickedLayer),J.pickedLayer.disablePickingIndex(J.pickedObjectIndex)),ee=phe({pickInfo:J,lastPickedInfo:this.lastPickedInfo,mode:d,layers:w,viewports:i,x:r,y:o,z:Ce,pixelRatio:T});for(const me of ee.values())me.layer&&ne.push(me);if(!J.pickedColor)break}for(const fe of ye)fe.restorePickingColors();return{result:ne,emptyInfo:ee.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:i,x:r,y:o,width:l=1,height:s=1,mode:d="query",maxObjects:p=null,onViewportActive:y,effects:v}){const w=this._getPickable(e);if(!w)return[];this._resizeBuffer();const T=cf(this.gl),I=FS(this.gl,[r,o],!0),L=I.x,k=I.y+I.height,F=FS(this.gl,[r+l,o+s],!0),B=F.x+F.width,G=F.y,U={x:L,y:G,width:B-L,height:k-G},ee=this._drawAndSample({layers:w,views:n,viewports:i,onViewportActive:y,deviceRect:U,cullRect:{x:r,y:o,width:l,height:s},effects:v,pass:"picking:".concat(d)}),ne=fhe(ee),ye=new Map,fe=Number.isFinite(p);for(let J=0;J<ne.length&&!(fe&&p&&ye.size>=p);J++){const Ce=ne[J];let me={color:Ce.pickedColor,layer:null,index:Ce.pickedObjectIndex,picked:!0,x:r,y:o,pixelRatio:T};me=R7({layer:Ce.pickedLayer,info:me,mode:d}),ye.has(me.object)||ye.set(me.object,me)}return Array.from(ye.values())}_drawAndSample({layers:e,views:n,viewports:i,onViewportActive:r,deviceRect:o,cullRect:l,effects:s,pass:d},p=!1){const y=p?this.depthFBO:this.pickingFBO,v={layers:e,layerFilter:this.layerFilter,views:n,viewports:i,onViewportActive:r,pickingFBO:y,deviceRect:o,cullRect:l,effects:s,pass:d,pickZ:p,preRenderStats:{}};for(const B of s)B.useInPicking&&(v.preRenderStats[B.id]=B.preRender(this.gl,v));const{decodePickingColor:w}=this.pickLayersPass.render(v),{x:T,y:I,width:L,height:k}=o,F=new(p?Float32Array:Uint8Array)(L*k*4);return b_(y,{sourceX:T,sourceY:I,sourceWidth:L,sourceHeight:k,target:F}),{pickedColors:F,decodePickingColor:w}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:i,deviceWidth:r,deviceHeight:o}){const l=Math.max(0,e-i),s=Math.max(0,n-i),d=Math.min(r,e+i+1)-l,p=Math.min(o,n+i+1)-s;return d<=0||p<=0?null:{x:l,y:s,width:d,height:p}}}const yhe={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class vhe{constructor(e){q(this,"el",null),q(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,yhe),n.appendChild(this.el))}setTooltip(e,n,i){const r=this.el;if(r){if(typeof e=="string")r.innerText=e;else if(e)e.text&&(r.innerText=e.text),e.html&&(r.innerHTML=e.html),e.className&&(r.className=e.className);else{this.isVisible=!1,r.style.display="none";return}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(n,"px, ").concat(i,"px)"),e&&typeof e=="object"&&"style"in e&&Object.assign(r.style,e.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}}var L7={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,i,r){var o=["","webkit","Moz","MS","ms","o"],l=n.createElement("div"),s="function",d=Math.round,p=Math.abs,y=Date.now;function v(se,ve,Re){return setTimeout(G(se,Re),ve)}function w(se,ve,Re){return Array.isArray(se)?(T(se,Re[ve],Re),!0):!1}function T(se,ve,Re){var gt;if(se)if(se.forEach)se.forEach(ve,Re);else if(se.length!==r)for(gt=0;gt<se.length;)ve.call(Re,se[gt],gt,se),gt++;else for(gt in se)se.hasOwnProperty(gt)&&ve.call(Re,se[gt],gt,se)}function I(se,ve,Re){var gt="DEPRECATED METHOD: "+ve+`
`+Re+` AT 
`;return function(){var $t=new Error("get-stack-trace"),vn=$t&&$t.stack?$t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",ui=e.console&&(e.console.warn||e.console.log);return ui&&ui.call(e.console,gt,vn),se.apply(this,arguments)}}var L;typeof Object.assign!="function"?L=function(ve){if(ve===r||ve===null)throw new TypeError("Cannot convert undefined or null to object");for(var Re=Object(ve),gt=1;gt<arguments.length;gt++){var $t=arguments[gt];if($t!==r&&$t!==null)for(var vn in $t)$t.hasOwnProperty(vn)&&(Re[vn]=$t[vn])}return Re}:L=Object.assign;var k=I(function(ve,Re,gt){for(var $t=Object.keys(Re),vn=0;vn<$t.length;)(!gt||gt&&ve[$t[vn]]===r)&&(ve[$t[vn]]=Re[$t[vn]]),vn++;return ve},"extend","Use `assign`."),F=I(function(ve,Re){return k(ve,Re,!0)},"merge","Use `assign`.");function B(se,ve,Re){var gt=ve.prototype,$t;$t=se.prototype=Object.create(gt),$t.constructor=se,$t._super=gt,Re&&L($t,Re)}function G(se,ve){return function(){return se.apply(ve,arguments)}}function U(se,ve){return typeof se==s?se.apply(ve&&ve[0]||r,ve):se}function ee(se,ve){return se===r?ve:se}function ne(se,ve,Re){T(Ce(ve),function(gt){se.addEventListener(gt,Re,!1)})}function ye(se,ve,Re){T(Ce(ve),function(gt){se.removeEventListener(gt,Re,!1)})}function fe(se,ve){for(;se;){if(se==ve)return!0;se=se.parentNode}return!1}function J(se,ve){return se.indexOf(ve)>-1}function Ce(se){return se.trim().split(/\s+/g)}function me(se,ve,Re){if(se.indexOf&&!Re)return se.indexOf(ve);for(var gt=0;gt<se.length;){if(Re&&se[gt][Re]==ve||!Re&&se[gt]===ve)return gt;gt++}return-1}function be(se){return Array.prototype.slice.call(se,0)}function Te(se,ve,Re){for(var gt=[],$t=[],vn=0;vn<se.length;){var ui=ve?se[vn][ve]:se[vn];me($t,ui)<0&&gt.push(se[vn]),$t[vn]=ui,vn++}return Re&&(ve?gt=gt.sort(function(Ze,at){return Ze[ve]>at[ve]}):gt=gt.sort()),gt}function ke(se,ve){for(var Re,gt,$t=ve[0].toUpperCase()+ve.slice(1),vn=0;vn<o.length;){if(Re=o[vn],gt=Re?Re+$t:ve,gt in se)return gt;vn++}return r}var ut=1;function et(){return ut++}function Et(se){var ve=se.ownerDocument||se;return ve.defaultView||ve.parentWindow||e}var bt=/mobile|tablet|ip(ad|hone|od)|android/i,Qt="ontouchstart"in e,cn=ke(e,"PointerEvent")!==r,pn=Qt&&bt.test(navigator.userAgent),xn="touch",An="pen",kn="mouse",Bn="kinect",Nt=25,We=1,kt=2,Ke=4,ht=8,Pt=1,ae=2,Ae=4,je=8,tt=16,pt=ae|Ae,Tt=je|tt,tn=pt|Tt,Wt=["x","y"],qt=["clientX","clientY"];function It(se,ve){var Re=this;this.manager=se,this.callback=ve,this.element=se.element,this.target=se.options.inputTarget,this.domHandler=function(gt){U(se.options.enable,[se])&&Re.handler(gt)},this.init()}It.prototype={handler:function(){},init:function(){this.evEl&&ne(this.element,this.evEl,this.domHandler),this.evTarget&&ne(this.target,this.evTarget,this.domHandler),this.evWin&&ne(Et(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&ye(this.element,this.evEl,this.domHandler),this.evTarget&&ye(this.target,this.evTarget,this.domHandler),this.evWin&&ye(Et(this.element),this.evWin,this.domHandler)}};function wn(se){var ve,Re=se.options.inputClass;return Re?ve=Re:cn?ve=Pe:pn?ve=Ft:Qt?ve=ii:ve=Pn,new ve(se,hn)}function hn(se,ve,Re){var gt=Re.pointers.length,$t=Re.changedPointers.length,vn=ve&We&&gt-$t===0,ui=ve&(Ke|ht)&&gt-$t===0;Re.isFirst=!!vn,Re.isFinal=!!ui,vn&&(se.session={}),Re.eventType=ve,En(se,Re),se.emit("hammer.input",Re),se.recognize(Re),se.session.prevInput=Re}function En(se,ve){var Re=se.session,gt=ve.pointers,$t=gt.length;Re.firstInput||(Re.firstInput=ti(ve)),$t>1&&!Re.firstMultiple?Re.firstMultiple=ti(ve):$t===1&&(Re.firstMultiple=!1);var vn=Re.firstInput,ui=Re.firstMultiple,Oe=ui?ui.center:vn.center,Ze=ve.center=li(gt);ve.timeStamp=y(),ve.deltaTime=ve.timeStamp-vn.timeStamp,ve.angle=rt(Oe,Ze),ve.distance=Be(Oe,Ze),zn(Re,ve),ve.offsetDirection=K(ve.deltaX,ve.deltaY);var at=ie(ve.deltaTime,ve.deltaX,ve.deltaY);ve.overallVelocityX=at.x,ve.overallVelocityY=at.y,ve.overallVelocity=p(at.x)>p(at.y)?at.x:at.y,ve.scale=ui?zt(ui.pointers,gt):1,ve.rotation=ui?mt(ui.pointers,gt):0,ve.maxPointers=Re.prevInput?ve.pointers.length>Re.prevInput.maxPointers?ve.pointers.length:Re.prevInput.maxPointers:ve.pointers.length,ei(Re,ve);var Ot=se.element;fe(ve.srcEvent.target,Ot)&&(Ot=ve.srcEvent.target),ve.target=Ot}function zn(se,ve){var Re=ve.center,gt=se.offsetDelta||{},$t=se.prevDelta||{},vn=se.prevInput||{};(ve.eventType===We||vn.eventType===Ke)&&($t=se.prevDelta={x:vn.deltaX||0,y:vn.deltaY||0},gt=se.offsetDelta={x:Re.x,y:Re.y}),ve.deltaX=$t.x+(Re.x-gt.x),ve.deltaY=$t.y+(Re.y-gt.y)}function ei(se,ve){var Re=se.lastInterval||ve,gt=ve.timeStamp-Re.timeStamp,$t,vn,ui,Oe;if(ve.eventType!=ht&&(gt>Nt||Re.velocity===r)){var Ze=ve.deltaX-Re.deltaX,at=ve.deltaY-Re.deltaY,Ot=ie(gt,Ze,at);vn=Ot.x,ui=Ot.y,$t=p(Ot.x)>p(Ot.y)?Ot.x:Ot.y,Oe=K(Ze,at),se.lastInterval=ve}else $t=Re.velocity,vn=Re.velocityX,ui=Re.velocityY,Oe=Re.direction;ve.velocity=$t,ve.velocityX=vn,ve.velocityY=ui,ve.direction=Oe}function ti(se){for(var ve=[],Re=0;Re<se.pointers.length;)ve[Re]={clientX:d(se.pointers[Re].clientX),clientY:d(se.pointers[Re].clientY)},Re++;return{timeStamp:y(),pointers:ve,center:li(ve),deltaX:se.deltaX,deltaY:se.deltaY}}function li(se){var ve=se.length;if(ve===1)return{x:d(se[0].clientX),y:d(se[0].clientY)};for(var Re=0,gt=0,$t=0;$t<ve;)Re+=se[$t].clientX,gt+=se[$t].clientY,$t++;return{x:d(Re/ve),y:d(gt/ve)}}function ie(se,ve,Re){return{x:ve/se||0,y:Re/se||0}}function K(se,ve){return se===ve?Pt:p(se)>=p(ve)?se<0?ae:Ae:ve<0?je:tt}function Be(se,ve,Re){Re||(Re=Wt);var gt=ve[Re[0]]-se[Re[0]],$t=ve[Re[1]]-se[Re[1]];return Math.sqrt(gt*gt+$t*$t)}function rt(se,ve,Re){Re||(Re=Wt);var gt=ve[Re[0]]-se[Re[0]],$t=ve[Re[1]]-se[Re[1]];return Math.atan2($t,gt)*180/Math.PI}function mt(se,ve){return rt(ve[1],ve[0],qt)+rt(se[1],se[0],qt)}function zt(se,ve){return Be(ve[0],ve[1],qt)/Be(se[0],se[1],qt)}var en={mousedown:We,mousemove:kt,mouseup:Ke},bn="mousedown",Hn="mousemove mouseup";function Pn(){this.evEl=bn,this.evWin=Hn,this.pressed=!1,It.apply(this,arguments)}B(Pn,It,{handler:function(ve){var Re=en[ve.type];Re&We&&ve.button===0&&(this.pressed=!0),Re&kt&&ve.which!==1&&(Re=Ke),this.pressed&&(Re&Ke&&(this.pressed=!1),this.callback(this.manager,Re,{pointers:[ve],changedPointers:[ve],pointerType:kn,srcEvent:ve}))}});var ue={pointerdown:We,pointermove:kt,pointerup:Ke,pointercancel:ht,pointerout:ht},X={2:xn,3:An,4:kn,5:Bn},te="pointerdown",de="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(te="MSPointerDown",de="MSPointerMove MSPointerUp MSPointerCancel");function Pe(){this.evEl=te,this.evWin=de,It.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}B(Pe,It,{handler:function(ve){var Re=this.store,gt=!1,$t=ve.type.toLowerCase().replace("ms",""),vn=ue[$t],ui=X[ve.pointerType]||ve.pointerType,Oe=ui==xn,Ze=me(Re,ve.pointerId,"pointerId");vn&We&&(ve.button===0||Oe)?Ze<0&&(Re.push(ve),Ze=Re.length-1):vn&(Ke|ht)&&(gt=!0),!(Ze<0)&&(Re[Ze]=ve,this.callback(this.manager,vn,{pointers:Re,changedPointers:[ve],pointerType:ui,srcEvent:ve}),gt&&Re.splice(Ze,1))}});var $e={touchstart:We,touchmove:kt,touchend:Ke,touchcancel:ht},Je="touchstart",qe="touchstart touchmove touchend touchcancel";function Ge(){this.evTarget=Je,this.evWin=qe,this.started=!1,It.apply(this,arguments)}B(Ge,It,{handler:function(ve){var Re=$e[ve.type];if(Re===We&&(this.started=!0),!!this.started){var gt=ct.call(this,ve,Re);Re&(Ke|ht)&&gt[0].length-gt[1].length===0&&(this.started=!1),this.callback(this.manager,Re,{pointers:gt[0],changedPointers:gt[1],pointerType:xn,srcEvent:ve})}}});function ct(se,ve){var Re=be(se.touches),gt=be(se.changedTouches);return ve&(Ke|ht)&&(Re=Te(Re.concat(gt),"identifier",!0)),[Re,gt]}var Ht={touchstart:We,touchmove:kt,touchend:Ke,touchcancel:ht},Xt="touchstart touchmove touchend touchcancel";function Ft(){this.evTarget=Xt,this.targetIds={},It.apply(this,arguments)}B(Ft,It,{handler:function(ve){var Re=Ht[ve.type],gt=qn.call(this,ve,Re);gt&&this.callback(this.manager,Re,{pointers:gt[0],changedPointers:gt[1],pointerType:xn,srcEvent:ve})}});function qn(se,ve){var Re=be(se.touches),gt=this.targetIds;if(ve&(We|kt)&&Re.length===1)return gt[Re[0].identifier]=!0,[Re,Re];var $t,vn,ui=be(se.changedTouches),Oe=[],Ze=this.target;if(vn=Re.filter(function(at){return fe(at.target,Ze)}),ve===We)for($t=0;$t<vn.length;)gt[vn[$t].identifier]=!0,$t++;for($t=0;$t<ui.length;)gt[ui[$t].identifier]&&Oe.push(ui[$t]),ve&(Ke|ht)&&delete gt[ui[$t].identifier],$t++;if(Oe.length)return[Te(vn.concat(Oe),"identifier",!0),Oe]}var ci=2500,Yn=25;function ii(){It.apply(this,arguments);var se=G(this.handler,this);this.touch=new Ft(this.manager,se),this.mouse=new Pn(this.manager,se),this.primaryTouch=null,this.lastTouches=[]}B(ii,It,{handler:function(ve,Re,gt){var $t=gt.pointerType==xn,vn=gt.pointerType==kn;if(!(vn&&gt.sourceCapabilities&&gt.sourceCapabilities.firesTouchEvents)){if($t)mi.call(this,Re,gt);else if(vn&&hr.call(this,gt))return;this.callback(ve,Re,gt)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function mi(se,ve){se&We?(this.primaryTouch=ve.changedPointers[0].identifier,Vi.call(this,ve)):se&(Ke|ht)&&Vi.call(this,ve)}function Vi(se){var ve=se.changedPointers[0];if(ve.identifier===this.primaryTouch){var Re={x:ve.clientX,y:ve.clientY};this.lastTouches.push(Re);var gt=this.lastTouches,$t=function(){var vn=gt.indexOf(Re);vn>-1&&gt.splice(vn,1)};setTimeout($t,ci)}}function hr(se){for(var ve=se.srcEvent.clientX,Re=se.srcEvent.clientY,gt=0;gt<this.lastTouches.length;gt++){var $t=this.lastTouches[gt],vn=Math.abs(ve-$t.x),ui=Math.abs(Re-$t.y);if(vn<=Yn&&ui<=Yn)return!0}return!1}var Fr=ke(l.style,"touchAction"),xr=Fr!==r,Ko="compute",Cr="auto",Kr="manipulation",Bo="none",na="pan-x",Fs="pan-y",vi=Dl();function Xo(se,ve){this.manager=se,this.set(ve)}Xo.prototype={set:function(se){se==Ko&&(se=this.compute()),xr&&this.manager.element.style&&vi[se]&&(this.manager.element.style[Fr]=se),this.actions=se.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var se=[];return T(this.manager.recognizers,function(ve){U(ve.options.enable,[ve])&&(se=se.concat(ve.getTouchAction()))}),Za(se.join(" "))},preventDefaults:function(se){var ve=se.srcEvent,Re=se.offsetDirection;if(this.manager.session.prevented){ve.preventDefault();return}var gt=this.actions,$t=J(gt,Bo)&&!vi[Bo],vn=J(gt,Fs)&&!vi[Fs],ui=J(gt,na)&&!vi[na];if($t){var Oe=se.pointers.length===1,Ze=se.distance<2,at=se.deltaTime<250;if(Oe&&Ze&&at)return}if(!(ui&&vn)&&($t||vn&&Re&pt||ui&&Re&Tt))return this.preventSrc(ve)},preventSrc:function(se){this.manager.session.prevented=!0,se.preventDefault()}};function Za(se){if(J(se,Bo))return Bo;var ve=J(se,na),Re=J(se,Fs);return ve&&Re?Bo:ve||Re?ve?na:Fs:J(se,Kr)?Kr:Cr}function Dl(){if(!xr)return!1;var se={},ve=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Re){se[Re]=ve?e.CSS.supports("touch-action",Re):!0}),se}var ia=1,wr=2,bo=4,zo=8,Io=zo,Zo=16,Br=32;function Mo(se){this.options=L({},this.defaults,se||{}),this.id=et(),this.manager=null,this.options.enable=ee(this.options.enable,!0),this.state=ia,this.simultaneous={},this.requireFail=[]}Mo.prototype={defaults:{},set:function(se){return L(this.options,se),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(se){if(w(se,"recognizeWith",this))return this;var ve=this.simultaneous;return se=sr(se,this),ve[se.id]||(ve[se.id]=se,se.recognizeWith(this)),this},dropRecognizeWith:function(se){return w(se,"dropRecognizeWith",this)?this:(se=sr(se,this),delete this.simultaneous[se.id],this)},requireFailure:function(se){if(w(se,"requireFailure",this))return this;var ve=this.requireFail;return se=sr(se,this),me(ve,se)===-1&&(ve.push(se),se.requireFailure(this)),this},dropRequireFailure:function(se){if(w(se,"dropRequireFailure",this))return this;se=sr(se,this);var ve=me(this.requireFail,se);return ve>-1&&this.requireFail.splice(ve,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(se){return!!this.simultaneous[se.id]},emit:function(se){var ve=this,Re=this.state;function gt($t){ve.manager.emit($t,se)}Re<zo&&gt(ve.options.event+yt(Re)),gt(ve.options.event),se.additionalEvent&&gt(se.additionalEvent),Re>=zo&&gt(ve.options.event+yt(Re))},tryEmit:function(se){if(this.canEmit())return this.emit(se);this.state=Br},canEmit:function(){for(var se=0;se<this.requireFail.length;){if(!(this.requireFail[se].state&(Br|ia)))return!1;se++}return!0},recognize:function(se){var ve=L({},se);if(!U(this.options.enable,[this,ve])){this.reset(),this.state=Br;return}this.state&(Io|Zo|Br)&&(this.state=ia),this.state=this.process(ve),this.state&(wr|bo|zo|Zo)&&this.tryEmit(ve)},process:function(se){},getTouchAction:function(){},reset:function(){}};function yt(se){return se&Zo?"cancel":se&zo?"end":se&bo?"move":se&wr?"start":""}function No(se){return se==tt?"down":se==je?"up":se==ae?"left":se==Ae?"right":""}function sr(se,ve){var Re=ve.manager;return Re?Re.get(se):se}function Ai(){Mo.apply(this,arguments)}B(Ai,Mo,{defaults:{pointers:1},attrTest:function(se){var ve=this.options.pointers;return ve===0||se.pointers.length===ve},process:function(se){var ve=this.state,Re=se.eventType,gt=ve&(wr|bo),$t=this.attrTest(se);return gt&&(Re&ht||!$t)?ve|Zo:gt||$t?Re&Ke?ve|zo:ve&wr?ve|bo:wr:Br}});function er(){Ai.apply(this,arguments),this.pX=null,this.pY=null}B(er,Ai,{defaults:{event:"pan",threshold:10,pointers:1,direction:tn},getTouchAction:function(){var se=this.options.direction,ve=[];return se&pt&&ve.push(Fs),se&Tt&&ve.push(na),ve},directionTest:function(se){var ve=this.options,Re=!0,gt=se.distance,$t=se.direction,vn=se.deltaX,ui=se.deltaY;return $t&ve.direction||(ve.direction&pt?($t=vn===0?Pt:vn<0?ae:Ae,Re=vn!=this.pX,gt=Math.abs(se.deltaX)):($t=ui===0?Pt:ui<0?je:tt,Re=ui!=this.pY,gt=Math.abs(se.deltaY))),se.direction=$t,Re&&gt>ve.threshold&&$t&ve.direction},attrTest:function(se){return Ai.prototype.attrTest.call(this,se)&&(this.state&wr||!(this.state&wr)&&this.directionTest(se))},emit:function(se){this.pX=se.deltaX,this.pY=se.deltaY;var ve=No(se.direction);ve&&(se.additionalEvent=this.options.event+ve),this._super.emit.call(this,se)}});function go(){Ai.apply(this,arguments)}B(go,Ai,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Bo]},attrTest:function(se){return this._super.attrTest.call(this,se)&&(Math.abs(se.scale-1)>this.options.threshold||this.state&wr)},emit:function(se){if(se.scale!==1){var ve=se.scale<1?"in":"out";se.additionalEvent=this.options.event+ve}this._super.emit.call(this,se)}});function ra(){Mo.apply(this,arguments),this._timer=null,this._input=null}B(ra,Mo,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Cr]},process:function(se){var ve=this.options,Re=se.pointers.length===ve.pointers,gt=se.distance<ve.threshold,$t=se.deltaTime>ve.time;if(this._input=se,!gt||!Re||se.eventType&(Ke|ht)&&!$t)this.reset();else if(se.eventType&We)this.reset(),this._timer=v(function(){this.state=Io,this.tryEmit()},ve.time,this);else if(se.eventType&Ke)return Io;return Br},reset:function(){clearTimeout(this._timer)},emit:function(se){this.state===Io&&(se&&se.eventType&Ke?this.manager.emit(this.options.event+"up",se):(this._input.timeStamp=y(),this.manager.emit(this.options.event,this._input)))}});function qa(){Ai.apply(this,arguments)}B(qa,Ai,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Bo]},attrTest:function(se){return this._super.attrTest.call(this,se)&&(Math.abs(se.rotation)>this.options.threshold||this.state&wr)}});function Ts(){Ai.apply(this,arguments)}B(Ts,Ai,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:pt|Tt,pointers:1},getTouchAction:function(){return er.prototype.getTouchAction.call(this)},attrTest:function(se){var ve=this.options.direction,Re;return ve&(pt|Tt)?Re=se.overallVelocity:ve&pt?Re=se.overallVelocityX:ve&Tt&&(Re=se.overallVelocityY),this._super.attrTest.call(this,se)&&ve&se.offsetDirection&&se.distance>this.options.threshold&&se.maxPointers==this.options.pointers&&p(Re)>this.options.velocity&&se.eventType&Ke},emit:function(se){var ve=No(se.offsetDirection);ve&&this.manager.emit(this.options.event+ve,se),this.manager.emit(this.options.event,se)}});function nn(){Mo.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}B(nn,Mo,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Kr]},process:function(se){var ve=this.options,Re=se.pointers.length===ve.pointers,gt=se.distance<ve.threshold,$t=se.deltaTime<ve.time;if(this.reset(),se.eventType&We&&this.count===0)return this.failTimeout();if(gt&&$t&&Re){if(se.eventType!=Ke)return this.failTimeout();var vn=this.pTime?se.timeStamp-this.pTime<ve.interval:!0,ui=!this.pCenter||Be(this.pCenter,se.center)<ve.posThreshold;this.pTime=se.timeStamp,this.pCenter=se.center,!ui||!vn?this.count=1:this.count+=1,this._input=se;var Oe=this.count%ve.taps;if(Oe===0)return this.hasRequireFailures()?(this._timer=v(function(){this.state=Io,this.tryEmit()},ve.interval,this),wr):Io}return Br},failTimeout:function(){return this._timer=v(function(){this.state=Br},this.options.interval,this),Br},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Io&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Kn(se,ve){return ve=ve||{},ve.recognizers=ee(ve.recognizers,Kn.defaults.preset),new xo(se,ve)}Kn.VERSION="2.0.7",Kn.defaults={domEvents:!1,touchAction:Ko,enable:!0,inputTarget:null,inputClass:null,preset:[[qa,{enable:!1}],[go,{enable:!1},["rotate"]],[Ts,{direction:pt}],[er,{direction:pt},["swipe"]],[nn],[nn,{event:"doubletap",taps:2},["tap"]],[ra]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Jn=1,yo=2;function xo(se,ve){this.options=L({},Kn.defaults,ve||{}),this.options.inputTarget=this.options.inputTarget||se,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=se,this.input=wn(this),this.touchAction=new Xo(this,this.options.touchAction),ni(this,!0),T(this.options.recognizers,function(Re){var gt=this.add(new Re[0](Re[1]));Re[2]&&gt.recognizeWith(Re[2]),Re[3]&&gt.requireFailure(Re[3])},this)}xo.prototype={set:function(se){return L(this.options,se),se.touchAction&&this.touchAction.update(),se.inputTarget&&(this.input.destroy(),this.input.target=se.inputTarget,this.input.init()),this},stop:function(se){this.session.stopped=se?yo:Jn},recognize:function(se){var ve=this.session;if(!ve.stopped){this.touchAction.preventDefaults(se);var Re,gt=this.recognizers,$t=ve.curRecognizer;(!$t||$t&&$t.state&Io)&&($t=ve.curRecognizer=null);for(var vn=0;vn<gt.length;)Re=gt[vn],ve.stopped!==yo&&(!$t||Re==$t||Re.canRecognizeWith($t))?Re.recognize(se):Re.reset(),!$t&&Re.state&(wr|bo|zo)&&($t=ve.curRecognizer=Re),vn++}},get:function(se){if(se instanceof Mo)return se;for(var ve=this.recognizers,Re=0;Re<ve.length;Re++)if(ve[Re].options.event==se)return ve[Re];return null},add:function(se){if(w(se,"add",this))return this;var ve=this.get(se.options.event);return ve&&this.remove(ve),this.recognizers.push(se),se.manager=this,this.touchAction.update(),se},remove:function(se){if(w(se,"remove",this))return this;if(se=this.get(se),se){var ve=this.recognizers,Re=me(ve,se);Re!==-1&&(ve.splice(Re,1),this.touchAction.update())}return this},on:function(se,ve){if(se!==r&&ve!==r){var Re=this.handlers;return T(Ce(se),function(gt){Re[gt]=Re[gt]||[],Re[gt].push(ve)}),this}},off:function(se,ve){if(se!==r){var Re=this.handlers;return T(Ce(se),function(gt){ve?Re[gt]&&Re[gt].splice(me(Re[gt],ve),1):delete Re[gt]}),this}},emit:function(se,ve){this.options.domEvents&&Ro(se,ve);var Re=this.handlers[se]&&this.handlers[se].slice();if(!(!Re||!Re.length)){ve.type=se,ve.preventDefault=function(){ve.srcEvent.preventDefault()};for(var gt=0;gt<Re.length;)Re[gt](ve),gt++}},destroy:function(){this.element&&ni(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function ni(se,ve){var Re=se.element;if(Re.style){var gt;T(se.options.cssProps,function($t,vn){gt=ke(Re.style,vn),ve?(se.oldCssProps[gt]=Re.style[gt],Re.style[gt]=$t):Re.style[gt]=se.oldCssProps[gt]||""}),ve||(se.oldCssProps={})}}function Ro(se,ve){var Re=n.createEvent("Event");Re.initEvent(se,!0,!0),Re.gesture=ve,ve.target.dispatchEvent(Re)}L(Kn,{INPUT_START:We,INPUT_MOVE:kt,INPUT_END:Ke,INPUT_CANCEL:ht,STATE_POSSIBLE:ia,STATE_BEGAN:wr,STATE_CHANGED:bo,STATE_ENDED:zo,STATE_RECOGNIZED:Io,STATE_CANCELLED:Zo,STATE_FAILED:Br,DIRECTION_NONE:Pt,DIRECTION_LEFT:ae,DIRECTION_RIGHT:Ae,DIRECTION_UP:je,DIRECTION_DOWN:tt,DIRECTION_HORIZONTAL:pt,DIRECTION_VERTICAL:Tt,DIRECTION_ALL:tn,Manager:xo,Input:It,TouchAction:Xo,TouchInput:Ft,MouseInput:Pn,PointerEventInput:Pe,TouchMouseInput:ii,SingleTouchInput:Ge,Recognizer:Mo,AttrRecognizer:Ai,Tap:nn,Pan:er,Swipe:Ts,Pinch:go,Rotate:qa,Press:ra,on:ne,off:ye,each:T,merge:F,extend:k,assign:L,inherit:B,bindFn:G,prefixed:ke});var Ya=typeof e<"u"?e:typeof self<"u"?self:{};Ya.Hammer=Kn,typeof r=="function"&&r.amd?r(function(){return Kn}):t.exports?t.exports=Kn:e[i]=Kn})(window,document,"Hammer")})(L7);var S_=L7.exports;const _he=u_(S_),Wl=Q8({__proto__:null,default:_he},[S_]),O7=1,D7=2,sP=4,bhe={mousedown:O7,mousemove:D7,mouseup:sP};function xhe(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function whe(t){const e=t.prototype.handler;t.prototype.handler=function(i){const r=this.store;i.button>0&&i.type==="pointerdown"&&(xhe(r,o=>o.pointerId===i.pointerId)||r.push(i)),e.call(this,i)}}function Ehe(t){t.prototype.handler=function(n){let i=bhe[n.type];i&O7&&n.button>=0&&(this.pressed=!0),i&D7&&n.which===0&&(i=sP),this.pressed&&(i&sP&&(this.pressed=!1),this.callback(this.manager,i,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}whe(S_.PointerEventInput);Ehe(S_.MouseInput);const The=S_.Manager;class B2{constructor(e,n,i){this.element=e,this.callback=n,this.options={enable:!0,...i}}}const She=Wl?[[Wl.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Wl.Rotate,{enable:!1}],[Wl.Pinch,{enable:!1}],[Wl.Swipe,{enable:!1}],[Wl.Pan,{threshold:0,enable:!1}],[Wl.Press,{enable:!1}],[Wl.Tap,{event:"doubletap",taps:2,enable:!1}],[Wl.Tap,{event:"anytap",enable:!1}],[Wl.Tap,{enable:!1}]]:null,$5={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},Che={doubletap:["tap"]},Ahe={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},XM={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},Phe={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},G5={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},Ihe=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",qp=typeof window<"u"?window:global;let aP=!1;try{const t={get passive(){return aP=!0,!0}};qp.addEventListener("test",null,t),qp.removeEventListener("test",null)}catch{aP=!1}const Mhe=Ihe.indexOf("firefox")!==-1,{WHEEL_EVENTS:Rhe}=XM,H5="wheel",W5=4.000244140625,Lhe=40,Ohe=.25;class Dhe extends B2{constructor(e,n,i){super(e,n,i),this.handleEvent=r=>{if(!this.options.enable)return;let o=r.deltaY;qp.WheelEvent&&(Mhe&&r.deltaMode===qp.WheelEvent.DOM_DELTA_PIXEL&&(o/=qp.devicePixelRatio),r.deltaMode===qp.WheelEvent.DOM_DELTA_LINE&&(o*=Lhe)),o!==0&&o%W5===0&&(o=Math.floor(o/W5)),r.shiftKey&&o&&(o=o*Ohe),this.callback({type:H5,center:{x:r.clientX,y:r.clientY},delta:-o,srcEvent:r,pointerType:"mouse",target:r.target})},this.events=(this.options.events||[]).concat(Rhe),this.events.forEach(r=>e.addEventListener(r,this.handleEvent,aP?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===H5&&(this.options.enable=n)}}const{MOUSE_EVENTS:khe}=XM,K5="pointermove",X5="pointerover",Z5="pointerout",q5="pointerenter",Y5="pointerleave";class Fhe extends B2{constructor(e,n,i){super(e,n,i),this.handleEvent=o=>{this.handleOverEvent(o),this.handleOutEvent(o),this.handleEnterEvent(o),this.handleLeaveEvent(o),this.handleMoveEvent(o)},this.pressed=!1;const{enable:r}=this.options;this.enableMoveEvent=r,this.enableLeaveEvent=r,this.enableEnterEvent=r,this.enableOutEvent=r,this.enableOverEvent=r,this.events=(this.options.events||[]).concat(khe),this.events.forEach(o=>e.addEventListener(o,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===K5&&(this.enableMoveEvent=n),e===X5&&(this.enableOverEvent=n),e===Z5&&(this.enableOutEvent=n),e===q5&&(this.enableEnterEvent=n),e===Y5&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(X5,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(Z5,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(q5,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(Y5,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.which===0&&(this.pressed=!1),this.pressed||this._emit(K5,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:Bhe}=XM,J5="keydown",Q5="keyup";class zhe extends B2{constructor(e,n,i){super(e,n,i),this.handleEvent=r=>{const o=r.target||r.srcElement;o.tagName==="INPUT"&&o.type==="text"||o.tagName==="TEXTAREA"||(this.enableDownEvent&&r.type==="keydown"&&this.callback({type:J5,srcEvent:r,key:r.key,target:r.target}),this.enableUpEvent&&r.type==="keyup"&&this.callback({type:Q5,srcEvent:r,key:r.key,target:r.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(Bhe),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(r=>e.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===J5&&(this.enableDownEvent=n),e===Q5&&(this.enableUpEvent=n)}}const e6="contextmenu";class Nhe extends B2{constructor(e,n,i){super(e,n,i),this.handleEvent=r=>{this.options.enable&&this.callback({type:e6,center:{x:r.clientX,y:r.clientY},srcEvent:r,pointerType:"mouse",target:r.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===e6&&(this.options.enable=n)}}const lP=1,Ew=2,cP=4,Uhe={pointerdown:lP,pointermove:Ew,pointerup:cP,mousedown:lP,mousemove:Ew,mouseup:cP},Vhe=1,jhe=2,$he=3,Ghe=0,Hhe=1,Whe=2,Khe=1,Xhe=2,Zhe=4;function qhe(t){const e=Uhe[t.srcEvent.type];if(!e)return null;const{buttons:n,button:i,which:r}=t.srcEvent;let o=!1,l=!1,s=!1;return e===cP||e===Ew&&!Number.isFinite(n)?(o=r===Vhe,l=r===jhe,s=r===$he):e===Ew?(o=!!(n&Khe),l=!!(n&Zhe),s=!!(n&Xhe)):e===lP&&(o=i===Ghe,l=i===Hhe,s=i===Whe),{leftButton:o,middleButton:l,rightButton:s}}function Yhe(t,e){const n=t.center;if(!n)return null;const i=e.getBoundingClientRect(),r=i.width/e.offsetWidth||1,o=i.height/e.offsetHeight||1,l={x:(n.x-i.left-e.clientLeft)/r,y:(n.y-i.top-e.clientTop)/o};return{center:n,offsetCenter:l}}const tC={srcElement:"root",priority:0};class Jhe{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const i=this._normalizeEvent(n);let r=n.srcEvent.target;for(;r&&r!==i.rootElement;){if(this._emit(i,r),i.handled)return;r=r.parentNode}this._emit(i,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,i,r=!1,o=!1){const{handlers:l,handlersByElement:s}=this;let d=tC;typeof i=="string"||i&&i.addEventListener?d={...tC,srcElement:i}:i&&(d={...tC,...i});let p=s.get(d.srcElement);p||(p=[],s.set(d.srcElement,p));const y={type:e,handler:n,srcElement:d.srcElement,priority:d.priority};r&&(y.once=!0),o&&(y.passive=!0),l.push(y),this._active=this._active||!y.passive;let v=p.length-1;for(;v>=0&&!(p[v].priority>=y.priority);)v--;p.splice(v+1,0,y)}remove(e,n){const{handlers:i,handlersByElement:r}=this;for(let o=i.length-1;o>=0;o--){const l=i[o];if(l.type===e&&l.handler===n){i.splice(o,1);const s=r.get(l.srcElement);s.splice(s.indexOf(l),1),s.length===0&&r.delete(l.srcElement)}}this._active=i.some(o=>!o.passive)}_emit(e,n){const i=this.handlersByElement.get(n);if(i){let r=!1;const o=()=>{e.handled=!0},l=()=>{e.handled=!0,r=!0},s=[];for(let d=0;d<i.length;d++){const{type:p,handler:y,once:v}=i[d];if(y({...e,type:p,stopPropagation:o,stopImmediatePropagation:l}),v&&s.push(i[d]),r)break}for(let d=0;d<s.length;d++){const{type:p,handler:y}=s[d];this.remove(p,y)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...qhe(e),...Yhe(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const Qhe={events:null,recognizers:null,recognizerOptions:{},Manager:The,touchAction:"none",tabIndex:0};class ede{constructor(e=null,n){this._onBasicInput=r=>{const{srcEvent:o}=r,l=Ahe[o.type];l&&this.manager.emit(l,r)},this._onOtherEvent=r=>{this.manager.emit(r.type,r)},this.options={...Qhe,...n},this.events=new Map,this.setElement(e);const{events:i}=this.options;i&&this.on(i)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,i=n.Manager;this.manager=new i(e,{touchAction:n.touchAction,recognizers:n.recognizers||She}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys($5).forEach(r=>{const o=this.manager.get(r);o&&$5[r].forEach(l=>{o.recognizeWith(l)})});for(const r in n.recognizerOptions){const o=this.manager.get(r);if(o){const l=n.recognizerOptions[r];delete l.enable,o.set(l)}}this.wheelInput=new Dhe(e,this._onOtherEvent,{enable:!1}),this.moveInput=new Fhe(e,this._onOtherEvent,{enable:!1}),this.keyInput=new zhe(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new Nhe(e,this._onOtherEvent,{enable:!1});for(const[r,o]of this.events)o.isEmpty()||(this._toggleRecognizer(o.recognizerName,!0),this.manager.on(r,o.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,i){this._addEventHandler(e,n,i,!1)}once(e,n,i){this._addEventHandler(e,n,i,!0)}watch(e,n,i){this._addEventHandler(e,n,i,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:i}=this;if(!i)return;const r=i.get(e);if(r&&r.options.enable!==n){r.set({enable:n});const o=Che[e];o&&!this.options.recognizers&&o.forEach(l=>{const s=i.get(l);n?(s.requireFailure(e),r.dropRequireFailure(l)):s.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,i,r,o){if(typeof e!="string"){i=n;for(const y in e)this._addEventHandler(y,e[y],i,r,o);return}const{manager:l,events:s}=this,d=G5[e]||e;let p=s.get(d);p||(p=new Jhe(this),s.set(d,p),p.recognizerName=Phe[d]||d,l&&l.on(d,p.handleEvent)),p.add(e,n,i,r,o),p.isEmpty()||this._toggleRecognizer(p.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const l in e)this._removeEventHandler(l,e[l]);return}const{events:i}=this,r=G5[e]||e,o=i.get(r);if(o&&(o.remove(e,n),o.isEmpty())){const{recognizerName:l}=o;let s=!1;for(const d of i.values())if(d.recognizerName===l&&!d.isEmpty()){s=!0;break}s||this._toggleRecognizer(l,!1)}}}function Pd(){}const tde=({isDragging:t})=>t?"grabbing":"grab",k7={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:Pd,onResize:Pd,onViewStateChange:Pd,onInteractionStateChange:Pd,onBeforeRender:Pd,onAfterRender:Pd,onLoad:Pd,onError:t=>Ti.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:tde,getTooltip:null,debug:!1,drawPickingColors:!1};class ZM{constructor(e){q(this,"props",void 0),q(this,"width",0),q(this,"height",0),q(this,"userData",{}),q(this,"canvas",null),q(this,"viewManager",null),q(this,"layerManager",null),q(this,"effectManager",null),q(this,"deckRenderer",null),q(this,"deckPicker",null),q(this,"eventManager",null),q(this,"tooltip",null),q(this,"metrics",void 0),q(this,"animationLoop",void 0),q(this,"stats",void 0),q(this,"viewState",void 0),q(this,"cursorState",void 0),q(this,"_needsRedraw",void 0),q(this,"_pickRequest",void 0),q(this,"_lastPointerDownInfo",null),q(this,"_metricsCounter",void 0),q(this,"_onPointerMove",n=>{const{_pickRequest:i}=this;if(n.type==="pointerleave")i.x=-1,i.y=-1,i.radius=0;else{if(n.leftButton||n.rightButton)return;{const r=n.offsetCenter;if(!r)return;i.x=r.x,i.y=r.y,i.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:i.x,y:i.y}),i.event=n}),q(this,"_onEvent",n=>{const i=Lk[n.type],r=n.offsetCenter;if(!i||!r||!this.layerManager)return;const o=this.layerManager.getLayers(),l=this.deckPicker.getLastPickedObject({x:r.x,y:r.y,layers:o,viewports:this.getViewports(r)},this._lastPointerDownInfo),{layer:s}=l,d=s&&(s[i.handler]||s.props[i.handler]),p=this.props[i.handler];let y=!1;d&&(y=d.call(s,l,n)),!y&&p&&p(l,n)}),q(this,"_onPointerDown",n=>{const i=n.offsetCenter,r=this._pick("pickObject","pickObject Time",{x:i.x,y:i.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=r.result[0]||r.emptyInfo}),this.props={...k7,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&Ti.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),p9()==="IE"&&Ti.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new OM({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&Um.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,i,r,o,l,s,d;if((e=this.animationLoop)===null||e===void 0||e.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(n=this.layerManager)===null||n===void 0||n.finalize(),this.layerManager=null,(i=this.viewManager)===null||i===void 0||i.finalize(),this.viewManager=null,(r=this.effectManager)===null||r===void 0||r.finalize(),this.effectManager=null,(o=this.deckRenderer)===null||o===void 0||o.finalize(),this.deckRenderer=null,(l=this.deckPicker)===null||l===void 0||l.finalize(),this.deckPicker=null,(s=this.eventManager)===null||s===void 0||s.destroy(),this.eventManager=null,(d=this.tooltip)===null||d===void 0||d.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var p;(p=this.canvas.parentElement)===null||p===void 0||p.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Ti.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Ti.removed("onLayerClick","onClick")(),e.initialViewState&&!oc(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const i=this.viewManager.needsRedraw(e),r=this.layerManager.needsRedraw(e),o=this.effectManager.needsRedraw(e),l=this.deckRenderer.needsRedraw(e);return n=n||i||r||o||l,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return Go(this.viewManager),this.viewManager.views}getViewports(e){return Go(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const i in e)this.layerManager.resourceManager.add({resourceId:i,data:e[i],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_pick(e,n,i){Go(this.deckPicker);const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(n).timeStart();const o=this.deckPicker[e]({layers:this.layerManager.getLayers(i),views:this.viewManager.getViews(),viewports:this.getViewports(i),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...i});return r.get(n).timeEnd(),o}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),Go(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:i}=e;if(n||n===0){const o=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=o}if(i||i===0){var r;const o=Number.isFinite(i)?"".concat(i,"px"):i;this.canvas.style.position=((r=e.style)===null||r===void 0?void 0:r.position)||"absolute",this.canvas.style.height=o}}_updateCanvasSize(){var e,n;const{canvas:i}=this;if(!i)return;const r=(e=i.clientWidth)!==null&&e!==void 0?e:i.width,o=(n=i.clientHeight)!==null&&n!==void 0?n:i.height;if(r!==this.width||o!==this.height){var l,s;this.width=r,this.height=o,(l=this.viewManager)===null||l===void 0||l.setProps({width:r,height:o}),(s=this.layerManager)===null||s===void 0||s.activateViewport(this.getViewports()[0]),this.props.onResize({width:r,height:o})}}_createAnimationLoop(e){const{width:n,height:i,gl:r,glOptions:o,debug:l,onError:s,onBeforeRender:d,onAfterRender:p,useDevicePixels:y}=e;return new Ese({width:n,height:i,useDevicePixels:y,autoResizeDrawingBuffer:!r,autoResizeViewport:!1,gl:r,onCreateContext:v=>w9({...o,...v,canvas:this.canvas,debug:l,onContextLost:()=>this._onContextLost()}),onInitialize:v=>this._setGLContext(v.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:d,onAfterRender:p,onError:s})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new I7({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:i,emptyInfo:r}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=i.length>0;let o=r,l=!1;for(const s of i){var n;o=s,l=((n=s.layer)===null||n===void 0?void 0:n.onHover(s,e.event))||l}if(!l&&this.props.onHover&&this.props.onHover(o,e.event),this.props.getTooltip&&this.tooltip){const s=this.props.getTooltip(o);this.tooltip.setTooltip(s,o.x,o.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,LM(e,{enable:!0,copyState:!0})),this.tooltip=new vhe(this.canvas),nu(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new p7;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new ede(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const r in Lk)this.eventManager.on(r,this._onEvent);this.viewManager=new Gue({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const i=this.viewManager.getViewports()[0];this.layerManager=new $ue(e,{deck:this,stats:this.stats,viewport:i,timeline:n}),this.effectManager=new ahe,this.deckRenderer=new uhe(e),this.deckPicker=new ghe(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:i}=this.layerManager.context;nu(i,this.props.parameters),this.props.onBeforeRender({gl:i}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:i})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),Ti.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const i=Gd.get("Memory Usage");e.bufferMemory=i.get("Buffer Memory").count,e.textureMemory=i.get("Texture Memory").count,e.renderbufferMemory=i.get("Renderbuffer Memory").count,e.gpuMemory=i.get("GPU Memory").count}}q(ZM,"defaultProps",k7);q(ZM,"VERSION",Mie);class nC{constructor(e,n){q(this,"opts",void 0),q(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:i}=this.source,{size:r}=n;let o=i;if(i&&i.length!==r){o=new Float32Array(r);const l=n.elementOffset||0;for(let s=0;s<r;++s)o[s]=i[l+s]}return o}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function nde(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function Ix(t){return t.stride||t.size*t.bytesPerElement}function F7(t,e){e.offset&&Ti.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=Ix(t),i=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,r=e.elementOffset||0,o=i*n+r*t.bytesPerElement+(t.offset||0);return{...e,offset:o,stride:n}}function ide(t,e){const n=F7(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class rde{constructor(e,n,i){q(this,"gl",void 0),q(this,"id",void 0),q(this,"size",void 0),q(this,"settings",void 0),q(this,"value",void 0),q(this,"doublePrecision",void 0),q(this,"_buffer",void 0),q(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const r=n.logicalType||n.type,o=r===5130;let{defaultValue:l}=n;l=Number.isFinite(l)?[l]:l||new Array(this.size).fill(0);let s;o?s=5126:!r&&n.isIndexed?s=e&&R9(e,cr.ELEMENT_INDEX_UINT32)?5125:5123:s=r||5126;let d=nde(r||s||5126);this.doublePrecision=o,o&&n.fp64===!1&&(d=Float32Array),this.value=null,this.settings={...n,defaultType:d,defaultValue:l,logicalType:r,type:s,size:this.size,bytesPerElement:d.BYTES_PER_ELEMENT},this.state={...i,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new $i(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*Ix(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Um.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const i={},r=this.value instanceof Float64Array,o=ide(this.getAccessor(),n||{});return i[e]=new nC(this,o.high),i["".concat(e,"64Low")]=r?new nC(this,o.low):new Float32Array(this.size),i}if(n){const i=F7(this.getAccessor(),n);return{[e]:new nC(this,i)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:i,size:r}=this,o=i*r;if(n&&o&&n.length>=o){const l=new Array(r).fill(1/0),s=new Array(r).fill(-1/0);for(let d=0;d<o;)for(let p=0;p<r;p++){const y=n[d++];y<l[p]&&(l[p]=y),y>s[p]&&(s[p]=y)}e=[l,s]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let i;ArrayBuffer.isView(e)?i={value:e}:e instanceof $i?i={buffer:e}:i=e;const r={...this.settings,...i};if(n.bufferAccessor=r,n.bounds=null,i.constant){let o=i.value;if(o=this._normalizeValue(o,[],0),this.settings.normalized&&(o=this.normalizeConstant(o)),!(!n.constant||!this._areValuesEqual(o,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=o}else if(i.buffer){const o=i.buffer;n.externalBuffer=o,n.constant=!1,this.value=i.value||null;const l=i.value instanceof Float64Array;r.type=i.type||o.accessor.type,r.bytesPerElement=o.accessor.BYTES_PER_ELEMENT*(l?2:1),r.stride=Ix(r)}else if(i.value){this._checkExternalBuffer(i);let o=i.value;n.externalBuffer=null,n.constant=!1,this.value=o,r.bytesPerElement=o.BYTES_PER_ELEMENT,r.stride=Ix(r);const{buffer:l,byteOffset:s}=this;this.doublePrecision&&o instanceof Float64Array&&(o=JS(o,r));const d=o.byteLength+s+r.stride*2;l.byteLength<d&&l.reallocate(d),l.setAccessor(null),l.subData({data:o,offset:s}),r.type=i.type||l.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:i=0,endOffset:r}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?JS(n,{size:this.size,startIndex:i,endIndex:r}):n.subarray(i,r),offset:i*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:i}=this,r=i.allocatedValue,o=Um.allocate(r,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=o;const{buffer:l,byteOffset:s}=this;return l.byteLength<o.byteLength+s&&(l.reallocate(o.byteLength+s),n&&r&&l.subData({data:r instanceof Float64Array?JS(r,this):r,offset:s})),i.allocatedValue=o,i.constant=!1,i.externalBuffer=null,i.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const i=this.settings.defaultType;let r=!1;if(this.doublePrecision&&(r=n.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof i)&&this.settings.normalized&&!("normalized"in e)&&Ti.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,i){const{defaultValue:r,size:o}=this.settings;if(Number.isFinite(e))return n[i]=e,n;if(!e){let l=o;for(;--l>=0;)n[i+l]=r[l];return n}switch(o){case 4:n[i+3]=Number.isFinite(e[3])?e[3]:r[3];case 3:n[i+2]=Number.isFinite(e[2])?e[2]:r[2];case 2:n[i+1]=Number.isFinite(e[1])?e[1]:r[1];case 1:n[i+0]=Number.isFinite(e[0])?e[0]:r[0];break;default:let l=o;for(;--l>=0;)n[i+l]=Number.isFinite(e[l])?e[l]:r[l]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:i}=this;for(let r=0;r<i;r++)if(e[r]!==n[r])return!1;return!0}}const t6=[],n6=[];function z2(t,e=0,n=1/0){let i=t6;const r={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?i=t:t.length>0&&(n6.length=t.length,i=n6):i=t6,(e>0||Number.isFinite(n))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(e,n),r.index=e-1),{iterable:i,objectInfo:r}}function B7(t){return t&&t[Symbol.asyncIterator]}function z7(t,e){const{size:n,stride:i,offset:r,startIndices:o,nested:l}=e,s=t.BYTES_PER_ELEMENT,d=i?i/s:n,p=r?r/s:0,y=Math.floor((t.length-p)/d);return(v,{index:w,target:T})=>{if(!o){const F=w*d+p;for(let B=0;B<n;B++)T[B]=t[F+B];return T}const I=o[w],L=o[w+1]||y;let k;if(l){k=new Array(L-I);for(let F=I;F<L;F++){const B=F*d+p;T=new Array(n);for(let G=0;G<n;G++)T[G]=t[B+G];k[F-I]=T}}else if(d===n)k=t.subarray(I*n+p,L*n+p);else{k=new t.constructor((L-I)*n);let F=0;for(let B=I;B<L;B++){const G=B*d+p;for(let U=0;U<n;U++)k[F++]=t[G+U]}}return k}}const ode=[],Mx=[[0,1/0]];function sde(t,e){if(t===Mx||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],i=t.length;let r=0;for(let o=0;o<i;o++){const l=t[o];l[1]<e[0]?(n.push(l),r=o+1):l[0]>e[1]?n.push(l):e=[Math.min(l[0],e[0]),Math.max(l[1],e[1])]}return n.splice(r,0,e),n}function iC(t){const{source:e,target:n,start:i=0,size:r,getData:o}=t,l=t.end||n.length,s=e.length,d=l-i;if(s>d){n.set(e.subarray(0,d),i);return}if(n.set(e,i),!o)return;let p=s;for(;p<d;){const y=o(p,e);for(let v=0;v<r;v++)n[i+p]=y[v]||0,p++}}function ade({source:t,target:e,size:n,getData:i,sourceStartIndices:r,targetStartIndices:o}){if(!Array.isArray(o))return iC({source:t,target:e,size:n,getData:i}),e;let l=0,s=0;const d=i&&((y,v)=>i(y+s,v)),p=Math.min(r.length,o.length);for(let y=1;y<p;y++){const v=r[y]*n,w=o[y]*n;iC({source:t.subarray(l,v),target:e,start:s,end:w,size:n,getData:d}),l=v,s=w}return s<e.length&&iC({source:[],target:e,start:s,size:n,getData:d}),e}const lde={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function N7(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...lde[n],...e,...t,type:n}}function U7(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function V7(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function j7(t){t.push(t.shift())}function qM(t,e){const{doublePrecision:n,settings:i,value:r,size:o}=t,l=n&&r instanceof Float64Array?2:1;return(i.noAlloc?r.length:e*o)*l}function $7({buffer:t,numInstances:e,attribute:n,fromLength:i,fromStartIndices:r,getData:o=l=>l}){const l=n.doublePrecision&&n.value instanceof Float64Array?2:1,s=n.size*l,d=n.byteOffset,p=n.startIndices,y=r&&p,v=qM(n,e),w=n.isConstant;if(!y&&i>=v)return;const T=w?n.value:n.getBuffer().getData({srcByteOffset:d});if(n.settings.normalized&&!w){const F=o;o=(B,G)=>n.normalizeConstant(F(B,G))}const I=w?(F,B)=>o(T,B):(F,B)=>o(T.subarray(F,F+s),B),L=t.getData({length:i}),k=new Float32Array(v);ade({source:L,target:k,sourceStartIndices:r,targetStartIndices:p,size:s,getData:I}),t.byteLength<k.byteLength+d&&t.reallocate(k.byteLength+d),t.subData({data:k,offset:d})}class YM extends rde{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:Mx}),q(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,i=this.settings.transition,r=Array.isArray(n)?e[n.find(o=>e[o])]:e[n];return N7(r,i)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:i=0,endRow:r=1/0}=n;this.state.updateRanges=sde(this.state.updateRanges,[i,r])}else this.state.updateRanges=Mx}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=ode}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:i}=this;return i.noAlloc?!1:i.update?(super.allocate(e,n.updateRanges!==Mx),!0):!1}updateBuffer({numInstances:e,data:n,props:i,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:o},settings:{update:l,noAlloc:s}}=this;let d=!0;if(l){for(const[p,y]of o)l.call(r,this,{data:n,startRow:p,endRow:y,props:i,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[p,y]of o){const v=Number.isFinite(p)?this.getVertexOffset(p):0,w=Number.isFinite(y)?this.getVertexOffset(y):s||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:v,endOffset:w})}this._checkAttributeArray()}else d=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),d}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:i,settings:r}=this;if(!e)return i.binaryValue=null,i.binaryAccessor=null,!1;if(r.noAlloc)return!1;if(i.binaryValue===e)return this.clearNeedsUpdate(),!0;if(i.binaryValue=e,this.setNeedsRedraw(),r.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const l=e;Go(ArrayBuffer.isView(l.value),"invalid ".concat(r.accessor));const s=!!l.size&&l.size!==this.size;return i.binaryAccessor=z7(l.value,{size:l.size||this.size,stride:l.stride,offset:l.offset,startIndices:n,nested:s}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const i in e)Object.assign(n,super.getShaderAttributes(i,e[i]));return n}_autoUpdater(e,{data:n,startRow:i,endRow:r,props:o,numInstances:l}){if(e.constant)return;const{settings:s,state:d,value:p,size:y,startIndices:v}=e,{accessor:w,transform:T}=s,I=d.binaryAccessor||(typeof w=="function"?w:o[w]);Go(typeof I=="function",'accessor "'.concat(w,'" is not a function'));let L=e.getVertexOffset(i);const{iterable:k,objectInfo:F}=z2(n,i,r);for(const B of k){F.index++;let G=I(B,F);if(T&&(G=T.call(this,G)),v){const U=(F.index<v.length-1?v[F.index+1]:l)-v[F.index];if(G&&Array.isArray(G[0])){let ee=L;for(const ne of G)e._normalizeValue(ne,p,ee),ee+=y}else G&&G.length>y?p.set(G,L):(e._normalizeValue(G,F.target,0),Oue({target:p,source:F.target,start:L,count:U}));L+=U*y}else e._normalizeValue(G,p,L),L+=y}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let i=!0;switch(n){case 4:i=i&&Number.isFinite(e[3]);case 3:i=i&&Number.isFinite(e[2]);case 2:i=i&&Number.isFinite(e[1]);case 1:i=i&&Number.isFinite(e[0]);break;default:i=!1}if(!i)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class cde{constructor({gl:e,attribute:n,timeline:i}){q(this,"gl",void 0),q(this,"type","interpolation"),q(this,"attributeInTransition",void 0),q(this,"settings",void 0),q(this,"attribute",void 0),q(this,"transition",void 0),q(this,"currentStartIndices",void 0),q(this,"currentLength",void 0),q(this,"transform",void 0),q(this,"buffers",void 0),this.gl=e,this.transition=new T_(i),this.attribute=n,this.attributeInTransition=new YM(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=hde(e,n);const r={byteLength:0,usage:35050};this.buffers=[new $i(e,r),new $i(e,r)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:i,buffers:r,attribute:o}=this;j7(r);const l={numInstances:n,attribute:o,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const s of r)$7({buffer:s,...l});this.currentStartIndices=o.startIndices,this.currentLength=qM(o,n),this.attributeInTransition.setData({buffer:r[1],value:o.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/o.size),sourceBuffers:{aFrom:r[0],aTo:U7(i,o)},feedbackBuffers:{vCurrent:r[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:i}=this.settings,{time:r}=this.transition;let o=r/n;i&&(o=i(o)),this.transform.run({uniforms:{time:o}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const ude=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function hde(t,e){const n=V7(e.size);return new Bm(t,{vs:ude,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class dde{constructor({gl:e,attribute:n,timeline:i}){q(this,"gl",void 0),q(this,"type","spring"),q(this,"attributeInTransition",void 0),q(this,"settings",void 0),q(this,"attribute",void 0),q(this,"transition",void 0),q(this,"currentStartIndices",void 0),q(this,"currentLength",void 0),q(this,"texture",void 0),q(this,"framebuffer",void 0),q(this,"transform",void 0),q(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new T_(i),this.attribute=n,this.attributeInTransition=new YM(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=pde(e),this.framebuffer=mde(e,this.texture),this.transform=fde(e,n,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new $i(e,r),new $i(e,r),new $i(e,r)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:i,buffers:r,attribute:o}=this,l={numInstances:n,attribute:o,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const s of r)$7({buffer:s,...l});this.settings=e,this.currentStartIndices=o.startIndices,this.currentLength=qM(o,n),this.attributeInTransition.setData({buffer:r[1],value:o.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/o.size),sourceBuffers:{aTo:U7(i,o)}})}update(){const{buffers:e,transform:n,framebuffer:i,transition:r}=this;if(!r.update())return!1;const l=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:i,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:l.stiffness,damping:l.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),j7(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),b_(i)[0]>0||r.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function fde(t,e,n){const i=V7(e.size);return new Bm(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:i},varyings:["vNext"]})}function pde(t){return new ws(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function mde(t,e){return new ko(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}const gde={interpolation:cde,spring:dde};class yde{constructor(e,{id:n,timeline:i}){q(this,"id",void 0),q(this,"isSupported",void 0),q(this,"gl",void 0),q(this,"timeline",void 0),q(this,"transitions",void 0),q(this,"needsRedraw",void 0),q(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=Bm.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:i}){this.numInstances=i||1;for(const r in e){const o=e[r],l=o.getTransitionSetting(n);l&&this._updateAttribute(r,o,l)}for(const r in this.transitions){const o=e[r];(!o||!o.getTransitionSetting(n))&&this._removeTransition(r)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const i=this.transitions[n];i.inProgress&&(e[n]=i.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,i){const r=this.transitions[e];let o=!r||r.type!==i.type;if(o){if(!this.isSupported){Ti.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}r&&this._removeTransition(e);const l=gde[i.type];l?this.transitions[e]=new l({attribute:n,timeline:this.timeline,gl:this.gl}):(Ti.error("unsupported transition type '".concat(i.type,"'"))(),o=!1)}(o||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(i,this.numInstances))}}const i6="attributeManager.invalidate",vde="attributeManager.updateStart",_de="attributeManager.updateEnd",bde="attribute.updateStart",xde="attribute.allocate",wde="attribute.updateEnd";class JM{constructor(e,{id:n="attribute-manager",stats:i,timeline:r}={}){q(this,"id",void 0),q(this,"gl",void 0),q(this,"attributes",void 0),q(this,"updateTriggers",void 0),q(this,"needsRedraw",void 0),q(this,"userData",void 0),q(this,"stats",void 0),q(this,"attributeTransitionManager",void 0),q(this,"mergeBoundsMemoized",E_(Tue)),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=i,this.attributeTransitionManager=new yde(e,{id:"".concat(n,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const i=this._invalidateTrigger(e,n);ms(i6,this,e,i)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);ms(i6,this,"all")}update({data:e,numInstances:n,startIndices:i=null,transitions:r,props:o={},buffers:l={},context:s={}}){let d=!1;ms(vde,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const p in this.attributes){const y=this.attributes[p],v=y.settings.accessor;y.startIndices=i,y.numInstances=n,o[p]&&Ti.removed("props.".concat(p),"data.attributes.".concat(p))(),y.setExternalBuffer(l[p])||y.setBinaryValue(typeof v=="string"?l[v]:void 0,e.startIndices)||typeof v=="string"&&!l[v]&&y.setConstantValue(o[v])||y.needsUpdate()&&(d=!0,this._updateAttribute({attribute:y,numInstances:n,data:e,props:o,context:s})),this.needsRedraw=this.needsRedraw||y.needsRedraw()}d&&ms(_de,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:r})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getBounds(e){const n=e.map(i=>{var r;return(r=this.attributes[i])===null||r===void 0?void 0:r.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:i}=this,r={...i.getAttributes()};for(const o in n){const l=n[o];l.needsRedraw(e)&&!i.hasAttribute(o)&&(r[o]=l)}return r}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const i={};for(const r in e)n[r]||Object.assign(i,e[r].getShaderAttributes());return i}_add(e,n={}){for(const i in e){const r=e[i];this.attributes[i]=this._createAttribute(i,r,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,i){const r={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:i.instanced?1:n.divisor||0};return new YM(this.gl,r)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(r=>{e[r]||(e[r]=[]),e[r].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:i,updateTriggers:r}=this,o=r[e];return o&&o.forEach(l=>{const s=i[l];s&&s.setNeedsUpdate(s.id,n)}),o}_updateAttribute(e){const{attribute:n,numInstances:i}=e;if(ms(bde,n),n.constant){n.setConstantValue(n.value);return}n.allocate(i)&&ms(xde,n,i),n.updateBuffer(e)&&(this.needsRedraw=!0,ms(wde,n,i))}}class Ede extends T_{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:i,duration:r,easing:o}}=this,l=o(e/r);this._value=Yd(n,i,l)}}const r6=1e-5;function o6(t,e,n,i,r){const o=e-t,s=(n-e)*r,d=-o*i;return s+d+o+e}function Tde(t,e,n,i,r){if(Array.isArray(n)){const o=[];for(let l=0;l<n.length;l++)o[l]=o6(t[l],e[l],n[l],i,r);return o}return o6(t,e,n,i,r)}function s6(t,e){if(Array.isArray(t)){let n=0;for(let i=0;i<t.length;i++){const r=t[i]-e[i];n+=r*r}return Math.sqrt(n)}return Math.abs(t-e)}class Sde extends T_{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:i,stiffness:r}=this.settings,{_prevValue:o=e,_currValue:l=e}=this;let s=Tde(o,l,n,i,r);const d=s6(s,n),p=s6(s,l);d<r6&&p<r6&&(s=n,this.end()),this._prevValue=l,this._currValue=s}}const Cde={interpolation:Ede,spring:Sde};class Ade{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,i,r){const{transitions:o}=this;if(o.has(e)){const d=o.get(e),{value:p=d.settings.fromValue}=d;n=p,this.remove(e)}if(r=N7(r),!r)return;const l=Cde[r.type];if(!l){Ti.error("unsupported transition type '".concat(r.type,"'"))();return}const s=new l(this.timeline);s.start({...r,fromValue:n,toValue:i}),o.set(e,s)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,i]of this.transitions)i.update(),e[n]=i.value,i.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function Pde(t){const e=t[Sh];for(const n in e){const i=e[n],{validate:r}=i;if(r&&!r(t[n],i))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function Ide(t,e){const n=QM({newProps:t,oldProps:e,propTypes:t[Sh],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=Rde(t,e);let r=!1;return i||(r=Lde(t,e)),{dataChanged:i,propsChanged:n,updateTriggersChanged:r,extensionsChanged:Ode(t,e),transitionsChanged:Mde(t,e)}}function Mde(t,e){if(!t.transitions)return!1;const n={},i=t[Sh];let r=!1;for(const o in t.transitions){const l=i[o],s=l&&l.type;(s==="number"||s==="color"||s==="array")&&uP(t[o],e[o],l)&&(n[o]=!0,r=!0)}return r?n:!1}function QM({newProps:t,oldProps:e,ignoreProps:n={},propTypes:i={},triggerName:r="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(r," changed shallowly");for(const o of Object.keys(t))if(!(o in n)){if(!(o in e))return"".concat(r,".").concat(o," added");const l=uP(t[o],e[o],i[o]);if(l)return"".concat(r,".").concat(o," ").concat(l)}for(const o of Object.keys(e))if(!(o in n)){if(!(o in t))return"".concat(r,".").concat(o," dropped");if(!Object.hasOwnProperty.call(t,o)){const l=uP(t[o],e[o],i[o]);if(l)return"".concat(r,".").concat(o," ").concat(l)}}return!1}function uP(t,e,n){let i=n&&n.equal;return i&&!i(t,e,n)||!i&&(i=t&&e&&t.equals,i&&!i.call(t,e))?"changed deeply":!i&&e!==t?"changed shallowly":null}function Rde(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:i,_dataDiff:r}=t;return i?i(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&r&&(n=r(t.data,e.data)||n),n}function Lde(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&a6(t,e,"all"))return{all:!0};const n={};let i=!1;for(const r in t.updateTriggers)r!=="all"&&a6(t,e,r)&&(n[r]=!0,i=!0);return i?n:!1}function Ode(t,e){if(e===null)return!0;const n=e.extensions,{extensions:i}=t;if(i===n)return!1;if(!n||!i||i.length!==n.length)return!0;for(let r=0;r<i.length;r++)if(!i[r].equals(n[r]))return!0;return!1}function a6(t,e,n){let i=t.updateTriggers[n];i=i??{};let r=e.updateTriggers[n];return r=r??{},QM({oldProps:r,newProps:i,triggerName:n})}const Dde="count(): argument not an object",kde="count(): argument not a container";function Fde(t){if(!zde(t))throw new Error(Dde);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(Bde(t))return Object.keys(t).length;throw new Error(kde)}function Bde(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function zde(t){return t!==null&&typeof t=="object"}function Nde(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(i=>i.name==="project64"))){const i=n.modules.findIndex(r=>r.name==="project32");i>=0&&n.modules.splice(i,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const i={...t.inject};for(const r in e.inject)i[r]=(i[r]||"")+e.inject[r];n.inject=i}return n}const Ude={10241:9987,10240:9729,10242:33071,10243:33071},hP={};function Vde(t,e,n,i){if(n instanceof ws)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let r=null;n.compressed&&(r={10241:n.data.length>1?9985:9729});const o=new ws(e,{...n,parameters:{...Ude,...r,...i}});return hP[o.id]=t,o}function jde(t,e){!e||!(e instanceof ws)||hP[e.id]===t&&(e.delete(),delete hP[e.id])}const $de={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||dP(t)&&(t.length===3||t.length===4)},equal(t,e,n){return oc(t,e,1)}},accessor:{validate(t,e){const n=Tw(t);return n==="function"||n===Tw(e.value)},equal(t,e,n){return typeof e=="function"?!0:oc(t,e,1)}},array:{validate(t,e){return e.optional&&!t||dP(t)},equal(t,e,n){const{compare:i}=n,r=Number.isInteger(i)?i:i?1:0;return i?oc(t,e,r):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:i}=n,r=Number.isInteger(i)?i:i?1:0;return i?oc(t,e,r):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:i}=n.props;return i&&t?i(t):t}},image:{transform:(t,e,n)=>{const i=n.context;return!i||!i.gl?null:Vde(n.id,i.gl,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{jde(n.id,t)}}};function Gde(t){const e={},n={},i={};for(const[r,o]of Object.entries(t)){const l=o==null?void 0:o.deprecatedFor;if(l)i[r]=Array.isArray(l)?l:[l];else{const s=Hde(r,o);e[r]=s,n[r]=s.value}}return{propTypes:e,defaultProps:n,deprecatedProps:i}}function Hde(t,e){switch(Tw(e)){case"object":return ky(t,e);case"array":return ky(t,{type:"array",value:e,compare:!1});case"boolean":return ky(t,{type:"boolean",value:e});case"number":return ky(t,{type:"number",value:e});case"function":return ky(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function ky(t,e){return"type"in e?{name:t,...$de[e.type],...e}:"value"in e?{name:t,type:Tw(e.value),...e}:{name:t,type:"object",value:e}}function dP(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Tw(t){return dP(t)?"array":t===null?"null":typeof t}function Wde(t,e){let n;for(let o=e.length-1;o>=0;o--){const l=e[o];"extensions"in l&&(n=l.extensions)}const i=fP(t.constructor,n),r=Object.create(i);r[ww]=t,r[df]={},r[vh]={};for(let o=0;o<e.length;++o){const l=e[o];for(const s in l)r[s]=l[s]}return Object.freeze(r),r}const Kde="_mergedDefaultProps";function fP(t,e){let n=Kde;if(e)for(const r of e){const o=r.constructor;o&&(n+=":".concat(o.extensionName||o.name))}const i=G7(t,n);return i||(t[n]=Xde(t,e||[]))}function Xde(t,e){if(!t.prototype)return null;const i=Object.getPrototypeOf(t),r=fP(i),o=G7(t,"defaultProps")||{},l=Gde(o),s=Object.assign(Object.create(null),r,l.defaultProps),d=Object.assign(Object.create(null),r==null?void 0:r[Sh],l.propTypes),p=Object.assign(Object.create(null),r==null?void 0:r[eC],l.deprecatedProps);for(const y of e){const v=fP(y.constructor);v&&(Object.assign(s,v),Object.assign(d,v[Sh]),Object.assign(p,v[eC]))}return Zde(s,t),Yde(s,d),qde(s,p),s[Sh]=d,s[eC]=p,e.length===0&&!e3(t,"_propTypes")&&(t._propTypes=d),s}function Zde(t,e){const n=Qde(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function qde(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(i){const r="".concat(this.id,": ").concat(n);for(const o of e[n])e3(this,o)||(this[o]=i);Ti.deprecated(r,e[n].join("/"))()}})}function Yde(t,e){const n={},i={};for(const r in e){const o=e[r],{name:l,value:s}=o;o.async&&(n[l]=s,i[l]=Jde(l))}t[ym]=n,t[df]={},Object.defineProperties(t,i)}function Jde(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||B7(e)?this[df][t]=e:this[vh][t]=e},get(){if(this[vh]){if(t in this[vh])return this[vh][t]||this[ym][t];if(t in this[df]){const e=this[ww]&&this[ww].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[ym][t]}}return this[ym][t]}}}function e3(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function G7(t,e){return e3(t,e)&&t[e]}function Qde(t){const e=t.componentName;return e||Ti.warn("".concat(t.name,".componentName not specified"))(),e||t.name}let efe=0;class t3{constructor(...e){q(this,"id",void 0),q(this,"props",void 0),q(this,"count",void 0),this.props=Wde(this,e),this.id=this.props.id,this.count=efe++}clone(e){const{props:n}=this,i={};for(const r in n[ym])r in n[vh]?i[r]=n[vh][r]:r in n[df]&&(i[r]=n[df][r]);return new this.constructor({...n,...i,...e})}}q(t3,"componentName","Component");q(t3,"defaultProps",{});const tfe=Object.freeze({});class nfe{constructor(e){q(this,"component",void 0),q(this,"onAsyncPropUpdated",void 0),q(this,"asyncProps",void 0),q(this,"oldProps",void 0),q(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||tfe}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[ww]||this.component;const n=e[vh]||{},i=e[df]||e,r=e[ym]||{};for(const o in n){const l=n[o];this._createAsyncPropData(o,r[o]),this._updateAsyncProp(o,l),n[o]=this.getAsyncProp(o)}for(const o in i){const l=i[o];this._createAsyncPropData(o,r[o]),this._updateAsyncProp(o,l)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(B7(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const i=this.asyncProps[e];return n===i.resolvedValue||n===i.lastValue?!1:(i.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const i=this.asyncProps[e];i&&(n=this._postProcessValue(i,n),i.resolvedValue=n,i.pendingLoadCount++,i.resolvedLoadCount=i.pendingLoadCount)}_setAsyncPropValue(e,n,i){const r=this.asyncProps[e];r&&i>=r.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),r.resolvedValue=n,r.resolvedLoadCount=i,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const i=this.asyncProps[e];if(i){i.pendingLoadCount++;const r=i.pendingLoadCount;n.then(o=>{this.component&&(o=this._postProcessValue(i,o),this._setAsyncPropValue(e,o,r),this._onResolve(e,o))}).catch(o=>{this._onError(e,o)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const i=this.asyncProps[e];if(!i)return;i.pendingLoadCount++;const r=i.pendingLoadCount;let o=[],l=0;for await(const s of n){if(!this.component)return;const{dataTransform:d}=this.component.props;d?o=d(s,o):o=o.concat(s),Object.defineProperty(o,"__diff",{enumerable:!1,value:[{startRow:l,endRow:o.length}]}),l=o.length,this._setAsyncPropValue(e,o,r)}this._onResolve(e,o)}_postProcessValue(e,n){const i=e.type;return i&&this.component&&(i.release&&i.release(e.resolvedValue,i,this.component),i.transform)?i.transform(n,i,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const r=this.component&&this.component.props[Sh];this.asyncProps[e]={type:r&&r[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class ife extends nfe{constructor({attributeManager:e,layer:n}){super(n),q(this,"attributeManager",void 0),q(this,"needsRedraw",void 0),q(this,"needsUpdate",void 0),q(this,"subLayers",void 0),q(this,"usesPickingColorCache",void 0),q(this,"hasPickingBuffer",void 0),q(this,"changeFlags",void 0),q(this,"viewport",void 0),q(this,"uniformTransitions",void 0),q(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const i=this.layer,r=i==null?void 0:i.props.fetch;return r?r(n,{propName:e,layer:i}):super._fetch(e,n)}_onResolve(e,n){const i=this.layer;if(i){const r=i.props.onDataLoad;e==="data"&&r&&r(n,{propName:e,layer:i})}}_onError(e,n){const i=this.layer;i&&i.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const rfe="layer.changeFlag",ofe="layer.initialize",sfe="layer.update",afe="layer.finalize",lfe="layer.matched",l6=2**24-1,cfe=Object.freeze([]),ufe=E_(({oldViewport:t,viewport:e})=>t.equals(e));let Kl=new Uint8ClampedArray(0);const hfe={data:{type:"data",value:cfe,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:i,loadOptions:r,signal:o})=>{const{resourceManager:l}=n.context;if(r=r||n.getLoadOptions(),i=i||n.props.loaders,o){var s;r={...r,fetch:{...(s=r)===null||s===void 0?void 0:s.fetch,signal:o}}}let d=l.contains(t);return!d&&!r&&(l.add({resourceId:t,data:mv(t,i),persistent:!1}),d=!0),d?l.subscribe({resourceId:t,onChange:p=>{var y;return(y=n.internalState)===null||y===void 0?void 0:y.reloadAsyncProp(e,p)},consumerId:n.id,requestId:e}):mv(t,i,r)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Li.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class Ka extends t3{constructor(...e){super(...e),q(this,"internalState",null),q(this,"lifecycle",Gp.NO_STATE),q(this,"context",void 0),q(this,"state",void 0),q(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){Go(this.internalState);const n=this.internalState.viewport||this.context.viewport,i=S7(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[r,o,l]=E7(i,n.pixelProjectionMatrix);return e.length===2?[r,o]:[r,o,l]}unproject(e){return Go(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){Go(this.internalState);const i=this.internalState.viewport||this.context.viewport;return Mue(e,{viewport:i,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===Li.DEFAULT||e===Li.LNGLAT||e===Li.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){Go(e instanceof Uint8Array);const[n,i,r]=e;return n+i*256+r*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:Fde(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())===null||e===void 0?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){for(const n of this.props.extensions)e=Nde(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:i}=e.changeFlags;if(i&&n)if(Array.isArray(i))for(const r of i)n.invalidateAll(r);else n.invalidateAll();if(n){const{props:r}=e,o=this.internalState.hasPickingBuffer,l=Number.isInteger(r.highlightedObjectIndex)||r.pickable||r.extensions.some(s=>s.getNeedsPickingBuffer.call(this,s));if(o!==l){this.internalState.hasPickingBuffer=l;const{pickingColors:s,instancePickingColors:d}=n.attributes,p=s||d;p&&(l&&p.constant&&(p.constant=!1,n.invalidate(p.id)),!p.value&&!l&&(p.constant=!0,p.value=[0,0,0]))}}}finalizeState(e){for(const i of this.getModels())i.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:i}){const{index:r}=e;return r>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[r]),e}raiseError(e,n){var i,r;if(n&&(e=new Error("".concat(n,": ").concat(e.message),{cause:e})),!((i=(r=this.props).onError)!==null&&i!==void 0&&i.call(r,e))){var o,l;(o=this.context)===null||o===void 0||(l=o.onError)===null||l===void 0||l.call(o,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!ufe({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,i=this.getNumInstances(),r=this.getStartIndices();e.update({data:n.data,numInstances:i,startIndices:r,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const o=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(o)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),i=Object.create(this.props);for(const r in n)Object.defineProperty(i,r,{value:n[r]});return i}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const i=Math.floor(Kl.length/3);if(this.internalState.usesPickingColorCache=!0,i<n){n>l6&&Ti.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Kl=Um.allocate(Kl,n,{size:3,copy:!0,maxCount:Math.max(n,l6)});const r=Math.floor(Kl.length/3),o=[];for(let l=i;l<r;l++)this.encodePickingColor(l,o),Kl[l*3+0]=o[0],Kl[l*3+1]=o[1],Kl[l*3+2]=o[2]}e.value=Kl.subarray(0,n*3)}_setModelAttributes(e,n){const i=this.getAttributeManager(),r=e.userData.excludeAttributes||{},o=i.getShaderAttributes(n,r);e.setAttributes(o)}disablePickingIndex(e){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(e);return}const{pickingColors:i,instancePickingColors:r}=this.getAttributeManager().attributes,o=i||r,l=o&&n.attributes&&n.attributes[o.id];if(l&&l.value){const s=l.value,d=this.encodePickingColor(e);for(let p=0;p<n.length;p++){const y=o.getVertexOffset(p);s[y]===d[0]&&s[y+1]===d[1]&&s[y+2]===d[2]&&this._disablePickingIndex(p)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:i}=this.getAttributeManager().attributes,r=n||i;if(!r)return;const o=r.getVertexOffset(e),l=r.getVertexOffset(e+1);r.buffer.subData({data:new Uint8Array(l-o),offset:o})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,i=e||n;i&&(this.internalState.usesPickingColorCache&&i.value.buffer!==Kl.buffer&&(i.value=Kl.subarray(0,i.value.length)),i.updateSubBuffer({startOffset:0}))}_initialize(){Go(!this.internalState),Go(Number.isFinite(this.props.coordinateSystem)),ms(ofe,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new ife({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Ti.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new Ade(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){ms(lfe,this,this===e);const{state:n,internalState:i}=e;this!==e&&(this.internalState=i,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(ms(sfe,this,e),!e)return;const n=this.props,i=this.context,r=this.internalState,o=i.viewport,l=this._updateUniformTransition();r.propsInTransition=l,i.viewport=r.viewport||o,this.props=l;try{const s=this._getUpdateParams(),d=this.getModels();if(i.gl)this.updateState(s);else try{this.updateState(s)}catch{}for(const y of this.props.extensions)y.updateState.call(this,s,y);const p=this.getModels()[0]!==d[0];this._postUpdate(s,p)}finally{i.viewport=o,this.props=n,this._clearChangeFlags(),r.needsUpdate=!1,r.resetOldProps()}}_finalize(){ms(afe,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:i={}}){this._updateAttributeTransition();const r=this.props,o=this.context;this.props=this.internalState.propsInTransition||r;const l=this.props.opacity;n.opacity=Math.pow(l,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:s}=this.props,d=s&&s(n)||[0,0];nu(o.gl,{polygonOffset:d}),Ga(o.gl,i,()=>{const p={moduleParameters:e,uniforms:n,parameters:i,context:o};for(const y of this.props.extensions)y.draw.call(this,p,y);this.draw(p)})}finally{this.props=r}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const r in e)if(e[r]){let o=!1;switch(r){case"dataChanged":const l=e[r],s=n[r];l&&Array.isArray(s)&&(n.dataChanged=Array.isArray(l)?s.concat(l):l,o=!0);default:n[r]||(n[r]=e[r],o=!0)}o&&ms(rfe,this,r,e)}const i=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=i,n.somethingChanged=i||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const i=Ide(e,n);if(i.updateTriggersChanged)for(const o in i.updateTriggersChanged)i.updateTriggersChanged[o]&&this.invalidateAttribute(o);if(i.transitionsChanged)for(const o in i.transitionsChanged){var r;this.internalState.uniformTransitions.add(o,n[o],e[o],(r=e.transitions)===null||r===void 0?void 0:r[o])}return this.setChangeFlags(i)}validateProps(){Pde(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:i}=this.props;e.picked&&typeof i=="function"&&(n.pickingHighlightColor=i(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new JM(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:i,oldProps:r}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:o}=this.state;o==null||o.setInstanceCount(this.getNumInstances());const{autoHighlight:l,highlightedObjectIndex:s,highlightColor:d}=i;if(n||r.autoHighlight!==l||r.highlightedObjectIndex!==s||r.highlightColor!==d){const p={};l||(p.pickingSelectedColor=null),Array.isArray(d)&&(p.pickingHighlightColor=d),(n||s!==r.highlightedObjectIndex)&&(p.pickingSelectedColor=Number.isFinite(s)&&s>=0?this.encodePickingColor(s):null),this.setModuleParameters(p)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const i=this.getAttributeManager(),r=i?i.getNeedsRedraw(e):!1;if(n=n||r,n)for(const o of this.props.extensions)o.onNeedsRedraw.call(this,o);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}q(Ka,"defaultProps",hfe);q(Ka,"layerName","Layer");const dfe="compositeLayer.renderLayers";class C_ extends Ka{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:i}=this.props;return i&&i[e]&&i[e].type||n}getSubLayerRow(e,n,i){return e.__source={parent:this,object:n,index:i},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(i,r)=>i&&i.__source?(n.index=i.__source.index,e(i.__source.object,n)):e(i,r)}return e}getSubLayerProps(e={}){var n;const{opacity:i,pickable:r,visible:o,parameters:l,getPolygonOffset:s,highlightedObjectIndex:d,autoHighlight:p,highlightColor:y,coordinateSystem:v,coordinateOrigin:w,wrapLongitude:T,positionFormat:I,modelMatrix:L,extensions:k,fetch:F,operation:B,_subLayerProps:G}=this.props,U={id:"",updateTriggers:{},opacity:i,pickable:r,visible:o,parameters:l,getPolygonOffset:s,highlightedObjectIndex:d,autoHighlight:p,highlightColor:y,coordinateSystem:v,coordinateOrigin:w,wrapLongitude:T,positionFormat:I,modelMatrix:L,extensions:k,fetch:F,operation:B},ee=G&&e.id&&G[e.id],ne=ee&&ee.updateTriggers,ye=e.id||"sublayer";if(ee){const fe=this.props[Sh],J=e.type?e.type._propTypes:{};for(const Ce in ee){const me=J[Ce]||fe[Ce];me&&me.type==="accessor"&&(ee[Ce]=this.getSubLayerAccessor(ee[Ce]))}}Object.assign(U,e,ee),U.id="".concat(this.props.id,"-").concat(ye),U.updateTriggers={all:(n=this.props.updateTriggers)===null||n===void 0?void 0:n.all,...e.updateTriggers,...ne};for(const fe of k){const J=fe.getSubLayerProps.call(this,fe);J&&Object.assign(U,J,{updateTriggers:Object.assign(U.updateTriggers,J.updateTriggers)})}return U}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let i=this.internalState.subLayers;const r=!i||this.needsUpdate();if(r){const o=this.renderLayers();i=F2(o,Boolean),this.internalState.subLayers=i}ms(dfe,this,r,i);for(const o of i)o.parent=this}}q(C_,"layerName","CompositeLayer");const zb=Math.PI/180,c6=180/Math.PI,Rx=6370972,Yp=256;function ffe(){const t=Yp/Rx,e=Math.PI/180*Yp;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[1/t,1/t,1/t],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/t]}}class pfe extends Sf{constructor(e={}){const{latitude:n=0,longitude:i=0,zoom:r=0,nearZMultiplier:o=.1,farZMultiplier:l=2,resolution:s=10}=e;let{height:d,altitude:p=1.5}=e;d=d||1,p=Math.max(.75,p);const y=new Js().lookAt({eye:[0,-p,0],up:[0,0,1]}),v=Math.pow(2,r);y.rotateX(n*zb),y.rotateZ(-i*zb),y.scale(v/d);const w=Math.atan(.5/p),T=Yp*2*v/d;super({...e,height:d,viewMatrix:y,longitude:i,latitude:n,zoom:r,distanceScales:ffe(),fovyRadians:w*2,focalDistance:p,near:o,far:Math.min(2,1/T+1)*p*l}),q(this,"longitude",void 0),q(this,"latitude",void 0),q(this,"resolution",void 0),this.latitude=n,this.longitude=i,this.resolution=s}get projectionMode(){return xl.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(e={}){const n={targetZ:e.z||0},i=this.unproject([0,this.height/2],n),r=this.unproject([this.width/2,0],n),o=this.unproject([this.width,this.height/2],n),l=this.unproject([this.width/2,this.height],n);return o[0]<this.longitude&&(o[0]+=360),i[0]>this.longitude&&(i[0]-=360),[Math.min(i[0],o[0],r[0],l[0]),Math.min(i[1],o[1],r[1],l[1]),Math.max(i[0],o[0],r[0],l[0]),Math.max(i[1],o[1],r[1],l[1])]}unproject(e,{topLeft:n=!0,targetZ:i}={}){const[r,o,l]=e,s=n?o:this.height-o,{pixelUnprojectionMatrix:d}=this;let p;if(Number.isFinite(l))p=rC(d,[r,s,l,1]);else{const T=rC(d,[r,s,-1,1]),I=rC(d,[r,s,1,1]),L=((i||0)/Rx+1)*Yp,k=HS(e7([],T,I)),F=HS(T),B=HS(I),U=4*((4*F*B-(k-F-B)**2)/16)/k,ee=Math.sqrt(F-U),ne=Math.sqrt(Math.max(0,L*L-U)),ye=(ee-ne)/Math.sqrt(k);p=Oae([],T,I,ye)}const[y,v,w]=this.unprojectPosition(p);return Number.isFinite(l)?[y,v,w]:Number.isFinite(i)?[y,v,i]:[y,v]}projectPosition(e){const[n,i,r=0]=e,o=n*zb,l=i*zb,s=Math.cos(l),d=(r/Rx+1)*Yp;return[Math.sin(o)*s*d,-Math.cos(o)*s*d,Math.sin(l)*d]}unprojectPosition(e){const[n,i,r]=e,o=t7(e),l=Math.asin(r/o),d=Math.atan2(n,-i)*c6,p=l*c6,y=(o/Yp-1)*Rx;return[d,p,y]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition(e,n){const i=this.unproject(n);return{longitude:e[0]-i[0]+this.longitude,latitude:e[1]-i[1]+this.latitude}}}function rC(t,e){const n=tg([],e,t);return $M(n,n,1/n[3]),n}class H7{constructor(e){q(this,"opts",void 0),q(this,"typedArrayManager",void 0),q(this,"indexStarts",[0]),q(this,"vertexStarts",[0]),q(this,"vertexCount",0),q(this,"instanceCount",0),q(this,"attributes",void 0),q(this,"_attributeDefs",void 0),q(this,"data",void 0),q(this,"getGeometry",void 0),q(this,"geometryBuffer",void 0),q(this,"buffers",void 0),q(this,"positionSize",void 0),q(this,"normalize",void 0);const{attributes:n={}}=e;this.typedArrayManager=Um,this.attributes={},this._attributeDefs=n,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:n,buffers:i={},getGeometry:r,geometryBuffer:o,positionFormat:l,dataChanged:s,normalize:d=!0}=this.opts;if(this.data=n,this.getGeometry=r,this.positionSize=o&&o.size||(l==="XY"?2:3),this.buffers=i,this.normalize=d,o&&(Go(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(o),d||(i.positions=o)),this.geometryBuffer=i.positions,Array.isArray(s))for(const p of s)this._rebuildGeometry(p);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:n}){this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(e){const n=e.value||e;return ArrayBuffer.isView(n)?z7(n,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,n){const{attributes:i,buffers:r,_attributeDefs:o,typedArrayManager:l}=this;for(const s in o)if(s in r)l.release(i[s]),i[s]=null;else{const d=o[s];d.copy=n,i[s]=l.allocate(i[s],e,d)}}_forEachGeometry(e,n,i){const{data:r,getGeometry:o}=this,{iterable:l,objectInfo:s}=z2(r,n,i);for(const d of l){s.index++;const p=o?o(d,s):null;e(p,s.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:n,vertexStarts:i,instanceCount:r}=this;const{data:o,geometryBuffer:l}=this,{startRow:s=0,endRow:d=1/0}=e||{},p={};if(e||(n=[0],i=[0]),this.normalize||!l)this._forEachGeometry((v,w)=>{const T=v&&this.normalizeGeometry(v);p[w]=T,i[w+1]=i[w]+(T?this.getGeometrySize(T):0)},s,d),r=i[i.length-1];else if(i=o.startIndices,r=i[o.length]||0,ArrayBuffer.isView(l))r=r||l.length/this.positionSize;else if(l instanceof $i){const v=l.accessor.stride||this.positionSize*4;r=r||l.byteLength/v}else if(l.buffer){const v=l.stride||this.positionSize*4;r=r||l.buffer.byteLength/v}else if(l.value){const v=l.value,w=l.stride/v.BYTES_PER_ELEMENT||this.positionSize;r=r||v.length/w}this._allocate(r,!!e),this.indexStarts=n,this.vertexStarts=i,this.instanceCount=r;const y={};this._forEachGeometry((v,w)=>{const T=p[w]||v;y.vertexStart=i[w],y.indexStart=n[w];const I=w<i.length-1?i[w+1]:r;y.geometrySize=I-i[w],y.geometryIndex=w,this.updateGeometryAttributes(T,y)},s,d),this.vertexCount=n[n.length-1]}}function Nb(t){return[null,void 0,!1].indexOf(t)!==-1}function mfe(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function W7(t){var e={exports:{}};return t(e,e.exports),e.exports}var u6=W7(function(t,e){t.exports=function(){var n=["decimals","thousand","mark","prefix","suffix","encoder","decoder","negativeBefore","negative","edit","undo"];function i(I){return I.split("").reverse().join("")}function r(I,L){return I.substring(0,L.length)===L}function o(I,L){return I.slice(-1*L.length)===L}function l(I,L,k){if((I[L]||I[k])&&I[L]===I[k])throw new Error(L)}function s(I){return typeof I=="number"&&isFinite(I)}function d(I,L){return I=I.toString().split("e"),(+((I=(I=Math.round(+(I[0]+"e"+(I[1]?+I[1]+L:L)))).toString().split("e"))[0]+"e"+(I[1]?+I[1]-L:-L))).toFixed(L)}function p(I,L,k,F,B,G,U,ee,ne,ye,fe,J){var Ce,me,be,Te=J,ke="",ut="";return G&&(J=G(J)),!!s(J)&&(I!==!1&&parseFloat(J.toFixed(I))===0&&(J=0),J<0&&(Ce=!0,J=Math.abs(J)),I!==!1&&(J=d(J,I)),(J=J.toString()).indexOf(".")!==-1?(be=(me=J.split("."))[0],k&&(ke=k+me[1])):be=J,L&&(be=i(be).match(/.{1,3}/g),be=i(be.join(i(L)))),Ce&&ee&&(ut+=ee),F&&(ut+=F),Ce&&ne&&(ut+=ne),ut+=be,ut+=ke,B&&(ut+=B),ye&&(ut=ye(ut,Te)),ut)}function y(I,L,k,F,B,G,U,ee,ne,ye,fe,J){var Ce,me="";return fe&&(J=fe(J)),!(!J||typeof J!="string")&&(ee&&r(J,ee)&&(J=J.replace(ee,""),Ce=!0),F&&r(J,F)&&(J=J.replace(F,"")),ne&&r(J,ne)&&(J=J.replace(ne,""),Ce=!0),B&&o(J,B)&&(J=J.slice(0,-1*B.length)),L&&(J=J.split(L).join("")),k&&(J=J.replace(k,".")),Ce&&(me+="-"),(me=(me+=J).replace(/[^0-9\.\-.]/g,""))!==""&&(me=Number(me),U&&(me=U(me)),!!s(me)&&me))}function v(I){var L,k,F,B={};for(I.suffix===void 0&&(I.suffix=I.postfix),L=0;L<n.length;L+=1)if((F=I[k=n[L]])===void 0)k!=="negative"||B.negativeBefore?k==="mark"&&B.thousand!=="."?B[k]=".":B[k]=!1:B[k]="-";else if(k==="decimals"){if(!(F>=0&&F<8))throw new Error(k);B[k]=F}else if(k==="encoder"||k==="decoder"||k==="edit"||k==="undo"){if(typeof F!="function")throw new Error(k);B[k]=F}else{if(typeof F!="string")throw new Error(k);B[k]=F}return l(B,"mark","thousand"),l(B,"prefix","negative"),l(B,"prefix","negativeBefore"),B}function w(I,L,k){var F,B=[];for(F=0;F<n.length;F+=1)B.push(I[n[F]]);return B.push(k),L.apply("",B)}function T(I){if(!(this instanceof T))return new T(I);typeof I=="object"&&(I=v(I),this.to=function(L){return w(I,p,L)},this.from=function(L){return w(I,y,L)})}return T}()}),gfe=mfe(W7(function(t,e){(function(n){function i(ie){return r(ie)&&typeof ie.from=="function"}function r(ie){return typeof ie=="object"&&typeof ie.to=="function"}function o(ie){ie.parentElement.removeChild(ie)}function l(ie){return ie!=null}function s(ie){ie.preventDefault()}function d(ie){return ie.filter(function(K){return!this[K]&&(this[K]=!0)},{})}function p(ie,K){return Math.round(ie/K)*K}function y(ie,K){var Be=ie.getBoundingClientRect(),rt=ie.ownerDocument,mt=rt.documentElement,zt=G(rt);return/webkit.*Chrome.*Mobile/i.test(navigator.userAgent)&&(zt.x=0),K?Be.top+zt.y-mt.clientTop:Be.left+zt.x-mt.clientLeft}function v(ie){return typeof ie=="number"&&!isNaN(ie)&&isFinite(ie)}function w(ie,K,Be){Be>0&&(k(ie,K),setTimeout(function(){F(ie,K)},Be))}function T(ie){return Math.max(Math.min(ie,100),0)}function I(ie){return Array.isArray(ie)?ie:[ie]}function L(ie){var K=(ie=String(ie)).split(".");return K.length>1?K[1].length:0}function k(ie,K){ie.classList&&!/\s/.test(K)?ie.classList.add(K):ie.className+=" "+K}function F(ie,K){ie.classList&&!/\s/.test(K)?ie.classList.remove(K):ie.className=ie.className.replace(new RegExp("(^|\\b)"+K.split(" ").join("|")+"(\\b|$)","gi")," ")}function B(ie,K){return ie.classList?ie.classList.contains(K):new RegExp("\\b"+K+"\\b").test(ie.className)}function G(ie){var K=window.pageXOffset!==void 0,Be=(ie.compatMode||"")==="CSS1Compat";return{x:K?window.pageXOffset:Be?ie.documentElement.scrollLeft:ie.body.scrollLeft,y:K?window.pageYOffset:Be?ie.documentElement.scrollTop:ie.body.scrollTop}}function U(){return window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"}}function ee(){var ie=!1;try{var K=Object.defineProperty({},"passive",{get:function(){ie=!0}});window.addEventListener("test",null,K)}catch{}return ie}function ne(){return window.CSS&&CSS.supports&&CSS.supports("touch-action","none")}function ye(ie,K){return 100/(K-ie)}function fe(ie,K,Be){return 100*K/(ie[Be+1]-ie[Be])}function J(ie,K){return fe(ie,ie[0]<0?K+Math.abs(ie[0]):K-ie[0],0)}function Ce(ie,K){return K*(ie[1]-ie[0])/100+ie[0]}function me(ie,K){for(var Be=1;ie>=K[Be];)Be+=1;return Be}function be(ie,K,Be){if(Be>=ie.slice(-1)[0])return 100;var rt=me(Be,ie),mt=ie[rt-1],zt=ie[rt],en=K[rt-1],bn=K[rt];return en+J([mt,zt],Be)/ye(en,bn)}function Te(ie,K,Be){if(Be>=100)return ie.slice(-1)[0];var rt=me(Be,K),mt=ie[rt-1],zt=ie[rt],en=K[rt-1];return Ce([mt,zt],(Be-en)*ye(en,K[rt]))}function ke(ie,K,Be,rt){if(rt===100)return rt;var mt=me(rt,ie),zt=ie[mt-1],en=ie[mt];return Be?rt-zt>(en-zt)/2?en:zt:K[mt-1]?ie[mt-1]+p(rt-ie[mt-1],K[mt-1]):rt}var ut,et;n.PipsMode=void 0,(et=n.PipsMode||(n.PipsMode={})).Range="range",et.Steps="steps",et.Positions="positions",et.Count="count",et.Values="values",n.PipsType=void 0,(ut=n.PipsType||(n.PipsType={}))[ut.None=-1]="None",ut[ut.NoValue=0]="NoValue",ut[ut.LargeValue=1]="LargeValue",ut[ut.SmallValue=2]="SmallValue";var Et=function(){function ie(K,Be,rt){var mt;this.xPct=[],this.xVal=[],this.xSteps=[],this.xNumSteps=[],this.xHighestCompleteStep=[],this.xSteps=[rt||!1],this.xNumSteps=[!1],this.snap=Be;var zt=[];for(Object.keys(K).forEach(function(en){zt.push([I(K[en]),en])}),zt.sort(function(en,bn){return en[0][0]-bn[0][0]}),mt=0;mt<zt.length;mt++)this.handleEntryPoint(zt[mt][1],zt[mt][0]);for(this.xNumSteps=this.xSteps.slice(0),mt=0;mt<this.xNumSteps.length;mt++)this.handleStepPoint(mt,this.xNumSteps[mt])}return ie.prototype.getDistance=function(K){for(var Be=[],rt=0;rt<this.xNumSteps.length-1;rt++)Be[rt]=fe(this.xVal,K,rt);return Be},ie.prototype.getAbsoluteDistance=function(K,Be,rt){var mt,zt=0;if(K<this.xPct[this.xPct.length-1])for(;K>this.xPct[zt+1];)zt++;else K===this.xPct[this.xPct.length-1]&&(zt=this.xPct.length-2);rt||K!==this.xPct[zt+1]||zt++,Be===null&&(Be=[]);var en=1,bn=Be[zt],Hn=0,Pn=0,ue=0,X=0;for(mt=rt?(K-this.xPct[zt])/(this.xPct[zt+1]-this.xPct[zt]):(this.xPct[zt+1]-K)/(this.xPct[zt+1]-this.xPct[zt]);bn>0;)Hn=this.xPct[zt+1+X]-this.xPct[zt+X],Be[zt+X]*en+100-100*mt>100?(Pn=Hn*mt,en=(bn-100*mt)/Be[zt+X],mt=1):(Pn=Be[zt+X]*Hn/100*en,en=0),rt?(ue-=Pn,this.xPct.length+X>=1&&X--):(ue+=Pn,this.xPct.length-X>=1&&X++),bn=Be[zt+X]*en;return K+ue},ie.prototype.toStepping=function(K){return K=be(this.xVal,this.xPct,K)},ie.prototype.fromStepping=function(K){return Te(this.xVal,this.xPct,K)},ie.prototype.getStep=function(K){return K=ke(this.xPct,this.xSteps,this.snap,K)},ie.prototype.getDefaultStep=function(K,Be,rt){var mt=me(K,this.xPct);return(K===100||Be&&K===this.xPct[mt-1])&&(mt=Math.max(mt-1,1)),(this.xVal[mt]-this.xVal[mt-1])/rt},ie.prototype.getNearbySteps=function(K){var Be=me(K,this.xPct);return{stepBefore:{startValue:this.xVal[Be-2],step:this.xNumSteps[Be-2],highestStep:this.xHighestCompleteStep[Be-2]},thisStep:{startValue:this.xVal[Be-1],step:this.xNumSteps[Be-1],highestStep:this.xHighestCompleteStep[Be-1]},stepAfter:{startValue:this.xVal[Be],step:this.xNumSteps[Be],highestStep:this.xHighestCompleteStep[Be]}}},ie.prototype.countStepDecimals=function(){var K=this.xNumSteps.map(L);return Math.max.apply(null,K)},ie.prototype.hasNoSize=function(){return this.xVal[0]===this.xVal[this.xVal.length-1]},ie.prototype.convert=function(K){return this.getStep(this.toStepping(K))},ie.prototype.handleEntryPoint=function(K,Be){var rt;if(!v(rt=K==="min"?0:K==="max"?100:parseFloat(K))||!v(Be[0]))throw new Error("noUiSlider: 'range' value isn't numeric.");this.xPct.push(rt),this.xVal.push(Be[0]);var mt=Number(Be[1]);rt?this.xSteps.push(!isNaN(mt)&&mt):isNaN(mt)||(this.xSteps[0]=mt),this.xHighestCompleteStep.push(0)},ie.prototype.handleStepPoint=function(K,Be){if(Be)if(this.xVal[K]!==this.xVal[K+1]){this.xSteps[K]=fe([this.xVal[K],this.xVal[K+1]],Be,0)/ye(this.xPct[K],this.xPct[K+1]);var rt=(this.xVal[K+1]-this.xVal[K])/this.xNumSteps[K],mt=Math.ceil(Number(rt.toFixed(3))-1),zt=this.xVal[K]+this.xNumSteps[K]*mt;this.xHighestCompleteStep[K]=zt}else this.xSteps[K]=this.xHighestCompleteStep[K]=this.xVal[K]},ie}(),bt={to:function(ie){return ie===void 0?"":ie.toFixed(2)},from:Number},Qt={target:"target",base:"base",origin:"origin",handle:"handle",handleLower:"handle-lower",handleUpper:"handle-upper",touchArea:"touch-area",horizontal:"horizontal",vertical:"vertical",background:"background",connect:"connect",connects:"connects",ltr:"ltr",rtl:"rtl",textDirectionLtr:"txt-dir-ltr",textDirectionRtl:"txt-dir-rtl",draggable:"draggable",drag:"state-drag",tap:"state-tap",active:"active",tooltip:"tooltip",pips:"pips",pipsHorizontal:"pips-horizontal",pipsVertical:"pips-vertical",marker:"marker",markerHorizontal:"marker-horizontal",markerVertical:"marker-vertical",markerNormal:"marker-normal",markerLarge:"marker-large",markerSub:"marker-sub",value:"value",valueHorizontal:"value-horizontal",valueVertical:"value-vertical",valueNormal:"value-normal",valueLarge:"value-large",valueSub:"value-sub"},cn={tooltips:".__tooltips",aria:".__aria"};function pn(ie,K){if(!v(K))throw new Error("noUiSlider: 'step' is not numeric.");ie.singleStep=K}function xn(ie,K){if(!v(K))throw new Error("noUiSlider: 'keyboardPageMultiplier' is not numeric.");ie.keyboardPageMultiplier=K}function An(ie,K){if(!v(K))throw new Error("noUiSlider: 'keyboardMultiplier' is not numeric.");ie.keyboardMultiplier=K}function kn(ie,K){if(!v(K))throw new Error("noUiSlider: 'keyboardDefaultStep' is not numeric.");ie.keyboardDefaultStep=K}function Bn(ie,K){if(typeof K!="object"||Array.isArray(K))throw new Error("noUiSlider: 'range' is not an object.");if(K.min===void 0||K.max===void 0)throw new Error("noUiSlider: Missing 'min' or 'max' in 'range'.");ie.spectrum=new Et(K,ie.snap||!1,ie.singleStep)}function Nt(ie,K){if(K=I(K),!Array.isArray(K)||!K.length)throw new Error("noUiSlider: 'start' option is incorrect.");ie.handles=K.length,ie.start=K}function We(ie,K){if(typeof K!="boolean")throw new Error("noUiSlider: 'snap' option must be a boolean.");ie.snap=K}function kt(ie,K){if(typeof K!="boolean")throw new Error("noUiSlider: 'animate' option must be a boolean.");ie.animate=K}function Ke(ie,K){if(typeof K!="number")throw new Error("noUiSlider: 'animationDuration' option must be a number.");ie.animationDuration=K}function ht(ie,K){var Be,rt=[!1];if(K==="lower"?K=[!0,!1]:K==="upper"&&(K=[!1,!0]),K===!0||K===!1){for(Be=1;Be<ie.handles;Be++)rt.push(K);rt.push(!1)}else{if(!Array.isArray(K)||!K.length||K.length!==ie.handles+1)throw new Error("noUiSlider: 'connect' option doesn't match handle count.");rt=K}ie.connect=rt}function Pt(ie,K){switch(K){case"horizontal":ie.ort=0;break;case"vertical":ie.ort=1;break;default:throw new Error("noUiSlider: 'orientation' option is invalid.")}}function ae(ie,K){if(!v(K))throw new Error("noUiSlider: 'margin' option must be numeric.");K!==0&&(ie.margin=ie.spectrum.getDistance(K))}function Ae(ie,K){if(!v(K))throw new Error("noUiSlider: 'limit' option must be numeric.");if(ie.limit=ie.spectrum.getDistance(K),!ie.limit||ie.handles<2)throw new Error("noUiSlider: 'limit' option is only supported on linear sliders with 2 or more handles.")}function je(ie,K){var Be;if(!v(K)&&!Array.isArray(K))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(Array.isArray(K)&&K.length!==2&&!v(K[0])&&!v(K[1]))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(K!==0){for(Array.isArray(K)||(K=[K,K]),ie.padding=[ie.spectrum.getDistance(K[0]),ie.spectrum.getDistance(K[1])],Be=0;Be<ie.spectrum.xNumSteps.length-1;Be++)if(ie.padding[0][Be]<0||ie.padding[1][Be]<0)throw new Error("noUiSlider: 'padding' option must be a positive number(s).");var rt=K[0]+K[1],mt=ie.spectrum.xVal[0];if(rt/(ie.spectrum.xVal[ie.spectrum.xVal.length-1]-mt)>1)throw new Error("noUiSlider: 'padding' option must not exceed 100% of the range.")}}function tt(ie,K){switch(K){case"ltr":ie.dir=0;break;case"rtl":ie.dir=1;break;default:throw new Error("noUiSlider: 'direction' option was not recognized.")}}function pt(ie,K){if(typeof K!="string")throw new Error("noUiSlider: 'behaviour' must be a string containing options.");var Be=K.indexOf("tap")>=0,rt=K.indexOf("drag")>=0,mt=K.indexOf("fixed")>=0,zt=K.indexOf("snap")>=0,en=K.indexOf("hover")>=0,bn=K.indexOf("unconstrained")>=0,Hn=K.indexOf("drag-all")>=0,Pn=K.indexOf("smooth-steps")>=0;if(mt){if(ie.handles!==2)throw new Error("noUiSlider: 'fixed' behaviour must be used with 2 handles");ae(ie,ie.start[1]-ie.start[0])}if(bn&&(ie.margin||ie.limit))throw new Error("noUiSlider: 'unconstrained' behaviour cannot be used with margin or limit");ie.events={tap:Be||zt,drag:rt,dragAll:Hn,smoothSteps:Pn,fixed:mt,snap:zt,hover:en,unconstrained:bn}}function Tt(ie,K){if(K!==!1)if(K===!0||r(K)){ie.tooltips=[];for(var Be=0;Be<ie.handles;Be++)ie.tooltips.push(K)}else{if((K=I(K)).length!==ie.handles)throw new Error("noUiSlider: must pass a formatter for all handles.");K.forEach(function(rt){if(typeof rt!="boolean"&&!r(rt))throw new Error("noUiSlider: 'tooltips' must be passed a formatter or 'false'.")}),ie.tooltips=K}}function tn(ie,K){if(K.length!==ie.handles)throw new Error("noUiSlider: must pass a attributes for all handles.");ie.handleAttributes=K}function Wt(ie,K){if(!r(K))throw new Error("noUiSlider: 'ariaFormat' requires 'to' method.");ie.ariaFormat=K}function qt(ie,K){if(!i(K))throw new Error("noUiSlider: 'format' requires 'to' and 'from' methods.");ie.format=K}function It(ie,K){if(typeof K!="boolean")throw new Error("noUiSlider: 'keyboardSupport' option must be a boolean.");ie.keyboardSupport=K}function wn(ie,K){ie.documentElement=K}function hn(ie,K){if(typeof K!="string"&&K!==!1)throw new Error("noUiSlider: 'cssPrefix' must be a string or `false`.");ie.cssPrefix=K}function En(ie,K){if(typeof K!="object")throw new Error("noUiSlider: 'cssClasses' must be an object.");typeof ie.cssPrefix=="string"?(ie.cssClasses={},Object.keys(K).forEach(function(Be){ie.cssClasses[Be]=ie.cssPrefix+K[Be]})):ie.cssClasses=K}function zn(ie){var K={margin:null,limit:null,padding:null,animate:!0,animationDuration:300,ariaFormat:bt,format:bt},Be={step:{r:!1,t:pn},keyboardPageMultiplier:{r:!1,t:xn},keyboardMultiplier:{r:!1,t:An},keyboardDefaultStep:{r:!1,t:kn},start:{r:!0,t:Nt},connect:{r:!0,t:ht},direction:{r:!0,t:tt},snap:{r:!1,t:We},animate:{r:!1,t:kt},animationDuration:{r:!1,t:Ke},range:{r:!0,t:Bn},orientation:{r:!1,t:Pt},margin:{r:!1,t:ae},limit:{r:!1,t:Ae},padding:{r:!1,t:je},behaviour:{r:!0,t:pt},ariaFormat:{r:!1,t:Wt},format:{r:!1,t:qt},tooltips:{r:!1,t:Tt},keyboardSupport:{r:!0,t:It},documentElement:{r:!1,t:wn},cssPrefix:{r:!0,t:hn},cssClasses:{r:!0,t:En},handleAttributes:{r:!1,t:tn}},rt={connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal",keyboardSupport:!0,cssPrefix:"noUi-",cssClasses:Qt,keyboardPageMultiplier:5,keyboardMultiplier:1,keyboardDefaultStep:10};ie.format&&!ie.ariaFormat&&(ie.ariaFormat=ie.format),Object.keys(Be).forEach(function(Hn){if(l(ie[Hn])||rt[Hn]!==void 0)Be[Hn].t(K,l(ie[Hn])?ie[Hn]:rt[Hn]);else if(Be[Hn].r)throw new Error("noUiSlider: '"+Hn+"' is required.")}),K.pips=ie.pips;var mt=document.createElement("div"),zt=mt.style.msTransform!==void 0,en=mt.style.transform!==void 0;K.transformRule=en?"transform":zt?"msTransform":"webkitTransform";var bn=[["left","top"],["right","bottom"]];return K.style=bn[K.dir][K.ort],K}function ei(ie,K,Be){var rt,mt,zt,en,bn,Hn=U(),Pn=ne()&&ee(),ue=ie,X=K.spectrum,te=[],de=[],Pe=[],$e=0,Je={},qe=ie.ownerDocument,Ge=K.documentElement||qe.documentElement,ct=qe.body,Ht=qe.dir==="rtl"||K.ort===1?0:100;function Xt(Oe,Ze){var at=qe.createElement("div");return Ze&&k(at,Ze),Oe.appendChild(at),at}function Ft(Oe,Ze){var at=Xt(Oe,K.cssClasses.origin),Ot=Xt(at,K.cssClasses.handle);if(Xt(Ot,K.cssClasses.touchArea),Ot.setAttribute("data-handle",String(Ze)),K.keyboardSupport&&(Ot.setAttribute("tabindex","0"),Ot.addEventListener("keydown",function(un){return Mo(un,Ze)})),K.handleAttributes!==void 0){var mn=K.handleAttributes[Ze];Object.keys(mn).forEach(function(un){Ot.setAttribute(un,mn[un])})}return Ot.setAttribute("role","slider"),Ot.setAttribute("aria-orientation",K.ort?"vertical":"horizontal"),Ze===0?k(Ot,K.cssClasses.handleLower):Ze===K.handles-1&&k(Ot,K.cssClasses.handleUpper),at}function qn(Oe,Ze){return!!Ze&&Xt(Oe,K.cssClasses.connect)}function ci(Oe,Ze){var at=Xt(Ze,K.cssClasses.connects);mt=[],(zt=[]).push(qn(at,Oe[0]));for(var Ot=0;Ot<K.handles;Ot++)mt.push(Ft(Ze,Ot)),Pe[Ot]=Ot,zt.push(qn(at,Oe[Ot+1]))}function Yn(Oe){return k(Oe,K.cssClasses.target),K.dir===0?k(Oe,K.cssClasses.ltr):k(Oe,K.cssClasses.rtl),K.ort===0?k(Oe,K.cssClasses.horizontal):k(Oe,K.cssClasses.vertical),k(Oe,getComputedStyle(Oe).direction==="rtl"?K.cssClasses.textDirectionRtl:K.cssClasses.textDirectionLtr),Xt(Oe,K.cssClasses.base)}function ii(Oe,Ze){return!(!K.tooltips||!K.tooltips[Ze])&&Xt(Oe.firstChild,K.cssClasses.tooltip)}function mi(){return ue.hasAttribute("disabled")}function Vi(Oe){return mt[Oe].hasAttribute("disabled")}function hr(){bn&&(Ai("update"+cn.tooltips),bn.forEach(function(Oe){Oe&&o(Oe)}),bn=null)}function Fr(){hr(),bn=mt.map(ii),No("update"+cn.tooltips,function(Oe,Ze,at){if(bn&&K.tooltips&&bn[Ze]!==!1){var Ot=Oe[Ze];K.tooltips[Ze]!==!0&&(Ot=K.tooltips[Ze].to(at[Ze])),bn[Ze].innerHTML=Ot}})}function xr(){Ai("update"+cn.aria),No("update"+cn.aria,function(Oe,Ze,at,Ot,mn){Pe.forEach(function(un){var jn=mt[un],on=go(de,un,0,!0,!0,!0),Er=go(de,un,100,!0,!0,!0),mr=mn[un],xi=String(K.ariaFormat.to(at[un]));on=X.fromStepping(on).toFixed(1),Er=X.fromStepping(Er).toFixed(1),mr=X.fromStepping(mr).toFixed(1),jn.children[0].setAttribute("aria-valuemin",on),jn.children[0].setAttribute("aria-valuemax",Er),jn.children[0].setAttribute("aria-valuenow",mr),jn.children[0].setAttribute("aria-valuetext",xi)})})}function Ko(Oe){if(Oe.mode===n.PipsMode.Range||Oe.mode===n.PipsMode.Steps)return X.xVal;if(Oe.mode===n.PipsMode.Count){if(Oe.values<2)throw new Error("noUiSlider: 'values' (>= 2) required for mode 'count'.");for(var Ze=Oe.values-1,at=100/Ze,Ot=[];Ze--;)Ot[Ze]=Ze*at;return Ot.push(100),Cr(Ot,Oe.stepped)}return Oe.mode===n.PipsMode.Positions?Cr(Oe.values,Oe.stepped):Oe.mode===n.PipsMode.Values?Oe.stepped?Oe.values.map(function(mn){return X.fromStepping(X.getStep(X.toStepping(mn)))}):Oe.values:[]}function Cr(Oe,Ze){return Oe.map(function(at){return X.fromStepping(Ze?X.getStep(at):at)})}function Kr(Oe){function Ze(mr,xi){return Number((mr+xi).toFixed(7))}var at=Ko(Oe),Ot={},mn=X.xVal[0],un=X.xVal[X.xVal.length-1],jn=!1,on=!1,Er=0;return(at=d(at.slice().sort(function(mr,xi){return mr-xi})))[0]!==mn&&(at.unshift(mn),jn=!0),at[at.length-1]!==un&&(at.push(un),on=!0),at.forEach(function(mr,xi){var Si,ji,Ar,Ei,gr,vu,oa,ro,_u,bu,Ss=mr,qo=at[xi+1],vc=Oe.mode===n.PipsMode.Steps;for(vc&&(Si=X.xNumSteps[xi]),Si||(Si=qo-Ss),qo===void 0&&(qo=Ss),Si=Math.max(Si,1e-7),ji=Ss;ji<=qo;ji=Ze(ji,Si)){for(ro=(gr=(Ei=X.toStepping(ji))-Er)/(Oe.density||1),bu=gr/(_u=Math.round(ro)),Ar=1;Ar<=_u;Ar+=1)Ot[(vu=Er+Ar*bu).toFixed(5)]=[X.fromStepping(vu),0];oa=at.indexOf(ji)>-1?n.PipsType.LargeValue:vc?n.PipsType.SmallValue:n.PipsType.NoValue,!xi&&jn&&ji!==qo&&(oa=0),ji===qo&&on||(Ot[Ei.toFixed(5)]=[ji,oa]),Er=Ei}}),Ot}function Bo(Oe,Ze,at){var Ot,mn,un=qe.createElement("div"),jn=((Ot={})[n.PipsType.None]="",Ot[n.PipsType.NoValue]=K.cssClasses.valueNormal,Ot[n.PipsType.LargeValue]=K.cssClasses.valueLarge,Ot[n.PipsType.SmallValue]=K.cssClasses.valueSub,Ot),on=((mn={})[n.PipsType.None]="",mn[n.PipsType.NoValue]=K.cssClasses.markerNormal,mn[n.PipsType.LargeValue]=K.cssClasses.markerLarge,mn[n.PipsType.SmallValue]=K.cssClasses.markerSub,mn),Er=[K.cssClasses.valueHorizontal,K.cssClasses.valueVertical],mr=[K.cssClasses.markerHorizontal,K.cssClasses.markerVertical];function xi(ji,Ar){var Ei=Ar===K.cssClasses.value,gr=Ei?jn:on;return Ar+" "+(Ei?Er:mr)[K.ort]+" "+gr[ji]}function Si(ji,Ar,Ei){if((Ei=Ze?Ze(Ar,Ei):Ei)!==n.PipsType.None){var gr=Xt(un,!1);gr.className=xi(Ei,K.cssClasses.marker),gr.style[K.style]=ji+"%",Ei>n.PipsType.NoValue&&((gr=Xt(un,!1)).className=xi(Ei,K.cssClasses.value),gr.setAttribute("data-value",String(Ar)),gr.style[K.style]=ji+"%",gr.innerHTML=String(at.to(Ar)))}}return k(un,K.cssClasses.pips),k(un,K.ort===0?K.cssClasses.pipsHorizontal:K.cssClasses.pipsVertical),Object.keys(Oe).forEach(function(ji){Si(ji,Oe[ji][0],Oe[ji][1])}),un}function na(){en&&(o(en),en=null)}function Fs(Oe){na();var Ze=Kr(Oe),at=Oe.filter,Ot=Oe.format||{to:function(mn){return String(Math.round(mn))}};return en=ue.appendChild(Bo(Ze,at,Ot))}function vi(){var Oe=rt.getBoundingClientRect(),Ze="offset"+["Width","Height"][K.ort];return K.ort===0?Oe.width||rt[Ze]:Oe.height||rt[Ze]}function Xo(Oe,Ze,at,Ot){var mn=function(jn){var on=Za(jn,Ot.pageOffset,Ot.target||Ze);return!!on&&!(mi()&&!Ot.doNotReject)&&!(B(ue,K.cssClasses.tap)&&!Ot.doNotReject)&&!(Oe===Hn.start&&on.buttons!==void 0&&on.buttons>1)&&(!Ot.hover||!on.buttons)&&(Pn||on.preventDefault(),on.calcPoint=on.points[K.ort],void at(on,Ot))},un=[];return Oe.split(" ").forEach(function(jn){Ze.addEventListener(jn,mn,!!Pn&&{passive:!0}),un.push([jn,mn])}),un}function Za(Oe,Ze,at){var Ot=Oe.type.indexOf("touch")===0,mn=Oe.type.indexOf("mouse")===0,un=Oe.type.indexOf("pointer")===0,jn=0,on=0;if(Oe.type.indexOf("MSPointer")===0&&(un=!0),Oe.type==="mousedown"&&!Oe.buttons&&!Oe.touches)return!1;if(Ot){var Er=function(Si){var ji=Si.target;return ji===at||at.contains(ji)||Oe.composed&&Oe.composedPath().shift()===at};if(Oe.type==="touchstart"){var mr=Array.prototype.filter.call(Oe.touches,Er);if(mr.length>1)return!1;jn=mr[0].pageX,on=mr[0].pageY}else{var xi=Array.prototype.find.call(Oe.changedTouches,Er);if(!xi)return!1;jn=xi.pageX,on=xi.pageY}}return Ze=Ze||G(qe),(mn||un)&&(jn=Oe.clientX+Ze.x,on=Oe.clientY+Ze.y),Oe.pageOffset=Ze,Oe.points=[jn,on],Oe.cursor=mn||un,Oe}function Dl(Oe){var Ze=100*(Oe-y(rt,K.ort))/vi();return Ze=T(Ze),K.dir?100-Ze:Ze}function ia(Oe){var Ze=100,at=!1;return mt.forEach(function(Ot,mn){if(!Vi(mn)){var un=de[mn],jn=Math.abs(un-Oe);(jn<Ze||jn<=Ze&&Oe>un||jn===100&&Ze===100)&&(at=mn,Ze=jn)}}),at}function wr(Oe,Ze){Oe.type==="mouseout"&&Oe.target.nodeName==="HTML"&&Oe.relatedTarget===null&&zo(Oe,Ze)}function bo(Oe,Ze){if(navigator.appVersion.indexOf("MSIE 9")===-1&&Oe.buttons===0&&Ze.buttonsProperty!==0)return zo(Oe,Ze);var at=(K.dir?-1:1)*(Oe.calcPoint-Ze.startCalcPoint);qa(at>0,100*at/Ze.baseSize,Ze.locations,Ze.handleNumbers,Ze.connect)}function zo(Oe,Ze){Ze.handle&&(F(Ze.handle,K.cssClasses.active),$e-=1),Ze.listeners.forEach(function(at){Ge.removeEventListener(at[0],at[1])}),$e===0&&(F(ue,K.cssClasses.drag),Kn(),Oe.cursor&&(ct.style.cursor="",ct.removeEventListener("selectstart",s))),K.events.smoothSteps&&(Ze.handleNumbers.forEach(function(at){Jn(at,de[at],!0,!0,!1,!1)}),Ze.handleNumbers.forEach(function(at){er("update",at)})),Ze.handleNumbers.forEach(function(at){er("change",at),er("set",at),er("end",at)})}function Io(Oe,Ze){if(!Ze.handleNumbers.some(Vi)){var at;Ze.handleNumbers.length===1&&(at=mt[Ze.handleNumbers[0]].children[0],$e+=1,k(at,K.cssClasses.active)),Oe.stopPropagation();var Ot=[],mn=Xo(Hn.move,Ge,bo,{target:Oe.target,handle:at,connect:Ze.connect,listeners:Ot,startCalcPoint:Oe.calcPoint,baseSize:vi(),pageOffset:Oe.pageOffset,handleNumbers:Ze.handleNumbers,buttonsProperty:Oe.buttons,locations:de.slice()}),un=Xo(Hn.end,Ge,zo,{target:Oe.target,handle:at,listeners:Ot,doNotReject:!0,handleNumbers:Ze.handleNumbers}),jn=Xo("mouseout",Ge,wr,{target:Oe.target,handle:at,listeners:Ot,doNotReject:!0,handleNumbers:Ze.handleNumbers});Ot.push.apply(Ot,mn.concat(un,jn)),Oe.cursor&&(ct.style.cursor=getComputedStyle(Oe.target).cursor,mt.length>1&&k(ue,K.cssClasses.drag),ct.addEventListener("selectstart",s,!1)),Ze.handleNumbers.forEach(function(on){er("start",on)})}}function Zo(Oe){Oe.stopPropagation();var Ze=Dl(Oe.calcPoint),at=ia(Ze);at!==!1&&(K.events.snap||w(ue,K.cssClasses.tap,K.animationDuration),Jn(at,Ze,!0,!0),Kn(),er("slide",at,!0),er("update",at,!0),K.events.snap?Io(Oe,{handleNumbers:[at]}):(er("change",at,!0),er("set",at,!0)))}function Br(Oe){var Ze=Dl(Oe.calcPoint),at=X.getStep(Ze),Ot=X.fromStepping(at);Object.keys(Je).forEach(function(mn){mn.split(".")[0]==="hover"&&Je[mn].forEach(function(un){un.call(ui,Ot)})})}function Mo(Oe,Ze){if(mi()||Vi(Ze))return!1;var at=["Left","Right"],Ot=["Down","Up"],mn=["PageDown","PageUp"],un=["Home","End"];K.dir&&!K.ort?at.reverse():K.ort&&!K.dir&&(Ot.reverse(),mn.reverse());var jn,on=Oe.key.replace("Arrow",""),Er=on===mn[0],mr=on===mn[1],xi=on===Ot[0]||on===at[0]||Er,Si=on===Ot[1]||on===at[1]||mr,ji=on===un[0],Ar=on===un[1];if(!(xi||Si||ji||Ar))return!0;if(Oe.preventDefault(),Si||xi){var Ei=xi?0:1,gr=Re(Ze)[Ei];if(gr===null)return!1;gr===!1&&(gr=X.getDefaultStep(de[Ze],xi,K.keyboardDefaultStep)),gr*=mr||Er?K.keyboardPageMultiplier:K.keyboardMultiplier,gr=Math.max(gr,1e-7),gr*=xi?-1:1,jn=te[Ze]+gr}else jn=Ar?K.spectrum.xVal[K.spectrum.xVal.length-1]:K.spectrum.xVal[0];return Jn(Ze,X.toStepping(jn),!0,!0),er("slide",Ze),er("update",Ze),er("change",Ze),er("set",Ze),!1}function yt(Oe){Oe.fixed||mt.forEach(function(Ze,at){Xo(Hn.start,Ze.children[0],Io,{handleNumbers:[at]})}),Oe.tap&&Xo(Hn.start,rt,Zo,{}),Oe.hover&&Xo(Hn.move,rt,Br,{hover:!0}),Oe.drag&&zt.forEach(function(Ze,at){if(Ze!==!1&&at!==0&&at!==zt.length-1){var Ot=mt[at-1],mn=mt[at],un=[Ze],jn=[Ot,mn],on=[at-1,at];k(Ze,K.cssClasses.draggable),Oe.fixed&&(un.push(Ot.children[0]),un.push(mn.children[0])),Oe.dragAll&&(jn=mt,on=Pe),un.forEach(function(Er){Xo(Hn.start,Er,Io,{handles:jn,handleNumbers:on,connect:Ze})})}})}function No(Oe,Ze){Je[Oe]=Je[Oe]||[],Je[Oe].push(Ze),Oe.split(".")[0]==="update"&&mt.forEach(function(at,Ot){er("update",Ot)})}function sr(Oe){return Oe===cn.aria||Oe===cn.tooltips}function Ai(Oe){var Ze=Oe&&Oe.split(".")[0],at=Ze?Oe.substring(Ze.length):Oe;Object.keys(Je).forEach(function(Ot){var mn=Ot.split(".")[0],un=Ot.substring(mn.length);Ze&&Ze!==mn||at&&at!==un||sr(un)&&at!==un||delete Je[Ot]})}function er(Oe,Ze,at){Object.keys(Je).forEach(function(Ot){var mn=Ot.split(".")[0];Oe===mn&&Je[Ot].forEach(function(un){un.call(ui,te.map(K.format.to),Ze,te.slice(),at||!1,de.slice(),ui)})})}function go(Oe,Ze,at,Ot,mn,un,jn){var on;return mt.length>1&&!K.events.unconstrained&&(Ot&&Ze>0&&(on=X.getAbsoluteDistance(Oe[Ze-1],K.margin,!1),at=Math.max(at,on)),mn&&Ze<mt.length-1&&(on=X.getAbsoluteDistance(Oe[Ze+1],K.margin,!0),at=Math.min(at,on))),mt.length>1&&K.limit&&(Ot&&Ze>0&&(on=X.getAbsoluteDistance(Oe[Ze-1],K.limit,!1),at=Math.min(at,on)),mn&&Ze<mt.length-1&&(on=X.getAbsoluteDistance(Oe[Ze+1],K.limit,!0),at=Math.max(at,on))),K.padding&&(Ze===0&&(on=X.getAbsoluteDistance(0,K.padding[0],!1),at=Math.max(at,on)),Ze===mt.length-1&&(on=X.getAbsoluteDistance(100,K.padding[1],!0),at=Math.min(at,on))),jn||(at=X.getStep(at)),!((at=T(at))===Oe[Ze]&&!un)&&at}function ra(Oe,Ze){var at=K.ort;return(at?Ze:Oe)+", "+(at?Oe:Ze)}function qa(Oe,Ze,at,Ot,mn){var un=at.slice(),jn=Ot[0],on=K.events.smoothSteps,Er=[!Oe,Oe],mr=[Oe,!Oe];Ot=Ot.slice(),Oe&&Ot.reverse(),Ot.length>1?Ot.forEach(function(Si,ji){var Ar=go(un,Si,un[Si]+Ze,Er[ji],mr[ji],!1,on);Ar===!1?Ze=0:(Ze=Ar-un[Si],un[Si]=Ar)}):Er=mr=[!0];var xi=!1;Ot.forEach(function(Si,ji){xi=Jn(Si,at[Si]+Ze,Er[ji],mr[ji],!1,on)||xi}),xi&&(Ot.forEach(function(Si){er("update",Si),er("slide",Si)}),mn!=null&&er("drag",jn))}function Ts(Oe,Ze){return K.dir?100-Oe-Ze:Oe}function nn(Oe,Ze){de[Oe]=Ze,te[Oe]=X.fromStepping(Ze);var at="translate("+ra(Ts(Ze,0)-Ht+"%","0")+")";mt[Oe].style[K.transformRule]=at,yo(Oe),yo(Oe+1)}function Kn(){Pe.forEach(function(Oe){var Ze=de[Oe]>50?-1:1,at=3+(mt.length+Ze*Oe);mt[Oe].style.zIndex=String(at)})}function Jn(Oe,Ze,at,Ot,mn,un){return mn||(Ze=go(de,Oe,Ze,at,Ot,!1,un)),Ze!==!1&&(nn(Oe,Ze),!0)}function yo(Oe){if(zt[Oe]){var Ze=0,at=100;Oe!==0&&(Ze=de[Oe-1]),Oe!==zt.length-1&&(at=de[Oe]);var Ot=at-Ze,mn="translate("+ra(Ts(Ze,Ot)+"%","0")+")",un="scale("+ra(Ot/100,"1")+")";zt[Oe].style[K.transformRule]=mn+" "+un}}function xo(Oe,Ze){return Oe===null||Oe===!1||Oe===void 0?de[Ze]:(typeof Oe=="number"&&(Oe=String(Oe)),(Oe=K.format.from(Oe))!==!1&&(Oe=X.toStepping(Oe)),Oe===!1||isNaN(Oe)?de[Ze]:Oe)}function ni(Oe,Ze,at){var Ot=I(Oe),mn=de[0]===void 0;Ze=Ze===void 0||Ze,K.animate&&!mn&&w(ue,K.cssClasses.tap,K.animationDuration),Pe.forEach(function(on){Jn(on,xo(Ot[on],on),!0,!1,at)});var un=Pe.length===1?0:1;if(mn&&X.hasNoSize()&&(at=!0,de[0]=0,Pe.length>1)){var jn=100/(Pe.length-1);Pe.forEach(function(on){de[on]=on*jn})}for(;un<Pe.length;++un)Pe.forEach(function(on){Jn(on,de[on],!0,!0,at)});Kn(),Pe.forEach(function(on){er("update",on),Ot[on]!==null&&Ze&&er("set",on)})}function Ro(Oe){ni(K.start,Oe)}function Ya(Oe,Ze,at,Ot){if(!((Oe=Number(Oe))>=0&&Oe<Pe.length))throw new Error("noUiSlider: invalid handle number, got: "+Oe);Jn(Oe,xo(Ze,Oe),!0,!0,Ot),er("update",Oe),at&&er("set",Oe)}function se(Oe){if(Oe===void 0&&(Oe=!1),Oe)return te.length===1?te[0]:te.slice(0);var Ze=te.map(K.format.to);return Ze.length===1?Ze[0]:Ze}function ve(){for(Ai(cn.aria),Ai(cn.tooltips),Object.keys(K.cssClasses).forEach(function(Oe){F(ue,K.cssClasses[Oe])});ue.firstChild;)ue.removeChild(ue.firstChild);delete ue.noUiSlider}function Re(Oe){var Ze=de[Oe],at=X.getNearbySteps(Ze),Ot=te[Oe],mn=at.thisStep.step,un=null;if(K.snap)return[Ot-at.stepBefore.startValue||null,at.stepAfter.startValue-Ot||null];mn!==!1&&Ot+mn>at.stepAfter.startValue&&(mn=at.stepAfter.startValue-Ot),un=Ot>at.thisStep.startValue?at.thisStep.step:at.stepBefore.step!==!1&&Ot-at.stepBefore.highestStep,Ze===100?mn=null:Ze===0&&(un=null);var jn=X.countStepDecimals();return mn!==null&&mn!==!1&&(mn=Number(mn.toFixed(jn))),un!==null&&un!==!1&&(un=Number(un.toFixed(jn))),[un,mn]}function gt(){return Pe.map(Re)}function $t(Oe,Ze){var at=se(),Ot=["margin","limit","padding","range","animate","snap","step","format","pips","tooltips"];Ot.forEach(function(un){Oe[un]!==void 0&&(Be[un]=Oe[un])});var mn=zn(Be);Ot.forEach(function(un){Oe[un]!==void 0&&(K[un]=mn[un])}),X=mn.spectrum,K.margin=mn.margin,K.limit=mn.limit,K.padding=mn.padding,K.pips?Fs(K.pips):na(),K.tooltips?Fr():hr(),de=[],ni(l(Oe.start)?Oe.start:at,Ze)}function vn(){rt=Yn(ue),ci(K.connect,rt),yt(K.events),ni(K.start),K.pips&&Fs(K.pips),K.tooltips&&Fr(),xr()}vn();var ui={destroy:ve,steps:gt,on:No,off:Ai,get:se,set:ni,setHandle:Ya,reset:Ro,__moveHandles:function(Oe,Ze,at){qa(Oe,Ze,de,at)},options:Be,updateOptions:$t,target:ue,removePips:na,removeTooltips:hr,getPositions:function(){return de.slice()},getTooltips:function(){return bn},getOrigins:function(){return mt},pips:Fs};return ui}function ti(ie,K){if(!ie||!ie.nodeName)throw new Error("noUiSlider: create requires a single element, got: "+ie);if(ie.noUiSlider)throw new Error("noUiSlider: Slider was already initialized.");var Be=ei(ie,zn(K),K);return ie.noUiSlider=Be,Be}var li={__spectrum:Et,cssClasses:Qt,create:ti};n.create=ti,n.cssClasses=Qt,n.default=li,Object.defineProperty(n,"__esModule",{value:!0})})(e)}));function h6(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;const n=e.slice().sort();return t.length===e.length&&t.slice().sort().every(function(i,r){return i===n[r]})}var pP={name:"Slider",emits:["input","update:modelValue","start","slide","drag","update","change","set","end"],props:{value:{validator:function(t){return e=>typeof e=="number"||e instanceof Array||e==null||e===!1},required:!1},modelValue:{validator:function(t){return e=>typeof e=="number"||e instanceof Array||e==null||e===!1},required:!1},id:{type:[String,Number],required:!1},disabled:{type:Boolean,required:!1,default:!1},min:{type:Number,required:!1,default:0},max:{type:Number,required:!1,default:100},step:{type:Number,required:!1,default:1},orientation:{type:String,required:!1,default:"horizontal"},direction:{type:String,required:!1,default:"ltr"},tooltips:{type:Boolean,required:!1,default:!0},options:{type:Object,required:!1,default:()=>({})},merge:{type:Number,required:!1,default:-1},format:{type:[Object,Function,Boolean],required:!1,default:null},classes:{type:Object,required:!1,default:()=>({})},showTooltip:{type:String,required:!1,default:"always"},tooltipPosition:{type:String,required:!1,default:null},lazy:{type:Boolean,required:!1,default:!0},ariaLabelledby:{type:String,required:!1,default:void 0},aria:{required:!1,type:Object,default:()=>({})}},setup(t,e){const n=function(l,s,d){const{value:p,modelValue:y,min:v}=Wp(l);let w=y&&y.value!==void 0?y:p;const T=$n(w.value);if(Nb(w.value)&&(w=$n(v.value)),Array.isArray(w.value)&&w.value.length==0)throw new Error("Slider v-model must not be an empty array");return{value:w,initialValue:T}}(t),i=function(l,s,d){const{classes:p,showTooltip:y,tooltipPosition:v,orientation:w}=Wp(l),T=ur(()=>({target:"slider-target",focused:"slider-focused",tooltipFocus:"slider-tooltip-focus",tooltipDrag:"slider-tooltip-drag",ltr:"slider-ltr",rtl:"slider-rtl",horizontal:"slider-horizontal",vertical:"slider-vertical",textDirectionRtl:"slider-txt-dir-rtl",textDirectionLtr:"slider-txt-dir-ltr",base:"slider-base",connects:"slider-connects",connect:"slider-connect",origin:"slider-origin",handle:"slider-handle",handleLower:"slider-handle-lower",handleUpper:"slider-handle-upper",touchArea:"slider-touch-area",tooltip:"slider-tooltip",tooltipTop:"slider-tooltip-top",tooltipBottom:"slider-tooltip-bottom",tooltipLeft:"slider-tooltip-left",tooltipRight:"slider-tooltip-right",tooltipHidden:"slider-tooltip-hidden",active:"slider-active",draggable:"slider-draggable",tap:"slider-state-tap",drag:"slider-state-drag",pips:"slider-pips",pipsHorizontal:"slider-pips-horizontal",pipsVertical:"slider-pips-vertical",marker:"slider-marker",markerHorizontal:"slider-marker-horizontal",markerVertical:"slider-marker-vertical",markerNormal:"slider-marker-normal",markerLarge:"slider-marker-large",markerSub:"slider-marker-sub",value:"slider-value",valueHorizontal:"slider-value-horizontal",valueVertical:"slider-value-vertical",valueNormal:"slider-value-normal",valueLarge:"slider-value-large",valueSub:"slider-value-sub",...p.value}));return{classList:ur(()=>{const I={...T.value};return Object.keys(I).forEach(L=>{I[L]=Array.isArray(I[L])?I[L].filter(k=>k!==null).join(" "):I[L]}),y.value!=="always"&&(I.target+=` ${y.value==="drag"?I.tooltipDrag:I.tooltipFocus}`),w.value==="horizontal"&&(I.tooltip+=v.value==="bottom"?` ${I.tooltipBottom}`:` ${I.tooltipTop}`),w.value==="vertical"&&(I.tooltip+=v.value==="right"?` ${I.tooltipRight}`:` ${I.tooltipLeft}`),I})}}(t),r=function(l,s,d){const{format:p,step:y}=Wp(l),v=d.value,w=d.classList,T=ur(()=>p&&p.value?typeof p.value=="function"?{to:p.value}:u6({...p.value}):u6({decimals:y.value>=0?0:2})),I=ur(()=>Array.isArray(v.value)?v.value.map(L=>T.value):T.value);return{tooltipFormat:T,tooltipsFormat:I,tooltipsMerge:(L,k,F)=>{var B=getComputedStyle(L).direction==="rtl",G=L.noUiSlider.options.direction==="rtl",U=L.noUiSlider.options.orientation==="vertical",ee=L.noUiSlider.getTooltips(),ne=L.noUiSlider.getOrigins();ee.forEach(function(ye,fe){ye&&ne[fe].appendChild(ye)}),L.noUiSlider.on("update",function(ye,fe,J,Ce,me){var be=[[]],Te=[[]],ke=[[]],ut=0;ee[0]&&(be[0][0]=0,Te[0][0]=me[0],ke[0][0]=T.value.to(parseFloat(ye[0])));for(var et=1;et<ye.length;et++)(!ee[et]||ye[et]-ye[et-1]>k)&&(be[++ut]=[],ke[ut]=[],Te[ut]=[]),ee[et]&&(be[ut].push(et),ke[ut].push(T.value.to(parseFloat(ye[et]))),Te[ut].push(me[et]));be.forEach(function(Et,bt){for(var Qt=Et.length,cn=0;cn<Qt;cn++){var pn=Et[cn];if(cn===Qt-1){var xn=0;Te[bt].forEach(function(Nt){xn+=1e3-Nt});var An=U?"bottom":"right",kn=G?0:Qt-1,Bn=1e3-Te[bt][kn];xn=(B&&!U?100:0)+xn/Qt-Bn,ee[pn].innerHTML=ke[bt].join(F),ee[pn].style.display="block",ee[pn].style[An]=xn+"%",w.value.tooltipHidden.split(" ").forEach(Nt=>{ee[pn].classList.contains(Nt)&&ee[pn].classList.remove(Nt)})}else ee[pn].style.display="none",w.value.tooltipHidden.split(" ").forEach(Nt=>{ee[pn].classList.add(Nt)})}})})}}}(t,0,{value:n.value,classList:i.classList}),o=function(l,s,d){const{orientation:p,direction:y,tooltips:v,step:w,min:T,max:I,merge:L,id:k,disabled:F,options:B,classes:G,format:U,lazy:ee,ariaLabelledby:ne,aria:ye}=Wp(l),fe=d.value,J=d.initialValue,Ce=d.tooltipsFormat,me=d.tooltipsMerge,be=d.tooltipFormat,Te=d.classList,ke=$n(null),ut=$n(null),et=$n(!1),Et=ur(()=>{let Nt={cssPrefix:"",cssClasses:Te.value,orientation:p.value,direction:y.value,tooltips:!!v.value&&Ce.value,connect:"lower",start:Nb(fe.value)?T.value:fe.value,range:{min:T.value,max:I.value}};if(w.value>0&&(Nt.step=w.value),Array.isArray(fe.value)&&(Nt.connect=!0),ne&&ne.value||ye&&Object.keys(ye.value).length){let We=Array.isArray(fe.value)?fe.value:[fe.value];Nt.handleAttributes=We.map(kt=>Object.assign({},ye.value,ne&&ne.value?{"aria-labelledby":ne.value}:{}))}return U.value&&(Nt.ariaFormat=be.value),Nt}),bt=ur(()=>{let Nt={id:k&&k.value?k.value:void 0};return F.value&&(Nt.disabled=!0),Nt}),Qt=ur(()=>Array.isArray(fe.value)),cn=()=>{let Nt=ut.value.get();return Array.isArray(Nt)?Nt.map(We=>parseFloat(We)):parseFloat(Nt)},pn=function(Nt){let We=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];ut.value.set(Nt,We)},xn=Nt=>{s.emit("input",Nt),s.emit("update:modelValue",Nt),s.emit("update",Nt)},An=()=>{ut.value=gfe.create(ke.value,Object.assign({},Et.value,B.value)),v.value&&Qt.value&&L.value>=0&&me(ke.value,L.value," - "),ut.value.on("set",()=>{const Nt=cn();s.emit("change",Nt),s.emit("set",Nt),ee.value&&xn(Nt)}),ut.value.on("update",()=>{if(!et.value)return;const Nt=cn();Qt.value&&h6(fe.value,Nt)||!Qt.value&&fe.value==Nt?s.emit("update",Nt):ee.value||xn(Nt)}),ut.value.on("start",()=>{s.emit("start",cn())}),ut.value.on("end",()=>{s.emit("end",cn())}),ut.value.on("slide",()=>{s.emit("slide",cn())}),ut.value.on("drag",()=>{s.emit("drag",cn())}),ke.value.querySelectorAll("[data-handle]").forEach(Nt=>{Nt.onblur=()=>{ke.value&&Te.value.focused.split(" ").forEach(We=>{ke.value.classList.remove(We)})},Nt.onfocus=()=>{Te.value.focused.split(" ").forEach(We=>{ke.value.classList.add(We)})}}),et.value=!0},kn=()=>{ut.value.off(),ut.value.destroy(),ut.value=null},Bn=(Nt,We)=>{et.value=!1,kn(),An()};return Ds(An),bf(kn),Ri(Qt,Bn,{immediate:!1}),Ri(T,Bn,{immediate:!1}),Ri(I,Bn,{immediate:!1}),Ri(w,Bn,{immediate:!1}),Ri(p,Bn,{immediate:!1}),Ri(y,Bn,{immediate:!1}),Ri(v,Bn,{immediate:!1}),Ri(L,Bn,{immediate:!1}),Ri(U,Bn,{immediate:!1,deep:!0}),Ri(B,Bn,{immediate:!1,deep:!0}),Ri(G,Bn,{immediate:!1,deep:!0}),Ri(fe,(Nt,We)=>{We&&(typeof We=="object"&&typeof Nt=="object"&&Nt&&Object.keys(We)>Object.keys(Nt)||typeof We=="object"&&typeof Nt!="object"||Nb(Nt))&&Bn()},{immediate:!1}),Ri(fe,Nt=>{if(Nb(Nt))return void pn(T.value,!1);let We=cn();Qt.value&&!Array.isArray(We)&&(We=[We]),(Qt.value&&!h6(Nt,We)||!Qt.value&&Nt!=We)&&pn(Nt,!1)},{deep:!0}),{slider:ke,slider$:ut,isRange:Qt,sliderProps:bt,init:An,destroy:kn,refresh:Bn,update:pn,reset:()=>{xn(J.value)}}}(t,e,{value:n.value,initialValue:n.initialValue,tooltipFormat:r.tooltipFormat,tooltipsFormat:r.tooltipsFormat,tooltipsMerge:r.tooltipsMerge,classList:i.classList});return{...i,...r,...o}}};pP.render=function(t,e,n,i,r,o){return le(),Ue("div",Le(t.sliderProps,{ref:"slider"}),null,16)},pP.__file="src/Slider.vue";var N2={name:"Portal",props:{appendTo:{type:String,default:"body"},disabled:{type:Boolean,default:!1}},data:function(){return{mounted:!1}},mounted:function(){this.mounted=He.isClient()},computed:{inline:function(){return this.disabled||this.appendTo==="self"}}};function yfe(t,e,n,i,r,o){return o.inline?Xn(t.$slots,"default",{key:0}):r.mounted?(le(),Rt(nz,{key:1,to:n.appendTo},[Xn(t.$slots,"default")],8,["to"])):Jt("",!0)}N2.render=yfe;var vfe=`
@layer primevue {
    .p-contextmenu ul {
        margin: 0;
        padding: 0;
        list-style: none;
    }

    .p-contextmenu .p-submenu-list {
        position: absolute;
        min-width: 100%;
        z-index: 1;
    }

    .p-contextmenu .p-menuitem-link {
        cursor: pointer;
        display: flex;
        align-items: center;
        text-decoration: none;
        overflow: hidden;
        position: relative;
    }

    .p-contextmenu .p-menuitem-text {
        line-height: 1;
    }

    .p-contextmenu .p-menuitem {
        position: relative;
    }

    .p-contextmenu .p-menuitem-link .p-submenu-icon {
        margin-left: auto;
    }

    .p-contextmenu-enter-from {
        opacity: 0;
    }

    .p-contextmenu-enter-active {
        transition: opacity 250ms;
    }
}
`,_fe={root:function(e){var n=e.instance;return["p-contextmenu p-component",{"p-input-filled":n.$primevue.config.inputStyle==="filled","p-ripple-disabled":n.$primevue.config.ripple===!1}]},menu:"p-contextmenu-root-list",menuitem:function(e){var n=e.instance,i=e.processedItem;return["p-menuitem",{"p-menuitem-active p-highlight":n.isItemActive(i),"p-focus":n.isItemFocused(i),"p-disabled":n.isItemDisabled(i)}]},content:"p-menuitem-content",action:function(e){var n=e.props,i=e.isActive,r=e.isExactActive;return["p-menuitem-link",{"router-link-active":i,"router-link-active-exact":n.exact&&r}]},icon:"p-menuitem-icon",label:"p-menuitem-text",submenuIcon:"p-submenu-icon",submenu:"p-submenu-list",separator:"p-menuitem-separator"},bfe=_o.extend({name:"contextmenu",css:vfe,classes:_fe}),xfe=`
.p-icon {
    display: inline-block;
}

.p-icon-spin {
    -webkit-animation: p-icon-spin 2s infinite linear;
    animation: p-icon-spin 2s infinite linear;
}

@-webkit-keyframes p-icon-spin {
    0% {
        -webkit-transform: rotate(0deg);
        transform: rotate(0deg);
    }
    100% {
        -webkit-transform: rotate(359deg);
        transform: rotate(359deg);
    }
}

@keyframes p-icon-spin {
    0% {
        -webkit-transform: rotate(0deg);
        transform: rotate(0deg);
    }
    100% {
        -webkit-transform: rotate(359deg);
        transform: rotate(359deg);
    }
}
`,wfe=_o.extend({name:"baseicon",css:xfe}),mo={name:"BaseIcon",props:{label:{type:String,default:void 0},spin:{type:Boolean,default:!1}},beforeMount:function(){var e;wfe.loadStyle({nonce:(e=this.$config)===null||e===void 0||(e=e.csp)===null||e===void 0?void 0:e.nonce})},methods:{pti:function(){var e=At.isEmpty(this.label);return{class:["p-icon",{"p-icon-spin":this.spin}],role:e?void 0:"img","aria-label":e?void 0:this.label,"aria-hidden":e}}},computed:{$config:function(){var e;return(e=this.$primevue)===null||e===void 0?void 0:e.config}}},n3={name:"AngleRightIcon",extends:mo},Efe=Qe("path",{d:"M5.25 11.1728C5.14929 11.1694 5.05033 11.1455 4.9592 11.1025C4.86806 11.0595 4.78666 10.9984 4.72 10.9228C4.57955 10.7822 4.50066 10.5916 4.50066 10.3928C4.50066 10.1941 4.57955 10.0035 4.72 9.86283L7.72 6.86283L4.72 3.86283C4.66067 3.71882 4.64765 3.55991 4.68275 3.40816C4.71785 3.25642 4.79932 3.11936 4.91585 3.01602C5.03238 2.91268 5.17819 2.84819 5.33305 2.83149C5.4879 2.81479 5.64411 2.84671 5.78 2.92283L9.28 6.42283C9.42045 6.56346 9.49934 6.75408 9.49934 6.95283C9.49934 7.15158 9.42045 7.34221 9.28 7.48283L5.78 10.9228C5.71333 10.9984 5.63193 11.0595 5.5408 11.1025C5.44966 11.1455 5.35071 11.1694 5.25 11.1728Z",fill:"currentColor"},null,-1),Tfe=[Efe];function Sfe(t,e,n,i,r,o){return le(),Ue("svg",Le({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),Tfe,16)}n3.render=Sfe;var Cfe={name:"BaseContextMenu",extends:Ni,props:{model:{type:Array,default:null},appendTo:{type:String,default:"body"},autoZIndex:{type:Boolean,default:!0},baseZIndex:{type:Number,default:0},global:{type:Boolean,default:!1},exact:{type:Boolean,default:!0},tabindex:{type:Number,default:0},"aria-labelledby":{type:String,default:null},"aria-label":{type:String,default:null}},style:bfe,provide:function(){return{$parentInstance:this}}},K7={name:"ContextMenuSub",hostName:"ContextMenu",extends:Ni,emits:["item-click","item-mouseenter"],props:{items:{type:Array,default:null},menuId:{type:String,default:null},focusedItemId:{type:String,default:null},root:{type:Boolean,default:!1},visible:{type:Boolean,default:!1},level:{type:Number,default:0},templates:{type:Object,default:null},exact:{type:Boolean,default:!0},activeItemPath:{type:Object,default:null},tabindex:{type:Number,default:0}},methods:{getItemId:function(e){return"".concat(this.menuId,"_").concat(e.key)},getItemKey:function(e){return this.getItemId(e)},getItemProp:function(e,n,i){return e&&e.item?At.getItemValue(e.item[n],i):void 0},getItemLabel:function(e){return this.getItemProp(e,"label")},getPTOptions:function(e,n,i){return this.ptm(e,{context:{item:n,active:this.isItemActive(n),focused:this.isItemFocused(n),disabled:this.isItemDisabled(n),index:i}})},isItemActive:function(e){return this.activeItemPath.some(function(n){return n.key===e.key})},isItemVisible:function(e){return this.getItemProp(e,"visible")!==!1},isItemDisabled:function(e){return this.getItemProp(e,"disabled")},isItemFocused:function(e){return this.focusedItemId===this.getItemId(e)},isItemGroup:function(e){return At.isNotEmpty(e.items)},onItemClick:function(e,n){this.getItemProp(n,"command",{originalEvent:e,item:n.item}),this.$emit("item-click",{originalEvent:e,processedItem:n,isFocus:!0})},onItemMouseEnter:function(e,n){this.$emit("item-mouseenter",{originalEvent:e,processedItem:n})},onItemActionClick:function(e,n){n&&n(e)},getAriaSetSize:function(){var e=this;return this.items.filter(function(n){return e.isItemVisible(n)&&!e.getItemProp(n,"separator")}).length},getAriaPosInset:function(e){var n=this;return e-this.items.slice(0,e).filter(function(i){return n.isItemVisible(i)&&n.getItemProp(i,"separator")}).length+1},onEnter:function(){this.position()},position:function(){var e=this.$refs.container.parentElement,n=He.getOffset(this.$refs.container.parentElement),i=He.getViewport(),r=this.$refs.container.offsetParent?this.$refs.container.offsetWidth:He.getHiddenElementOuterWidth(this.$refs.container),o=He.getOuterWidth(e.children[0]);this.$refs.container.style.top="0px",parseInt(n.left,10)+o+r>i.width-He.calculateScrollbarWidth()?this.$refs.container.style.left=-1*r+"px":this.$refs.container.style.left=o+"px"},getMenuItemProps:function(e,n){return{action:Le({class:this.cx("action"),tabindex:-1,"aria-hidden":!0},this.getPTOptions("action",e,n)),icon:Le({class:[this.cx("icon"),this.getItemProp(e,"icon")]},this.getPTOptions("icon",e,n)),label:Le({class:this.cx("label")},this.getPTOptions("label",e,n)),submenuicon:Le({class:this.cx("submenuIcon")},this.getPTOptions("submenuicon",e,n))}}},components:{AngleRightIcon:n3},directives:{ripple:Rl}},Afe=["tabindex"],Pfe=["id","aria-label","aria-disabled","aria-expanded","aria-haspopup","aria-level","aria-setsize","aria-posinset","data-p-highlight","data-p-focused","data-p-disabled"],Ife=["onClick","onMouseenter"],Mfe=["href","onClick"],Rfe=["href","target"],Lfe=["id"];function Ofe(t,e,n,i,r,o){var l=Gn("router-link"),s=Gn("AngleRightIcon"),d=Gn("ContextMenuSub",!0),p=ea("ripple");return le(),Rt(xf,Le({name:"p-contextmenusub",onEnter:o.onEnter},t.ptm("menu.transition")),{default:Cn(function(){return[n.root||n.visible?(le(),Ue("ul",Le({key:0,ref:"container",tabindex:n.tabindex},t.ptm("menu")),[(le(!0),Ue(_n,null,or(n.items,function(y,v){return le(),Ue(_n,{key:o.getItemKey(y)},[o.isItemVisible(y)&&!o.getItemProp(y,"separator")?(le(),Ue("li",Le({key:0,id:o.getItemId(y),style:o.getItemProp(y,"style"),class:[t.cx("menuitem",{processedItem:y}),o.getItemProp(y,"class")],role:"menuitem","aria-label":o.getItemLabel(y),"aria-disabled":o.isItemDisabled(y)||void 0,"aria-expanded":o.isItemGroup(y)?o.isItemActive(y):void 0,"aria-haspopup":o.isItemGroup(y)&&!o.getItemProp(y,"to")?"menu":void 0,"aria-level":n.level+1,"aria-setsize":o.getAriaSetSize(),"aria-posinset":o.getAriaPosInset(v)},o.getPTOptions("menuitem",y,v),{"data-p-highlight":o.isItemActive(y),"data-p-focused":o.isItemFocused(y),"data-p-disabled":o.isItemDisabled(y)}),[Qe("div",Le({class:t.cx("content"),onClick:function(T){return o.onItemClick(T,y)},onMouseenter:function(T){return o.onItemMouseEnter(T,y)}},o.getPTOptions("content",y,v)),[n.templates.item?(le(),Rt(Zn(n.templates.item),{key:1,item:y.item,label:o.getItemLabel(y),props:o.getMenuItemProps(y,v)},null,8,["item","label","props"])):(le(),Ue(_n,{key:0},[o.getItemProp(y,"to")&&!o.isItemDisabled(y)?(le(),Rt(l,{key:0,to:o.getItemProp(y,"to"),custom:""},{default:Cn(function(w){var T=w.navigate,I=w.href,L=w.isActive,k=w.isExactActive;return[fo((le(),Ue("a",Le({href:I,class:t.cx("action",{isActive:L,isExactActive:k}),tabindex:"-1","aria-hidden":"true",onClick:function(B){return o.onItemActionClick(B,T)}},o.getPTOptions("action",y,v)),[n.templates.itemicon?(le(),Rt(Zn(n.templates.itemicon),{key:0,item:y.item,class:ri([t.cx("icon"),o.getItemProp(y,"icon")])},null,8,["item","class"])):o.getItemProp(y,"icon")?(le(),Ue("span",Le({key:1,class:[t.cx("icon"),o.getItemProp(y,"icon")]},o.getPTOptions("icon",y,v)),null,16)):Jt("",!0),Qe("span",Le({class:t.cx("label")},o.getPTOptions("label",y,v)),ki(o.getItemLabel(y)),17)],16,Mfe)),[[p]])]}),_:2},1032,["to"])):fo((le(),Ue("a",Le({key:1,href:o.getItemProp(y,"url"),class:t.cx("action"),target:o.getItemProp(y,"target"),tabindex:"-1","aria-hidden":"true"},o.getPTOptions("action",y,v)),[n.templates.itemicon?(le(),Rt(Zn(n.templates.itemicon),{key:0,item:y.item,class:ri([t.cx("icon"),o.getItemProp(y,"icon")])},null,8,["item","class"])):o.getItemProp(y,"icon")?(le(),Ue("span",Le({key:1,class:[t.cx("icon"),o.getItemProp(y,"icon")]},o.getPTOptions("icon",y,v)),null,16)):Jt("",!0),Qe("span",Le({class:t.cx("label")},o.getPTOptions("label",y,v)),ki(o.getItemLabel(y)),17),o.getItemProp(y,"items")?(le(),Ue(_n,{key:2},[n.templates.submenuicon?(le(),Rt(Zn(n.templates.submenuicon),{key:0,active:o.isItemActive(y),class:ri(t.cx("submenuIcon"))},null,8,["active","class"])):(le(),Rt(s,Le({key:1,class:t.cx("submenuIcon")},o.getPTOptions("submenuicon",y,v)),null,16,["class"]))],64)):Jt("",!0)],16,Rfe)),[[p]])],64))],16,Ife),o.isItemVisible(y)&&o.isItemGroup(y)?(le(),Rt(d,Le({key:0,id:o.getItemId(y)+"_list",role:"menu",class:t.cx("submenu"),menuId:n.menuId,focusedItemId:n.focusedItemId,items:y.items,templates:n.templates,activeItemPath:n.activeItemPath,exact:n.exact,level:n.level+1,visible:o.isItemActive(y)&&o.isItemGroup(y),pt:t.pt,unstyled:t.unstyled,onItemClick:e[0]||(e[0]=function(w){return t.$emit("item-click",w)}),onItemMouseenter:e[1]||(e[1]=function(w){return t.$emit("item-mouseenter",w)})},t.ptm("submenu")),null,16,["id","class","menuId","focusedItemId","items","templates","activeItemPath","exact","level","visible","pt","unstyled"])):Jt("",!0)],16,Pfe)):Jt("",!0),o.isItemVisible(y)&&o.getItemProp(y,"separator")?(le(),Ue("li",Le({key:1,id:o.getItemId(y),style:o.getItemProp(y,"style"),class:[t.cx("separator"),o.getItemProp(y,"class")],role:"separator"},t.ptm("separator")),null,16,Lfe)):Jt("",!0)],64)}),128))],16,Afe)):Jt("",!0)]}),_:1},16,["onEnter"])}K7.render=Ofe;var X7={name:"ContextMenu",extends:Cfe,inheritAttrs:!1,emits:["focus","blur","show","hide"],target:null,outsideClickListener:null,resizeListener:null,documentContextMenuListener:null,pageX:null,pageY:null,container:null,list:null,data:function(){return{id:this.$attrs.id,focused:!1,focusedItemInfo:{index:-1,level:0,parentKey:""},activeItemPath:[],visible:!1,submenuVisible:!1}},watch:{"$attrs.id":function(e){this.id=e||Gr()},activeItemPath:function(e){At.isNotEmpty(e)?(this.bindOutsideClickListener(),this.bindResizeListener()):this.visible||(this.unbindOutsideClickListener(),this.unbindResizeListener())}},beforeMount:function(){this.$slots.item||console.warn("In future versions, vue-router support will be removed. Item templating should be used.")},mounted:function(){this.id=this.id||Gr(),this.global&&this.bindDocumentContextMenuListener()},beforeUnmount:function(){this.unbindResizeListener(),this.unbindOutsideClickListener(),this.unbindDocumentContextMenuListener(),this.container&&this.autoZIndex&&Sl.clear(this.container),this.target=null,this.container=null},methods:{getItemProp:function(e,n){return e?At.getItemValue(e[n]):void 0},getItemLabel:function(e){return this.getItemProp(e,"label")},isItemDisabled:function(e){return this.getItemProp(e,"disabled")},isItemGroup:function(e){return At.isNotEmpty(this.getItemProp(e,"items"))},isItemSeparator:function(e){return this.getItemProp(e,"separator")},getProccessedItemLabel:function(e){return e?this.getItemLabel(e.item):void 0},isProccessedItemGroup:function(e){return e&&At.isNotEmpty(e.items)},toggle:function(e){this.visible?this.hide():this.show(e)},show:function(e){this.activeItemPath=[],this.focusedItemInfo={index:-1,level:0,parentKey:""},He.focus(this.list),this.pageX=e.pageX,this.pageY=e.pageY,this.visible?this.position():this.visible=!0,e.stopPropagation(),e.preventDefault()},hide:function(){this.visible=!1,this.activeItemPath=[],this.focusedItemInfo={index:-1,level:0,parentKey:""}},onFocus:function(e){this.focused=!0,this.focusedItemInfo=this.focusedItemInfo.index!==-1?this.focusedItemInfo:{index:-1,level:0,parentKey:""},this.$emit("focus",e)},onBlur:function(e){this.focused=!1,this.focusedItemInfo={index:-1,level:0,parentKey:""},this.searchValue="",this.$emit("blur",e)},onKeyDown:function(e){var n=e.metaKey||e.ctrlKey;switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e);break;case"ArrowLeft":this.onArrowLeftKey(e);break;case"ArrowRight":this.onArrowRightKey(e);break;case"Home":this.onHomeKey(e);break;case"End":this.onEndKey(e);break;case"Space":this.onSpaceKey(e);break;case"Enter":this.onEnterKey(e);break;case"Escape":this.onEscapeKey(e);break;case"Tab":this.onTabKey(e);break;case"PageDown":case"PageUp":case"Backspace":case"ShiftLeft":case"ShiftRight":break;default:!n&&At.isPrintableCharacter(e.key)&&this.searchItems(e,e.key);break}},onItemChange:function(e){var n=e.processedItem,i=e.isFocus;if(!At.isEmpty(n)){var r=n.index,o=n.key,l=n.level,s=n.parentKey,d=n.items,p=At.isNotEmpty(d),y=this.activeItemPath.filter(function(v){return v.parentKey!==s&&v.parentKey!==o});p&&(y.push(n),this.submenuVisible=!0),this.focusedItemInfo={index:r,level:l,parentKey:s},this.activeItemPath=y,i&&He.focus(this.list)}},onItemClick:function(e){var n=e.processedItem,i=this.isProccessedItemGroup(n),r=this.isSelected(n);if(r){var o=n.index,l=n.key,s=n.level,d=n.parentKey;this.activeItemPath=this.activeItemPath.filter(function(p){return l!==p.key&&l.startsWith(p.key)}),this.focusedItemInfo={index:o,level:s,parentKey:d},He.focus(this.list)}else i?this.onItemChange(e):this.hide()},onItemMouseEnter:function(e){this.onItemChange(e)},onArrowDownKey:function(e){var n=this.focusedItemInfo.index!==-1?this.findNextItemIndex(this.focusedItemInfo.index):this.findFirstFocusedItemIndex();this.changeFocusedItemIndex(e,n),e.preventDefault()},onArrowUpKey:function(e){if(e.altKey){if(this.focusedItemInfo.index!==-1){var n=this.visibleItems[this.focusedItemInfo.index],i=this.isProccessedItemGroup(n);!i&&this.onItemChange({originalEvent:e,processedItem:n})}this.popup&&this.hide(),e.preventDefault()}else{var r=this.focusedItemInfo.index!==-1?this.findPrevItemIndex(this.focusedItemInfo.index):this.findLastFocusedItemIndex();this.changeFocusedItemIndex(e,r),e.preventDefault()}},onArrowLeftKey:function(e){var n=this,i=this.visibleItems[this.focusedItemInfo.index],r=this.activeItemPath.find(function(l){return l.key===i.parentKey}),o=At.isEmpty(i.parent);o||(this.focusedItemInfo={index:-1,parentKey:r?r.parentKey:""},this.searchValue="",this.onArrowDownKey(e)),this.activeItemPath=this.activeItemPath.filter(function(l){return l.parentKey!==n.focusedItemInfo.parentKey}),e.preventDefault()},onArrowRightKey:function(e){var n=this.visibleItems[this.focusedItemInfo.index],i=this.isProccessedItemGroup(n);i&&(this.onItemChange({originalEvent:e,processedItem:n}),this.focusedItemInfo={index:-1,parentKey:n.key},this.searchValue="",this.onArrowDownKey(e)),e.preventDefault()},onHomeKey:function(e){this.changeFocusedItemIndex(e,this.findFirstItemIndex()),e.preventDefault()},onEndKey:function(e){this.changeFocusedItemIndex(e,this.findLastItemIndex()),e.preventDefault()},onEnterKey:function(e){if(this.focusedItemInfo.index!==-1){var n=He.findSingle(this.list,'li[id="'.concat("".concat(this.focusedItemId),'"]')),i=n&&He.findSingle(n,'a[data-pc-section="action"]');i?i.click():n&&n.click();var r=this.visibleItems[this.focusedItemInfo.index],o=this.isProccessedItemGroup(r);!o&&(this.focusedItemInfo.index=this.findFirstFocusedItemIndex())}e.preventDefault()},onSpaceKey:function(e){this.onEnterKey(e)},onEscapeKey:function(e){this.hide(),!this.popup&&(this.focusedItemInfo.index=this.findFirstFocusedItemIndex()),e.preventDefault()},onTabKey:function(e){if(this.focusedItemInfo.index!==-1){var n=this.visibleItems[this.focusedItemInfo.index],i=this.isProccessedItemGroup(n);!i&&this.onItemChange({originalEvent:e,processedItem:n})}this.hide()},onEnter:function(e){He.addStyles(e,{position:"absolute"}),this.position(),this.autoZIndex&&Sl.set("menu",e,this.baseZIndex+this.$primevue.config.zIndex.menu)},onAfterEnter:function(){this.bindOutsideClickListener(),this.bindResizeListener(),this.$emit("show"),He.focus(this.list)},onLeave:function(){this.$emit("hide"),this.container=null},onAfterLeave:function(e){this.autoZIndex&&Sl.clear(e),this.unbindOutsideClickListener(),this.unbindResizeListener()},position:function(){var e=this.pageX+1,n=this.pageY+1,i=this.container.offsetParent?this.container.offsetWidth:He.getHiddenElementOuterWidth(this.container),r=this.container.offsetParent?this.container.offsetHeight:He.getHiddenElementOuterHeight(this.container),o=He.getViewport();e+i-document.body.scrollLeft>o.width&&(e-=i),n+r-document.body.scrollTop>o.height&&(n-=r),e<document.body.scrollLeft&&(e=document.body.scrollLeft),n<document.body.scrollTop&&(n=document.body.scrollTop),this.container.style.left=e+"px",this.container.style.top=n+"px"},bindOutsideClickListener:function(){var e=this;this.outsideClickListener||(this.outsideClickListener=function(n){var i=e.container&&!e.container.contains(n.target),r=e.visible?!(e.target&&(e.target===n.target||e.target.contains(n.target))):!0;i&&r&&e.hide()},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener:function(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)},bindResizeListener:function(){var e=this;this.resizeListener||(this.resizeListener=function(){e.visible&&!He.isTouchDevice()&&e.hide()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener:function(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},bindDocumentContextMenuListener:function(){var e=this;this.documentContextMenuListener||(this.documentContextMenuListener=function(n){n.button===2&&e.show(n)},document.addEventListener("contextmenu",this.documentContextMenuListener))},unbindDocumentContextMenuListener:function(){this.documentContextMenuListener&&(document.removeEventListener("contextmenu",this.documentContextMenuListener),this.documentContextMenuListener=null)},isItemMatched:function(e){return this.isValidItem(e)&&this.getProccessedItemLabel(e).toLocaleLowerCase().startsWith(this.searchValue.toLocaleLowerCase())},isValidItem:function(e){return!!e&&!this.isItemDisabled(e.item)&&!this.isItemSeparator(e.item)},isValidSelectedItem:function(e){return this.isValidItem(e)&&this.isSelected(e)},isSelected:function(e){return this.activeItemPath.some(function(n){return n.key===e.key})},findFirstItemIndex:function(){var e=this;return this.visibleItems.findIndex(function(n){return e.isValidItem(n)})},findLastItemIndex:function(){var e=this;return At.findLastIndex(this.visibleItems,function(n){return e.isValidItem(n)})},findNextItemIndex:function(e){var n=this,i=e<this.visibleItems.length-1?this.visibleItems.slice(e+1).findIndex(function(r){return n.isValidItem(r)}):-1;return i>-1?i+e+1:e},findPrevItemIndex:function(e){var n=this,i=e>0?At.findLastIndex(this.visibleItems.slice(0,e),function(r){return n.isValidItem(r)}):-1;return i>-1?i:e},findSelectedItemIndex:function(){var e=this;return this.visibleItems.findIndex(function(n){return e.isValidSelectedItem(n)})},findFirstFocusedItemIndex:function(){var e=this.findSelectedItemIndex();return e<0?this.findFirstItemIndex():e},findLastFocusedItemIndex:function(){var e=this.findSelectedItemIndex();return e<0?this.findLastItemIndex():e},searchItems:function(e,n){var i=this;this.searchValue=(this.searchValue||"")+n;var r=-1,o=!1;return this.focusedItemInfo.index!==-1?(r=this.visibleItems.slice(this.focusedItemInfo.index).findIndex(function(l){return i.isItemMatched(l)}),r=r===-1?this.visibleItems.slice(0,this.focusedItemInfo.index).findIndex(function(l){return i.isItemMatched(l)}):r+this.focusedItemInfo.index):r=this.visibleItems.findIndex(function(l){return i.isItemMatched(l)}),r!==-1&&(o=!0),r===-1&&this.focusedItemInfo.index===-1&&(r=this.findFirstFocusedItemIndex()),r!==-1&&this.changeFocusedItemIndex(e,r),this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(function(){i.searchValue="",i.searchTimeout=null},500),o},changeFocusedItemIndex:function(e,n){this.focusedItemInfo.index!==n&&(this.focusedItemInfo.index=n,this.scrollInView())},scrollInView:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:-1,n=e!==-1?"".concat(this.id,"_").concat(e):this.focusedItemId,i=He.findSingle(this.list,'li[id="'.concat(n,'"]'));i&&i.scrollIntoView&&i.scrollIntoView({block:"nearest",inline:"start"})},createProcessedItems:function(e){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"",l=[];return e&&e.forEach(function(s,d){var p=(o!==""?o+"_":"")+d,y={item:s,index:d,level:i,key:p,parent:r,parentKey:o};y.items=n.createProcessedItems(s.items,i+1,y,p),l.push(y)}),l},containerRef:function(e){this.container=e},listRef:function(e){this.list=e?e.$el:void 0}},computed:{processedItems:function(){return this.createProcessedItems(this.model||[])},visibleItems:function(){var e=this,n=this.activeItemPath.find(function(i){return i.key===e.focusedItemInfo.parentKey});return n?n.items:this.processedItems},focusedItemId:function(){return this.focusedItemInfo.index!==-1?"".concat(this.id).concat(At.isNotEmpty(this.focusedItemInfo.parentKey)?"_"+this.focusedItemInfo.parentKey:"","_").concat(this.focusedItemInfo.index):null}},components:{ContextMenuSub:K7,Portal:N2}};function xv(t){"@babel/helpers - typeof";return xv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xv(t)}function d6(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function f6(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?d6(Object(n),!0).forEach(function(i){Dfe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d6(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Dfe(t,e,n){return e=kfe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kfe(t){var e=Ffe(t,"string");return xv(e)==="symbol"?e:String(e)}function Ffe(t,e){if(xv(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(xv(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bfe(t,e,n,i,r,o){var l=Gn("ContextMenuSub"),s=Gn("Portal");return le(),Rt(s,{appendTo:t.appendTo},{default:Cn(function(){return[Lt(xf,Le({name:"p-contextmenu",onEnter:o.onEnter,onAfterEnter:o.onAfterEnter,onLeave:o.onLeave,onAfterLeave:o.onAfterLeave},t.ptm("transition")),{default:Cn(function(){return[r.visible?(le(),Ue("div",Le({key:0,ref:o.containerRef,class:t.cx("root")},f6(f6({},t.$attrs),t.ptm("root")),{"data-pc-name":"contextmenu"}),[Lt(l,{ref:o.listRef,id:r.id+"_list",class:ri(t.cx("menu")),role:"menubar",root:!0,tabindex:t.tabindex,"aria-orientation":"vertical","aria-activedescendant":r.focused?o.focusedItemId:void 0,menuId:r.id,focusedItemId:r.focused?o.focusedItemId:void 0,items:o.processedItems,templates:t.$slots,activeItemPath:r.activeItemPath,exact:t.exact,"aria-labelledby":t.ariaLabelledby,"aria-label":t.ariaLabel,level:0,visible:r.submenuVisible,pt:t.pt,unstyled:t.unstyled,onFocus:o.onFocus,onBlur:o.onBlur,onKeydown:o.onKeyDown,onItemClick:o.onItemClick,onItemMouseenter:o.onItemMouseEnter},null,8,["id","class","tabindex","aria-activedescendant","menuId","focusedItemId","items","templates","activeItemPath","exact","aria-labelledby","aria-label","visible","pt","unstyled","onFocus","onBlur","onKeydown","onItemClick","onItemMouseenter"])],16)):Jt("",!0)]}),_:1},16,["onEnter","onAfterEnter","onLeave","onAfterLeave"])]}),_:1},8,["appendTo"])}X7.render=Bfe;var zfe=`
@layer primevue {
    .p-badge {
        display: inline-block;
        border-radius: 10px;
        text-align: center;
        padding: 0 .5rem;
    }

    .p-overlay-badge {
        position: relative;
    }

    .p-overlay-badge .p-badge {
        position: absolute;
        top: 0;
        right: 0;
        transform: translate(50%,-50%);
        transform-origin: 100% 0;
        margin: 0;
    }

    .p-badge-dot {
        width: .5rem;
        min-width: .5rem;
        height: .5rem;
        border-radius: 50%;
        padding: 0;
    }

    .p-badge-no-gutter {
        padding: 0;
        border-radius: 50%;
    }
}
`,Nfe={root:function(e){var n=e.props,i=e.instance;return["p-badge p-component",{"p-badge-no-gutter":At.isNotEmpty(n.value)&&String(n.value).length===1,"p-badge-dot":At.isEmpty(n.value)&&!i.$slots.default,"p-badge-lg":n.size==="large","p-badge-xl":n.size==="xlarge","p-badge-info":n.severity==="info","p-badge-success":n.severity==="success","p-badge-warning":n.severity==="warning","p-badge-danger":n.severity==="danger"}]}},Ufe=_o.extend({name:"badge",css:zfe,classes:Nfe}),Vfe={name:"BaseBadge",extends:Ni,props:{value:{type:[String,Number],default:null},severity:{type:String,default:null},size:{type:String,default:null}},style:Ufe,provide:function(){return{$parentInstance:this}}},Z7={name:"Badge",extends:Vfe};function jfe(t,e,n,i,r,o){return le(),Ue("span",Le({class:t.cx("root")},t.ptm("root"),{"data-pc-name":"badge"}),[Xn(t.$slots,"default",{},function(){return[vo(ki(t.value),1)]})],16)}Z7.render=jfe;var A_={name:"SpinnerIcon",extends:mo,computed:{pathId:function(){return"pv_icon_clip_".concat(Gr())}}},$fe=["clipPath"],Gfe=Qe("path",{d:"M6.99701 14C5.85441 13.999 4.72939 13.7186 3.72012 13.1832C2.71084 12.6478 1.84795 11.8737 1.20673 10.9284C0.565504 9.98305 0.165424 8.89526 0.041387 7.75989C-0.0826496 6.62453 0.073125 5.47607 0.495122 4.4147C0.917119 3.35333 1.59252 2.4113 2.46241 1.67077C3.33229 0.930247 4.37024 0.413729 5.4857 0.166275C6.60117 -0.0811796 7.76026 -0.0520535 8.86188 0.251112C9.9635 0.554278 10.9742 1.12227 11.8057 1.90555C11.915 2.01493 11.9764 2.16319 11.9764 2.31778C11.9764 2.47236 11.915 2.62062 11.8057 2.73C11.7521 2.78503 11.688 2.82877 11.6171 2.85864C11.5463 2.8885 11.4702 2.90389 11.3933 2.90389C11.3165 2.90389 11.2404 2.8885 11.1695 2.85864C11.0987 2.82877 11.0346 2.78503 10.9809 2.73C9.9998 1.81273 8.73246 1.26138 7.39226 1.16876C6.05206 1.07615 4.72086 1.44794 3.62279 2.22152C2.52471 2.99511 1.72683 4.12325 1.36345 5.41602C1.00008 6.70879 1.09342 8.08723 1.62775 9.31926C2.16209 10.5513 3.10478 11.5617 4.29713 12.1803C5.48947 12.7989 6.85865 12.988 8.17414 12.7157C9.48963 12.4435 10.6711 11.7264 11.5196 10.6854C12.3681 9.64432 12.8319 8.34282 12.8328 7C12.8328 6.84529 12.8943 6.69692 13.0038 6.58752C13.1132 6.47812 13.2616 6.41667 13.4164 6.41667C13.5712 6.41667 13.7196 6.47812 13.8291 6.58752C13.9385 6.69692 14 6.84529 14 7C14 8.85651 13.2622 10.637 11.9489 11.9497C10.6356 13.2625 8.85432 14 6.99701 14Z",fill:"currentColor"},null,-1),Hfe=[Gfe],Wfe=["id"],Kfe=Qe("rect",{width:"14",height:"14",fill:"white"},null,-1),Xfe=[Kfe];function Zfe(t,e,n,i,r,o){return le(),Ue("svg",Le({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),[Qe("g",{clipPath:"url(#".concat(o.pathId,")")},Hfe,8,$fe),Qe("defs",null,[Qe("clipPath",{id:"".concat(o.pathId)},Xfe,8,Wfe)])],16)}A_.render=Zfe;function wv(t){"@babel/helpers - typeof";return wv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wv(t)}function rh(t,e,n){return e=qfe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qfe(t){var e=Yfe(t,"string");return wv(e)==="symbol"?e:String(e)}function Yfe(t,e){if(wv(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(wv(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Jfe={root:function(e){var n,i=e.instance,r=e.props;return["p-button p-component",(n={"p-button-icon-only":i.hasIcon&&!r.label&&!r.badge,"p-button-vertical":(r.iconPos==="top"||r.iconPos==="bottom")&&r.label,"p-disabled":i.$attrs.disabled||i.$attrs.disabled===""||r.loading,"p-button-loading":r.loading,"p-button-loading-label-only":r.loading&&!i.hasIcon&&r.label,"p-button-link":r.link},rh(n,"p-button-".concat(r.severity),r.severity),rh(n,"p-button-raised",r.raised),rh(n,"p-button-rounded",r.rounded),rh(n,"p-button-text",r.text),rh(n,"p-button-outlined",r.outlined),rh(n,"p-button-sm",r.size==="small"),rh(n,"p-button-lg",r.size==="large"),rh(n,"p-button-plain",r.plain),n)]},loadingIcon:"p-button-loading-icon pi-spin",icon:function(e){var n=e.props;return["p-button-icon",{"p-button-icon-left":n.iconPos==="left"&&n.label,"p-button-icon-right":n.iconPos==="right"&&n.label,"p-button-icon-top":n.iconPos==="top"&&n.label,"p-button-icon-bottom":n.iconPos==="bottom"&&n.label}]},label:"p-button-label"},Qfe=_o.extend({name:"button",classes:Jfe}),epe={name:"BaseButton",extends:Ni,props:{label:{type:String,default:null},icon:{type:String,default:null},iconPos:{type:String,default:"left"},iconClass:{type:String,default:null},badge:{type:String,default:null},badgeClass:{type:String,default:null},loading:{type:Boolean,default:!1},loadingIcon:{type:String,default:void 0},link:{type:Boolean,default:!1},severity:{type:String,default:null},raised:{type:Boolean,default:!1},rounded:{type:Boolean,default:!1},text:{type:Boolean,default:!1},outlined:{type:Boolean,default:!1},size:{type:String,default:null},plain:{type:Boolean,default:!1}},style:Qfe,provide:function(){return{$parentInstance:this}}},zh={name:"Button",extends:epe,methods:{getPTOptions:function(e){var n,i;return this.ptm(e,{parent:{props:(n=this.$parent)===null||n===void 0?void 0:n.$props,state:(i=this.$parent)===null||i===void 0?void 0:i.$data},context:{disabled:this.disabled}})}},computed:{disabled:function(){return this.$attrs.disabled||this.$attrs.disabled===""||this.loading},defaultAriaLabel:function(){return this.label?this.label+(this.badge?" "+this.badge:""):this.$attrs["aria-label"]},hasIcon:function(){return this.icon||this.$slots.icon}},components:{SpinnerIcon:A_,Badge:Z7},directives:{ripple:Rl}},tpe=["aria-label","disabled","data-pc-severity"];function npe(t,e,n,i,r,o){var l=Gn("SpinnerIcon"),s=Gn("Badge"),d=ea("ripple");return fo((le(),Ue("button",Le({class:t.cx("root"),type:"button","aria-label":o.defaultAriaLabel,disabled:o.disabled},o.getPTOptions("root"),{"data-pc-name":"button","data-pc-severity":t.severity}),[Xn(t.$slots,"default",{},function(){return[t.loading?Xn(t.$slots,"loadingicon",{key:0,class:ri([t.cx("loadingIcon"),t.cx("icon")])},function(){return[t.loadingIcon?(le(),Ue("span",Le({key:0,class:[t.cx("loadingIcon"),t.cx("icon"),t.loadingIcon]},t.ptm("loadingIcon")),null,16)):(le(),Rt(l,Le({key:1,class:[t.cx("loadingIcon"),t.cx("icon")],spin:""},t.ptm("loadingIcon")),null,16,["class"]))]}):Xn(t.$slots,"icon",{key:1,class:ri([t.cx("icon")])},function(){return[t.icon?(le(),Ue("span",Le({key:0,class:[t.cx("icon"),t.icon,t.iconClass]},t.ptm("icon")),null,16)):Jt("",!0)]}),Qe("span",Le({class:t.cx("label")},t.ptm("label")),ki(t.label||" "),17),t.badge?(le(),Rt(s,Le({key:2,value:t.badge,class:t.badgeClass,unstyled:t.unstyled},t.ptm("badge")),null,16,["value","class","unstyled"])):Jt("",!0)]})],16,tpe)),[[d]])}zh.render=npe;const Xa=E2("singleMap",{state:()=>({deckGLMapState:[],accessToken:"pk.eyJ1Ijoia2Rhc3UiLCJhIjoiY2tiMml3dDhjMDRrNTJ6cGgzdzBweTZmaCJ9.-HeZjTEqnQE8PYKvtcqNjg",mapStyle:"mapbox://styles/haxzie/ck0aryyna2lwq1crp7fwpm5vz"}),getters:{mapStateExists:t=>(e,n)=>t.deckGLMapState.length>0?t.deckGLMapState.some(i=>i._metaData.id===e&&i._metaData.mType==n&&i._metaData.active):!1,isDataReady:t=>(e,n,i)=>{let r=t.deckGLMapState.some(o=>o._metaData.id===e&&o._metaData.mType==n&&o._metaData.active);if(console.log("Map Status: ",r,e,i),r){const o=t.deckGLMapState.find(s=>s._metaData.id===e&&s._metaData.mType==n&&s._metaData.active);r=(o==null?void 0:o._data)[i].isFetched,console.log("Data Status: ",r,o,e,i)}return r}},actions:{findActiveIDX(t,e){let n=-1;try{n=this.deckGLMapState.findIndex(i=>i._metaData.id==t&&i._metaData.mType==e&&i._metaData.active)}catch(i){console.error("Error finding active single fire IDX",i)}return n},deactivateMapState(t,e){let n=this.deckGLMapState.find(i=>i._metaData.mType===t&&i._metaData.id===e&&i._metaData.active);n._metaData.active=!1},updateGLMapState(t,e,n){const i=this.deckGLMapState.findIndex(r=>r._metaData.id===t&&r._metaData.mType==e);if(i===-1)throw Error(`No FireMap found with id: ${t}`);this.deckGLMapState[i]=n},getMapStateComponents(t,e){return[{id:t,name:`${e}-${t}`,mType:e,active:!0},{latitude:38.544907,longitude:-121.740517,zoom:6,pitch:0,bearing:0}]},addDeckMapState(t){this.deckGLMapState=[t,...this.deckGLMapState]},getMapStateByID(t,e){return console.log("Searching for Map ID ",t,"in array ",this.deckGLMapState),this.deckGLMapState.find(n=>n._metaData.id===t&&n._metaData.mType==e)},getLayerList(t,e){return this.deckGLMapState.find(i=>i._metaData.mType==e&&i._metaData.id.includes(t)&&i._metaData.active)._data.layerList},updateLayerListState(t,e,n){let i=this.deckGLMapState.find(r=>r._metaData.mType===n&&r._metaData.id===e&&r._metaData.active);i._data.layerList=t},changeViewState(t,e,n){const i=this.deckGLMapState.findIndex(r=>r._metaData.id===e&&r._metaData.mType==n&&r._metaData.active);i<0||(this.deckGLMapState[i]._viewState.bearing=t.bearing,this.deckGLMapState[i]._viewState.latitude=t.latitude,this.deckGLMapState[i]._viewState.longitude=t.longitude,this.deckGLMapState[i]._viewState.pitch=t.pitch,this.deckGLMapState[i]._viewState.zoom=t.zoom)},changeViewStateIDX(t,e){this.deckGLMapState[t]._viewState.bearing=e.bearing,this.deckGLMapState[t]._viewState.latitude=e.latitude,this.deckGLMapState[t]._viewState.longitude=e.longitude,this.deckGLMapState[t]._viewState.pitch=e.pitch,this.deckGLMapState[t]._viewState.zoom=e.zoom},changeTimeIDX(t,e){this.deckGLMapState[t]._data.currentTime=e},setAnnotationHighlighted(t,e,n,i){let r=this.findActiveIDX(t,e);if(r>=0){let o=this.deckGLMapState[r],l=o._data.annotations.findIndex(s=>s.id==n);l>=0&&(o._data.annotations[l].highlighted=i)}}}}),i3={SATELLITE:"mapbox://styles/mapbox/satellite-v9",DARK:"mapbox://styles/mapbox/dark-v11",LIGHT:"mapbox://styles/mapbox/light-v11",TEST:"mapbox://styles/mapbox/satellite-streets-v12"},_s={latitude:38,longitude:-117,zoom:4,pitch:0,bearing:0};i3.DARK,_s.longitude,_s.latitude,_s.zoom,_s.bearing,_s.pitch;i3.LIGHT,_s.longitude,_s.latitude,_s.zoom,_s.bearing,_s.pitch;const ipe={container:"map-single-fire",width:"100%",style:i3.LIGHT,interactive:!1,center:[_s.longitude,_s.latitude],zoom:_s.zoom,bearing:_s.bearing,pitch:_s.pitch,projection:"mercator"},rpe={canvas:"deck-canvas",width:"100%",height:"100%",controller:!0,initialViewState:_s},ope={marker:{x:128,y:0,width:128,height:128,anchorY:127}};class spe{constructor(e,n){this.mapID=e,this.inverseTimeScale=n}getProps(e){let n={};return e.forEach((i,r)=>{let o="Icons"+r.toString();n={...n,[o]:{id:o,data:[{location:i.location}],iconAtlas:"https://raw.githubusercontent.com/yuya737/assets/main/icon-atlas.png",iconMapping:ope,getPosition:l=>l.location,getSize:l=>10,getIcon:l=>"marker",sizeScale:4,text:i.text,relevantLayers:i.relevantLayers?i.relevantLayers:[],annotationID:i.id,highlighted:i.highlighted?i.highlighted:!1,time:this.inverseTimeScale(new Date(i.timestamp)),pickable:!0}}}),n}}const ape=pr({__name:"InfoPanelDynamicRenderer",props:{schema:{type:Object,required:!0},selectedSchema:{type:String,required:!0}},emits:["settings-changed"],setup(t,{emit:e}){const n=e,i=t,r=o=>{n("settings-changed",o)};return(o,l)=>(le(),Ue("div",null,[(le(!0),Ue(_n,null,or(t.schema,(s,d)=>(le(),Ue("div",{key:d},[(le(),Rt(LB,null,[d==i.selectedSchema?(le(),Rt(Zn(s.type),{key:0,scheme:s,onSettingsChanged:r},null,40,["scheme"])):Jt("",!0)],1024))]))),128))]))}}),lpe={style:{"align-items":"center"}},cpe=pr({__name:"InfoPanelScale",props:{scale:{}},setup(t){const e=t,n=e.scale.colorRange.map(o=>`rgb(${o.join(",")})`),i=(80/e.scale.colorRange.length).toString()+"%",r=(100/e.scale.labels.length).toString()+"%";return(o,l)=>(le(),Ue(_n,null,[Qe("h3",null,ki(e.scale.variable),1),Qe("div",lpe,[(le(!0),Ue(_n,null,or(e.scale.colorRange,(s,d)=>(le(),Ue("div",{key:d,class:"InfoPanelScale-legend",style:tf({"background-color":Yt(n)[d],width:i})},null,4))),128))]),(le(!0),Ue(_n,null,or(e.scale.labels,(s,d)=>(le(),Ue("div",{key:d,class:"InfoPanelScale-labels",style:tf({width:r})},[Qe("div",null,ki(e.scale.labels[d]),1)],4))),128))],64))}});const r3=po(cpe,[["__scopeId","data-v-b5de145a"]]);var P_={name:"CheckIcon",extends:mo},upe=Qe("path",{d:"M4.86199 11.5948C4.78717 11.5923 4.71366 11.5745 4.64596 11.5426C4.57826 11.5107 4.51779 11.4652 4.46827 11.4091L0.753985 7.69483C0.683167 7.64891 0.623706 7.58751 0.580092 7.51525C0.536478 7.44299 0.509851 7.36177 0.502221 7.27771C0.49459 7.19366 0.506156 7.10897 0.536046 7.03004C0.565935 6.95111 0.613367 6.88 0.674759 6.82208C0.736151 6.76416 0.8099 6.72095 0.890436 6.69571C0.970973 6.67046 1.05619 6.66385 1.13966 6.67635C1.22313 6.68886 1.30266 6.72017 1.37226 6.76792C1.44186 6.81567 1.4997 6.8786 1.54141 6.95197L4.86199 10.2503L12.6397 2.49483C12.7444 2.42694 12.8689 2.39617 12.9932 2.40745C13.1174 2.41873 13.2343 2.47141 13.3251 2.55705C13.4159 2.64268 13.4753 2.75632 13.4938 2.87973C13.5123 3.00315 13.4888 3.1292 13.4271 3.23768L5.2557 11.4091C5.20618 11.4652 5.14571 11.5107 5.07801 11.5426C5.01031 11.5745 4.9368 11.5923 4.86199 11.5948Z",fill:"currentColor"},null,-1),hpe=[upe];function dpe(t,e,n,i,r,o){return le(),Ue("svg",Le({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),hpe,16)}P_.render=dpe;var fpe={root:function(e){var n=e.instance,i=e.props;return["p-checkbox p-component",{"p-checkbox-checked":n.checked,"p-checkbox-disabled":i.disabled,"p-checkbox-focused":n.focused}]},input:function(e){var n=e.instance,i=e.props;return["p-checkbox-box",{"p-highlight":n.checked,"p-disabled":i.disabled,"p-focus":n.focused}]},icon:"p-checkbox-icon"},ppe=_o.extend({name:"checkbox",classes:fpe}),mpe={name:"BaseCheckbox",extends:Ni,props:{value:null,modelValue:null,binary:Boolean,name:{type:String,default:null},trueValue:{type:null,default:!0},falseValue:{type:null,default:!1},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},required:{type:Boolean,default:!1},tabindex:{type:Number,default:null},inputId:{type:String,default:null},inputClass:{type:[String,Object],default:null},inputStyle:{type:Object,default:null},inputProps:{type:null,default:null},"aria-labelledby":{type:String,default:null},"aria-label":{type:String,default:null}},style:ppe,provide:function(){return{$parentInstance:this}}};function gpe(t){return bpe(t)||_pe(t)||vpe(t)||ype()}function ype(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vpe(t,e){if(t){if(typeof t=="string")return mP(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mP(t,e)}}function _pe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function bpe(t){if(Array.isArray(t))return mP(t)}function mP(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var o3={name:"Checkbox",extends:mpe,emits:["click","update:modelValue","change","input","focus","blur"],data:function(){return{focused:!1}},methods:{getPTOptions:function(e){return this.ptm(e,{context:{checked:this.checked,focused:this.focused,disabled:this.disabled}})},onClick:function(e){var n=this;if(!this.disabled&&!this.readonly){var i;this.binary?i=this.checked?this.falseValue:this.trueValue:this.checked?i=this.modelValue.filter(function(r){return!At.equals(r,n.value)}):i=this.modelValue?[].concat(gpe(this.modelValue),[this.value]):[this.value],this.$emit("click",e),this.$emit("update:modelValue",i),this.$emit("change",e),this.$emit("input",i),this.$refs.input.focus()}},onFocus:function(e){this.focused=!0,this.$emit("focus",e)},onBlur:function(e){this.focused=!1,this.$emit("blur",e)}},computed:{checked:function(){return this.binary?this.modelValue===this.trueValue:At.contains(this.value,this.modelValue)}},components:{CheckIcon:P_}};function Ev(t){"@babel/helpers - typeof";return Ev=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ev(t)}function p6(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function m6(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?p6(Object(n),!0).forEach(function(i){xpe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p6(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function xpe(t,e,n){return e=wpe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wpe(t){var e=Epe(t,"string");return Ev(e)==="symbol"?e:String(e)}function Epe(t,e){if(Ev(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Ev(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Tpe=["id","value","name","checked","tabindex","disabled","readonly","required","aria-labelledby","aria-label"],Spe=["data-p-highlight","data-p-disabled","data-p-focused"];function Cpe(t,e,n,i,r,o){var l=Gn("CheckIcon");return le(),Ue("div",Le({class:t.cx("root"),onClick:e[2]||(e[2]=function(s){return o.onClick(s)})},o.getPTOptions("root"),{"data-pc-name":"checkbox"}),[Qe("div",Le({class:"p-hidden-accessible"},t.ptm("hiddenInputWrapper"),{"data-p-hidden-accessible":!0}),[Qe("input",Le({ref:"input",id:t.inputId,type:"checkbox",value:t.value,name:t.name,checked:o.checked,tabindex:t.tabindex,disabled:t.disabled,readonly:t.readonly,required:t.required,"aria-labelledby":t.ariaLabelledby,"aria-label":t.ariaLabel,onFocus:e[0]||(e[0]=function(s){return o.onFocus(s)}),onBlur:e[1]||(e[1]=function(s){return o.onBlur(s)})},t.ptm("hiddenInput")),null,16,Tpe)],16),Qe("div",Le({ref:"box",class:[t.cx("input"),t.inputClass],style:t.inputStyle},m6(m6({},t.inputProps),o.getPTOptions("input")),{"data-p-highlight":o.checked,"data-p-disabled":t.disabled,"data-p-focused":r.focused}),[Xn(t.$slots,"icon",{checked:o.checked,class:ri(t.cx("icon"))},function(){return[o.checked?(le(),Rt(l,Le({key:0,class:t.cx("icon")},o.getPTOptions("icon")),null,16,["class"])):Jt("",!0)]})],16,Spe)],16)}o3.render=Cpe;var Ape=`
@layer primevue {
    .p-divider-horizontal {
        display: flex;
        width: 100%;
        position: relative;
        align-items: center;
    }

    .p-divider-horizontal:before {
        position: absolute;
        display: block;
        top: 50%;
        left: 0;
        width: 100%;
        content: '';
    }

    .p-divider-content {
        z-index: 1;
    }

    .p-divider-vertical {
        min-height: 100%;
        margin: 0 1rem;
        display: flex;
        position: relative;
        justify-content: center;
    }

    .p-divider-vertical:before {
        position: absolute;
        display: block;
        top: 0;
        left: 50%;
        height: 100%;
        content: '';
    }

    .p-divider-solid.p-divider-horizontal:before {
        border-top-style: solid;
    }

    .p-divider-solid.p-divider-vertical:before {
        border-left-style: solid;
    }

    .p-divider-dashed.p-divider-horizontal:before {
        border-top-style: dashed;
    }

    .p-divider-dashed.p-divider-vertical:before {
        border-left-style: dashed;
    }

    .p-divider-dotted.p-divider-horizontal:before {
        border-top-style: dotted;
    }

    .p-divider-dotted.p-divider-vertical:before {
        border-left-style: dotted;
    }
}
`,Ppe={root:function(e){var n=e.props;return{justifyContent:n.layout==="horizontal"?n.align==="center"||n.align===null?"center":n.align==="left"?"flex-start":n.align==="right"?"flex-end":null:null,alignItems:n.layout==="vertical"?n.align==="center"||n.align===null?"center":n.align==="top"?"flex-start":n.align==="bottom"?"flex-end":null:null}}},Ipe={root:function(e){var n=e.props;return["p-divider p-component","p-divider-"+n.layout,"p-divider-"+n.type,{"p-divider-left":n.layout==="horizontal"&&(!n.align||n.align==="left")},{"p-divider-center":n.layout==="horizontal"&&n.align==="center"},{"p-divider-right":n.layout==="horizontal"&&n.align==="right"},{"p-divider-top":n.layout==="vertical"&&n.align==="top"},{"p-divider-center":n.layout==="vertical"&&(!n.align||n.align==="center")},{"p-divider-bottom":n.layout==="vertical"&&n.align==="bottom"}]},content:"p-divider-content"},Mpe=_o.extend({name:"divider",css:Ape,classes:Ipe,inlineStyles:Ppe}),Rpe={name:"BaseDivider",extends:Ni,props:{align:{type:String,default:null},layout:{type:String,default:"horizontal"},type:{type:String,default:"solid"}},style:Mpe,provide:function(){return{$parentInstance:this}}},Ch={name:"Divider",extends:Rpe},Lpe=["aria-orientation"];function Ope(t,e,n,i,r,o){return le(),Ue("div",Le({class:t.cx("root"),style:t.sx("root"),role:"separator","aria-orientation":t.layout},t.ptm("root"),{"data-pc-name":"divider"}),[t.$slots.default?(le(),Ue("div",Le({key:0,class:t.cx("content")},t.ptm("content")),[Xn(t.$slots,"default")],16)):Jt("",!0)],16,Lpe)}Ch.render=Ope;const mu=Symbol("mapParams"),ng=Symbol("mapResize"),U2=Symbol("mapMode"),V2=Symbol("contentManager"),Dpe=["id"],kpe=["id"],Fpe={key:0},Bpe=pr({__name:"InfoPanelCheckbox",props:{scheme:{}},emits:["settings-changed"],setup(t,{emit:e}){const n=e,i=$r(mu),r=t,o=r.scheme.scales!==void 0,l=$n([]);r.scheme.options.forEach(d=>{d.default&&l.value.push(d.name)}),console.log(l.value),Ds(()=>{document.getElementById(`title-${i.mapID}`).innerHTML=r.scheme.title,document.getElementById(`body-${i.mapID}`).innerHTML+=r.scheme.info});const s=d=>{let p={};r.scheme.options.forEach(y=>p[y.emitVal]=l.value.includes(y.name)),console.log(l.value),n("settings-changed",p)};return(d,p)=>(le(),Ue(_n,null,[Qe("div",null,[Qe("h1",{id:`title-${Yt(i).mapID}`},null,8,Dpe),Qe("p",{id:`body-${Yt(i).mapID}`},null,8,kpe)]),o?(le(),Ue("div",Fpe,[(le(!0),Ue(_n,null,or(r.scheme.scales,y=>(le(),Ue("div",{key:y.variable,class:"InfoPanel-checkbox-scales"},[Lt(r3,{scale:y},null,8,["scale"])]))),128))])):Jt("",!0),Lt(Yt(Ch)),(le(!0),Ue(_n,null,or(r.scheme.options,y=>(le(),Ue("div",{key:y.name,class:"InfoPanel-checkbox"},[Lt(Yt(o3),{modelValue:l.value,"onUpdate:modelValue":p[0]||(p[0]=v=>l.value=v),value:y.name,onInput:s},null,8,["modelValue","value"]),Qe("label",null,ki(y.name),1)]))),128))],64))}});const zpe=po(Bpe,[["__scopeId","data-v-3f4b69f1"]]);var j2={name:"ChevronDownIcon",extends:mo},Npe=Qe("path",{d:"M7.01744 10.398C6.91269 10.3985 6.8089 10.378 6.71215 10.3379C6.61541 10.2977 6.52766 10.2386 6.45405 10.1641L1.13907 4.84913C1.03306 4.69404 0.985221 4.5065 1.00399 4.31958C1.02276 4.13266 1.10693 3.95838 1.24166 3.82747C1.37639 3.69655 1.55301 3.61742 1.74039 3.60402C1.92777 3.59062 2.11386 3.64382 2.26584 3.75424L7.01744 8.47394L11.769 3.75424C11.9189 3.65709 12.097 3.61306 12.2748 3.62921C12.4527 3.64535 12.6199 3.72073 12.7498 3.84328C12.8797 3.96582 12.9647 4.12842 12.9912 4.30502C13.0177 4.48162 12.9841 4.662 12.8958 4.81724L7.58083 10.1322C7.50996 10.2125 7.42344 10.2775 7.32656 10.3232C7.22968 10.3689 7.12449 10.3944 7.01744 10.398Z",fill:"currentColor"},null,-1),Upe=[Npe];function Vpe(t,e,n,i,r,o){return le(),Ue("svg",Le({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),Upe,16)}j2.render=Vpe;var s3={name:"FilterIcon",extends:mo,computed:{pathId:function(){return"pv_icon_clip_".concat(Gr())}}},jpe=["clipPath"],$pe=Qe("path",{d:"M8.64708 14H5.35296C5.18981 13.9979 5.03395 13.9321 4.91858 13.8167C4.8032 13.7014 4.73745 13.5455 4.73531 13.3824V7L0.329431 0.98C0.259794 0.889466 0.217389 0.780968 0.20718 0.667208C0.19697 0.553448 0.219379 0.439133 0.271783 0.337647C0.324282 0.236453 0.403423 0.151519 0.500663 0.0920138C0.597903 0.0325088 0.709548 0.000692754 0.823548 0H13.1765C13.2905 0.000692754 13.4021 0.0325088 13.4994 0.0920138C13.5966 0.151519 13.6758 0.236453 13.7283 0.337647C13.7807 0.439133 13.8031 0.553448 13.7929 0.667208C13.7826 0.780968 13.7402 0.889466 13.6706 0.98L9.26472 7V13.3824C9.26259 13.5455 9.19683 13.7014 9.08146 13.8167C8.96609 13.9321 8.81022 13.9979 8.64708 14ZM5.97061 12.7647H8.02943V6.79412C8.02878 6.66289 8.07229 6.53527 8.15296 6.43177L11.9412 1.23529H2.05884L5.86355 6.43177C5.94422 6.53527 5.98773 6.66289 5.98708 6.79412L5.97061 12.7647Z",fill:"currentColor"},null,-1),Gpe=[$pe],Hpe=["id"],Wpe=Qe("rect",{width:"14",height:"14",fill:"white"},null,-1),Kpe=[Wpe];function Xpe(t,e,n,i,r,o){return le(),Ue("svg",Le({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),[Qe("g",{clipPath:"url(#".concat(o.pathId,")")},Gpe,8,jpe),Qe("defs",null,[Qe("clipPath",{id:"".concat(o.pathId)},Kpe,8,Hpe)])],16)}s3.render=Xpe;var a3={name:"TimesIcon",extends:mo},Zpe=Qe("path",{d:"M8.01186 7.00933L12.27 2.75116C12.341 2.68501 12.398 2.60524 12.4375 2.51661C12.4769 2.42798 12.4982 2.3323 12.4999 2.23529C12.5016 2.13827 12.4838 2.0419 12.4474 1.95194C12.4111 1.86197 12.357 1.78024 12.2884 1.71163C12.2198 1.64302 12.138 1.58893 12.0481 1.55259C11.9581 1.51625 11.8617 1.4984 11.7647 1.50011C11.6677 1.50182 11.572 1.52306 11.4834 1.56255C11.3948 1.60204 11.315 1.65898 11.2488 1.72997L6.99067 5.98814L2.7325 1.72997C2.59553 1.60234 2.41437 1.53286 2.22718 1.53616C2.03999 1.53946 1.8614 1.61529 1.72901 1.74767C1.59663 1.88006 1.5208 2.05865 1.5175 2.24584C1.5142 2.43303 1.58368 2.61419 1.71131 2.75116L5.96948 7.00933L1.71131 11.2675C1.576 11.403 1.5 11.5866 1.5 11.7781C1.5 11.9696 1.576 12.1532 1.71131 12.2887C1.84679 12.424 2.03043 12.5 2.2219 12.5C2.41338 12.5 2.59702 12.424 2.7325 12.2887L6.99067 8.03052L11.2488 12.2887C11.3843 12.424 11.568 12.5 11.7594 12.5C11.9509 12.5 12.1346 12.424 12.27 12.2887C12.4053 12.1532 12.4813 11.9696 12.4813 11.7781C12.4813 11.5866 12.4053 11.403 12.27 11.2675L8.01186 7.00933Z",fill:"currentColor"},null,-1),qpe=[Zpe];function Ype(t,e,n,i,r,o){return le(),Ue("svg",Le({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),qpe,16)}a3.render=Ype;var _h=nN(),Jpe=`
.p-virtualscroller {
    position: relative;
    overflow: auto;
    contain: strict;
    transform: translateZ(0);
    will-change: scroll-position;
    outline: 0 none;
}

.p-virtualscroller-content {
    position: absolute;
    top: 0;
    left: 0;
    /* contain: content; */
    min-height: 100%;
    min-width: 100%;
    will-change: transform;
}

.p-virtualscroller-spacer {
    position: absolute;
    top: 0;
    left: 0;
    height: 1px;
    width: 1px;
    transform-origin: 0 0;
    pointer-events: none;
}

.p-virtualscroller .p-virtualscroller-loader {
    position: sticky;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

.p-virtualscroller-loader.p-component-overlay {
    display: flex;
    align-items: center;
    justify-content: center;
}

.p-virtualscroller-loading-icon {
    font-size: 2rem;
}

.p-virtualscroller-loading-icon.p-icon {
    width: 2rem;
    height: 2rem;
}

.p-virtualscroller-horizontal > .p-virtualscroller-content {
    display: flex;
}

/* Inline */
.p-virtualscroller-inline .p-virtualscroller-content {
    position: static;
}
`,g6=_o.extend({name:"virtualscroller",css:Jpe}),Qpe={name:"BaseVirtualScroller",extends:Ni,props:{id:{type:String,default:null},style:null,class:null,items:{type:Array,default:null},itemSize:{type:[Number,Array],default:0},scrollHeight:null,scrollWidth:null,orientation:{type:String,default:"vertical"},numToleratedItems:{type:Number,default:null},delay:{type:Number,default:0},resizeDelay:{type:Number,default:10},lazy:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},loaderDisabled:{type:Boolean,default:!1},columns:{type:Array,default:null},loading:{type:Boolean,default:!1},showSpacer:{type:Boolean,default:!0},showLoader:{type:Boolean,default:!1},tabindex:{type:Number,default:0},inline:{type:Boolean,default:!1},step:{type:Number,default:0},appendOnly:{type:Boolean,default:!1},autoSize:{type:Boolean,default:!1}},style:g6,provide:function(){return{$parentInstance:this}},beforeMount:function(){g6.loadStyle()}};function Tv(t){"@babel/helpers - typeof";return Tv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tv(t)}function y6(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Fy(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?y6(Object(n),!0).forEach(function(i){q7(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y6(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function q7(t,e,n){return e=eme(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eme(t){var e=tme(t,"string");return Tv(e)==="symbol"?e:String(e)}function tme(t,e){if(Tv(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Tv(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var l3={name:"VirtualScroller",extends:Qpe,emits:["update:numToleratedItems","scroll","scroll-index-change","lazy-load"],data:function(){return{first:this.isBoth()?{rows:0,cols:0}:0,last:this.isBoth()?{rows:0,cols:0}:0,page:this.isBoth()?{rows:0,cols:0}:0,numItemsInViewport:this.isBoth()?{rows:0,cols:0}:0,lastScrollPos:this.isBoth()?{top:0,left:0}:0,d_numToleratedItems:this.numToleratedItems,d_loading:this.loading,loaderArr:[],spacerStyle:{},contentStyle:{}}},element:null,content:null,lastScrollPos:null,scrollTimeout:null,resizeTimeout:null,defaultWidth:0,defaultHeight:0,defaultContentWidth:0,defaultContentHeight:0,isRangeChanged:!1,lazyLoadState:{},resizeListener:null,initialized:!1,watch:{numToleratedItems:function(e){this.d_numToleratedItems=e},loading:function(e){this.d_loading=e},items:function(e,n){(!n||n.length!==(e||[]).length)&&(this.init(),this.calculateAutoSize())},itemSize:function(){this.init(),this.calculateAutoSize()},orientation:function(){this.lastScrollPos=this.isBoth()?{top:0,left:0}:0},scrollHeight:function(){this.init(),this.calculateAutoSize()},scrollWidth:function(){this.init(),this.calculateAutoSize()}},mounted:function(){this.viewInit(),this.lastScrollPos=this.isBoth()?{top:0,left:0}:0,this.lazyLoadState=this.lazyLoadState||{}},updated:function(){!this.initialized&&this.viewInit()},unmounted:function(){this.unbindResizeListener(),this.initialized=!1},methods:{viewInit:function(){He.isVisible(this.element)&&(this.setContentEl(this.content),this.init(),this.bindResizeListener(),this.defaultWidth=He.getWidth(this.element),this.defaultHeight=He.getHeight(this.element),this.defaultContentWidth=He.getWidth(this.content),this.defaultContentHeight=He.getHeight(this.content),this.initialized=!0)},init:function(){this.disabled||(this.setSize(),this.calculateOptions(),this.setSpacerSize())},isVertical:function(){return this.orientation==="vertical"},isHorizontal:function(){return this.orientation==="horizontal"},isBoth:function(){return this.orientation==="both"},scrollTo:function(e){this.lastScrollPos=this.both?{top:0,left:0}:0,this.element&&this.element.scrollTo(e)},scrollToIndex:function(e){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto",r=this.isBoth(),o=this.isHorizontal(),l=this.first,s=this.calculateNumItems(),d=s.numToleratedItems,p=this.getContentPosition(),y=this.itemSize,v=function(){var F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,B=arguments.length>1?arguments[1]:void 0;return F<=B?0:F},w=function(F,B,G){return F*B+G},T=function(){var F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return n.scrollTo({left:F,top:B,behavior:i})},I=r?{rows:0,cols:0}:0,L=!1;r?(I={rows:v(e[0],d[0]),cols:v(e[1],d[1])},T(w(I.cols,y[1],p.left),w(I.rows,y[0],p.top)),L=I.rows!==l.rows||I.cols!==l.cols):(I=v(e,d),o?T(w(I,y,p.left),0):T(0,w(I,y,p.top)),L=I!==l),this.isRangeChanged=L,this.first=I},scrollInView:function(e,n){var i=this,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"auto";if(n){var o=this.isBoth(),l=this.isHorizontal(),s=this.getRenderedRange(),d=s.first,p=s.viewport,y=function(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return i.scrollTo({left:k,top:F,behavior:r})},v=n==="to-start",w=n==="to-end";if(v){if(o)p.first.rows-d.rows>e[0]?y(p.first.cols*this.itemSize[1],(p.first.rows-1)*this.itemSize[0]):p.first.cols-d.cols>e[1]&&y((p.first.cols-1)*this.itemSize[1],p.first.rows*this.itemSize[0]);else if(p.first-d>e){var T=(p.first-1)*this.itemSize;l?y(T,0):y(0,T)}}else if(w){if(o)p.last.rows-d.rows<=e[0]+1?y(p.first.cols*this.itemSize[1],(p.first.rows+1)*this.itemSize[0]):p.last.cols-d.cols<=e[1]+1&&y((p.first.cols+1)*this.itemSize[1],p.first.rows*this.itemSize[0]);else if(p.last-d<=e+1){var I=(p.first+1)*this.itemSize;l?y(I,0):y(0,I)}}}else this.scrollToIndex(e,r)},getRenderedRange:function(){var e=function(v,w){return Math.floor(v/(w||v))},n=this.first,i=0;if(this.element){var r=this.isBoth(),o=this.isHorizontal(),l=this.element.scrollTop,s=l.scrollTop,d=l.scrollLeft;if(r)n={rows:e(s,this.itemSize[0]),cols:e(d,this.itemSize[1])},i={rows:n.rows+this.numItemsInViewport.rows,cols:n.cols+this.numItemsInViewport.cols};else{var p=o?d:s;n=e(p,this.itemSize),i=n+this.numItemsInViewport}}return{first:this.first,last:this.last,viewport:{first:n,last:i}}},calculateNumItems:function(){var e=this.isBoth(),n=this.isHorizontal(),i=this.itemSize,r=this.getContentPosition(),o=this.element?this.element.offsetWidth-r.left:0,l=this.element?this.element.offsetHeight-r.top:0,s=function(w,T){return Math.ceil(w/(T||w))},d=function(w){return Math.ceil(w/2)},p=e?{rows:s(l,i[0]),cols:s(o,i[1])}:s(n?o:l,i),y=this.d_numToleratedItems||(e?[d(p.rows),d(p.cols)]:d(p));return{numItemsInViewport:p,numToleratedItems:y}},calculateOptions:function(){var e=this,n=this.isBoth(),i=this.first,r=this.calculateNumItems(),o=r.numItemsInViewport,l=r.numToleratedItems,s=function(y,v,w){var T=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return e.getLast(y+v+(y<w?2:3)*w,T)},d=n?{rows:s(i.rows,o.rows,l[0]),cols:s(i.cols,o.cols,l[1],!0)}:s(i,o,l);this.last=d,this.numItemsInViewport=o,this.d_numToleratedItems=l,this.$emit("update:numToleratedItems",this.d_numToleratedItems),this.showLoader&&(this.loaderArr=n?Array.from({length:o.rows}).map(function(){return Array.from({length:o.cols})}):Array.from({length:o})),this.lazy&&Promise.resolve().then(function(){e.lazyLoadState={first:e.step?n?{rows:0,cols:i.cols}:0:i,last:Math.min(e.step?e.step:d,e.items.length)},e.$emit("lazy-load",e.lazyLoadState)})},calculateAutoSize:function(){var e=this;this.autoSize&&!this.d_loading&&Promise.resolve().then(function(){if(e.content){var n=e.isBoth(),i=e.isHorizontal(),r=e.isVertical();e.content.style.minHeight=e.content.style.minWidth="auto",e.content.style.position="relative",e.element.style.contain="none";var o=[He.getWidth(e.content),He.getHeight(e.content)],l=o[0],s=o[1];l!==e.defaultContentWidth&&(e.element.style.width=""),s!==e.defaultContentHeight&&(e.element.style.height="");var d=[He.getWidth(e.element),He.getHeight(e.element)],p=d[0],y=d[1];(n||i)&&(e.element.style.width=p<e.defaultWidth?p+"px":e.scrollWidth||e.defaultWidth+"px"),(n||r)&&(e.element.style.height=y<e.defaultHeight?y+"px":e.scrollHeight||e.defaultHeight+"px"),e.content.style.minHeight=e.content.style.minWidth="",e.content.style.position="",e.element.style.contain=""}})},getLast:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1?arguments[1]:void 0;return this.items?Math.min(n?(this.columns||this.items[0]).length:this.items.length,e):0},getContentPosition:function(){if(this.content){var e=getComputedStyle(this.content),n=parseFloat(e.paddingLeft)+Math.max(parseFloat(e.left)||0,0),i=parseFloat(e.paddingRight)+Math.max(parseFloat(e.right)||0,0),r=parseFloat(e.paddingTop)+Math.max(parseFloat(e.top)||0,0),o=parseFloat(e.paddingBottom)+Math.max(parseFloat(e.bottom)||0,0);return{left:n,right:i,top:r,bottom:o,x:n+i,y:r+o}}return{left:0,right:0,top:0,bottom:0,x:0,y:0}},setSize:function(){var e=this;if(this.element){var n=this.isBoth(),i=this.isHorizontal(),r=this.element.parentElement,o=this.scrollWidth||"".concat(this.element.offsetWidth||r.offsetWidth,"px"),l=this.scrollHeight||"".concat(this.element.offsetHeight||r.offsetHeight,"px"),s=function(p,y){return e.element.style[p]=y};n||i?(s("height",l),s("width",o)):s("height",l)}},setSpacerSize:function(){var e=this,n=this.items;if(n){var i=this.isBoth(),r=this.isHorizontal(),o=this.getContentPosition(),l=function(d,p,y){var v=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return e.spacerStyle=Fy(Fy({},e.spacerStyle),q7({},"".concat(d),(p||[]).length*y+v+"px"))};i?(l("height",n,this.itemSize[0],o.y),l("width",this.columns||n[1],this.itemSize[1],o.x)):r?l("width",this.columns||n,this.itemSize,o.x):l("height",n,this.itemSize,o.y)}},setContentPosition:function(e){var n=this;if(this.content&&!this.appendOnly){var i=this.isBoth(),r=this.isHorizontal(),o=e?e.first:this.first,l=function(y,v){return y*v},s=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return n.contentStyle=Fy(Fy({},n.contentStyle),{transform:"translate3d(".concat(y,"px, ").concat(v,"px, 0)")})};if(i)s(l(o.cols,this.itemSize[1]),l(o.rows,this.itemSize[0]));else{var d=l(o,this.itemSize);r?s(d,0):s(0,d)}}},onScrollPositionChange:function(e){var n=this,i=e.target,r=this.isBoth(),o=this.isHorizontal(),l=this.getContentPosition(),s=function(me,be){return me?me>be?me-be:me:0},d=function(me,be){return Math.floor(me/(be||me))},p=function(me,be,Te,ke,ut,et){return me<=ut?ut:et?Te-ke-ut:be+ut-1},y=function(me,be,Te,ke,ut,et,Et){return me<=et?0:Math.max(0,Et?me<be?Te:me-et:me>be?Te:me-2*et)},v=function(me,be,Te,ke,ut,et){var Et=be+ke+2*ut;return me>=ut&&(Et+=ut+1),n.getLast(Et,et)},w=s(i.scrollTop,l.top),T=s(i.scrollLeft,l.left),I=r?{rows:0,cols:0}:0,L=this.last,k=!1,F=this.lastScrollPos;if(r){var B=this.lastScrollPos.top<=w,G=this.lastScrollPos.left<=T;if(!this.appendOnly||this.appendOnly&&(B||G)){var U={rows:d(w,this.itemSize[0]),cols:d(T,this.itemSize[1])},ee={rows:p(U.rows,this.first.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0],B),cols:p(U.cols,this.first.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],G)};I={rows:y(U.rows,ee.rows,this.first.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0],B),cols:y(U.cols,ee.cols,this.first.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],G)},L={rows:v(U.rows,I.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0]),cols:v(U.cols,I.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],!0)},k=I.rows!==this.first.rows||L.rows!==this.last.rows||I.cols!==this.first.cols||L.cols!==this.last.cols||this.isRangeChanged,F={top:w,left:T}}}else{var ne=o?T:w,ye=this.lastScrollPos<=ne;if(!this.appendOnly||this.appendOnly&&ye){var fe=d(ne,this.itemSize),J=p(fe,this.first,this.last,this.numItemsInViewport,this.d_numToleratedItems,ye);I=y(fe,J,this.first,this.last,this.numItemsInViewport,this.d_numToleratedItems,ye),L=v(fe,I,this.last,this.numItemsInViewport,this.d_numToleratedItems),k=I!==this.first||L!==this.last||this.isRangeChanged,F=ne}}return{first:I,last:L,isRangeChanged:k,scrollPos:F}},onScrollChange:function(e){var n=this.onScrollPositionChange(e),i=n.first,r=n.last,o=n.isRangeChanged,l=n.scrollPos;if(o){var s={first:i,last:r};if(this.setContentPosition(s),this.first=i,this.last=r,this.lastScrollPos=l,this.$emit("scroll-index-change",s),this.lazy&&this.isPageChanged(i)){var d={first:this.step?Math.min(this.getPageByFirst(i)*this.step,this.items.length-this.step):i,last:Math.min(this.step?(this.getPageByFirst(i)+1)*this.step:r,this.items.length)},p=this.lazyLoadState.first!==d.first||this.lazyLoadState.last!==d.last;p&&this.$emit("lazy-load",d),this.lazyLoadState=d}}},onScroll:function(e){var n=this;if(this.$emit("scroll",e),this.delay&&this.isPageChanged()){if(this.scrollTimeout&&clearTimeout(this.scrollTimeout),!this.d_loading&&this.showLoader){var i=this.onScrollPositionChange(e),r=i.isRangeChanged,o=r||(this.step?this.isPageChanged():!1);o&&(this.d_loading=!0)}this.scrollTimeout=setTimeout(function(){n.onScrollChange(e),n.d_loading&&n.showLoader&&(!n.lazy||n.loading===void 0)&&(n.d_loading=!1,n.page=n.getPageByFirst())},this.delay)}else this.onScrollChange(e)},onResize:function(){var e=this;this.resizeTimeout&&clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){if(He.isVisible(e.element)){var n=e.isBoth(),i=e.isVertical(),r=e.isHorizontal(),o=[He.getWidth(e.element),He.getHeight(e.element)],l=o[0],s=o[1],d=l!==e.defaultWidth,p=s!==e.defaultHeight,y=n?d||p:r?d:i?p:!1;y&&(e.d_numToleratedItems=e.numToleratedItems,e.defaultWidth=l,e.defaultHeight=s,e.defaultContentWidth=He.getWidth(e.content),e.defaultContentHeight=He.getHeight(e.content),e.init())}},this.resizeDelay)},bindResizeListener:function(){this.resizeListener||(this.resizeListener=this.onResize.bind(this),window.addEventListener("resize",this.resizeListener),window.addEventListener("orientationchange",this.resizeListener))},unbindResizeListener:function(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),window.removeEventListener("orientationchange",this.resizeListener),this.resizeListener=null)},getOptions:function(e){var n=(this.items||[]).length,i=this.isBoth()?this.first.rows+e:this.first+e;return{index:i,count:n,first:i===0,last:i===n-1,even:i%2===0,odd:i%2!==0}},getLoaderOptions:function(e,n){var i=this.loaderArr.length;return Fy({index:e,count:i,first:e===0,last:e===i-1,even:e%2===0,odd:e%2!==0},n)},getPageByFirst:function(e){return Math.floor(((e??this.first)+this.d_numToleratedItems*4)/(this.step||1))},isPageChanged:function(e){return this.step?this.page!==this.getPageByFirst(e??this.first):!0},setContentEl:function(e){this.content=e||this.content||He.findSingle(this.element,'[data-pc-section="content"]')},elementRef:function(e){this.element=e},contentRef:function(e){this.content=e}},computed:{containerClass:function(){return["p-virtualscroller",this.class,{"p-virtualscroller-inline":this.inline,"p-virtualscroller-both p-both-scroll":this.isBoth(),"p-virtualscroller-horizontal p-horizontal-scroll":this.isHorizontal()}]},contentClass:function(){return["p-virtualscroller-content",{"p-virtualscroller-loading":this.d_loading}]},loaderClass:function(){return["p-virtualscroller-loader",{"p-component-overlay":!this.$slots.loader}]},loadedItems:function(){var e=this;return this.items&&!this.d_loading?this.isBoth()?this.items.slice(this.appendOnly?0:this.first.rows,this.last.rows).map(function(n){return e.columns?n:n.slice(e.appendOnly?0:e.first.cols,e.last.cols)}):this.isHorizontal()&&this.columns?this.items:this.items.slice(this.appendOnly?0:this.first,this.last):[]},loadedRows:function(){return this.d_loading?this.loaderDisabled?this.loaderArr:[]:this.loadedItems},loadedColumns:function(){if(this.columns){var e=this.isBoth(),n=this.isHorizontal();if(e||n)return this.d_loading&&this.loaderDisabled?e?this.loaderArr[0]:this.loaderArr:this.columns.slice(e?this.first.cols:this.first,e?this.last.cols:this.last)}return this.columns}},components:{SpinnerIcon:A_}},nme=["tabindex"];function ime(t,e,n,i,r,o){var l=Gn("SpinnerIcon");return t.disabled?(le(),Ue(_n,{key:1},[Xn(t.$slots,"default"),Xn(t.$slots,"content",{items:t.items,rows:t.items,columns:o.loadedColumns})],64)):(le(),Ue("div",Le({key:0,ref:o.elementRef,class:o.containerClass,tabindex:t.tabindex,style:t.style,onScroll:e[0]||(e[0]=function(){return o.onScroll&&o.onScroll.apply(o,arguments)})},t.ptm("root"),{"data-pc-name":"virtualscroller"}),[Xn(t.$slots,"content",{styleClass:o.contentClass,items:o.loadedItems,getItemOptions:o.getOptions,loading:r.d_loading,getLoaderOptions:o.getLoaderOptions,itemSize:t.itemSize,rows:o.loadedRows,columns:o.loadedColumns,contentRef:o.contentRef,spacerStyle:r.spacerStyle,contentStyle:r.contentStyle,vertical:o.isVertical(),horizontal:o.isHorizontal(),both:o.isBoth()},function(){return[Qe("div",Le({ref:o.contentRef,class:o.contentClass,style:r.contentStyle},t.ptm("content")),[(le(!0),Ue(_n,null,or(o.loadedItems,function(s,d){return Xn(t.$slots,"item",{key:d,item:s,options:o.getOptions(d)})}),128))],16)]}),t.showSpacer?(le(),Ue("div",Le({key:0,class:"p-virtualscroller-spacer",style:r.spacerStyle},t.ptm("spacer")),null,16)):Jt("",!0),!t.loaderDisabled&&t.showLoader&&r.d_loading?(le(),Ue("div",Le({key:1,class:o.loaderClass},t.ptm("loader")),[t.$slots&&t.$slots.loader?(le(!0),Ue(_n,{key:0},or(r.loaderArr,function(s,d){return Xn(t.$slots,"loader",{key:d,options:o.getLoaderOptions(d,o.isBoth()&&{numCols:t.d_numItemsInViewport.cols})})}),128)):Jt("",!0),Xn(t.$slots,"loadingicon",{},function(){return[Lt(l,Le({spin:"",class:"p-virtualscroller-loading-icon"},t.ptm("loadingIcon")),null,16)]})],16)):Jt("",!0)],16,nme))}l3.render=ime;var rme=`
@layer primevue {
    .p-dropdown {
        display: inline-flex;
        cursor: pointer;
        position: relative;
        user-select: none;
    }

    .p-dropdown-clear-icon {
        position: absolute;
        top: 50%;
        margin-top: -0.5rem;
    }

    .p-dropdown-trigger {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
    }

    .p-dropdown-label {
        display: block;
        white-space: nowrap;
        overflow: hidden;
        flex: 1 1 auto;
        width: 1%;
        text-overflow: ellipsis;
        cursor: pointer;
    }

    .p-dropdown-label-empty {
        overflow: hidden;
        opacity: 0;
    }

    input.p-dropdown-label {
        cursor: default;
    }

    .p-dropdown .p-dropdown-panel {
        min-width: 100%;
    }

    .p-dropdown-panel {
        position: absolute;
        top: 0;
        left: 0;
    }

    .p-dropdown-items-wrapper {
        overflow: auto;
    }

    .p-dropdown-item {
        cursor: pointer;
        font-weight: normal;
        white-space: nowrap;
        position: relative;
        overflow: hidden;
    }

    .p-dropdown-item-group {
        cursor: auto;
    }

    .p-dropdown-items {
        margin: 0;
        padding: 0;
        list-style-type: none;
    }

    .p-dropdown-filter {
        width: 100%;
    }

    .p-dropdown-filter-container {
        position: relative;
    }

    .p-dropdown-filter-icon {
        position: absolute;
        top: 50%;
        margin-top: -0.5rem;
    }

    .p-fluid .p-dropdown {
        display: flex;
    }

    .p-fluid .p-dropdown .p-dropdown-label {
        width: 1%;
    }
}
`,ome={root:function(e){var n=e.instance,i=e.props,r=e.state;return["p-dropdown p-component p-inputwrapper",{"p-disabled":i.disabled,"p-dropdown-clearable":i.showClear&&!i.disabled,"p-focus":r.focused,"p-inputwrapper-filled":n.hasSelectedOption,"p-inputwrapper-focus":r.focused||r.overlayVisible,"p-overlay-open":r.overlayVisible}]},input:function(e){var n=e.instance,i=e.props;return["p-dropdown-label p-inputtext",{"p-placeholder":!i.editable&&n.label===i.placeholder,"p-dropdown-label-empty":!i.editable&&!n.$slots.value&&(n.label==="p-emptylabel"||n.label.length===0)}]},clearIcon:"p-dropdown-clear-icon",trigger:"p-dropdown-trigger",loadingicon:"p-dropdown-trigger-icon",dropdownIcon:"p-dropdown-trigger-icon",panel:function(e){var n=e.instance;return["p-dropdown-panel p-component",{"p-input-filled":n.$primevue.config.inputStyle==="filled","p-ripple-disabled":n.$primevue.config.ripple===!1}]},header:"p-dropdown-header",filterContainer:"p-dropdown-filter-container",filterInput:"p-dropdown-filter p-inputtext p-component",filterIcon:"p-dropdown-filter-icon",wrapper:"p-dropdown-items-wrapper",list:"p-dropdown-items",itemGroup:"p-dropdown-item-group",item:function(e){var n=e.instance,i=e.state,r=e.option,o=e.focusedOption;return["p-dropdown-item",{"p-highlight":n.isSelected(r),"p-focus":i.focusedOptionIndex===o,"p-disabled":n.isOptionDisabled(r)}]},emptyMessage:"p-dropdown-empty-message"},sme=_o.extend({name:"dropdown",css:rme,classes:ome}),ame={name:"BaseDropdown",extends:Ni,props:{modelValue:null,options:Array,optionLabel:[String,Function],optionValue:[String,Function],optionDisabled:[String,Function],optionGroupLabel:[String,Function],optionGroupChildren:[String,Function],scrollHeight:{type:String,default:"200px"},filter:Boolean,filterPlaceholder:String,filterLocale:String,filterMatchMode:{type:String,default:"contains"},filterFields:{type:Array,default:null},editable:Boolean,placeholder:{type:String,default:null},disabled:{type:Boolean,default:!1},dataKey:null,showClear:{type:Boolean,default:!1},inputId:{type:String,default:null},inputClass:{type:[String,Object],default:null},inputStyle:{type:Object,default:null},inputProps:{type:null,default:null},panelClass:{type:[String,Object],default:null},panelStyle:{type:Object,default:null},panelProps:{type:null,default:null},filterInputProps:{type:null,default:null},clearIconProps:{type:null,default:null},appendTo:{type:String,default:"body"},loading:{type:Boolean,default:!1},clearIcon:{type:String,default:void 0},dropdownIcon:{type:String,default:void 0},filterIcon:{type:String,default:void 0},loadingIcon:{type:String,default:void 0},resetFilterOnHide:{type:Boolean,default:!1},virtualScrollerOptions:{type:Object,default:null},autoOptionFocus:{type:Boolean,default:!0},autoFilterFocus:{type:Boolean,default:!1},selectOnFocus:{type:Boolean,default:!1},filterMessage:{type:String,default:null},selectionMessage:{type:String,default:null},emptySelectionMessage:{type:String,default:null},emptyFilterMessage:{type:String,default:null},emptyMessage:{type:String,default:null},tabindex:{type:Number,default:0},"aria-label":{type:String,default:null},"aria-labelledby":{type:String,default:null}},style:sme,provide:function(){return{$parentInstance:this}}};function Sv(t){"@babel/helpers - typeof";return Sv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sv(t)}function lme(t){return dme(t)||hme(t)||ume(t)||cme()}function cme(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ume(t,e){if(t){if(typeof t=="string")return gP(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gP(t,e)}}function hme(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function dme(t){if(Array.isArray(t))return gP(t)}function gP(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function v6(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function _6(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?v6(Object(n),!0).forEach(function(i){Y7(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v6(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Y7(t,e,n){return e=fme(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fme(t){var e=pme(t,"string");return Sv(e)==="symbol"?e:String(e)}function pme(t,e){if(Sv(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Sv(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ig={name:"Dropdown",extends:ame,emits:["update:modelValue","change","focus","blur","before-show","before-hide","show","hide","filter"],outsideClickListener:null,scrollHandler:null,resizeListener:null,overlay:null,list:null,virtualScroller:null,searchTimeout:null,searchValue:null,isModelValueChanged:!1,focusOnHover:!1,data:function(){return{id:this.$attrs.id,focused:!1,focusedOptionIndex:-1,filterValue:null,overlayVisible:!1}},watch:{"$attrs.id":function(e){this.id=e||Gr()},modelValue:function(){this.isModelValueChanged=!0},options:function(){this.autoUpdateModel()}},mounted:function(){this.id=this.id||Gr(),this.autoUpdateModel()},updated:function(){this.overlayVisible&&this.isModelValueChanged&&this.scrollInView(this.findSelectedOptionIndex()),this.isModelValueChanged=!1},beforeUnmount:function(){this.unbindOutsideClickListener(),this.unbindResizeListener(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.overlay&&(Sl.clear(this.overlay),this.overlay=null)},methods:{getOptionIndex:function(e,n){return this.virtualScrollerDisabled?e:n&&n(e).index},getOptionLabel:function(e){return this.optionLabel?At.resolveFieldData(e,this.optionLabel):e},getOptionValue:function(e){return this.optionValue?At.resolveFieldData(e,this.optionValue):e},getOptionRenderKey:function(e,n){return(this.dataKey?At.resolveFieldData(e,this.dataKey):this.getOptionLabel(e))+"_"+n},getPTOptions:function(e,n,i,r){return this.ptm(r,{context:{selected:this.isSelected(e),focused:this.focusedOptionIndex===this.getOptionIndex(i,n),disabled:this.isOptionDisabled(e)}})},isOptionDisabled:function(e){return this.optionDisabled?At.resolveFieldData(e,this.optionDisabled):!1},isOptionGroup:function(e){return this.optionGroupLabel&&e.optionGroup&&e.group},getOptionGroupLabel:function(e){return At.resolveFieldData(e,this.optionGroupLabel)},getOptionGroupChildren:function(e){return At.resolveFieldData(e,this.optionGroupChildren)},getAriaPosInset:function(e){var n=this;return(this.optionGroupLabel?e-this.visibleOptions.slice(0,e).filter(function(i){return n.isOptionGroup(i)}).length:e)+1},show:function(e){this.$emit("before-show"),this.overlayVisible=!0,this.focusedOptionIndex=this.focusedOptionIndex!==-1?this.focusedOptionIndex:this.autoOptionFocus?this.findFirstFocusedOptionIndex():-1,e&&He.focus(this.$refs.focusInput)},hide:function(e){var n=this,i=function(){n.$emit("before-hide"),n.overlayVisible=!1,n.focusedOptionIndex=-1,n.searchValue="",n.resetFilterOnHide&&(n.filterValue=null),e&&He.focus(n.$refs.focusInput)};setTimeout(function(){i()},0)},onFocus:function(e){this.disabled||(this.focused=!0,this.focusedOptionIndex=this.focusedOptionIndex!==-1?this.focusedOptionIndex:this.overlayVisible&&this.autoOptionFocus?this.findFirstFocusedOptionIndex():-1,this.overlayVisible&&this.scrollInView(this.focusedOptionIndex),this.$emit("focus",e))},onBlur:function(e){this.focused=!1,this.focusedOptionIndex=-1,this.searchValue="",this.$emit("blur",e)},onKeyDown:function(e){if(this.disabled){e.preventDefault();return}var n=e.metaKey||e.ctrlKey;switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e,this.editable);break;case"ArrowLeft":case"ArrowRight":this.onArrowLeftKey(e,this.editable);break;case"Delete":this.onDeleteKey(e);case"Home":this.onHomeKey(e,this.editable);break;case"End":this.onEndKey(e,this.editable);break;case"PageDown":this.onPageDownKey(e);break;case"PageUp":this.onPageUpKey(e);break;case"Space":this.onSpaceKey(e,this.editable);break;case"Enter":case"NumpadEnter":this.onEnterKey(e);break;case"Escape":this.onEscapeKey(e);break;case"Tab":this.onTabKey(e);break;case"Backspace":this.onBackspaceKey(e,this.editable);break;case"ShiftLeft":case"ShiftRight":break;default:!n&&At.isPrintableCharacter(e.key)&&(!this.overlayVisible&&this.show(),!this.editable&&this.searchOptions(e,e.key));break}},onEditableInput:function(e){var n=e.target.value;this.searchValue="";var i=this.searchOptions(e,n);!i&&(this.focusedOptionIndex=-1),this.updateModel(e,n)},onContainerClick:function(e){this.disabled||this.loading||e.target.tagName==="INPUT"||e.target.getAttribute("data-pc-section")==="clearicon"||e.target.closest('[data-pc-section="clearicon"]')||(!this.overlay||!this.overlay.contains(e.target))&&(this.overlayVisible?this.hide(!0):this.show(!0))},onClearClick:function(e){this.updateModel(e,null)},onFirstHiddenFocus:function(e){var n=e.relatedTarget===this.$refs.focusInput?He.getFirstFocusableElement(this.overlay,':not([data-p-hidden-focusable="true"])'):this.$refs.focusInput;He.focus(n)},onLastHiddenFocus:function(e){var n=e.relatedTarget===this.$refs.focusInput?He.getLastFocusableElement(this.overlay,':not([data-p-hidden-focusable="true"])'):this.$refs.focusInput;He.focus(n)},onOptionSelect:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=this.getOptionValue(n);this.updateModel(e,r),i&&this.hide(!0)},onOptionMouseMove:function(e,n){this.focusOnHover&&this.changeFocusedOptionIndex(e,n)},onFilterChange:function(e){var n=e.target.value;this.filterValue=n,this.focusedOptionIndex=-1,this.$emit("filter",{originalEvent:e,value:n}),!this.virtualScrollerDisabled&&this.virtualScroller.scrollToIndex(0)},onFilterKeyDown:function(e){switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e,!0);break;case"ArrowLeft":case"ArrowRight":this.onArrowLeftKey(e,!0);break;case"Home":this.onHomeKey(e,!0);break;case"End":this.onEndKey(e,!0);break;case"Enter":this.onEnterKey(e);break;case"Escape":this.onEscapeKey(e);break;case"Tab":this.onTabKey(e,!0);break}},onFilterBlur:function(){this.focusedOptionIndex=-1},onFilterUpdated:function(){this.overlayVisible&&this.alignOverlay()},onOverlayClick:function(e){_h.emit("overlay-click",{originalEvent:e,target:this.$el})},onOverlayKeyDown:function(e){switch(e.code){case"Escape":this.onEscapeKey(e);break}},onDeleteKey:function(e){this.showClear&&(this.updateModel(e,null),e.preventDefault())},onArrowDownKey:function(e){var n=this.focusedOptionIndex!==-1?this.findNextOptionIndex(this.focusedOptionIndex):this.findFirstFocusedOptionIndex();this.changeFocusedOptionIndex(e,n),!this.overlayVisible&&this.show(),e.preventDefault()},onArrowUpKey:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e.altKey&&!n)this.focusedOptionIndex!==-1&&this.onOptionSelect(e,this.visibleOptions[this.focusedOptionIndex]),this.overlayVisible&&this.hide(),e.preventDefault();else{var i=this.focusedOptionIndex!==-1?this.findPrevOptionIndex(this.focusedOptionIndex):this.findLastFocusedOptionIndex();this.changeFocusedOptionIndex(e,i),!this.overlayVisible&&this.show(),e.preventDefault()}},onArrowLeftKey:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n&&(this.focusedOptionIndex=-1)},onHomeKey:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n?(e.currentTarget.setSelectionRange(0,0),this.focusedOptionIndex=-1):(this.changeFocusedOptionIndex(e,this.findFirstOptionIndex()),!this.overlayVisible&&this.show()),e.preventDefault()},onEndKey:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(n){var i=e.currentTarget,r=i.value.length;i.setSelectionRange(r,r),this.focusedOptionIndex=-1}else this.changeFocusedOptionIndex(e,this.findLastOptionIndex()),!this.overlayVisible&&this.show();e.preventDefault()},onPageUpKey:function(e){this.scrollInView(0),e.preventDefault()},onPageDownKey:function(e){this.scrollInView(this.visibleOptions.length-1),e.preventDefault()},onEnterKey:function(e){this.overlayVisible?(this.focusedOptionIndex!==-1&&this.onOptionSelect(e,this.visibleOptions[this.focusedOptionIndex]),this.hide()):this.onArrowDownKey(e),e.preventDefault()},onSpaceKey:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;!n&&this.onEnterKey(e)},onEscapeKey:function(e){this.overlayVisible&&this.hide(!0),e.preventDefault()},onTabKey:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n||(this.overlayVisible&&this.hasFocusableElements()?(He.focus(this.$refs.firstHiddenFocusableElementOnOverlay),e.preventDefault()):(this.focusedOptionIndex!==-1&&this.onOptionSelect(e,this.visibleOptions[this.focusedOptionIndex]),this.overlayVisible&&this.hide(this.filter)))},onBackspaceKey:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n&&!this.overlayVisible&&this.show()},onOverlayEnter:function(e){Sl.set("overlay",e,this.$primevue.config.zIndex.overlay),He.addStyles(e,{position:"absolute",top:"0",left:"0"}),this.alignOverlay(),this.scrollInView(),this.autoFilterFocus&&He.focus(this.$refs.filterInput)},onOverlayAfterEnter:function(){this.bindOutsideClickListener(),this.bindScrollListener(),this.bindResizeListener(),this.$emit("show")},onOverlayLeave:function(){this.unbindOutsideClickListener(),this.unbindScrollListener(),this.unbindResizeListener(),this.$emit("hide"),this.overlay=null},onOverlayAfterLeave:function(e){Sl.clear(e)},alignOverlay:function(){this.appendTo==="self"?He.relativePosition(this.overlay,this.$el):(this.overlay.style.minWidth=He.getOuterWidth(this.$el)+"px",He.absolutePosition(this.overlay,this.$el))},bindOutsideClickListener:function(){var e=this;this.outsideClickListener||(this.outsideClickListener=function(n){e.overlayVisible&&e.overlay&&!e.$el.contains(n.target)&&!e.overlay.contains(n.target)&&e.hide()},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener:function(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)},bindScrollListener:function(){var e=this;this.scrollHandler||(this.scrollHandler=new rM(this.$refs.container,function(){e.overlayVisible&&e.hide()})),this.scrollHandler.bindScrollListener()},unbindScrollListener:function(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener:function(){var e=this;this.resizeListener||(this.resizeListener=function(){e.overlayVisible&&!He.isTouchDevice()&&e.hide()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener:function(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},hasFocusableElements:function(){return He.getFocusableElements(this.overlay,':not([data-p-hidden-focusable="true"])').length>0},isOptionMatched:function(e){return this.isValidOption(e)&&this.getOptionLabel(e).toLocaleLowerCase(this.filterLocale).startsWith(this.searchValue.toLocaleLowerCase(this.filterLocale))},isValidOption:function(e){return e&&!(this.isOptionDisabled(e)||this.isOptionGroup(e))},isValidSelectedOption:function(e){return this.isValidOption(e)&&this.isSelected(e)},isSelected:function(e){return this.isValidOption(e)&&At.equals(this.modelValue,this.getOptionValue(e),this.equalityKey)},findFirstOptionIndex:function(){var e=this;return this.visibleOptions.findIndex(function(n){return e.isValidOption(n)})},findLastOptionIndex:function(){var e=this;return At.findLastIndex(this.visibleOptions,function(n){return e.isValidOption(n)})},findNextOptionIndex:function(e){var n=this,i=e<this.visibleOptions.length-1?this.visibleOptions.slice(e+1).findIndex(function(r){return n.isValidOption(r)}):-1;return i>-1?i+e+1:e},findPrevOptionIndex:function(e){var n=this,i=e>0?At.findLastIndex(this.visibleOptions.slice(0,e),function(r){return n.isValidOption(r)}):-1;return i>-1?i:e},findSelectedOptionIndex:function(){var e=this;return this.hasSelectedOption?this.visibleOptions.findIndex(function(n){return e.isValidSelectedOption(n)}):-1},findFirstFocusedOptionIndex:function(){var e=this.findSelectedOptionIndex();return e<0?this.findFirstOptionIndex():e},findLastFocusedOptionIndex:function(){var e=this.findSelectedOptionIndex();return e<0?this.findLastOptionIndex():e},searchOptions:function(e,n){var i=this;this.searchValue=(this.searchValue||"")+n;var r=-1,o=!1;return this.focusedOptionIndex!==-1?(r=this.visibleOptions.slice(this.focusedOptionIndex).findIndex(function(l){return i.isOptionMatched(l)}),r=r===-1?this.visibleOptions.slice(0,this.focusedOptionIndex).findIndex(function(l){return i.isOptionMatched(l)}):r+this.focusedOptionIndex):r=this.visibleOptions.findIndex(function(l){return i.isOptionMatched(l)}),r!==-1&&(o=!0),r===-1&&this.focusedOptionIndex===-1&&(r=this.findFirstFocusedOptionIndex()),r!==-1&&this.changeFocusedOptionIndex(e,r),this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(function(){i.searchValue="",i.searchTimeout=null},500),o},changeFocusedOptionIndex:function(e,n){this.focusedOptionIndex!==n&&(this.focusedOptionIndex=n,this.scrollInView(),this.selectOnFocus&&this.onOptionSelect(e,this.visibleOptions[n],!1))},scrollInView:function(){var e=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:-1,i=n!==-1?"".concat(this.id,"_").concat(n):this.focusedOptionId,r=He.findSingle(this.list,'li[id="'.concat(i,'"]'));r?r.scrollIntoView&&r.scrollIntoView({block:"nearest",inline:"start"}):this.virtualScrollerDisabled||setTimeout(function(){e.virtualScroller&&e.virtualScroller.scrollToIndex(n!==-1?n:e.focusedOptionIndex)},0)},autoUpdateModel:function(){this.selectOnFocus&&this.autoOptionFocus&&!this.hasSelectedOption&&(this.focusedOptionIndex=this.findFirstFocusedOptionIndex(),this.onOptionSelect(null,this.visibleOptions[this.focusedOptionIndex],!1))},updateModel:function(e,n){this.$emit("update:modelValue",n),this.$emit("change",{originalEvent:e,value:n})},flatOptions:function(e){var n=this;return(e||[]).reduce(function(i,r,o){i.push({optionGroup:r,group:!0,index:o});var l=n.getOptionGroupChildren(r);return l&&l.forEach(function(s){return i.push(s)}),i},[])},overlayRef:function(e){this.overlay=e},listRef:function(e,n){this.list=e,n&&n(e)},virtualScrollerRef:function(e){this.virtualScroller=e}},computed:{visibleOptions:function(){var e=this,n=this.optionGroupLabel?this.flatOptions(this.options):this.options||[];if(this.filterValue){var i=_A.filter(n,this.searchFields,this.filterValue,this.filterMatchMode,this.filterLocale);if(this.optionGroupLabel){var r=this.options||[],o=[];return r.forEach(function(l){var s=e.getOptionGroupChildren(l),d=s.filter(function(p){return i.includes(p)});d.length>0&&o.push(_6(_6({},l),{},Y7({},typeof e.optionGroupChildren=="string"?e.optionGroupChildren:"items",lme(d))))}),this.flatOptions(o)}return i}return n},hasSelectedOption:function(){return At.isNotEmpty(this.modelValue)},label:function(){var e=this.findSelectedOptionIndex();return e!==-1?this.getOptionLabel(this.visibleOptions[e]):this.placeholder||"p-emptylabel"},editableInputValue:function(){var e=this.findSelectedOptionIndex();return e!==-1?this.getOptionLabel(this.visibleOptions[e]):this.modelValue||""},equalityKey:function(){return this.optionValue?null:this.dataKey},searchFields:function(){return this.filterFields||[this.optionLabel]},filterResultMessageText:function(){return At.isNotEmpty(this.visibleOptions)?this.filterMessageText.replaceAll("{0}",this.visibleOptions.length):this.emptyFilterMessageText},filterMessageText:function(){return this.filterMessage||this.$primevue.config.locale.searchMessage||""},emptyFilterMessageText:function(){return this.emptyFilterMessage||this.$primevue.config.locale.emptySearchMessage||this.$primevue.config.locale.emptyFilterMessage||""},emptyMessageText:function(){return this.emptyMessage||this.$primevue.config.locale.emptyMessage||""},selectionMessageText:function(){return this.selectionMessage||this.$primevue.config.locale.selectionMessage||""},emptySelectionMessageText:function(){return this.emptySelectionMessage||this.$primevue.config.locale.emptySelectionMessage||""},selectedMessageText:function(){return this.hasSelectedOption?this.selectionMessageText.replaceAll("{0}","1"):this.emptySelectionMessageText},focusedOptionId:function(){return this.focusedOptionIndex!==-1?"".concat(this.id,"_").concat(this.focusedOptionIndex):null},ariaSetSize:function(){var e=this;return this.visibleOptions.filter(function(n){return!e.isOptionGroup(n)}).length},virtualScrollerDisabled:function(){return!this.virtualScrollerOptions}},directives:{ripple:Rl},components:{VirtualScroller:l3,Portal:N2,TimesIcon:a3,ChevronDownIcon:j2,SpinnerIcon:A_,FilterIcon:s3}};function Cv(t){"@babel/helpers - typeof";return Cv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cv(t)}function b6(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Xl(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?b6(Object(n),!0).forEach(function(i){mme(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):b6(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function mme(t,e,n){return e=gme(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gme(t){var e=yme(t,"string");return Cv(e)==="symbol"?e:String(e)}function yme(t,e){if(Cv(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Cv(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var vme=["id"],_me=["id","value","placeholder","tabindex","disabled","aria-label","aria-labelledby","aria-expanded","aria-controls","aria-activedescendant"],bme=["id","tabindex","aria-label","aria-labelledby","aria-expanded","aria-controls","aria-activedescendant","aria-disabled"],xme=["value","placeholder","aria-owns","aria-activedescendant"],wme=["id"],Eme=["id"],Tme=["id","aria-label","aria-selected","aria-disabled","aria-setsize","aria-posinset","onClick","onMousemove","data-p-highlight","data-p-focused","data-p-disabled"];function Sme(t,e,n,i,r,o){var l=Gn("SpinnerIcon"),s=Gn("VirtualScroller"),d=Gn("Portal"),p=ea("ripple");return le(),Ue("div",Le({ref:"container",id:r.id,class:t.cx("root"),onClick:e[15]||(e[15]=function(){return o.onContainerClick&&o.onContainerClick.apply(o,arguments)})},t.ptm("root"),{"data-pc-name":"dropdown"}),[t.editable?(le(),Ue("input",Le({key:0,ref:"focusInput",id:t.inputId,type:"text",class:[t.cx("input"),t.inputClass],style:t.inputStyle,value:o.editableInputValue,placeholder:t.placeholder,tabindex:t.disabled?-1:t.tabindex,disabled:t.disabled,autocomplete:"off",role:"combobox","aria-label":t.ariaLabel,"aria-labelledby":t.ariaLabelledby,"aria-haspopup":"listbox","aria-expanded":r.overlayVisible,"aria-controls":r.id+"_list","aria-activedescendant":r.focused?o.focusedOptionId:void 0,onFocus:e[0]||(e[0]=function(){return o.onFocus&&o.onFocus.apply(o,arguments)}),onBlur:e[1]||(e[1]=function(){return o.onBlur&&o.onBlur.apply(o,arguments)}),onKeydown:e[2]||(e[2]=function(){return o.onKeyDown&&o.onKeyDown.apply(o,arguments)}),onInput:e[3]||(e[3]=function(){return o.onEditableInput&&o.onEditableInput.apply(o,arguments)})},Xl(Xl({},t.inputProps),t.ptm("input"))),null,16,_me)):(le(),Ue("span",Le({key:1,ref:"focusInput",id:t.inputId,class:[t.cx("input"),t.inputClass],style:t.inputStyle,tabindex:t.disabled?-1:t.tabindex,role:"combobox","aria-label":t.ariaLabel||(o.label==="p-emptylabel"?void 0:o.label),"aria-labelledby":t.ariaLabelledby,"aria-haspopup":"listbox","aria-expanded":r.overlayVisible,"aria-controls":r.id+"_list","aria-activedescendant":r.focused?o.focusedOptionId:void 0,"aria-disabled":t.disabled,onFocus:e[4]||(e[4]=function(){return o.onFocus&&o.onFocus.apply(o,arguments)}),onBlur:e[5]||(e[5]=function(){return o.onBlur&&o.onBlur.apply(o,arguments)}),onKeydown:e[6]||(e[6]=function(){return o.onKeyDown&&o.onKeyDown.apply(o,arguments)})},Xl(Xl({},t.inputProps),t.ptm("input"))),[Xn(t.$slots,"value",{value:t.modelValue,placeholder:t.placeholder},function(){return[vo(ki(o.label==="p-emptylabel"?" ":o.label||"empty"),1)]})],16,bme)),t.showClear&&t.modelValue!=null?Xn(t.$slots,"clearicon",{key:2,class:ri(t.cx("clearIcon")),onClick:o.onClearClick},function(){return[(le(),Rt(Zn(t.clearIcon?"i":"TimesIcon"),Le({ref:"clearIcon",class:[t.cx("clearIcon"),t.clearIcon],onClick:o.onClearClick},Xl(Xl({},t.clearIconProps),t.ptm("clearIcon")),{"data-pc-section":"clearicon"}),null,16,["class","onClick"]))]}):Jt("",!0),Qe("div",Le({class:t.cx("trigger")},t.ptm("trigger")),[t.loading?Xn(t.$slots,"loadingicon",{key:0,class:ri(t.cx("loadingIcon"))},function(){return[t.loadingIcon?(le(),Ue("span",Le({key:0,class:[t.cx("loadingIcon"),"pi-spin",t.loadingIcon],"aria-hidden":"true"},t.ptm("loadingIcon")),null,16)):(le(),Rt(l,Le({key:1,class:t.cx("loadingIcon"),spin:"","aria-hidden":"true"},t.ptm("loadingIcon")),null,16,["class"]))]}):Xn(t.$slots,"dropdownicon",{key:1,class:ri(t.cx("dropdownIcon"))},function(){return[(le(),Rt(Zn(t.dropdownIcon?"span":"ChevronDownIcon"),Le({class:[t.cx("dropdownIcon"),t.dropdownIcon],"aria-hidden":"true"},t.ptm("dropdownIcon")),null,16,["class"]))]})],16),Lt(d,{appendTo:t.appendTo},{default:Cn(function(){return[Lt(xf,Le({name:"p-connected-overlay",onEnter:o.onOverlayEnter,onAfterEnter:o.onOverlayAfterEnter,onLeave:o.onOverlayLeave,onAfterLeave:o.onOverlayAfterLeave},t.ptm("transition")),{default:Cn(function(){return[r.overlayVisible?(le(),Ue("div",Le({key:0,ref:o.overlayRef,class:[t.cx("panel"),t.panelClass],style:t.panelStyle,onClick:e[13]||(e[13]=function(){return o.onOverlayClick&&o.onOverlayClick.apply(o,arguments)}),onKeydown:e[14]||(e[14]=function(){return o.onOverlayKeyDown&&o.onOverlayKeyDown.apply(o,arguments)})},Xl(Xl({},t.panelProps),t.ptm("panel"))),[Qe("span",Le({ref:"firstHiddenFocusableElementOnOverlay",role:"presentation","aria-hidden":"true",class:"p-hidden-accessible p-hidden-focusable",tabindex:0,onFocus:e[7]||(e[7]=function(){return o.onFirstHiddenFocus&&o.onFirstHiddenFocus.apply(o,arguments)})},t.ptm("hiddenFirstFocusableEl"),{"data-p-hidden-accessible":!0,"data-p-hidden-focusable":!0}),null,16),Xn(t.$slots,"header",{value:t.modelValue,options:o.visibleOptions}),t.filter?(le(),Ue("div",Le({key:0,class:t.cx("header")},t.ptm("header")),[Qe("div",Le({class:t.cx("filterContainer")},t.ptm("filterContainer")),[Qe("input",Le({ref:"filterInput",type:"text",value:r.filterValue,onVnodeMounted:e[8]||(e[8]=function(){return o.onFilterUpdated&&o.onFilterUpdated.apply(o,arguments)}),class:t.cx("filterInput"),placeholder:t.filterPlaceholder,role:"searchbox",autocomplete:"off","aria-owns":r.id+"_list","aria-activedescendant":o.focusedOptionId,onKeydown:e[9]||(e[9]=function(){return o.onFilterKeyDown&&o.onFilterKeyDown.apply(o,arguments)}),onBlur:e[10]||(e[10]=function(){return o.onFilterBlur&&o.onFilterBlur.apply(o,arguments)}),onInput:e[11]||(e[11]=function(){return o.onFilterChange&&o.onFilterChange.apply(o,arguments)})},Xl(Xl({},t.filterInputProps),t.ptm("filterInput"))),null,16,xme),Xn(t.$slots,"filtericon",{class:ri(t.cx("filterIcon"))},function(){return[(le(),Rt(Zn(t.filterIcon?"span":"FilterIcon"),Le({class:[t.cx("filterIcon"),t.filterIcon]},t.ptm("filterIcon")),null,16,["class"]))]})],16),Qe("span",Le({role:"status","aria-live":"polite",class:"p-hidden-accessible"},t.ptm("hiddenFilterResult"),{"data-p-hidden-accessible":!0}),ki(o.filterResultMessageText),17)],16)):Jt("",!0),Qe("div",Le({class:t.cx("wrapper"),style:{"max-height":o.virtualScrollerDisabled?t.scrollHeight:""}},t.ptm("wrapper")),[Lt(s,Le({ref:o.virtualScrollerRef},t.virtualScrollerOptions,{items:o.visibleOptions,style:{height:t.scrollHeight},tabindex:-1,disabled:o.virtualScrollerDisabled,pt:t.ptm("virtualScroller")}),Pm({content:Cn(function(y){var v=y.styleClass,w=y.contentRef,T=y.items,I=y.getItemOptions,L=y.contentStyle,k=y.itemSize;return[Qe("ul",Le({ref:function(B){return o.listRef(B,w)},id:r.id+"_list",class:[t.cx("list"),v],style:L,role:"listbox"},t.ptm("list")),[(le(!0),Ue(_n,null,or(T,function(F,B){return le(),Ue(_n,{key:o.getOptionRenderKey(F,o.getOptionIndex(B,I))},[o.isOptionGroup(F)?(le(),Ue("li",Le({key:0,id:r.id+"_"+o.getOptionIndex(B,I),style:{height:k?k+"px":void 0},class:t.cx("itemGroup"),role:"option"},t.ptm("itemGroup")),[Xn(t.$slots,"optiongroup",{option:F.optionGroup,index:o.getOptionIndex(B,I)},function(){return[vo(ki(o.getOptionGroupLabel(F.optionGroup)),1)]})],16,Eme)):fo((le(),Ue("li",Le({key:1,id:r.id+"_"+o.getOptionIndex(B,I),class:t.cx("item",{option:F,focusedOption:o.getOptionIndex(B,I)}),style:{height:k?k+"px":void 0},role:"option","aria-label":o.getOptionLabel(F),"aria-selected":o.isSelected(F),"aria-disabled":o.isOptionDisabled(F),"aria-setsize":o.ariaSetSize,"aria-posinset":o.getAriaPosInset(o.getOptionIndex(B,I)),onClick:function(U){return o.onOptionSelect(U,F)},onMousemove:function(U){return o.onOptionMouseMove(U,o.getOptionIndex(B,I))},"data-p-highlight":o.isSelected(F),"data-p-focused":r.focusedOptionIndex===o.getOptionIndex(B,I),"data-p-disabled":o.isOptionDisabled(F)},o.getPTOptions(F,I,B,"item")),[Xn(t.$slots,"option",{option:F,index:o.getOptionIndex(B,I)},function(){return[vo(ki(o.getOptionLabel(F)),1)]})],16,Tme)),[[p]])],64)}),128)),r.filterValue&&(!T||T&&T.length===0)?(le(),Ue("li",Le({key:0,class:t.cx("emptyMessage"),role:"option"},t.ptm("emptyMessage"),{"data-p-hidden-accessible":!0}),[Xn(t.$slots,"emptyfilter",{},function(){return[vo(ki(o.emptyFilterMessageText),1)]})],16)):!t.options||t.options&&t.options.length===0?(le(),Ue("li",Le({key:1,class:t.cx("emptyMessage"),role:"option"},t.ptm("emptyMessage"),{"data-p-hidden-accessible":!0}),[Xn(t.$slots,"empty",{},function(){return[vo(ki(o.emptyMessageText),1)]})],16)):Jt("",!0)],16,wme)]}),_:2},[t.$slots.loader?{name:"loader",fn:Cn(function(y){var v=y.options;return[Xn(t.$slots,"loader",{options:v})]}),key:"0"}:void 0]),1040,["items","style","disabled","pt"])],16),Xn(t.$slots,"footer",{value:t.modelValue,options:o.visibleOptions}),!t.options||t.options&&t.options.length===0?(le(),Ue("span",Le({key:1,role:"status","aria-live":"polite",class:"p-hidden-accessible"},t.ptm("hiddenEmptyMessage"),{"data-p-hidden-accessible":!0}),ki(o.emptyMessageText),17)):Jt("",!0),Qe("span",Le({role:"status","aria-live":"polite",class:"p-hidden-accessible"},t.ptm("hiddenSelectedMessage"),{"data-p-hidden-accessible":!0}),ki(o.selectedMessageText),17),Qe("span",Le({ref:"lastHiddenFocusableElementOnOverlay",role:"presentation","aria-hidden":"true",class:"p-hidden-accessible p-hidden-focusable",tabindex:0,onFocus:e[12]||(e[12]=function(){return o.onLastHiddenFocus&&o.onLastHiddenFocus.apply(o,arguments)})},t.ptm("hiddenLastFocusableEl"),{"data-p-hidden-accessible":!0,"data-p-hidden-focusable":!0}),null,16)],16)):Jt("",!0)]}),_:3},16,["onEnter","onAfterEnter","onLeave","onAfterLeave"])]}),_:3},8,["appendTo"])],16,vme)}ig.render=Sme;const Cme=["id"],Ame=["id"],Pme={key:0},Ime=pr({__name:"InfoPanelCheckboxDropdown",props:{scheme:{}},emits:["settings-changed"],setup(t,{emit:e}){const n=$r(mu);Ds(()=>{document.getElementById(`title-${n.mapID}`).innerHTML=r.scheme.title,document.getElementById(`body-${n.mapID}`).innerHTML+=r.scheme.info});const i=e,r=t,o=r.scheme.scales!==void 0;let l=r.scheme.options.filter(w=>w.type==="dropdown")[0];const s=l.values.map((w,T)=>({name:w,id:T})),d=$n(s[0]),p=r.scheme.options.filter(w=>w.type==="checkbox"),y=$n([]);$n(l.values[0]),r.scheme.options.forEach(w=>{w.default&&y.value.push(w.name)});const v=w=>{let T={};p.forEach(I=>T[I.emitVal]=y.value.includes(I.name)),T[l.emitVal]=d.value.name,i("settings-changed",T)};return(w,T)=>(le(),Ue(_n,null,[Qe("div",null,[Qe("h1",{id:`title-${Yt(n).mapID}`},null,8,Cme),Qe("p",{id:`body-${Yt(n).mapID}`},null,8,Ame)]),Lt(Yt(Ch)),o?(le(),Ue("div",Pme,[(le(!0),Ue(_n,null,or(r.scheme.scales,I=>(le(),Ue("div",{key:I.variable,class:"InfoPanel-checkboxdropdown-scales"},[Lt(r3,{scale:I},null,8,["scale"])]))),128))])):Jt("",!0),Lt(Yt(Ch)),(le(!0),Ue(_n,null,or(Yt(p),I=>(le(),Ue("div",{key:I.name,class:"InfoPanel-checkboxdropdown-checkbox"},[Lt(Yt(o3),{modelValue:y.value,"onUpdate:modelValue":T[0]||(T[0]=L=>y.value=L),value:I.name,onInput:v},null,8,["modelValue","value"]),Qe("label",null,ki(I.name),1)]))),128)),Lt(Yt(Ch)),Qe("h3",null,ki(Yt(l).name),1),Lt(Yt(ig),{modelValue:d.value,"onUpdate:modelValue":T[1]||(T[1]=I=>d.value=I),class:"InfoPanel-checkboxdropdown-dropdown",options:Yt(s),"option-label":"name",placeholder:"Select",onChange:v},null,8,["modelValue","options"])],64))}});const Mme=po(Ime,[["__scopeId","data-v-8310296e"]]),Rme=["id"],Lme=["id"],Ome={key:0},Dme=pr({__name:"InfoPanelText",props:{scheme:{}},emits:["settings-changed"],setup(t,{emit:e}){const n=$r(mu),i=t,r=i.scheme.scales!==void 0;return Ds(()=>{document.getElementById(`title-${n.mapID}`).innerHTML=i.scheme.title,document.getElementById(`body-${n.mapID}`).innerHTML+=i.scheme.info}),(o,l)=>(le(),Ue(_n,null,[Qe("div",null,[Qe("h1",{id:`title-${Yt(n).mapID}`},null,8,Rme),Qe("div",{id:`body-${Yt(n).mapID}`},null,8,Lme)]),Lt(Yt(Ch)),r?(le(),Ue("div",Ome,[(le(!0),Ue(_n,null,or(i.scheme.scales,s=>(le(),Ue("div",{key:s.variable,class:"InfoPanel-text-scales"},[Lt(r3,{scale:s},null,8,["scale"])]))),128))])):Jt("",!0)],64))}});const kme=po(Dme,[["__scopeId","data-v-7c7eb620"]]),Fme={class:"InfoPanelContainer"},Bme={id:"InfoPanelContainer-dropdownarray"},zme=pr({__name:"InfoPanel",props:{settings:{}},emits:["settings-changed"],setup(t,{emit:e}){const n=$n("pi pi-minus"),i=$n(!0),r=()=>{i.value=!i.value,n.value=i.value?"pi pi-minus":"pi pi-plus"},o=e,l=t,s=$n(l.settings.map(I=>({name:I.title,id:I.id}))),d=$n(s.value[0]),p=I=>{if(I==="checkbox")return zpe;if(I==="text")return kme;if(I==="checkbox-dropdown")return Mme},y=l.settings.map(I=>({...I,type:p(I.type)})),v=ur(()=>y.findIndex(I=>I.id===d.value.id).toString()),w=()=>{Ys(()=>{console.log(d.value)})},T=I=>{o("settings-changed",I)};return(I,L)=>(le(),Ue("div",Fme,[Qe("div",Bme,[Lt(Yt(ig),{modelValue:d.value,"onUpdate:modelValue":L[0]||(L[0]=k=>d.value=k),class:"InfoPanelDropdown",options:s.value,"option-label":"name",placeholder:"Select a Layer",onChange:w},null,8,["modelValue","options"]),Lt(Yt(zh),{icon:n.value,style:{height:"fit-content"},onClick:r},null,8,["icon"])]),fo(Qe("div",null,[Lt(ape,{schema:Yt(y),selectedSchema:v.value,onSettingsChanged:T},null,8,["schema","selectedSchema"])],512),[[l_,i.value]])]))}});const Nme=po(zme,[["__scopeId","data-v-5869e560"]]),Ume=["dataID"],Vme=["src"],jme=pr({__name:"LayerCard",props:{element:{}},setup(t){const e=t;function n(i){return console.log("imageName: "+i),new URL("../../../../assets/images/layerIcons/"+i+".png",import.meta.url).href}return(i,r)=>(le(),Ue("div",{class:"layerCard",dataID:e.element.name},[Qe("img",{src:n(e.element.icon),style:{width:"100%"}},null,8,Vme),vo(" "+ki(e.element.name)+" ",1),Lt(m_,{direction:"top",description:e.element.description},null,8,["description"])],8,Ume))}});const Lx=po(jme,[["__scopeId","data-v-8902c172"]]),c3=t=>(lu("data-v-c527e130"),t=t(),cu(),t),$me={class:"AnnotationPanelContainer"},Gme=c3(()=>Qe("h2",null," Annotation! ",-1)),Hme=c3(()=>Qe("p",{id:"AnnotationPanelBody"},null,-1)),Wme=c3(()=>Qe("h3",null," Relevant Layers ",-1)),Kme={id:"AnnotationPanelRelevantLayerContainer"},Xme=pr({__name:"AnnotationPanel",props:{annotationPanelProps:{}},emits:["close-annotation-panel","highlight-layers"],setup(t,{emit:e}){let n=[],i=!1;const r=$n("Show Relevant Layers Only"),o=Xa(),l=$r(mu);Ds(()=>{document.getElementById("AnnotationPanelBody").innerHTML+=d.annotationPanelProps.text});const s=e,d=t,p=()=>{i=!i,console.log(l),i?(r.value="Revert back",n=[],o.getLayerList(l.mapID,l.mapType).forEach(y=>{y.visibility&&n.push(y.name)}),s("highlight-layers",d.annotationPanelProps.relevantLayers.map(y=>y.name))):(r.value="Show Relevant Layers Only",s("highlight-layers",n))};return(y,v)=>(le(),Ue("div",$me,[Qe("div",null,[Gme,Hme,Lt(Yt(Ch)),Wme,Qe("div",Kme,[(le(!0),Ue(_n,null,or(d.annotationPanelProps.relevantLayers,w=>(le(),Rt(Lx,{id:"AnnotationPanelRelevantLayerCards",key:w.name,element:w},null,8,["element"]))),128)),Lt(Yt(zh),{label:`${r.value}`,onClick:p},null,8,["label"])]),Lt(Yt(Ch))]),Lt(Yt(zh),{label:"Close",severity:"secondary",onClick:v[0]||(v[0]=w=>y.$emit("close-annotation-panel"))})]))}});const Zme=po(Xme,[["__scopeId","data-v-c527e130"]]);function qme(t,e,n,i){return new t(e,n,i)}function J7(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function u3(t){let e=t,n=t;t.length===1&&(e=(l,s)=>t(l)-s,n=Yme(t));function i(l,s,d,p){for(d==null&&(d=0),p==null&&(p=l.length);d<p;){const y=d+p>>>1;n(l[y],s)<0?d=y+1:p=y}return d}function r(l,s,d,p){for(d==null&&(d=0),p==null&&(p=l.length);d<p;){const y=d+p>>>1;n(l[y],s)>0?p=y:d=y+1}return d}function o(l,s,d,p){d==null&&(d=0),p==null&&(p=l.length);const y=i(l,s,d,p-1);return y>d&&e(l[y-1],s)>-e(l[y],s)?y-1:y}return{left:i,center:o,right:r}}function Yme(t){return(e,n)=>J7(t(e),n)}function Jme(t){return t===null?NaN:+t}const Qme=u3(J7),ege=Qme.right;u3(Jme).center;const tge=ege;function Va(t,e){let n,i;if(e===void 0)for(const r of t)r!=null&&(n===void 0?r>=r&&(n=i=r):(n>r&&(n=r),i<r&&(i=r)));else{let r=-1;for(let o of t)(o=e(o,++r,t))!=null&&(n===void 0?o>=o&&(n=i=o):(n>o&&(n=o),i<o&&(i=o)))}return[n,i]}var yP=Math.sqrt(50),vP=Math.sqrt(10),_P=Math.sqrt(2);function nge(t,e,n){var i,r=-1,o,l,s;if(e=+e,t=+t,n=+n,t===e&&n>0)return[t];if((i=e<t)&&(o=t,t=e,e=o),(s=Q7(t,e,n))===0||!isFinite(s))return[];if(s>0){let d=Math.round(t/s),p=Math.round(e/s);for(d*s<t&&++d,p*s>e&&--p,l=new Array(o=p-d+1);++r<o;)l[r]=(d+r)*s}else{s=-s;let d=Math.round(t*s),p=Math.round(e*s);for(d/s<t&&++d,p/s>e&&--p,l=new Array(o=p-d+1);++r<o;)l[r]=(d+r)/s}return i&&l.reverse(),l}function Q7(t,e,n){var i=(e-t)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),o=i/Math.pow(10,r);return r>=0?(o>=yP?10:o>=vP?5:o>=_P?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(o>=yP?10:o>=vP?5:o>=_P?2:1)}function bP(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),o=i/r;return o>=yP?r*=10:o>=vP?r*=5:o>=_P&&(r*=2),e<t?-r:r}var oC=Array.prototype.slice;function ige(t){return t}var sC=1,aC=2,xP=3,Ub=4,x6=1e-6;function rge(t){return"translate("+t+",0)"}function oge(t){return"translate(0,"+t+")"}function sge(t){return e=>+t(e)}function age(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function lge(){return!this.__axis}function cge(t,e){var n=[],i=null,r=null,o=6,l=6,s=3,d=typeof window<"u"&&window.devicePixelRatio>1?0:.5,p=t===sC||t===Ub?-1:1,y=t===Ub||t===aC?"x":"y",v=t===sC||t===xP?rge:oge;function w(T){var I=i??(e.ticks?e.ticks.apply(e,n):e.domain()),L=r??(e.tickFormat?e.tickFormat.apply(e,n):ige),k=Math.max(o,0)+s,F=e.range(),B=+F[0]+d,G=+F[F.length-1]+d,U=(e.bandwidth?age:sge)(e.copy(),d),ee=T.selection?T.selection():T,ne=ee.selectAll(".domain").data([null]),ye=ee.selectAll(".tick").data(I,e).order(),fe=ye.exit(),J=ye.enter().append("g").attr("class","tick"),Ce=ye.select("line"),me=ye.select("text");ne=ne.merge(ne.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),ye=ye.merge(J),Ce=Ce.merge(J.append("line").attr("stroke","currentColor").attr(y+"2",p*o)),me=me.merge(J.append("text").attr("fill","currentColor").attr(y,p*k).attr("dy",t===sC?"0em":t===xP?"0.71em":"0.32em")),T!==ee&&(ne=ne.transition(T),ye=ye.transition(T),Ce=Ce.transition(T),me=me.transition(T),fe=fe.transition(T).attr("opacity",x6).attr("transform",function(be){return isFinite(be=U(be))?v(be+d):this.getAttribute("transform")}),J.attr("opacity",x6).attr("transform",function(be){var Te=this.parentNode.__axis;return v((Te&&isFinite(Te=Te(be))?Te:U(be))+d)})),fe.remove(),ne.attr("d",t===Ub||t===aC?l?"M"+p*l+","+B+"H"+d+"V"+G+"H"+p*l:"M"+d+","+B+"V"+G:l?"M"+B+","+p*l+"V"+d+"H"+G+"V"+p*l:"M"+B+","+d+"H"+G),ye.attr("opacity",1).attr("transform",function(be){return v(U(be)+d)}),Ce.attr(y+"2",p*o),me.attr(y,p*k).text(L),ee.filter(lge).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===aC?"start":t===Ub?"end":"middle"),ee.each(function(){this.__axis=U})}return w.scale=function(T){return arguments.length?(e=T,w):e},w.ticks=function(){return n=oC.call(arguments),w},w.tickArguments=function(T){return arguments.length?(n=T==null?[]:oC.call(T),w):n.slice()},w.tickValues=function(T){return arguments.length?(i=T==null?null:oC.call(T),w):i&&i.slice()},w.tickFormat=function(T){return arguments.length?(r=T,w):r},w.tickSize=function(T){return arguments.length?(o=l=+T,w):o},w.tickSizeInner=function(T){return arguments.length?(o=+T,w):o},w.tickSizeOuter=function(T){return arguments.length?(l=+T,w):l},w.tickPadding=function(T){return arguments.length?(s=+T,w):s},w.offset=function(T){return arguments.length?(d=+T,w):d},w}function uge(t){return cge(xP,t)}var hge={value:()=>{}};function h3(){for(var t=0,e=arguments.length,n={},i;t<e;++t){if(!(i=arguments[t]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new Ox(n)}function Ox(t){this._=t}function dge(t,e){return t.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}Ox.prototype=h3.prototype={constructor:Ox,on:function(t,e){var n=this._,i=dge(t+"",n),r,o=-1,l=i.length;if(arguments.length<2){for(;++o<l;)if((r=(t=i[o]).type)&&(r=fge(n[r],t.name)))return r;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<l;)if(r=(t=i[o]).type)n[r]=w6(n[r],t.name,e);else if(e==null)for(r in n)n[r]=w6(n[r],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Ox(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,o;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],i=0,r=o.length;i<r;++i)o[i].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,o=i.length;r<o;++r)i[r].value.apply(e,n)}};function fge(t,e){for(var n=0,i=t.length,r;n<i;++n)if((r=t[n]).name===e)return r.value}function w6(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=hge,t=t.slice(0,i).concat(t.slice(i+1));break}return n!=null&&t.push({name:e,value:n}),t}var wP="http://www.w3.org/1999/xhtml";const E6={svg:"http://www.w3.org/2000/svg",xhtml:wP,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function $2(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),E6.hasOwnProperty(e)?{space:E6[e],local:t}:t}function pge(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===wP&&e.documentElement.namespaceURI===wP?e.createElement(t):e.createElementNS(n,t)}}function mge(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function eU(t){var e=$2(t);return(e.local?mge:pge)(e)}function gge(){}function d3(t){return t==null?gge:function(){return this.querySelector(t)}}function yge(t){typeof t!="function"&&(t=d3(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o=e[r],l=o.length,s=i[r]=new Array(l),d,p,y=0;y<l;++y)(d=o[y])&&(p=t.call(d,d.__data__,y,o))&&("__data__"in d&&(p.__data__=d.__data__),s[y]=p);return new Es(i,this._parents)}function f3(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function vge(){return[]}function tU(t){return t==null?vge:function(){return this.querySelectorAll(t)}}function _ge(t){return function(){var e=t.apply(this,arguments);return e==null?[]:f3(e)}}function bge(t){typeof t=="function"?t=_ge(t):t=tU(t);for(var e=this._groups,n=e.length,i=[],r=[],o=0;o<n;++o)for(var l=e[o],s=l.length,d,p=0;p<s;++p)(d=l[p])&&(i.push(t.call(d,d.__data__,p,l)),r.push(d));return new Es(i,r)}function nU(t){return function(){return this.matches(t)}}function iU(t){return function(e){return e.matches(t)}}var xge=Array.prototype.find;function wge(t){return function(){return xge.call(this.children,t)}}function Ege(){return this.firstElementChild}function Tge(t){return this.select(t==null?Ege:wge(typeof t=="function"?t:iU(t)))}var Sge=Array.prototype.filter;function Cge(){return this.children}function Age(t){return function(){return Sge.call(this.children,t)}}function Pge(t){return this.selectAll(t==null?Cge:Age(typeof t=="function"?t:iU(t)))}function Ige(t){typeof t!="function"&&(t=nU(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o=e[r],l=o.length,s=i[r]=[],d,p=0;p<l;++p)(d=o[p])&&t.call(d,d.__data__,p,o)&&s.push(d);return new Es(i,this._parents)}function rU(t){return new Array(t.length)}function Mge(){return new Es(this._enter||this._groups.map(rU),this._parents)}function Sw(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Sw.prototype={constructor:Sw,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Rge(t){return function(){return t}}function Lge(t,e,n,i,r,o){for(var l=0,s,d=e.length,p=o.length;l<p;++l)(s=e[l])?(s.__data__=o[l],i[l]=s):n[l]=new Sw(t,o[l]);for(;l<d;++l)(s=e[l])&&(r[l]=s)}function Oge(t,e,n,i,r,o,l){var s,d,p=new Map,y=e.length,v=o.length,w=new Array(y),T;for(s=0;s<y;++s)(d=e[s])&&(w[s]=T=l.call(d,d.__data__,s,e)+"",p.has(T)?r[s]=d:p.set(T,d));for(s=0;s<v;++s)T=l.call(t,o[s],s,o)+"",(d=p.get(T))?(i[s]=d,d.__data__=o[s],p.delete(T)):n[s]=new Sw(t,o[s]);for(s=0;s<y;++s)(d=e[s])&&p.get(w[s])===d&&(r[s]=d)}function Dge(t){return t.__data__}function kge(t,e){if(!arguments.length)return Array.from(this,Dge);var n=e?Oge:Lge,i=this._parents,r=this._groups;typeof t!="function"&&(t=Rge(t));for(var o=r.length,l=new Array(o),s=new Array(o),d=new Array(o),p=0;p<o;++p){var y=i[p],v=r[p],w=v.length,T=f3(t.call(y,y&&y.__data__,p,i)),I=T.length,L=s[p]=new Array(I),k=l[p]=new Array(I),F=d[p]=new Array(w);n(y,v,L,k,F,T,e);for(var B=0,G=0,U,ee;B<I;++B)if(U=L[B]){for(B>=G&&(G=B+1);!(ee=k[G])&&++G<I;);U._next=ee||null}}return l=new Es(l,i),l._enter=s,l._exit=d,l}function Fge(){return new Es(this._exit||this._groups.map(rU),this._parents)}function Bge(t,e,n){var i=this.enter(),r=this,o=this.exit();return i=typeof t=="function"?t(i):i.append(t+""),e!=null&&(r=e(r)),n==null?o.remove():n(o),i&&r?i.merge(r).order():r}function zge(t){if(!(t instanceof Es))throw new Error("invalid merge");for(var e=this._groups,n=t._groups,i=e.length,r=n.length,o=Math.min(i,r),l=new Array(i),s=0;s<o;++s)for(var d=e[s],p=n[s],y=d.length,v=l[s]=new Array(y),w,T=0;T<y;++T)(w=d[T]||p[T])&&(v[T]=w);for(;s<i;++s)l[s]=e[s];return new Es(l,this._parents)}function Nge(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i=t[e],r=i.length-1,o=i[r],l;--r>=0;)(l=i[r])&&(o&&l.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(l,o),o=l);return this}function Uge(t){t||(t=Vge);function e(v,w){return v&&w?t(v.__data__,w.__data__):!v-!w}for(var n=this._groups,i=n.length,r=new Array(i),o=0;o<i;++o){for(var l=n[o],s=l.length,d=r[o]=new Array(s),p,y=0;y<s;++y)(p=l[y])&&(d[y]=p);d.sort(e)}return new Es(r,this._parents).order()}function Vge(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function jge(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function $ge(){return Array.from(this)}function Gge(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,o=i.length;r<o;++r){var l=i[r];if(l)return l}return null}function Hge(){let t=0;for(const e of this)++t;return t}function Wge(){return!this.node()}function Kge(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r=e[n],o=0,l=r.length,s;o<l;++o)(s=r[o])&&t.call(s,s.__data__,o,r);return this}function Xge(t){return function(){this.removeAttribute(t)}}function Zge(t){return function(){this.removeAttributeNS(t.space,t.local)}}function qge(t,e){return function(){this.setAttribute(t,e)}}function Yge(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Jge(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Qge(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function eye(t,e){var n=$2(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((e==null?n.local?Zge:Xge:typeof e=="function"?n.local?Qge:Jge:n.local?Yge:qge)(n,e))}function oU(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function tye(t){return function(){this.style.removeProperty(t)}}function nye(t,e,n){return function(){this.style.setProperty(t,e,n)}}function iye(t,e,n){return function(){var i=e.apply(this,arguments);i==null?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function rye(t,e,n){return arguments.length>1?this.each((e==null?tye:typeof e=="function"?iye:nye)(t,e,n??"")):Vm(this.node(),t)}function Vm(t,e){return t.style.getPropertyValue(e)||oU(t).getComputedStyle(t,null).getPropertyValue(e)}function oye(t){return function(){delete this[t]}}function sye(t,e){return function(){this[t]=e}}function aye(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function lye(t,e){return arguments.length>1?this.each((e==null?oye:typeof e=="function"?aye:sye)(t,e)):this.node()[t]}function sU(t){return t.trim().split(/^|\s+/)}function p3(t){return t.classList||new aU(t)}function aU(t){this._node=t,this._names=sU(t.getAttribute("class")||"")}aU.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function lU(t,e){for(var n=p3(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function cU(t,e){for(var n=p3(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function cye(t){return function(){lU(this,t)}}function uye(t){return function(){cU(this,t)}}function hye(t,e){return function(){(e.apply(this,arguments)?lU:cU)(this,t)}}function dye(t,e){var n=sU(t+"");if(arguments.length<2){for(var i=p3(this.node()),r=-1,o=n.length;++r<o;)if(!i.contains(n[r]))return!1;return!0}return this.each((typeof e=="function"?hye:e?cye:uye)(n,e))}function fye(){this.textContent=""}function pye(t){return function(){this.textContent=t}}function mye(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function gye(t){return arguments.length?this.each(t==null?fye:(typeof t=="function"?mye:pye)(t)):this.node().textContent}function yye(){this.innerHTML=""}function vye(t){return function(){this.innerHTML=t}}function _ye(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function bye(t){return arguments.length?this.each(t==null?yye:(typeof t=="function"?_ye:vye)(t)):this.node().innerHTML}function xye(){this.nextSibling&&this.parentNode.appendChild(this)}function wye(){return this.each(xye)}function Eye(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Tye(){return this.each(Eye)}function Sye(t){var e=typeof t=="function"?t:eU(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Cye(){return null}function Aye(t,e){var n=typeof t=="function"?t:eU(t),i=e==null?Cye:typeof e=="function"?e:d3(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function Pye(){var t=this.parentNode;t&&t.removeChild(this)}function Iye(){return this.each(Pye)}function Mye(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Rye(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Lye(t){return this.select(t?Rye:Mye)}function Oye(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Dye(t){return function(e){t.call(this,e,this.__data__)}}function kye(t){return t.trim().split(/^|\s+/).map(function(e){var n="",i=e.indexOf(".");return i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),{type:e,name:n}})}function Fye(t){return function(){var e=this.__on;if(e){for(var n=0,i=-1,r=e.length,o;n<r;++n)o=e[n],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.options):e[++i]=o;++i?e.length=i:delete this.__on}}}function Bye(t,e,n){return function(){var i=this.__on,r,o=Dye(e);if(i){for(var l=0,s=i.length;l<s;++l)if((r=i[l]).type===t.type&&r.name===t.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),r.value=e;return}}this.addEventListener(t.type,o,n),r={type:t.type,name:t.name,value:e,listener:o,options:n},i?i.push(r):this.__on=[r]}}function zye(t,e,n){var i=kye(t+""),r,o=i.length,l;if(arguments.length<2){var s=this.node().__on;if(s){for(var d=0,p=s.length,y;d<p;++d)for(r=0,y=s[d];r<o;++r)if((l=i[r]).type===y.type&&l.name===y.name)return y.value}return}for(s=e?Bye:Fye,r=0;r<o;++r)this.each(s(i[r],e,n));return this}function uU(t,e,n){var i=oU(t),r=i.CustomEvent;typeof r=="function"?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function Nye(t,e){return function(){return uU(this,t,e)}}function Uye(t,e){return function(){return uU(this,t,e.apply(this,arguments))}}function Vye(t,e){return this.each((typeof e=="function"?Uye:Nye)(t,e))}function*jye(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,o=i.length,l;r<o;++r)(l=i[r])&&(yield l)}var m3=[null];function Es(t,e){this._groups=t,this._parents=e}function I_(){return new Es([[document.documentElement]],m3)}function $ye(){return this}Es.prototype=I_.prototype={constructor:Es,select:yge,selectAll:bge,selectChild:Tge,selectChildren:Pge,filter:Ige,data:kge,enter:Mge,exit:Fge,join:Bge,merge:zge,selection:$ye,order:Nge,sort:Uge,call:jge,nodes:$ge,node:Gge,size:Hge,empty:Wge,each:Kge,attr:eye,style:rye,property:lye,classed:dye,text:gye,html:bye,raise:wye,lower:Tye,append:Sye,insert:Aye,remove:Iye,clone:Lye,datum:Oye,on:zye,dispatch:Vye,[Symbol.iterator]:jye};function Nh(t){return typeof t=="string"?new Es([[document.querySelector(t)]],[document.documentElement]):new Es([[t]],m3)}function Gye(t){let e;for(;e=t.sourceEvent;)t=e;return t}function T6(t,e){if(t=Gye(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]}function lC(t){return typeof t=="string"?new Es([document.querySelectorAll(t)],[document.documentElement]):new Es([t==null?[]:f3(t)],m3)}function cC(t){t.stopImmediatePropagation()}function vm(t){t.preventDefault(),t.stopImmediatePropagation()}function Hye(t){var e=t.document.documentElement,n=Nh(t).on("dragstart.drag",vm,!0);"onselectstart"in e?n.on("selectstart.drag",vm,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Wye(t,e){var n=t.document.documentElement,i=Nh(t).on("dragstart.drag",null);e&&(i.on("click.drag",vm,!0),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Vb=t=>()=>t;function EP(t,{sourceEvent:e,subject:n,target:i,identifier:r,active:o,x:l,y:s,dx:d,dy:p,dispatch:y}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:l,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:d,enumerable:!0,configurable:!0},dy:{value:p,enumerable:!0,configurable:!0},_:{value:y}})}EP.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function Kye(t){return!t.ctrlKey&&!t.button}function Xye(){return this.parentNode}function Zye(t,e){return e??{x:t.x,y:t.y}}function qye(){return navigator.maxTouchPoints||"ontouchstart"in this}function S6(){var t=Kye,e=Xye,n=Zye,i=qye,r={},o=h3("start","drag","end"),l=0,s,d,p,y,v=0;function w(U){U.on("mousedown.drag",T).filter(i).on("touchstart.drag",k).on("touchmove.drag",F).on("touchend.drag touchcancel.drag",B).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function T(U,ee){if(!(y||!t.call(this,U,ee))){var ne=G(this,e.call(this,U,ee),U,ee,"mouse");ne&&(Nh(U.view).on("mousemove.drag",I,!0).on("mouseup.drag",L,!0),Hye(U.view),cC(U),p=!1,s=U.clientX,d=U.clientY,ne("start",U))}}function I(U){if(vm(U),!p){var ee=U.clientX-s,ne=U.clientY-d;p=ee*ee+ne*ne>v}r.mouse("drag",U)}function L(U){Nh(U.view).on("mousemove.drag mouseup.drag",null),Wye(U.view,p),vm(U),r.mouse("end",U)}function k(U,ee){if(t.call(this,U,ee)){var ne=U.changedTouches,ye=e.call(this,U,ee),fe=ne.length,J,Ce;for(J=0;J<fe;++J)(Ce=G(this,ye,U,ee,ne[J].identifier,ne[J]))&&(cC(U),Ce("start",U,ne[J]))}}function F(U){var ee=U.changedTouches,ne=ee.length,ye,fe;for(ye=0;ye<ne;++ye)(fe=r[ee[ye].identifier])&&(vm(U),fe("drag",U,ee[ye]))}function B(U){var ee=U.changedTouches,ne=ee.length,ye,fe;for(y&&clearTimeout(y),y=setTimeout(function(){y=null},500),ye=0;ye<ne;++ye)(fe=r[ee[ye].identifier])&&(cC(U),fe("end",U,ee[ye]))}function G(U,ee,ne,ye,fe,J){var Ce=o.copy(),me=T6(J||ne,ee),be,Te,ke;if((ke=n.call(U,new EP("beforestart",{sourceEvent:ne,target:w,identifier:fe,active:l,x:me[0],y:me[1],dx:0,dy:0,dispatch:Ce}),ye))!=null)return be=ke.x-me[0]||0,Te=ke.y-me[1]||0,function ut(et,Et,bt){var Qt=me,cn;switch(et){case"start":r[fe]=ut,cn=l++;break;case"end":delete r[fe],--l;case"drag":me=T6(bt||Et,ee),cn=l;break}Ce.call(et,U,new EP(et,{sourceEvent:Et,subject:ke,target:w,identifier:fe,active:cn,x:me[0]+be,y:me[1]+Te,dx:me[0]-Qt[0],dy:me[1]-Qt[1],dispatch:Ce}),ye)}}return w.filter=function(U){return arguments.length?(t=typeof U=="function"?U:Vb(!!U),w):t},w.container=function(U){return arguments.length?(e=typeof U=="function"?U:Vb(U),w):e},w.subject=function(U){return arguments.length?(n=typeof U=="function"?U:Vb(U),w):n},w.touchable=function(U){return arguments.length?(i=typeof U=="function"?U:Vb(!!U),w):i},w.on=function(){var U=o.on.apply(o,arguments);return U===o?w:U},w.clickDistance=function(U){return arguments.length?(v=(U=+U)*U,w):Math.sqrt(v)},w}function g3(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function hU(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function M_(){}var Av=.7,Cw=1/Av,_m="\\s*([+-]?\\d+)\\s*",Pv="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",ac="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Yye=/^#([0-9a-f]{3,8})$/,Jye=new RegExp("^rgb\\("+[_m,_m,_m]+"\\)$"),Qye=new RegExp("^rgb\\("+[ac,ac,ac]+"\\)$"),e0e=new RegExp("^rgba\\("+[_m,_m,_m,Pv]+"\\)$"),t0e=new RegExp("^rgba\\("+[ac,ac,ac,Pv]+"\\)$"),n0e=new RegExp("^hsl\\("+[Pv,ac,ac]+"\\)$"),i0e=new RegExp("^hsla\\("+[Pv,ac,ac,Pv]+"\\)$"),C6={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};g3(M_,ff,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:A6,formatHex:A6,formatHsl:r0e,formatRgb:P6,toString:P6});function A6(){return this.rgb().formatHex()}function r0e(){return dU(this).formatHsl()}function P6(){return this.rgb().formatRgb()}function ff(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Yye.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?I6(e):n===3?new wa(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?jb(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?jb(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Jye.exec(t))?new wa(e[1],e[2],e[3],1):(e=Qye.exec(t))?new wa(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=e0e.exec(t))?jb(e[1],e[2],e[3],e[4]):(e=t0e.exec(t))?jb(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=n0e.exec(t))?L6(e[1],e[2]/100,e[3]/100,1):(e=i0e.exec(t))?L6(e[1],e[2]/100,e[3]/100,e[4]):C6.hasOwnProperty(t)?I6(C6[t]):t==="transparent"?new wa(NaN,NaN,NaN,0):null}function I6(t){return new wa(t>>16&255,t>>8&255,t&255,1)}function jb(t,e,n,i){return i<=0&&(t=e=n=NaN),new wa(t,e,n,i)}function o0e(t){return t instanceof M_||(t=ff(t)),t?(t=t.rgb(),new wa(t.r,t.g,t.b,t.opacity)):new wa}function Uh(t,e,n,i){return arguments.length===1?o0e(t):new wa(t,e,n,i??1)}function wa(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}g3(wa,Uh,hU(M_,{brighter:function(t){return t=t==null?Cw:Math.pow(Cw,t),new wa(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?Av:Math.pow(Av,t),new wa(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:M6,formatHex:M6,formatRgb:R6,toString:R6}));function M6(){return"#"+uC(this.r)+uC(this.g)+uC(this.b)}function R6(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}function uC(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function L6(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new nc(t,e,n,i)}function dU(t){if(t instanceof nc)return new nc(t.h,t.s,t.l,t.opacity);if(t instanceof M_||(t=ff(t)),!t)return new nc;if(t instanceof nc)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),o=Math.max(e,n,i),l=NaN,s=o-r,d=(o+r)/2;return s?(e===o?l=(n-i)/s+(n<i)*6:n===o?l=(i-e)/s+2:l=(e-n)/s+4,s/=d<.5?o+r:2-o-r,l*=60):s=d>0&&d<1?0:l,new nc(l,s,d,t.opacity)}function s0e(t,e,n,i){return arguments.length===1?dU(t):new nc(t,e,n,i??1)}function nc(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}g3(nc,s0e,hU(M_,{brighter:function(t){return t=t==null?Cw:Math.pow(Cw,t),new nc(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?Av:Math.pow(Av,t),new nc(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new wa(hC(t>=240?t-240:t+120,r,i),hC(t,r,i),hC(t<120?t+240:t-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(t===1?")":", "+t+")")}}));function hC(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}var jm=0,o0=0,By=0,fU=1e3,Aw,s0,Pw=0,pf=0,G2=0,Iv=typeof performance=="object"&&performance.now?performance:Date,pU=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function y3(){return pf||(pU(a0e),pf=Iv.now()+G2)}function a0e(){pf=0}function Iw(){this._call=this._time=this._next=null}Iw.prototype=mU.prototype={constructor:Iw,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?y3():+n)+(e==null?0:+e),!this._next&&s0!==this&&(s0?s0._next=this:Aw=this,s0=this),this._call=t,this._time=n,TP()},stop:function(){this._call&&(this._call=null,this._time=1/0,TP())}};function mU(t,e,n){var i=new Iw;return i.restart(t,e,n),i}function l0e(){y3(),++jm;for(var t=Aw,e;t;)(e=pf-t._time)>=0&&t._call.call(null,e),t=t._next;--jm}function O6(){pf=(Pw=Iv.now())+G2,jm=o0=0;try{l0e()}finally{jm=0,u0e(),pf=0}}function c0e(){var t=Iv.now(),e=t-Pw;e>fU&&(G2-=e,Pw=t)}function u0e(){for(var t,e=Aw,n,i=1/0;e;)e._call?(i>e._time&&(i=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Aw=n);s0=t,TP(i)}function TP(t){if(!jm){o0&&(o0=clearTimeout(o0));var e=t-pf;e>24?(t<1/0&&(o0=setTimeout(O6,t-Iv.now()-G2)),By&&(By=clearInterval(By))):(By||(Pw=Iv.now(),By=setInterval(c0e,fU)),jm=1,pU(O6))}}function D6(t,e,n){var i=new Iw;return e=e==null?0:+e,i.restart(r=>{i.stop(),t(r+e)},e,n),i}var h0e=h3("start","end","cancel","interrupt"),d0e=[],gU=0,k6=1,SP=2,Dx=3,F6=4,CP=5,kx=6;function H2(t,e,n,i,r,o){var l=t.__transition;if(!l)t.__transition={};else if(n in l)return;f0e(t,n,{name:e,index:i,group:r,on:h0e,tween:d0e,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:gU})}function v3(t,e){var n=Ll(t,e);if(n.state>gU)throw new Error("too late; already scheduled");return n}function yc(t,e){var n=Ll(t,e);if(n.state>Dx)throw new Error("too late; already running");return n}function Ll(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function f0e(t,e,n){var i=t.__transition,r;i[e]=n,n.timer=mU(o,0,n.time);function o(p){n.state=k6,n.timer.restart(l,n.delay,n.time),n.delay<=p&&l(p-n.delay)}function l(p){var y,v,w,T;if(n.state!==k6)return d();for(y in i)if(T=i[y],T.name===n.name){if(T.state===Dx)return D6(l);T.state===F6?(T.state=kx,T.timer.stop(),T.on.call("interrupt",t,t.__data__,T.index,T.group),delete i[y]):+y<e&&(T.state=kx,T.timer.stop(),T.on.call("cancel",t,t.__data__,T.index,T.group),delete i[y])}if(D6(function(){n.state===Dx&&(n.state=F6,n.timer.restart(s,n.delay,n.time),s(p))}),n.state=SP,n.on.call("start",t,t.__data__,n.index,n.group),n.state===SP){for(n.state=Dx,r=new Array(w=n.tween.length),y=0,v=-1;y<w;++y)(T=n.tween[y].value.call(t,t.__data__,n.index,n.group))&&(r[++v]=T);r.length=v+1}}function s(p){for(var y=p<n.duration?n.ease.call(null,p/n.duration):(n.timer.restart(d),n.state=CP,1),v=-1,w=r.length;++v<w;)r[v].call(t,y);n.state===CP&&(n.on.call("end",t,t.__data__,n.index,n.group),d())}function d(){n.state=kx,n.timer.stop(),delete i[e];for(var p in i)return;delete t.__transition}}function p0e(t,e){var n=t.__transition,i,r,o=!0,l;if(n){e=e==null?null:e+"";for(l in n){if((i=n[l]).name!==e){o=!1;continue}r=i.state>SP&&i.state<CP,i.state=kx,i.timer.stop(),i.on.call(r?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete n[l]}o&&delete t.__transition}}function m0e(t){return this.each(function(){p0e(this,t)})}const yU=t=>()=>t;function g0e(t,e){return function(n){return t+n*e}}function y0e(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function v0e(t){return(t=+t)==1?vU:function(e,n){return n-e?y0e(e,n,t):yU(isNaN(e)?n:e)}}function vU(t,e){var n=e-t;return n?g0e(t,n):yU(isNaN(t)?e:t)}const B6=function t(e){var n=v0e(e);function i(r,o){var l=n((r=Uh(r)).r,(o=Uh(o)).r),s=n(r.g,o.g),d=n(r.b,o.b),p=vU(r.opacity,o.opacity);return function(y){return r.r=l(y),r.g=s(y),r.b=d(y),r.opacity=p(y),r+""}}return i.gamma=t,i}(1);function ph(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var AP=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,dC=new RegExp(AP.source,"g");function _0e(t){return function(){return t}}function b0e(t){return function(e){return t(e)+""}}function x0e(t,e){var n=AP.lastIndex=dC.lastIndex=0,i,r,o,l=-1,s=[],d=[];for(t=t+"",e=e+"";(i=AP.exec(t))&&(r=dC.exec(e));)(o=r.index)>n&&(o=e.slice(n,o),s[l]?s[l]+=o:s[++l]=o),(i=i[0])===(r=r[0])?s[l]?s[l]+=r:s[++l]=r:(s[++l]=null,d.push({i:l,x:ph(i,r)})),n=dC.lastIndex;return n<e.length&&(o=e.slice(n),s[l]?s[l]+=o:s[++l]=o),s.length<2?d[0]?b0e(d[0].x):_0e(e):(e=d.length,function(p){for(var y=0,v;y<e;++y)s[(v=d[y]).i]=v.x(p);return s.join("")})}var z6=180/Math.PI,PP={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function _U(t,e,n,i,r,o){var l,s,d;return(l=Math.sqrt(t*t+e*e))&&(t/=l,e/=l),(d=t*n+e*i)&&(n-=t*d,i-=e*d),(s=Math.sqrt(n*n+i*i))&&(n/=s,i/=s,d/=s),t*i<e*n&&(t=-t,e=-e,d=-d,l=-l),{translateX:r,translateY:o,rotate:Math.atan2(e,t)*z6,skewX:Math.atan(d)*z6,scaleX:l,scaleY:s}}var $b;function w0e(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?PP:_U(e.a,e.b,e.c,e.d,e.e,e.f)}function E0e(t){return t==null||($b||($b=document.createElementNS("http://www.w3.org/2000/svg","g")),$b.setAttribute("transform",t),!(t=$b.transform.baseVal.consolidate()))?PP:(t=t.matrix,_U(t.a,t.b,t.c,t.d,t.e,t.f))}function bU(t,e,n,i){function r(p){return p.length?p.pop()+" ":""}function o(p,y,v,w,T,I){if(p!==v||y!==w){var L=T.push("translate(",null,e,null,n);I.push({i:L-4,x:ph(p,v)},{i:L-2,x:ph(y,w)})}else(v||w)&&T.push("translate("+v+e+w+n)}function l(p,y,v,w){p!==y?(p-y>180?y+=360:y-p>180&&(p+=360),w.push({i:v.push(r(v)+"rotate(",null,i)-2,x:ph(p,y)})):y&&v.push(r(v)+"rotate("+y+i)}function s(p,y,v,w){p!==y?w.push({i:v.push(r(v)+"skewX(",null,i)-2,x:ph(p,y)}):y&&v.push(r(v)+"skewX("+y+i)}function d(p,y,v,w,T,I){if(p!==v||y!==w){var L=T.push(r(T)+"scale(",null,",",null,")");I.push({i:L-4,x:ph(p,v)},{i:L-2,x:ph(y,w)})}else(v!==1||w!==1)&&T.push(r(T)+"scale("+v+","+w+")")}return function(p,y){var v=[],w=[];return p=t(p),y=t(y),o(p.translateX,p.translateY,y.translateX,y.translateY,v,w),l(p.rotate,y.rotate,v,w),s(p.skewX,y.skewX,v,w),d(p.scaleX,p.scaleY,y.scaleX,y.scaleY,v,w),p=y=null,function(T){for(var I=-1,L=w.length,k;++I<L;)v[(k=w[I]).i]=k.x(T);return v.join("")}}}var T0e=bU(w0e,"px, ","px)","deg)"),S0e=bU(E0e,", ",")",")");function C0e(t,e){var n,i;return function(){var r=yc(this,t),o=r.tween;if(o!==n){i=n=o;for(var l=0,s=i.length;l<s;++l)if(i[l].name===e){i=i.slice(),i.splice(l,1);break}}r.tween=i}}function A0e(t,e,n){var i,r;if(typeof n!="function")throw new Error;return function(){var o=yc(this,t),l=o.tween;if(l!==i){r=(i=l).slice();for(var s={name:e,value:n},d=0,p=r.length;d<p;++d)if(r[d].name===e){r[d]=s;break}d===p&&r.push(s)}o.tween=r}}function P0e(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i=Ll(this.node(),n).tween,r=0,o=i.length,l;r<o;++r)if((l=i[r]).name===t)return l.value;return null}return this.each((e==null?C0e:A0e)(n,t,e))}function _3(t,e,n){var i=t._id;return t.each(function(){var r=yc(this,i);(r.value||(r.value={}))[e]=n.apply(this,arguments)}),function(r){return Ll(r,i).value[e]}}function xU(t,e){var n;return(typeof e=="number"?ph:e instanceof ff?B6:(n=ff(e))?(e=n,B6):x0e)(t,e)}function I0e(t){return function(){this.removeAttribute(t)}}function M0e(t){return function(){this.removeAttributeNS(t.space,t.local)}}function R0e(t,e,n){var i,r=n+"",o;return function(){var l=this.getAttribute(t);return l===r?null:l===i?o:o=e(i=l,n)}}function L0e(t,e,n){var i,r=n+"",o;return function(){var l=this.getAttributeNS(t.space,t.local);return l===r?null:l===i?o:o=e(i=l,n)}}function O0e(t,e,n){var i,r,o;return function(){var l,s=n(this),d;return s==null?void this.removeAttribute(t):(l=this.getAttribute(t),d=s+"",l===d?null:l===i&&d===r?o:(r=d,o=e(i=l,s)))}}function D0e(t,e,n){var i,r,o;return function(){var l,s=n(this),d;return s==null?void this.removeAttributeNS(t.space,t.local):(l=this.getAttributeNS(t.space,t.local),d=s+"",l===d?null:l===i&&d===r?o:(r=d,o=e(i=l,s)))}}function k0e(t,e){var n=$2(t),i=n==="transform"?S0e:xU;return this.attrTween(t,typeof e=="function"?(n.local?D0e:O0e)(n,i,_3(this,"attr."+t,e)):e==null?(n.local?M0e:I0e)(n):(n.local?L0e:R0e)(n,i,e))}function F0e(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function B0e(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function z0e(t,e){var n,i;function r(){var o=e.apply(this,arguments);return o!==i&&(n=(i=o)&&B0e(t,o)),n}return r._value=e,r}function N0e(t,e){var n,i;function r(){var o=e.apply(this,arguments);return o!==i&&(n=(i=o)&&F0e(t,o)),n}return r._value=e,r}function U0e(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var i=$2(t);return this.tween(n,(i.local?z0e:N0e)(i,e))}function V0e(t,e){return function(){v3(this,t).delay=+e.apply(this,arguments)}}function j0e(t,e){return e=+e,function(){v3(this,t).delay=e}}function $0e(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?V0e:j0e)(e,t)):Ll(this.node(),e).delay}function G0e(t,e){return function(){yc(this,t).duration=+e.apply(this,arguments)}}function H0e(t,e){return e=+e,function(){yc(this,t).duration=e}}function W0e(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?G0e:H0e)(e,t)):Ll(this.node(),e).duration}function K0e(t,e){if(typeof e!="function")throw new Error;return function(){yc(this,t).ease=e}}function X0e(t){var e=this._id;return arguments.length?this.each(K0e(e,t)):Ll(this.node(),e).ease}function Z0e(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;yc(this,t).ease=n}}function q0e(t){if(typeof t!="function")throw new Error;return this.each(Z0e(this._id,t))}function Y0e(t){typeof t!="function"&&(t=nU(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o=e[r],l=o.length,s=i[r]=[],d,p=0;p<l;++p)(d=o[p])&&t.call(d,d.__data__,p,o)&&s.push(d);return new ru(i,this._parents,this._name,this._id)}function J0e(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,o=Math.min(i,r),l=new Array(i),s=0;s<o;++s)for(var d=e[s],p=n[s],y=d.length,v=l[s]=new Array(y),w,T=0;T<y;++T)(w=d[T]||p[T])&&(v[T]=w);for(;s<i;++s)l[s]=e[s];return new ru(l,this._parents,this._name,this._id)}function Q0e(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function eve(t,e,n){var i,r,o=Q0e(e)?v3:yc;return function(){var l=o(this,t),s=l.on;s!==i&&(r=(i=s).copy()).on(e,n),l.on=r}}function tve(t,e){var n=this._id;return arguments.length<2?Ll(this.node(),n).on.on(t):this.each(eve(n,t,e))}function nve(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function ive(){return this.on("end.remove",nve(this._id))}function rve(t){var e=this._name,n=this._id;typeof t!="function"&&(t=d3(t));for(var i=this._groups,r=i.length,o=new Array(r),l=0;l<r;++l)for(var s=i[l],d=s.length,p=o[l]=new Array(d),y,v,w=0;w<d;++w)(y=s[w])&&(v=t.call(y,y.__data__,w,s))&&("__data__"in y&&(v.__data__=y.__data__),p[w]=v,H2(p[w],e,n,w,p,Ll(y,n)));return new ru(o,this._parents,e,n)}function ove(t){var e=this._name,n=this._id;typeof t!="function"&&(t=tU(t));for(var i=this._groups,r=i.length,o=[],l=[],s=0;s<r;++s)for(var d=i[s],p=d.length,y,v=0;v<p;++v)if(y=d[v]){for(var w=t.call(y,y.__data__,v,d),T,I=Ll(y,n),L=0,k=w.length;L<k;++L)(T=w[L])&&H2(T,e,n,L,w,I);o.push(w),l.push(y)}return new ru(o,l,e,n)}var sve=I_.prototype.constructor;function ave(){return new sve(this._groups,this._parents)}function lve(t,e){var n,i,r;return function(){var o=Vm(this,t),l=(this.style.removeProperty(t),Vm(this,t));return o===l?null:o===n&&l===i?r:r=e(n=o,i=l)}}function wU(t){return function(){this.style.removeProperty(t)}}function cve(t,e,n){var i,r=n+"",o;return function(){var l=Vm(this,t);return l===r?null:l===i?o:o=e(i=l,n)}}function uve(t,e,n){var i,r,o;return function(){var l=Vm(this,t),s=n(this),d=s+"";return s==null&&(d=s=(this.style.removeProperty(t),Vm(this,t))),l===d?null:l===i&&d===r?o:(r=d,o=e(i=l,s))}}function hve(t,e){var n,i,r,o="style."+e,l="end."+o,s;return function(){var d=yc(this,t),p=d.on,y=d.value[o]==null?s||(s=wU(e)):void 0;(p!==n||r!==y)&&(i=(n=p).copy()).on(l,r=y),d.on=i}}function dve(t,e,n){var i=(t+="")=="transform"?T0e:xU;return e==null?this.styleTween(t,lve(t,i)).on("end.style."+t,wU(t)):typeof e=="function"?this.styleTween(t,uve(t,i,_3(this,"style."+t,e))).each(hve(this._id,t)):this.styleTween(t,cve(t,i,e),n).on("end.style."+t,null)}function fve(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function pve(t,e,n){var i,r;function o(){var l=e.apply(this,arguments);return l!==r&&(i=(r=l)&&fve(t,l,n)),i}return o._value=e,o}function mve(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,pve(t,e,n??""))}function gve(t){return function(){this.textContent=t}}function yve(t){return function(){var e=t(this);this.textContent=e??""}}function vve(t){return this.tween("text",typeof t=="function"?yve(_3(this,"text",t)):gve(t==null?"":t+""))}function _ve(t){return function(e){this.textContent=t.call(this,e)}}function bve(t){var e,n;function i(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&_ve(r)),e}return i._value=t,i}function xve(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,bve(t))}function wve(){for(var t=this._name,e=this._id,n=EU(),i=this._groups,r=i.length,o=0;o<r;++o)for(var l=i[o],s=l.length,d,p=0;p<s;++p)if(d=l[p]){var y=Ll(d,e);H2(d,t,n,p,l,{time:y.time+y.delay+y.duration,delay:0,duration:y.duration,ease:y.ease})}return new ru(i,this._parents,t,n)}function Eve(){var t,e,n=this,i=n._id,r=n.size();return new Promise(function(o,l){var s={value:l},d={value:function(){--r===0&&o()}};n.each(function(){var p=yc(this,i),y=p.on;y!==t&&(e=(t=y).copy(),e._.cancel.push(s),e._.interrupt.push(s),e._.end.push(d)),p.on=e}),r===0&&o()})}var Tve=0;function ru(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function EU(){return++Tve}var Id=I_.prototype;ru.prototype={constructor:ru,select:rve,selectAll:ove,filter:Y0e,merge:J0e,selection:ave,transition:wve,call:Id.call,nodes:Id.nodes,node:Id.node,size:Id.size,empty:Id.empty,each:Id.each,on:tve,attr:k0e,attrTween:U0e,style:dve,styleTween:mve,text:vve,textTween:xve,remove:ive,tween:P0e,delay:$0e,duration:W0e,ease:X0e,easeVarying:q0e,end:Eve,[Symbol.iterator]:Id[Symbol.iterator]};function Sve(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Cve={time:null,delay:0,duration:250,ease:Sve};function Ave(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function Pve(t){var e,n;t instanceof ru?(e=t._id,t=t._name):(e=EU(),(n=Cve).time=y3(),t=t==null?null:t+"");for(var i=this._groups,r=i.length,o=0;o<r;++o)for(var l=i[o],s=l.length,d,p=0;p<s;++p)(d=l[p])&&H2(d,t,e,p,l,n||Ave(d,e));return new ru(i,this._parents,t,e)}I_.prototype.interrupt=m0e;I_.prototype.transition=Pve;const IP=Math.PI,MP=2*IP,Bd=1e-6,Ive=MP-Bd;function RP(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function TU(){return new RP}RP.prototype=TU.prototype={constructor:RP,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,i){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(t,e,n,i,r,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+o)},arcTo:function(t,e,n,i,r){t=+t,e=+e,n=+n,i=+i,r=+r;var o=this._x1,l=this._y1,s=n-t,d=i-e,p=o-t,y=l-e,v=p*p+y*y;if(r<0)throw new Error("negative radius: "+r);if(this._x1===null)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(v>Bd)if(!(Math.abs(y*s-d*p)>Bd)||!r)this._+="L"+(this._x1=t)+","+(this._y1=e);else{var w=n-o,T=i-l,I=s*s+d*d,L=w*w+T*T,k=Math.sqrt(I),F=Math.sqrt(v),B=r*Math.tan((IP-Math.acos((I+v-L)/(2*k*F)))/2),G=B/F,U=B/k;Math.abs(G-1)>Bd&&(this._+="L"+(t+G*p)+","+(e+G*y)),this._+="A"+r+","+r+",0,0,"+ +(y*w>p*T)+","+(this._x1=t+U*s)+","+(this._y1=e+U*d)}},arc:function(t,e,n,i,r,o){t=+t,e=+e,n=+n,o=!!o;var l=n*Math.cos(i),s=n*Math.sin(i),d=t+l,p=e+s,y=1^o,v=o?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+d+","+p:(Math.abs(this._x1-d)>Bd||Math.abs(this._y1-p)>Bd)&&(this._+="L"+d+","+p),n&&(v<0&&(v=v%MP+MP),v>Ive?this._+="A"+n+","+n+",0,1,"+y+","+(t-l)+","+(e-s)+"A"+n+","+n+",0,1,"+y+","+(this._x1=d)+","+(this._y1=p):v>Bd&&(this._+="A"+n+","+n+",0,"+ +(v>=IP)+","+y+","+(this._x1=t+n*Math.cos(r))+","+(this._y1=e+n*Math.sin(r))))},rect:function(t,e,n,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};function Mve(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Mw(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function $m(t){return t=Mw(Math.abs(t)),t?t[1]:NaN}function Rve(t,e){return function(n,i){for(var r=n.length,o=[],l=0,s=t[0],d=0;r>0&&s>0&&(d+s+1>i&&(s=Math.max(1,i-d)),o.push(n.substring(r-=s,r+s)),!((d+=s+1)>i));)s=t[l=(l+1)%t.length];return o.reverse().join(e)}}function Lve(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var Ove=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Rw(t){if(!(e=Ove.exec(t)))throw new Error("invalid format: "+t);var e;return new b3({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Rw.prototype=b3.prototype;function b3(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}b3.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Dve(t){e:for(var e=t.length,n=1,i=-1,r;n<e;++n)switch(t[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+t[n])break e;i>0&&(i=0);break}return i>0?t.slice(0,i)+t.slice(r+1):t}var SU;function kve(t,e){var n=Mw(t,e);if(!n)return t+"";var i=n[0],r=n[1],o=r-(SU=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,l=i.length;return o===l?i:o>l?i+new Array(o-l+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+Mw(t,Math.max(0,e+o-1))[0]}function N6(t,e){var n=Mw(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const U6={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Mve,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>N6(t*100,e),r:N6,s:kve,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function V6(t){return t}var j6=Array.prototype.map,$6=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Fve(t){var e=t.grouping===void 0||t.thousands===void 0?V6:Rve(j6.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",i=t.currency===void 0?"":t.currency[1]+"",r=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?V6:Lve(j6.call(t.numerals,String)),l=t.percent===void 0?"%":t.percent+"",s=t.minus===void 0?"−":t.minus+"",d=t.nan===void 0?"NaN":t.nan+"";function p(v){v=Rw(v);var w=v.fill,T=v.align,I=v.sign,L=v.symbol,k=v.zero,F=v.width,B=v.comma,G=v.precision,U=v.trim,ee=v.type;ee==="n"?(B=!0,ee="g"):U6[ee]||(G===void 0&&(G=12),U=!0,ee="g"),(k||w==="0"&&T==="=")&&(k=!0,w="0",T="=");var ne=L==="$"?n:L==="#"&&/[boxX]/.test(ee)?"0"+ee.toLowerCase():"",ye=L==="$"?i:/[%p]/.test(ee)?l:"",fe=U6[ee],J=/[defgprs%]/.test(ee);G=G===void 0?6:/[gprs]/.test(ee)?Math.max(1,Math.min(21,G)):Math.max(0,Math.min(20,G));function Ce(me){var be=ne,Te=ye,ke,ut,et;if(ee==="c")Te=fe(me)+Te,me="";else{me=+me;var Et=me<0||1/me<0;if(me=isNaN(me)?d:fe(Math.abs(me),G),U&&(me=Dve(me)),Et&&+me==0&&I!=="+"&&(Et=!1),be=(Et?I==="("?I:s:I==="-"||I==="("?"":I)+be,Te=(ee==="s"?$6[8+SU/3]:"")+Te+(Et&&I==="("?")":""),J){for(ke=-1,ut=me.length;++ke<ut;)if(et=me.charCodeAt(ke),48>et||et>57){Te=(et===46?r+me.slice(ke+1):me.slice(ke))+Te,me=me.slice(0,ke);break}}}B&&!k&&(me=e(me,1/0));var bt=be.length+me.length+Te.length,Qt=bt<F?new Array(F-bt+1).join(w):"";switch(B&&k&&(me=e(Qt+me,Qt.length?F-Te.length:1/0),Qt=""),T){case"<":me=be+me+Te+Qt;break;case"=":me=be+Qt+me+Te;break;case"^":me=Qt.slice(0,bt=Qt.length>>1)+be+me+Te+Qt.slice(bt);break;default:me=Qt+be+me+Te;break}return o(me)}return Ce.toString=function(){return v+""},Ce}function y(v,w){var T=p((v=Rw(v),v.type="f",v)),I=Math.max(-8,Math.min(8,Math.floor($m(w)/3)))*3,L=Math.pow(10,-I),k=$6[8+I/3];return function(F){return T(L*F)+k}}return{format:p,formatPrefix:y}}var Gb,x3,CU;Bve({thousands:",",grouping:[3],currency:["$",""]});function Bve(t){return Gb=Fve(t),x3=Gb.format,CU=Gb.formatPrefix,Gb}function zve(t){return Math.max(0,-$m(Math.abs(t)))}function Nve(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor($m(e)/3)))*3-$m(Math.abs(t)))}function Uve(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,$m(e)-$m(t))+1}function AU(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}const w3=t=>()=>t;function Vve(t,e){return function(n){return t+n*e}}function jve(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function $ve(t){return(t=+t)==1?PU:function(e,n){return n-e?jve(e,n,t):w3(isNaN(e)?n:e)}}function PU(t,e){var n=e-t;return n?Vve(t,n):w3(isNaN(t)?e:t)}const G6=function t(e){var n=$ve(e);function i(r,o){var l=n((r=Uh(r)).r,(o=Uh(o)).r),s=n(r.g,o.g),d=n(r.b,o.b),p=PU(r.opacity,o.opacity);return function(y){return r.r=l(y),r.g=s(y),r.b=d(y),r.opacity=p(y),r+""}}return i.gamma=t,i}(1);function Gve(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,i=e.slice(),r;return function(o){for(r=0;r<n;++r)i[r]=t[r]*(1-o)+e[r]*o;return i}}function Hve(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Wve(t,e){var n=e?e.length:0,i=t?Math.min(n,t.length):0,r=new Array(i),o=new Array(n),l;for(l=0;l<i;++l)r[l]=E3(t[l],e[l]);for(;l<n;++l)o[l]=e[l];return function(s){for(l=0;l<i;++l)o[l]=r[l](s);return o}}function Kve(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function Lw(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Xve(t,e){var n={},i={},r;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in t?n[r]=E3(t[r],e[r]):i[r]=e[r];return function(o){for(r in n)i[r]=n[r](o);return i}}var LP=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,fC=new RegExp(LP.source,"g");function Zve(t){return function(){return t}}function qve(t){return function(e){return t(e)+""}}function Yve(t,e){var n=LP.lastIndex=fC.lastIndex=0,i,r,o,l=-1,s=[],d=[];for(t=t+"",e=e+"";(i=LP.exec(t))&&(r=fC.exec(e));)(o=r.index)>n&&(o=e.slice(n,o),s[l]?s[l]+=o:s[++l]=o),(i=i[0])===(r=r[0])?s[l]?s[l]+=r:s[++l]=r:(s[++l]=null,d.push({i:l,x:Lw(i,r)})),n=fC.lastIndex;return n<e.length&&(o=e.slice(n),s[l]?s[l]+=o:s[++l]=o),s.length<2?d[0]?qve(d[0].x):Zve(e):(e=d.length,function(p){for(var y=0,v;y<e;++y)s[(v=d[y]).i]=v.x(p);return s.join("")})}function E3(t,e){var n=typeof e,i;return e==null||n==="boolean"?w3(e):(n==="number"?Lw:n==="string"?(i=ff(e))?(e=i,G6):Yve:e instanceof ff?G6:e instanceof Date?Kve:Hve(e)?Gve:Array.isArray(e)?Wve:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Xve:Lw)(t,e)}function Jve(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function Qve(t){return function(){return t}}function e_e(t){return+t}var H6=[0,1];function Jp(t){return t}function OP(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:Qve(isNaN(e)?NaN:.5)}function t_e(t,e){var n;return t>e&&(n=t,t=e,e=n),function(i){return Math.max(t,Math.min(e,i))}}function n_e(t,e,n){var i=t[0],r=t[1],o=e[0],l=e[1];return r<i?(i=OP(r,i),o=n(l,o)):(i=OP(i,r),o=n(o,l)),function(s){return o(i(s))}}function i_e(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),o=new Array(i),l=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++l<i;)r[l]=OP(t[l],t[l+1]),o[l]=n(e[l],e[l+1]);return function(s){var d=tge(t,s,1,i)-1;return o[d](r[d](s))}}function IU(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function r_e(){var t=H6,e=H6,n=E3,i,r,o,l=Jp,s,d,p;function y(){var w=Math.min(t.length,e.length);return l!==Jp&&(l=t_e(t[0],t[w-1])),s=w>2?i_e:n_e,d=p=null,v}function v(w){return w==null||isNaN(w=+w)?o:(d||(d=s(t.map(i),e,n)))(i(l(w)))}return v.invert=function(w){return l(r((p||(p=s(e,t.map(i),Lw)))(w)))},v.domain=function(w){return arguments.length?(t=Array.from(w,e_e),y()):t.slice()},v.range=function(w){return arguments.length?(e=Array.from(w),y()):e.slice()},v.rangeRound=function(w){return e=Array.from(w),n=Jve,y()},v.clamp=function(w){return arguments.length?(l=w?!0:Jp,y()):l!==Jp},v.interpolate=function(w){return arguments.length?(n=w,y()):n},v.unknown=function(w){return arguments.length?(o=w,v):o},function(w,T){return i=w,r=T,y()}}function MU(){return r_e()(Jp,Jp)}function o_e(t,e,n,i){var r=bP(t,e,n),o;switch(i=Rw(i??",f"),i.type){case"s":{var l=Math.max(Math.abs(t),Math.abs(e));return i.precision==null&&!isNaN(o=Nve(r,l))&&(i.precision=o),CU(i,l)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(o=Uve(r,Math.max(Math.abs(t),Math.abs(e))))&&(i.precision=o-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(o=zve(r))&&(i.precision=o-(i.type==="%")*2);break}}return x3(i)}function s_e(t){var e=t.domain;return t.ticks=function(n){var i=e();return nge(i[0],i[i.length-1],n??10)},t.tickFormat=function(n,i){var r=e();return o_e(r[0],r[r.length-1],n??10,i)},t.nice=function(n){n==null&&(n=10);var i=e(),r=0,o=i.length-1,l=i[r],s=i[o],d,p,y=10;for(s<l&&(p=l,l=s,s=p,p=r,r=o,o=p);y-- >0;){if(p=Q7(l,s,n),p===d)return i[r]=l,i[o]=s,e(i);if(p>0)l=Math.floor(l/p)*p,s=Math.ceil(s/p)*p;else if(p<0)l=Math.ceil(l*p)/p,s=Math.floor(s*p)/p;else break;d=p}return t},t}function jc(){var t=MU();return t.copy=function(){return IU(t,jc())},AU.apply(t,arguments),s_e(t)}function a_e(t,e){t=t.slice();var n=0,i=t.length-1,r=t[n],o=t[i],l;return o<r&&(l=n,n=i,i=l,l=r,r=o,o=l),t[n]=e.floor(r),t[i]=e.ceil(o),t}var pC=new Date,mC=new Date;function ks(t,e,n,i){function r(o){return t(o=arguments.length===0?new Date:new Date(+o)),o}return r.floor=function(o){return t(o=new Date(+o)),o},r.ceil=function(o){return t(o=new Date(o-1)),e(o,1),t(o),o},r.round=function(o){var l=r(o),s=r.ceil(o);return o-l<s-o?l:s},r.offset=function(o,l){return e(o=new Date(+o),l==null?1:Math.floor(l)),o},r.range=function(o,l,s){var d=[],p;if(o=r.ceil(o),s=s==null?1:Math.floor(s),!(o<l)||!(s>0))return d;do d.push(p=new Date(+o)),e(o,s),t(o);while(p<o&&o<l);return d},r.filter=function(o){return ks(function(l){if(l>=l)for(;t(l),!o(l);)l.setTime(l-1)},function(l,s){if(l>=l)if(s<0)for(;++s<=0;)for(;e(l,-1),!o(l););else for(;--s>=0;)for(;e(l,1),!o(l););})},n&&(r.count=function(o,l){return pC.setTime(+o),mC.setTime(+l),t(pC),t(mC),Math.floor(n(pC,mC))},r.every=function(o){return o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?r.filter(i?function(l){return i(l)%o===0}:function(l){return r.count(0,l)%o===0}):r}),r}var Ow=ks(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});Ow.every=function(t){return t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?ks(function(e){e.setTime(Math.floor(e/t)*t)},function(e,n){e.setTime(+e+n*t)},function(e,n){return(n-e)/t}):Ow};const l_e=Ow;Ow.range;const $c=1e3,sc=$c*60,Hd=sc*60,mf=Hd*24,T3=mf*7,W6=mf*30,gC=mf*365;var RU=ks(function(t){t.setTime(t-t.getMilliseconds())},function(t,e){t.setTime(+t+e*$c)},function(t,e){return(e-t)/$c},function(t){return t.getUTCSeconds()});const a0=RU;RU.range;var LU=ks(function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*$c)},function(t,e){t.setTime(+t+e*sc)},function(t,e){return(e-t)/sc},function(t){return t.getMinutes()});const OU=LU;LU.range;var DU=ks(function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*$c-t.getMinutes()*sc)},function(t,e){t.setTime(+t+e*Hd)},function(t,e){return(e-t)/Hd},function(t){return t.getHours()});const kU=DU;DU.range;var FU=ks(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*sc)/mf,t=>t.getDate()-1);const W2=FU;FU.range;function Cf(t){return ks(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(e,n){e.setDate(e.getDate()+n*7)},function(e,n){return(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*sc)/T3})}var R_=Cf(0),Dw=Cf(1),c_e=Cf(2),u_e=Cf(3),Gm=Cf(4),h_e=Cf(5),d_e=Cf(6);R_.range;Dw.range;c_e.range;u_e.range;Gm.range;h_e.range;d_e.range;var BU=ks(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12},function(t){return t.getMonth()});const zU=BU;BU.range;var S3=ks(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});S3.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:ks(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)})};const Vh=S3;S3.range;var NU=ks(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/mf},function(t){return t.getUTCDate()-1});const UU=NU;NU.range;function Af(t){return ks(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCDate(e.getUTCDate()+n*7)},function(e,n){return(n-e)/T3})}var VU=Af(0),kw=Af(1),f_e=Af(2),p_e=Af(3),Hm=Af(4),m_e=Af(5),g_e=Af(6);VU.range;kw.range;f_e.range;p_e.range;Hm.range;m_e.range;g_e.range;var C3=ks(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});C3.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:ks(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})};const Mv=C3;C3.range;function y_e(t,e,n,i,r,o){const l=[[a0,1,$c],[a0,5,5*$c],[a0,15,15*$c],[a0,30,30*$c],[o,1,sc],[o,5,5*sc],[o,15,15*sc],[o,30,30*sc],[r,1,Hd],[r,3,3*Hd],[r,6,6*Hd],[r,12,12*Hd],[i,1,mf],[i,2,2*mf],[n,1,T3],[e,1,W6],[e,3,3*W6],[t,1,gC]];function s(p,y,v){const w=y<p;w&&([p,y]=[y,p]);const T=v&&typeof v.range=="function"?v:d(p,y,v),I=T?T.range(p,+y+1):[];return w?I.reverse():I}function d(p,y,v){const w=Math.abs(y-p)/v,T=u3(([,,k])=>k).right(l,w);if(T===l.length)return t.every(bP(p/gC,y/gC,v));if(T===0)return l_e.every(Math.max(bP(p,y,v),1));const[I,L]=l[w/l[T-1][2]<l[T][2]/w?T-1:T];return I.every(L)}return[s,d]}const[v_e,__e]=y_e(Vh,zU,R_,W2,kU,OU);function yC(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function vC(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function zy(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function b_e(t){var e=t.dateTime,n=t.date,i=t.time,r=t.periods,o=t.days,l=t.shortDays,s=t.months,d=t.shortMonths,p=Ny(r),y=Uy(r),v=Ny(o),w=Uy(o),T=Ny(l),I=Uy(l),L=Ny(s),k=Uy(s),F=Ny(d),B=Uy(d),G={a:Et,A:bt,b:Qt,B:cn,c:null,d:J6,e:J6,f:$_e,g:Q_e,G:t1e,H:U_e,I:V_e,j:j_e,L:jU,m:G_e,M:H_e,p:pn,q:xn,Q:tF,s:nF,S:W_e,u:K_e,U:X_e,V:Z_e,w:q_e,W:Y_e,x:null,X:null,y:J_e,Y:e1e,Z:n1e,"%":eF},U={a:An,A:kn,b:Bn,B:Nt,c:null,d:Q6,e:Q6,f:s1e,g:g1e,G:v1e,H:i1e,I:r1e,j:o1e,L:GU,m:a1e,M:l1e,p:We,q:kt,Q:tF,s:nF,S:c1e,u:u1e,U:h1e,V:d1e,w:f1e,W:p1e,x:null,X:null,y:m1e,Y:y1e,Z:_1e,"%":eF},ee={a:Ce,A:me,b:be,B:Te,c:ke,d:q6,e:q6,f:F_e,g:Z6,G:X6,H:Y6,I:Y6,j:L_e,L:k_e,m:R_e,M:O_e,p:J,q:M_e,Q:z_e,s:N_e,S:D_e,u:S_e,U:C_e,V:A_e,w:T_e,W:P_e,x:ut,X:et,y:Z6,Y:X6,Z:I_e,"%":B_e};G.x=ne(n,G),G.X=ne(i,G),G.c=ne(e,G),U.x=ne(n,U),U.X=ne(i,U),U.c=ne(e,U);function ne(Ke,ht){return function(Pt){var ae=[],Ae=-1,je=0,tt=Ke.length,pt,Tt,tn;for(Pt instanceof Date||(Pt=new Date(+Pt));++Ae<tt;)Ke.charCodeAt(Ae)===37&&(ae.push(Ke.slice(je,Ae)),(Tt=K6[pt=Ke.charAt(++Ae)])!=null?pt=Ke.charAt(++Ae):Tt=pt==="e"?" ":"0",(tn=ht[pt])&&(pt=tn(Pt,Tt)),ae.push(pt),je=Ae+1);return ae.push(Ke.slice(je,Ae)),ae.join("")}}function ye(Ke,ht){return function(Pt){var ae=zy(1900,void 0,1),Ae=fe(ae,Ke,Pt+="",0),je,tt;if(Ae!=Pt.length)return null;if("Q"in ae)return new Date(ae.Q);if("s"in ae)return new Date(ae.s*1e3+("L"in ae?ae.L:0));if(ht&&!("Z"in ae)&&(ae.Z=0),"p"in ae&&(ae.H=ae.H%12+ae.p*12),ae.m===void 0&&(ae.m="q"in ae?ae.q:0),"V"in ae){if(ae.V<1||ae.V>53)return null;"w"in ae||(ae.w=1),"Z"in ae?(je=vC(zy(ae.y,0,1)),tt=je.getUTCDay(),je=tt>4||tt===0?kw.ceil(je):kw(je),je=UU.offset(je,(ae.V-1)*7),ae.y=je.getUTCFullYear(),ae.m=je.getUTCMonth(),ae.d=je.getUTCDate()+(ae.w+6)%7):(je=yC(zy(ae.y,0,1)),tt=je.getDay(),je=tt>4||tt===0?Dw.ceil(je):Dw(je),je=W2.offset(je,(ae.V-1)*7),ae.y=je.getFullYear(),ae.m=je.getMonth(),ae.d=je.getDate()+(ae.w+6)%7)}else("W"in ae||"U"in ae)&&("w"in ae||(ae.w="u"in ae?ae.u%7:"W"in ae?1:0),tt="Z"in ae?vC(zy(ae.y,0,1)).getUTCDay():yC(zy(ae.y,0,1)).getDay(),ae.m=0,ae.d="W"in ae?(ae.w+6)%7+ae.W*7-(tt+5)%7:ae.w+ae.U*7-(tt+6)%7);return"Z"in ae?(ae.H+=ae.Z/100|0,ae.M+=ae.Z%100,vC(ae)):yC(ae)}}function fe(Ke,ht,Pt,ae){for(var Ae=0,je=ht.length,tt=Pt.length,pt,Tt;Ae<je;){if(ae>=tt)return-1;if(pt=ht.charCodeAt(Ae++),pt===37){if(pt=ht.charAt(Ae++),Tt=ee[pt in K6?ht.charAt(Ae++):pt],!Tt||(ae=Tt(Ke,Pt,ae))<0)return-1}else if(pt!=Pt.charCodeAt(ae++))return-1}return ae}function J(Ke,ht,Pt){var ae=p.exec(ht.slice(Pt));return ae?(Ke.p=y.get(ae[0].toLowerCase()),Pt+ae[0].length):-1}function Ce(Ke,ht,Pt){var ae=T.exec(ht.slice(Pt));return ae?(Ke.w=I.get(ae[0].toLowerCase()),Pt+ae[0].length):-1}function me(Ke,ht,Pt){var ae=v.exec(ht.slice(Pt));return ae?(Ke.w=w.get(ae[0].toLowerCase()),Pt+ae[0].length):-1}function be(Ke,ht,Pt){var ae=F.exec(ht.slice(Pt));return ae?(Ke.m=B.get(ae[0].toLowerCase()),Pt+ae[0].length):-1}function Te(Ke,ht,Pt){var ae=L.exec(ht.slice(Pt));return ae?(Ke.m=k.get(ae[0].toLowerCase()),Pt+ae[0].length):-1}function ke(Ke,ht,Pt){return fe(Ke,e,ht,Pt)}function ut(Ke,ht,Pt){return fe(Ke,n,ht,Pt)}function et(Ke,ht,Pt){return fe(Ke,i,ht,Pt)}function Et(Ke){return l[Ke.getDay()]}function bt(Ke){return o[Ke.getDay()]}function Qt(Ke){return d[Ke.getMonth()]}function cn(Ke){return s[Ke.getMonth()]}function pn(Ke){return r[+(Ke.getHours()>=12)]}function xn(Ke){return 1+~~(Ke.getMonth()/3)}function An(Ke){return l[Ke.getUTCDay()]}function kn(Ke){return o[Ke.getUTCDay()]}function Bn(Ke){return d[Ke.getUTCMonth()]}function Nt(Ke){return s[Ke.getUTCMonth()]}function We(Ke){return r[+(Ke.getUTCHours()>=12)]}function kt(Ke){return 1+~~(Ke.getUTCMonth()/3)}return{format:function(Ke){var ht=ne(Ke+="",G);return ht.toString=function(){return Ke},ht},parse:function(Ke){var ht=ye(Ke+="",!1);return ht.toString=function(){return Ke},ht},utcFormat:function(Ke){var ht=ne(Ke+="",U);return ht.toString=function(){return Ke},ht},utcParse:function(Ke){var ht=ye(Ke+="",!0);return ht.toString=function(){return Ke},ht}}}var K6={"-":"",_:" ",0:"0"},Wo=/^\s*\d+/,x_e=/^%/,w_e=/[\\^$*+?|[\]().{}]/g;function Qi(t,e,n){var i=t<0?"-":"",r=(i?-t:t)+"",o=r.length;return i+(o<n?new Array(n-o+1).join(e)+r:r)}function E_e(t){return t.replace(w_e,"\\$&")}function Ny(t){return new RegExp("^(?:"+t.map(E_e).join("|")+")","i")}function Uy(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function T_e(t,e,n){var i=Wo.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function S_e(t,e,n){var i=Wo.exec(e.slice(n,n+1));return i?(t.u=+i[0],n+i[0].length):-1}function C_e(t,e,n){var i=Wo.exec(e.slice(n,n+2));return i?(t.U=+i[0],n+i[0].length):-1}function A_e(t,e,n){var i=Wo.exec(e.slice(n,n+2));return i?(t.V=+i[0],n+i[0].length):-1}function P_e(t,e,n){var i=Wo.exec(e.slice(n,n+2));return i?(t.W=+i[0],n+i[0].length):-1}function X6(t,e,n){var i=Wo.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function Z6(t,e,n){var i=Wo.exec(e.slice(n,n+2));return i?(t.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function I_e(t,e,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return i?(t.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function M_e(t,e,n){var i=Wo.exec(e.slice(n,n+1));return i?(t.q=i[0]*3-3,n+i[0].length):-1}function R_e(t,e,n){var i=Wo.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function q6(t,e,n){var i=Wo.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function L_e(t,e,n){var i=Wo.exec(e.slice(n,n+3));return i?(t.m=0,t.d=+i[0],n+i[0].length):-1}function Y6(t,e,n){var i=Wo.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function O_e(t,e,n){var i=Wo.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function D_e(t,e,n){var i=Wo.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function k_e(t,e,n){var i=Wo.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function F_e(t,e,n){var i=Wo.exec(e.slice(n,n+6));return i?(t.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function B_e(t,e,n){var i=x_e.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function z_e(t,e,n){var i=Wo.exec(e.slice(n));return i?(t.Q=+i[0],n+i[0].length):-1}function N_e(t,e,n){var i=Wo.exec(e.slice(n));return i?(t.s=+i[0],n+i[0].length):-1}function J6(t,e){return Qi(t.getDate(),e,2)}function U_e(t,e){return Qi(t.getHours(),e,2)}function V_e(t,e){return Qi(t.getHours()%12||12,e,2)}function j_e(t,e){return Qi(1+W2.count(Vh(t),t),e,3)}function jU(t,e){return Qi(t.getMilliseconds(),e,3)}function $_e(t,e){return jU(t,e)+"000"}function G_e(t,e){return Qi(t.getMonth()+1,e,2)}function H_e(t,e){return Qi(t.getMinutes(),e,2)}function W_e(t,e){return Qi(t.getSeconds(),e,2)}function K_e(t){var e=t.getDay();return e===0?7:e}function X_e(t,e){return Qi(R_.count(Vh(t)-1,t),e,2)}function $U(t){var e=t.getDay();return e>=4||e===0?Gm(t):Gm.ceil(t)}function Z_e(t,e){return t=$U(t),Qi(Gm.count(Vh(t),t)+(Vh(t).getDay()===4),e,2)}function q_e(t){return t.getDay()}function Y_e(t,e){return Qi(Dw.count(Vh(t)-1,t),e,2)}function J_e(t,e){return Qi(t.getFullYear()%100,e,2)}function Q_e(t,e){return t=$U(t),Qi(t.getFullYear()%100,e,2)}function e1e(t,e){return Qi(t.getFullYear()%1e4,e,4)}function t1e(t,e){var n=t.getDay();return t=n>=4||n===0?Gm(t):Gm.ceil(t),Qi(t.getFullYear()%1e4,e,4)}function n1e(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Qi(e/60|0,"0",2)+Qi(e%60,"0",2)}function Q6(t,e){return Qi(t.getUTCDate(),e,2)}function i1e(t,e){return Qi(t.getUTCHours(),e,2)}function r1e(t,e){return Qi(t.getUTCHours()%12||12,e,2)}function o1e(t,e){return Qi(1+UU.count(Mv(t),t),e,3)}function GU(t,e){return Qi(t.getUTCMilliseconds(),e,3)}function s1e(t,e){return GU(t,e)+"000"}function a1e(t,e){return Qi(t.getUTCMonth()+1,e,2)}function l1e(t,e){return Qi(t.getUTCMinutes(),e,2)}function c1e(t,e){return Qi(t.getUTCSeconds(),e,2)}function u1e(t){var e=t.getUTCDay();return e===0?7:e}function h1e(t,e){return Qi(VU.count(Mv(t)-1,t),e,2)}function HU(t){var e=t.getUTCDay();return e>=4||e===0?Hm(t):Hm.ceil(t)}function d1e(t,e){return t=HU(t),Qi(Hm.count(Mv(t),t)+(Mv(t).getUTCDay()===4),e,2)}function f1e(t){return t.getUTCDay()}function p1e(t,e){return Qi(kw.count(Mv(t)-1,t),e,2)}function m1e(t,e){return Qi(t.getUTCFullYear()%100,e,2)}function g1e(t,e){return t=HU(t),Qi(t.getUTCFullYear()%100,e,2)}function y1e(t,e){return Qi(t.getUTCFullYear()%1e4,e,4)}function v1e(t,e){var n=t.getUTCDay();return t=n>=4||n===0?Hm(t):Hm.ceil(t),Qi(t.getUTCFullYear()%1e4,e,4)}function _1e(){return"+0000"}function eF(){return"%"}function tF(t){return+t}function nF(t){return Math.floor(+t/1e3)}var kp,WU;b1e({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function b1e(t){return kp=b_e(t),WU=kp.format,kp.parse,kp.utcFormat,kp.utcParse,kp}function x1e(t){return new Date(t)}function w1e(t){return t instanceof Date?+t:+new Date(+t)}function KU(t,e,n,i,r,o,l,s,d,p){var y=MU(),v=y.invert,w=y.domain,T=p(".%L"),I=p(":%S"),L=p("%I:%M"),k=p("%I %p"),F=p("%a %d"),B=p("%b %d"),G=p("%B"),U=p("%Y");function ee(ne){return(d(ne)<ne?T:s(ne)<ne?I:l(ne)<ne?L:o(ne)<ne?k:i(ne)<ne?r(ne)<ne?F:B:n(ne)<ne?G:U)(ne)}return y.invert=function(ne){return new Date(v(ne))},y.domain=function(ne){return arguments.length?w(Array.from(ne,w1e)):w().map(x1e)},y.ticks=function(ne){var ye=w();return t(ye[0],ye[ye.length-1],ne??10)},y.tickFormat=function(ne,ye){return ye==null?ee:p(ye)},y.nice=function(ne){var ye=w();return(!ne||typeof ne.range!="function")&&(ne=e(ye[0],ye[ye.length-1],ne??10)),ne?w(a_e(ye,ne)):y},y.copy=function(){return IU(y,KU(t,e,n,i,r,o,l,s,d,p))},y}function Qd(){return AU.apply(KU(v_e,__e,Vh,zU,R_,W2,kU,OU,a0,WU).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function XU(t){for(var e=t.length/6|0,n=new Array(e),i=0;i<e;)n[i]="#"+t.slice(i*6,++i*6);return n}function E1e(t,e,n,i,r){var o=t*t,l=o*t;return((1-3*t+3*o-l)*e+(4-6*o+3*l)*n+(1+3*t+3*o-3*l)*i+l*r)/6}function T1e(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],o=t[i+1],l=i>0?t[i-1]:2*r-o,s=i<e-1?t[i+2]:2*o-r;return E1e((n-i/e)*e,l,r,o,s)}}const ZU=t=>()=>t;function S1e(t,e){return function(n){return t+n*e}}function C1e(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function A1e(t){return(t=+t)==1?qU:function(e,n){return n-e?C1e(e,n,t):ZU(isNaN(e)?n:e)}}function qU(t,e){var n=e-t;return n?S1e(t,n):ZU(isNaN(t)?e:t)}(function t(e){var n=A1e(e);function i(r,o){var l=n((r=Uh(r)).r,(o=Uh(o)).r),s=n(r.g,o.g),d=n(r.b,o.b),p=qU(r.opacity,o.opacity);return function(y){return r.r=l(y),r.g=s(y),r.b=d(y),r.opacity=p(y),r+""}}return i.gamma=t,i})(1);function P1e(t){return function(e){var n=e.length,i=new Array(n),r=new Array(n),o=new Array(n),l,s;for(l=0;l<n;++l)s=Uh(e[l]),i[l]=s.r||0,r[l]=s.g||0,o[l]=s.b||0;return i=t(i),r=t(r),o=t(o),s.opacity=1,function(d){return s.r=i(d),s.g=r(d),s.b=o(d),s+""}}}var I1e=P1e(T1e);const YU=t=>I1e(t[t.length-1]);var M1e=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(XU);const R1e=YU(M1e);var L1e=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(XU);const DP=YU(L1e);function oh(t){return function(){return t}}var iF=Math.abs,us=Math.atan2,Md=Math.cos,O1e=Math.max,_C=Math.min,Zl=Math.sin,Qp=Math.sqrt,Ws=1e-12,Rv=Math.PI,Fw=Rv/2,D1e=2*Rv;function k1e(t){return t>1?0:t<-1?Rv:Math.acos(t)}function rF(t){return t>=1?Fw:t<=-1?-Fw:Math.asin(t)}function F1e(t){return t.innerRadius}function B1e(t){return t.outerRadius}function z1e(t){return t.startAngle}function N1e(t){return t.endAngle}function U1e(t){return t&&t.padAngle}function V1e(t,e,n,i,r,o,l,s){var d=n-t,p=i-e,y=l-r,v=s-o,w=v*d-y*p;if(!(w*w<Ws))return w=(y*(e-o)-v*(t-r))/w,[t+w*d,e+w*p]}function Hb(t,e,n,i,r,o,l){var s=t-n,d=e-i,p=(l?o:-o)/Qp(s*s+d*d),y=p*d,v=-p*s,w=t+y,T=e+v,I=n+y,L=i+v,k=(w+I)/2,F=(T+L)/2,B=I-w,G=L-T,U=B*B+G*G,ee=r-o,ne=w*L-I*T,ye=(G<0?-1:1)*Qp(O1e(0,ee*ee*U-ne*ne)),fe=(ne*G-B*ye)/U,J=(-ne*B-G*ye)/U,Ce=(ne*G+B*ye)/U,me=(-ne*B+G*ye)/U,be=fe-k,Te=J-F,ke=Ce-k,ut=me-F;return be*be+Te*Te>ke*ke+ut*ut&&(fe=Ce,J=me),{cx:fe,cy:J,x01:-y,y01:-v,x11:fe*(r/ee-1),y11:J*(r/ee-1)}}function j1e(){var t=F1e,e=B1e,n=oh(0),i=null,r=z1e,o=N1e,l=U1e,s=null;function d(){var p,y,v=+t.apply(this,arguments),w=+e.apply(this,arguments),T=r.apply(this,arguments)-Fw,I=o.apply(this,arguments)-Fw,L=iF(I-T),k=I>T;if(s||(s=p=TU()),w<v&&(y=w,w=v,v=y),!(w>Ws))s.moveTo(0,0);else if(L>D1e-Ws)s.moveTo(w*Md(T),w*Zl(T)),s.arc(0,0,w,T,I,!k),v>Ws&&(s.moveTo(v*Md(I),v*Zl(I)),s.arc(0,0,v,I,T,k));else{var F=T,B=I,G=T,U=I,ee=L,ne=L,ye=l.apply(this,arguments)/2,fe=ye>Ws&&(i?+i.apply(this,arguments):Qp(v*v+w*w)),J=_C(iF(w-v)/2,+n.apply(this,arguments)),Ce=J,me=J,be,Te;if(fe>Ws){var ke=rF(fe/v*Zl(ye)),ut=rF(fe/w*Zl(ye));(ee-=ke*2)>Ws?(ke*=k?1:-1,G+=ke,U-=ke):(ee=0,G=U=(T+I)/2),(ne-=ut*2)>Ws?(ut*=k?1:-1,F+=ut,B-=ut):(ne=0,F=B=(T+I)/2)}var et=w*Md(F),Et=w*Zl(F),bt=v*Md(U),Qt=v*Zl(U);if(J>Ws){var cn=w*Md(B),pn=w*Zl(B),xn=v*Md(G),An=v*Zl(G),kn;if(L<Rv&&(kn=V1e(et,Et,xn,An,cn,pn,bt,Qt))){var Bn=et-kn[0],Nt=Et-kn[1],We=cn-kn[0],kt=pn-kn[1],Ke=1/Zl(k1e((Bn*We+Nt*kt)/(Qp(Bn*Bn+Nt*Nt)*Qp(We*We+kt*kt)))/2),ht=Qp(kn[0]*kn[0]+kn[1]*kn[1]);Ce=_C(J,(v-ht)/(Ke-1)),me=_C(J,(w-ht)/(Ke+1))}}ne>Ws?me>Ws?(be=Hb(xn,An,et,Et,w,me,k),Te=Hb(cn,pn,bt,Qt,w,me,k),s.moveTo(be.cx+be.x01,be.cy+be.y01),me<J?s.arc(be.cx,be.cy,me,us(be.y01,be.x01),us(Te.y01,Te.x01),!k):(s.arc(be.cx,be.cy,me,us(be.y01,be.x01),us(be.y11,be.x11),!k),s.arc(0,0,w,us(be.cy+be.y11,be.cx+be.x11),us(Te.cy+Te.y11,Te.cx+Te.x11),!k),s.arc(Te.cx,Te.cy,me,us(Te.y11,Te.x11),us(Te.y01,Te.x01),!k))):(s.moveTo(et,Et),s.arc(0,0,w,F,B,!k)):s.moveTo(et,Et),!(v>Ws)||!(ee>Ws)?s.lineTo(bt,Qt):Ce>Ws?(be=Hb(bt,Qt,cn,pn,v,-Ce,k),Te=Hb(et,Et,xn,An,v,-Ce,k),s.lineTo(be.cx+be.x01,be.cy+be.y01),Ce<J?s.arc(be.cx,be.cy,Ce,us(be.y01,be.x01),us(Te.y01,Te.x01),!k):(s.arc(be.cx,be.cy,Ce,us(be.y01,be.x01),us(be.y11,be.x11),!k),s.arc(0,0,v,us(be.cy+be.y11,be.cx+be.x11),us(Te.cy+Te.y11,Te.cx+Te.x11),k),s.arc(Te.cx,Te.cy,Ce,us(Te.y11,Te.x11),us(Te.y01,Te.x01),!k))):s.arc(0,0,v,U,G,k)}if(s.closePath(),p)return s=null,p+""||null}return d.centroid=function(){var p=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,y=(+r.apply(this,arguments)+ +o.apply(this,arguments))/2-Rv/2;return[Md(y)*p,Zl(y)*p]},d.innerRadius=function(p){return arguments.length?(t=typeof p=="function"?p:oh(+p),d):t},d.outerRadius=function(p){return arguments.length?(e=typeof p=="function"?p:oh(+p),d):e},d.cornerRadius=function(p){return arguments.length?(n=typeof p=="function"?p:oh(+p),d):n},d.padRadius=function(p){return arguments.length?(i=p==null?null:typeof p=="function"?p:oh(+p),d):i},d.startAngle=function(p){return arguments.length?(r=typeof p=="function"?p:oh(+p),d):r},d.endAngle=function(p){return arguments.length?(o=typeof p=="function"?p:oh(+p),d):o},d.padAngle=function(p){return arguments.length?(l=typeof p=="function"?p:oh(+p),d):l},d.context=function(p){return arguments.length?(s=p??null,d):s},d}function l0(t,e,n){this.k=t,this.x=e,this.y=n}l0.prototype={constructor:l0,scale:function(t){return t===1?this:new l0(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new l0(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};l0.prototype;const $1e={class:"deck-container"},G1e=["id"],H1e={id:"button-slider",class:"button-slider"},W1e=null,K1e=pr({__name:"DeckGLController",emits:["click"],setup(t,{emit:e}){const n=Xa(),i=s_();let r=null;const o=e,l=$r(mu),s=$r(ng),d=$r(U2);console.log("PRINTING injects in DeckGLSingleFire mapParams, mapSizeUpdate, mapMode",l,s,d);let p=!1,y={},v,w=null;const T=$n(0);let I={};const L=$n(!1);let k=null,F=null;const B=$n(!1);let G=$n(null),U=$n("pi-play"),ee=null,ne=null;const ye=$n(!1);let fe=null;const J=$n(!1),Ce=$n(!1),me=$n("");let be=`deck-canvas-${l.mapType}-${l.mapID}`,Te={...rpe,canvas:be};Ds(()=>{Ce.value=!!(l!=null&&l.SM),r=new ZM({onViewStateChange:({viewState:ht})=>Et(ht),...Te,...i,useDevicePixels:!1,onClick:(ht,Pt)=>{Pt.type=="click"&&Pt.rightButton&&(fe=ht.coordinate),ht.picked&&ht.layer.id.includes("Icons")&&(B.value=!1,Ys(()=>{G.value=ht.layer.props,B.value=!0}),Ys(()=>{ut()})),o("click",{info:ht,event:Pt})}});let We=$r(V2);ne=qme(We,l,W1e,n.getLayerList(l.mapID,l.mapType)),ye.value=!0,[k,F]=ne.getTimeScales(),L.value=!0;const kt=n.findActiveIDX(l.mapID,l.mapType);let Ke=n.deckGLMapState[kt]._data;Ri(()=>Ke.layerList,ht=>{v=ht,w=ne.getAllLayerProps(ht,T.value,I,d,B,J,r),console.log("LayerList Changed"),ut()},{immediate:!0,deep:!0}),Ri(()=>Ke.annotations,ht=>{y=new spe(l.mapID,F).getProps(ht),console.log("Annotations Changed",y);let ae=Object.keys(ne.animatedProps).reduce(function(Ae,je){return ne.animatedProps[je].id.startsWith("Icon")||(Ae[je]=ne.animatedProps[je]),Ae},{});ne.animatedProps={...ae,...y},Object.keys(y).length,ut()},{immediate:!0,deep:!0}),Ri(T,ht=>{Ke.currentTime=k(ht).getTime()}),Ys(()=>{Ri(s,()=>{ke()},{immediate:!0})}),Ri(()=>Ke.currentTime,ht=>{ht!=null&&(T.value=F(ht),me.value=`${ne.formatTimeString(new Date(ht))}`,ut())},{immediate:!0}),Ri(n.deckGLMapState[kt]._viewState,ht=>{Et(ht)}),d=="Editing"&&r.canvas.addEventListener("contextmenu",ht=>ht.preventDefault()),Et(ne.getInitialViewState())});function ke(){let We=document.getElementById(`timeSlider-${l.mapType}-${l.mapID}`),kt=document.getElementById("button-slider"),Ke=We==null?void 0:We.clientWidth,ht=kt==null?void 0:kt.clientHeight;ee&&Nh(`#timeSliderSVG-${l.mapType}-${l.mapID}`).remove(),ee=Nh(`#timeSlider-${l.mapType}-${l.mapID}`).append("svg").attr("id",`timeSliderSVG-${l.mapType}-${l.mapID}`).attr("viewBox",[0,0,Ke,ht]).attr("width",Ke).attr("height",ht).attr("class","axis").attr("transform",`translate(0, ${ht/10})`);let[Pt,ae,Ae]=ne.getTimeSliderScaleParams();ee.append("g").call(uge(Pt.range([0,Ke])).ticks(ae,Ae)),lC(".axis line").style("stroke","black"),lC(".axis text").style("stroke","black").style("fill","black").style("font-size","0.75rem"),lC(".axis path").style("stroke","black")}function ut(){w=ne.getAllLayerProps(v,T.value,I,d,B,J,r),w=ne.handleSettings(I,w,B,G),r.setProps({layers:[...w]})}function et(){p&&(T.value=(T.value+6e-4)%1,ut(),requestAnimationFrame(et))}function Et(We){r.setProps({viewState:{...We}}),n.changeViewState(We,l.mapID,l.mapType)}function bt(){U.value=p?"pi-play":"pi-pause",p=!p,et()}const Qt=()=>{B.value=!1},cn=We=>{const kt=n.deckGLMapState.findIndex(ht=>ht._metaData.id==l.mapID&&ht._metaData.active);let Ke=n.deckGLMapState[kt]._data;Ke.layerList=Ke.layerList.map(ht=>We.includes(ht.name)?{...ht,visibility:!0}:{...ht,visibility:!1})};function pn(We){I={...I,...We},ut(),console.log("setting changed",We)}function xn(We){return ne.formatTimeString(k(We))}function An(){ut()}const kn=$n(),Bn=$n([{label:"Add annotation",icon:"pi pi-fw pi-plus",command:()=>{addAnnotation(fe)}}]),Nt=We=>{d=="Editing"&&kn.value.show(We)};return(We,kt)=>(le(),Ue("div",$1e,[B.value?(le(),Rt(Zme,{key:0,"annotation-panel-props":Yt(G),onCloseAnnotationPanel:Qt,onHighlightLayers:cn},null,8,["annotation-panel-props"])):Jt("",!0),!Ce.value&&ye.value?(le(),Rt(Nme,{key:1,settings:Yt(ne).getInfoPanelSettings(),onSettingsChanged:pn},null,8,["settings"])):Jt("",!0),Xn(We.$slots,"default",{},void 0,!0),Qe("div",null,[Qe("canvas",{id:`deck-canvas-${Yt(l).mapType}-${Yt(l).mapID}`,class:"deck-canvas-single-fire",onContextmenu:Nt},null,40,G1e),Yt(d)=="Editing"?(le(),Rt(Yt(X7),{key:0,ref_key:"menu",ref:kn,model:Bn.value},null,8,["model"])):Jt("",!0)]),fo(Qe("div",H1e,[Lt(Yt(zh),{icon:`pi ${Yt(U)}`,class:"rounded-full",onClick:kt[0]||(kt[0]=Ke=>bt())},null,8,["icon"]),L.value?(le(),Rt(Yt(pP),{key:0,id:`timeSlider-${Yt(l).mapType}-${Yt(l).mapID}`,modelValue:T.value,"onUpdate:modelValue":kt[1]||(kt[1]=Ke=>T.value=Ke),class:"slider",min:0,max:1,step:-1,format:xn,onChange:An},null,8,["id","modelValue"])):Jt("",!0)],512),[[l_,!Ce.value]])]))}});const X1e=po(K1e,[["__scopeId","data-v-30155de4"]]);var JU={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(Nz,function(){var n,i,r;function o(s,d){if(!n)n=d;else if(!i)i=d;else{var p="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+n+")(sharedChunk); ("+i+")(sharedChunk); self.onerror = null;",y={};n(y),r=d(y),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(r.workerUrl=window.URL.createObjectURL(new Blob([p],{type:"text/javascript"})))}}o(["exports"],function(s){var d=typeof self<"u"?self:{},p="2.15.0";let y;const v={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(y==null){const c=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{y={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):c}catch{y=c}}return y},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!v.API_URL)return null;try{const c=new URL(v.API_URL);return c.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":c.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},w={supported:!1,testSupport:function(c){!L&&I&&(k?F(c):T=c)}};let T,I,L=!1,k=!1;function F(c){const a=c.createTexture();c.bindTexture(c.TEXTURE_2D,a);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,I),c.isContextLost())return;w.supported=!0}catch{}c.deleteTexture(a),L=!0}d.document&&(I=d.document.createElement("img"),I.onload=function(){T&&F(T),T=null,k=!0},I.onerror=function(){L=!0,T=null},I.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const B="01";function G(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var U=ee;function ee(c,a,u,f){this.cx=3*c,this.bx=3*(u-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(f-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=a,this.p2x=u,this.p2y=f}ee.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,a){if(a===void 0&&(a=1e-6),c<0)return 0;if(c>1)return 1;for(var u=c,f=0;f<8;f++){var g=this.sampleCurveX(u)-c;if(Math.abs(g)<a)return u;var b=this.sampleCurveDerivativeX(u);if(Math.abs(b)<1e-6)break;u-=g/b}var E=0,C=1;for(u=c,f=0;f<20&&(g=this.sampleCurveX(u),!(Math.abs(g-c)<a));f++)c>g?E=u:C=u,u=.5*(C-E)+E;return u},solve:function(c,a){return this.sampleCurveY(this.solveCurveX(c,a))}};var ne=G(U),ye=fe;function fe(c,a){this.x=c,this.y=a}fe.prototype={clone:function(){return new fe(this.x,this.y)},add:function(c){return this.clone()._add(c)},sub:function(c){return this.clone()._sub(c)},multByPoint:function(c){return this.clone()._multByPoint(c)},divByPoint:function(c){return this.clone()._divByPoint(c)},mult:function(c){return this.clone()._mult(c)},div:function(c){return this.clone()._div(c)},rotate:function(c){return this.clone()._rotate(c)},rotateAround:function(c,a){return this.clone()._rotateAround(c,a)},matMult:function(c){return this.clone()._matMult(c)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(c){return this.x===c.x&&this.y===c.y},dist:function(c){return Math.sqrt(this.distSqr(c))},distSqr:function(c){var a=c.x-this.x,u=c.y-this.y;return a*a+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith:function(c){return this.angleWithSep(c.x,c.y)},angleWithSep:function(c,a){return Math.atan2(this.x*a-this.y*c,this.x*c+this.y*a)},_matMult:function(c){var a=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=a,this},_add:function(c){return this.x+=c.x,this.y+=c.y,this},_sub:function(c){return this.x-=c.x,this.y-=c.y,this},_mult:function(c){return this.x*=c,this.y*=c,this},_div:function(c){return this.x/=c,this.y/=c,this},_multByPoint:function(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint:function(c){return this.x/=c.x,this.y/=c.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var c=this.y;return this.y=this.x,this.x=-c,this},_rotate:function(c){var a=Math.cos(c),u=Math.sin(c),f=u*this.x+a*this.y;return this.x=a*this.x-u*this.y,this.y=f,this},_rotateAround:function(c,a){var u=Math.cos(c),f=Math.sin(c),g=a.y+f*(this.x-a.x)+u*(this.y-a.y);return this.x=a.x+u*(this.x-a.x)-f*(this.y-a.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},fe.convert=function(c){return c instanceof fe?c:Array.isArray(c)?new fe(c[0],c[1]):c};var J=G(ye);const Ce=Math.PI/180,me=180/Math.PI;function be(c){return c*Ce}function Te(c){return c*me}const ke=[[0,0],[1,0],[1,1],[0,1]];function ut(c){if(c<=0)return 0;if(c>=1)return 1;const a=c*c,u=a*c;return 4*(c<.5?u:3*(c-a)+u-.75)}function et(c,a,u,f){const g=new ne(c,a,u,f);return function(b){return g.solve(b)}}const Et=et(.25,.1,.25,1);function bt(c,a,u){return Math.min(u,Math.max(a,c))}function Qt(c,a,u){return(u=bt((u-c)/(a-c),0,1))*u*(3-2*u)}function cn(c,a,u){const f=u-a,g=((c-a)%f+f)%f+a;return g===a?u:g}function pn(c,a,u){if(!c.length)return u(null,[]);let f=c.length;const g=new Array(c.length);let b=null;c.forEach((E,C)=>{a(E,(P,M)=>{P&&(b=P),g[C]=M,--f==0&&u(b,g)})})}function xn(c){const a=[];for(const u in c)a.push(c[u]);return a}function An(c,...a){for(const u of a)for(const f in u)c[f]=u[f];return c}let kn=1;function Bn(){return kn++}function Nt(){return function c(a){return a?(a^Math.random()*(16>>a/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,c)}()}function We(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))}function kt(c){return!!c&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(c)}function Ke(c,a){c.forEach(u=>{a[u]&&(a[u]=a[u].bind(a))})}function ht(c,a){return c.indexOf(a,c.length-a.length)!==-1}function Pt(c,a,u){const f={};for(const g in c)f[g]=a.call(u||this,c[g],g,c);return f}function ae(c,a,u){const f={};for(const g in c)a.call(u||this,c[g],g,c)&&(f[g]=c[g]);return f}function Ae(c){return Array.isArray(c)?c.map(Ae):typeof c=="object"&&c?Pt(c,Ae):c}const je={};function tt(c){je[c]||(typeof console<"u"&&console.warn(c),je[c]=!0)}function pt(c,a,u){return(u.y-c.y)*(a.x-c.x)>(a.y-c.y)*(u.x-c.x)}function Tt(c){let a=0;for(let u,f,g=0,b=c.length,E=b-1;g<b;E=g++)u=c[g],f=c[E],a+=(f.x-u.x)*(u.y+f.y);return a}function tn(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Wt(c){const a={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(u,f,g,b)=>{const E=g||b;return a[f]=!E||E.toLowerCase(),""}),a["max-age"]){const u=parseInt(a["max-age"],10);isNaN(u)?delete a["max-age"]:a["max-age"]=u}return a}let qt=null;function It(c){if(qt==null){const a=c.navigator?c.navigator.userAgent:null;qt=!!c.safari||!(!a||!(/\b(iPad|iPhone|iPod)\b/.test(a)||a.match("Safari")&&!a.match("Chrome")))}return qt}function wn(c){try{const a=d[c];return a.setItem("_mapbox_test_",1),a.removeItem("_mapbox_test_"),!0}catch{return!1}}function hn(c,a){return[c[4*a],c[4*a+1],c[4*a+2],c[4*a+3]]}const En="mapbox-tiles";let zn=500,ei=50,ti,li;function ie(){try{return d.caches}catch{}}function K(){ie()&&!ti&&(ti=d.caches.open(En))}function Be(c){const a=c.indexOf("?");if(a<0)return c;const u=function(g){const b=g.indexOf("?");return b>0?g.slice(b+1).split("&"):[]}(c),f=u.filter(g=>{const b=g.split("=");return b[0]==="language"||b[0]==="worldview"});return f.length?`${c.slice(0,a)}?${f.join("&")}`:c.slice(0,a)}let rt=1/0;const mt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(mt);class zt extends Error{constructor(a,u,f){u===401&&Je(f)&&(a+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(a),this.status=u,this.url=f}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const en=tn()?()=>self.worker&&self.worker.referrer:()=>(d.location.protocol==="blob:"?d.parent:d).location.href,bn=function(c,a){if(!(/^file:/.test(u=c.url)||/^file:/.test(en())&&!/^\w+:/.test(u))){if(d.fetch&&d.Request&&d.AbortController&&d.Request.prototype.hasOwnProperty("signal"))return function(f,g){const b=new d.AbortController,E=new d.Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:en(),referrerPolicy:f.referrerPolicy,signal:b.signal});let C=!1,P=!1;const M=(D=E.url).indexOf("sku=")>0&&Je(D);var D;f.type==="json"&&E.headers.set("Accept","application/json");const N=(H,W,Q)=>{if(P)return;if(H&&H.message!=="SecurityError"&&tt(H.toString()),W&&Q)return V(W);const oe=Date.now();d.fetch(E).then(xe=>{if(xe.ok){const Me=M?xe.clone():null;return V(xe,Me,oe)}return g(new zt(xe.statusText,xe.status,f.url))}).catch(xe=>{xe.name!=="AbortError"&&g(new Error(`${xe.message} ${f.url}`))})},V=(H,W,Q)=>{(f.type==="arrayBuffer"?H.arrayBuffer():f.type==="json"?H.json():H.text()).then(oe=>{P||(W&&Q&&function(xe,Me,we){if(K(),!ti)return;const Ie={status:Me.status,statusText:Me.statusText,headers:new d.Headers};Me.headers.forEach((lt,it)=>Ie.headers.set(it,lt));const Fe=Wt(Me.headers.get("Cache-Control")||"");if(Fe["no-store"])return;Fe["max-age"]&&Ie.headers.set("Expires",new Date(we+1e3*Fe["max-age"]).toUTCString());const De=Ie.headers.get("Expires");De&&(new Date(De).getTime()-we<42e4||function(lt,it){if(li===void 0)try{new Response(new ReadableStream),li=!0}catch{li=!1}li?it(lt.body):lt.blob().then(it)}(Me,lt=>{const it=new d.Response(lt,Ie);K(),ti&&ti.then(_t=>_t.put(Be(xe.url),it)).catch(_t=>tt(_t.message))}))}(E,W,Q),C=!0,g(null,oe,H.headers.get("Cache-Control"),H.headers.get("Expires")))}).catch(oe=>{P||g(new Error(oe.message))})};return M?function(H,W){if(K(),!ti)return W(null);const Q=Be(H.url);ti.then(oe=>{oe.match(Q).then(xe=>{const Me=function(we){if(!we)return!1;const Ie=new Date(we.headers.get("Expires")||0),Fe=Wt(we.headers.get("Cache-Control")||"");return Ie>Date.now()&&!Fe["no-cache"]}(xe);oe.delete(Q),Me&&oe.put(Q,xe.clone()),W(null,xe,Me)}).catch(W)}).catch(W)}(E,N):N(null,null),{cancel:()=>{P=!0,C||b.abort()}}}(c,a);if(tn()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,a,void 0,!0)}var u;return function(f,g){const b=new d.XMLHttpRequest;b.open(f.method||"GET",f.url,!0),f.type==="arrayBuffer"&&(b.responseType="arraybuffer");for(const E in f.headers)b.setRequestHeader(E,f.headers[E]);return f.type==="json"&&(b.responseType="text",b.setRequestHeader("Accept","application/json")),b.withCredentials=f.credentials==="include",b.onerror=()=>{g(new Error(b.statusText))},b.onload=()=>{if((b.status>=200&&b.status<300||b.status===0)&&b.response!==null){let E=b.response;if(f.type==="json")try{E=JSON.parse(b.response)}catch(C){return g(C)}g(null,E,b.getResponseHeader("Cache-Control"),b.getResponseHeader("Expires"))}else g(new zt(b.statusText,b.status,f.url))},b.send(f.body),{cancel:()=>b.abort()}}(c,a)},Hn=function(c,a){return bn(An(c,{type:"arrayBuffer"}),a)};function Pn(c){const a=d.document.createElement("a");return a.href=c,a.protocol===d.document.location.protocol&&a.host===d.document.location.host}const ue="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let X,te;X=[],te=0;const de=function(c,a){if(w.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),te>=v.MAX_PARALLEL_IMAGE_REQUESTS){const b={requestParameters:c,callback:a,cancelled:!1,cancel(){this.cancelled=!0}};return X.push(b),b}te++;let u=!1;const f=()=>{if(!u)for(u=!0,te--;X.length&&te<v.MAX_PARALLEL_IMAGE_REQUESTS;){const b=X.shift(),{requestParameters:E,callback:C,cancelled:P}=b;P||(b.cancel=de(E,C).cancel)}},g=Hn(c,(b,E,C,P)=>{f(),b?a(b):E&&(d.createImageBitmap?function(M,D){const N=new d.Blob([new Uint8Array(M)],{type:"image/png"});d.createImageBitmap(N).then(V=>{D(null,V)}).catch(V=>{D(new Error(`Could not load image because of ${V.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(E,(M,D)=>a(M,D,C,P)):function(M,D){const N=new d.Image,V=d.URL;N.onload=()=>{D(null,N),V.revokeObjectURL(N.src),N.onload=null,d.requestAnimationFrame(()=>{N.src=ue})},N.onerror=()=>D(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const H=new d.Blob([new Uint8Array(M)],{type:"image/png"});N.src=M.byteLength?V.createObjectURL(H):ue}(E,(M,D)=>a(M,D,C,P)))});return{cancel:()=>{g.cancel(),f()}}},Pe="NO_ACCESS_TOKEN";function $e(c){return c.indexOf("mapbox:")===0}function Je(c){return v.API_URL_REGEX.test(c)}function qe(c){return v.API_CDN_URL_REGEX.test(c)}function Ge(c){return v.API_STYLE_REGEX.test(c)&&!ct(c)}function ct(c){return v.API_SPRITE_REGEX.test(c)}const Ht=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Xt(c){const a=c.match(Ht);if(!a)throw new Error("Unable to parse URL object");return{protocol:a[1],authority:a[2],path:a[3]||"/",params:a[4]?a[4].split("&"):[]}}function Ft(c){const a=c.params.length?`?${c.params.join("&")}`:"";return`${c.protocol}://${c.authority}${c.path}${a}`}const qn="mapbox.eventData";function ci(c){if(!c)return null;const a=c.split(".");if(!a||a.length!==3)return null;try{return JSON.parse(decodeURIComponent(d.atob(a[1]).split("").map(u=>"%"+("00"+u.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Yn{constructor(a){this.type=a,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(a){const u=ci(v.ACCESS_TOKEN);let f="";return f=u&&u.u?d.btoa(encodeURIComponent(u.u).replace(/%([0-9A-F]{2})/g,(g,b)=>String.fromCharCode(+("0x"+b)))):v.ACCESS_TOKEN||"",a?`${qn}.${a}:${f}`:`${qn}:${f}`}fetchEventData(){const a=wn("localStorage"),u=this.getStorageKey(),f=this.getStorageKey("uuid");if(a)try{const g=d.localStorage.getItem(u);g&&(this.eventData=JSON.parse(g));const b=d.localStorage.getItem(f);b&&(this.anonId=b)}catch{tt("Unable to read from LocalStorage")}}saveEventData(){const a=wn("localStorage"),u=this.getStorageKey(),f=this.getStorageKey("uuid");if(a)try{d.localStorage.setItem(f,this.anonId),Object.keys(this.eventData).length>=1&&d.localStorage.setItem(u,JSON.stringify(this.eventData))}catch{tt("Unable to write to LocalStorage")}}processRequests(a){}postEvent(a,u,f,g){if(!v.EVENTS_URL)return;const b=Xt(v.EVENTS_URL);b.params.push(`access_token=${g||v.ACCESS_TOKEN||""}`);const E={event:this.type,created:new Date(a).toISOString()},C=u?An(E,u):E,P={url:Ft(b),headers:{"Content-Type":"text/plain"},body:JSON.stringify([C])};this.pendingRequest=function(M,D){return bn(An(M,{method:"POST"}),D)}(P,M=>{this.pendingRequest=null,f(M),this.saveEventData(),this.processRequests(g)})}queueRequest(a,u){this.queue.push(a),this.processRequests(u)}}const ii=new class extends Yn{constructor(c){super("appUserTurnstile"),this._customAccessToken=c}postTurnstileEvent(c,a){v.EVENTS_URL&&v.ACCESS_TOKEN&&Array.isArray(c)&&c.some(u=>$e(u)||Je(u))&&this.queueRequest(Date.now(),a)}processRequests(c){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const a=ci(v.ACCESS_TOKEN),u=a?a.u:v.ACCESS_TOKEN;let f=u!==this.eventData.tokenU;kt(this.anonId)||(this.anonId=Nt(),f=!0);const g=this.queue.shift();if(this.eventData.lastSuccess){const b=new Date(this.eventData.lastSuccess),E=new Date(g),C=(g-this.eventData.lastSuccess)/864e5;f=f||C>=1||C<-1||b.getDate()!==E.getDate()}else f=!0;f?this.postEvent(g,{sdkIdentifier:"mapbox-gl-js",sdkVersion:p,skuId:B,"enabled.telemetry":!1,userId:this.anonId},b=>{b||(this.eventData.lastSuccess=g,this.eventData.tokenU=u)},c):this.processRequests()}},mi=ii.postTurnstileEvent.bind(ii),Vi=new class extends Yn{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(c,a,u,f){this.skuToken=a,this.errorCb=f,v.EVENTS_URL&&(u||v.ACCESS_TOKEN?this.queueRequest({id:c,timestamp:Date.now()},u):this.errorCb(new Error(Pe)))}processRequests(c){if(this.pendingRequest||this.queue.length===0)return;const{id:a,timestamp:u}=this.queue.shift();a&&this.success[a]||(this.anonId||this.fetchEventData(),kt(this.anonId)||(this.anonId=Nt()),this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:p,skuId:B,skuToken:this.skuToken,userId:this.anonId},f=>{f?this.errorCb(f):a&&(this.success[a]=!0)},c))}},hr=Vi.postMapLoadEvent.bind(Vi),Fr=new class extends Yn{constructor(){super("gljs.performance")}postPerformanceEvent(c,a){v.EVENTS_URL&&(c||v.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:a},c)}processRequests(c){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:a,performanceData:u}=this.queue.shift(),f=function(g){const b=d.performance.getEntriesByType("resource"),E=d.performance.getEntriesByType("mark"),C=function(V){const H={};if(V){for(const W in V)if(W!=="other")for(const Q of V[W]){const oe=`${W}ResolveRangeMin`,xe=`${W}ResolveRangeMax`,Me=`${W}RequestCount`,we=`${W}RequestCachedCount`;H[oe]=Math.min(H[oe]||1/0,Q.startTime),H[xe]=Math.max(H[xe]||-1/0,Q.responseEnd);const Ie=Fe=>{H[Fe]===void 0&&(H[Fe]=0),++H[Fe]};Q.transferSize!==void 0&&Q.transferSize===0&&Ie(we),Ie(Me)}}return H}(function(V,H){const W={};if(V)for(const Q of V){const oe=H(Q);W[oe]===void 0&&(W[oe]=[]),W[oe].push(Q)}return W}(b,Fs)),P=d.devicePixelRatio,M=d.navigator.connection||d.navigator.mozConnection||d.navigator.webkitConnection,D={counters:[],metadata:[],attributes:[]},N=(V,H,W)=>{W!=null&&V.push({name:H,value:W.toString()})};for(const V in C)N(D.counters,V,C[V]);if(g.interactionRange[0]!==1/0&&g.interactionRange[1]!==-1/0&&(N(D.counters,"interactionRangeMin",g.interactionRange[0]),N(D.counters,"interactionRangeMax",g.interactionRange[1])),E)for(const V of Object.keys(Bo)){const H=Bo[V],W=E.find(Q=>Q.name===H);W&&N(D.counters,H,W.startTime)}return N(D.counters,"visibilityHidden",g.visibilityHidden),N(D.attributes,"style",function(V){if(V)for(const H of V){const W=H.name.split("?")[0];if(Ge(W)){const Q=W.split("/").slice(-2);if(Q.length===2)return`mapbox://styles/${Q[0]}/${Q[1]}`}}}(b)),N(D.attributes,"terrainEnabled",g.terrainEnabled?"true":"false"),N(D.attributes,"fogEnabled",g.fogEnabled?"true":"false"),N(D.attributes,"projection",g.projection),N(D.attributes,"zoom",g.zoom),N(D.metadata,"devicePixelRatio",P),N(D.metadata,"connectionEffectiveType",M?M.effectiveType:void 0),N(D.metadata,"navigatorUserAgent",d.navigator.userAgent),N(D.metadata,"screenWidth",d.screen.width),N(D.metadata,"screenHeight",d.screen.height),N(D.metadata,"windowWidth",d.innerWidth),N(D.metadata,"windowHeight",d.innerHeight),N(D.metadata,"mapWidth",g.width/P),N(D.metadata,"mapHeight",g.height/P),N(D.metadata,"webglRenderer",g.renderer),N(D.metadata,"webglVendor",g.vendor),N(D.metadata,"sdkVersion",p),N(D.metadata,"sdkIdentifier","mapbox-gl-js"),D}(u);for(const g of f.metadata);for(const g of f.counters);for(const g of f.attributes);this.postEvent(a,f,()=>{},c)}},xr=Fr.postPerformanceEvent.bind(Fr),Ko=new class extends Yn{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(c,a,u,f){if(!v.API_URL||!v.SESSION_PATH)return;const g=Xt(v.API_URL+v.SESSION_PATH);g.params.push(`sku=${a||""}`),g.params.push(`access_token=${f||v.ACCESS_TOKEN||""}`);const b={url:Ft(g),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(E,C){return bn(An(E,{method:"GET"}),C)}(b,E=>{this.pendingRequest=null,u(E),this.saveEventData(),this.processRequests(f)})}getSessionAPI(c,a,u,f){this.skuToken=a,this.errorCb=f,v.SESSION_PATH&&v.API_URL&&(u||v.ACCESS_TOKEN?this.queueRequest({id:c,timestamp:Date.now()},u):this.errorCb(new Error(Pe)))}processRequests(c){if(this.pendingRequest||this.queue.length===0)return;const{id:a,timestamp:u}=this.queue.shift();a&&this.success[a]||this.getSession(u,this.skuToken,f=>{f?this.errorCb(f):a&&(this.success[a]=!0)},c)}},Cr=Ko.getSessionAPI.bind(Ko),Kr=new Set,Bo={create:"create",load:"load",fullLoad:"fullLoad"},na={mark(c){d.performance.mark(c)},measure(c,a,u){d.performance.measure(c,a,u)}};function Fs(c){const a=c.name.split("?")[0];return qe(a)&&a.includes("mapbox-gl.js")?"javascript":qe(a)&&a.includes("mapbox-gl.css")?"css":function(u){return v.API_FONTS_REGEX.test(u)}(a)?"fontRange":ct(a)?"sprite":Ge(a)?"style":function(u){return v.API_TILEJSON_REGEX.test(u)}(a)?"tilejson":"other"}const vi=d.performance;function Xo(c){const a=c?c.url.toString():void 0;return vi.getEntriesByName(a)}let Za,Dl,ia,wr;const bo={now:()=>ia!==void 0?ia:d.performance.now(),setNow(c){ia=c},restoreNow(){ia=void 0},frame(c){const a=d.requestAnimationFrame(c);return{cancel:()=>d.cancelAnimationFrame(a)}},getImageData(c,a=0){const{width:u,height:f}=c;wr||(wr=d.document.createElement("canvas"));const g=wr.getContext("2d",{willReadFrequently:!0});if(!g)throw new Error("failed to create canvas 2d context");return(u>wr.width||f>wr.height)&&(wr.width=u,wr.height=f),g.clearRect(-a,-a,u+2*a,f+2*a),g.drawImage(c,0,0,u,f),g.getImageData(-a,-a,u+2*a,f+2*a)},resolveURL:c=>(Za||(Za=d.document.createElement("a")),Za.href=c,Za.href),get devicePixelRatio(){return d.devicePixelRatio},get prefersReducedMotion(){return!!d.matchMedia&&(Dl==null&&(Dl=d.matchMedia("(prefers-reduced-motion: reduce)")),Dl.matches)}};function zo(c,a,u){u[c]&&u[c].indexOf(a)!==-1||(u[c]=u[c]||[],u[c].push(a))}function Io(c,a,u){if(u&&u[c]){const f=u[c].indexOf(a);f!==-1&&u[c].splice(f,1)}}class Zo{constructor(a,u={}){An(this,u),this.type=a}}class Br extends Zo{constructor(a,u={}){super("error",An({error:a},u))}}class Mo{on(a,u){return this._listeners=this._listeners||{},zo(a,u,this._listeners),this}off(a,u){return Io(a,u,this._listeners),Io(a,u,this._oneTimeListeners),this}once(a,u){return u?(this._oneTimeListeners=this._oneTimeListeners||{},zo(a,u,this._oneTimeListeners),this):new Promise(f=>this.once(a,f))}fire(a,u){typeof a=="string"&&(a=new Zo(a,u||{}));const f=a.type;if(this.listens(f)){a.target=this;const g=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const C of g)C.call(this,a);const b=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const C of b)Io(f,C,this._oneTimeListeners),C.call(this,a);const E=this._eventedParent;E&&(An(a,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),E.fire(a))}else a instanceof Br&&console.error(a.error);return this}listens(a){return!!(this._listeners&&this._listeners[a]&&this._listeners[a].length>0||this._oneTimeListeners&&this._oneTimeListeners[a]&&this._oneTimeListeners[a].length>0||this._eventedParent&&this._eventedParent.listens(a))}setEventedParent(a,u){return this._eventedParent=a,this._eventedParentData=u,this}}var yt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function No(c,...a){for(const u of a)for(const f in u)c[f]=u[f];return c}function sr(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function Ai(c){if(Array.isArray(c))return c.map(Ai);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const a={};for(const u in c)a[u]=Ai(c[u]);return a}return sr(c)}class er extends Error{constructor(a,u){super(u),this.message=u,this.key=a}}var go=er;class ra{constructor(a,u=[]){this.parent=a,this.bindings={};for(const[f,g]of u)this.bindings[f]=g}concat(a){return new ra(this,a)}get(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(`${a} not found in scope.`)}has(a){return!!this.bindings[a]||!!this.parent&&this.parent.has(a)}}var qa=ra;const Ts={kind:"null"},nn={kind:"number"},Kn={kind:"string"},Jn={kind:"boolean"},yo={kind:"color"},xo={kind:"object"},ni={kind:"value"},Ro={kind:"collator"},Ya={kind:"formatted"},se={kind:"resolvedImage"};function ve(c,a){return{kind:"array",itemType:c,N:a}}function Re(c){if(c.kind==="array"){const a=Re(c.itemType);return typeof c.N=="number"?`array<${a}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${a}>`}return c.kind}const gt=[Ts,nn,Kn,Jn,yo,Ya,xo,ve(ni),se];function $t(c,a){if(a.kind==="error")return null;if(c.kind==="array"){if(a.kind==="array"&&(a.N===0&&a.itemType.kind==="value"||!$t(c.itemType,a.itemType))&&(typeof c.N!="number"||c.N===a.N))return null}else{if(c.kind===a.kind)return null;if(c.kind==="value"){for(const u of gt)if(!$t(u,a))return null}}return`Expected ${Re(c)} but found ${Re(a)} instead.`}function vn(c,a){return a.some(u=>u.kind===c.kind)}function ui(c,a){return a.some(u=>u==="null"?c===null:u==="array"?Array.isArray(c):u==="object"?c&&!Array.isArray(c)&&typeof c=="object":u===typeof c)}var Oe,Ze={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function at(c){return(c=Math.round(c))<0?0:c>255?255:c}function Ot(c){return at(c[c.length-1]==="%"?parseFloat(c)/100*255:parseInt(c))}function mn(c){return(a=c[c.length-1]==="%"?parseFloat(c)/100:parseFloat(c))<0?0:a>1?1:a;var a}function un(c,a,u){return u<0?u+=1:u>1&&(u-=1),6*u<1?c+(a-c)*u*6:2*u<1?a:3*u<2?c+(a-c)*(2/3-u)*6:c}try{Oe={}.parseCSSColor=function(c){var a,u=c.replace(/ /g,"").toLowerCase();if(u in Ze)return Ze[u].slice();if(u[0]==="#")return u.length===4?(a=parseInt(u.substr(1),16))>=0&&a<=4095?[(3840&a)>>4|(3840&a)>>8,240&a|(240&a)>>4,15&a|(15&a)<<4,1]:null:u.length===7&&(a=parseInt(u.substr(1),16))>=0&&a<=16777215?[(16711680&a)>>16,(65280&a)>>8,255&a,1]:null;var f=u.indexOf("("),g=u.indexOf(")");if(f!==-1&&g+1===u.length){var b=u.substr(0,f),E=u.substr(f+1,g-(f+1)).split(","),C=1;switch(b){case"rgba":if(E.length!==4)return null;C=mn(E.pop());case"rgb":return E.length!==3?null:[Ot(E[0]),Ot(E[1]),Ot(E[2]),C];case"hsla":if(E.length!==4)return null;C=mn(E.pop());case"hsl":if(E.length!==3)return null;var P=(parseFloat(E[0])%360+360)%360/360,M=mn(E[1]),D=mn(E[2]),N=D<=.5?D*(M+1):D+M-D*M,V=2*D-N;return[at(255*un(V,N,P+1/3)),at(255*un(V,N,P)),at(255*un(V,N,P-1/3)),C];default:return null}}return null}}catch{}class jn{constructor(a,u,f,g=1){this.r=a,this.g=u,this.b=f,this.a=g}static parse(a){if(!a)return;if(a instanceof jn)return a;if(typeof a!="string")return;const u=Oe(a);return u?new jn(u[0]/255*u[3],u[1]/255*u[3],u[2]/255*u[3],u[3]):void 0}toString(){const[a,u,f,g]=this.toArray();return`rgba(${Math.round(a)},${Math.round(u)},${Math.round(f)},${g})`}toArray(){const{r:a,g:u,b:f,a:g}=this;return g===0?[0,0,0,0]:[255*a/g,255*u/g,255*f/g,g]}toArray01(){const{r:a,g:u,b:f,a:g}=this;return g===0?[0,0,0,0]:[a/g,u/g,f/g,g]}toArray01PremultipliedAlpha(){const{r:a,g:u,b:f,a:g}=this;return[a,u,f,g]}}jn.black=new jn(0,0,0,1),jn.white=new jn(1,1,1,1),jn.transparent=new jn(0,0,0,0),jn.red=new jn(1,0,0,1),jn.blue=new jn(0,0,1,1);var on=jn;class Er{constructor(a,u,f){this.sensitivity=a?u?"variant":"case":u?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(a,u){return this.collator.compare(a,u)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class mr{constructor(a,u,f,g,b){this.text=a.normalize?a.normalize():a,this.image=u,this.scale=f,this.fontStack=g,this.textColor=b}}class xi{constructor(a){this.sections=a}static fromString(a){return new xi([new mr(a,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(a=>a.text.length!==0||a.image&&a.image.name.length!==0)}static factory(a){return a instanceof xi?a:xi.fromString(a)}toString(){return this.sections.length===0?"":this.sections.map(a=>a.text).join("")}serialize(){const a=["format"];for(const u of this.sections){if(u.image){a.push(["image",u.image.name]);continue}a.push(u.text);const f={};u.fontStack&&(f["text-font"]=["literal",u.fontStack.split(",")]),u.scale&&(f["font-scale"]=u.scale),u.textColor&&(f["text-color"]=["rgba"].concat(u.textColor.toArray())),a.push(f)}return a}}class Si{constructor(a){this.name=a.name,this.available=a.available}toString(){return this.name}static fromString(a){return a?new Si({name:a,available:!1}):null}serialize(){return["image",this.name]}}function ji(c,a,u,f){return typeof c=="number"&&c>=0&&c<=255&&typeof a=="number"&&a>=0&&a<=255&&typeof u=="number"&&u>=0&&u<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:`Invalid rgba value [${[c,a,u,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof f=="number"?[c,a,u,f]:[c,a,u]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ar(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof on||c instanceof Er||c instanceof xi||c instanceof Si)return!0;if(Array.isArray(c)){for(const a of c)if(!Ar(a))return!1;return!0}if(typeof c=="object"){for(const a in c)if(!Ar(c[a]))return!1;return!0}return!1}function Ei(c){if(c===null)return Ts;if(typeof c=="string")return Kn;if(typeof c=="boolean")return Jn;if(typeof c=="number")return nn;if(c instanceof on)return yo;if(c instanceof Er)return Ro;if(c instanceof xi)return Ya;if(c instanceof Si)return se;if(Array.isArray(c)){const a=c.length;let u;for(const f of c){const g=Ei(f);if(u){if(u===g)continue;u=ni;break}u=g}return ve(u||ni,a)}return xo}function gr(c){const a=typeof c;return c===null?"":a==="string"||a==="number"||a==="boolean"?String(c):c instanceof on||c instanceof xi||c instanceof Si?c.toString():JSON.stringify(c)}class vu{constructor(a,u){this.type=a,this.value=u}static parse(a,u){if(a.length!==2)return u.error(`'literal' expression requires exactly one argument, but found ${a.length-1} instead.`);if(!Ar(a[1]))return u.error("invalid value");const f=a[1];let g=Ei(f);const b=u.expectedType;return g.kind!=="array"||g.N!==0||!b||b.kind!=="array"||typeof b.N=="number"&&b.N!==0||(g=b),new vu(g,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof on?["rgba"].concat(this.value.toArray()):this.value instanceof xi?this.value.serialize():this.value}}var oa=vu,ro=class{constructor(c){this.name="ExpressionEvaluationError",this.message=c}toJSON(){return this.message}};const _u={string:Kn,number:nn,boolean:Jn,object:xo};class bu{constructor(a,u){this.type=a,this.args=u}static parse(a,u){if(a.length<2)return u.error("Expected at least one argument.");let f,g=1;const b=a[0];if(b==="array"){let C,P;if(a.length>2){const M=a[1];if(typeof M!="string"||!(M in _u)||M==="object")return u.error('The item type argument of "array" must be one of string, number, boolean',1);C=_u[M],g++}else C=ni;if(a.length>3){if(a[2]!==null&&(typeof a[2]!="number"||a[2]<0||a[2]!==Math.floor(a[2])))return u.error('The length argument to "array" must be a positive integer literal',2);P=a[2],g++}f=ve(C,P)}else f=_u[b];const E=[];for(;g<a.length;g++){const C=u.parse(a[g],g,ni);if(!C)return null;E.push(C)}return new bu(f,E)}evaluate(a){for(let u=0;u<this.args.length;u++){const f=this.args[u].evaluate(a);if(!$t(this.type,Ei(f)))return f;if(u===this.args.length-1)throw new ro(`Expected value to be of type ${Re(this.type)}, but found ${Re(Ei(f))} instead.`)}return null}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){const a=this.type,u=[a.kind];if(a.kind==="array"){const f=a.itemType;if(f.kind==="string"||f.kind==="number"||f.kind==="boolean"){u.push(f.kind);const g=a.N;(typeof g=="number"||this.args.length>1)&&u.push(g)}}return u.concat(this.args.map(f=>f.serialize()))}}var Ss=bu;class qo{constructor(a){this.type=Ya,this.sections=a}static parse(a,u){if(a.length<2)return u.error("Expected at least one argument.");const f=a[1];if(!Array.isArray(f)&&typeof f=="object")return u.error("First argument must be an image or text section.");const g=[];let b=!1;for(let E=1;E<=a.length-1;++E){const C=a[E];if(b&&typeof C=="object"&&!Array.isArray(C)){b=!1;let P=null;if(C["font-scale"]&&(P=u.parse(C["font-scale"],1,nn),!P))return null;let M=null;if(C["text-font"]&&(M=u.parse(C["text-font"],1,ve(Kn)),!M))return null;let D=null;if(C["text-color"]&&(D=u.parse(C["text-color"],1,yo),!D))return null;const N=g[g.length-1];N.scale=P,N.font=M,N.textColor=D}else{const P=u.parse(a[E],1,ni);if(!P)return null;const M=P.type.kind;if(M!=="string"&&M!=="value"&&M!=="null"&&M!=="resolvedImage")return u.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");b=!0,g.push({content:P,scale:null,font:null,textColor:null})}}return new qo(g)}evaluate(a){return new xi(this.sections.map(u=>{const f=u.content.evaluate(a);return Ei(f)===se?new mr("",f,null,null,null):new mr(gr(f),null,u.scale?u.scale.evaluate(a):null,u.font?u.font.evaluate(a).join(","):null,u.textColor?u.textColor.evaluate(a):null)}))}eachChild(a){for(const u of this.sections)a(u.content),u.scale&&a(u.scale),u.font&&a(u.font),u.textColor&&a(u.textColor)}outputDefined(){return!1}serialize(){const a=["format"];for(const u of this.sections){a.push(u.content.serialize());const f={};u.scale&&(f["font-scale"]=u.scale.serialize()),u.font&&(f["text-font"]=u.font.serialize()),u.textColor&&(f["text-color"]=u.textColor.serialize()),a.push(f)}return a}}class vc{constructor(a){this.type=se,this.input=a}static parse(a,u){if(a.length!==2)return u.error("Expected two arguments.");const f=u.parse(a[1],1,Kn);return f?new vc(f):u.error("No image name provided.")}evaluate(a){const u=this.input.evaluate(a),f=Si.fromString(u);return f&&a.availableImages&&(f.available=a.availableImages.indexOf(u)>-1),f}eachChild(a){a(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const hE={"to-boolean":Jn,"to-color":yo,"to-number":nn,"to-string":Kn};class sg{constructor(a,u){this.type=a,this.args=u}static parse(a,u){if(a.length<2)return u.error("Expected at least one argument.");const f=a[0];if((f==="to-boolean"||f==="to-string")&&a.length!==2)return u.error("Expected one argument.");const g=hE[f],b=[];for(let E=1;E<a.length;E++){const C=u.parse(a[E],E,ni);if(!C)return null;b.push(C)}return new sg(g,b)}evaluate(a){if(this.type.kind==="boolean")return!!this.args[0].evaluate(a);if(this.type.kind==="color"){let u,f;for(const g of this.args){if(u=g.evaluate(a),f=null,u instanceof on)return u;if(typeof u=="string"){const b=a.parseColor(u);if(b)return b}else if(Array.isArray(u)&&(f=u.length<3||u.length>4?`Invalid rbga value ${JSON.stringify(u)}: expected an array containing either three or four numeric values.`:ji(u[0],u[1],u[2],u[3]),!f))return new on(u[0]/255,u[1]/255,u[2]/255,u[3])}throw new ro(f||`Could not parse color from value '${typeof u=="string"?u:String(JSON.stringify(u))}'`)}if(this.type.kind==="number"){let u=null;for(const f of this.args){if(u=f.evaluate(a),u===null)return 0;const g=Number(u);if(!isNaN(g))return g}throw new ro(`Could not convert ${JSON.stringify(u)} to number.`)}return this.type.kind==="formatted"?xi.fromString(gr(this.args[0].evaluate(a))):this.type.kind==="resolvedImage"?Si.fromString(gr(this.args[0].evaluate(a))):gr(this.args[0].evaluate(a))}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){if(this.type.kind==="formatted")return new qo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new vc(this.args[0]).serialize();const a=[`to-${this.type.kind}`];return this.eachChild(u=>{a.push(u.serialize())}),a}}var xu=sg;const Aa=["Unknown","Point","LineString","Polygon"];var ag=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Aa[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const c=this.featureDistanceData.center,a=this.featureDistanceData.scale,{x:u,y:f}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(u*a-c[0])+this.featureDistanceData.bearing[1]*(f*a-c[1])}return 0}parseColor(c){let a=this._parseColorCache[c];return a||(a=this._parseColorCache[c]=on.parse(c)),a}};class _c{constructor(a,u,f,g){this.name=a,this.type=u,this._evaluate=f,this.args=g}evaluate(a){return this._evaluate(a,this.args)}eachChild(a){this.args.forEach(a)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(a=>a.serialize()))}static parse(a,u){const f=a[0],g=_c.definitions[f];if(!g)return u.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const b=Array.isArray(g)?g[0]:g.type,E=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,C=E.filter(([M])=>!Array.isArray(M)||M.length===a.length-1);let P=null;for(const[M,D]of C){P=new fg(u.registry,u.path,null,u.scope);const N=[];let V=!1;for(let H=1;H<a.length;H++){const W=a[H],Q=Array.isArray(M)?M[H-1]:M.type,oe=P.parse(W,1+N.length,Q);if(!oe){V=!0;break}N.push(oe)}if(!V)if(Array.isArray(M)&&M.length!==N.length)P.error(`Expected ${M.length} arguments, but found ${N.length} instead.`);else{for(let H=0;H<N.length;H++){const W=Array.isArray(M)?M[H]:M.type,Q=N[H];P.concat(H+1).checkSubtype(W,Q.type)}if(P.errors.length===0)return new _c(f,b,D,N)}}if(C.length===1)u.errors.push(...P.errors);else{const M=(C.length?C:E).map(([N])=>{return V=N,Array.isArray(V)?`(${V.map(Re).join(", ")})`:`(${Re(V.type)}...)`;var V}).join(" | "),D=[];for(let N=1;N<a.length;N++){const V=u.parse(a[N],1+D.length);if(!V)return null;D.push(Re(V.type))}u.error(`Expected arguments of type ${M}, but found (${D.join(", ")}) instead.`)}return null}static register(a,u){_c.definitions=u;for(const f in u)a[f]=_c}}var Ja=_c;class Wh{constructor(a,u,f){this.type=Ro,this.locale=f,this.caseSensitive=a,this.diacriticSensitive=u}static parse(a,u){if(a.length!==2)return u.error("Expected one argument.");const f=a[1];if(typeof f!="object"||Array.isArray(f))return u.error("Collator options argument must be an object.");const g=u.parse(f["case-sensitive"]!==void 0&&f["case-sensitive"],1,Jn);if(!g)return null;const b=u.parse(f["diacritic-sensitive"]!==void 0&&f["diacritic-sensitive"],1,Jn);if(!b)return null;let E=null;return f.locale&&(E=u.parse(f.locale,1,Kn),!E)?null:new Wh(g,b,E)}evaluate(a){return new Er(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)}eachChild(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)}outputDefined(){return!1}serialize(){const a={};return a["case-sensitive"]=this.caseSensitive.serialize(),a["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(a.locale=this.locale.serialize()),["collator",a]}}const Qa=8192;function If(c,a){c[0]=Math.min(c[0],a[0]),c[1]=Math.min(c[1],a[1]),c[2]=Math.max(c[2],a[0]),c[3]=Math.max(c[3],a[1])}function wu(c,a){return!(c[0]<=a[0]||c[2]>=a[2]||c[1]<=a[1]||c[3]>=a[3])}function Kh(c,a){const u=(180+c[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,g=Math.pow(2,a.z);return[Math.round(u*g*Qa),Math.round(f*g*Qa)]}function B_(c,a,u){const f=c[0]-a[0],g=c[1]-a[1],b=c[0]-u[0],E=c[1]-u[1];return f*E-b*g==0&&f*b<=0&&g*E<=0}function Mf(c,a){let u=!1;for(let E=0,C=a.length;E<C;E++){const P=a[E];for(let M=0,D=P.length;M<D-1;M++){if(B_(c,P[M],P[M+1]))return!1;(g=P[M])[1]>(f=c)[1]!=(b=P[M+1])[1]>f[1]&&f[0]<(b[0]-g[0])*(f[1]-g[1])/(b[1]-g[1])+g[0]&&(u=!u)}}var f,g,b;return u}function lg(c,a){for(let u=0;u<a.length;u++)if(Mf(c,a[u]))return!0;return!1}function cg(c,a,u,f){const g=f[0]-u[0],b=f[1]-u[1],E=(c[0]-u[0])*b-g*(c[1]-u[1]),C=(a[0]-u[0])*b-g*(a[1]-u[1]);return E>0&&C<0||E<0&&C>0}function Eu(c,a,u){for(const M of u)for(let D=0;D<M.length-1;++D)if((C=[(E=M[D+1])[0]-(b=M[D])[0],E[1]-b[1]])[0]*(P=[(g=a)[0]-(f=c)[0],g[1]-f[1]])[1]-C[1]*P[0]!=0&&cg(f,g,b,E)&&cg(b,E,f,g))return!0;var f,g,b,E,C,P;return!1}function Fi(c,a){for(let u=0;u<c.length;++u)if(!Mf(c[u],a))return!1;for(let u=0;u<c.length-1;++u)if(Eu(c[u],c[u+1],a))return!1;return!0}function dE(c,a){for(let u=0;u<a.length;u++)if(Fi(c,a[u]))return!0;return!1}function ug(c,a,u){const f=[];for(let g=0;g<c.length;g++){const b=[];for(let E=0;E<c[g].length;E++){const C=Kh(c[g][E],u);If(a,C),b.push(C)}f.push(b)}return f}function z_(c,a,u){const f=[];for(let g=0;g<c.length;g++){const b=ug(c[g],a,u);f.push(b)}return f}function hg(c,a,u,f){if(c[0]<u[0]||c[0]>u[2]){const g=.5*f;let b=c[0]-u[0]>g?-f:u[0]-c[0]>g?f:0;b===0&&(b=c[0]-u[2]>g?-f:u[2]-c[0]>g?f:0),c[0]+=b}If(a,c)}function N_(c,a,u,f){const g=Math.pow(2,f.z)*Qa,b=[f.x*Qa,f.y*Qa],E=[];if(!c)return E;for(const C of c)for(const P of C){const M=[P.x+b[0],P.y+b[1]];hg(M,a,u,g),E.push(M)}return E}function dg(c,a,u,f){const g=Math.pow(2,f.z)*Qa,b=[f.x*Qa,f.y*Qa],E=[];if(!c)return E;for(const P of c){const M=[];for(const D of P){const N=[D.x+b[0],D.y+b[1]];If(a,N),M.push(N)}E.push(M)}if(a[2]-a[0]<=g/2){(C=a)[0]=C[1]=1/0,C[2]=C[3]=-1/0;for(const P of E)for(const M of P)hg(M,a,u,g)}var C;return E}class Tu{constructor(a,u){this.type=Jn,this.geojson=a,this.geometries=u}static parse(a,u){if(a.length!==2)return u.error(`'within' expression requires exactly one argument, but found ${a.length-1} instead.`);if(Ar(a[1])){const f=a[1];if(f.type==="FeatureCollection")for(let g=0;g<f.features.length;++g){const b=f.features[g].geometry.type;if(b==="Polygon"||b==="MultiPolygon")return new Tu(f,f.features[g].geometry)}else if(f.type==="Feature"){const g=f.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new Tu(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new Tu(f,f)}return u.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(a){if(a.geometry()!=null&&a.canonicalID()!=null){if(a.geometryType()==="Point")return function(u,f){const g=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],E=u.canonicalID();if(!E)return!1;if(f.type==="Polygon"){const C=ug(f.coordinates,b,E),P=N_(u.geometry(),g,b,E);if(!wu(g,b))return!1;for(const M of P)if(!Mf(M,C))return!1}if(f.type==="MultiPolygon"){const C=z_(f.coordinates,b,E),P=N_(u.geometry(),g,b,E);if(!wu(g,b))return!1;for(const M of P)if(!lg(M,C))return!1}return!0}(a,this.geometries);if(a.geometryType()==="LineString")return function(u,f){const g=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],E=u.canonicalID();if(!E)return!1;if(f.type==="Polygon"){const C=ug(f.coordinates,b,E),P=dg(u.geometry(),g,b,E);if(!wu(g,b))return!1;for(const M of P)if(!Fi(M,C))return!1}if(f.type==="MultiPolygon"){const C=z_(f.coordinates,b,E),P=dg(u.geometry(),g,b,E);if(!wu(g,b))return!1;for(const M of P)if(!dE(M,C))return!1}return!0}(a,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Rf=Tu;function Su(c){if(c instanceof Ja&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof Rf)return!1;let a=!0;return c.eachChild(u=>{a&&!Su(u)&&(a=!1)}),a}function el(c){if(c instanceof Ja&&c.name==="feature-state")return!1;let a=!0;return c.eachChild(u=>{a&&!el(u)&&(a=!1)}),a}function bc(c,a){if(c instanceof Ja&&a.indexOf(c.name)>=0)return!1;let u=!0;return c.eachChild(f=>{u&&!bc(f,a)&&(u=!1)}),u}class Lf{constructor(a,u){this.type=u.type,this.name=a,this.boundExpression=u}static parse(a,u){if(a.length!==2||typeof a[1]!="string")return u.error("'var' expression requires exactly one string literal argument.");const f=a[1];return u.scope.has(f)?new Lf(f,u.scope.get(f)):u.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(a){return this.boundExpression.evaluate(a)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var U_=Lf;class Xh{constructor(a,u=[],f,g=new qa,b=[]){this.registry=a,this.path=u,this.key=u.map(E=>`[${E}]`).join(""),this.scope=g,this.errors=b,this.expectedType=f}parse(a,u,f,g,b={}){return u?this.concat(u,f,g)._parse(a,b):this._parse(a,b)}_parse(a,u){function f(g,b,E){return E==="assert"?new Ss(b,[g]):E==="coerce"?new xu(b,[g]):g}if(a!==null&&typeof a!="string"&&typeof a!="boolean"&&typeof a!="number"||(a=["literal",a]),Array.isArray(a)){if(a.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=a[0];if(typeof g!="string")return this.error(`Expression name must be a string, but found ${typeof g} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const b=this.registry[g];if(b){let E=b.parse(a,this);if(!E)return null;if(this.expectedType){const C=this.expectedType,P=E.type;if(C.kind!=="string"&&C.kind!=="number"&&C.kind!=="boolean"&&C.kind!=="object"&&C.kind!=="array"||P.kind!=="value")if(C.kind!=="color"&&C.kind!=="formatted"&&C.kind!=="resolvedImage"||P.kind!=="value"&&P.kind!=="string"){if(this.checkSubtype(C,P))return null}else E=f(E,C,u.typeAnnotation||"coerce");else E=f(E,C,u.typeAnnotation||"assert")}if(!(E instanceof oa)&&E.type.kind!=="resolvedImage"&&pg(E)){const C=new ag;try{E=new oa(E.type,E.evaluate(C))}catch(P){return this.error(P.message),null}}return E}return this.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(a===void 0?"'undefined' value invalid. Use null instead.":typeof a=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof a} instead.`)}concat(a,u,f){const g=typeof a=="number"?this.path.concat(a):this.path,b=f?this.scope.concat(f):this.scope;return new Xh(this.registry,g,u||null,b,this.errors)}error(a,...u){const f=`${this.key}${u.map(g=>`[${g}]`).join("")}`;this.errors.push(new go(f,a))}checkSubtype(a,u){const f=$t(a,u);return f&&this.error(f),f}}var fg=Xh;function pg(c){if(c instanceof U_)return pg(c.boundExpression);if(c instanceof Ja&&c.name==="error"||c instanceof Wh||c instanceof Rf)return!1;const a=c instanceof xu||c instanceof Ss;let u=!0;return c.eachChild(f=>{u=a?u&&pg(f):u&&f instanceof oa}),!!u&&Su(c)&&bc(c,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Of(c,a){const u=c.length-1;let f,g,b=0,E=u,C=0;for(;b<=E;)if(C=Math.floor((b+E)/2),f=c[C],g=c[C+1],f<=a){if(C===u||a<g)return C;b=C+1}else{if(!(f>a))throw new ro("Input is not a number.");E=C-1}return 0}class Df{constructor(a,u,f){this.type=a,this.input=u,this.labels=[],this.outputs=[];for(const[g,b]of f)this.labels.push(g),this.outputs.push(b)}static parse(a,u){if(a.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return u.error("Expected an even number of arguments.");const f=u.parse(a[1],1,nn);if(!f)return null;const g=[];let b=null;u.expectedType&&u.expectedType.kind!=="value"&&(b=u.expectedType);for(let E=1;E<a.length;E+=2){const C=E===1?-1/0:a[E],P=a[E+1],M=E,D=E+1;if(typeof C!="number")return u.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(g.length&&g[g.length-1][0]>=C)return u.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);const N=u.parse(P,D,b);if(!N)return null;b=b||N.type,g.push([C,N])}return new Df(b,f,g)}evaluate(a){const u=this.labels,f=this.outputs;if(u.length===1)return f[0].evaluate(a);const g=this.input.evaluate(a);if(g<=u[0])return f[0].evaluate(a);const b=u.length;return g>=u[b-1]?f[b-1].evaluate(a):f[Of(u,g)].evaluate(a)}eachChild(a){a(this.input);for(const u of this.outputs)a(u)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}serialize(){const a=["step",this.input.serialize()];for(let u=0;u<this.labels.length;u++)u>0&&a.push(this.labels[u]),a.push(this.outputs[u].serialize());return a}}var mg=Df;function Ci(c,a,u){return c*(1-u)+a*u}var Zh=Object.freeze({__proto__:null,array:function(c,a,u){return c.map((f,g)=>Ci(f,a[g],u))},color:function(c,a,u){return new on(Ci(c.r,a.r,u),Ci(c.g,a.g,u),Ci(c.b,a.b,u),Ci(c.a,a.a,u))},number:Ci});const V_=.95047,gg=1.08883,j_=4/29,xc=6/29,yg=3*xc*xc,fE=xc*xc*xc,pE=Math.PI/180,mE=180/Math.PI;function vg(c){return c>fE?Math.pow(c,1/3):c/yg+j_}function _g(c){return c>xc?c*c*c:yg*(c-j_)}function bg(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function kf(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function $_(c){const a=kf(c.r),u=kf(c.g),f=kf(c.b),g=vg((.4124564*a+.3575761*u+.1804375*f)/V_),b=vg((.2126729*a+.7151522*u+.072175*f)/1);return{l:116*b-16,a:500*(g-b),b:200*(b-vg((.0193339*a+.119192*u+.9503041*f)/gg)),alpha:c.a}}function G_(c){let a=(c.l+16)/116,u=isNaN(c.a)?a:a+c.a/500,f=isNaN(c.b)?a:a-c.b/200;return a=1*_g(a),u=V_*_g(u),f=gg*_g(f),new on(bg(3.2404542*u-1.5371385*a-.4985314*f),bg(-.969266*u+1.8760108*a+.041556*f),bg(.0556434*u-.2040259*a+1.0572252*f),c.alpha)}function gE(c,a,u){const f=a-c;return c+u*(f>180||f<-180?f-360*Math.round(f/360):f)}const qh={forward:$_,reverse:G_,interpolate:function(c,a,u){return{l:Ci(c.l,a.l,u),a:Ci(c.a,a.a,u),b:Ci(c.b,a.b,u),alpha:Ci(c.alpha,a.alpha,u)}}},Cu={forward:function(c){const{l:a,a:u,b:f}=$_(c),g=Math.atan2(f,u)*mE;return{h:g<0?g+360:g,c:Math.sqrt(u*u+f*f),l:a,alpha:c.a}},reverse:function(c){const a=c.h*pE,u=c.c;return G_({l:c.l,a:Math.cos(a)*u,b:Math.sin(a)*u,alpha:c.alpha})},interpolate:function(c,a,u){return{h:gE(c.h,a.h,u),c:Ci(c.c,a.c,u),l:Ci(c.l,a.l,u),alpha:Ci(c.alpha,a.alpha,u)}}};var xg=Object.freeze({__proto__:null,hcl:Cu,lab:qh});class Yh{constructor(a,u,f,g,b){this.type=a,this.operator=u,this.interpolation=f,this.input=g,this.labels=[],this.outputs=[];for(const[E,C]of b)this.labels.push(E),this.outputs.push(C)}static interpolationFactor(a,u,f,g){let b=0;if(a.name==="exponential")b=wg(u,a.base,f,g);else if(a.name==="linear")b=wg(u,1,f,g);else if(a.name==="cubic-bezier"){const E=a.controlPoints;b=new ne(E[0],E[1],E[2],E[3]).solve(wg(u,1,f,g))}return b}static parse(a,u){let[f,g,b,...E]=a;if(!Array.isArray(g)||g.length===0)return u.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const M=g[1];if(typeof M!="number")return u.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:M}}else{if(g[0]!=="cubic-bezier")return u.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const M=g.slice(1);if(M.length!==4||M.some(D=>typeof D!="number"||D<0||D>1))return u.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:M}}}if(a.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return u.error("Expected an even number of arguments.");if(b=u.parse(b,2,nn),!b)return null;const C=[];let P=null;f==="interpolate-hcl"||f==="interpolate-lab"?P=yo:u.expectedType&&u.expectedType.kind!=="value"&&(P=u.expectedType);for(let M=0;M<E.length;M+=2){const D=E[M],N=E[M+1],V=M+3,H=M+4;if(typeof D!="number")return u.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',V);if(C.length&&C[C.length-1][0]>=D)return u.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',V);const W=u.parse(N,H,P);if(!W)return null;P=P||W.type,C.push([D,W])}return P.kind==="number"||P.kind==="color"||P.kind==="array"&&P.itemType.kind==="number"&&typeof P.N=="number"?new Yh(P,f,g,b,C):u.error(`Type ${Re(P)} is not interpolatable.`)}evaluate(a){const u=this.labels,f=this.outputs;if(u.length===1)return f[0].evaluate(a);const g=this.input.evaluate(a);if(g<=u[0])return f[0].evaluate(a);const b=u.length;if(g>=u[b-1])return f[b-1].evaluate(a);const E=Of(u,g),C=Yh.interpolationFactor(this.interpolation,g,u[E],u[E+1]),P=f[E].evaluate(a),M=f[E+1].evaluate(a);return this.operator==="interpolate"?Zh[this.type.kind.toLowerCase()](P,M,C):this.operator==="interpolate-hcl"?Cu.reverse(Cu.interpolate(Cu.forward(P),Cu.forward(M),C)):qh.reverse(qh.interpolate(qh.forward(P),qh.forward(M),C))}eachChild(a){a(this.input);for(const u of this.outputs)a(u)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}serialize(){let a;a=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const u=[this.operator,a,this.input.serialize()];for(let f=0;f<this.labels.length;f++)u.push(this.labels[f],this.outputs[f].serialize());return u}}function wg(c,a,u,f){const g=f-u,b=c-u;return g===0?0:a===1?b/g:(Math.pow(a,b)-1)/(Math.pow(a,g)-1)}var Pa=Yh;class Ff{constructor(a,u){this.type=a,this.args=u}static parse(a,u){if(a.length<2)return u.error("Expectected at least one argument.");let f=null;const g=u.expectedType;g&&g.kind!=="value"&&(f=g);const b=[];for(const C of a.slice(1)){const P=u.parse(C,1+b.length,f,void 0,{typeAnnotation:"omit"});if(!P)return null;f=f||P.type,b.push(P)}const E=g&&b.some(C=>$t(g,C.type));return new Ff(E?ni:f,b)}evaluate(a){let u,f=null,g=0;for(const b of this.args){if(g++,f=b.evaluate(a),f&&f instanceof Si&&!f.available&&(u||(u=f),f=null,g===this.args.length))return u;if(f!==null)break}return f}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){const a=["coalesce"];return this.eachChild(u=>{a.push(u.serialize())}),a}}var Eg=Ff;class Bf{constructor(a,u){this.type=u.type,this.bindings=[].concat(a),this.result=u}evaluate(a){return this.result.evaluate(a)}eachChild(a){for(const u of this.bindings)a(u[1]);a(this.result)}static parse(a,u){if(a.length<4)return u.error(`Expected at least 3 arguments, but found ${a.length-1} instead.`);const f=[];for(let b=1;b<a.length-1;b+=2){const E=a[b];if(typeof E!="string")return u.error(`Expected string, but found ${typeof E} instead.`,b);if(/[^a-zA-Z0-9_]/.test(E))return u.error("Variable names must contain only alphanumeric characters or '_'.",b);const C=u.parse(a[b+1],b+1);if(!C)return null;f.push([E,C])}const g=u.parse(a[a.length-1],a.length-1,u.expectedType,f);return g?new Bf(f,g):null}outputDefined(){return this.result.outputDefined()}serialize(){const a=["let"];for(const[u,f]of this.bindings)a.push(u,f.serialize());return a.push(this.result.serialize()),a}}var H_=Bf;class Tg{constructor(a,u,f){this.type=a,this.index=u,this.input=f}static parse(a,u){if(a.length!==3)return u.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const f=u.parse(a[1],1,nn),g=u.parse(a[2],2,ve(u.expectedType||ni));return f&&g?new Tg(g.type.itemType,f,g):null}evaluate(a){const u=this.index.evaluate(a),f=this.input.evaluate(a);if(u<0)throw new ro(`Array index out of bounds: ${u} < 0.`);if(u>=f.length)throw new ro(`Array index out of bounds: ${u} > ${f.length-1}.`);if(u!==Math.floor(u))throw new ro(`Array index must be an integer, but found ${u} instead.`);return f[u]}eachChild(a){a(this.index),a(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var yE=Tg;class Sg{constructor(a,u){this.type=Jn,this.needle=a,this.haystack=u}static parse(a,u){if(a.length!==3)return u.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const f=u.parse(a[1],1,ni),g=u.parse(a[2],2,ni);return f&&g?vn(f.type,[Jn,Kn,nn,Ts,ni])?new Sg(f,g):u.error(`Expected first argument to be of type boolean, string, number or null, but found ${Re(f.type)} instead`):null}evaluate(a){const u=this.needle.evaluate(a),f=this.haystack.evaluate(a);if(f==null)return!1;if(!ui(u,["boolean","string","number","null"]))throw new ro(`Expected first argument to be of type boolean, string, number or null, but found ${Re(Ei(u))} instead.`);if(!ui(f,["string","array"]))throw new ro(`Expected second argument to be of type array or string, but found ${Re(Ei(f))} instead.`);return f.indexOf(u)>=0}eachChild(a){a(this.needle),a(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var zf=Sg;class Jh{constructor(a,u,f){this.type=nn,this.needle=a,this.haystack=u,this.fromIndex=f}static parse(a,u){if(a.length<=2||a.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const f=u.parse(a[1],1,ni),g=u.parse(a[2],2,ni);if(!f||!g)return null;if(!vn(f.type,[Jn,Kn,nn,Ts,ni]))return u.error(`Expected first argument to be of type boolean, string, number or null, but found ${Re(f.type)} instead`);if(a.length===4){const b=u.parse(a[3],3,nn);return b?new Jh(f,g,b):null}return new Jh(f,g)}evaluate(a){const u=this.needle.evaluate(a),f=this.haystack.evaluate(a);if(!ui(u,["boolean","string","number","null"]))throw new ro(`Expected first argument to be of type boolean, string, number or null, but found ${Re(Ei(u))} instead.`);if(!ui(f,["string","array"]))throw new ro(`Expected second argument to be of type array or string, but found ${Re(Ei(f))} instead.`);if(this.fromIndex){const g=this.fromIndex.evaluate(a);return f.indexOf(u,g)}return f.indexOf(u)}eachChild(a){a(this.needle),a(this.haystack),this.fromIndex&&a(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const a=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),a]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var W_=Jh;class Cg{constructor(a,u,f,g,b,E){this.inputType=a,this.type=u,this.input=f,this.cases=g,this.outputs=b,this.otherwise=E}static parse(a,u){if(a.length<5)return u.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if(a.length%2!=1)return u.error("Expected an even number of arguments.");let f,g;u.expectedType&&u.expectedType.kind!=="value"&&(g=u.expectedType);const b={},E=[];for(let M=2;M<a.length-1;M+=2){let D=a[M];const N=a[M+1];Array.isArray(D)||(D=[D]);const V=u.concat(M);if(D.length===0)return V.error("Expected at least one branch label.");for(const W of D){if(typeof W!="number"&&typeof W!="string")return V.error("Branch labels must be numbers or strings.");if(typeof W=="number"&&Math.abs(W)>Number.MAX_SAFE_INTEGER)return V.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof W=="number"&&Math.floor(W)!==W)return V.error("Numeric branch labels must be integer values.");if(f){if(V.checkSubtype(f,Ei(W)))return null}else f=Ei(W);if(b[String(W)]!==void 0)return V.error("Branch labels must be unique.");b[String(W)]=E.length}const H=u.parse(N,M,g);if(!H)return null;g=g||H.type,E.push(H)}const C=u.parse(a[1],1,ni);if(!C)return null;const P=u.parse(a[a.length-1],a.length-1,g);return P?C.type.kind!=="value"&&u.concat(1).checkSubtype(f,C.type)?null:new Cg(f,g,C,b,E,P):null}evaluate(a){const u=this.input.evaluate(a);return(Ei(u)===this.inputType&&this.outputs[this.cases[u]]||this.otherwise).evaluate(a)}eachChild(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)}outputDefined(){return this.outputs.every(a=>a.outputDefined())&&this.otherwise.outputDefined()}serialize(){const a=["match",this.input.serialize()],u=Object.keys(this.cases).sort(),f=[],g={};for(const E of u){const C=g[this.cases[E]];C===void 0?(g[this.cases[E]]=f.length,f.push([this.cases[E],[E]])):f[C][1].push(E)}const b=E=>this.inputType.kind==="number"?Number(E):E;for(const[E,C]of f)a.push(C.length===1?b(C[0]):C.map(b)),a.push(this.outputs[E].serialize());return a.push(this.otherwise.serialize()),a}}var vE=Cg;class Ag{constructor(a,u,f){this.type=a,this.branches=u,this.otherwise=f}static parse(a,u){if(a.length<4)return u.error(`Expected at least 3 arguments, but found only ${a.length-1}.`);if(a.length%2!=0)return u.error("Expected an odd number of arguments.");let f;u.expectedType&&u.expectedType.kind!=="value"&&(f=u.expectedType);const g=[];for(let E=1;E<a.length-1;E+=2){const C=u.parse(a[E],E,Jn);if(!C)return null;const P=u.parse(a[E+1],E+1,f);if(!P)return null;g.push([C,P]),f=f||P.type}const b=u.parse(a[a.length-1],a.length-1,f);return b?new Ag(f,g,b):null}evaluate(a){for(const[u,f]of this.branches)if(u.evaluate(a))return f.evaluate(a);return this.otherwise.evaluate(a)}eachChild(a){for(const[u,f]of this.branches)a(u),a(f);a(this.otherwise)}outputDefined(){return this.branches.every(([a,u])=>u.outputDefined())&&this.otherwise.outputDefined()}serialize(){const a=["case"];return this.eachChild(u=>{a.push(u.serialize())}),a}}var K_=Ag;class Qh{constructor(a,u,f,g){this.type=a,this.input=u,this.beginIndex=f,this.endIndex=g}static parse(a,u){if(a.length<=2||a.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const f=u.parse(a[1],1,ni),g=u.parse(a[2],2,nn);if(!f||!g)return null;if(!vn(f.type,[ve(ni),Kn,ni]))return u.error(`Expected first argument to be of type array or string, but found ${Re(f.type)} instead`);if(a.length===4){const b=u.parse(a[3],3,nn);return b?new Qh(f.type,f,g,b):null}return new Qh(f.type,f,g)}evaluate(a){const u=this.input.evaluate(a),f=this.beginIndex.evaluate(a);if(!ui(u,["string","array"]))throw new ro(`Expected first argument to be of type array or string, but found ${Re(Ei(u))} instead.`);if(this.endIndex){const g=this.endIndex.evaluate(a);return u.slice(f,g)}return u.slice(f)}eachChild(a){a(this.input),a(this.beginIndex),this.endIndex&&a(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const a=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),a]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var X_=Qh;function Nf(c,a){return c==="=="||c==="!="?a.kind==="boolean"||a.kind==="string"||a.kind==="number"||a.kind==="null"||a.kind==="value":a.kind==="string"||a.kind==="number"||a.kind==="value"}function Z_(c,a,u,f){return f.compare(a,u)===0}function Au(c,a,u){const f=c!=="=="&&c!=="!=";return class QU{constructor(b,E,C){this.type=Jn,this.lhs=b,this.rhs=E,this.collator=C,this.hasUntypedArgument=b.type.kind==="value"||E.type.kind==="value"}static parse(b,E){if(b.length!==3&&b.length!==4)return E.error("Expected two or three arguments.");const C=b[0];let P=E.parse(b[1],1,ni);if(!P)return null;if(!Nf(C,P.type))return E.concat(1).error(`"${C}" comparisons are not supported for type '${Re(P.type)}'.`);let M=E.parse(b[2],2,ni);if(!M)return null;if(!Nf(C,M.type))return E.concat(2).error(`"${C}" comparisons are not supported for type '${Re(M.type)}'.`);if(P.type.kind!==M.type.kind&&P.type.kind!=="value"&&M.type.kind!=="value")return E.error(`Cannot compare types '${Re(P.type)}' and '${Re(M.type)}'.`);f&&(P.type.kind==="value"&&M.type.kind!=="value"?P=new Ss(M.type,[P]):P.type.kind!=="value"&&M.type.kind==="value"&&(M=new Ss(P.type,[M])));let D=null;if(b.length===4){if(P.type.kind!=="string"&&M.type.kind!=="string"&&P.type.kind!=="value"&&M.type.kind!=="value")return E.error("Cannot use collator to compare non-string types.");if(D=E.parse(b[3],3,Ro),!D)return null}return new QU(P,M,D)}evaluate(b){const E=this.lhs.evaluate(b),C=this.rhs.evaluate(b);if(f&&this.hasUntypedArgument){const P=Ei(E),M=Ei(C);if(P.kind!==M.kind||P.kind!=="string"&&P.kind!=="number")throw new ro(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${P.kind}, ${M.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const P=Ei(E),M=Ei(C);if(P.kind!=="string"||M.kind!=="string")return a(b,E,C)}return this.collator?u(b,E,C,this.collator.evaluate(b)):a(b,E,C)}eachChild(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)}outputDefined(){return!0}serialize(){const b=[c];return this.eachChild(E=>{b.push(E.serialize())}),b}}}const _E=Au("==",function(c,a,u){return a===u},Z_),bE=Au("!=",function(c,a,u){return a!==u},function(c,a,u,f){return!Z_(0,a,u,f)}),xE=Au("<",function(c,a,u){return a<u},function(c,a,u,f){return f.compare(a,u)<0}),wE=Au(">",function(c,a,u){return a>u},function(c,a,u,f){return f.compare(a,u)>0}),EE=Au("<=",function(c,a,u){return a<=u},function(c,a,u,f){return f.compare(a,u)<=0}),q_=Au(">=",function(c,a,u){return a>=u},function(c,a,u,f){return f.compare(a,u)>=0});class Uf{constructor(a,u,f,g,b,E){this.type=Kn,this.number=a,this.locale=u,this.currency=f,this.unit=g,this.minFractionDigits=b,this.maxFractionDigits=E}static parse(a,u){if(a.length!==3)return u.error("Expected two arguments.");const f=u.parse(a[1],1,nn);if(!f)return null;const g=a[2];if(typeof g!="object"||Array.isArray(g))return u.error("NumberFormat options argument must be an object.");let b=null;if(g.locale&&(b=u.parse(g.locale,1,Kn),!b))return null;let E=null;if(g.currency&&(E=u.parse(g.currency,1,Kn),!E))return null;let C=null;if(g.unit&&(C=u.parse(g.unit,1,Kn),!C))return null;let P=null;if(g["min-fraction-digits"]&&(P=u.parse(g["min-fraction-digits"],1,nn),!P))return null;let M=null;return g["max-fraction-digits"]&&(M=u.parse(g["max-fraction-digits"],1,nn),!M)?null:new Uf(f,b,E,C,P,M)}evaluate(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(a):void 0,unit:this.unit?this.unit.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))}eachChild(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.unit&&a(this.unit),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const a={};return this.locale&&(a.locale=this.locale.serialize()),this.currency&&(a.currency=this.currency.serialize()),this.unit&&(a.unit=this.unit.serialize()),this.minFractionDigits&&(a["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(a["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),a]}}class Pu{constructor(a){this.type=nn,this.input=a}static parse(a,u){if(a.length!==2)return u.error(`Expected 1 argument, but found ${a.length-1} instead.`);const f=u.parse(a[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?u.error(`Expected argument of type string or array, but found ${Re(f.type)} instead.`):new Pu(f):null}evaluate(a){const u=this.input.evaluate(a);if(typeof u=="string"||Array.isArray(u))return u.length;throw new ro(`Expected value to be of type string or array, but found ${Re(Ei(u))} instead.`)}eachChild(a){a(this.input)}outputDefined(){return!1}serialize(){const a=["length"];return this.eachChild(u=>{a.push(u.serialize())}),a}}const Y_={"==":_E,"!=":bE,">":wE,"<":xE,">=":q_,"<=":EE,array:Ss,at:yE,boolean:Ss,case:K_,coalesce:Eg,collator:Wh,format:qo,image:vc,in:zf,"index-of":W_,interpolate:Pa,"interpolate-hcl":Pa,"interpolate-lab":Pa,length:Pu,let:H_,literal:oa,match:vE,number:Ss,"number-format":Uf,object:Ss,slice:X_,step:mg,string:Ss,"to-boolean":xu,"to-color":xu,"to-number":xu,"to-string":xu,var:U_,within:Rf};function J_(c,[a,u,f,g]){a=a.evaluate(c),u=u.evaluate(c),f=f.evaluate(c);const b=g?g.evaluate(c):1,E=ji(a,u,f,b);if(E)throw new ro(E);return new on(a/255*b,u/255*b,f/255*b,b)}function tl(c,a){return c in a}function Vf(c,a){const u=a[c];return u===void 0?null:u}function Bs(c){return{type:c}}Ja.register(Y_,{error:[{kind:"error"},[Kn],(c,[a])=>{throw new ro(a.evaluate(c))}],typeof:[Kn,[ni],(c,[a])=>Re(Ei(a.evaluate(c)))],"to-rgba":[ve(nn,4),[yo],(c,[a])=>a.evaluate(c).toArray()],rgb:[yo,[nn,nn,nn],J_],rgba:[yo,[nn,nn,nn,nn],J_],has:{type:Jn,overloads:[[[Kn],(c,[a])=>tl(a.evaluate(c),c.properties())],[[Kn,xo],(c,[a,u])=>tl(a.evaluate(c),u.evaluate(c))]]},get:{type:ni,overloads:[[[Kn],(c,[a])=>Vf(a.evaluate(c),c.properties())],[[Kn,xo],(c,[a,u])=>Vf(a.evaluate(c),u.evaluate(c))]]},"feature-state":[ni,[Kn],(c,[a])=>Vf(a.evaluate(c),c.featureState||{})],properties:[xo,[],c=>c.properties()],"geometry-type":[Kn,[],c=>c.geometryType()],id:[ni,[],c=>c.id()],zoom:[nn,[],c=>c.globals.zoom],pitch:[nn,[],c=>c.globals.pitch||0],"distance-from-center":[nn,[],c=>c.distanceFromCenter()],"heatmap-density":[nn,[],c=>c.globals.heatmapDensity||0],"line-progress":[nn,[],c=>c.globals.lineProgress||0],"sky-radial-progress":[nn,[],c=>c.globals.skyRadialProgress||0],accumulated:[ni,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[nn,Bs(nn),(c,a)=>{let u=0;for(const f of a)u+=f.evaluate(c);return u}],"*":[nn,Bs(nn),(c,a)=>{let u=1;for(const f of a)u*=f.evaluate(c);return u}],"-":{type:nn,overloads:[[[nn,nn],(c,[a,u])=>a.evaluate(c)-u.evaluate(c)],[[nn],(c,[a])=>-a.evaluate(c)]]},"/":[nn,[nn,nn],(c,[a,u])=>a.evaluate(c)/u.evaluate(c)],"%":[nn,[nn,nn],(c,[a,u])=>a.evaluate(c)%u.evaluate(c)],ln2:[nn,[],()=>Math.LN2],pi:[nn,[],()=>Math.PI],e:[nn,[],()=>Math.E],"^":[nn,[nn,nn],(c,[a,u])=>Math.pow(a.evaluate(c),u.evaluate(c))],sqrt:[nn,[nn],(c,[a])=>Math.sqrt(a.evaluate(c))],log10:[nn,[nn],(c,[a])=>Math.log(a.evaluate(c))/Math.LN10],ln:[nn,[nn],(c,[a])=>Math.log(a.evaluate(c))],log2:[nn,[nn],(c,[a])=>Math.log(a.evaluate(c))/Math.LN2],sin:[nn,[nn],(c,[a])=>Math.sin(a.evaluate(c))],cos:[nn,[nn],(c,[a])=>Math.cos(a.evaluate(c))],tan:[nn,[nn],(c,[a])=>Math.tan(a.evaluate(c))],asin:[nn,[nn],(c,[a])=>Math.asin(a.evaluate(c))],acos:[nn,[nn],(c,[a])=>Math.acos(a.evaluate(c))],atan:[nn,[nn],(c,[a])=>Math.atan(a.evaluate(c))],min:[nn,Bs(nn),(c,a)=>Math.min(...a.map(u=>u.evaluate(c)))],max:[nn,Bs(nn),(c,a)=>Math.max(...a.map(u=>u.evaluate(c)))],abs:[nn,[nn],(c,[a])=>Math.abs(a.evaluate(c))],round:[nn,[nn],(c,[a])=>{const u=a.evaluate(c);return u<0?-Math.round(-u):Math.round(u)}],floor:[nn,[nn],(c,[a])=>Math.floor(a.evaluate(c))],ceil:[nn,[nn],(c,[a])=>Math.ceil(a.evaluate(c))],"filter-==":[Jn,[Kn,ni],(c,[a,u])=>c.properties()[a.value]===u.value],"filter-id-==":[Jn,[ni],(c,[a])=>c.id()===a.value],"filter-type-==":[Jn,[Kn],(c,[a])=>c.geometryType()===a.value],"filter-<":[Jn,[Kn,ni],(c,[a,u])=>{const f=c.properties()[a.value],g=u.value;return typeof f==typeof g&&f<g}],"filter-id-<":[Jn,[ni],(c,[a])=>{const u=c.id(),f=a.value;return typeof u==typeof f&&u<f}],"filter->":[Jn,[Kn,ni],(c,[a,u])=>{const f=c.properties()[a.value],g=u.value;return typeof f==typeof g&&f>g}],"filter-id->":[Jn,[ni],(c,[a])=>{const u=c.id(),f=a.value;return typeof u==typeof f&&u>f}],"filter-<=":[Jn,[Kn,ni],(c,[a,u])=>{const f=c.properties()[a.value],g=u.value;return typeof f==typeof g&&f<=g}],"filter-id-<=":[Jn,[ni],(c,[a])=>{const u=c.id(),f=a.value;return typeof u==typeof f&&u<=f}],"filter->=":[Jn,[Kn,ni],(c,[a,u])=>{const f=c.properties()[a.value],g=u.value;return typeof f==typeof g&&f>=g}],"filter-id->=":[Jn,[ni],(c,[a])=>{const u=c.id(),f=a.value;return typeof u==typeof f&&u>=f}],"filter-has":[Jn,[ni],(c,[a])=>a.value in c.properties()],"filter-has-id":[Jn,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[Jn,[ve(Kn)],(c,[a])=>a.value.indexOf(c.geometryType())>=0],"filter-id-in":[Jn,[ve(ni)],(c,[a])=>a.value.indexOf(c.id())>=0],"filter-in-small":[Jn,[Kn,ve(ni)],(c,[a,u])=>u.value.indexOf(c.properties()[a.value])>=0],"filter-in-large":[Jn,[Kn,ve(ni)],(c,[a,u])=>function(f,g,b,E){for(;b<=E;){const C=b+E>>1;if(g[C]===f)return!0;g[C]>f?E=C-1:b=C+1}return!1}(c.properties()[a.value],u.value,0,u.value.length-1)],all:{type:Jn,overloads:[[[Jn,Jn],(c,[a,u])=>a.evaluate(c)&&u.evaluate(c)],[Bs(Jn),(c,a)=>{for(const u of a)if(!u.evaluate(c))return!1;return!0}]]},any:{type:Jn,overloads:[[[Jn,Jn],(c,[a,u])=>a.evaluate(c)||u.evaluate(c)],[Bs(Jn),(c,a)=>{for(const u of a)if(u.evaluate(c))return!0;return!1}]]},"!":[Jn,[Jn],(c,[a])=>!a.evaluate(c)],"is-supported-script":[Jn,[Kn],(c,[a])=>{const u=c.globals&&c.globals.isSupportedScript;return!u||u(a.evaluate(c))}],upcase:[Kn,[Kn],(c,[a])=>a.evaluate(c).toUpperCase()],downcase:[Kn,[Kn],(c,[a])=>a.evaluate(c).toLowerCase()],concat:[Kn,Bs(ni),(c,a)=>a.map(u=>gr(u.evaluate(c))).join("")],"resolved-locale":[Kn,[Ro],(c,[a])=>a.evaluate(c).resolvedLocale()]});var ed=Y_;function Q_(c){return{result:"success",value:c}}function wc(c){return{result:"error",value:c}}function Iu(c){return c["property-type"]==="data-driven"}function jf(c){return!!c.expression&&c.expression.parameters.indexOf("zoom")>-1}function $f(c){return!!c.expression&&c.expression.interpolated}function Pi(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}function td(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function e1(c){return c}function Gf(c,a){const u=a.type==="color",f=c.stops&&typeof c.stops[0][0]=="object",g=f||!(f||c.property!==void 0),b=c.type||($f(a)?"exponential":"interval");if(u&&((c=No({},c)).stops&&(c.stops=c.stops.map(M=>[M[0],on.parse(M[1])])),c.default=on.parse(c.default?c.default:a.default)),c.colorSpace&&c.colorSpace!=="rgb"&&!xg[c.colorSpace])throw new Error(`Unknown color space: ${c.colorSpace}`);let E,C,P;if(b==="exponential")E=nl;else if(b==="interval")E=Hf;else if(b==="categorical"){E=t1,C=Object.create(null);for(const M of c.stops)C[M[0]]=M[1];P=typeof c.stops[0][0]}else{if(b!=="identity")throw new Error(`Unknown function type "${b}"`);E=n1}if(f){const M={},D=[];for(let H=0;H<c.stops.length;H++){const W=c.stops[H],Q=W[0].zoom;M[Q]===void 0&&(M[Q]={zoom:Q,type:c.type,property:c.property,default:c.default,stops:[]},D.push(Q)),M[Q].stops.push([W[0].value,W[1]])}const N=[];for(const H of D)N.push([M[H].zoom,Gf(M[H],a)]);const V={name:"linear"};return{kind:"composite",interpolationType:V,interpolationFactor:Pa.interpolationFactor.bind(void 0,V),zoomStops:N.map(H=>H[0]),evaluate:({zoom:H},W)=>nl({stops:N,base:c.base},a,H).evaluate(H,W)}}if(g){const M=b==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:M,interpolationFactor:Pa.interpolationFactor.bind(void 0,M),zoomStops:c.stops.map(D=>D[0]),evaluate:({zoom:D})=>E(c,a,D,C,P)}}return{kind:"source",evaluate(M,D){const N=D&&D.properties?D.properties[c.property]:void 0;return N===void 0?Mu(c.default,a.default):E(c,a,N,C,P)}}}function Mu(c,a,u){return c!==void 0?c:a!==void 0?a:u!==void 0?u:void 0}function t1(c,a,u,f,g){return Mu(typeof u===g?f[u]:void 0,c.default,a.default)}function Hf(c,a,u){if(Pi(u)!=="number")return Mu(c.default,a.default);const f=c.stops.length;if(f===1||u<=c.stops[0][0])return c.stops[0][1];if(u>=c.stops[f-1][0])return c.stops[f-1][1];const g=Of(c.stops.map(b=>b[0]),u);return c.stops[g][1]}function nl(c,a,u){const f=c.base!==void 0?c.base:1;if(Pi(u)!=="number")return Mu(c.default,a.default);const g=c.stops.length;if(g===1||u<=c.stops[0][0])return c.stops[0][1];if(u>=c.stops[g-1][0])return c.stops[g-1][1];const b=Of(c.stops.map(D=>D[0]),u),E=function(D,N,V,H){const W=H-V,Q=D-V;return W===0?0:N===1?Q/W:(Math.pow(N,Q)-1)/(Math.pow(N,W)-1)}(u,f,c.stops[b][0],c.stops[b+1][0]),C=c.stops[b][1],P=c.stops[b+1][1];let M=Zh[a.type]||e1;if(c.colorSpace&&c.colorSpace!=="rgb"){const D=xg[c.colorSpace];M=(N,V)=>D.reverse(D.interpolate(D.forward(N),D.forward(V),E))}return typeof C.evaluate=="function"?{evaluate(...D){const N=C.evaluate.apply(void 0,D),V=P.evaluate.apply(void 0,D);if(N!==void 0&&V!==void 0)return M(N,V,E)}}:M(C,P,E)}function n1(c,a,u){return a.type==="color"?u=on.parse(u):a.type==="formatted"?u=xi.fromString(u.toString()):a.type==="resolvedImage"?u=Si.fromString(u.toString()):Pi(u)===a.type||a.type==="enum"&&a.values[u]||(u=void 0),Mu(u,c.default,a.default)}class Wf{constructor(a,u){this.expression=a,this._warningHistory={},this._evaluator=new ag,this._defaultValue=u?function(f){return f.type==="color"&&(td(f.default)||Array.isArray(f.default))?new on(0,0,0,0):f.type==="color"?on.parse(f.default)||null:f.default===void 0?null:f.default}(u):null,this._enumValues=u&&u.type==="enum"?u.values:null}evaluateWithoutErrorHandling(a,u,f,g,b,E,C,P){return this._evaluator.globals=a,this._evaluator.feature=u,this._evaluator.featureState=f,this._evaluator.canonical=g||null,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=E,this._evaluator.featureTileCoord=C||null,this._evaluator.featureDistanceData=P||null,this.expression.evaluate(this._evaluator)}evaluate(a,u,f,g,b,E,C,P){this._evaluator.globals=a,this._evaluator.feature=u||null,this._evaluator.featureState=f||null,this._evaluator.canonical=g||null,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=E||null,this._evaluator.featureTileCoord=C||null,this._evaluator.featureDistanceData=P||null;try{const M=this.expression.evaluate(this._evaluator);if(M==null||typeof M=="number"&&M!=M)return this._defaultValue;if(this._enumValues&&!(M in this._enumValues))throw new ro(`Expected value to be one of ${Object.keys(this._enumValues).map(D=>JSON.stringify(D)).join(", ")}, but found ${JSON.stringify(M)} instead.`);return M}catch(M){return this._warningHistory[M.message]||(this._warningHistory[M.message]=!0,typeof console<"u"&&console.warn(M.message)),this._defaultValue}}}function Ru(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in ed}function Lu(c,a){const u=new fg(ed,[],a?function(g){const b={color:yo,string:Kn,number:nn,enum:Kn,boolean:Jn,formatted:Ya,resolvedImage:se};return g.type==="array"?ve(b[g.value]||ni,g.length):b[g.type]}(a):void 0),f=u.parse(c,void 0,void 0,void 0,a&&a.type==="string"?{typeAnnotation:"coerce"}:void 0);return f?Q_(new Wf(f,a)):wc(u.errors)}class Pg{constructor(a,u){this.kind=a,this._styleExpression=u,this.isStateDependent=a!=="constant"&&!el(u.expression)}evaluateWithoutErrorHandling(a,u,f,g,b,E){return this._styleExpression.evaluateWithoutErrorHandling(a,u,f,g,b,E)}evaluate(a,u,f,g,b,E){return this._styleExpression.evaluate(a,u,f,g,b,E)}}class nd{constructor(a,u,f,g){this.kind=a,this.zoomStops=f,this._styleExpression=u,this.isStateDependent=a!=="camera"&&!el(u.expression),this.interpolationType=g}evaluateWithoutErrorHandling(a,u,f,g,b,E){return this._styleExpression.evaluateWithoutErrorHandling(a,u,f,g,b,E)}evaluate(a,u,f,g,b,E){return this._styleExpression.evaluate(a,u,f,g,b,E)}interpolationFactor(a,u,f){return this.interpolationType?Pa.interpolationFactor(this.interpolationType,a,u,f):0}}function id(c,a){if((c=Lu(c,a)).result==="error")return c;const u=c.value.expression,f=Su(u);if(!f&&!Iu(a))return wc([new go("","data expressions not supported")]);const g=bc(u,["zoom","pitch","distance-from-center"]);if(!g&&!jf(a))return wc([new go("","zoom expressions not supported")]);const b=Xf(u);return b||g?b instanceof go?wc([b]):b instanceof Pa&&!$f(a)?wc([new go("",'"interpolate" expressions cannot be used with this property')]):Q_(b?new nd(f?"camera":"composite",c.value,b.labels,b instanceof Pa?b.interpolation:void 0):new Pg(f?"constant":"source",c.value)):wc([new go("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Kf{constructor(a,u){this._parameters=a,this._specification=u,No(this,Gf(this._parameters,this._specification))}static deserialize(a){return new Kf(a._parameters,a._specification)}static serialize(a){return{_parameters:a._parameters,_specification:a._specification}}}function Xf(c){let a=null;if(c instanceof H_)a=Xf(c.result);else if(c instanceof Eg){for(const u of c.args)if(a=Xf(u),a)break}else(c instanceof mg||c instanceof Pa)&&c.input instanceof Ja&&c.input.name==="zoom"&&(a=c);return a instanceof go||c.eachChild(u=>{const f=Xf(u);f instanceof go?a=f:!a&&f?a=new go("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):a&&f&&a!==f&&(a=new go("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),a}class ln{constructor(a,u,f,g){this.message=(a?`${a}: `:"")+f,g&&(this.identifier=g),u!=null&&u.__line__&&(this.line=u.__line__)}}function sa(c){const a=c.key,u=c.value,f=c.valueSpec||{},g=c.objectElementValidators||{},b=c.style,E=c.styleSpec;let C=[];const P=Pi(u);if(P!=="object")return[new ln(a,u,`object expected, ${P} found`)];for(const M in u){const D=M.split(".")[0];let N;g[D]?N=g[D]:f[D]?N=Uo:g["*"]?N=g["*"]:f["*"]&&(N=Uo),N?C=C.concat(N({key:(a&&`${a}.`)+M,value:u[M],valueSpec:f[D]||f["*"],style:b,styleSpec:E,object:u,objectKey:M},u)):C.push(new ln(a,u[M],`unknown property "${M}"`))}for(const M in f)g[M]||f[M].required&&f[M].default===void 0&&u[M]===void 0&&C.push(new ln(a,u,`missing required property "${M}"`));return C}function i1(c){const a=c.value,u=c.valueSpec,f=c.style,g=c.styleSpec,b=c.key,E=c.arrayElementValidator||Uo;if(Pi(a)!=="array")return[new ln(b,a,`array expected, ${Pi(a)} found`)];if(u.length&&a.length!==u.length)return[new ln(b,a,`array length ${u.length} expected, length ${a.length} found`)];if(u["min-length"]&&a.length<u["min-length"])return[new ln(b,a,`array length at least ${u["min-length"]} expected, length ${a.length} found`)];let C={type:u.value,values:u.values,minimum:u.minimum,maximum:u.maximum,function:void 0};g.$version<7&&(C.function=u.function),Pi(u.value)==="object"&&(C=u.value);let P=[];for(let M=0;M<a.length;M++)P=P.concat(E({array:a,arrayIndex:M,value:a[M],valueSpec:C,style:f,styleSpec:g,key:`${b}[${M}]`}));return P}function rd(c){const a=c.key,u=c.value,f=c.valueSpec;let g=Pi(u);if(g==="number"&&u!=u&&(g="NaN"),g!=="number")return[new ln(a,u,`number expected, ${g} found`)];if("minimum"in f){let b=f.minimum;if(Pi(f.minimum)==="array"&&(b=f.minimum[c.arrayIndex]),u<b)return[new ln(a,u,`${u} is less than the minimum value ${b}`)]}if("maximum"in f){let b=f.maximum;if(Pi(f.maximum)==="array"&&(b=f.maximum[c.arrayIndex]),u>b)return[new ln(a,u,`${u} is greater than the maximum value ${b}`)]}return[]}function od(c){const a=c.valueSpec,u=sr(c.value.type);let f,g,b,E={};const C=u!=="categorical"&&c.value.property===void 0,P=!C,M=Pi(c.value.stops)==="array"&&Pi(c.value.stops[0])==="array"&&Pi(c.value.stops[0][0])==="object",D=sa({key:c.key,value:c.value,valueSpec:c.styleSpec.function,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{stops:function(H){if(u==="identity")return[new ln(H.key,H.value,'identity function may not have a "stops" property')];let W=[];const Q=H.value;return W=W.concat(i1({key:H.key,value:Q,valueSpec:H.valueSpec,style:H.style,styleSpec:H.styleSpec,arrayElementValidator:N})),Pi(Q)==="array"&&Q.length===0&&W.push(new ln(H.key,Q,"array must have at least one stop")),W},default:function(H){return Uo({key:H.key,value:H.value,valueSpec:a,style:H.style,styleSpec:H.styleSpec})}}});return u==="identity"&&C&&D.push(new ln(c.key,c.value,'missing required property "property"')),u==="identity"||c.value.stops||D.push(new ln(c.key,c.value,'missing required property "stops"')),u==="exponential"&&c.valueSpec.expression&&!$f(c.valueSpec)&&D.push(new ln(c.key,c.value,"exponential functions not supported")),c.styleSpec.$version>=8&&(P&&!Iu(c.valueSpec)?D.push(new ln(c.key,c.value,"property functions not supported")):C&&!jf(c.valueSpec)&&D.push(new ln(c.key,c.value,"zoom functions not supported"))),u!=="categorical"&&!M||c.value.property!==void 0||D.push(new ln(c.key,c.value,'"property" property is required')),D;function N(H){let W=[];const Q=H.value,oe=H.key;if(Pi(Q)!=="array")return[new ln(oe,Q,`array expected, ${Pi(Q)} found`)];if(Q.length!==2)return[new ln(oe,Q,`array length 2 expected, length ${Q.length} found`)];if(M){if(Pi(Q[0])!=="object")return[new ln(oe,Q,`object expected, ${Pi(Q[0])} found`)];if(Q[0].zoom===void 0)return[new ln(oe,Q,"object stop key must have zoom")];if(Q[0].value===void 0)return[new ln(oe,Q,"object stop key must have value")];const xe=sr(Q[0].zoom);if(typeof xe!="number")return[new ln(oe,Q[0].zoom,"stop zoom values must be numbers")];if(b&&b>xe)return[new ln(oe,Q[0].zoom,"stop zoom values must appear in ascending order")];xe!==b&&(b=xe,g=void 0,E={}),W=W.concat(sa({key:`${oe}[0]`,value:Q[0],valueSpec:{zoom:{}},style:H.style,styleSpec:H.styleSpec,objectElementValidators:{zoom:rd,value:V}}))}else W=W.concat(V({key:`${oe}[0]`,value:Q[0],valueSpec:{},style:H.style,styleSpec:H.styleSpec},Q));return Ru(Ai(Q[1]))?W.concat([new ln(`${oe}[1]`,Q[1],"expressions are not allowed in function stops.")]):W.concat(Uo({key:`${oe}[1]`,value:Q[1],valueSpec:a,style:H.style,styleSpec:H.styleSpec}))}function V(H,W){const Q=Pi(H.value),oe=sr(H.value),xe=H.value!==null?H.value:W;if(f){if(Q!==f)return[new ln(H.key,xe,`${Q} stop domain type must match previous stop domain type ${f}`)]}else f=Q;if(Q!=="number"&&Q!=="string"&&Q!=="boolean"&&typeof oe!="number"&&typeof oe!="string"&&typeof oe!="boolean")return[new ln(H.key,xe,"stop domain value must be a number, string, or boolean")];if(Q!=="number"&&u!=="categorical"){let Me=`number expected, ${Q} found`;return Iu(a)&&u===void 0&&(Me+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ln(H.key,xe,Me)]}return u!=="categorical"||Q!=="number"||typeof oe=="number"&&isFinite(oe)&&Math.floor(oe)===oe?u!=="categorical"&&Q==="number"&&typeof oe=="number"&&typeof g=="number"&&g!==void 0&&oe<g?[new ln(H.key,xe,"stop domain values must appear in ascending order")]:(g=oe,u==="categorical"&&oe in E?[new ln(H.key,xe,"stop domain values must be unique")]:(E[oe]=!0,[])):[new ln(H.key,xe,`integer expected, found ${String(oe)}`)]}}function wo(c){const a=(c.expressionContext==="property"?id:Lu)(Ai(c.value),c.valueSpec);if(a.result==="error")return a.value.map(f=>new ln(`${c.key}${f.key}`,c.value,f.message));const u=a.value.expression||a.value._styleExpression.expression;if(c.expressionContext==="property"&&c.propertyKey==="text-font"&&!u.outputDefined())return[new ln(c.key,c.value,`Invalid data expression for "${c.propertyKey}". Output values must be contained as literals within the expression.`)];if(c.expressionContext==="property"&&c.propertyType==="layout"&&!el(u))return[new ln(c.key,c.value,'"feature-state" data expressions are not supported with layout properties.')];if(c.expressionContext==="filter")return sd(u,c);if(c.expressionContext&&c.expressionContext.indexOf("cluster")===0){if(!bc(u,["zoom","feature-state"]))return[new ln(c.key,c.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(c.expressionContext==="cluster-initial"&&!Su(u))return[new ln(c.key,c.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function sd(c,a){const u=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(a.valueSpec&&a.valueSpec.expression)for(const g of a.valueSpec.expression.parameters)u.delete(g);if(u.size===0)return[];const f=[];return c instanceof Ja&&u.has(c.name)?[new ln(a.key,a.value,`["${c.name}"] expression is not supported in a filter for a ${a.object.type} layer with id: ${a.object.id}`)]:(c.eachChild(g=>{f.push(...sd(g,a))}),f)}function Zf(c){const a=c.key,u=c.value,f=c.valueSpec,g=[];return Array.isArray(f.values)?f.values.indexOf(sr(u))===-1&&g.push(new ln(a,u,`expected one of [${f.values.join(", ")}], ${JSON.stringify(u)} found`)):Object.keys(f.values).indexOf(sr(u))===-1&&g.push(new ln(a,u,`expected one of [${Object.keys(f.values).join(", ")}], ${JSON.stringify(u)} found`)),g}function Ig(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const a of c.slice(1))if(!Ig(a)&&typeof a!="boolean")return!1;return!0;default:return!0}}function qf(c,a="fill"){if(c==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Ig(c)||(c=Du(c));const u=c;let f=!0;try{f=function(M){if(!Ou(M))return M;let D=Ai(M);return Yf(D),D=r1(D),D}(u)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(u,null,2)}
        `)}const g=yt[`filter_${a}`],b=Lu(f,g);let E=null;if(b.result==="error")throw new Error(b.value.map(M=>`${M.key}: ${M.message}`).join(", "));E=(M,D,N)=>b.value.evaluate(M,D,{},N);let C=null,P=null;if(f!==u){const M=Lu(u,g);if(M.result==="error")throw new Error(M.value.map(D=>`${D.key}: ${D.message}`).join(", "));C=(D,N,V,H,W)=>M.value.evaluate(D,N,{},V,void 0,void 0,H,W),P=!Su(M.value.expression)}return{filter:E,dynamicFilter:C||void 0,needGeometry:o1(f),needFeature:!!P}}function r1(c){if(!Array.isArray(c))return c;const a=function(u){if(Mg.has(u[0])){for(let f=1;f<u.length;f++)if(Ou(u[f]))return!0}return u}(c);return a===!0?a:a.map(u=>r1(u))}function Yf(c){let a=!1;const u=[];if(c[0]==="case"){for(let f=1;f<c.length-1;f+=2)a=a||Ou(c[f]),u.push(c[f+1]);u.push(c[c.length-1])}else if(c[0]==="match"){a=a||Ou(c[1]);for(let f=2;f<c.length-1;f+=2)u.push(c[f+1]);u.push(c[c.length-1])}else if(c[0]==="step"){a=a||Ou(c[1]);for(let f=1;f<c.length-1;f+=2)u.push(c[f+1])}a&&(c.length=0,c.push("any",...u));for(let f=1;f<c.length;f++)Yf(c[f])}function Ou(c){if(!Array.isArray(c))return!1;if((a=c[0])==="pitch"||a==="distance-from-center")return!0;var a;for(let u=1;u<c.length;u++)if(Ou(c[u]))return!0;return!1}const Mg=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function TE(c,a){return c<a?-1:c>a?1:0}function o1(c){if(!Array.isArray(c))return!1;if(c[0]==="within")return!0;for(let a=1;a<c.length;a++)if(o1(c[a]))return!0;return!1}function Du(c){if(!c)return!0;const a=c[0];return c.length<=1?a!=="any":a==="=="?Rg(c[1],c[2],"=="):a==="!="?Jf(Rg(c[1],c[2],"==")):a==="<"||a===">"||a==="<="||a===">="?Rg(c[1],c[2],a):a==="any"?(u=c.slice(1),["any"].concat(u.map(Du))):a==="all"?["all"].concat(c.slice(1).map(Du)):a==="none"?["all"].concat(c.slice(1).map(Du).map(Jf)):a==="in"?Lg(c[1],c.slice(2)):a==="!in"?Jf(Lg(c[1],c.slice(2))):a==="has"?Og(c[1]):a==="!has"?Jf(Og(c[1])):a!=="within"||c;var u}function Rg(c,a,u){switch(c){case"$type":return[`filter-type-${u}`,a];case"$id":return[`filter-id-${u}`,a];default:return[`filter-${u}`,c,a]}}function Lg(c,a){if(a.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",a]];case"$id":return["filter-id-in",["literal",a]];default:return a.length>200&&!a.some(u=>typeof u!=typeof a[0])?["filter-in-large",c,["literal",a.sort(TE)]]:["filter-in-small",c,["literal",a]]}}function Og(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function Jf(c){return["!",c]}function ad(c){return Ig(Ai(c.value))?wo(No({},c,{expressionContext:"filter",valueSpec:c.styleSpec[`filter_${c.layerType||"fill"}`]})):ld(c)}function ld(c){const a=c.value,u=c.key;if(Pi(a)!=="array")return[new ln(u,a,`array expected, ${Pi(a)} found`)];const f=c.styleSpec;let g,b=[];if(a.length<1)return[new ln(u,a,"filter array must have at least 1 element")];switch(b=b.concat(Zf({key:`${u}[0]`,value:a[0],valueSpec:f.filter_operator,style:c.style,styleSpec:c.styleSpec})),sr(a[0])){case"<":case"<=":case">":case">=":a.length>=2&&sr(a[1])==="$type"&&b.push(new ln(u,a,`"$type" cannot be use with operator "${a[0]}"`));case"==":case"!=":a.length!==3&&b.push(new ln(u,a,`filter array for operator "${a[0]}" must have 3 elements`));case"in":case"!in":a.length>=2&&(g=Pi(a[1]),g!=="string"&&b.push(new ln(`${u}[1]`,a[1],`string expected, ${g} found`)));for(let E=2;E<a.length;E++)g=Pi(a[E]),sr(a[1])==="$type"?b=b.concat(Zf({key:`${u}[${E}]`,value:a[E],valueSpec:f.geometry_type,style:c.style,styleSpec:c.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&b.push(new ln(`${u}[${E}]`,a[E],`string, number, or boolean expected, ${g} found`));break;case"any":case"all":case"none":for(let E=1;E<a.length;E++)b=b.concat(ld({key:`${u}[${E}]`,value:a[E],style:c.style,styleSpec:c.styleSpec}));break;case"has":case"!has":g=Pi(a[1]),a.length!==2?b.push(new ln(u,a,`filter array for "${a[0]}" operator must have 2 elements`)):g!=="string"&&b.push(new ln(`${u}[1]`,a[1],`string expected, ${g} found`));break;case"within":g=Pi(a[1]),a.length!==2?b.push(new ln(u,a,`filter array for "${a[0]}" operator must have 2 elements`)):g!=="object"&&b.push(new ln(`${u}[1]`,a[1],`object expected, ${g} found`))}return b}function Dg(c,a){const u=c.key,f=c.style,g=c.styleSpec,b=c.value,E=c.objectKey,C=g[`${a}_${c.layerType}`];if(!C)return[];const P=E.match(/^(.*)-transition$/);if(a==="paint"&&P&&C[P[1]]&&C[P[1]].transition)return Uo({key:u,value:b,valueSpec:g.transition,style:f,styleSpec:g});const M=c.valueSpec||C[E];if(!M)return[new ln(u,b,`unknown property "${E}"`)];let D;if(Pi(b)==="string"&&Iu(M)&&!M.tokens&&(D=/^{([^}]+)}$/.exec(b))){const V=`\`{ "type": "identity", "property": ${D?JSON.stringify(D[1]):'"_"'} }\``;return[new ln(u,b,`"${E}" does not support interpolation syntax
Use an identity property function instead: ${V}.`)]}const N=[];return c.layerType==="symbol"&&(E==="text-field"&&f&&!f.glyphs&&N.push(new ln(u,b,'use of "text-field" requires a style "glyphs" property')),E==="text-font"&&td(Ai(b))&&sr(b.type)==="identity"&&N.push(new ln(u,b,'"text-font" does not support identity functions'))),N.concat(Uo({key:c.key,value:b,valueSpec:M,style:f,styleSpec:g,expressionContext:"property",propertyType:a,propertyKey:E}))}function s1(c){return Dg(c,"paint")}function kg(c){return Dg(c,"layout")}function a1(c){let a=[];const u=c.value,f=c.key,g=c.style,b=c.styleSpec;u.type||u.ref||a.push(new ln(f,u,'either "type" or "ref" is required'));let E=sr(u.type);const C=sr(u.ref);if(u.id){const P=sr(u.id);for(let M=0;M<c.arrayIndex;M++){const D=g.layers[M];sr(D.id)===P&&a.push(new ln(f,u.id,`duplicate layer id "${u.id}", previously used at line ${D.id.__line__}`))}}if("ref"in u){let P;["type","source","source-layer","filter","layout"].forEach(M=>{M in u&&a.push(new ln(f,u[M],`"${M}" is prohibited for ref layers`))}),g.layers.forEach(M=>{sr(M.id)===C&&(P=M)}),P?P.ref?a.push(new ln(f,u.ref,"ref cannot reference another ref layer")):E=sr(P.type):typeof C=="string"&&a.push(new ln(f,u.ref,`ref layer "${C}" not found`))}else if(E!=="background"&&E!=="sky")if(u.source){const P=g.sources&&g.sources[u.source],M=P&&sr(P.type);P?M==="vector"&&E==="raster"?a.push(new ln(f,u.source,`layer "${u.id}" requires a raster source`)):M==="raster"&&E!=="raster"?a.push(new ln(f,u.source,`layer "${u.id}" requires a vector source`)):M!=="vector"||u["source-layer"]?M==="raster-dem"&&E!=="hillshade"?a.push(new ln(f,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):E!=="line"||!u.paint||!u.paint["line-gradient"]&&!u.paint["line-trim-offset"]||M==="geojson"&&P.lineMetrics||a.push(new ln(f,u,`layer "${u.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):a.push(new ln(f,u,`layer "${u.id}" must specify a "source-layer"`)):a.push(new ln(f,u.source,`source "${u.source}" not found`))}else a.push(new ln(f,u,'missing required property "source"'));return a=a.concat(sa({key:f,value:u,valueSpec:b.layer,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Uo({key:`${f}.type`,value:u.type,valueSpec:b.layer.type,style:c.style,styleSpec:c.styleSpec,object:u,objectKey:"type"}),filter:P=>ad(No({layerType:E},P)),layout:P=>sa({layer:u,key:P.key,value:P.value,valueSpec:{},style:P.style,styleSpec:P.styleSpec,objectElementValidators:{"*":M=>kg(No({layerType:E},M))}}),paint:P=>sa({layer:u,key:P.key,value:P.value,valueSpec:{},style:P.style,styleSpec:P.styleSpec,objectElementValidators:{"*":M=>s1(No({layerType:E},M))}})}})),a}function kl(c){const a=c.value,u=c.key,f=Pi(a);return f!=="string"?[new ln(u,a,`string expected, ${f} found`)]:[]}const l1={promoteId:function({key:c,value:a}){if(Pi(a)==="string")return kl({key:c,value:a});{const u=[];for(const f in a)u.push(...kl({key:`${c}.${f}`,value:a[f]}));return u}}};function c1(c){const a=c.value,u=c.key,f=c.styleSpec,g=c.style;if(!a.type)return[new ln(u,a,'"type" is required')];const b=sr(a.type);let E;switch(b){case"vector":case"raster":case"raster-dem":return E=sa({key:u,value:a,valueSpec:f[`source_${b.replace("-","_")}`],style:c.style,styleSpec:f,objectElementValidators:l1}),E;case"geojson":if(E=sa({key:u,value:a,valueSpec:f.source_geojson,style:g,styleSpec:f,objectElementValidators:l1}),a.cluster)for(const C in a.clusterProperties){const[P,M]=a.clusterProperties[C],D=typeof P=="string"?[P,["accumulated"],["get",C]]:P;E.push(...wo({key:`${u}.${C}.map`,value:M,expressionContext:"cluster-map"})),E.push(...wo({key:`${u}.${C}.reduce`,value:D,expressionContext:"cluster-reduce"}))}return E;case"video":return sa({key:u,value:a,valueSpec:f.source_video,style:g,styleSpec:f});case"image":return sa({key:u,value:a,valueSpec:f.source_image,style:g,styleSpec:f});case"canvas":return[new ln(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Zf({key:`${u}.type`,value:a.type,valueSpec:{values:SE(f)},style:g,styleSpec:f})}}function SE(c){return c.source.reduce((a,u)=>{const f=c[u];return f.type.type==="enum"&&(a=a.concat(Object.keys(f.type.values))),a},[])}function u1(c){const a=c.value,u=c.styleSpec,f=u.light,g=c.style;let b=[];const E=Pi(a);if(a===void 0)return b;if(E!=="object")return b=b.concat([new ln("light",a,`object expected, ${E} found`)]),b;for(const C in a){const P=C.match(/^(.*)-transition$/);b=b.concat(P&&f[P[1]]&&f[P[1]].transition?Uo({key:C,value:a[C],valueSpec:u.transition,style:g,styleSpec:u}):f[C]?Uo({key:C,value:a[C],valueSpec:f[C],style:g,styleSpec:u}):[new ln(C,a[C],`unknown property "${C}"`)])}return b}function Fg(c){const a=c.value,u=c.key,f=c.style,g=c.styleSpec,b=g.terrain;let E=[];const C=Pi(a);if(a===void 0)return E;if(C!=="object")return E=E.concat([new ln("terrain",a,`object expected, ${C} found`)]),E;for(const P in a){const M=P.match(/^(.*)-transition$/);E=E.concat(M&&b[M[1]]&&b[M[1]].transition?Uo({key:P,value:a[P],valueSpec:g.transition,style:f,styleSpec:g}):b[P]?Uo({key:P,value:a[P],valueSpec:b[P],style:f,styleSpec:g}):[new ln(P,a[P],`unknown property "${P}"`)])}if(a.source){const P=f.sources&&f.sources[a.source],M=P&&sr(P.type);P?M!=="raster-dem"&&E.push(new ln(u,a.source,`terrain cannot be used with a source of type ${String(M)}, it only be used with a "raster-dem" source type`)):E.push(new ln(u,a.source,`source "${a.source}" not found`))}else E.push(new ln(u,a,'terrain is missing required property "source"'));return E}function h1(c){const a=c.value,u=c.style,f=c.styleSpec,g=f.fog;let b=[];const E=Pi(a);if(a===void 0)return b;if(E!=="object")return b=b.concat([new ln("fog",a,`object expected, ${E} found`)]),b;for(const C in a){const P=C.match(/^(.*)-transition$/);b=b.concat(P&&g[P[1]]&&g[P[1]].transition?Uo({key:C,value:a[C],valueSpec:f.transition,style:u,styleSpec:f}):g[C]?Uo({key:C,value:a[C],valueSpec:g[C],style:u,styleSpec:f}):[new ln(C,a[C],`unknown property "${C}"`)])}return b}const d1={"*":()=>[],array:i1,boolean:function(c){const a=c.value,u=c.key,f=Pi(a);return f!=="boolean"?[new ln(u,a,`boolean expected, ${f} found`)]:[]},number:rd,color:function(c){const a=c.key,u=c.value,f=Pi(u);return f!=="string"?[new ln(a,u,`color expected, ${f} found`)]:Oe(u)===null?[new ln(a,u,`color expected, "${u}" found`)]:[]},enum:Zf,filter:ad,function:od,layer:a1,object:sa,source:c1,light:u1,terrain:Fg,fog:h1,string:kl,formatted:function(c){return kl(c).length===0?[]:wo(c)},resolvedImage:function(c){return kl(c).length===0?[]:wo(c)},projection:function(c){const a=c.value,u=c.styleSpec,f=u.projection,g=c.style;let b=[];const E=Pi(a);if(E==="object")for(const C in a)b=b.concat(Uo({key:C,value:a[C],valueSpec:f[C],style:g,styleSpec:u}));else E!=="string"&&(b=b.concat([new ln("projection",a,`object or string expected, ${E} found`)]));return b}};function Uo(c){const a=c.value,u=c.valueSpec,f=c.styleSpec;return u.expression&&td(sr(a))?od(c):u.expression&&Ru(Ai(a))?wo(c):u.type&&d1[u.type]?d1[u.type](c):sa(No({},c,{valueSpec:u.type?f[u.type]:u}))}function CE(c){const a=c.value,u=c.key,f=kl(c);return f.length||(a.indexOf("{fontstack}")===-1&&f.push(new ln(u,a,'"glyphs" url must include a "{fontstack}" token')),a.indexOf("{range}")===-1&&f.push(new ln(u,a,'"glyphs" url must include a "{range}" token'))),f}function f1(c,a=yt){return zs(Uo({key:"",value:c,valueSpec:a.$root,styleSpec:a,style:c,objectElementValidators:{glyphs:CE,"*":()=>[]}}))}const AE=c=>zs(s1(c)),PE=c=>zs(kg(c));function zs(c){return c.slice().sort((a,u)=>a.line&&u.line?a.line-u.line:0)}function p1(c,a){let u=!1;if(a&&a.length)for(const f of a)c.fire(new Br(new Error(f.message))),u=!0;return u}var IE=Ia,aa=3;function Ia(c,a,u){var f=this.cells=[];if(c instanceof ArrayBuffer){this.arrayBuffer=c;var g=new Int32Array(this.arrayBuffer);c=g[0],this.d=(a=g[1])+2*(u=g[2]);for(var b=0;b<this.d*this.d;b++){var E=g[aa+b],C=g[aa+b+1];f.push(E===C?null:g.subarray(E,C))}var P=g[aa+f.length+1];this.keys=g.subarray(g[aa+f.length],P),this.bboxes=g.subarray(P),this.insert=this._insertReadonly}else{this.d=a+2*u;for(var M=0;M<this.d*this.d;M++)f.push([]);this.keys=[],this.bboxes=[]}this.n=a,this.extent=c,this.padding=u,this.scale=a/c,this.uid=0;var D=u/a*c;this.min=-D,this.max=c+D}Ia.prototype.insert=function(c,a,u,f,g){this._forEachCell(a,u,f,g,this._insertCell,this.uid++),this.keys.push(c),this.bboxes.push(a),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(g)},Ia.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ia.prototype._insertCell=function(c,a,u,f,g,b){this.cells[g].push(b)},Ia.prototype.query=function(c,a,u,f,g){var b=this.min,E=this.max;if(c<=b&&a<=b&&E<=u&&E<=f&&!g)return Array.prototype.slice.call(this.keys);var C=[];return this._forEachCell(c,a,u,f,this._queryCell,C,{},g),C},Ia.prototype._queryCell=function(c,a,u,f,g,b,E,C){var P=this.cells[g];if(P!==null)for(var M=this.keys,D=this.bboxes,N=0;N<P.length;N++){var V=P[N];if(E[V]===void 0){var H=4*V;(C?C(D[H+0],D[H+1],D[H+2],D[H+3]):c<=D[H+2]&&a<=D[H+3]&&u>=D[H+0]&&f>=D[H+1])?(E[V]=!0,b.push(M[V])):E[V]=!1}}},Ia.prototype._forEachCell=function(c,a,u,f,g,b,E,C){for(var P=this._convertToCellCoord(c),M=this._convertToCellCoord(a),D=this._convertToCellCoord(u),N=this._convertToCellCoord(f),V=P;V<=D;V++)for(var H=M;H<=N;H++){var W=this.d*H+V;if((!C||C(this._convertFromCellCoord(V),this._convertFromCellCoord(H),this._convertFromCellCoord(V+1),this._convertFromCellCoord(H+1)))&&g.call(this,c,a,u,f,W,b,E,C))return}},Ia.prototype._convertFromCellCoord=function(c){return(c-this.padding)/this.scale},Ia.prototype._convertToCellCoord=function(c){return Math.max(0,Math.min(this.d-1,Math.floor(c*this.scale)+this.padding))},Ia.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var c=this.cells,a=aa+this.cells.length+1+1,u=0,f=0;f<this.cells.length;f++)u+=this.cells[f].length;var g=new Int32Array(a+u+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;for(var b=a,E=0;E<c.length;E++){var C=c[E];g[aa+E]=b,g.set(C,b),b+=C.length}return g[aa+c.length]=b,g.set(this.keys,b),g[aa+c.length+1]=b+=this.keys.length,g.set(this.bboxes,b),b+=this.bboxes.length,g.buffer};var Ec=G(IE);const Qf={};function dn(c,a,u={}){Object.defineProperty(c,"_classRegistryKey",{value:a,writeable:!1}),Qf[a]={klass:c,omit:u.omit||[]}}dn(Object,"Object"),Ec.serialize=function(c,a){const u=c.toArrayBuffer();return a&&a.push(u),{buffer:u}},Ec.deserialize=function(c){return new Ec(c.buffer)},Object.defineProperty(Ec,"name",{value:"Grid"}),dn(Ec,"Grid"),dn(on,"Color"),dn(Error,"Error"),dn(zt,"AJAXError"),dn(Si,"ResolvedImage"),dn(Kf,"StylePropertyFunction"),dn(Wf,"StyleExpression",{omit:["_evaluator"]}),dn(nd,"ZoomDependentExpression"),dn(Pg,"ZoomConstantExpression"),dn(Ja,"CompoundExpression",{omit:["_evaluate"]});for(const c in ed)Qf[ed[c]._classRegistryKey]||dn(ed[c],`Expression${c}`);function Bg(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function zg(c){return d.ImageBitmap&&c instanceof d.ImageBitmap}function ku(c,a){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp)return c;if(Bg(c)||zg(c))return a&&a.push(c),c;if(ArrayBuffer.isView(c)){const u=c;return a&&a.push(u.buffer),u}if(c instanceof d.ImageData)return a&&a.push(c.data.buffer),c;if(Array.isArray(c)){const u=[];for(const f of c)u.push(ku(f,a));return u}if(typeof c=="object"){const u=c.constructor,f=u._classRegistryKey;if(!f)throw new Error(`can't serialize object of unregistered class ${f}`);const g=u.serialize?u.serialize(c,a):{};if(!u.serialize){for(const b in c)c.hasOwnProperty(b)&&(Qf[f].omit.indexOf(b)>=0||(g[b]=ku(c[b],a)));c instanceof Error&&(g.message=c.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return f!=="Object"&&(g.$name=f),g}throw new Error("can't serialize object of type "+typeof c)}function Tc(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||Bg(c)||zg(c)||ArrayBuffer.isView(c)||c instanceof d.ImageData)return c;if(Array.isArray(c))return c.map(Tc);if(typeof c=="object"){const a=c.$name||"Object",{klass:u}=Qf[a];if(!u)throw new Error(`can't deserialize unregistered class ${a}`);if(u.deserialize)return u.deserialize(c);const f=Object.create(u.prototype);for(const g of Object.keys(c))g!=="$name"&&(f[g]=Tc(c[g]));return f}throw new Error("can't deserialize object of type "+typeof c)}const an={"Latin-1 Supplement":c=>c>=128&&c<=255,Arabic:c=>c>=1536&&c<=1791,"Arabic Supplement":c=>c>=1872&&c<=1919,"Arabic Extended-A":c=>c>=2208&&c<=2303,"Hangul Jamo":c=>c>=4352&&c<=4607,"Unified Canadian Aboriginal Syllabics":c=>c>=5120&&c<=5759,Khmer:c=>c>=6016&&c<=6143,"Unified Canadian Aboriginal Syllabics Extended":c=>c>=6320&&c<=6399,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"CJK Radicals Supplement":c=>c>=11904&&c<=12031,"Kangxi Radicals":c=>c>=12032&&c<=12255,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Bopomofo:c=>c>=12544&&c<=12591,"Hangul Compatibility Jamo":c=>c>=12592&&c<=12687,Kanbun:c=>c>=12688&&c<=12703,"Bopomofo Extended":c=>c>=12704&&c<=12735,"CJK Strokes":c=>c>=12736&&c<=12783,"Katakana Phonetic Extensions":c=>c>=12784&&c<=12799,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"CJK Unified Ideographs Extension A":c=>c>=13312&&c<=19903,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Yi Syllables":c=>c>=40960&&c<=42127,"Yi Radicals":c=>c>=42128&&c<=42191,"Hangul Jamo Extended-A":c=>c>=43360&&c<=43391,"Hangul Syllables":c=>c>=44032&&c<=55215,"Hangul Jamo Extended-B":c=>c>=55216&&c<=55295,"Private Use Area":c=>c>=57344&&c<=63743,"CJK Compatibility Ideographs":c=>c>=63744&&c<=64255,"Arabic Presentation Forms-A":c=>c>=64336&&c<=65023,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Arabic Presentation Forms-B":c=>c>=65136&&c<=65279,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519};function Ng(c){for(const a of c)if(Ug(a.charCodeAt(0)))return!0;return!1}function ME(c){for(const a of c)if(!m1(a.charCodeAt(0)))return!1;return!0}function m1(c){return!(an.Arabic(c)||an["Arabic Supplement"](c)||an["Arabic Extended-A"](c)||an["Arabic Presentation Forms-A"](c)||an["Arabic Presentation Forms-B"](c))}function Ug(c){return!(c!==746&&c!==747&&(c<4352||!(an["Bopomofo Extended"](c)||an.Bopomofo(c)||an["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||an["CJK Compatibility Ideographs"](c)||an["CJK Compatibility"](c)||an["CJK Radicals Supplement"](c)||an["CJK Strokes"](c)||!(!an["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||an["CJK Unified Ideographs Extension A"](c)||an["CJK Unified Ideographs"](c)||an["Enclosed CJK Letters and Months"](c)||an["Hangul Compatibility Jamo"](c)||an["Hangul Jamo Extended-A"](c)||an["Hangul Jamo Extended-B"](c)||an["Hangul Jamo"](c)||an["Hangul Syllables"](c)||an.Hiragana(c)||an["Ideographic Description Characters"](c)||an.Kanbun(c)||an["Kangxi Radicals"](c)||an["Katakana Phonetic Extensions"](c)||an.Katakana(c)&&c!==12540||!(!an["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!an["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||an["Unified Canadian Aboriginal Syllabics"](c)||an["Unified Canadian Aboriginal Syllabics Extended"](c)||an["Vertical Forms"](c)||an["Yijing Hexagram Symbols"](c)||an["Yi Syllables"](c)||an["Yi Radicals"](c))))}function g1(c){return!(Ug(c)||function(a){return!!(an["Latin-1 Supplement"](a)&&(a===167||a===169||a===174||a===177||a===188||a===189||a===190||a===215||a===247)||an["General Punctuation"](a)&&(a===8214||a===8224||a===8225||a===8240||a===8241||a===8251||a===8252||a===8258||a===8263||a===8264||a===8265||a===8273)||an["Letterlike Symbols"](a)||an["Number Forms"](a)||an["Miscellaneous Technical"](a)&&(a>=8960&&a<=8967||a>=8972&&a<=8991||a>=8996&&a<=9e3||a===9003||a>=9085&&a<=9114||a>=9150&&a<=9165||a===9167||a>=9169&&a<=9179||a>=9186&&a<=9215)||an["Control Pictures"](a)&&a!==9251||an["Optical Character Recognition"](a)||an["Enclosed Alphanumerics"](a)||an["Geometric Shapes"](a)||an["Miscellaneous Symbols"](a)&&!(a>=9754&&a<=9759)||an["Miscellaneous Symbols and Arrows"](a)&&(a>=11026&&a<=11055||a>=11088&&a<=11097||a>=11192&&a<=11243)||an["CJK Symbols and Punctuation"](a)||an.Katakana(a)||an["Private Use Area"](a)||an["CJK Compatibility Forms"](a)||an["Small Form Variants"](a)||an["Halfwidth and Fullwidth Forms"](a)||a===8734||a===8756||a===8757||a>=9984&&a<=10087||a>=10102&&a<=10131||a===65532||a===65533)}(c))}function y1(c){return c>=1424&&c<=2303||an["Arabic Presentation Forms-A"](c)||an["Arabic Presentation Forms-B"](c)}function RE(c,a){return!(!a&&y1(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||an.Khmer(c))}function LE(c){for(const a of c)if(y1(a.charCodeAt(0)))return!0;return!1}const Vg="deferred",jg="loading",$g="loaded";let Fu=null,_="unavailable",h=null;const m=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&(_="error"),Fu&&Fu(c)};function x(){S.fire(new Zo("pluginStateChange",{pluginStatus:_,pluginURL:h}))}const S=new Mo,A=function(){return _},R=function(){if(_!==Vg||!h)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");_=jg,x(),h&&Hn({url:h},c=>{c?m(c):(_=$g,x())})},O={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>_===$g||O.applyArabicShaping!=null,isLoading:()=>_===jg,setState(c){_=c.pluginStatus,h=c.pluginURL},isParsed:()=>O.applyArabicShaping!=null&&O.processBidirectionalText!=null&&O.processStyledBidirectionalText!=null,getPluginURL:()=>h};class z{constructor(a,u){this.zoom=a,u?(this.now=u.now,this.fadeDuration=u.fadeDuration,this.transition=u.transition,this.pitch=u.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(a){return function(u,f){for(const g of u)if(!RE(g.charCodeAt(0),f))return!1;return!0}(a,O.isLoaded())}}class ${constructor(a,u){this.property=a,this.value=u,this.expression=function(f,g){if(td(f))return new Kf(f,g);if(Ru(f)){const b=id(f,g);if(b.result==="error")throw new Error(b.value.map(E=>`${E.key}: ${E.message}`).join(", "));return b.value}{let b=f;return typeof f=="string"&&g.type==="color"&&(b=on.parse(f)),{kind:"constant",evaluate:()=>b}}}(u===void 0?a.specification.default:u,a.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(a,u,f){return this.property.possiblyEvaluate(this,a,u,f)}}class j{constructor(a){this.property=a,this.value=new $(a,void 0)}transitioned(a,u){return new re(this.property,this.value,u,An({},a.transition,this.transition),a.now)}untransitioned(){return new re(this.property,this.value,null,{},0)}}class Z{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitionablePropertyValues)}getValue(a){return Ae(this._values[a].value.value)}setValue(a,u){this._values.hasOwnProperty(a)||(this._values[a]=new j(this._values[a].property)),this._values[a].value=new $(this._values[a].property,u===null?void 0:Ae(u))}getTransition(a){return Ae(this._values[a].transition)}setTransition(a,u){this._values.hasOwnProperty(a)||(this._values[a]=new j(this._values[a].property)),this._values[a].transition=Ae(u)||void 0}serialize(){const a={};for(const u of Object.keys(this._values)){const f=this.getValue(u);f!==void 0&&(a[u]=f);const g=this.getTransition(u);g!==void 0&&(a[`${u}-transition`]=g)}return a}transitioned(a,u){const f=new he(this._properties);for(const g of Object.keys(this._values))f._values[g]=this._values[g].transitioned(a,u._values[g]);return f}untransitioned(){const a=new he(this._properties);for(const u of Object.keys(this._values))a._values[u]=this._values[u].untransitioned();return a}}class re{constructor(a,u,f,g,b){const E=g.delay||0,C=g.duration||0;b=b||0,this.property=a,this.value=u,this.begin=b+E,this.end=this.begin+C,a.specification.transition&&(g.delay||g.duration)&&(this.prior=f)}possiblyEvaluate(a,u,f){const g=a.now||0,b=this.value.possiblyEvaluate(a,u,f),E=this.prior;if(E){if(g>this.end)return this.prior=null,b;if(this.value.isDataDriven())return this.prior=null,b;if(g<this.begin)return E.possiblyEvaluate(a,u,f);{const C=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(E.possiblyEvaluate(a,u,f),b,ut(C))}}return b}}class he{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitioningPropertyValues)}possiblyEvaluate(a,u,f){const g=new _e(this._properties);for(const b of Object.keys(this._values))g._values[b]=this._values[b].possiblyEvaluate(a,u,f);return g}hasTransition(){for(const a of Object.keys(this._values))if(this._values[a].prior)return!0;return!1}}class ge{constructor(a){this._properties=a,this._values=Object.create(a.defaultPropertyValues)}getValue(a){return Ae(this._values[a].value)}setValue(a,u){this._values[a]=new $(this._values[a].property,u===null?void 0:Ae(u))}serialize(){const a={};for(const u of Object.keys(this._values)){const f=this.getValue(u);f!==void 0&&(a[u]=f)}return a}possiblyEvaluate(a,u,f){const g=new _e(this._properties);for(const b of Object.keys(this._values))g._values[b]=this._values[b].possiblyEvaluate(a,u,f);return g}}class pe{constructor(a,u,f){this.property=a,this.value=u,this.parameters=f}isConstant(){return this.value.kind==="constant"}constantOr(a){return this.value.kind==="constant"?this.value.value:a}evaluate(a,u,f,g){return this.property.evaluate(this.value,this.parameters,a,u,f,g)}}class _e{constructor(a){this._properties=a,this._values=Object.create(a.defaultPossiblyEvaluatedValues)}get(a){return this._values[a]}}class Y{constructor(a){this.specification=a}possiblyEvaluate(a,u){return a.expression.evaluate(u)}interpolate(a,u,f){const g=Zh[this.specification.type];return g?g(a,u,f):a}}class ce{constructor(a,u){this.specification=a,this.overrides=u}possiblyEvaluate(a,u,f,g){return new pe(this,a.expression.kind==="constant"||a.expression.kind==="camera"?{kind:"constant",value:a.expression.evaluate(u,null,{},f,g)}:a.expression,u)}interpolate(a,u,f){if(a.value.kind!=="constant"||u.value.kind!=="constant")return a;if(a.value.value===void 0||u.value.value===void 0)return new pe(this,{kind:"constant",value:void 0},a.parameters);const g=Zh[this.specification.type];return g?new pe(this,{kind:"constant",value:g(a.value.value,u.value.value,f)},a.parameters):a}evaluate(a,u,f,g,b,E){return a.kind==="constant"?a.value:a.evaluate(u,f,g,b,E)}}class Ee{constructor(a){this.specification=a}possiblyEvaluate(a,u,f,g){return!!a.expression.evaluate(u,null,{},f,g)}interpolate(){return!1}}class Se{constructor(a){this.properties=a,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const u=new z(0,{});for(const f in a){const g=a[f];g.specification.overridable&&this.overridableProperties.push(f);const b=this.defaultPropertyValues[f]=new $(g,void 0),E=this.defaultTransitionablePropertyValues[f]=new j(g);this.defaultTransitioningPropertyValues[f]=E.untransitioned(),this.defaultPossiblyEvaluatedValues[f]=b.possiblyEvaluate(u)}}}function ze(c,a){return 256*(c=bt(Math.floor(c),0,255))+bt(Math.floor(a),0,255)}dn(ce,"DataDrivenProperty"),dn(Y,"DataConstantProperty"),dn(Ee,"ColorRampProperty");const Ve={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ne{constructor(a,u){this._structArray=a,this._pos1=u*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ye{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(a,u){return a._trim(),u&&(a.isTransferred=!0,u.push(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}}static deserialize(a){const u=Object.create(this.prototype);return u.arrayBuffer=a.arrayBuffer,u.length=a.length,u.capacity=a.arrayBuffer.byteLength/u.bytesPerElement,u._refreshViews(),u}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(a){this.reserve(a),this.length=a}reserve(a){if(a>this.capacity){this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const u=this.uint8;this._refreshViews(),u&&this.uint8.set(u)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Xe(c,a=1){let u=0,f=0;return{members:c.map(g=>{const b=Ve[g.type].BYTES_PER_ELEMENT,E=u=st(u,Math.max(a,b)),C=g.components||1;return f=Math.max(f,b),u+=b*C,{name:g.name,type:g.type,components:C,offset:E}}),size:st(u,Math.max(f,a)),alignment:a}}function st(c,a){return Math.ceil(c/a)*a}class Ut extends Ye{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u){const f=this.length;return this.resize(f+1),this.emplace(f,a,u)}emplace(a,u,f){const g=2*a;return this.int16[g+0]=u,this.int16[g+1]=f,a}}Ut.prototype.bytesPerElement=4,dn(Ut,"StructArrayLayout2i4");class nt extends Ye{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,a,u,f)}emplace(a,u,f,g){const b=3*a;return this.int16[b+0]=u,this.int16[b+1]=f,this.int16[b+2]=g,a}}nt.prototype.bytesPerElement=6,dn(nt,"StructArrayLayout3i6");class wt extends Ye{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,f,g){const b=this.length;return this.resize(b+1),this.emplace(b,a,u,f,g)}emplace(a,u,f,g,b){const E=4*a;return this.int16[E+0]=u,this.int16[E+1]=f,this.int16[E+2]=g,this.int16[E+3]=b,a}}wt.prototype.bytesPerElement=8,dn(wt,"StructArrayLayout4i8");class dt extends Ye{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,f,g,b,E,C){const P=this.length;return this.resize(P+1),this.emplace(P,a,u,f,g,b,E,C)}emplace(a,u,f,g,b,E,C,P){const M=6*a,D=12*a,N=3*a;return this.int16[M+0]=u,this.int16[M+1]=f,this.uint8[D+4]=g,this.uint8[D+5]=b,this.uint8[D+6]=E,this.uint8[D+7]=C,this.float32[N+2]=P,a}}dt.prototype.bytesPerElement=12,dn(dt,"StructArrayLayout2i4ub1f12");class Bt extends Ye{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,f,g){const b=this.length;return this.resize(b+1),this.emplace(b,a,u,f,g)}emplace(a,u,f,g,b){const E=4*a;return this.float32[E+0]=u,this.float32[E+1]=f,this.float32[E+2]=g,this.float32[E+3]=b,a}}Bt.prototype.bytesPerElement=16,dn(Bt,"StructArrayLayout4f16");class ot extends Ye{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,f,g,b){const E=this.length;return this.resize(E+1),this.emplace(E,a,u,f,g,b)}emplace(a,u,f,g,b,E){const C=6*a,P=3*a;return this.uint16[C+0]=u,this.uint16[C+1]=f,this.uint16[C+2]=g,this.uint16[C+3]=b,this.float32[P+2]=E,a}}ot.prototype.bytesPerElement=12,dn(ot,"StructArrayLayout4ui1f12");class xt extends Ye{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,f,g){const b=this.length;return this.resize(b+1),this.emplace(b,a,u,f,g)}emplace(a,u,f,g,b){const E=4*a;return this.uint16[E+0]=u,this.uint16[E+1]=f,this.uint16[E+2]=g,this.uint16[E+3]=b,a}}xt.prototype.bytesPerElement=8,dn(xt,"StructArrayLayout4ui8");class jt extends Ye{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,f,g,b,E){const C=this.length;return this.resize(C+1),this.emplace(C,a,u,f,g,b,E)}emplace(a,u,f,g,b,E,C){const P=6*a;return this.int16[P+0]=u,this.int16[P+1]=f,this.int16[P+2]=g,this.int16[P+3]=b,this.int16[P+4]=E,this.int16[P+5]=C,a}}jt.prototype.bytesPerElement=12,dn(jt,"StructArrayLayout6i12");class Mt extends Ye{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,f,g,b,E,C,P,M,D,N,V){const H=this.length;return this.resize(H+1),this.emplace(H,a,u,f,g,b,E,C,P,M,D,N,V)}emplace(a,u,f,g,b,E,C,P,M,D,N,V,H){const W=12*a;return this.int16[W+0]=u,this.int16[W+1]=f,this.int16[W+2]=g,this.int16[W+3]=b,this.uint16[W+4]=E,this.uint16[W+5]=C,this.uint16[W+6]=P,this.uint16[W+7]=M,this.int16[W+8]=D,this.int16[W+9]=N,this.int16[W+10]=V,this.int16[W+11]=H,a}}Mt.prototype.bytesPerElement=24,dn(Mt,"StructArrayLayout4i4ui4i24");class Gt extends Ye{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,f,g,b,E){const C=this.length;return this.resize(C+1),this.emplace(C,a,u,f,g,b,E)}emplace(a,u,f,g,b,E,C){const P=10*a,M=5*a;return this.int16[P+0]=u,this.int16[P+1]=f,this.int16[P+2]=g,this.float32[M+2]=b,this.float32[M+3]=E,this.float32[M+4]=C,a}}Gt.prototype.bytesPerElement=20,dn(Gt,"StructArrayLayout3i3f20");class In extends Ye{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a){const u=this.length;return this.resize(u+1),this.emplace(u,a)}emplace(a,u){return this.uint32[1*a+0]=u,a}}In.prototype.bytesPerElement=4,dn(In,"StructArrayLayout1ul4");class Qn extends Ye{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,f,g,b,E,C,P,M,D,N,V,H){const W=this.length;return this.resize(W+1),this.emplace(W,a,u,f,g,b,E,C,P,M,D,N,V,H)}emplace(a,u,f,g,b,E,C,P,M,D,N,V,H,W){const Q=20*a,oe=10*a;return this.int16[Q+0]=u,this.int16[Q+1]=f,this.int16[Q+2]=g,this.int16[Q+3]=b,this.int16[Q+4]=E,this.float32[oe+3]=C,this.float32[oe+4]=P,this.float32[oe+5]=M,this.float32[oe+6]=D,this.int16[Q+14]=N,this.uint32[oe+8]=V,this.uint16[Q+18]=H,this.uint16[Q+19]=W,a}}Qn.prototype.bytesPerElement=40,dn(Qn,"StructArrayLayout5i4f1i1ul2ui40");class gn extends Ye{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,f,g,b,E,C){const P=this.length;return this.resize(P+1),this.emplace(P,a,u,f,g,b,E,C)}emplace(a,u,f,g,b,E,C,P){const M=8*a;return this.int16[M+0]=u,this.int16[M+1]=f,this.int16[M+2]=g,this.int16[M+4]=b,this.int16[M+5]=E,this.int16[M+6]=C,this.int16[M+7]=P,a}}gn.prototype.bytesPerElement=16,dn(gn,"StructArrayLayout3i2i2i16");class Fn extends Ye{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,f,g,b){const E=this.length;return this.resize(E+1),this.emplace(E,a,u,f,g,b)}emplace(a,u,f,g,b,E){const C=4*a,P=8*a;return this.float32[C+0]=u,this.float32[C+1]=f,this.float32[C+2]=g,this.int16[P+6]=b,this.int16[P+7]=E,a}}Fn.prototype.bytesPerElement=16,dn(Fn,"StructArrayLayout2f1f2i16");class yi extends Ye{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,f,g){const b=this.length;return this.resize(b+1),this.emplace(b,a,u,f,g)}emplace(a,u,f,g,b){const E=12*a,C=3*a;return this.uint8[E+0]=u,this.uint8[E+1]=f,this.float32[C+1]=g,this.float32[C+2]=b,a}}yi.prototype.bytesPerElement=12,dn(yi,"StructArrayLayout2ub2f12");class gi extends Ye{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,a,u,f)}emplace(a,u,f,g){const b=3*a;return this.float32[b+0]=u,this.float32[b+1]=f,this.float32[b+2]=g,a}}gi.prototype.bytesPerElement=12,dn(gi,"StructArrayLayout3f12");class Sn extends Ye{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,a,u,f)}emplace(a,u,f,g){const b=3*a;return this.uint16[b+0]=u,this.uint16[b+1]=f,this.uint16[b+2]=g,a}}Sn.prototype.bytesPerElement=6,dn(Sn,"StructArrayLayout3ui6");class Ui extends Ye{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a,u,f,g,b,E,C,P,M,D,N,V,H,W,Q,oe,xe,Me,we,Ie,Fe){const De=this.length;return this.resize(De+1),this.emplace(De,a,u,f,g,b,E,C,P,M,D,N,V,H,W,Q,oe,xe,Me,we,Ie,Fe)}emplace(a,u,f,g,b,E,C,P,M,D,N,V,H,W,Q,oe,xe,Me,we,Ie,Fe,De){const lt=30*a,it=15*a,_t=60*a;return this.int16[lt+0]=u,this.int16[lt+1]=f,this.int16[lt+2]=g,this.float32[it+2]=b,this.float32[it+3]=E,this.uint16[lt+8]=C,this.uint16[lt+9]=P,this.uint32[it+5]=M,this.uint32[it+6]=D,this.uint32[it+7]=N,this.uint16[lt+16]=V,this.uint16[lt+17]=H,this.uint16[lt+18]=W,this.float32[it+10]=Q,this.float32[it+11]=oe,this.uint8[_t+48]=xe,this.uint8[_t+49]=Me,this.uint8[_t+50]=we,this.uint32[it+13]=Ie,this.int16[lt+28]=Fe,this.uint8[_t+58]=De,a}}Ui.prototype.bytesPerElement=60,dn(Ui,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Hi extends Ye{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a,u,f,g,b,E,C,P,M,D,N,V,H,W,Q,oe,xe,Me,we,Ie,Fe,De,lt,it,_t,Vt,ft,St,Ct,Dt){const Kt=this.length;return this.resize(Kt+1),this.emplace(Kt,a,u,f,g,b,E,C,P,M,D,N,V,H,W,Q,oe,xe,Me,we,Ie,Fe,De,lt,it,_t,Vt,ft,St,Ct,Dt)}emplace(a,u,f,g,b,E,C,P,M,D,N,V,H,W,Q,oe,xe,Me,we,Ie,Fe,De,lt,it,_t,Vt,ft,St,Ct,Dt,Kt){const vt=38*a,rn=19*a;return this.int16[vt+0]=u,this.int16[vt+1]=f,this.int16[vt+2]=g,this.float32[rn+2]=b,this.float32[rn+3]=E,this.int16[vt+8]=C,this.int16[vt+9]=P,this.int16[vt+10]=M,this.int16[vt+11]=D,this.int16[vt+12]=N,this.int16[vt+13]=V,this.uint16[vt+14]=H,this.uint16[vt+15]=W,this.uint16[vt+16]=Q,this.uint16[vt+17]=oe,this.uint16[vt+18]=xe,this.uint16[vt+19]=Me,this.uint16[vt+20]=we,this.uint16[vt+21]=Ie,this.uint16[vt+22]=Fe,this.uint16[vt+23]=De,this.uint16[vt+24]=lt,this.uint16[vt+25]=it,this.uint16[vt+26]=_t,this.uint16[vt+27]=Vt,this.uint16[vt+28]=ft,this.uint32[rn+15]=St,this.float32[rn+16]=Ct,this.float32[rn+17]=Dt,this.float32[rn+18]=Kt,a}}Hi.prototype.bytesPerElement=76,dn(Hi,"StructArrayLayout3i2f6i15ui1ul3f76");class Wi extends Ye{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a){const u=this.length;return this.resize(u+1),this.emplace(u,a)}emplace(a,u){return this.float32[1*a+0]=u,a}}Wi.prototype.bytesPerElement=4,dn(Wi,"StructArrayLayout1f4");class Ki extends Ye{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,f,g,b){const E=this.length;return this.resize(E+1),this.emplace(E,a,u,f,g,b)}emplace(a,u,f,g,b,E){const C=5*a;return this.float32[C+0]=u,this.float32[C+1]=f,this.float32[C+2]=g,this.float32[C+3]=b,this.float32[C+4]=E,a}}Ki.prototype.bytesPerElement=20,dn(Ki,"StructArrayLayout5f20");class Vo extends Ye{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,f,g){const b=this.length;return this.resize(b+1),this.emplace(b,a,u,f,g)}emplace(a,u,f,g,b){const E=6*a;return this.uint32[3*a+0]=u,this.uint16[E+2]=f,this.uint16[E+3]=g,this.uint16[E+4]=b,a}}Vo.prototype.bytesPerElement=12,dn(Vo,"StructArrayLayout1ul3ui12");class Eo extends Ye{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u){const f=this.length;return this.resize(f+1),this.emplace(f,a,u)}emplace(a,u,f){const g=2*a;return this.uint16[g+0]=u,this.uint16[g+1]=f,a}}Eo.prototype.bytesPerElement=4,dn(Eo,"StructArrayLayout2ui4");class Ns extends Ye{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a){const u=this.length;return this.resize(u+1),this.emplace(u,a)}emplace(a,u){return this.uint16[1*a+0]=u,a}}Ns.prototype.bytesPerElement=2,dn(Ns,"StructArrayLayout1ui2");class Ma extends Ye{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u){const f=this.length;return this.resize(f+1),this.emplace(f,a,u)}emplace(a,u,f){const g=2*a;return this.float32[g+0]=u,this.float32[g+1]=f,a}}Ma.prototype.bytesPerElement=8,dn(Ma,"StructArrayLayout2f8");class yr extends Ne{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}yr.prototype.size=40;class Xi extends Qn{get(a){return new yr(this,a)}}dn(Xi,"CollisionBoxArray");class Oi extends Ne{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(a){this._structArray.uint8[this._pos1+49]=a}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(a){this._structArray.uint8[this._pos1+50]=a}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(a){this._structArray.uint32[this._pos4+13]=a}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(a){this._structArray.uint8[this._pos1+58]=a}}Oi.prototype.size=60;class Xr extends Ui{get(a){return new Oi(this,a)}}dn(Xr,"PlacedSymbolArray");class Yo extends Ne{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(a){this._structArray.uint32[this._pos4+15]=a}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Yo.prototype.size=76;class dr extends Hi{get(a){return new Yo(this,a)}}dn(dr,"SymbolInstanceArray");class is extends Wi{getoffsetX(a){return this.float32[1*a+0]}}dn(is,"GlyphOffsetArray");class ep extends Ut{getx(a){return this.int16[2*a+0]}gety(a){return this.int16[2*a+1]}}dn(ep,"SymbolLineVertexArray");class Sc extends Ne{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Sc.prototype.size=12;class cd extends Vo{get(a){return new Sc(this,a)}}dn(cd,"FeatureIndexArray");class il extends Eo{geta_centroid_pos0(a){return this.uint16[2*a+0]}geta_centroid_pos1(a){return this.uint16[2*a+1]}}dn(il,"FillExtrusionCentroidArray");const Fl=Xe([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Cc=Xe([{name:"a_dash",components:4,type:"Uint16"}]);var tp={exports:{}},ud={exports:{}};ud.exports=function(c,a){var u,f,g,b,E,C,P,M;for(f=c.length-(u=3&c.length),g=a,E=3432918353,C=461845907,M=0;M<f;)P=255&c.charCodeAt(M)|(255&c.charCodeAt(++M))<<8|(255&c.charCodeAt(++M))<<16|(255&c.charCodeAt(++M))<<24,++M,g=27492+(65535&(b=5*(65535&(g=(g^=P=(65535&(P=(P=(65535&P)*E+(((P>>>16)*E&65535)<<16)&4294967295)<<15|P>>>17))*C+(((P>>>16)*C&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(b>>>16)&65535)<<16);switch(P=0,u){case 3:P^=(255&c.charCodeAt(M+2))<<16;case 2:P^=(255&c.charCodeAt(M+1))<<8;case 1:g^=P=(65535&(P=(P=(65535&(P^=255&c.charCodeAt(M)))*E+(((P>>>16)*E&65535)<<16)&4294967295)<<15|P>>>17))*C+(((P>>>16)*C&65535)<<16)&4294967295}return g^=c.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0};var Gg=ud.exports,hR={exports:{}};hR.exports=function(c,a){for(var u,f=c.length,g=a^f,b=0;f>=4;)u=1540483477*(65535&(u=255&c.charCodeAt(b)|(255&c.charCodeAt(++b))<<8|(255&c.charCodeAt(++b))<<16|(255&c.charCodeAt(++b))<<24))+((1540483477*(u>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),f-=4,++b;switch(f){case 3:g^=(255&c.charCodeAt(b+2))<<16;case 2:g^=(255&c.charCodeAt(b+1))<<8;case 1:g=1540483477*(65535&(g^=255&c.charCodeAt(b)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0};var dR=Gg,c$=hR.exports;tp.exports=dR,tp.exports.murmur3=dR,tp.exports.murmur2=c$;var OE=G(tp.exports);class v1{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(a,u,f,g){this.ids.push(fR(a)),this.positions.push(u,f,g)}getPositions(a){const u=fR(a);let f=0,g=this.ids.length-1;for(;f<g;){const E=f+g>>1;this.ids[E]>=u?g=E:f=E+1}const b=[];for(;this.ids[f]===u;)b.push({index:this.positions[3*f],start:this.positions[3*f+1],end:this.positions[3*f+2]}),f++;return b}static serialize(a,u){const f=new Float64Array(a.ids),g=new Uint32Array(a.positions);return DE(f,g,0,f.length-1),u&&u.push(f.buffer,g.buffer),{ids:f,positions:g}}static deserialize(a){const u=new v1;return u.ids=a.ids,u.positions=a.positions,u.indexed=!0,u}}function fR(c){const a=+c;return!isNaN(a)&&Number.MIN_SAFE_INTEGER<=a&&a<=Number.MAX_SAFE_INTEGER?a:OE(String(c))}function DE(c,a,u,f){for(;u<f;){const g=c[u+f>>1];let b=u-1,E=f+1;for(;;){do b++;while(c[b]<g);do E--;while(c[E]>g);if(b>=E)break;_1(c,b,E),_1(a,3*b,3*E),_1(a,3*b+1,3*E+1),_1(a,3*b+2,3*E+2)}E-u<f-E?(DE(c,a,u,E),u=E+1):(DE(c,a,E+1,f),f=E)}}function _1(c,a,u){const f=c[a];c[a]=c[u],c[u]=f}dn(v1,"FeaturePositionMap");class Ac{constructor(a){this.gl=a.gl,this.initialized=!1}fetchUniformLocation(a,u){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(a,u),this.initialized=!0),!!this.location}}class b1 extends Ac{constructor(a){super(a),this.current=0}set(a,u,f){this.fetchUniformLocation(a,u)&&this.current!==f&&(this.current=f,this.gl.uniform1f(this.location,f))}}class pR extends Ac{constructor(a){super(a),this.current=[0,0,0,0]}set(a,u,f){this.fetchUniformLocation(a,u)&&(f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]&&f[3]===this.current[3]||(this.current=f,this.gl.uniform4f(this.location,f[0],f[1],f[2],f[3])))}}class mR extends Ac{constructor(a){super(a),this.current=on.transparent}set(a,u,f){this.fetchUniformLocation(a,u)&&(f.r===this.current.r&&f.g===this.current.g&&f.b===this.current.b&&f.a===this.current.a||(this.current=f,this.gl.uniform4f(this.location,f.r,f.g,f.b,f.a)))}}const u$=new Float32Array(16),h$=new Float32Array(9),d$=new Float32Array(4);function kE(c){return[ze(255*c.r,255*c.g),ze(255*c.b,255*c.a)]}class Hg{constructor(a,u,f){this.value=a,this.uniformNames=u.map(g=>`u_${g}`),this.type=f}setUniform(a,u,f,g,b){u.set(a,b,g.constantOr(this.value))}getBinding(a,u){return this.type==="color"?new mR(a):new b1(a)}}class np{constructor(a,u){this.uniformNames=u.map(f=>`u_${f}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(a){this.pixelRatio=a.pixelRatio||1,this.pattern=a.tl.concat(a.br)}setUniform(a,u,f,g,b){const E=b==="u_pattern"||b==="u_dash"?this.pattern:b==="u_pixel_ratio"?this.pixelRatio:null;E&&u.set(a,b,E)}getBinding(a,u){return u==="u_pattern"||u==="u_dash"?new pR(a):new b1(a)}}class Pc{constructor(a,u,f,g){this.expression=a,this.type=f,this.maxValue=0,this.paintVertexAttributes=u.map(b=>({name:`a_${b}`,type:"Float32",components:f==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(a,u,f,g,b,E){const C=this.paintVertexArray.length,P=this.expression.evaluate(new z(0),u,{},b,g,E);this.paintVertexArray.resize(a),this._setPaintValue(C,a,P)}updatePaintArray(a,u,f,g,b){const E=this.expression.evaluate({zoom:0},f,g,void 0,b);this._setPaintValue(a,u,E)}_setPaintValue(a,u,f){if(this.type==="color"){const g=kE(f);for(let b=a;b<u;b++)this.paintVertexArray.emplace(b,g[0],g[1])}else{for(let g=a;g<u;g++)this.paintVertexArray.emplace(g,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class rl{constructor(a,u,f,g,b,E){this.expression=a,this.uniformNames=u.map(C=>`u_${C}_t`),this.type=f,this.useIntegerZoom=g,this.zoom=b,this.maxValue=0,this.paintVertexAttributes=u.map(C=>({name:`a_${C}`,type:"Float32",components:f==="color"?4:2,offset:0})),this.paintVertexArray=new E}populatePaintArray(a,u,f,g,b,E){const C=this.expression.evaluate(new z(this.zoom),u,{},b,g,E),P=this.expression.evaluate(new z(this.zoom+1),u,{},b,g,E),M=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValue(M,a,C,P)}updatePaintArray(a,u,f,g,b){const E=this.expression.evaluate({zoom:this.zoom},f,g,void 0,b),C=this.expression.evaluate({zoom:this.zoom+1},f,g,void 0,b);this._setPaintValue(a,u,E,C)}_setPaintValue(a,u,f,g){if(this.type==="color"){const b=kE(f),E=kE(g);for(let C=a;C<u;C++)this.paintVertexArray.emplace(C,b[0],b[1],E[0],E[1])}else{for(let b=a;b<u;b++)this.paintVertexArray.emplace(b,f,g);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(g))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(a,u,f,g,b){const E=this.useIntegerZoom?Math.floor(f.zoom):f.zoom,C=bt(this.expression.interpolationFactor(E,this.zoom,this.zoom+1),0,1);u.set(a,b,C)}getBinding(a,u){return new b1(a)}}class Bu{constructor(a,u,f,g,b){this.expression=a,this.layerId=b,this.paintVertexAttributes=(f==="array"?Cc:Fl).members;for(let E=0;E<u.length;++E);this.paintVertexArray=new g}populatePaintArray(a,u,f){const g=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValues(g,a,u.patterns&&u.patterns[this.layerId],f)}updatePaintArray(a,u,f,g,b,E){this._setPaintValues(a,u,f.patterns&&f.patterns[this.layerId],E)}_setPaintValues(a,u,f,g){if(!g||!f)return;const b=g[f];if(!b)return;const{tl:E,br:C,pixelRatio:P}=b;for(let M=a;M<u;M++)this.paintVertexArray.emplace(M,E[0],E[1],C[0],C[1],P)}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class zu{constructor(a,u,f=()=>!0){this.binders={},this._buffers=[];const g=[];for(const b in a.paint._values){if(!f(b))continue;const E=a.paint.get(b);if(!(E instanceof pe&&Iu(E.property.specification)))continue;const C=p$(b,a.type),P=E.value,M=E.property.specification.type,D=!!E.property.useIntegerZoom,N=b==="line-dasharray"||b.endsWith("pattern"),V=b==="line-dasharray"&&a.layout.get("line-cap").value.kind!=="constant";if(P.kind!=="constant"||V)if(P.kind==="source"||V||N){const H=gR(b,M,"source");this.binders[b]=N?new Bu(P,C,M,H,a.id):new Pc(P,C,M,H),g.push(`/a_${b}`)}else{const H=gR(b,M,"composite");this.binders[b]=new rl(P,C,M,D,u,H),g.push(`/z_${b}`)}else this.binders[b]=N?new np(P.value,C):new Hg(P.value,C,M),g.push(`/u_${b}`)}this.cacheKey=g.sort().join("")}getMaxValue(a){const u=this.binders[a];return u instanceof Pc||u instanceof rl?u.maxValue:0}populatePaintArrays(a,u,f,g,b,E){for(const C in this.binders){const P=this.binders[C];(P instanceof Pc||P instanceof rl||P instanceof Bu)&&P.populatePaintArray(a,u,f,g,b,E)}}setConstantPatternPositions(a){for(const u in this.binders){const f=this.binders[u];f instanceof np&&f.setConstantPatternPositions(a)}}updatePaintArrays(a,u,f,g,b,E){let C=!1;for(const P in a){const M=u.getPositions(P);for(const D of M){const N=f.feature(D.index);for(const V in this.binders){const H=this.binders[V];if((H instanceof Pc||H instanceof rl||H instanceof Bu)&&H.expression.isStateDependent===!0){const W=g.paint.get(V);H.expression=W.value,H.updatePaintArray(D.start,D.end,N,a[P],b,E),C=!0}}}}return C}defines(){const a=[];for(const u in this.binders){const f=this.binders[u];(f instanceof Hg||f instanceof np)&&a.push(...f.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return a}getBinderAttributes(){const a=[];for(const u in this.binders){const f=this.binders[u];if(f instanceof Pc||f instanceof rl||f instanceof Bu)for(let g=0;g<f.paintVertexAttributes.length;g++)a.push(f.paintVertexAttributes[g].name)}return a}getBinderUniforms(){const a=[];for(const u in this.binders){const f=this.binders[u];if(f instanceof Hg||f instanceof np||f instanceof rl)for(const g of f.uniformNames)a.push(g)}return a}getPaintVertexBuffers(){return this._buffers}getUniforms(a){const u=[];for(const f in this.binders){const g=this.binders[f];if(g instanceof Hg||g instanceof np||g instanceof rl)for(const b of g.uniformNames)u.push({name:b,property:f,binding:g.getBinding(a,b)})}return u}setUniforms(a,u,f,g,b){for(const{name:E,property:C,binding:P}of f)this.binders[C].setUniform(a,P,b,g.get(C),E)}updatePaintBuffers(){this._buffers=[];for(const a in this.binders){const u=this.binders[a];(u instanceof Pc||u instanceof rl||u instanceof Bu)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}}upload(a){for(const u in this.binders){const f=this.binders[u];(f instanceof Pc||f instanceof rl||f instanceof Bu)&&f.upload(a)}this.updatePaintBuffers()}destroy(){for(const a in this.binders){const u=this.binders[a];(u instanceof Pc||u instanceof rl||u instanceof Bu)&&u.destroy()}}}class hd{constructor(a,u,f=()=>!0){this.programConfigurations={};for(const g of a)this.programConfigurations[g.id]=new zu(g,u,f);this.needsUpload=!1,this._featureMap=new v1,this._bufferOffset=0}populatePaintArrays(a,u,f,g,b,E,C){for(const P in this.programConfigurations)this.programConfigurations[P].populatePaintArrays(a,u,g,b,E,C);u.id!==void 0&&this._featureMap.add(u.id,f,this._bufferOffset,a),this._bufferOffset=a,this.needsUpload=!0}updatePaintArrays(a,u,f,g,b){for(const E of f)this.needsUpload=this.programConfigurations[E.id].updatePaintArrays(a,this._featureMap,u,E,g,b)||this.needsUpload}get(a){return this.programConfigurations[a]}upload(a){if(this.needsUpload){for(const u in this.programConfigurations)this.programConfigurations[u].upload(a);this.needsUpload=!1}}destroy(){for(const a in this.programConfigurations)this.programConfigurations[a].destroy()}}const f$={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function p$(c,a){return f$[c]||[c.replace(`${a}-`,"").replace(/-/g,"_")]}const m$={"line-pattern":{source:ot,composite:ot},"fill-pattern":{source:ot,composite:ot},"fill-extrusion-pattern":{source:ot,composite:ot},"line-dasharray":{source:xt,composite:xt}},g$={color:{source:Ma,composite:Bt},number:{source:Wi,composite:Ma}};function gR(c,a,u){const f=m$[c];return f&&f[u]||g$[a][u]}dn(Hg,"ConstantBinder"),dn(np,"PatternConstantBinder"),dn(Pc,"SourceExpressionBinder"),dn(Bu,"PatternCompositeBinder"),dn(rl,"CompositeExpressionBinder"),dn(zu,"ProgramConfiguration",{omit:["_buffers"]}),dn(hd,"ProgramConfigurationSet");const yR="-transition";class ol extends Mo{constructor(a,u){if(super(),this.id=a.id,this.type=a.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,a.type!=="custom"&&(this.metadata=a.metadata,this.minzoom=a.minzoom,this.maxzoom=a.maxzoom,a.type!=="background"&&a.type!=="sky"&&(this.source=a.source,this.sourceLayer=a["source-layer"],this.filter=a.filter),u.layout&&(this._unevaluatedLayout=new ge(u.layout)),u.paint)){this._transitionablePaint=new Z(u.paint);for(const f in a.paint)this.setPaintProperty(f,a.paint[f],{validate:!1});for(const f in a.layout)this.setLayoutProperty(f,a.layout[f],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new _e(u.paint)}}getLayoutProperty(a){return a==="visibility"?this.visibility:this._unevaluatedLayout.getValue(a)}setLayoutProperty(a,u,f={}){u!=null&&this._validate(PE,`layers.${this.id}.layout.${a}`,a,u,f)||(a!=="visibility"?this._unevaluatedLayout.setValue(a,u):this.visibility=u)}getPaintProperty(a){return ht(a,yR)?this._transitionablePaint.getTransition(a.slice(0,-11)):this._transitionablePaint.getValue(a)}setPaintProperty(a,u,f={}){if(u!=null&&this._validate(AE,`layers.${this.id}.paint.${a}`,a,u,f))return!1;if(ht(a,yR))return this._transitionablePaint.setTransition(a.slice(0,-11),u||void 0),!1;{const g=this._transitionablePaint._values[a],b=g.value.isDataDriven(),E=g.value;this._transitionablePaint.setValue(a,u),this._handleSpecialPaintPropertyUpdate(a);const C=this._transitionablePaint._values[a].value,P=C.isDataDriven(),M=ht(a,"pattern")||a==="line-dasharray";return P||b||M||this._handleOverridablePaintPropertyUpdate(a,E,C)}}_handleSpecialPaintPropertyUpdate(a){}getProgramIds(){return null}getProgramConfiguration(a){return null}_handleOverridablePaintPropertyUpdate(a,u,f){return!1}isHidden(a){return!!(this.minzoom&&a<this.minzoom)||!!(this.maxzoom&&a>=this.maxzoom)||this.visibility==="none"}updateTransitions(a){this._transitioningPaint=this._transitionablePaint.transitioned(a,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(a,u){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(a,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(a,void 0,u)}serialize(){const a={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(a.layout=a.layout||{},a.layout.visibility=this.visibility),ae(a,(u,f)=>!(u===void 0||f==="layout"&&!Object.keys(u).length||f==="paint"&&!Object.keys(u).length))}_validate(a,u,f,g,b={}){return(!b||b.validate!==!1)&&p1(this,a.call(f1,{key:u,layerType:this.type,objectKey:f,value:g,styleSpec:yt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const a in this.paint._values){const u=this.paint.get(a);if(u instanceof pe&&Iu(u.property.specification)&&(u.value.kind==="source"||u.value.kind==="composite")&&u.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=qf(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const y$=Xe([{name:"a_pos",components:2,type:"Int16"}],4),v$=Xe([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Zr{constructor(a=[]){this.segments=a}prepareSegment(a,u,f,g){let b=this.segments[this.segments.length-1];return a>Zr.MAX_VERTEX_ARRAY_LENGTH&&tt(`Max vertices per segment is ${Zr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${a}`),(!b||b.vertexLength+a>Zr.MAX_VERTEX_ARRAY_LENGTH||b.sortKey!==g)&&(b={vertexOffset:u.length,primitiveOffset:f.length,vertexLength:0,primitiveLength:0},g!==void 0&&(b.sortKey=g),this.segments.push(b)),b}get(){return this.segments}destroy(){for(const a of this.segments)for(const u in a.vaos)a.vaos[u].destroy()}static simpleSegment(a,u,f,g){return new Zr([{vertexOffset:a,primitiveOffset:u,vertexLength:f,primitiveLength:g,vaos:{},sortKey:0}])}}Zr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,dn(Zr,"SegmentVector");var On=8192;class Nu{constructor(a,u){a&&(u?this.setSouthWest(a).setNorthEast(u):a.length===4?this.setSouthWest([a[0],a[1]]).setNorthEast([a[2],a[3]]):this.setSouthWest(a[0]).setNorthEast(a[1]))}setNorthEast(a){return this._ne=a instanceof Zi?new Zi(a.lng,a.lat):Zi.convert(a),this}setSouthWest(a){return this._sw=a instanceof Zi?new Zi(a.lng,a.lat):Zi.convert(a),this}extend(a){const u=this._sw,f=this._ne;let g,b;if(a instanceof Zi)g=a,b=a;else{if(!(a instanceof Nu))return Array.isArray(a)?a.length===4||a.every(Array.isArray)?this.extend(Nu.convert(a)):this.extend(Zi.convert(a)):typeof a=="object"&&a!==null&&a.hasOwnProperty("lat")&&(a.hasOwnProperty("lon")||a.hasOwnProperty("lng"))?this.extend(Zi.convert(a)):this;if(g=a._sw,b=a._ne,!g||!b)return this}return u||f?(u.lng=Math.min(g.lng,u.lng),u.lat=Math.min(g.lat,u.lat),f.lng=Math.max(b.lng,f.lng),f.lat=Math.max(b.lat,f.lat)):(this._sw=new Zi(g.lng,g.lat),this._ne=new Zi(b.lng,b.lat)),this}getCenter(){return new Zi((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Zi(this.getWest(),this.getNorth())}getSouthEast(){return new Zi(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(a){const{lng:u,lat:f}=Zi.convert(a);let g=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&g}static convert(a){return!a||a instanceof Nu?a:new Nu(a)}}var x1=1e-6,Us=typeof Float32Array<"u"?Float32Array:Array;function vR(){var c=new Us(9);return Us!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,c}function _R(c,a,u){var f=a[0],g=a[1],b=a[2],E=a[3],C=a[4],P=a[5],M=a[6],D=a[7],N=a[8],V=u[0],H=u[1],W=u[2],Q=u[3],oe=u[4],xe=u[5],Me=u[6],we=u[7],Ie=u[8];return c[0]=V*f+H*E+W*M,c[1]=V*g+H*C+W*D,c[2]=V*b+H*P+W*N,c[3]=Q*f+oe*E+xe*M,c[4]=Q*g+oe*C+xe*D,c[5]=Q*b+oe*P+xe*N,c[6]=Me*f+we*E+Ie*M,c[7]=Me*g+we*C+Ie*D,c[8]=Me*b+we*P+Ie*N,c}function sl(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function FE(c,a){var u=a[0],f=a[1],g=a[2],b=a[3],E=a[4],C=a[5],P=a[6],M=a[7],D=a[8],N=a[9],V=a[10],H=a[11],W=a[12],Q=a[13],oe=a[14],xe=a[15],Me=u*C-f*E,we=u*P-g*E,Ie=u*M-b*E,Fe=f*P-g*C,De=f*M-b*C,lt=g*M-b*P,it=D*Q-N*W,_t=D*oe-V*W,Vt=D*xe-H*W,ft=N*oe-V*Q,St=N*xe-H*Q,Ct=V*xe-H*oe,Dt=Me*Ct-we*St+Ie*ft+Fe*Vt-De*_t+lt*it;return Dt?(c[0]=(C*Ct-P*St+M*ft)*(Dt=1/Dt),c[1]=(g*St-f*Ct-b*ft)*Dt,c[2]=(Q*lt-oe*De+xe*Fe)*Dt,c[3]=(V*De-N*lt-H*Fe)*Dt,c[4]=(P*Vt-E*Ct-M*_t)*Dt,c[5]=(u*Ct-g*Vt+b*_t)*Dt,c[6]=(oe*Ie-W*lt-xe*we)*Dt,c[7]=(D*lt-V*Ie+H*we)*Dt,c[8]=(E*St-C*Vt+M*it)*Dt,c[9]=(f*Vt-u*St-b*it)*Dt,c[10]=(W*De-Q*Ie+xe*Me)*Dt,c[11]=(N*Ie-D*De-H*Me)*Dt,c[12]=(C*_t-E*ft-P*it)*Dt,c[13]=(u*ft-f*_t+g*it)*Dt,c[14]=(Q*we-W*Fe-oe*Me)*Dt,c[15]=(D*Fe-N*we+V*Me)*Dt,c):null}function dd(c,a,u){var f=a[0],g=a[1],b=a[2],E=a[3],C=a[4],P=a[5],M=a[6],D=a[7],N=a[8],V=a[9],H=a[10],W=a[11],Q=a[12],oe=a[13],xe=a[14],Me=a[15],we=u[0],Ie=u[1],Fe=u[2],De=u[3];return c[0]=we*f+Ie*C+Fe*N+De*Q,c[1]=we*g+Ie*P+Fe*V+De*oe,c[2]=we*b+Ie*M+Fe*H+De*xe,c[3]=we*E+Ie*D+Fe*W+De*Me,c[4]=(we=u[4])*f+(Ie=u[5])*C+(Fe=u[6])*N+(De=u[7])*Q,c[5]=we*g+Ie*P+Fe*V+De*oe,c[6]=we*b+Ie*M+Fe*H+De*xe,c[7]=we*E+Ie*D+Fe*W+De*Me,c[8]=(we=u[8])*f+(Ie=u[9])*C+(Fe=u[10])*N+(De=u[11])*Q,c[9]=we*g+Ie*P+Fe*V+De*oe,c[10]=we*b+Ie*M+Fe*H+De*xe,c[11]=we*E+Ie*D+Fe*W+De*Me,c[12]=(we=u[12])*f+(Ie=u[13])*C+(Fe=u[14])*N+(De=u[15])*Q,c[13]=we*g+Ie*P+Fe*V+De*oe,c[14]=we*b+Ie*M+Fe*H+De*xe,c[15]=we*E+Ie*D+Fe*W+De*Me,c}function Wg(c,a,u){var f,g,b,E,C,P,M,D,N,V,H,W,Q=u[0],oe=u[1],xe=u[2];return a===c?(c[12]=a[0]*Q+a[4]*oe+a[8]*xe+a[12],c[13]=a[1]*Q+a[5]*oe+a[9]*xe+a[13],c[14]=a[2]*Q+a[6]*oe+a[10]*xe+a[14],c[15]=a[3]*Q+a[7]*oe+a[11]*xe+a[15]):(g=a[1],b=a[2],E=a[3],C=a[4],P=a[5],M=a[6],D=a[7],N=a[8],V=a[9],H=a[10],W=a[11],c[0]=f=a[0],c[1]=g,c[2]=b,c[3]=E,c[4]=C,c[5]=P,c[6]=M,c[7]=D,c[8]=N,c[9]=V,c[10]=H,c[11]=W,c[12]=f*Q+C*oe+N*xe+a[12],c[13]=g*Q+P*oe+V*xe+a[13],c[14]=b*Q+M*oe+H*xe+a[14],c[15]=E*Q+D*oe+W*xe+a[15]),c}function fd(c,a,u){var f=u[0],g=u[1],b=u[2];return c[0]=a[0]*f,c[1]=a[1]*f,c[2]=a[2]*f,c[3]=a[3]*f,c[4]=a[4]*g,c[5]=a[5]*g,c[6]=a[6]*g,c[7]=a[7]*g,c[8]=a[8]*b,c[9]=a[9]*b,c[10]=a[10]*b,c[11]=a[11]*b,c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15],c}function BE(c,a,u){var f=Math.sin(u),g=Math.cos(u),b=a[4],E=a[5],C=a[6],P=a[7],M=a[8],D=a[9],N=a[10],V=a[11];return a!==c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]),c[4]=b*g+M*f,c[5]=E*g+D*f,c[6]=C*g+N*f,c[7]=P*g+V*f,c[8]=M*g-b*f,c[9]=D*g-E*f,c[10]=N*g-C*f,c[11]=V*g-P*f,c}function w1(c,a,u){var f=Math.sin(u),g=Math.cos(u),b=a[0],E=a[1],C=a[2],P=a[3],M=a[8],D=a[9],N=a[10],V=a[11];return a!==c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]),c[0]=b*g-M*f,c[1]=E*g-D*f,c[2]=C*g-N*f,c[3]=P*g-V*f,c[8]=b*f+M*g,c[9]=E*f+D*g,c[10]=C*f+N*g,c[11]=P*f+V*g,c}function bR(c,a){return c[0]=a[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=a[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=a[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function xR(c,a,u){var f,g,b,E=u[0],C=u[1],P=u[2],M=Math.hypot(E,C,P);return M<x1?null:(E*=M=1/M,C*=M,P*=M,f=Math.sin(a),g=Math.cos(a),c[0]=E*E*(b=1-g)+g,c[1]=C*E*b+P*f,c[2]=P*E*b-C*f,c[3]=0,c[4]=E*C*b-P*f,c[5]=C*C*b+g,c[6]=P*C*b+E*f,c[7]=0,c[8]=E*P*b+C*f,c[9]=C*P*b-E*f,c[10]=P*P*b+g,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c)}Math.hypot||(Math.hypot=function(){for(var c=0,a=arguments.length;a--;)c+=arguments[a]*arguments[a];return Math.sqrt(c)});var _$=dd;function zE(){var c=new Us(3);return Us!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c}function wR(c){var a=new Us(3);return a[0]=c[0],a[1]=c[1],a[2]=c[2],a}function Kg(c){return Math.hypot(c[0],c[1],c[2])}function ip(c,a,u){var f=new Us(3);return f[0]=c,f[1]=a,f[2]=u,f}function Ic(c,a,u){return c[0]=a[0]+u[0],c[1]=a[1]+u[1],c[2]=a[2]+u[2],c}function NE(c,a,u){return c[0]=a[0]-u[0],c[1]=a[1]-u[1],c[2]=a[2]-u[2],c}function ER(c,a,u){return c[0]=a[0]*u[0],c[1]=a[1]*u[1],c[2]=a[2]*u[2],c}function Xg(c,a,u){return c[0]=Math.min(a[0],u[0]),c[1]=Math.min(a[1],u[1]),c[2]=Math.min(a[2],u[2]),c}function Zg(c,a,u){return c[0]=Math.max(a[0],u[0]),c[1]=Math.max(a[1],u[1]),c[2]=Math.max(a[2],u[2]),c}function la(c,a,u){return c[0]=a[0]*u,c[1]=a[1]*u,c[2]=a[2]*u,c}function qg(c,a,u,f){return c[0]=a[0]+u[0]*f,c[1]=a[1]+u[1]*f,c[2]=a[2]+u[2]*f,c}function rs(c,a){var u=a[0],f=a[1],g=a[2],b=u*u+f*f+g*g;return b>0&&(b=1/Math.sqrt(b)),c[0]=a[0]*b,c[1]=a[1]*b,c[2]=a[2]*b,c}function Ra(c,a){return c[0]*a[0]+c[1]*a[1]+c[2]*a[2]}function UE(c,a,u){var f=a[0],g=a[1],b=a[2],E=u[0],C=u[1],P=u[2];return c[0]=g*P-b*C,c[1]=b*E-f*P,c[2]=f*C-g*E,c}function zr(c,a,u){var f=a[0],g=a[1],b=a[2],E=u[3]*f+u[7]*g+u[11]*b+u[15];return c[0]=(u[0]*f+u[4]*g+u[8]*b+u[12])/(E=E||1),c[1]=(u[1]*f+u[5]*g+u[9]*b+u[13])/E,c[2]=(u[2]*f+u[6]*g+u[10]*b+u[14])/E,c}function TR(c,a,u){var f=u[0],g=u[1],b=u[2],E=a[0],C=a[1],P=a[2],M=g*P-b*C,D=b*E-f*P,N=f*C-g*E,V=g*N-b*D,H=b*M-f*N,W=f*D-g*M,Q=2*u[3];return D*=Q,N*=Q,H*=2,W*=2,c[0]=E+(M*=Q)+(V*=2),c[1]=C+D+H,c[2]=P+N+W,c}var Yg,al=NE,b$=ER,x$=Kg;function SR(c,a,u){return c[0]=a[0]*u,c[1]=a[1]*u,c[2]=a[2]*u,c[3]=a[3]*u,c}function CR(c,a){var u=a[0],f=a[1],g=a[2],b=a[3],E=u*u+f*f+g*g+b*b;return E>0&&(E=1/Math.sqrt(E)),c[0]=u*E,c[1]=f*E,c[2]=g*E,c[3]=b*E,c}function pd(c,a,u){var f=a[0],g=a[1],b=a[2],E=a[3];return c[0]=u[0]*f+u[4]*g+u[8]*b+u[12]*E,c[1]=u[1]*f+u[5]*g+u[9]*b+u[13]*E,c[2]=u[2]*f+u[6]*g+u[10]*b+u[14]*E,c[3]=u[3]*f+u[7]*g+u[11]*b+u[15]*E,c}function AR(){var c=new Us(4);return Us!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c[3]=1,c}function PR(c){return c[0]=0,c[1]=0,c[2]=0,c[3]=1,c}function IR(c,a,u){u*=.5;var f=a[0],g=a[1],b=a[2],E=a[3],C=Math.sin(u),P=Math.cos(u);return c[0]=f*P+E*C,c[1]=g*P+b*C,c[2]=b*P-g*C,c[3]=E*P-f*C,c}function MR(c,a,u){u*=.5;var f=a[0],g=a[1],b=a[2],E=a[3],C=Math.sin(u),P=Math.cos(u);return c[0]=f*P-b*C,c[1]=g*P+E*C,c[2]=b*P+f*C,c[3]=E*P-g*C,c}zE(),Yg=new Us(4),Us!=Float32Array&&(Yg[0]=0,Yg[1]=0,Yg[2]=0,Yg[3]=0);var w$=CR;zE(),ip(1,0,0),ip(0,1,0),AR(),AR(),vR();const E$=Xe([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:RR}=E$,LR=Xe([{name:"a_pos_3",components:3,type:"Int16"}]);var Jg=Xe([{name:"a_pos",type:"Int16",components:2}]);class VE{constructor(a,u){this.pos=a,this.dir=u}intersectsPlane(a,u,f){const g=Ra(u,this.dir);if(Math.abs(g)<1e-6)return!1;const b=((a[0]-this.pos[0])*u[0]+(a[1]-this.pos[1])*u[1]+(a[2]-this.pos[2])*u[2])/g;return f[0]=this.pos[0]+this.dir[0]*b,f[1]=this.pos[1]+this.dir[1]*b,f[2]=this.pos[2]+this.dir[2]*b,!0}closestPointOnSphere(a,u,f){if(function(H,W){var Q=H[0],oe=H[1],xe=H[2],Me=W[0],we=W[1],Ie=W[2];return Math.abs(Q-Me)<=x1*Math.max(1,Math.abs(Q),Math.abs(Me))&&Math.abs(oe-we)<=x1*Math.max(1,Math.abs(oe),Math.abs(we))&&Math.abs(xe-Ie)<=x1*Math.max(1,Math.abs(xe),Math.abs(Ie))}(this.pos,a)||u===0)return f[0]=f[1]=f[2]=0,!1;const[g,b,E]=this.dir,C=this.pos[0]-a[0],P=this.pos[1]-a[1],M=this.pos[2]-a[2],D=g*g+b*b+E*E,N=2*(C*g+P*b+M*E),V=N*N-4*D*(C*C+P*P+M*M-u*u);if(V<0){const H=Math.max(-N/2,0),W=C+g*H,Q=P+b*H,oe=M+E*H,xe=Math.hypot(W,Q,oe);return f[0]=W*u/xe,f[1]=Q*u/xe,f[2]=oe*u/xe,!1}{const H=(-N-Math.sqrt(V))/(2*D);if(H<0){const W=Math.hypot(C,P,M);return f[0]=C*u/W,f[1]=P*u/W,f[2]=M*u/W,!1}return f[0]=C+g*H,f[1]=P+b*H,f[2]=M+E*H,!0}}}class jE{constructor(a,u,f,g,b){this.TL=a,this.TR=u,this.BR=f,this.BL=g,this.horizon=b}static fromInvProjectionMatrix(a,u,f){const g=[-1,1,1],b=[1,1,1],E=[1,-1,1],C=[-1,-1,1],P=zr(g,g,a),M=zr(b,b,a),D=zr(E,E,a),N=zr(C,C,a);return new jE(P,M,D,N,u/f)}}class $E{constructor(a,u){this.points=a,this.planes=u}static fromInvProjectionMatrix(a,u,f,g){const b=Math.pow(2,f),E=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(P=>{const M=pd([],P,a),D=1/M[3]/u*b;return function(N,V,H){return N[0]=V[0]*H[0],N[1]=V[1]*H[1],N[2]=V[2]*H[2],N[3]=V[3]*H[3],N}(M,M,[D,D,g?1/M[3]:D,D])}),C=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(P=>{const M=rs([],UE([],al([],E[P[0]],E[P[1]]),al([],E[P[2]],E[P[1]]))),D=-Ra(M,E[P[1]]);return M.concat(D)});return new $E(E,C)}}class os{static fromPoints(a){const u=[1/0,1/0,1/0],f=[-1/0,-1/0,-1/0];for(const g of a)Xg(u,u,g),Zg(f,f,g);return new os(u,f)}static applyTransform(a,u){const f=a.getCorners();for(let g=0;g<f.length;++g)zr(f[g],f[g],u);return os.fromPoints(f)}constructor(a,u){this.min=a,this.max=u,this.center=la([],Ic([],this.min,this.max),.5)}quadrant(a){const u=[a%2==0,a<2],f=wR(this.min),g=wR(this.max);for(let b=0;b<u.length;b++)f[b]=u[b]?this.min[b]:this.center[b],g[b]=u[b]?this.center[b]:this.max[b];return g[2]=this.max[2],new os(f,g)}distanceX(a){return Math.max(Math.min(this.max[0],a[0]),this.min[0])-a[0]}distanceY(a){return Math.max(Math.min(this.max[1],a[1]),this.min[1])-a[1]}distanceZ(a){return Math.max(Math.min(this.max[2],a[2]),this.min[2])-a[2]}getCorners(){const a=this.min,u=this.max;return[[a[0],a[1],a[2]],[u[0],a[1],a[2]],[u[0],u[1],a[2]],[a[0],u[1],a[2]],[a[0],a[1],u[2]],[u[0],a[1],u[2]],[u[0],u[1],u[2]],[a[0],u[1],u[2]]]}intersects(a){const u=this.getCorners();let f=!0;for(let g=0;g<a.planes.length;g++){const b=a.planes[g];let E=0;for(let C=0;C<u.length;C++)E+=Ra(b,u[C])+b[3]>=0;if(E===0)return 0;E!==u.length&&(f=!1)}if(f)return 2;for(let g=0;g<3;g++){let b=Number.MAX_VALUE,E=-Number.MAX_VALUE;for(let C=0;C<a.points.length;C++){const P=a.points[C][g]-this.min[g];b=Math.min(b,P),E=Math.max(E,P)}if(E<0||b>this.max[g]-this.min[g])return 0}return 1}}const GE=5,OR=6,Bl=On/Math.PI/2,T$=16383,md=64,Qg=[md,32,16],La=-Bl,Oa=Bl,S$=[new os([La,La,La],[Oa,Oa,Oa]),new os([La,La,La],[0,0,Oa]),new os([0,La,La],[Oa,0,Oa]),new os([La,0,La],[0,Oa,Oa]),new os([0,0,La],[Oa,Oa,Oa])];function E1(c){return c*Bl/ny}function DR(c,a,u,f=!0){const g=la([],c._camera.position,c.worldSize),b=[a,u,1,1];pd(b,b,c.pixelMatrixInverse),SR(b,b,1/b[3]);const E=rs([],al([],b,g)),C=c.globeMatrix,P=[C[12],C[13],C[14]],M=al([],P,g),D=Kg(M),N=rs([],M),V=c.worldSize/(2*Math.PI),H=Ra(N,E),W=Math.asin(V/D);if(W<Math.acos(H)){if(!f)return null;const Vt=[],ft=[];la(Vt,E,D/H),rs(ft,al(ft,Vt,M)),rs(E,Ic(E,M,la(E,ft,Math.tan(W)*D)))}const Q=[];new VE(g,E).closestPointOnSphere(P,V,Q);const oe=rs([],hn(C,0)),xe=rs([],hn(C,1)),Me=rs([],hn(C,2)),we=Ra(oe,Q),Ie=Ra(xe,Q),Fe=Ra(Me,Q),De=Te(Math.asin(-Ie/V));let lt=Te(Math.atan2(we,Fe));lt=c.center.lng+function(Vt,ft){const St=(ft-Vt+180)%360-180;return St<-180?St+360:St}(c.center.lng,lt);const it=Nl(lt),_t=bt(Ul(De),0,1);return new ap(it,_t)}class C${constructor(a,u,f){this.a=al([],a,f),this.b=al([],u,f),this.center=f;const g=rs([],this.a),b=rs([],this.b);this.angle=Math.acos(Ra(g,b))}}function HE(c,a){if(c.angle===0)return null;let u;return u=c.a[a]===0?1/c.angle*.5*Math.PI:1/c.angle*Math.atan(c.b[a]/c.a[a]/Math.sin(c.angle)-1/Math.tan(c.angle)),u<0||u>1?null:function(f,g,b,E){const C=Math.sin(b);return f*(Math.sin((1-E)*b)/C)+g*(Math.sin(E*b)/C)}(c.a[a],c.b[a],c.angle,bt(u,0,1))+c.center[a]}function zl(c){if(c.z<=1)return S$[c.z+2*c.y+c.x];const a=WE(T1(c));return os.fromPoints(a)}function gd(c,a,u){return la(c,c,1-u),qg(c,c,a,u)}function kR(c,a){const u=sp(a.zoom);if(u===0)return zl(c);const f=T1(c),g=WE(f),b=Nl(f.getWest())*a.worldSize,E=Nl(f.getEast())*a.worldSize,C=Ul(f.getNorth())*a.worldSize,P=Ul(f.getSouth())*a.worldSize,M=[b,C,0],D=[E,C,0],N=[b,P,0],V=[E,P,0],H=FE([],a.globeMatrix);return zr(M,M,H),zr(D,D,H),zr(N,N,H),zr(V,V,H),g[0]=gd(g[0],N,u),g[1]=gd(g[1],V,u),g[2]=gd(g[2],D,u),g[3]=gd(g[3],M,u),os.fromPoints(g)}function FR(c,a,u){for(const f of c)zr(f,f,a),la(f,f,u)}function A$(c,a,u){const f=a/c.worldSize,g=c.globeMatrix;if(u.z<=1){const it=zl(u).getCorners();return FR(it,g,f),os.fromPoints(it)}const b=T1(u),E=WE(b);FR(E,g,f);const C=Number.MAX_VALUE,P=[-C,-C,-C],M=[C,C,C];if(b.contains(c.center)){for(const Vt of E)Xg(M,M,Vt),Zg(P,P,Vt);P[2]=0;const it=c.point,_t=[it.x*f,it.y*f,0];return Xg(M,M,_t),Zg(P,P,_t),new os(M,P)}const D=[g[12]*f,g[13]*f,g[14]*f],N=b.getCenter(),V=bt(c.center.lat,-$o,$o),H=bt(N.lat,-$o,$o),W=Nl(c.center.lng),Q=Ul(V);let oe=W-Nl(N.lng);const xe=Q-Ul(H);oe>.5?oe-=1:oe<-.5&&(oe+=1);let Me=0;Math.abs(oe)>Math.abs(xe)?Me=oe>=0?1:3:(Me=xe>=0?0:2,qg(D,D,[g[4]*f,g[5]*f,g[6]*f],-Math.sin(be(xe>=0?b.getSouth():b.getNorth()))*Bl));const we=E[Me],Ie=E[(Me+1)%4],Fe=new C$(we,Ie,D),De=[HE(Fe,0)||we[0],HE(Fe,1)||we[1],HE(Fe,2)||we[2]],lt=sp(c.zoom);if(lt>0){const it=function({x:Vt,y:ft,z:St},Ct,Dt,Kt,vt){const rn=1/(1<<St);let yn=Vt*rn,sn=yn+rn,oi=ft*rn,Zt=oi+rn,Rn=0;const si=(yn+sn)/2-Kt;return si>.5?Rn=-1:si<-.5&&(Rn=1),yn=((yn+Rn)*Ct-(Kt*=Ct))*Dt+Kt,sn=((sn+Rn)*Ct-Kt)*Dt+Kt,oi=(oi*Ct-(vt*=Ct))*Dt+vt,Zt=(Zt*Ct-vt)*Dt+vt,[[yn,Zt,0],[sn,Zt,0],[sn,oi,0],[yn,oi,0]]}(u,a,c._pixelsPerMercatorPixel,W,Q);for(let Vt=0;Vt<E.length;Vt++)gd(E[Vt],it[Vt],lt);const _t=Ic([],it[Me],it[(Me+1)%4]);la(_t,_t,.5),gd(De,_t,lt)}for(const it of E)Xg(M,M,it),Zg(P,P,it);return M[2]=Math.min(we[2],Ie[2]),Xg(M,M,De),Zg(P,P,De),new os(M,P)}function T1({x:c,y:a,z:u}){const f=1/(1<<u),g=new Zi(ca(c*f),jo((a+1)*f)),b=new Zi(ca((c+1)*f),jo(a*f));return new Nu(g,b)}function WE(c){const a=be(c.getNorth()),u=be(c.getSouth()),f=Math.cos(a),g=Math.cos(u),b=Math.sin(a),E=Math.sin(u),C=c.getWest(),P=c.getEast();return[rp(g,E,C),rp(g,E,P),rp(f,b,P),rp(f,b,C)]}function rp(c,a,u,f=Bl){return u=be(u),[c*Math.sin(u)*f,-a*f,c*Math.cos(u)*f]}function op(c,a,u){return rp(Math.cos(be(c)),Math.sin(be(c)),a,u)}function ey(c,a,u,f){const g=1<<u.z,b=(c/On+u.x)/g;return op(jo((a/On+u.y)/g),ca(b),f)}function S1({min:c,max:a}){return T$/Math.max(a[0]-c[0],a[1]-c[1],a[2]-c[2])}const BR=new Float64Array(16);function ty(c){const a=S1(c),u=bR(BR,[a,a,a]);return Wg(u,u,((f=[])[0]=-(g=c.min)[0],f[1]=-g[1],f[2]=-g[2],f));var f,g}function KE(c){const a=(f=c.min,(u=BR)[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=f[0],u[13]=f[1],u[14]=f[2],u[15]=1,u);var u,f;const g=1/S1(c);return fd(a,a,[g,g,g])}function zR(c,a,u,f,g){const b=function(P){const M=On/(2*Math.PI);return P/(2*Math.PI)/M}(u),E=[c,a,-u/(2*Math.PI)],C=sl(new Float64Array(16));return Wg(C,C,E),fd(C,C,[b,b,b]),BE(C,C,be(-g)),w1(C,C,be(-f)),C}function sp(c){return Qt(GE,OR,c)}function NR(c,a){const u=op(a.lat,a.lng),f=function(W){const Q=op(W._center.lat,W._center.lng);let oe=UE([],ip(0,1,0),Q);const xe=xR([],-W.angle,Q);oe=zr(oe,oe,xe),xR(xe,-W._pitch,oe);const Me=rs([],Q);return la(Me,Me,E1(W.cameraToCenterDistance/W.pixelsPerMeter)),zr(Me,Me,xe),Ic([],Q,Me)}(c);return E=(g=NE([],f,u))[0],C=g[1],P=g[2],M=(b=u)[0],D=b[1],N=b[2],H=(V=Math.sqrt(E*E+C*C+P*P)*Math.sqrt(M*M+D*D+N*N))&&Ra(g,b)/V,Math.acos(Math.min(Math.max(H,-1),1));var g,b,E,C,P,M,D,N,V,H}function XE(c,a){return NR(c,a)>Math.PI/2*1.01}const UR=be(85),P$=Math.cos(UR),I$=Math.sin(UR),ny=63710088e-1,VR=2*Math.PI*ny;class Uu{constructor(a,u){if(isNaN(a)||isNaN(u))throw new Error(`Invalid LngLat object: (${a}, ${u})`);if(this.lng=+a,this.lat=+u,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Uu(cn(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(a){const u=Math.PI/180,f=this.lat*u,g=a.lat*u,b=Math.sin(f)*Math.sin(g)+Math.cos(f)*Math.cos(g)*Math.cos((a.lng-this.lng)*u);return ny*Math.acos(Math.min(b,1))}toBounds(a=0){const u=360*a/40075017,f=u/Math.cos(Math.PI/180*this.lat);return new Nu(new Uu(this.lng-f,this.lat-u),new Uu(this.lng+f,this.lat+u))}toEcef(a){const u=E1(a);return op(this.lat,this.lng,Bl+u)}static convert(a){if(a instanceof Uu)return a;if(Array.isArray(a)&&(a.length===2||a.length===3))return new Uu(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&typeof a=="object"&&a!==null)return new Uu(Number("lng"in a?a.lng:a.lon),Number(a.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var Zi=Uu;function ZE(c){return VR*Math.cos(c*Math.PI/180)}function Nl(c){return(180+c)/360}function Ul(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function ll(c,a){return c/ZE(a)}function ca(c){return 360*c-180}function jo(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function jR(c,a){return c*ZE(jo(a))}const $o=85.051129;function $R(c){return 1/Math.cos(c*Math.PI/180)}class ap{constructor(a,u,f=0){this.x=+a,this.y=+u,this.z=+f}static fromLngLat(a,u=0){const f=Zi.convert(a);return new ap(Nl(f.lng),Ul(f.lat),ll(u,f.lat))}toLngLat(){return new Zi(ca(this.x),jo(this.y))}toAltitude(){return jR(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/VR*$R(jo(this.y))}}function qE(c,a,u,f,g,b,E,C,P){const M=(a+f)/2,D=(u+g)/2,N=new J(M,D);C(N),function(V,H,W,Q,oe,xe){const Me=W-oe,we=Q-xe;return Math.abs((Q-H)*Me-(W-V)*we)/Math.hypot(Me,we)}(N.x,N.y,b.x,b.y,E.x,E.y)>=P?(qE(c,a,u,M,D,b,N,C,P),qE(c,M,D,f,g,N,E,C,P)):c.push(E)}function GR(c,a,u){let f=c[0],g=f.x,b=f.y;a(f);const E=[f];for(let C=1;C<c.length;C++){const P=c[C],{x:M,y:D}=P;a(P),qE(E,g,b,M,D,f,P,a,u),g=M,b=D,f=P}return E}function YE(c,a,u,f){if(f(a,u)){const g=a.add(u)._mult(.5);YE(c,a,g,f),YE(c,g,u,f)}else c.push(u)}function M$(c,a){let u=c[0];const f=[u];for(let g=1;g<c.length;g++){const b=c[g];YE(f,u,b,a),u=b}return f}const JE=Math.pow(2,14)-1,HR=-JE-1;function R$(c,a){const u=Math.round(c.x*a),f=Math.round(c.y*a);return c.x=bt(u,HR,JE),c.y=bt(f,HR,JE),(u<c.x||u>c.x+1||f<c.y||f>c.y+1)&&tt("Geometry exceeds allowed extent, reduce your vector tile buffer size"),c}function Mc(c,a,u){const f=c.loadGeometry(),g=c.extent,b=On/g;if(a&&u&&u.projection.isReprojectedInTileSpace){const E=1<<a.z,{scale:C,x:P,y:M,projection:D}=u,N=V=>{const H=ca((a.x+V.x/g)/E),W=jo((a.y+V.y/g)/E),Q=D.project(H,W);V.x=(Q.x*C-P)*g,V.y=(Q.y*C-M)*g};for(let V=0;V<f.length;V++)if(c.type!==1)f[V]=GR(f[V],N,1);else{const H=[];for(const W of f[V])W.x<0||W.x>=g||W.y<0||W.y>=g||(N(W),H.push(W));f[V]=H}}for(const E of f)for(const C of E)R$(C,b);return f}function yd(c,a){return{type:c.type,id:c.id,properties:c.properties,geometry:a?Mc(c):[]}}function C1(c,a,u,f,g){c.emplaceBack(2*a+(f+1)/2,2*u+(g+1)/2)}function A1(c,a,u){c.emplaceBack(a.x,a.y,a.z,u[0]*16384,u[1]*16384,u[2]*16384)}class QE{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(u=>u.id),this.index=a.index,this.hasPattern=!1,this.projection=a.projection,this.layoutVertexArray=new Ut,this.indexArray=new Sn,this.segments=new Zr,this.programConfigurations=new hd(a.layers,a.zoom),this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(a,u,f,g){const b=this.layers[0],E=[];let C=null;b.type==="circle"&&(C=b.layout.get("circle-sort-key"));for(const{feature:M,id:D,index:N,sourceLayerIndex:V}of a){const H=this.layers[0]._featureFilter.needGeometry,W=yd(M,H);if(!this.layers[0]._featureFilter.filter(new z(this.zoom),W,f))continue;const Q=C?C.evaluate(W,{},f):void 0,oe={id:D,properties:M.properties,type:M.type,sourceLayerIndex:V,index:N,geometry:H?W.geometry:Mc(M,f,g),patterns:{},sortKey:Q};E.push(oe)}C&&E.sort((M,D)=>M.sortKey-D.sortKey);let P=null;g.projection.name==="globe"&&(this.globeExtVertexArray=new jt,P=g.projection);for(const M of E){const{geometry:D,index:N,sourceLayerIndex:V}=M,H=a[N].feature;this.addFeature(M,D,N,u.availableImages,f,P),u.featureIndex.insert(H,D,N,V,this.index)}}update(a,u,f,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,f,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,y$.members),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=a.createVertexBuffer(this.globeExtVertexArray,v$.members))),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(a,u,f,g,b,E){for(const C of u)for(const P of C){const M=P.x,D=P.y;if(M<0||M>=On||D<0||D>=On)continue;if(E){const H=E.projectTilePoint(M,D,b),W=E.upVector(b,M,D),Q=this.globeExtVertexArray;A1(Q,H,W),A1(Q,H,W),A1(Q,H,W),A1(Q,H,W)}const N=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,a.sortKey),V=N.vertexLength;C1(this.layoutVertexArray,M,D,-1,-1),C1(this.layoutVertexArray,M,D,1,-1),C1(this.layoutVertexArray,M,D,1,1),C1(this.layoutVertexArray,M,D,-1,1),this.indexArray.emplaceBack(V,V+1,V+2),this.indexArray.emplaceBack(V,V+2,V+3),N.vertexLength+=4,N.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,{},g,b)}}function WR(c,a){for(let u=0;u<c.length;u++)if(vd(a,c[u]))return!0;for(let u=0;u<a.length;u++)if(vd(c,a[u]))return!0;return!!eT(c,a)}function L$(c,a,u){return!!vd(c,a)||!!tT(a,c,u)}function KR(c,a){if(c.length===1)return ZR(a,c[0]);for(let u=0;u<a.length;u++){const f=a[u];for(let g=0;g<f.length;g++)if(vd(c,f[g]))return!0}for(let u=0;u<c.length;u++)if(ZR(a,c[u]))return!0;for(let u=0;u<a.length;u++)if(eT(c,a[u]))return!0;return!1}function O$(c,a,u){if(c.length>1){if(eT(c,a))return!0;for(let f=0;f<a.length;f++)if(tT(a[f],c,u))return!0}for(let f=0;f<c.length;f++)if(tT(c[f],a,u))return!0;return!1}function eT(c,a){if(c.length===0||a.length===0)return!1;for(let u=0;u<c.length-1;u++){const f=c[u],g=c[u+1];for(let b=0;b<a.length-1;b++)if(D$(f,g,a[b],a[b+1]))return!0}return!1}function D$(c,a,u,f){return pt(c,u,f)!==pt(a,u,f)&&pt(c,a,u)!==pt(c,a,f)}function tT(c,a,u){const f=u*u;if(a.length===1)return c.distSqr(a[0])<f;for(let g=1;g<a.length;g++)if(XR(c,a[g-1],a[g])<f)return!0;return!1}function XR(c,a,u){const f=a.distSqr(u);if(f===0)return c.distSqr(a);const g=((c.x-a.x)*(u.x-a.x)+(c.y-a.y)*(u.y-a.y))/f;return c.distSqr(g<0?a:g>1?u:u.sub(a)._mult(g)._add(a))}function ZR(c,a){let u,f,g,b=!1;for(let E=0;E<c.length;E++){u=c[E];for(let C=0,P=u.length-1;C<u.length;P=C++)f=u[C],g=u[P],f.y>a.y!=g.y>a.y&&a.x<(g.x-f.x)*(a.y-f.y)/(g.y-f.y)+f.x&&(b=!b)}return b}function vd(c,a){let u=!1;for(let f=0,g=c.length-1;f<c.length;g=f++){const b=c[f],E=c[g];b.y>a.y!=E.y>a.y&&a.x<(E.x-b.x)*(a.y-b.y)/(E.y-b.y)+b.x&&(u=!u)}return u}function qR(c,a,u,f,g){for(const E of c)if(a<=E.x&&u<=E.y&&f>=E.x&&g>=E.y)return!0;const b=[new J(a,u),new J(a,g),new J(f,g),new J(f,u)];if(c.length>2){for(const E of b)if(vd(c,E))return!0}for(let E=0;E<c.length-1;E++)if(k$(c[E],c[E+1],b))return!0;return!1}function k$(c,a,u){const f=u[0],g=u[2];if(c.x<f.x&&a.x<f.x||c.x>g.x&&a.x>g.x||c.y<f.y&&a.y<f.y||c.y>g.y&&a.y>g.y)return!1;const b=pt(c,a,u[0]);return b!==pt(c,a,u[1])||b!==pt(c,a,u[2])||b!==pt(c,a,u[3])}function lp(c,a,u){const f=a.paint.get(c).value;return f.kind==="constant"?f.value:u.programConfigurations.get(a.id).getMaxValue(c)}function P1(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function YR(c,a,u,f,g){if(!a[0]&&!a[1])return c;const b=J.convert(a)._mult(g);u==="viewport"&&b._rotate(-f);const E=[];for(let C=0;C<c.length;C++)E.push(c[C].sub(b));return E}function JR(c,a,u,f){const g=J.convert(c)._mult(f);return a==="viewport"&&g._rotate(-u),g}dn(QE,"CircleBucket",{omit:["layers"]});const F$=new Se({"circle-sort-key":new ce(yt.layout_circle["circle-sort-key"])});var B$={paint:new Se({"circle-radius":new ce(yt.paint_circle["circle-radius"]),"circle-color":new ce(yt.paint_circle["circle-color"]),"circle-blur":new ce(yt.paint_circle["circle-blur"]),"circle-opacity":new ce(yt.paint_circle["circle-opacity"]),"circle-translate":new Y(yt.paint_circle["circle-translate"]),"circle-translate-anchor":new Y(yt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Y(yt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Y(yt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ce(yt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ce(yt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ce(yt.paint_circle["circle-stroke-opacity"])}),layout:F$};function QR(c,a,u,f,g,b,E,C,P){if(b&&c.queryGeometry.isAboveHorizon)return!1;b&&(P*=c.pixelToTileUnitsFactor);const M=c.tileID.canonical,D=u.projection.upVectorScale(M,u.center.lat,u.worldSize).metersToTile;for(const N of a)for(const V of N){const H=V.add(C),W=g&&u.elevation?u.elevation.exaggeration()*g.getElevationAt(H.x,H.y,!0):0,Q=u.projection.projectTilePoint(H.x,H.y,M);if(W>0){const we=u.projection.upVector(M,H.x,H.y);Q.x+=we[0]*D*W,Q.y+=we[1]*D*W,Q.z+=we[2]*D*W}const oe=b?H:z$(Q.x,Q.y,Q.z,f),xe=b?c.tilespaceRays.map(we=>U$(we,W)):c.queryGeometry.screenGeometry,Me=pd([],[Q.x,Q.y,Q.z,1],f);if(!E&&b?P*=Me[3]/u.cameraToCenterDistance:E&&!b&&(P*=u.cameraToCenterDistance/Me[3]),b){const we=jo((V.y/On+M.y)/(1<<M.z));P/=u.projection.pixelsPerMeter(we,1)/ll(1,we)}if(L$(xe,oe,P))return!0}return!1}function z$(c,a,u,f){const g=pd([],[c,a,u,1],f);return new J(g[0]/g[3],g[1]/g[3])}const eL=ip(0,0,0),N$=ip(0,0,1);function U$(c,a){const u=zE();return eL[2]=a,c.intersectsPlane(eL,N$,u),new J(u[0],u[1])}class tL extends QE{}function nL(c,{width:a,height:u},f,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==a*u*f)throw new RangeError("mismatched image size")}else g=new Uint8Array(a*u*f);return c.width=a,c.height=u,c.data=g,c}function iL(c,a,u){const{width:f,height:g}=a;f===c.width&&g===c.height||(nT(c,a,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,f),height:Math.min(c.height,g)},u),c.width=f,c.height=g,c.data=a.data)}function nT(c,a,u,f,g,b){if(g.width===0||g.height===0)return a;if(g.width>c.width||g.height>c.height||u.x>c.width-g.width||u.y>c.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>a.width||g.height>a.height||f.x>a.width-g.width||f.y>a.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const E=c.data,C=a.data;for(let P=0;P<g.height;P++){const M=((u.y+P)*c.width+u.x)*b,D=((f.y+P)*a.width+f.x)*b;for(let N=0;N<g.width*b;N++)C[D+N]=E[M+N]}return a}dn(tL,"HeatmapBucket",{omit:["layers"]});class Rc{constructor(a,u){nL(this,a,1,u)}resize(a){iL(this,new Rc(a),1)}clone(){return new Rc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,u,f,g,b){nT(a,u,f,g,b,1)}}class Vs{constructor(a,u){nL(this,a,4,u)}resize(a){iL(this,new Vs(a),4)}replace(a,u){u?this.data.set(a):this.data=a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):a}clone(){return new Vs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,u,f,g,b){nT(a,u,f,g,b,4)}}dn(Rc,"AlphaImage"),dn(Vs,"RGBAImage");var V$={paint:new Se({"heatmap-radius":new ce(yt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ce(yt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Y(yt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ee(yt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Y(yt.paint_heatmap["heatmap-opacity"])})};function iT(c){const a={},u=c.resolution||256,f=c.clips?c.clips.length:1,g=c.image||new Vs({width:u,height:f}),b=(E,C,P)=>{a[c.evaluationKey]=P;const M=c.expression.evaluate(a);g.data[E+C+0]=Math.floor(255*M.r/M.a),g.data[E+C+1]=Math.floor(255*M.g/M.a),g.data[E+C+2]=Math.floor(255*M.b/M.a),g.data[E+C+3]=Math.floor(255*M.a)};if(c.clips)for(let E=0,C=0;E<f;++E,C+=4*u)for(let P=0,M=0;P<u;P++,M+=4){const D=P/(u-1),{start:N,end:V}=c.clips[E];b(C,M,N*(1-D)+V*D)}else for(let E=0,C=0;E<u;E++,C+=4)b(0,C,E/(u-1));return g}var j$={paint:new Se({"hillshade-illumination-direction":new Y(yt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Y(yt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Y(yt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Y(yt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Y(yt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Y(yt.paint_hillshade["hillshade-accent-color"])})};const $$=Xe([{name:"a_pos",components:2,type:"Int16"}],4),{members:G$}=$$;var rT={exports:{}};function I1(c,a,u){u=u||2;var f,g,b,E,C,P,M,D=a&&a.length,N=D?a[0]*u:c.length,V=rL(c,0,N,u,!0),H=[];if(!V||V.next===V.prev)return H;if(D&&(V=function(Q,oe,xe,Me){var we,Ie,Fe,De=[];for(we=0,Ie=oe.length;we<Ie;we++)(Fe=rL(Q,oe[we]*Me,we<Ie-1?oe[we+1]*Me:Q.length,Me,!1))===Fe.next&&(Fe.steiner=!0),De.push(J$(Fe));for(De.sort(Z$),we=0;we<De.length;we++)xe=q$(De[we],xe);return xe}(c,a,V,u)),c.length>80*u){f=b=c[0],g=E=c[1];for(var W=u;W<N;W+=u)(C=c[W])<f&&(f=C),(P=c[W+1])<g&&(g=P),C>b&&(b=C),P>E&&(E=P);M=(M=Math.max(b-f,E-g))!==0?32767/M:0}return iy(V,H,u,f,g,M,0),H}function rL(c,a,u,f,g){var b,E;if(g===aT(c,a,u,f)>0)for(b=a;b<u;b+=f)E=aL(b,c[b],c[b+1],E);else for(b=u-f;b>=a;b-=f)E=aL(b,c[b],c[b+1],E);return E&&M1(E,E.next)&&(oy(E),E=E.next),E}function _d(c,a){if(!c)return c;a||(a=c);var u,f=c;do if(u=!1,f.steiner||!M1(f,f.next)&&qr(f.prev,f,f.next)!==0)f=f.next;else{if(oy(f),(f=a=f.prev)===f.next)break;u=!0}while(u||f!==a);return a}function iy(c,a,u,f,g,b,E){if(c){!E&&b&&function(D,N,V,H){var W=D;do W.z===0&&(W.z=oT(W.x,W.y,N,V,H)),W.prevZ=W.prev,W.nextZ=W.next,W=W.next;while(W!==D);W.prevZ.nextZ=null,W.prevZ=null,function(Q){var oe,xe,Me,we,Ie,Fe,De,lt,it=1;do{for(xe=Q,Q=null,Ie=null,Fe=0;xe;){for(Fe++,Me=xe,De=0,oe=0;oe<it&&(De++,Me=Me.nextZ);oe++);for(lt=it;De>0||lt>0&&Me;)De!==0&&(lt===0||!Me||xe.z<=Me.z)?(we=xe,xe=xe.nextZ,De--):(we=Me,Me=Me.nextZ,lt--),Ie?Ie.nextZ=we:Q=we,we.prevZ=Ie,Ie=we;xe=Me}Ie.nextZ=null,it*=2}while(Fe>1)}(W)}(c,f,g,b);for(var C,P,M=c;c.prev!==c.next;)if(C=c.prev,P=c.next,b?W$(c,f,g,b):H$(c))a.push(C.i/u|0),a.push(c.i/u|0),a.push(P.i/u|0),oy(c),c=P.next,M=P.next;else if((c=P)===M){E?E===1?iy(c=K$(_d(c),a,u),a,u,f,g,b,2):E===2&&X$(c,a,u,f,g,b):iy(_d(c),a,u,f,g,b,1);break}}}function H$(c){var a=c.prev,u=c,f=c.next;if(qr(a,u,f)>=0)return!1;for(var g=a.x,b=u.x,E=f.x,C=a.y,P=u.y,M=f.y,D=g<b?g<E?g:E:b<E?b:E,N=C<P?C<M?C:M:P<M?P:M,V=g>b?g>E?g:E:b>E?b:E,H=C>P?C>M?C:M:P>M?P:M,W=f.next;W!==a;){if(W.x>=D&&W.x<=V&&W.y>=N&&W.y<=H&&cp(g,C,b,P,E,M,W.x,W.y)&&qr(W.prev,W,W.next)>=0)return!1;W=W.next}return!0}function W$(c,a,u,f){var g=c.prev,b=c,E=c.next;if(qr(g,b,E)>=0)return!1;for(var C=g.x,P=b.x,M=E.x,D=g.y,N=b.y,V=E.y,H=C<P?C<M?C:M:P<M?P:M,W=D<N?D<V?D:V:N<V?N:V,Q=C>P?C>M?C:M:P>M?P:M,oe=D>N?D>V?D:V:N>V?N:V,xe=oT(H,W,a,u,f),Me=oT(Q,oe,a,u,f),we=c.prevZ,Ie=c.nextZ;we&&we.z>=xe&&Ie&&Ie.z<=Me;){if(we.x>=H&&we.x<=Q&&we.y>=W&&we.y<=oe&&we!==g&&we!==E&&cp(C,D,P,N,M,V,we.x,we.y)&&qr(we.prev,we,we.next)>=0||(we=we.prevZ,Ie.x>=H&&Ie.x<=Q&&Ie.y>=W&&Ie.y<=oe&&Ie!==g&&Ie!==E&&cp(C,D,P,N,M,V,Ie.x,Ie.y)&&qr(Ie.prev,Ie,Ie.next)>=0))return!1;Ie=Ie.nextZ}for(;we&&we.z>=xe;){if(we.x>=H&&we.x<=Q&&we.y>=W&&we.y<=oe&&we!==g&&we!==E&&cp(C,D,P,N,M,V,we.x,we.y)&&qr(we.prev,we,we.next)>=0)return!1;we=we.prevZ}for(;Ie&&Ie.z<=Me;){if(Ie.x>=H&&Ie.x<=Q&&Ie.y>=W&&Ie.y<=oe&&Ie!==g&&Ie!==E&&cp(C,D,P,N,M,V,Ie.x,Ie.y)&&qr(Ie.prev,Ie,Ie.next)>=0)return!1;Ie=Ie.nextZ}return!0}function K$(c,a,u){var f=c;do{var g=f.prev,b=f.next.next;!M1(g,b)&&oL(g,f,f.next,b)&&ry(g,b)&&ry(b,g)&&(a.push(g.i/u|0),a.push(f.i/u|0),a.push(b.i/u|0),oy(f),oy(f.next),f=c=b),f=f.next}while(f!==c);return _d(f)}function X$(c,a,u,f,g,b){var E=c;do{for(var C=E.next.next;C!==E.prev;){if(E.i!==C.i&&Q$(E,C)){var P=sL(E,C);return E=_d(E,E.next),P=_d(P,P.next),iy(E,a,u,f,g,b,0),void iy(P,a,u,f,g,b,0)}C=C.next}E=E.next}while(E!==c)}function Z$(c,a){return c.x-a.x}function q$(c,a){var u=function(g,b){var E,C=b,P=g.x,M=g.y,D=-1/0;do{if(M<=C.y&&M>=C.next.y&&C.next.y!==C.y){var N=C.x+(M-C.y)*(C.next.x-C.x)/(C.next.y-C.y);if(N<=P&&N>D&&(D=N,E=C.x<C.next.x?C:C.next,N===P))return E}C=C.next}while(C!==b);if(!E)return null;var V,H=E,W=E.x,Q=E.y,oe=1/0;C=E;do P>=C.x&&C.x>=W&&P!==C.x&&cp(M<Q?P:D,M,W,Q,M<Q?D:P,M,C.x,C.y)&&(V=Math.abs(M-C.y)/(P-C.x),ry(C,g)&&(V<oe||V===oe&&(C.x>E.x||C.x===E.x&&Y$(E,C)))&&(E=C,oe=V)),C=C.next;while(C!==H);return E}(c,a);if(!u)return a;var f=sL(u,c);return _d(f,f.next),_d(u,u.next)}function Y$(c,a){return qr(c.prev,c,a.prev)<0&&qr(a.next,c,c.next)<0}function oT(c,a,u,f,g){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-u)*g|0)|c<<8))|c<<4))|c<<2))|c<<1))|(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-f)*g|0)|a<<8))|a<<4))|a<<2))|a<<1))<<1}function J$(c){var a=c,u=c;do(a.x<u.x||a.x===u.x&&a.y<u.y)&&(u=a),a=a.next;while(a!==c);return u}function cp(c,a,u,f,g,b,E,C){return(g-E)*(a-C)>=(c-E)*(b-C)&&(c-E)*(f-C)>=(u-E)*(a-C)&&(u-E)*(b-C)>=(g-E)*(f-C)}function Q$(c,a){return c.next.i!==a.i&&c.prev.i!==a.i&&!function(u,f){var g=u;do{if(g.i!==u.i&&g.next.i!==u.i&&g.i!==f.i&&g.next.i!==f.i&&oL(g,g.next,u,f))return!0;g=g.next}while(g!==u);return!1}(c,a)&&(ry(c,a)&&ry(a,c)&&function(u,f){var g=u,b=!1,E=(u.x+f.x)/2,C=(u.y+f.y)/2;do g.y>C!=g.next.y>C&&g.next.y!==g.y&&E<(g.next.x-g.x)*(C-g.y)/(g.next.y-g.y)+g.x&&(b=!b),g=g.next;while(g!==u);return b}(c,a)&&(qr(c.prev,c,a.prev)||qr(c,a.prev,a))||M1(c,a)&&qr(c.prev,c,c.next)>0&&qr(a.prev,a,a.next)>0)}function qr(c,a,u){return(a.y-c.y)*(u.x-a.x)-(a.x-c.x)*(u.y-a.y)}function M1(c,a){return c.x===a.x&&c.y===a.y}function oL(c,a,u,f){var g=L1(qr(c,a,u)),b=L1(qr(c,a,f)),E=L1(qr(u,f,c)),C=L1(qr(u,f,a));return g!==b&&E!==C||!(g!==0||!R1(c,u,a))||!(b!==0||!R1(c,f,a))||!(E!==0||!R1(u,c,f))||!(C!==0||!R1(u,a,f))}function R1(c,a,u){return a.x<=Math.max(c.x,u.x)&&a.x>=Math.min(c.x,u.x)&&a.y<=Math.max(c.y,u.y)&&a.y>=Math.min(c.y,u.y)}function L1(c){return c>0?1:c<0?-1:0}function ry(c,a){return qr(c.prev,c,c.next)<0?qr(c,a,c.next)>=0&&qr(c,c.prev,a)>=0:qr(c,a,c.prev)<0||qr(c,c.next,a)<0}function sL(c,a){var u=new sT(c.i,c.x,c.y),f=new sT(a.i,a.x,a.y),g=c.next,b=a.prev;return c.next=a,a.prev=c,u.next=g,g.prev=u,f.next=u,u.prev=f,b.next=f,f.prev=b,f}function aL(c,a,u,f){var g=new sT(c,a,u);return f?(g.next=f.next,g.prev=f,f.next.prev=g,f.next=g):(g.prev=g,g.next=g),g}function oy(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function sT(c,a,u){this.i=c,this.x=a,this.y=u,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function aT(c,a,u,f){for(var g=0,b=a,E=u-f;b<u;b+=f)g+=(c[E]-c[b])*(c[b+1]+c[E+1]),E=b;return g}rT.exports=I1,rT.exports.default=I1,I1.deviation=function(c,a,u,f){var g=a&&a.length,b=Math.abs(aT(c,0,g?a[0]*u:c.length,u));if(g)for(var E=0,C=a.length;E<C;E++)b-=Math.abs(aT(c,a[E]*u,E<C-1?a[E+1]*u:c.length,u));var P=0;for(E=0;E<f.length;E+=3){var M=f[E]*u,D=f[E+1]*u,N=f[E+2]*u;P+=Math.abs((c[M]-c[N])*(c[D+1]-c[M+1])-(c[M]-c[D])*(c[N+1]-c[M+1]))}return b===0&&P===0?0:Math.abs((P-b)/b)},I1.flatten=function(c){for(var a=c[0][0].length,u={vertices:[],holes:[],dimensions:a},f=0,g=0;g<c.length;g++){for(var b=0;b<c[g].length;b++)for(var E=0;E<a;E++)u.vertices.push(c[g][b][E]);g>0&&u.holes.push(f+=c[g-1].length)}return u};var lT=G(rT.exports);function eG(c,a,u,f,g){lL(c,a,u||0,f||c.length-1,g||tG)}function lL(c,a,u,f,g){for(;f>u;){if(f-u>600){var b=f-u+1,E=a-u+1,C=Math.log(b),P=.5*Math.exp(2*C/3),M=.5*Math.sqrt(C*P*(b-P)/b)*(E-b/2<0?-1:1);lL(c,a,Math.max(u,Math.floor(a-E*P/b+M)),Math.min(f,Math.floor(a+(b-E)*P/b+M)),g)}var D=c[a],N=u,V=f;for(sy(c,u,a),g(c[f],D)>0&&sy(c,u,f);N<V;){for(sy(c,N,V),N++,V--;g(c[N],D)<0;)N++;for(;g(c[V],D)>0;)V--}g(c[u],D)===0?sy(c,u,V):sy(c,++V,f),V<=a&&(u=V+1),a<=V&&(f=V-1)}}function sy(c,a,u){var f=c[a];c[a]=c[u],c[u]=f}function tG(c,a){return c<a?-1:c>a?1:0}function cT(c,a){const u=c.length;if(u<=1)return[c];const f=[];let g,b;for(let E=0;E<u;E++){const C=Tt(c[E]);C!==0&&(c[E].area=Math.abs(C),b===void 0&&(b=C<0),b===C<0?(g&&f.push(g),g=[c[E]]):g.push(c[E]))}if(g&&f.push(g),a>1)for(let E=0;E<f.length;E++)f[E].length<=a||(eG(f[E],a,1,f[E].length-1,nG),f[E]=f[E].slice(0,a));return f}function nG(c,a){return a.area-c.area}function uT(c,a,u){const f=u.patternDependencies;let g=!1;for(const b of a){const E=b.paint.get(`${c}-pattern`);E.isConstant()||(g=!0);const C=E.constantOr(null);C&&(g=!0,f[C]=!0)}return g}function hT(c,a,u,f,g){const b=g.patternDependencies;for(const E of a){const C=E.paint.get(`${c}-pattern`).value;if(C.kind!=="constant"){let P=C.evaluate({zoom:f},u,{},g.availableImages);P=P&&P.name?P.name:P,b[P]=!0,u.patterns[E.id]=P}}return u}class O1{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(u=>u.id),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ut,this.indexArray=new Sn,this.indexArray2=new Eo,this.programConfigurations=new hd(a.layers,a.zoom),this.segments=new Zr,this.segments2=new Zr,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.projection=a.projection}populate(a,u,f,g){this.hasPattern=uT("fill",this.layers,u);const b=this.layers[0].layout.get("fill-sort-key"),E=[];for(const{feature:C,id:P,index:M,sourceLayerIndex:D}of a){const N=this.layers[0]._featureFilter.needGeometry,V=yd(C,N);if(!this.layers[0]._featureFilter.filter(new z(this.zoom),V,f))continue;const H=b?b.evaluate(V,{},f,u.availableImages):void 0,W={id:P,properties:C.properties,type:C.type,sourceLayerIndex:D,index:M,geometry:N?V.geometry:Mc(C,f,g),patterns:{},sortKey:H};E.push(W)}b&&E.sort((C,P)=>C.sortKey-P.sortKey);for(const C of E){const{geometry:P,index:M,sourceLayerIndex:D}=C;if(this.hasPattern){const N=hT("fill",this.layers,C,this.zoom,u);this.patternFeatures.push(N)}else this.addFeature(C,P,M,f,{},u.availableImages);u.featureIndex.insert(a[M].feature,P,M,D,this.index)}}update(a,u,f,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,f,g)}addFeatures(a,u,f,g,b){for(const E of this.patternFeatures)this.addFeature(E,E.geometry,E.index,u,f,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,G$),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.indexBuffer2=a.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(a,u,f,g,b,E=[]){for(const C of cT(u,500)){let P=0;for(const W of C)P+=W.length;const M=this.segments.prepareSegment(P,this.layoutVertexArray,this.indexArray),D=M.vertexLength,N=[],V=[];for(const W of C){if(W.length===0)continue;W!==C[0]&&V.push(N.length/2);const Q=this.segments2.prepareSegment(W.length,this.layoutVertexArray,this.indexArray2),oe=Q.vertexLength;this.layoutVertexArray.emplaceBack(W[0].x,W[0].y),this.indexArray2.emplaceBack(oe+W.length-1,oe),N.push(W[0].x),N.push(W[0].y);for(let xe=1;xe<W.length;xe++)this.layoutVertexArray.emplaceBack(W[xe].x,W[xe].y),this.indexArray2.emplaceBack(oe+xe-1,oe+xe),N.push(W[xe].x),N.push(W[xe].y);Q.vertexLength+=W.length,Q.primitiveLength+=W.length}const H=lT(N,V);for(let W=0;W<H.length;W+=3)this.indexArray.emplaceBack(D+H[W],D+H[W+1],D+H[W+2]);M.vertexLength+=P,M.primitiveLength+=H.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,b,E,g)}}dn(O1,"FillBucket",{omit:["layers","patternFeatures"]});const iG=new Se({"fill-sort-key":new ce(yt.layout_fill["fill-sort-key"])});var rG={paint:new Se({"fill-antialias":new Y(yt.paint_fill["fill-antialias"]),"fill-opacity":new ce(yt.paint_fill["fill-opacity"]),"fill-color":new ce(yt.paint_fill["fill-color"]),"fill-outline-color":new ce(yt.paint_fill["fill-outline-color"]),"fill-translate":new Y(yt.paint_fill["fill-translate"]),"fill-translate-anchor":new Y(yt.paint_fill["fill-translate-anchor"]),"fill-pattern":new ce(yt.paint_fill["fill-pattern"])}),layout:iG};const oG=Xe([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),sG=Xe([{name:"a_centroid_pos",components:2,type:"Uint16"}]),aG=Xe([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:lG}=oG;var D1={},cG=ye,cL=up;function up(c,a,u,f,g){this.properties={},this.extent=u,this.type=0,this._pbf=c,this._geometry=-1,this._keys=f,this._values=g,c.readFields(uG,this,a)}function uG(c,a,u){c==1?a.id=u.readVarint():c==2?function(f,g){for(var b=f.readVarint()+f.pos;f.pos<b;){var E=g._keys[f.readVarint()],C=g._values[f.readVarint()];g.properties[E]=C}}(u,a):c==3?a.type=u.readVarint():c==4&&(a._geometry=u.pos)}function hG(c){for(var a,u,f=0,g=0,b=c.length,E=b-1;g<b;E=g++)f+=((u=c[E]).x-(a=c[g]).x)*(a.y+u.y);return f}up.types=["Unknown","Point","LineString","Polygon"],up.prototype.loadGeometry=function(){var c=this._pbf;c.pos=this._geometry;for(var a,u=c.readVarint()+c.pos,f=1,g=0,b=0,E=0,C=[];c.pos<u;){if(g<=0){var P=c.readVarint();f=7&P,g=P>>3}if(g--,f===1||f===2)b+=c.readSVarint(),E+=c.readSVarint(),f===1&&(a&&C.push(a),a=[]),a.push(new cG(b,E));else{if(f!==7)throw new Error("unknown command "+f);a&&a.push(a[0].clone())}}return a&&C.push(a),C},up.prototype.bbox=function(){var c=this._pbf;c.pos=this._geometry;for(var a=c.readVarint()+c.pos,u=1,f=0,g=0,b=0,E=1/0,C=-1/0,P=1/0,M=-1/0;c.pos<a;){if(f<=0){var D=c.readVarint();u=7&D,f=D>>3}if(f--,u===1||u===2)(g+=c.readSVarint())<E&&(E=g),g>C&&(C=g),(b+=c.readSVarint())<P&&(P=b),b>M&&(M=b);else if(u!==7)throw new Error("unknown command "+u)}return[E,P,C,M]},up.prototype.toGeoJSON=function(c,a,u){var f,g,b=this.extent*Math.pow(2,u),E=this.extent*c,C=this.extent*a,P=this.loadGeometry(),M=up.types[this.type];function D(H){for(var W=0;W<H.length;W++){var Q=H[W];H[W]=[360*(Q.x+E)/b-180,360/Math.PI*Math.atan(Math.exp((180-360*(Q.y+C)/b)*Math.PI/180))-90]}}switch(this.type){case 1:var N=[];for(f=0;f<P.length;f++)N[f]=P[f][0];D(P=N);break;case 2:for(f=0;f<P.length;f++)D(P[f]);break;case 3:for(P=function(H){var W=H.length;if(W<=1)return[H];for(var Q,oe,xe=[],Me=0;Me<W;Me++){var we=hG(H[Me]);we!==0&&(oe===void 0&&(oe=we<0),oe===we<0?(Q&&xe.push(Q),Q=[H[Me]]):Q.push(H[Me]))}return Q&&xe.push(Q),xe}(P),f=0;f<P.length;f++)for(g=0;g<P[f].length;g++)D(P[f][g])}P.length===1?P=P[0]:M="Multi"+M;var V={type:"Feature",geometry:{type:M,coordinates:P},properties:this.properties};return"id"in this&&(V.id=this.id),V};var dG=cL,uL=hL;function hL(c,a){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(fG,this,a),this.length=this._features.length}function fG(c,a,u){c===15?a.version=u.readVarint():c===1?a.name=u.readString():c===5?a.extent=u.readVarint():c===2?a._features.push(u.pos):c===3?a._keys.push(u.readString()):c===4&&a._values.push(function(f){for(var g=null,b=f.readVarint()+f.pos;f.pos<b;){var E=f.readVarint()>>3;g=E===1?f.readString():E===2?f.readFloat():E===3?f.readDouble():E===4?f.readVarint64():E===5?f.readVarint():E===6?f.readSVarint():E===7?f.readBoolean():null}return g}(u))}hL.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var a=this._pbf.readVarint()+this._pbf.pos;return new dG(this._pbf,a,this.extent,this._keys,this._values)};var pG=uL;function mG(c,a,u){if(c===3){var f=new pG(u,u.readVarint()+u.pos);f.length&&(a[f.name]=f)}}var dT=D1.VectorTile=function(c,a){this.layers=c.readFields(mG,{},a)},k1=D1.VectorTileFeature=cL;function F1(c,a,u,f){const g=[],b=f===0?(E,C,P,M,D,N)=>{E.push(new J(N,P+(N-C)/(M-C)*(D-P)))}:(E,C,P,M,D,N)=>{E.push(new J(C+(N-P)/(D-P)*(M-C),N))};for(const E of c){const C=[];for(const P of E){if(P.length<=2)continue;const M=[];for(let V=0;V<P.length-1;V++){const H=P[V].x,W=P[V].y,Q=P[V+1].x,oe=P[V+1].y,xe=f===0?H:W,Me=f===0?Q:oe;xe<a?Me>a&&b(M,H,W,Q,oe,a):xe>u?Me<u&&b(M,H,W,Q,oe,u):M.push(P[V]),Me<a&&xe>=a&&b(M,H,W,Q,oe,a),Me>u&&xe<=u&&b(M,H,W,Q,oe,u)}let D=P[P.length-1];const N=f===0?D.x:D.y;N>=a&&N<=u&&M.push(D),M.length&&(D=M[M.length-1],M[0].x===D.x&&M[0].y===D.y||M.push(M[0]),C.push(M))}C.length&&g.push(C)}return g}D1.VectorTileLayer=uL;const gG=k1.types,yG=Math.pow(2,13);function ay(c,a,u,f,g,b,E,C){c.emplaceBack((a<<1)+E,(u<<1)+b,(Math.floor(f*yG)<<1)+g,Math.round(C))}function ly(c,a,u){c.emplaceBack(a.x,a.y,a.z,u[0]*16384,u[1]*16384,u[2]*16384)}class dL{constructor(){this.acc=new J(0,0),this.polyCount=[]}startRing(a){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new J(a.x,a.y),this.max=new J(a.x,a.y))}append(a,u){this.currentPolyCount.edges++,this.acc._add(a);const f=this.min,g=this.max;a.x<f.x?f.x=a.x:a.x>g.x&&(g.x=a.x),a.y<f.y?f.y=a.y:a.y>g.y&&(g.y=a.y),((a.x===0||a.x===On)&&a.x===u.x)!=((a.y===0||a.y===On)&&a.y===u.y)&&this.processBorderOverlap(a,u),u.x<0!=a.x<0&&this.addBorderIntersection(0,Ci(u.y,a.y,(0-u.x)/(a.x-u.x))),u.x>On!=a.x>On&&this.addBorderIntersection(1,Ci(u.y,a.y,(On-u.x)/(a.x-u.x))),u.y<0!=a.y<0&&this.addBorderIntersection(2,Ci(u.x,a.x,(0-u.y)/(a.y-u.y))),u.y>On!=a.y>On&&this.addBorderIntersection(3,Ci(u.x,a.x,(On-u.y)/(a.y-u.y)))}addBorderIntersection(a,u){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const f=this.borders[a];u<f[0]&&(f[0]=u),u>f[1]&&(f[1]=u)}processBorderOverlap(a,u){if(a.x===u.x){if(a.y===u.y)return;const f=a.x===0?0:1;this.addBorderIntersection(f,u.y),this.addBorderIntersection(f,a.y)}else{const f=a.y===0?2:3;this.addBorderIntersection(f,u.x),this.addBorderIntersection(f,a.x)}}centroid(){const a=this.polyCount.reduce((u,f)=>u+f.edges,0);return a!==0?this.acc.div(a)._round():new J(0,0)}span(){return new J(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((a,u)=>a+ +(u[0]!==Number.MAX_VALUE),0)}}class cy{constructor(a){this.zoom=a.zoom,this.canonical=a.canonical,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(u=>u.id),this.index=a.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=a.projection,this.layoutVertexArray=new wt,this.centroidVertexArray=new il,this.indexArray=new Sn,this.programConfigurations=new hd(a.layers,a.zoom),this.segments=new Zr,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.enableTerrain=a.enableTerrain}populate(a,u,f,g){this.features=[],this.hasPattern=uT("fill-extrusion",this.layers,u),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(b){const E=Math.exp(Math.PI*(1-b.y/(1<<b.z)*2));return 80150034*E/(E*E+1)/On/(1<<b.z)}(f),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:b,id:E,index:C,sourceLayerIndex:P}of a){const M=this.layers[0]._featureFilter.needGeometry,D=yd(b,M);if(!this.layers[0]._featureFilter.filter(new z(this.zoom),D,f))continue;const N={id:E,sourceLayerIndex:P,index:C,geometry:M?D.geometry:Mc(b,f,g),properties:b.properties,type:b.type,patterns:{}},V=this.layoutVertexArray.length;this.hasPattern?this.features.push(hT("fill-extrusion",this.layers,N,this.zoom,u)):this.addFeature(N,N.geometry,C,f,{},u.availableImages,g),u.featureIndex.insert(b,N.geometry,C,P,this.index,V)}this.sortBorders()}addFeatures(a,u,f,g,b){for(const E of this.features){const{geometry:C}=E;this.addFeature(E,C,E.index,u,f,g,b)}this.sortBorders()}update(a,u,f,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,f,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,lG),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=a.createVertexBuffer(this.layoutVertexExtArray,aG.members,!0))),this.programConfigurations.upload(a),this.uploaded=!0}uploadCentroid(a){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=a.createVertexBuffer(this.centroidVertexArray,sG.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(a,u,f,g,b,E,C){const P=[new J(0,0),new J(On,On)],M=C.projection,D=M.name==="globe",N=this.enableTerrain&&!D?new dL:null,V=gG[a.type]==="Polygon";D&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new jt);const H=cT(u,500);for(let xe=H.length-1;xe>=0;xe--){const Me=H[xe];(Me.length===0||(W=Me[0]).every(we=>we.x<=0)||W.every(we=>we.x>=On)||W.every(we=>we.y<=0)||W.every(we=>we.y>=On))&&H.splice(xe,1)}var W;let Q;if(D)Q=_L(H,P,g);else{Q=[];for(const xe of H)Q.push({polygon:xe,bounds:P})}const oe=V?this.edgeRadius:0;for(const{polygon:xe,bounds:Me}of Q){let we=0,Ie=0;for(const De of xe)V&&!De[0].equals(De[De.length-1])&&De.push(De[0]),Ie+=V?De.length-1:De.length;const Fe=this.segments.prepareSegment((V?5:4)*Ie,this.layoutVertexArray,this.indexArray);if(V){const De=[],lt=[];we=Fe.vertexLength;for(const _t of xe){let Vt,ft;_t.length&&_t!==xe[0]&&lt.push(De.length/2),Vt=_t[1].sub(_t[0])._perp()._unit();for(let St=1;St<_t.length;St++){const Ct=_t[St],Dt=_t[St===_t.length-1?1:St+1];let{x:Kt,y:vt}=Ct;if(oe){ft=Dt.sub(Ct)._perp()._unit();const rn=Vt.add(ft)._unit(),yn=oe*Math.min(4,1/(Vt.x*rn.x+Vt.y*rn.y));Kt+=yn*rn.x,vt+=yn*rn.y,Vt=ft}ay(this.layoutVertexArray,Kt,vt,0,0,1,1,0),Fe.vertexLength++,De.push(Ct.x,Ct.y),D&&ly(this.layoutVertexExtArray,M.projectTilePoint(Kt,vt,g),M.upVector(g,Kt,vt))}}const it=lT(De,lt);for(let _t=0;_t<it.length;_t+=3)this.indexArray.emplaceBack(we+it[_t],we+it[_t+2],we+it[_t+1]),Fe.primitiveLength++}for(const De of xe){N&&De.length&&N.startRing(De[0]);let lt,it,_t,Vt=De.length>4&&gL(De[De.length-2],De[0],De[1]),ft=oe?vG(De[De.length-2],De[0],De[1],oe):0;it=De[1].sub(De[0])._perp()._unit();let St=!0;for(let Ct=1,Dt=0;Ct<De.length;Ct++){let Kt=De[Ct-1],vt=De[Ct];const rn=De[Ct===De.length-1?1:Ct+1];if(N&&V&&N.currentPolyCount.top++,mL(vt,Kt,Me)){oe&&(it=rn.sub(vt)._perp()._unit(),St=!St);continue}N&&N.append(vt,Kt);const yn=vt.sub(Kt)._perp(),sn=yn.x/(Math.abs(yn.x)+Math.abs(yn.y)),oi=yn.y>0?1:0,Zt=Kt.dist(vt);if(Dt+Zt>32768&&(Dt=0),oe){_t=rn.sub(vt)._perp()._unit();let ai=pL(Kt,vt,rn,fL(it,_t),oe);isNaN(ai)&&(ai=0);const Nn=vt.sub(Kt)._unit();Kt=Kt.add(Nn.mult(ft))._round(),vt=vt.add(Nn.mult(-ai))._round(),ft=ai,it=_t}const Rn=Fe.vertexLength,si=De.length>4&&gL(Kt,vt,rn);let Ii=yL(Dt,Vt,St);if(ay(this.layoutVertexArray,Kt.x,Kt.y,sn,oi,0,0,Ii),ay(this.layoutVertexArray,Kt.x,Kt.y,sn,oi,0,1,Ii),Dt+=Zt,Ii=yL(Dt,si,!St),Vt=si,ay(this.layoutVertexArray,vt.x,vt.y,sn,oi,0,0,Ii),ay(this.layoutVertexArray,vt.x,vt.y,sn,oi,0,1,Ii),Fe.vertexLength+=4,this.indexArray.emplaceBack(Rn+0,Rn+1,Rn+2),this.indexArray.emplaceBack(Rn+1,Rn+3,Rn+2),Fe.primitiveLength+=2,oe){const ai=we+(Ct===1?De.length-2:Ct-2),Nn=Ct===1?we:ai+1;if(this.indexArray.emplaceBack(Rn+1,ai,Rn+3),this.indexArray.emplaceBack(ai,Nn,Rn+3),Fe.primitiveLength+=2,lt===void 0&&(lt=Rn),!mL(rn,De[Ct],Me)){const ar=Ct===De.length-1?lt:Fe.vertexLength;this.indexArray.emplaceBack(Rn+2,Rn+3,ar),this.indexArray.emplaceBack(Rn+3,ar+1,ar),this.indexArray.emplaceBack(Rn+3,Nn,ar+1),Fe.primitiveLength+=3}St=!St}if(D){const ai=this.layoutVertexExtArray,Nn=M.projectTilePoint(Kt.x,Kt.y,g),ar=M.projectTilePoint(vt.x,vt.y,g),hi=M.upVector(g,Kt.x,Kt.y),di=M.upVector(g,vt.x,vt.y);ly(ai,Nn,hi),ly(ai,Nn,hi),ly(ai,ar,di),ly(ai,ar,di)}}V&&(we+=De.length-1)}}if(N&&N.polyCount.length>0){if(N.borders){N.vertexArrayOffset=this.centroidVertexArray.length;const xe=N.borders,Me=this.featuresOnBorder.push(N)-1;for(let we=0;we<4;we++)xe[we][0]!==Number.MAX_VALUE&&this.borders[we].push(Me)}this.encodeCentroid(N.borders?void 0:N.centroid(),N)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,b,E,g)}sortBorders(){for(let a=0;a<4;a++)this.borders[a].sort((u,f)=>this.featuresOnBorder[u].borders[a][0]-this.featuresOnBorder[f].borders[a][0])}encodeCentroid(a,u,f=!0){let g,b;if(a)if(a.y!==0){const C=u.span()._mult(this.tileToMeter);g=(Math.max(a.x,1)<<3)+Math.min(7,Math.round(C.x/10)),b=(Math.max(a.y,1)<<3)+Math.min(7,Math.round(C.y/10))}else g=Math.ceil(7*(a.x+450)),b=0;else g=0,b=+f;let E=f?this.centroidVertexArray.length:u.vertexArrayOffset;for(const C of u.polyCount){f&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*C.edges+C.top);for(let P=0;P<C.top;P++)this.centroidVertexArray.emplace(E++,g,b);for(let P=0;P<2*C.edges;P++)this.centroidVertexArray.emplace(E++,0,b),this.centroidVertexArray.emplace(E++,g,b)}}}function fL(c,a){const u=c.add(a)._unit();return c.x*u.x+c.y*u.y}function vG(c,a,u,f){const g=a.sub(c)._perp()._unit(),b=u.sub(a)._perp()._unit();return pL(c,a,u,fL(g,b),f)}function pL(c,a,u,f,g){const b=Math.sqrt(1-f*f);return Math.min(c.dist(a)/3,a.dist(u)/3,g*b/f)}function mL(c,a,u){return c.x<u[0].x&&a.x<u[0].x||c.x>u[1].x&&a.x>u[1].x||c.y<u[0].y&&a.y<u[0].y||c.y>u[1].y&&a.y>u[1].y}function gL(c,a,u){if(c.x<0||c.x>=On||a.x<0||a.x>=On||u.x<0||u.x>=On)return!1;const f=u.sub(a),g=f.perp(),b=c.sub(a);return(f.x*b.x+f.y*b.y)/Math.sqrt((f.x*f.x+f.y*f.y)*(b.x*b.x+b.y*b.y))>-.866&&g.x*b.x+g.y*b.y<0}function yL(c,a,u){const f=a?2|c:-3&c;return u?1|f:-2&f}function vL(){const c=Math.PI/32,a=Math.tan(c),u=ny;return u*Math.sqrt(1+2*a*a)-u}function _L(c,a,u){const f=1<<u.z,g=ca(u.x/f),b=ca((u.x+1)/f),E=jo(u.y/f),C=jo((u.y+1)/f);return function(P,M,D,N,V=0,H){const W=[];if(!P.length||!D||!N)return W;const Q=(De,lt)=>{for(const it of De)W.push({polygon:it,bounds:lt})},oe=Math.ceil(Math.log2(D)),xe=Math.ceil(Math.log2(N)),Me=oe-xe,we=[];for(let De=0;De<Math.abs(Me);De++)we.push(Me>0?0:1);for(let De=0;De<Math.min(oe,xe);De++)we.push(0),we.push(1);let Ie=P;if(Ie=F1(Ie,M[0].y-V,M[1].y+V,1),Ie=F1(Ie,M[0].x-V,M[1].x+V,0),!Ie.length)return W;const Fe=[];for(we.length?Fe.push({polygons:Ie,bounds:M,depth:0}):Q(Ie,M);Fe.length;){const De=Fe.pop(),lt=De.depth,it=we[lt],_t=De.bounds[0],Vt=De.bounds[1],ft=it===0?_t.x:_t.y,St=it===0?Vt.x:Vt.y,Ct=H?H(it,ft,St):.5*(ft+St),Dt=F1(De.polygons,ft-V,Ct+V,it),Kt=F1(De.polygons,Ct-V,St+V,it);if(Dt.length){const vt=[_t,new J(it===0?Ct:Vt.x,it===1?Ct:Vt.y)];we.length>lt+1?Fe.push({polygons:Dt,bounds:vt,depth:lt+1}):Q(Dt,vt)}if(Kt.length){const vt=[new J(it===0?Ct:_t.x,it===1?Ct:_t.y),Vt];we.length>lt+1?Fe.push({polygons:Kt,bounds:vt,depth:lt+1}):Q(Kt,vt)}}return W}(c,a,Math.ceil((b-g)/11.25),Math.ceil((E-C)/11.25),1,(P,M,D)=>{if(P===0)return .5*(M+D);{const N=jo((u.y+M/On)/f);return(Ul(.5*(jo((u.y+D/On)/f)+N))*f-u.y)*On}})}dn(cy,"FillExtrusionBucket",{omit:["layers","features"]}),dn(dL,"PartMetadata");const _G=new Se({"fill-extrusion-edge-radius":new Y(yt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var bG={paint:new Se({"fill-extrusion-opacity":new Y(yt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ce(yt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Y(yt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Y(yt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ce(yt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ce(yt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ce(yt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Y(yt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Y(yt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Y(yt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new Y(yt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:_G};function bL(c,a,u){var f=2*Math.PI*6378137/256/Math.pow(2,u);return[c*f-2*Math.PI*6378137/2,a*f-2*Math.PI*6378137/2]}class B1{constructor(a,u,f){this.z=a,this.x=u,this.y=f,this.key=uy(0,a,a,u,f)}equals(a){return this.z===a.z&&this.x===a.x&&this.y===a.y}url(a,u){const f=function(b,E,C){var P=bL(256*b,256*(E=Math.pow(2,C)-E-1),C),M=bL(256*(b+1),256*(E+1),C);return P[0]+","+P[1]+","+M[0]+","+M[1]}(this.x,this.y,this.z),g=function(b,E,C){let P,M="";for(let D=b;D>0;D--)P=1<<D-1,M+=(E&P?1:0)+(C&P?2:0);return M}(this.z,this.x,this.y);return a[(this.x+this.y)%a.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(u==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",g).replace("{bbox-epsg-3857}",f)}toString(){return`${this.z}/${this.x}/${this.y}`}}class xL{constructor(a,u){this.wrap=a,this.canonical=u,this.key=uy(a,u.z,u.z,u.x,u.y)}}class ss{constructor(a,u,f,g,b){this.overscaledZ=a,this.wrap=u,this.canonical=new B1(f,+g,+b),this.key=u===0&&a===f?this.canonical.key:uy(u,a,f,g,b)}equals(a){return this.overscaledZ===a.overscaledZ&&this.wrap===a.wrap&&this.canonical.equals(a.canonical)}scaledTo(a){const u=this.canonical.z-a;return a>this.canonical.z?new ss(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ss(a,this.wrap,a,this.canonical.x>>u,this.canonical.y>>u)}calculateScaledKey(a,u=!0){if(this.overscaledZ===a&&u)return this.key;if(a>this.canonical.z)return uy(this.wrap*+u,a,this.canonical.z,this.canonical.x,this.canonical.y);{const f=this.canonical.z-a;return uy(this.wrap*+u,a,a,this.canonical.x>>f,this.canonical.y>>f)}}isChildOf(a){if(a.wrap!==this.wrap)return!1;const u=this.canonical.z-a.canonical.z;return a.overscaledZ===0||a.overscaledZ<this.overscaledZ&&a.canonical.x===this.canonical.x>>u&&a.canonical.y===this.canonical.y>>u}children(a){if(this.overscaledZ>=a)return[new ss(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const u=this.canonical.z+1,f=2*this.canonical.x,g=2*this.canonical.y;return[new ss(u,this.wrap,u,f,g),new ss(u,this.wrap,u,f+1,g),new ss(u,this.wrap,u,f,g+1),new ss(u,this.wrap,u,f+1,g+1)]}isLessThan(a){return this.wrap<a.wrap||!(this.wrap>a.wrap)&&(this.overscaledZ<a.overscaledZ||!(this.overscaledZ>a.overscaledZ)&&(this.canonical.x<a.canonical.x||!(this.canonical.x>a.canonical.x)&&this.canonical.y<a.canonical.y))}wrapped(){return new ss(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(a){return new ss(this.overscaledZ,a,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new xL(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function uy(c,a,u,f,g){const b=1<<Math.min(u,22);let E=b*(g%b)+f%b;return c&&u<22&&(E+=b*b*((c<0?-2*c-1:2*c)%(1<<2*(22-u)))),16*(32*E+u)+(a-u)}dn(B1,"CanonicalTileID"),dn(ss,"OverscaledTileID",{omit:["projMatrix"]});class hp extends J{constructor(a,u,f){super(a,u),this.z=f}}function hy(c,a){return c.x*a.x+c.y*a.y}function wL(c,a){if(c.length===1){let u=0;const f=a[u++];let g;for(;!g||f.equals(g);)if(g=a[u++],!g)return 1/0;for(;u<a.length;u++){const b=a[u],E=c[0],C=g.sub(f),P=b.sub(f),M=E.sub(f),D=hy(C,C),N=hy(C,P),V=hy(P,P),H=hy(M,C),W=hy(M,P),Q=D*V-N*N,oe=(V*H-N*W)/Q,xe=(D*W-N*H)/Q,Me=f.z*(1-oe-xe)+g.z*oe+b.z*xe;if(isFinite(Me))return Me}return 1/0}{let u=1/0;for(const f of a)u=Math.min(u,f.z);return u}}function EL(c,a,u,f,g,b,E,C){const P=E*g.getElevationAt(c,a,!0,!0),M=b[0]!==0,D=M?b[1]===0?E*(b[0]/7-450):E*function(N,V,H){const W=Math.floor(V[0]/8),Q=Math.floor(V[1]/8),oe=10*(V[0]-8*W),xe=10*(V[1]-8*Q),Me=N.getElevationAt(W,Q,!0,!0),we=N.getMeterToDEM(H),Ie=Math.floor(.5*(oe*we-1)),Fe=Math.floor(.5*(xe*we-1)),De=N.tileCoordToPixel(W,Q),lt=2*Ie+1,it=2*Fe+1,_t=function(Kt,vt,rn,yn,sn){return[Kt.getElevationAtPixel(vt,rn,!0),Kt.getElevationAtPixel(vt+sn,rn,!0),Kt.getElevationAtPixel(vt,rn+sn,!0),Kt.getElevationAtPixel(vt+yn,rn+sn,!0)]}(N,De.x-Ie,De.y-Fe,lt,it),Vt=Math.abs(_t[0]-_t[1]),ft=Math.abs(_t[2]-_t[3]),St=Math.abs(_t[0]-_t[2])+Math.abs(_t[1]-_t[3]),Ct=Math.min(.25,.5*we*(Vt+ft)/lt),Dt=Math.min(.25,.5*we*St/it);return Me+Math.max(Ct*oe,Dt*xe)}(g,b,C):P;return{base:P+(u===0)?-1:u,top:M?Math.max(D+f,P+u+2):P+f}}const xG=Xe([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:wG}=xG,EG=Xe([{name:"a_packed",components:4,type:"Float32"}]),{members:TG}=EG,SG=k1.types,CG=Math.cos(Math.PI/180*37.5);class z1{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(u=>u.id),this.index=a.index,this.projection=a.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(u=>{this.gradients[u.id]={}}),this.layoutVertexArray=new dt,this.layoutVertexArray2=new Bt,this.indexArray=new Sn,this.programConfigurations=new hd(a.layers,a.zoom),this.segments=new Zr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(a,u,f,g){this.hasPattern=uT("line",this.layers,u);const b=this.layers[0].layout.get("line-sort-key"),E=[];for(const{feature:D,id:N,index:V,sourceLayerIndex:H}of a){const W=this.layers[0]._featureFilter.needGeometry,Q=yd(D,W);if(!this.layers[0]._featureFilter.filter(new z(this.zoom),Q,f))continue;const oe=b?b.evaluate(Q,{},f):void 0,xe={id:N,properties:D.properties,type:D.type,sourceLayerIndex:H,index:V,geometry:W?Q.geometry:Mc(D,f,g),patterns:{},sortKey:oe};E.push(xe)}b&&E.sort((D,N)=>D.sortKey-N.sortKey);const{lineAtlas:C,featureIndex:P}=u,M=this.addConstantDashes(C);for(const D of E){const{geometry:N,index:V,sourceLayerIndex:H}=D;if(M&&this.addFeatureDashes(D,C),this.hasPattern){const W=hT("line",this.layers,D,this.zoom,u);this.patternFeatures.push(W)}else this.addFeature(D,N,V,f,C.positions,u.availableImages);P.insert(a[V].feature,N,V,H,this.index)}}addConstantDashes(a){let u=!1;for(const f of this.layers){const g=f.paint.get("line-dasharray").value,b=f.layout.get("line-cap").value;if(g.kind!=="constant"||b.kind!=="constant")u=!0;else{const E=b.value,C=g.value;if(!C)continue;a.addDash(C,E)}}return u}addFeatureDashes(a,u){const f=this.zoom;for(const g of this.layers){const b=g.paint.get("line-dasharray").value,E=g.layout.get("line-cap").value;if(b.kind==="constant"&&E.kind==="constant")continue;let C,P;if(b.kind==="constant"){if(C=b.value,!C)continue}else C=b.evaluate({zoom:f},a);P=E.kind==="constant"?E.value:E.evaluate({zoom:f},a),u.addDash(C,P),a.patterns[g.id]=u.getKey(C,P)}}update(a,u,f,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,f,g)}addFeatures(a,u,f,g,b){for(const E of this.patternFeatures)this.addFeature(E,E.geometry,E.index,u,f,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=a.createVertexBuffer(this.layoutVertexArray2,TG)),this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,wG),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(a){if(a.properties&&a.properties.hasOwnProperty("mapbox_clip_start")&&a.properties.hasOwnProperty("mapbox_clip_end"))return{start:+a.properties.mapbox_clip_start,end:+a.properties.mapbox_clip_end}}addFeature(a,u,f,g,b,E){const C=this.layers[0].layout,P=C.get("line-join").evaluate(a,{}),M=C.get("line-cap").evaluate(a,{}),D=C.get("line-miter-limit"),N=C.get("line-round-limit");this.lineClips=this.lineFeatureClips(a);for(const V of u)this.addLine(V,a,P,M,D,N);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,b,E,g)}addLine(a,u,f,g,b,E){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let xe=0;xe<a.length-1;xe++)this.totalDistance+=a[xe].dist(a[xe+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const C=SG[u.type]==="Polygon";let P=a.length;for(;P>=2&&a[P-1].equals(a[P-2]);)P--;let M=0;for(;M<P-1&&a[M].equals(a[M+1]);)M++;if(P<(C?3:2))return;f==="bevel"&&(b=1.05);const D=this.overscaling<=16?15*On/(512*this.overscaling):0,N=this.segments.prepareSegment(10*P,this.layoutVertexArray,this.indexArray);let V,H,W,Q,oe;this.e1=this.e2=-1,C&&(V=a[P-2],oe=a[M].sub(V)._unit()._perp());for(let xe=M;xe<P;xe++){if(W=xe===P-1?C?a[M+1]:void 0:a[xe+1],W&&a[xe].equals(W))continue;oe&&(Q=oe),V&&(H=V),V=a[xe],oe=W?W.sub(V)._unit()._perp():Q,Q=Q||oe;let Me=Q.add(oe);Me.x===0&&Me.y===0||Me._unit();const we=Q.x*oe.x+Q.y*oe.y,Ie=Me.x*oe.x+Me.y*oe.y,Fe=Ie!==0?1/Ie:1/0,De=2*Math.sqrt(2-2*Ie),lt=Ie<CG&&H&&W,it=Q.x*oe.y-Q.y*oe.x>0;if(lt&&xe>M){const ft=V.dist(H);if(ft>2*D){const St=V.sub(V.sub(H)._mult(D/ft)._round());this.updateDistance(H,St),this.addCurrentVertex(St,Q,0,0,N),H=St}}const _t=H&&W;let Vt=_t?f:C?"butt":g;if(_t&&Vt==="round"&&(Fe<E?Vt="miter":Fe<=2&&(Vt="fakeround")),Vt==="miter"&&Fe>b&&(Vt="bevel"),Vt==="bevel"&&(Fe>2&&(Vt="flipbevel"),Fe<b&&(Vt="miter")),H&&this.updateDistance(H,V),Vt==="miter")Me._mult(Fe),this.addCurrentVertex(V,Me,0,0,N);else if(Vt==="flipbevel"){if(Fe>100)Me=oe.mult(-1);else{const ft=Fe*Q.add(oe).mag()/Q.sub(oe).mag();Me._perp()._mult(ft*(it?-1:1))}this.addCurrentVertex(V,Me,0,0,N),this.addCurrentVertex(V,Me.mult(-1),0,0,N)}else if(Vt==="bevel"||Vt==="fakeround"){const ft=-Math.sqrt(Fe*Fe-1),St=it?ft:0,Ct=it?0:ft;if(H&&this.addCurrentVertex(V,Q,St,Ct,N),Vt==="fakeround"){const Dt=Math.round(180*De/Math.PI/20);for(let Kt=1;Kt<Dt;Kt++){let vt=Kt/Dt;if(vt!==.5){const yn=vt-.5;vt+=vt*yn*(vt-1)*((1.0904+we*(we*(3.55645-1.43519*we)-3.2452))*yn*yn+(.848013+we*(.215638*we-1.06021)))}const rn=oe.sub(Q)._mult(vt)._add(Q)._unit()._mult(it?-1:1);this.addHalfVertex(V,rn.x,rn.y,!1,it,0,N)}}W&&this.addCurrentVertex(V,oe,-St,-Ct,N)}else if(Vt==="butt")this.addCurrentVertex(V,Me,0,0,N);else if(Vt==="square"){const ft=H?1:-1;H||this.addCurrentVertex(V,Me,ft,ft,N),this.addCurrentVertex(V,Me,0,0,N),H&&this.addCurrentVertex(V,Me,ft,ft,N)}else Vt==="round"&&(H&&(this.addCurrentVertex(V,Q,0,0,N),this.addCurrentVertex(V,Q,1,1,N,!0)),W&&(this.addCurrentVertex(V,oe,-1,-1,N,!0),this.addCurrentVertex(V,oe,0,0,N)));if(lt&&xe<P-1){const ft=V.dist(W);if(ft>2*D){const St=V.add(W.sub(V)._mult(D/ft)._round());this.updateDistance(V,St),this.addCurrentVertex(St,oe,0,0,N),V=St}}}}addCurrentVertex(a,u,f,g,b,E=!1){const C=u.y*g-u.x,P=-u.y-u.x*g;this.addHalfVertex(a,u.x+u.y*f,u.y-u.x*f,E,!1,f,b),this.addHalfVertex(a,C,P,E,!0,-g,b)}addHalfVertex({x:a,y:u},f,g,b,E,C,P){this.layoutVertexArray.emplaceBack((a<<1)+(b?1:0),(u<<1)+(E?1:0),Math.round(63*f)+128,Math.round(63*g)+128,1+(C===0?0:C<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const M=P.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,M),P.primitiveLength++),E?this.e2=M:this.e1=M}updateScaledDistance(){if(this.lineClips){const a=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=a*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(a,u){this.distance+=a.dist(u),this.updateScaledDistance()}}dn(z1,"LineBucket",{omit:["layers","patternFeatures"]});const AG=new Se({"line-cap":new ce(yt.layout_line["line-cap"]),"line-join":new ce(yt.layout_line["line-join"]),"line-miter-limit":new Y(yt.layout_line["line-miter-limit"]),"line-round-limit":new Y(yt.layout_line["line-round-limit"]),"line-sort-key":new ce(yt.layout_line["line-sort-key"])});var TL={paint:new Se({"line-opacity":new ce(yt.paint_line["line-opacity"]),"line-color":new ce(yt.paint_line["line-color"]),"line-translate":new Y(yt.paint_line["line-translate"]),"line-translate-anchor":new Y(yt.paint_line["line-translate-anchor"]),"line-width":new ce(yt.paint_line["line-width"]),"line-gap-width":new ce(yt.paint_line["line-gap-width"]),"line-offset":new ce(yt.paint_line["line-offset"]),"line-blur":new ce(yt.paint_line["line-blur"]),"line-dasharray":new ce(yt.paint_line["line-dasharray"]),"line-pattern":new ce(yt.paint_line["line-pattern"]),"line-gradient":new Ee(yt.paint_line["line-gradient"]),"line-trim-offset":new Y(yt.paint_line["line-trim-offset"])}),layout:AG};const SL=new class extends ce{possiblyEvaluate(c,a){return a=new z(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,transition:a.transition}),super.possiblyEvaluate(c,a)}evaluate(c,a,u,f){return a=An({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(c,a,u,f)}}(TL.paint.properties["line-width"].specification);function CL(c,a){return a>0?a+2*c:c}SL.useIntegerZoom=!0;const PG=Xe([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),IG=Xe([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),MG=Xe([{name:"a_projected_pos",components:4,type:"Float32"}],4);Xe([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const RG=Xe([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),LG=Xe([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Xe([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const AL=Xe([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),OG=Xe([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Xe([{name:"triangle",components:3,type:"Uint16"}]),Xe([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Xe([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Xe([{type:"Float32",name:"offsetX"}]),Xe([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Lo=24;const cl=128;function fT(c,a){const{expression:u}=a;if(u.kind==="constant")return{kind:"constant",layoutSize:u.evaluate(new z(c+1))};if(u.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:g}=u;let b=0;for(;b<f.length&&f[b]<=c;)b++;b=Math.max(0,b-1);let E=b;for(;E<f.length&&f[E]<c+1;)E++;E=Math.min(f.length-1,E);const C=f[b],P=f[E];return u.kind==="composite"?{kind:"composite",minZoom:C,maxZoom:P,interpolationType:g}:{kind:"camera",minZoom:C,maxZoom:P,minSize:u.evaluate(new z(C)),maxSize:u.evaluate(new z(P)),interpolationType:g}}}function N1(c,{uSize:a,uSizeT:u},{lowerSize:f,upperSize:g}){return c.kind==="source"?f/cl:c.kind==="composite"?Ci(f/cl,g/cl,u):a}function dp(c,a){let u=0,f=0;if(c.kind==="constant")f=c.layoutSize;else if(c.kind!=="source"){const{interpolationType:g,minZoom:b,maxZoom:E}=c,C=g?bt(Pa.interpolationFactor(g,a,b,E),0,1):0;c.kind==="camera"?f=Ci(c.minSize,c.maxSize,C):u=C}return{uSizeT:u,uSize:f}}var DG=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:cl,evaluateSizeForFeature:N1,evaluateSizeForZoom:dp,getSizeData:fT});function kG(c,a,u){return c.sections.forEach(f=>{f.text=function(g,b,E){const C=b.layout.get("text-transform").evaluate(E,{});return C==="uppercase"?g=g.toLocaleUpperCase():C==="lowercase"&&(g=g.toLocaleLowerCase()),O.applyArabicShaping&&(g=O.applyArabicShaping(g)),g}(f.text,a,u)}),c}const dy={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function FG(c){return c==="︶"||c==="﹈"||c==="︸"||c==="﹄"||c==="﹂"||c==="︾"||c==="︼"||c==="︺"||c==="︘"||c==="﹀"||c==="︐"||c==="︓"||c==="︔"||c==="｀"||c==="￣"||c==="︑"||c==="︒"}function BG(c){return c==="︵"||c==="﹇"||c==="︷"||c==="﹃"||c==="﹁"||c==="︽"||c==="︻"||c==="︹"||c==="︗"||c==="︿"}var PL=tr,IL=function(c,a,u,f,g){var b,E,C=8*g-f-1,P=(1<<C)-1,M=P>>1,D=-7,N=u?g-1:0,V=u?-1:1,H=c[a+N];for(N+=V,b=H&(1<<-D)-1,H>>=-D,D+=C;D>0;b=256*b+c[a+N],N+=V,D-=8);for(E=b&(1<<-D)-1,b>>=-D,D+=f;D>0;E=256*E+c[a+N],N+=V,D-=8);if(b===0)b=1-M;else{if(b===P)return E?NaN:1/0*(H?-1:1);E+=Math.pow(2,f),b-=M}return(H?-1:1)*E*Math.pow(2,b-f)},ML=function(c,a,u,f,g,b){var E,C,P,M=8*b-g-1,D=(1<<M)-1,N=D>>1,V=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,H=f?0:b-1,W=f?1:-1,Q=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(C=isNaN(a)?1:0,E=D):(E=Math.floor(Math.log(a)/Math.LN2),a*(P=Math.pow(2,-E))<1&&(E--,P*=2),(a+=E+N>=1?V/P:V*Math.pow(2,1-N))*P>=2&&(E++,P/=2),E+N>=D?(C=0,E=D):E+N>=1?(C=(a*P-1)*Math.pow(2,g),E+=N):(C=a*Math.pow(2,N-1)*Math.pow(2,g),E=0));g>=8;c[u+H]=255&C,H+=W,C/=256,g-=8);for(E=E<<g|C,M+=g;M>0;c[u+H]=255&E,H+=W,E/=256,M-=8);c[u+H-W]|=128*Q};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function tr(c){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(c)?c:new Uint8Array(c||0),this.pos=0,this.type=0,this.length=this.buf.length}tr.Varint=0,tr.Fixed64=1,tr.Bytes=2,tr.Fixed32=5;var pT=4294967296,RL=1/pT,LL=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Lc(c){return c.type===tr.Bytes?c.readVarint()+c.pos:c.pos+1}function fp(c,a,u){return u?4294967296*a+(c>>>0):4294967296*(a>>>0)+(c>>>0)}function OL(c,a,u){var f=a<=16383?1:a<=2097151?2:a<=268435455?3:Math.floor(Math.log(a)/(7*Math.LN2));u.realloc(f);for(var g=u.pos-1;g>=c;g--)u.buf[g+f]=u.buf[g]}function zG(c,a){for(var u=0;u<c.length;u++)a.writeVarint(c[u])}function NG(c,a){for(var u=0;u<c.length;u++)a.writeSVarint(c[u])}function UG(c,a){for(var u=0;u<c.length;u++)a.writeFloat(c[u])}function VG(c,a){for(var u=0;u<c.length;u++)a.writeDouble(c[u])}function jG(c,a){for(var u=0;u<c.length;u++)a.writeBoolean(c[u])}function $G(c,a){for(var u=0;u<c.length;u++)a.writeFixed32(c[u])}function GG(c,a){for(var u=0;u<c.length;u++)a.writeSFixed32(c[u])}function HG(c,a){for(var u=0;u<c.length;u++)a.writeFixed64(c[u])}function WG(c,a){for(var u=0;u<c.length;u++)a.writeSFixed64(c[u])}function U1(c,a){return(c[a]|c[a+1]<<8|c[a+2]<<16)+16777216*c[a+3]}function pp(c,a,u){c[u]=a,c[u+1]=a>>>8,c[u+2]=a>>>16,c[u+3]=a>>>24}function DL(c,a){return(c[a]|c[a+1]<<8|c[a+2]<<16)+(c[a+3]<<24)}tr.prototype={destroy:function(){this.buf=null},readFields:function(c,a,u){for(u=u||this.length;this.pos<u;){var f=this.readVarint(),g=f>>3,b=this.pos;this.type=7&f,c(g,a,this),this.pos===b&&this.skip(f)}return a},readMessage:function(c,a){return this.readFields(c,a,this.readVarint()+this.pos)},readFixed32:function(){var c=U1(this.buf,this.pos);return this.pos+=4,c},readSFixed32:function(){var c=DL(this.buf,this.pos);return this.pos+=4,c},readFixed64:function(){var c=U1(this.buf,this.pos)+U1(this.buf,this.pos+4)*pT;return this.pos+=8,c},readSFixed64:function(){var c=U1(this.buf,this.pos)+DL(this.buf,this.pos+4)*pT;return this.pos+=8,c},readFloat:function(){var c=IL(this.buf,this.pos,!0,23,4);return this.pos+=4,c},readDouble:function(){var c=IL(this.buf,this.pos,!0,52,8);return this.pos+=8,c},readVarint:function(c){var a,u,f=this.buf;return a=127&(u=f[this.pos++]),u<128?a:(a|=(127&(u=f[this.pos++]))<<7,u<128?a:(a|=(127&(u=f[this.pos++]))<<14,u<128?a:(a|=(127&(u=f[this.pos++]))<<21,u<128?a:function(g,b,E){var C,P,M=E.buf;if(C=(112&(P=M[E.pos++]))>>4,P<128||(C|=(127&(P=M[E.pos++]))<<3,P<128)||(C|=(127&(P=M[E.pos++]))<<10,P<128)||(C|=(127&(P=M[E.pos++]))<<17,P<128)||(C|=(127&(P=M[E.pos++]))<<24,P<128)||(C|=(1&(P=M[E.pos++]))<<31,P<128))return fp(g,C,b);throw new Error("Expected varint not more than 10 bytes")}(a|=(15&(u=f[this.pos]))<<28,c,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var c=this.readVarint();return c%2==1?(c+1)/-2:c/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var c=this.readVarint()+this.pos,a=this.pos;return this.pos=c,c-a>=12&&LL?function(u,f,g){return LL.decode(u.subarray(f,g))}(this.buf,a,c):function(u,f,g){for(var b="",E=f;E<g;){var C,P,M,D=u[E],N=null,V=D>239?4:D>223?3:D>191?2:1;if(E+V>g)break;V===1?D<128&&(N=D):V===2?(192&(C=u[E+1]))==128&&(N=(31&D)<<6|63&C)<=127&&(N=null):V===3?(P=u[E+2],(192&(C=u[E+1]))==128&&(192&P)==128&&((N=(15&D)<<12|(63&C)<<6|63&P)<=2047||N>=55296&&N<=57343)&&(N=null)):V===4&&(P=u[E+2],M=u[E+3],(192&(C=u[E+1]))==128&&(192&P)==128&&(192&M)==128&&((N=(15&D)<<18|(63&C)<<12|(63&P)<<6|63&M)<=65535||N>=1114112)&&(N=null)),N===null?(N=65533,V=1):N>65535&&(N-=65536,b+=String.fromCharCode(N>>>10&1023|55296),N=56320|1023&N),b+=String.fromCharCode(N),E+=V}return b}(this.buf,a,c)},readBytes:function(){var c=this.readVarint()+this.pos,a=this.buf.subarray(this.pos,c);return this.pos=c,a},readPackedVarint:function(c,a){if(this.type!==tr.Bytes)return c.push(this.readVarint(a));var u=Lc(this);for(c=c||[];this.pos<u;)c.push(this.readVarint(a));return c},readPackedSVarint:function(c){if(this.type!==tr.Bytes)return c.push(this.readSVarint());var a=Lc(this);for(c=c||[];this.pos<a;)c.push(this.readSVarint());return c},readPackedBoolean:function(c){if(this.type!==tr.Bytes)return c.push(this.readBoolean());var a=Lc(this);for(c=c||[];this.pos<a;)c.push(this.readBoolean());return c},readPackedFloat:function(c){if(this.type!==tr.Bytes)return c.push(this.readFloat());var a=Lc(this);for(c=c||[];this.pos<a;)c.push(this.readFloat());return c},readPackedDouble:function(c){if(this.type!==tr.Bytes)return c.push(this.readDouble());var a=Lc(this);for(c=c||[];this.pos<a;)c.push(this.readDouble());return c},readPackedFixed32:function(c){if(this.type!==tr.Bytes)return c.push(this.readFixed32());var a=Lc(this);for(c=c||[];this.pos<a;)c.push(this.readFixed32());return c},readPackedSFixed32:function(c){if(this.type!==tr.Bytes)return c.push(this.readSFixed32());var a=Lc(this);for(c=c||[];this.pos<a;)c.push(this.readSFixed32());return c},readPackedFixed64:function(c){if(this.type!==tr.Bytes)return c.push(this.readFixed64());var a=Lc(this);for(c=c||[];this.pos<a;)c.push(this.readFixed64());return c},readPackedSFixed64:function(c){if(this.type!==tr.Bytes)return c.push(this.readSFixed64());var a=Lc(this);for(c=c||[];this.pos<a;)c.push(this.readSFixed64());return c},skip:function(c){var a=7&c;if(a===tr.Varint)for(;this.buf[this.pos++]>127;);else if(a===tr.Bytes)this.pos=this.readVarint()+this.pos;else if(a===tr.Fixed32)this.pos+=4;else{if(a!==tr.Fixed64)throw new Error("Unimplemented type: "+a);this.pos+=8}},writeTag:function(c,a){this.writeVarint(c<<3|a)},realloc:function(c){for(var a=this.length||16;a<this.pos+c;)a*=2;if(a!==this.length){var u=new Uint8Array(a);u.set(this.buf),this.buf=u,this.length=a}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(c){this.realloc(4),pp(this.buf,c,this.pos),this.pos+=4},writeSFixed32:function(c){this.realloc(4),pp(this.buf,c,this.pos),this.pos+=4},writeFixed64:function(c){this.realloc(8),pp(this.buf,-1&c,this.pos),pp(this.buf,Math.floor(c*RL),this.pos+4),this.pos+=8},writeSFixed64:function(c){this.realloc(8),pp(this.buf,-1&c,this.pos),pp(this.buf,Math.floor(c*RL),this.pos+4),this.pos+=8},writeVarint:function(c){(c=+c||0)>268435455||c<0?function(a,u){var f,g;if(a>=0?(f=a%4294967296|0,g=a/4294967296|0):(g=~(-a/4294967296),4294967295^(f=~(-a%4294967296))?f=f+1|0:(f=0,g=g+1|0)),a>=18446744073709552e3||a<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),function(b,E,C){C.buf[C.pos++]=127&b|128,b>>>=7,C.buf[C.pos++]=127&b|128,b>>>=7,C.buf[C.pos++]=127&b|128,b>>>=7,C.buf[C.pos++]=127&b|128,C.buf[C.pos]=127&(b>>>=7)}(f,0,u),function(b,E){var C=(7&b)<<4;E.buf[E.pos++]|=C|((b>>>=3)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b)))))}(g,u)}(c,this):(this.realloc(4),this.buf[this.pos++]=127&c|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=c>>>7&127))))},writeSVarint:function(c){this.writeVarint(c<0?2*-c-1:2*c)},writeBoolean:function(c){this.writeVarint(!!c)},writeString:function(c){c=String(c),this.realloc(4*c.length),this.pos++;var a=this.pos;this.pos=function(f,g,b){for(var E,C,P=0;P<g.length;P++){if((E=g.charCodeAt(P))>55295&&E<57344){if(!C){E>56319||P+1===g.length?(f[b++]=239,f[b++]=191,f[b++]=189):C=E;continue}if(E<56320){f[b++]=239,f[b++]=191,f[b++]=189,C=E;continue}E=C-55296<<10|E-56320|65536,C=null}else C&&(f[b++]=239,f[b++]=191,f[b++]=189,C=null);E<128?f[b++]=E:(E<2048?f[b++]=E>>6|192:(E<65536?f[b++]=E>>12|224:(f[b++]=E>>18|240,f[b++]=E>>12&63|128),f[b++]=E>>6&63|128),f[b++]=63&E|128)}return b}(this.buf,c,this.pos);var u=this.pos-a;u>=128&&OL(a,u,this),this.pos=a-1,this.writeVarint(u),this.pos+=u},writeFloat:function(c){this.realloc(4),ML(this.buf,c,this.pos,!0,23,4),this.pos+=4},writeDouble:function(c){this.realloc(8),ML(this.buf,c,this.pos,!0,52,8),this.pos+=8},writeBytes:function(c){var a=c.length;this.writeVarint(a),this.realloc(a);for(var u=0;u<a;u++)this.buf[this.pos++]=c[u]},writeRawMessage:function(c,a){this.pos++;var u=this.pos;c(a,this);var f=this.pos-u;f>=128&&OL(u,f,this),this.pos=u-1,this.writeVarint(f),this.pos+=f},writeMessage:function(c,a,u){this.writeTag(c,tr.Bytes),this.writeRawMessage(a,u)},writePackedVarint:function(c,a){a.length&&this.writeMessage(c,zG,a)},writePackedSVarint:function(c,a){a.length&&this.writeMessage(c,NG,a)},writePackedBoolean:function(c,a){a.length&&this.writeMessage(c,jG,a)},writePackedFloat:function(c,a){a.length&&this.writeMessage(c,UG,a)},writePackedDouble:function(c,a){a.length&&this.writeMessage(c,VG,a)},writePackedFixed32:function(c,a){a.length&&this.writeMessage(c,$G,a)},writePackedSFixed32:function(c,a){a.length&&this.writeMessage(c,GG,a)},writePackedFixed64:function(c,a){a.length&&this.writeMessage(c,HG,a)},writePackedSFixed64:function(c,a){a.length&&this.writeMessage(c,WG,a)},writeBytesField:function(c,a){this.writeTag(c,tr.Bytes),this.writeBytes(a)},writeFixed32Field:function(c,a){this.writeTag(c,tr.Fixed32),this.writeFixed32(a)},writeSFixed32Field:function(c,a){this.writeTag(c,tr.Fixed32),this.writeSFixed32(a)},writeFixed64Field:function(c,a){this.writeTag(c,tr.Fixed64),this.writeFixed64(a)},writeSFixed64Field:function(c,a){this.writeTag(c,tr.Fixed64),this.writeSFixed64(a)},writeVarintField:function(c,a){this.writeTag(c,tr.Varint),this.writeVarint(a)},writeSVarintField:function(c,a){this.writeTag(c,tr.Varint),this.writeSVarint(a)},writeStringField:function(c,a){this.writeTag(c,tr.Bytes),this.writeString(a)},writeFloatField:function(c,a){this.writeTag(c,tr.Fixed32),this.writeFloat(a)},writeDoubleField:function(c,a){this.writeTag(c,tr.Fixed64),this.writeDouble(a)},writeBooleanField:function(c,a){this.writeVarintField(c,!!a)}};var V1=G(PL);const mT=3;function KG(c,a,u){a.glyphs=[],c===1&&u.readMessage(XG,a)}function XG(c,a,u){if(c===3){const{id:f,bitmap:g,width:b,height:E,left:C,top:P,advance:M}=u.readMessage(ZG,{});a.glyphs.push({id:f,bitmap:new Rc({width:b+2*mT,height:E+2*mT},g),metrics:{width:b,height:E,left:C,top:P,advance:M}})}else c===4?a.ascender=u.readSVarint():c===5&&(a.descender=u.readSVarint())}function ZG(c,a,u){c===1?a.id=u.readVarint():c===2?a.bitmap=u.readBytes():c===3?a.width=u.readVarint():c===4?a.height=u.readVarint():c===5?a.left=u.readSVarint():c===6?a.top=u.readSVarint():c===7&&(a.advance=u.readVarint())}const kL=mT;function gT(c){let a=0,u=0;for(const E of c)a+=E.w*E.h,u=Math.max(u,E.w);c.sort((E,C)=>C.h-E.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(a/.95)),u),h:1/0}];let g=0,b=0;for(const E of c)for(let C=f.length-1;C>=0;C--){const P=f[C];if(!(E.w>P.w||E.h>P.h)){if(E.x=P.x,E.y=P.y,b=Math.max(b,E.y+E.h),g=Math.max(g,E.x+E.w),E.w===P.w&&E.h===P.h){const M=f.pop();C<f.length&&(f[C]=M)}else E.h===P.h?(P.x+=E.w,P.w-=E.w):E.w===P.w?(P.y+=E.h,P.h-=E.h):(f.push({x:P.x+E.w,y:P.y,w:P.w-E.w,h:E.h}),P.y+=E.h,P.h-=E.h);break}}return{w:g,h:b,fill:a/(g*b)||0}}const Cs=1;class yT{constructor(a,{pixelRatio:u,version:f,stretchX:g,stretchY:b,content:E}){this.paddedRect=a,this.pixelRatio=u,this.stretchX=g,this.stretchY=b,this.content=E,this.version=f}get tl(){return[this.paddedRect.x+Cs,this.paddedRect.y+Cs]}get br(){return[this.paddedRect.x+this.paddedRect.w-Cs,this.paddedRect.y+this.paddedRect.h-Cs]}get displaySize(){return[(this.paddedRect.w-2*Cs)/this.pixelRatio,(this.paddedRect.h-2*Cs)/this.pixelRatio]}}class FL{constructor(a,u){const f={},g={};this.haveRenderCallbacks=[];const b=[];this.addImages(a,f,b),this.addImages(u,g,b);const{w:E,h:C}=gT(b),P=new Vs({width:E||1,height:C||1});for(const M in a){const D=a[M],N=f[M].paddedRect;Vs.copy(D.data,P,{x:0,y:0},{x:N.x+Cs,y:N.y+Cs},D.data)}for(const M in u){const D=u[M],N=g[M].paddedRect,V=N.x+Cs,H=N.y+Cs,W=D.data.width,Q=D.data.height;Vs.copy(D.data,P,{x:0,y:0},{x:V,y:H},D.data),Vs.copy(D.data,P,{x:0,y:Q-1},{x:V,y:H-1},{width:W,height:1}),Vs.copy(D.data,P,{x:0,y:0},{x:V,y:H+Q},{width:W,height:1}),Vs.copy(D.data,P,{x:W-1,y:0},{x:V-1,y:H},{width:1,height:Q}),Vs.copy(D.data,P,{x:0,y:0},{x:V+W,y:H},{width:1,height:Q})}this.image=P,this.iconPositions=f,this.patternPositions=g}addImages(a,u,f){for(const g in a){const b=a[g],E={x:0,y:0,w:b.data.width+2*Cs,h:b.data.height+2*Cs};f.push(E),u[g]=new yT(E,b),b.hasRenderCallback&&this.haveRenderCallbacks.push(g)}}patchUpdatedImages(a,u){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(f=>a.hasImage(f)),a.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const f in a.updatedImages)this.patchUpdatedImage(this.iconPositions[f],a.getImage(f),u),this.patchUpdatedImage(this.patternPositions[f],a.getImage(f),u)}patchUpdatedImage(a,u,f){if(!a||!u||a.version===u.version)return;a.version=u.version;const[g,b]=a.tl;f.update(u.data,void 0,{x:g,y:b})}}dn(yT,"ImagePosition"),dn(FL,"ImageAtlas");const ua={horizontal:1,vertical:2,horizontalOnly:3},BL=-17;class fy{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(a,u){const f=new fy;return f.scale=a||1,f.fontStack=u,f}static forImage(a){const u=new fy;return u.imageName=a,u}}class mp{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(a,u){const f=new mp;for(let g=0;g<a.sections.length;g++){const b=a.sections[g];b.image?f.addImageSection(b):f.addTextSection(b,u)}return f}length(){return this.text.length}getSection(a){return this.sections[this.sectionIndex[a]]}getSections(){return this.sections}getSectionIndex(a){return this.sectionIndex[a]}getCharCode(a){return this.text.charCodeAt(a)}verticalizePunctuation(a){this.text=function(u,f){let g="";for(let b=0;b<u.length;b++){const E=u.charCodeAt(b+1)||null,C=u.charCodeAt(b-1)||null;g+=!f&&(E&&g1(E)&&!dy[u[b+1]]||C&&g1(C)&&!dy[u[b-1]])||!dy[u[b]]?u[b]:dy[u[b]]}return g}(this.text,a)}trim(){let a=0;for(let f=0;f<this.text.length&&j1[this.text.charCodeAt(f)];f++)a++;let u=this.text.length;for(let f=this.text.length-1;f>=0&&f>=a&&j1[this.text.charCodeAt(f)];f--)u--;this.text=this.text.substring(a,u),this.sectionIndex=this.sectionIndex.slice(a,u)}substring(a,u){const f=new mp;return f.text=this.text.substring(a,u),f.sectionIndex=this.sectionIndex.slice(a,u),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((a,u)=>Math.max(a,this.sections[u].scale),0)}addTextSection(a,u){this.text+=a.text,this.sections.push(fy.forText(a.scale,a.fontStack||u));const f=this.sections.length-1;for(let g=0;g<a.text.length;++g)this.sectionIndex.push(f)}addImageSection(a){const u=a.image?a.image.name:"";if(u.length===0)return void tt("Can't add FormattedSection with an empty image.");const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCharCode(f),this.sections.push(fy.forImage(u)),this.sectionIndex.push(this.sections.length-1)):tt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function vT(c,a,u,f,g,b,E,C,P,M,D,N,V,H,W){const Q=mp.fromFeature(c,g);N===ua.vertical&&Q.verticalizePunctuation(V);let oe=[];const xe=function(De,lt,it,_t,Vt,ft){if(!De)return[];const St=[],Ct=function(rn,yn,sn,oi,Zt,Rn){let si=0;for(let Ii=0;Ii<rn.length();Ii++){const ai=rn.getSection(Ii);si+=zL(rn.getCharCode(Ii),ai,oi,Zt,yn,Rn)}return si/Math.max(1,Math.ceil(si/sn))}(De,lt,it,_t,Vt,ft),Dt=De.text.indexOf("​")>=0;let Kt=0;for(let rn=0;rn<De.length();rn++){const yn=De.getSection(rn),sn=De.getCharCode(rn);if(j1[sn]||(Kt+=zL(sn,yn,_t,Vt,lt,ft)),rn<De.length()-1){const oi=!((vt=sn)<11904||!(an["Bopomofo Extended"](vt)||an.Bopomofo(vt)||an["CJK Compatibility Forms"](vt)||an["CJK Compatibility Ideographs"](vt)||an["CJK Compatibility"](vt)||an["CJK Radicals Supplement"](vt)||an["CJK Strokes"](vt)||an["CJK Symbols and Punctuation"](vt)||an["CJK Unified Ideographs Extension A"](vt)||an["CJK Unified Ideographs"](vt)||an["Enclosed CJK Letters and Months"](vt)||an["Halfwidth and Fullwidth Forms"](vt)||an.Hiragana(vt)||an["Ideographic Description Characters"](vt)||an["Kangxi Radicals"](vt)||an["Katakana Phonetic Extensions"](vt)||an.Katakana(vt)||an["Vertical Forms"](vt)||an["Yi Radicals"](vt)||an["Yi Syllables"](vt)));(qG[sn]||oi||yn.imageName)&&St.push(UL(rn+1,Kt,Ct,St,YG(sn,De.getCharCode(rn+1),oi&&Dt),!1))}}var vt;return VL(UL(De.length(),Kt,Ct,St,0,!0))}(Q,M,b,a,f,H),{processBidirectionalText:Me,processStyledBidirectionalText:we}=O;if(Me&&Q.sections.length===1){const De=Me(Q.toString(),xe);for(const lt of De){const it=new mp;it.text=lt,it.sections=Q.sections;for(let _t=0;_t<lt.length;_t++)it.sectionIndex.push(0);oe.push(it)}}else if(we){const De=we(Q.text,Q.sectionIndex,xe);for(const lt of De){const it=new mp;it.text=lt[0],it.sectionIndex=lt[1],it.sections=Q.sections,oe.push(it)}}else oe=function(De,lt){const it=[],_t=De.text;let Vt=0;for(const ft of lt)it.push(De.substring(Vt,ft)),Vt=ft;return Vt<_t.length&&it.push(De.substring(Vt,_t.length)),it}(Q,xe);const Ie=[],Fe={positionedLines:Ie,text:Q.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:N,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(De,lt,it,_t,Vt,ft,St,Ct,Dt,Kt,vt,rn){let yn=0,sn=0,oi=0;const Zt=Ct==="right"?1:Ct==="left"?0:.5;let Rn=!1;for(const hi of Vt){const di=hi.getSections();for(const qi of di){if(qi.imageName)continue;const nr=lt[qi.fontStack];if(nr&&(Rn=nr.ascender!==void 0&&nr.descender!==void 0,!Rn))break}if(!Rn)break}let si=0;for(const hi of Vt){hi.trim();const di=hi.getMaxScale(),qi=(di-1)*Lo,nr={positionedGlyphs:[],lineOffset:0};De.positionedLines[si]=nr;const ir=nr.positionedGlyphs;let Yi=0;if(!hi.length()){sn+=ft,++si;continue}let Tr=0,Lr=0;for(let Ji=0;Ji<hi.length();Ji++){const oo=hi.getSection(Ji),Jr=hi.getSectionIndex(Ji),Pr=hi.getCharCode(Ji);let Di=oo.scale,Qr=null,rr=null,as=null,eo=Lo,Oo=0;const To=!(Dt===ua.horizontal||!vt&&!Ug(Pr)||vt&&(j1[Pr]||(Ii=Pr,an.Arabic(Ii)||an["Arabic Supplement"](Ii)||an["Arabic Extended-A"](Ii)||an["Arabic Presentation Forms-A"](Ii)||an["Arabic Presentation Forms-B"](Ii))));if(oo.imageName){const ls=_t[oo.imageName];if(!ls)continue;as=oo.imageName,De.iconsInText=De.iconsInText||!0,rr=ls.paddedRect;const So=ls.displaySize;Di=Di*Lo/rn,Qr={width:So[0],height:So[1],left:Cs,top:-kL,advance:To?So[1]:So[0],localGlyph:!1},Oo=Rn?-Qr.height*Di:BL+di*Lo-So[1]*Di,eo=Qr.advance;const dl=(To?So[0]:So[1])*Di-Lo*di;dl>0&&dl>Yi&&(Yi=dl)}else{const ls=it[oo.fontStack];if(!ls)continue;ls[Pr]&&(rr=ls[Pr]);const So=lt[oo.fontStack];if(!So)continue;const dl=So.glyphs[Pr];if(!dl)continue;if(Qr=dl.metrics,eo=Pr!==8203?Lo:0,Rn){const wp=So.ascender!==void 0?Math.abs(So.ascender):0,Ey=So.descender!==void 0?Math.abs(So.descender):0,Ty=(wp+Ey)*Di;Tr<Ty&&(Tr=Ty,Lr=(wp-Ey)/2*Di),Oo=-wp*Di}else Oo=BL+(di-Di)*Lo}To?(De.verticalizable=!0,ir.push({glyph:Pr,imageName:as,x:yn,y:sn+Oo,vertical:To,scale:Di,localGlyph:Qr.localGlyph,fontStack:oo.fontStack,sectionIndex:Jr,metrics:Qr,rect:rr}),yn+=eo*Di+Kt):(ir.push({glyph:Pr,imageName:as,x:yn,y:sn+Oo,vertical:To,scale:Di,localGlyph:Qr.localGlyph,fontStack:oo.fontStack,sectionIndex:Jr,metrics:Qr,rect:rr}),yn+=Qr.advance*Di+Kt)}ir.length!==0&&(oi=Math.max(yn-Kt,oi),Rn?jL(ir,Zt,Yi,Lr,ft*di/2):jL(ir,Zt,Yi,0,ft/2)),yn=0;const Yr=ft*di+Yi;nr.lineOffset=Math.max(Yi,qi),sn+=Yr,++si}var Ii;const ai=sn,{horizontalAlign:Nn,verticalAlign:ar}=_T(St);(function(hi,di,qi,nr,ir,Yi){const Tr=(di-qi)*ir,Lr=-Yi*nr;for(const Yr of hi)for(const Ji of Yr.positionedGlyphs)Ji.x+=Tr,Ji.y+=Lr})(De.positionedLines,Zt,Nn,ar,oi,ai),De.top+=-ar*ai,De.bottom=De.top+ai,De.left+=-Nn*oi,De.right=De.left+oi,De.hasBaseline=Rn}(Fe,a,u,f,oe,E,C,P,N,M,V,W),!function(De){for(const lt of De)if(lt.positionedGlyphs.length!==0)return!1;return!0}(Ie)&&Fe}const j1={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},qG={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function zL(c,a,u,f,g,b){if(a.imageName){const E=f[a.imageName];return E?E.displaySize[0]*a.scale*Lo/b+g:0}{const E=u[a.fontStack],C=E&&E.glyphs[c];return C?C.metrics.advance*a.scale+g:0}}function NL(c,a,u,f){const g=Math.pow(c-a,2);return f?c<a?g/2:2*g:g+Math.abs(u)*u}function YG(c,a,u){let f=0;return c===10&&(f-=1e4),u&&(f+=150),c!==40&&c!==65288||(f+=50),a!==41&&a!==65289||(f+=50),f}function UL(c,a,u,f,g,b){let E=null,C=NL(a,u,g,b);for(const P of f){const M=NL(a-P.x,u,g,b)+P.badness;M<=C&&(E=P,C=M)}return{index:c,x:a,priorBreak:E,badness:C}}function VL(c){return c?VL(c.priorBreak).concat(c.index):[]}function _T(c){let a=.5,u=.5;switch(c){case"right":case"top-right":case"bottom-right":a=1;break;case"left":case"top-left":case"bottom-left":a=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:a,verticalAlign:u}}function jL(c,a,u,f,g){if(!(a||u||f||g))return;const b=c.length-1,E=c[b],C=(E.x+E.metrics.advance*E.scale)*a;for(let P=0;P<=b;P++)c[P].x-=C,c[P].y+=u+f+g}function JG(c,a,u){const{horizontalAlign:f,verticalAlign:g}=_T(u),b=a[0]-c.displaySize[0]*f,E=a[1]-c.displaySize[1]*g;return{image:c,top:E,bottom:E+c.displaySize[1],left:b,right:b+c.displaySize[0]}}function $L(c,a,u,f,g,b){const E=c.image;let C;if(E.content){const oe=E.content,xe=E.pixelRatio||1;C=[oe[0]/xe,oe[1]/xe,E.displaySize[0]-oe[2]/xe,E.displaySize[1]-oe[3]/xe]}const P=a.left*b,M=a.right*b;let D,N,V,H;u==="width"||u==="both"?(H=g[0]+P-f[3],N=g[0]+M+f[1]):(H=g[0]+(P+M-E.displaySize[0])/2,N=H+E.displaySize[0]);const W=a.top*b,Q=a.bottom*b;return u==="height"||u==="both"?(D=g[1]+W-f[0],V=g[1]+Q+f[2]):(D=g[1]+(W+Q-E.displaySize[1])/2,V=D+E.displaySize[1]),{image:E,top:D,right:N,bottom:V,left:H,collisionPadding:C}}class Oc extends J{constructor(a,u,f,g,b){super(a,u),this.angle=g,this.z=f,b!==void 0&&(this.segment=b)}clone(){return new Oc(this.x,this.y,this.z,this.angle,this.segment)}}function GL(c,a,u,f,g){if(a.segment===void 0)return!0;let b=a,E=a.segment+1,C=0;for(;C>-u/2;){if(E--,E<0)return!1;C-=c[E].dist(b),b=c[E]}C+=c[E].dist(c[E+1]),E++;const P=[];let M=0;for(;C<u/2;){const D=c[E],N=c[E+1];if(!N)return!1;let V=c[E-1].angleTo(D)-D.angleTo(N);for(V=Math.abs((V+3*Math.PI)%(2*Math.PI)-Math.PI),P.push({distance:C,angleDelta:V}),M+=V;C-P[0].distance>f;)M-=P.shift().angleDelta;if(M>g)return!1;E++,C+=D.dist(N)}return!0}function HL(c){let a=0;for(let u=0;u<c.length-1;u++)a+=c[u].dist(c[u+1]);return a}function WL(c,a,u){return c?.6*a*u:0}function KL(c,a){return Math.max(c?c.right-c.left:0,a?a.right-a.left:0)}function QG(c,a,u,f,g,b){const E=WL(u,g,b),C=KL(u,f)*b;let P=0;const M=HL(c)/2;for(let D=0;D<c.length-1;D++){const N=c[D],V=c[D+1],H=N.dist(V);if(P+H>M){const W=(M-P)/H,Q=Ci(N.x,V.x,W),oe=Ci(N.y,V.y,W),xe=new Oc(Q,oe,0,V.angleTo(N),D);return!E||GL(c,xe,C,E,a)?xe:void 0}P+=H}}function eH(c,a,u,f,g,b,E,C,P){const M=WL(f,b,E),D=KL(f,g),N=D*E,V=c[0].x===0||c[0].x===P||c[0].y===0||c[0].y===P;return a-N<a/4&&(a=N+a/4),XL(c,V?a/2*C%a:(D/2+2*b)*E*C%a,a,M,u,N,V,!1,P)}function XL(c,a,u,f,g,b,E,C,P){const M=b/2,D=HL(c);let N=0,V=a-u,H=[];for(let W=0;W<c.length-1;W++){const Q=c[W],oe=c[W+1],xe=Q.dist(oe),Me=oe.angleTo(Q);for(;V+u<N+xe;){V+=u;const we=(V-N)/xe,Ie=Ci(Q.x,oe.x,we),Fe=Ci(Q.y,oe.y,we);if(Ie>=0&&Ie<P&&Fe>=0&&Fe<P&&V-M>=0&&V+M<=D){const De=new Oc(Ie,Fe,0,Me,W);De._round(),f&&!GL(c,De,b,f,g)||H.push(De)}}N+=xe}return C||H.length||E||(H=XL(c,N/2,u,f,g,b,E,!0,P)),H}function ZL(c,a,u,f,g){const b=[];for(let E=0;E<c.length;E++){const C=c[E];let P;for(let M=0;M<C.length-1;M++){let D=C[M],N=C[M+1];D.x<a&&N.x<a||(D.x<a?D=new J(a,D.y+(a-D.x)/(N.x-D.x)*(N.y-D.y))._round():N.x<a&&(N=new J(a,D.y+(a-D.x)/(N.x-D.x)*(N.y-D.y))._round()),D.y<u&&N.y<u||(D.y<u?D=new J(D.x+(u-D.y)/(N.y-D.y)*(N.x-D.x),u)._round():N.y<u&&(N=new J(D.x+(u-D.y)/(N.y-D.y)*(N.x-D.x),u)._round()),D.x>=f&&N.x>=f||(D.x>=f?D=new J(f,D.y+(f-D.x)/(N.x-D.x)*(N.y-D.y))._round():N.x>=f&&(N=new J(f,D.y+(f-D.x)/(N.x-D.x)*(N.y-D.y))._round()),D.y>=g&&N.y>=g||(D.y>=g?D=new J(D.x+(g-D.y)/(N.y-D.y)*(N.x-D.x),g)._round():N.y>=g&&(N=new J(D.x+(g-D.y)/(N.y-D.y)*(N.x-D.x),g)._round()),P&&D.equals(P[P.length-1])||(P=[D],b.push(P)),P.push(N)))))}}return b}dn(Oc,"Anchor");const py=1e20;function qL(c,a,u,f,g,b,E,C,P){for(let M=a;M<a+f;M++)YL(c,u*b+M,b,g,E,C,P);for(let M=u;M<u+g;M++)YL(c,M*b+a,1,f,E,C,P)}function YL(c,a,u,f,g,b,E){b[0]=0,E[0]=-py,E[1]=py,g[0]=c[a];for(let C=1,P=0,M=0;C<f;C++){g[C]=c[a+C*u];const D=C*C;do{const N=b[P];M=(g[C]-g[N]+D-N*N)/(C-N)/2}while(M<=E[P]&&--P>-1);P++,b[P]=C,E[P]=M,E[P+1]=py}for(let C=0,P=0;C<f;C++){for(;E[P+1]<C;)P++;const M=b[P],D=C-M;c[a+C*u]=g[M]+D*D}}const ul=2,bT={none:0,ideographs:1,all:2};class gp{constructor(a,u,f){this.requestManager=a,this.localGlyphMode=u,this.localFontFamily=f,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(a){this.url=a}getGlyphs(a,u){const f=[];for(const g in a)for(const b of a[g])f.push({stack:g,id:b});pn(f,({stack:g,id:b},E)=>{let C=this.entries[g];C||(C=this.entries[g]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let P=C.glyphs[b];if(P!==void 0)return void E(null,{stack:g,id:b,glyph:P});if(P=this._tinySDF(C,g,b),P)return C.glyphs[b]=P,void E(null,{stack:g,id:b,glyph:P});const M=Math.floor(b/256);if(256*M>65535)return void E(new Error("glyphs > 65535 not supported"));if(C.ranges[M])return void E(null,{stack:g,id:b,glyph:P});let D=C.requests[M];D||(D=C.requests[M]=[],gp.loadGlyphRange(g,M,this.url,this.requestManager,(N,V)=>{if(V){C.ascender=V.ascender,C.descender=V.descender;for(const H in V.glyphs)this._doesCharSupportLocalGlyph(+H)||(C.glyphs[+H]=V.glyphs[+H]);C.ranges[M]=!0}for(const H of D)H(N,V);delete C.requests[M]})),D.push((N,V)=>{N?E(N):V&&E(null,{stack:g,id:b,glyph:V.glyphs[b]||null})})},(g,b)=>{if(g)u(g);else if(b){const E={};for(const{stack:C,id:P,glyph:M}of b)E[C]===void 0&&(E[C]={}),E[C].glyphs===void 0&&(E[C].glyphs={}),E[C].glyphs[P]=M&&{id:M.id,bitmap:M.bitmap.clone(),metrics:M.metrics},E[C].ascender=this.entries[C].ascender,E[C].descender=this.entries[C].descender;u(null,E)}})}_doesCharSupportLocalGlyph(a){return this.localGlyphMode!==bT.none&&(this.localGlyphMode===bT.all?!!this.localFontFamily:!!this.localFontFamily&&(an["CJK Unified Ideographs"](a)||an["Hangul Syllables"](a)||an.Hiragana(a)||an.Katakana(a)||an["CJK Symbols and Punctuation"](a)))}_tinySDF(a,u,f){const g=this.localFontFamily;if(!g||!this._doesCharSupportLocalGlyph(f))return;let b=a.tinySDF;if(!b){let Q="400";/bold/i.test(u)?Q="900":/medium/i.test(u)?Q="500":/light/i.test(u)&&(Q="200"),b=a.tinySDF=new gp.TinySDF({fontFamily:g,fontWeight:Q,fontSize:24*ul,buffer:3*ul,radius:8*ul}),b.fontWeight=Q}if(this.localGlyphs[b.fontWeight][f])return this.localGlyphs[b.fontWeight][f];const E=String.fromCharCode(f),{data:C,width:P,height:M,glyphWidth:D,glyphHeight:N,glyphLeft:V,glyphTop:H,glyphAdvance:W}=b.draw(E);return this.localGlyphs[b.fontWeight][f]={id:f,bitmap:new Rc({width:P,height:M},C),metrics:{width:D/ul,height:N/ul,left:V/ul,top:H/ul-27,advance:W/ul,localGlyph:!0}}}}gp.loadGlyphRange=function(c,a,u,f,g){const b=256*a,E=b+255,C=f.transformRequest(f.normalizeGlyphsURL(u).replace("{fontstack}",c).replace("{range}",`${b}-${E}`),mt.Glyphs);Hn(C,(P,M)=>{if(P)g(P);else if(M){const D={},N=function(V){return new V1(V).readFields(KG,{})}(M);for(const V of N.glyphs)D[V.id]=V;g(null,{glyphs:D,ascender:N.ascender,descender:N.descender})}})},gp.TinySDF=class{constructor({fontSize:c=24,buffer:a=3,radius:u=8,cutoff:f=.25,fontFamily:g="sans-serif",fontWeight:b="normal",fontStyle:E="normal"}={}){this.buffer=a,this.cutoff=f,this.radius=u;const C=this.size=c+4*a,P=this._createCanvas(C),M=this.ctx=P.getContext("2d",{willReadFrequently:!0});M.font=`${E} ${b} ${c}px ${g}`,M.textBaseline="alphabetic",M.textAlign="left",M.fillStyle="black",this.gridOuter=new Float64Array(C*C),this.gridInner=new Float64Array(C*C),this.f=new Float64Array(C),this.z=new Float64Array(C+1),this.v=new Uint16Array(C)}_createCanvas(c){const a=document.createElement("canvas");return a.width=a.height=c,a}draw(c){const{width:a,actualBoundingBoxAscent:u,actualBoundingBoxDescent:f,actualBoundingBoxLeft:g,actualBoundingBoxRight:b}=this.ctx.measureText(c),E=Math.ceil(u),C=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(b-g))),P=Math.min(this.size-this.buffer,E+Math.ceil(f)),M=C+2*this.buffer,D=P+2*this.buffer,N=Math.max(M*D,0),V=new Uint8ClampedArray(N),H={data:V,width:M,height:D,glyphWidth:C,glyphHeight:P,glyphTop:E,glyphLeft:0,glyphAdvance:a};if(C===0||P===0)return H;const{ctx:W,buffer:Q,gridInner:oe,gridOuter:xe}=this;W.clearRect(Q,Q,C,P),W.fillText(c,Q,Q+E);const Me=W.getImageData(Q,Q,C,P);xe.fill(py,0,N),oe.fill(0,0,N);for(let we=0;we<P;we++)for(let Ie=0;Ie<C;Ie++){const Fe=Me.data[4*(we*C+Ie)+3]/255;if(Fe===0)continue;const De=(we+Q)*M+Ie+Q;if(Fe===1)xe[De]=0,oe[De]=py;else{const lt=.5-Fe;xe[De]=lt>0?lt*lt:0,oe[De]=lt<0?lt*lt:0}}qL(xe,0,0,M,D,M,this.f,this.v,this.z),qL(oe,Q,Q,C,P,M,this.f,this.v,this.z);for(let we=0;we<N;we++){const Ie=Math.sqrt(xe[we])-Math.sqrt(oe[we]);V[we]=Math.round(255-255*(Ie/this.radius+this.cutoff))}return H}};const yp=Cs;function JL(c,a,u,f){const g=[],b=c.image,E=b.pixelRatio,C=b.paddedRect.w-2*yp,P=b.paddedRect.h-2*yp,M=c.right-c.left,D=c.bottom-c.top,N=b.stretchX||[[0,C]],V=b.stretchY||[[0,P]],H=(ft,St)=>ft+St[1]-St[0],W=N.reduce(H,0),Q=V.reduce(H,0),oe=C-W,xe=P-Q;let Me=0,we=W,Ie=0,Fe=Q,De=0,lt=oe,it=0,_t=xe;if(b.content&&f){const ft=b.content;Me=$1(N,0,ft[0]),Ie=$1(V,0,ft[1]),we=$1(N,ft[0],ft[2]),Fe=$1(V,ft[1],ft[3]),De=ft[0]-Me,it=ft[1]-Ie,lt=ft[2]-ft[0]-we,_t=ft[3]-ft[1]-Fe}const Vt=(ft,St,Ct,Dt)=>{const Kt=G1(ft.stretch-Me,we,M,c.left),vt=H1(ft.fixed-De,lt,ft.stretch,W),rn=G1(St.stretch-Ie,Fe,D,c.top),yn=H1(St.fixed-it,_t,St.stretch,Q),sn=G1(Ct.stretch-Me,we,M,c.left),oi=H1(Ct.fixed-De,lt,Ct.stretch,W),Zt=G1(Dt.stretch-Ie,Fe,D,c.top),Rn=H1(Dt.fixed-it,_t,Dt.stretch,Q),si=new J(Kt,rn),Ii=new J(sn,rn),ai=new J(sn,Zt),Nn=new J(Kt,Zt),ar=new J(vt/E,yn/E),hi=new J(oi/E,Rn/E),di=a*Math.PI/180;if(di){const ir=Math.sin(di),Yi=Math.cos(di),Tr=[Yi,-ir,ir,Yi];si._matMult(Tr),Ii._matMult(Tr),Nn._matMult(Tr),ai._matMult(Tr)}const qi=ft.stretch+ft.fixed,nr=St.stretch+St.fixed;return{tl:si,tr:Ii,bl:Nn,br:ai,tex:{x:b.paddedRect.x+yp+qi,y:b.paddedRect.y+yp+nr,w:Ct.stretch+Ct.fixed-qi,h:Dt.stretch+Dt.fixed-nr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ar,pixelOffsetBR:hi,minFontScaleX:lt/E/M,minFontScaleY:_t/E/D,isSDF:u}};if(f&&(b.stretchX||b.stretchY)){const ft=QL(N,oe,W),St=QL(V,xe,Q);for(let Ct=0;Ct<ft.length-1;Ct++){const Dt=ft[Ct],Kt=ft[Ct+1];for(let vt=0;vt<St.length-1;vt++)g.push(Vt(Dt,St[vt],Kt,St[vt+1]))}}else g.push(Vt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:C+1},{fixed:0,stretch:P+1}));return g}function $1(c,a,u){let f=0;for(const g of c)f+=Math.max(a,Math.min(u,g[1]))-Math.max(a,Math.min(u,g[0]));return f}function QL(c,a,u){const f=[{fixed:-yp,stretch:0}];for(const[g,b]of c){const E=f[f.length-1];f.push({fixed:g-E.stretch,stretch:E.stretch}),f.push({fixed:g-E.stretch,stretch:E.stretch+(b-g)})}return f.push({fixed:a+yp,stretch:u}),f}function G1(c,a,u,f){return c/a*u+f}function H1(c,a,u,f){return c-a*u/f}function tH(c,a,u,f){const g=a+c.positionedLines[f].lineOffset;return f===0?u+g/2:u+(g+(a+c.positionedLines[f-1].lineOffset))/2}class nH{constructor(a=[],u=iH){if(this.data=a,this.length=this.data.length,this.compare=u,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(a){this.data.push(a),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const a=this.data[0],u=this.data.pop();return this.length--,this.length>0&&(this.data[0]=u,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:u,compare:f}=this,g=u[a];for(;a>0;){const b=a-1>>1,E=u[b];if(f(g,E)>=0)break;u[a]=E,a=b}u[a]=g}_down(a){const{data:u,compare:f}=this,g=this.length>>1,b=u[a];for(;a<g;){let E=1+(a<<1),C=u[E];const P=E+1;if(P<this.length&&f(u[P],C)<0&&(E=P,C=u[P]),f(C,b)>=0)break;u[a]=C,a=E}u[a]=b}}function iH(c,a){return c<a?-1:c>a?1:0}function rH(c,a=1,u=!1){let f=1/0,g=1/0,b=-1/0,E=-1/0;const C=c[0];for(let H=0;H<C.length;H++){const W=C[H];(!H||W.x<f)&&(f=W.x),(!H||W.y<g)&&(g=W.y),(!H||W.x>b)&&(b=W.x),(!H||W.y>E)&&(E=W.y)}const P=Math.min(b-f,E-g);let M=P/2;const D=new nH([],oH);if(P===0)return new J(f,g);for(let H=f;H<b;H+=P)for(let W=g;W<E;W+=P)D.push(new vp(H+M,W+M,M,c));let N=function(H){let W=0,Q=0,oe=0;const xe=H[0];for(let Me=0,we=xe.length,Ie=we-1;Me<we;Ie=Me++){const Fe=xe[Me],De=xe[Ie],lt=Fe.x*De.y-De.x*Fe.y;Q+=(Fe.x+De.x)*lt,oe+=(Fe.y+De.y)*lt,W+=3*lt}return new vp(Q/W,oe/W,0,H)}(c),V=D.length;for(;D.length;){const H=D.pop();(H.d>N.d||!N.d)&&(N=H,u&&console.log("found best %d after %d probes",Math.round(1e4*H.d)/1e4,V)),H.max-N.d<=a||(M=H.h/2,D.push(new vp(H.p.x-M,H.p.y-M,M,c)),D.push(new vp(H.p.x+M,H.p.y-M,M,c)),D.push(new vp(H.p.x-M,H.p.y+M,M,c)),D.push(new vp(H.p.x+M,H.p.y+M,M,c)),V+=4)}return u&&(console.log(`num probes: ${V}`),console.log(`best distance: ${N.d}`)),N.p}function oH(c,a){return a.max-c.max}class vp{constructor(a,u,f,g){this.p=new J(a,u),this.h=f,this.d=function(b,E){let C=!1,P=1/0;for(let M=0;M<E.length;M++){const D=E[M];for(let N=0,V=D.length,H=V-1;N<V;H=N++){const W=D[N],Q=D[H];W.y>b.y!=Q.y>b.y&&b.x<(Q.x-W.x)*(b.y-W.y)/(Q.y-W.y)+W.x&&(C=!C),P=Math.min(P,XR(b,W,Q))}}return(C?1:-1)*Math.sqrt(P)}(this.p,g),this.max=this.d+this.h*Math.SQRT2}}const _p=7,xT=Number.POSITIVE_INFINITY,sH=Math.sqrt(2);function eO(c,[a,u]){let f=0,g=0;if(u===xT){a<0&&(a=0);const b=a/sH;switch(c){case"top-right":case"top-left":g=b-_p;break;case"bottom-right":case"bottom-left":g=-b+_p;break;case"bottom":g=-a+_p;break;case"top":g=a-_p}switch(c){case"top-right":case"bottom-right":f=-b;break;case"top-left":case"bottom-left":f=b;break;case"left":f=a;break;case"right":f=-a}}else{switch(a=Math.abs(a),u=Math.abs(u),c){case"top-right":case"top-left":case"top":g=u-_p;break;case"bottom-right":case"bottom-left":case"bottom":g=-u+_p}switch(c){case"top-right":case"bottom-right":case"right":f=-a;break;case"top-left":case"bottom-left":case"left":f=a}}return[f,g]}function aH(c,a,u,f,g,b,E,C,P,M){c.createArrays(),c.tilePixelRatio=On/(512*c.overscaling),c.compareText={},c.iconsNeedLinear=!1;const D=c.layers[0].layout,N=c.layers[0]._unevaluatedLayout._values,V={};if(c.textSizeData.kind==="composite"){const{minZoom:Q,maxZoom:oe}=c.textSizeData;V.compositeTextSizes=[N["text-size"].possiblyEvaluate(new z(Q),C),N["text-size"].possiblyEvaluate(new z(oe),C)]}if(c.iconSizeData.kind==="composite"){const{minZoom:Q,maxZoom:oe}=c.iconSizeData;V.compositeIconSizes=[N["icon-size"].possiblyEvaluate(new z(Q),C),N["icon-size"].possiblyEvaluate(new z(oe),C)]}V.layoutTextSize=N["text-size"].possiblyEvaluate(new z(P+1),C),V.layoutIconSize=N["icon-size"].possiblyEvaluate(new z(P+1),C),V.textMaxSize=N["text-size"].possiblyEvaluate(new z(18),C);const H=D.get("text-rotation-alignment")==="map"&&D.get("symbol-placement")!=="point",W=D.get("text-size");for(const Q of c.features){const oe=D.get("text-font").evaluate(Q,{},C).join(","),xe=W.evaluate(Q,{},C),Me=V.layoutTextSize.evaluate(Q,{},C),we=(V.layoutIconSize.evaluate(Q,{},C),{horizontal:{},vertical:void 0}),Ie=Q.text;let Fe,De=[0,0];if(Ie){const _t=Ie.toString(),Vt=D.get("text-letter-spacing").evaluate(Q,{},C)*Lo,ft=D.get("text-line-height").evaluate(Q,{},C)*Lo,St=ME(_t)?Vt:0,Ct=D.get("text-anchor").evaluate(Q,{},C),Dt=D.get("text-variable-anchor");if(!Dt){const sn=D.get("text-radial-offset").evaluate(Q,{},C);De=sn?eO(Ct,[sn*Lo,xT]):D.get("text-offset").evaluate(Q,{},C).map(oi=>oi*Lo)}let Kt=H?"center":D.get("text-justify").evaluate(Q,{},C);const vt=D.get("symbol-placement")==="point",rn=vt?D.get("text-max-width").evaluate(Q,{},C)*Lo:1/0,yn=sn=>{c.allowVerticalPlacement&&Ng(_t)&&(we.vertical=vT(Ie,a,u,g,oe,rn,ft,Ct,sn,St,De,ua.vertical,!0,Me,xe))};if(!H&&Dt){const sn=Kt==="auto"?Dt.map(Zt=>wT(Zt)):[Kt];let oi=!1;for(let Zt=0;Zt<sn.length;Zt++){const Rn=sn[Zt];if(!we.horizontal[Rn])if(oi)we.horizontal[Rn]=we.horizontal[0];else{const si=vT(Ie,a,u,g,oe,rn,ft,"center",Rn,St,De,ua.horizontal,!1,Me,xe);si&&(we.horizontal[Rn]=si,oi=si.positionedLines.length===1)}}yn("left")}else{if(Kt==="auto"&&(Kt=wT(Ct)),vt||D.get("text-writing-mode").indexOf("horizontal")>=0||!Ng(_t)){const sn=vT(Ie,a,u,g,oe,rn,ft,Ct,Kt,St,De,ua.horizontal,!1,Me,xe);sn&&(we.horizontal[Kt]=sn)}yn(vt?"left":Kt)}}let lt=!1;if(Q.icon&&Q.icon.name){const _t=f[Q.icon.name];_t&&(Fe=JG(g[Q.icon.name],D.get("icon-offset").evaluate(Q,{},C),D.get("icon-anchor").evaluate(Q,{},C)),lt=_t.sdf,c.sdfIcons===void 0?c.sdfIcons=_t.sdf:c.sdfIcons!==_t.sdf&&tt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(_t.pixelRatio!==c.pixelRatio||D.get("icon-rotate").constantOr(1)!==0)&&(c.iconsNeedLinear=!0))}const it=nO(we.horizontal)||we.vertical;c.iconsInText||(c.iconsInText=!!it&&it.iconsInText),(it||Fe)&&lH(c,Q,we,Fe,f,V,Me,0,De,lt,E,C,M)}b&&c.generateCollisionDebugBuffers(P,c.collisionBoxArray)}function wT(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function lH(c,a,u,f,g,b,E,C,P,M,D,N,V){let H=b.textMaxSize.evaluate(a,{},N);H===void 0&&(H=E);const W=c.layers[0].layout,Q=W.get("icon-offset").evaluate(a,{},N),oe=nO(u.horizontal)||u.vertical,xe=V.name==="globe",Me=Lo,we=E/Me,Ie=c.tilePixelRatio*H/Me,Fe=(Ct=c.overscaling,c.zoom>18&&Ct>2&&(Ct>>=1),Math.max(On/(512*Ct),1)*W.get("symbol-spacing")),De=W.get("text-padding")*c.tilePixelRatio,lt=W.get("icon-padding")*c.tilePixelRatio,it=be(W.get("text-max-angle")),_t=W.get("text-rotation-alignment")==="map"&&W.get("symbol-placement")!=="point",Vt=W.get("icon-rotation-alignment")==="map"&&W.get("symbol-placement")!=="point",ft=W.get("symbol-placement"),St=Fe/2;var Ct;const Dt=W.get("icon-text-fit");let Kt;f&&Dt!=="none"&&(c.allowVerticalPlacement&&u.vertical&&(Kt=$L(f,u.vertical,Dt,W.get("icon-text-fit-padding"),Q,we)),oe&&(f=$L(f,oe,Dt,W.get("icon-text-fit-padding"),Q,we)));const vt=(rn,yn,sn)=>{if(yn.x<0||yn.x>=On||yn.y<0||yn.y>=On)return;let oi=null;if(xe){const{x:Zt,y:Rn,z:si}=V.projectTilePoint(yn.x,yn.y,sn);oi={anchor:new Oc(Zt,Rn,si,0,void 0),up:V.upVector(sn,yn.x,yn.y)}}(function(Zt,Rn,si,Ii,ai,Nn,ar,hi,di,qi,nr,ir,Yi,Tr,Lr,Yr,Ji,oo,Jr,Pr,Di,Qr,rr,as,eo){const Oo=Zt.addToLineVertexArray(Rn,Ii);let To,ls,So,dl,wp,Ey,Ty,kO=0,FO=0,BO=0,zO=0,BT=-1,zT=-1;const Gl={};let NO=OE("");const wd=si?si.anchor:Rn;let NT=0,UT=0;if(di._unevaluatedLayout.getValue("text-radial-offset")===void 0?[NT,UT]=di.layout.get("text-offset").evaluate(Di,{},eo).map(js=>js*Lo):(NT=di.layout.get("text-radial-offset").evaluate(Di,{},eo)*Lo,UT=xT),Zt.allowVerticalPlacement&&ai.vertical){const js=ai.vertical;if(Lr)Ey=ET(js),hi&&(Ty=ET(hi));else{const $s=di.layout.get("text-rotate").evaluate(Di,{},eo)+90;So=W1(qi,wd,Rn,nr,ir,Yi,js,Tr,$s,Yr),hi&&(dl=W1(qi,wd,Rn,nr,ir,Yi,hi,oo,$s))}}if(Nn){const js=di.layout.get("icon-rotate").evaluate(Di,{},eo),$s=di.layout.get("icon-text-fit")!=="none",Sy=JL(Nn,js,rr,$s),jT=hi?JL(hi,js,rr,$s):void 0;ls=W1(qi,wd,Rn,nr,ir,Yi,Nn,oo,js),kO=4*Sy.length;const UO=Zt.iconSizeData;let Ed=null;UO.kind==="source"?(Ed=[cl*di.layout.get("icon-size").evaluate(Di,{},eo)],Ed[0]>Vu&&tt(`${Zt.layerIds[0]}: Value for "icon-size" is >= ${my}. Reduce your "icon-size".`)):UO.kind==="composite"&&(Ed=[cl*Qr.compositeIconSizes[0].evaluate(Di,{},eo),cl*Qr.compositeIconSizes[1].evaluate(Di,{},eo)],(Ed[0]>Vu||Ed[1]>Vu)&&tt(`${Zt.layerIds[0]}: Value for "icon-size" is >= ${my}. Reduce your "icon-size".`)),Zt.addSymbols(Zt.icon,Sy,Ed,Pr,Jr,Di,!1,si,Rn,Oo.lineStartIndex,Oo.lineLength,-1,as,eo),BT=Zt.icon.placedSymbolArray.length-1,jT&&(FO=4*jT.length,Zt.addSymbols(Zt.icon,jT,Ed,Pr,Jr,Di,ua.vertical,si,Rn,Oo.lineStartIndex,Oo.lineLength,-1,as,eo),zT=Zt.icon.placedSymbolArray.length-1)}for(const js in ai.horizontal){const $s=ai.horizontal[js];To||(NO=OE($s.text),Lr?wp=ET($s):To=W1(qi,wd,Rn,nr,ir,Yi,$s,Tr,di.layout.get("text-rotate").evaluate(Di,{},eo),Yr));const Sy=$s.positionedLines.length===1;if(BO+=tO(Zt,si,Rn,$s,ar,di,Lr,Di,Yr,Oo,ai.vertical?ua.horizontal:ua.horizontalOnly,Sy?Object.keys(ai.horizontal):[js],Gl,BT,Qr,as,eo),Sy)break}ai.vertical&&(zO+=tO(Zt,si,Rn,ai.vertical,ar,di,Lr,Di,Yr,Oo,ua.vertical,["vertical"],Gl,zT,Qr,as,eo));let Ku=-1;const VT=(js,$s)=>js?Math.max(js,$s):$s;Ku=VT(wp,Ku),Ku=VT(Ey,Ku),Ku=VT(Ty,Ku);const FH=Ku>-1?1:0;Zt.glyphOffsetArray.length>=$u.MAX_GLYPHS&&tt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Di.sortKey!==void 0&&Zt.addToSortKeyRanges(Zt.symbolInstances.length,Di.sortKey),Zt.symbolInstances.emplaceBack(wd.x,wd.y,wd.z,Rn.x,Rn.y,Gl.right>=0?Gl.right:-1,Gl.center>=0?Gl.center:-1,Gl.left>=0?Gl.left:-1,Gl.vertical>=0?Gl.vertical:-1,BT,zT,NO,To!==void 0?To:Zt.collisionBoxArray.length,To!==void 0?To+1:Zt.collisionBoxArray.length,So!==void 0?So:Zt.collisionBoxArray.length,So!==void 0?So+1:Zt.collisionBoxArray.length,ls!==void 0?ls:Zt.collisionBoxArray.length,ls!==void 0?ls+1:Zt.collisionBoxArray.length,dl||Zt.collisionBoxArray.length,dl?dl+1:Zt.collisionBoxArray.length,nr,BO,zO,kO,FO,FH,0,NT,UT,Ku)})(c,yn,oi,rn,u,f,g,Kt,c.layers[0],c.collisionBoxArray,a.index,a.sourceLayerIndex,c.index,De,_t,P,0,lt,Vt,Q,a,b,M,D,N)};if(ft==="line")for(const rn of ZL(a.geometry,0,0,On,On)){const yn=eH(rn,Fe,it,u.vertical||oe,f,Me,Ie,c.overscaling,On);for(const sn of yn)oe&&cH(c,oe.text,St,sn)||vt(rn,sn,N)}else if(ft==="line-center"){for(const rn of a.geometry)if(rn.length>1){const yn=QG(rn,it,u.vertical||oe,f,Me,Ie);yn&&vt(rn,yn,N)}}else if(a.type==="Polygon")for(const rn of cT(a.geometry,0)){const yn=rH(rn,16);vt(rn[0],new Oc(yn.x,yn.y,0,0,void 0),N)}else if(a.type==="LineString")for(const rn of a.geometry)vt(rn,new Oc(rn[0].x,rn[0].y,0,0,void 0),N);else if(a.type==="Point")for(const rn of a.geometry)for(const yn of rn)vt([yn],new Oc(yn.x,yn.y,0,0,void 0),N)}const my=255,Vu=my*cl;function tO(c,a,u,f,g,b,E,C,P,M,D,N,V,H,W,Q,oe){const xe=function(Ie,Fe,De,lt,it,_t,Vt,ft){const St=[];if(Fe.positionedLines.length===0)return St;const Ct=lt.layout.get("text-rotate").evaluate(_t,{})*Math.PI/180,Dt=function(sn){const oi=sn[0],Zt=sn[1],Rn=oi*Zt;return Rn>0?[oi,-Zt]:Rn<0?[-oi,Zt]:oi===0?[Zt,oi]:[Zt,-oi]}(De);let Kt=Math.abs(Fe.top-Fe.bottom);for(const sn of Fe.positionedLines)Kt-=sn.lineOffset;const vt=Fe.positionedLines.length,rn=Kt/vt;let yn=Fe.top-De[1];for(let sn=0;sn<vt;++sn){const oi=Fe.positionedLines[sn];yn=tH(Fe,rn,yn,sn);for(const Zt of oi.positionedGlyphs){if(!Zt.rect)continue;const Rn=Zt.rect||{};let si=kL+1,Ii=!0,ai=1,Nn=0;if(Zt.imageName){const rr=Vt[Zt.imageName];if(!rr)continue;if(rr.sdf){tt("SDF images are not supported in formatted text and will be ignored.");continue}Ii=!1,ai=rr.pixelRatio,si=Cs/ai}const ar=(it||ft)&&Zt.vertical,hi=Zt.metrics.advance*Zt.scale/2,di=Zt.metrics,qi=Zt.rect;if(qi===null)continue;ft&&Fe.verticalizable&&(Nn=Zt.imageName?hi-Zt.metrics.width*Zt.scale/2:0);const nr=it?[Zt.x+hi,Zt.y]:[0,0];let ir=[0,0],Yi=[0,0],Tr=!1;it||(ar?(Yi=[Zt.x+hi+Dt[0],Zt.y+Dt[1]-Nn],Tr=!0):ir=[Zt.x+hi+De[0],Zt.y+De[1]-Nn]);const Lr=qi.w*Zt.scale/(ai*(Zt.localGlyph?ul:1)),Yr=qi.h*Zt.scale/(ai*(Zt.localGlyph?ul:1));let Ji,oo,Jr,Pr;if(ar){const rr=Zt.y-yn,as=new J(-hi,hi-rr),eo=-Math.PI/2,Oo=new J(...Yi);Ji=new J(-hi+ir[0],ir[1]),Ji._rotateAround(eo,as)._add(Oo),Ji.x+=-rr+hi,Ji.y-=(di.left-si)*Zt.scale;const To=Zt.imageName?di.advance*Zt.scale:Lo*Zt.scale,ls=String.fromCharCode(Zt.glyph);FG(ls)?Ji.x+=(1-si)*Zt.scale:BG(ls)?Ji.x+=To-di.height*Zt.scale+(-si-1)*Zt.scale:Ji.x+=Zt.imageName||di.width+2*si===qi.w&&di.height+2*si===qi.h?(To-Yr)/2:(To-(di.height+2*si)*Zt.scale)/2,oo=new J(Ji.x,Ji.y-Lr),Jr=new J(Ji.x+Yr,Ji.y),Pr=new J(Ji.x+Yr,Ji.y-Lr)}else{const rr=(di.left-si)*Zt.scale-hi+ir[0],as=(-di.top-si)*Zt.scale+ir[1],eo=rr+Lr,Oo=as+Yr;Ji=new J(rr,as),oo=new J(eo,as),Jr=new J(rr,Oo),Pr=new J(eo,Oo)}if(Ct){let rr;rr=it?new J(0,0):Tr?new J(Dt[0],Dt[1]):new J(De[0],De[1]),Ji._rotateAround(Ct,rr),oo._rotateAround(Ct,rr),Jr._rotateAround(Ct,rr),Pr._rotateAround(Ct,rr)}const Di=new J(0,0),Qr=new J(0,0);St.push({tl:Ji,tr:oo,bl:Jr,br:Pr,tex:Rn,writingMode:Fe.writingMode,glyphOffset:nr,sectionIndex:Zt.sectionIndex,isSDF:Ii,pixelOffsetTL:Di,pixelOffsetBR:Qr,minFontScaleX:0,minFontScaleY:0})}}return St}(0,f,P,b,E,C,g,c.allowVerticalPlacement),Me=c.textSizeData;let we=null;Me.kind==="source"?(we=[cl*b.layout.get("text-size").evaluate(C,{},oe)],we[0]>Vu&&tt(`${c.layerIds[0]}: Value for "text-size" is >= ${my}. Reduce your "text-size".`)):Me.kind==="composite"&&(we=[cl*W.compositeTextSizes[0].evaluate(C,{},oe),cl*W.compositeTextSizes[1].evaluate(C,{},oe)],(we[0]>Vu||we[1]>Vu)&&tt(`${c.layerIds[0]}: Value for "text-size" is >= ${my}. Reduce your "text-size".`)),c.addSymbols(c.text,xe,we,P,E,C,D,a,u,M.lineStartIndex,M.lineLength,H,Q,oe);for(const Ie of N)V[Ie]=c.text.placedSymbolArray.length-1;return 4*xe.length}function nO(c){for(const a in c)return c[a];return null}function W1(c,a,u,f,g,b,E,C,P,M){let D=E.top,N=E.bottom,V=E.left,H=E.right;const W=E.collisionPadding;if(W&&(V-=W[0],D-=W[1],H+=W[2],N+=W[3]),P){const Q=new J(V,D),oe=new J(H,D),xe=new J(V,N),Me=new J(H,N),we=be(P);let Ie=new J(0,0);M&&(Ie=new J(M[0],M[1])),Q._rotateAround(we,Ie),oe._rotateAround(we,Ie),xe._rotateAround(we,Ie),Me._rotateAround(we,Ie),V=Math.min(Q.x,oe.x,xe.x,Me.x),H=Math.max(Q.x,oe.x,xe.x,Me.x),D=Math.min(Q.y,oe.y,xe.y,Me.y),N=Math.max(Q.y,oe.y,xe.y,Me.y)}return c.emplaceBack(a.x,a.y,a.z,u.x,u.y,V,D,H,N,C,f,g,b),c.length-1}function ET(c){c.collisionPadding&&(c.top-=c.collisionPadding[1],c.bottom+=c.collisionPadding[3]);const a=c.bottom-c.top;return a>0?Math.max(10,a):null}function cH(c,a,u,f){const g=c.compareText;if(a in g){const b=g[a];for(let E=b.length-1;E>=0;E--)if(f.dist(b[E])<u)return!0}else g[a]=[];return g[a].push(f),!1}function iO(c,a){const u=c.fovAboveCenter,f=c.elevation?c.elevation.getMinElevationBelowMSL()*a:0,g=(c._camera.position[2]*c.worldSize-f)/Math.cos(c._pitch),b=Math.sin(u)*g/Math.sin(Math.max(Math.PI/2-c._pitch-u,.01)),E=Math.sin(c._pitch)*b+g;return Math.min(1.01*E,g*(1/c._horizonShift))}function bd(c,a){if(!a.isReprojectedInTileSpace)return{scale:1<<c.z,x:c.x,y:c.y,x2:c.x+1,y2:c.y+1,projection:a};const u=Math.pow(2,-c.z),f=c.x*u,g=(c.x+1)*u,b=c.y*u,E=(c.y+1)*u,C=ca(f),P=ca(g),M=jo(b),D=jo(E),N=a.project(C,M),V=a.project(P,M),H=a.project(P,D),W=a.project(C,D);let Q=Math.min(N.x,V.x,H.x,W.x),oe=Math.min(N.y,V.y,H.y,W.y),xe=Math.max(N.x,V.x,H.x,W.x),Me=Math.max(N.y,V.y,H.y,W.y);const we=u/16;function Ie(De,lt,it,_t,Vt,ft){const St=(it+Vt)/2,Ct=(_t+ft)/2,Dt=a.project(ca(St),jo(Ct)),Kt=Math.max(0,Q-Dt.x,oe-Dt.y,Dt.x-xe,Dt.y-Me);Q=Math.min(Q,Dt.x),xe=Math.max(xe,Dt.x),oe=Math.min(oe,Dt.y),Me=Math.max(Me,Dt.y),Kt>we&&(Ie(De,Dt,it,_t,St,Ct),Ie(Dt,lt,St,Ct,Vt,ft))}Ie(N,V,f,b,g,b),Ie(V,H,g,b,g,E),Ie(H,W,g,E,f,E),Ie(W,N,f,E,f,b),Q-=we,oe-=we,xe+=we,Me+=we;const Fe=1/Math.max(xe-Q,Me-oe);return{scale:Fe,x:Q*Fe,y:oe*Fe,x2:xe*Fe,y2:Me*Fe,projection:a}}const uH=sl(new Float32Array(16));class ju{constructor(a){this.spec=a,this.name=a.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(a,u){return{x:0,y:0,z:0}}unproject(a,u){return new Zi(0,0)}projectTilePoint(a,u,f){return{x:a,y:u,z:0}}locationPoint(a,u,f=!0){return a._coordinatePoint(a.locationCoordinate(u),f)}pixelsPerMeter(a,u){return ll(1,a)*u}pixelSpaceConversion(a,u,f){return 1}farthestPixelDistance(a){return iO(a,a.pixelsPerMeter)}pointCoordinate(a,u,f,g){const b=a.horizonLineFromTop(!1),E=new J(u,Math.max(b,f));return a.rayIntersectionCoordinate(a.pointRayIntersection(E,g))}pointCoordinate3D(a,u,f){const g=new J(u,f);if(a.elevation)return a.elevation.pointCoordinate(g);{const b=this.pointCoordinate(a,g.x,g.y,0);return[b.x,b.y,b.z]}}isPointAboveHorizon(a,u){if(a.elevation)return!this.pointCoordinate3D(a,u.x,u.y);const f=a.horizonLineFromTop();return u.y<f}createInversionMatrix(a,u){return uH}createTileMatrix(a,u,f){let g,b,E;const C=f.canonical,P=sl(new Float64Array(16));if(this.isReprojectedInTileSpace){const M=bd(C,this);g=1,b=M.x+f.wrap*M.scale,E=M.y,fd(P,P,[g/M.scale,g/M.scale,a.pixelsPerMeter/u])}else g=u/a.zoomScale(C.z),b=(C.x+Math.pow(2,C.z)*f.wrap)*g,E=C.y*g;return Wg(P,P,[b,E,0]),fd(P,P,[g/On,g/On,1]),P}upVector(a,u,f){return[0,0,1]}upVectorScale(a,u,f){return{metersToTile:1}}}class hH extends ju{constructor(a){super(a),this.range=[4,7],this.center=a.center||[-96,37.5];const[u,f]=this.parallels=a.parallels||[29.5,45.5],g=Math.sin(be(u));this.n=(g+Math.sin(be(f)))/2,this.c=1+g*(2*this.n-g),this.r0=Math.sqrt(this.c)/this.n}project(a,u){const{n:f,c:g,r0:b}=this,E=be(a-this.center[0]),C=be(u),P=Math.sqrt(g-2*f*Math.sin(C))/f;return{x:P*Math.sin(E*f),y:P*Math.cos(E*f)-b,z:0}}unproject(a,u){const{n:f,c:g,r0:b}=this,E=b+u;let C=Math.atan2(a,Math.abs(E))*Math.sign(E);E*f<0&&(C-=Math.PI*Math.sign(a)*Math.sign(E));const P=be(this.center[0])*f;C=cn(C,-Math.PI-P,Math.PI-P);const M=bt(Te(C/f)+this.center[0],-180,180),D=Math.asin(bt((g-(a*a+E*E)*f*f)/(2*f),-1,1)),N=bt(Te(D),-$o,$o);return new Zi(M,N)}}const gy=1.340264,yy=-.081106,vy=893e-6,_y=.003796,K1=Math.sqrt(3)/2;class dH extends ju{project(a,u){u=u/180*Math.PI,a=a/180*Math.PI;const f=Math.asin(K1*Math.sin(u)),g=f*f,b=g*g*g;return{x:.5*(a*Math.cos(f)/(K1*(gy+3*yy*g+b*(7*vy+9*_y*g)))/Math.PI+.5),y:1-.5*(f*(gy+yy*g+b*(vy+_y*g))/Math.PI+1),z:0}}unproject(a,u){a=(2*a-.5)*Math.PI;let f=u=(2*(1-u)-1)*Math.PI,g=f*f,b=g*g*g;for(let D,N,V,H=0;H<12&&(N=f*(gy+yy*g+b*(vy+_y*g))-u,V=gy+3*yy*g+b*(7*vy+9*_y*g),D=N/V,f=bt(f-D,-Math.PI/3,Math.PI/3),g=f*f,b=g*g*g,!(Math.abs(D)<1e-12));++H);const E=K1*a*(gy+3*yy*g+b*(7*vy+9*_y*g))/Math.cos(f),C=Math.asin(Math.sin(f)/K1),P=bt(180*E/Math.PI,-180,180),M=bt(180*C/Math.PI,-$o,$o);return new Zi(P,M)}}class fH extends ju{constructor(a){super(a),this.wrap=!0,this.supportsWorldCopies=!0}project(a,u){return{x:.5+a/360,y:.5-u/360,z:0}}unproject(a,u){const f=360*(a-.5),g=bt(360*(.5-u),-$o,$o);return new Zi(f,g)}}const bp=Math.PI/2;function X1(c){return Math.tan((bp+c)/2)}class pH extends ju{constructor(a){super(a),this.center=a.center||[0,30];const[u,f]=this.parallels=a.parallels||[30,30];let g=be(u),b=be(f);this.southernCenter=g+b<0,this.southernCenter&&(g=-g,b=-b);const E=Math.cos(g),C=X1(g);this.n=g===b?Math.sin(g):Math.log(E/Math.cos(b))/Math.log(X1(b)/C),this.f=E*Math.pow(X1(g),this.n)/this.n}project(a,u){u=be(u),this.southernCenter&&(u=-u),a=be(a-this.center[0]);const f=1e-6,{n:g,f:b}=this;b>0?u<-bp+f&&(u=-bp+f):u>bp-f&&(u=bp-f);const E=b/Math.pow(X1(u),g);let C=E*Math.sin(g*a),P=b-E*Math.cos(g*a);return C=.5*(C/Math.PI+.5),P=.5*(P/Math.PI+.5),{x:C,y:this.southernCenter?P:1-P,z:0}}unproject(a,u){a=(2*a-.5)*Math.PI,this.southernCenter&&(u=1-u),u=(2*(1-u)-.5)*Math.PI;const{n:f,f:g}=this,b=g-u,E=Math.sign(b),C=Math.sign(f)*Math.sqrt(a*a+b*b);let P=Math.atan2(a,Math.abs(b))*E;b*f<0&&(P-=Math.PI*Math.sign(a)*E);const M=bt(Te(P/f)+this.center[0],-180,180),D=bt(Te(2*Math.atan(Math.pow(g/C,1/f))-bp),-$o,$o);return new Zi(M,this.southernCenter?-D:D)}}class rO extends ju{constructor(a){super(a),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(a,u){return{x:Nl(a),y:Ul(u),z:0}}unproject(a,u){const f=ca(a),g=jo(u);return new Zi(f,g)}}const oO=be($o);class mH extends ju{project(a,u){const f=(u=be(u))*u,g=f*f;return{x:.5*((a=be(a))*(.8707-.131979*f+g*(g*(.003971*f-.001529*g)-.013791))/Math.PI+.5),y:1-.5*(u*(1.007226+f*(.015085+g*(.028874*f-.044475-.005916*g)))/Math.PI+1),z:0}}unproject(a,u){a=(2*a-.5)*Math.PI;let f=u=(2*(1-u)-1)*Math.PI,g=25,b=0,E=f*f;do{E=f*f;const M=E*E;b=(f*(1.007226+E*(.015085+M*(.028874*E-.044475-.005916*M)))-u)/(1.007226+E*(.045255+M*(.259866*E-.311325-.005916*11*M))),f=bt(f-b,-oO,oO)}while(Math.abs(b)>1e-6&&--g>0);E=f*f;const C=bt(Te(a/(.8707+E*(E*(E*E*E*(.003971-.001529*E)-.013791)-.131979))),-180,180),P=Te(f);return new Zi(C,P)}}const sO=be($o);class gH extends ju{project(a,u){u=be(u),a=be(a);const f=Math.cos(u),g=2/Math.PI,b=Math.acos(f*Math.cos(a/2)),E=Math.sin(b)/b,C=.5*(a*g+2*f*Math.sin(a/2)/E)||0,P=.5*(u+Math.sin(u)/E)||0;return{x:.5*(C/Math.PI+.5),y:1-.5*(P/Math.PI+1),z:0}}unproject(a,u){let f=a=(2*a-.5)*Math.PI,g=u=(2*(1-u)-1)*Math.PI,b=25;const E=1e-6;let C=0,P=0;do{const M=Math.cos(g),D=Math.sin(g),N=2*D*M,V=D*D,H=M*M,W=Math.cos(f/2),Q=Math.sin(f/2),oe=2*W*Q,xe=Q*Q,Me=1-H*W*W,we=Me?1/Me:0,Ie=Me?Math.acos(M*W)*Math.sqrt(1/Me):0,Fe=.5*(2*Ie*M*Q+2*f/Math.PI)-a,De=.5*(Ie*D+g)-u,lt=.5*we*(H*xe+Ie*M*W*V)+1/Math.PI,it=we*(oe*N/4-Ie*D*Q),_t=.125*we*(N*Q-Ie*D*H*oe),Vt=.5*we*(V*W+Ie*xe*M)+.5,ft=it*_t-Vt*lt;C=(De*it-Fe*Vt)/ft,P=(Fe*_t-De*lt)/ft,f=bt(f-C,-Math.PI,Math.PI),g=bt(g-P,-sO,sO)}while((Math.abs(C)>E||Math.abs(P)>E)&&--b>0);return new Zi(Te(f),Te(g))}}class aO extends ju{constructor(a){super(a),this.center=a.center||[0,0],this.parallels=a.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(be(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(a,u){const{scale:f,cosPhi:g}=this;return{x:be(a)*g*f+.5,y:-Math.sin(be(u))/g*f+.5,z:0}}unproject(a,u){const{scale:f,cosPhi:g}=this,b=-(u-.5)/f,E=bt(Te((a-.5)/f)/g,-180,180),C=Math.asin(bt(b*g,-1,1)),P=bt(Te(C),-$o,$o);return new Zi(E,P)}}class yH extends rO{constructor(a){super(a),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(a,u,f){const g=ey(a,u,f);return zr(g,g,ty(zl(f))),{x:g[0],y:g[1],z:g[2]}}locationPoint(a,u){const f=op(u.lat,u.lng),g=rs([],f),b=a.elevation?a.elevation.getAtPointOrZero(a.locationCoordinate(u),a._centerAltitude):a._centerAltitude;qg(f,f,g,ll(1,0)*On*b);const E=sl(new Float64Array(16));return dd(E,a.pixelMatrix,a.globeMatrix),zr(f,f,E),new J(f[0],f[1])}pixelsPerMeter(a,u){return ll(1,0)*u}pixelSpaceConversion(a,u,f){const g=ll(1,a)*u,b=Ci(ll(1,45)*u,g,f);return this.pixelsPerMeter(a,u)/b}createTileMatrix(a,u,f){const g=KE(zl(f.canonical));return dd(new Float64Array(16),a.globeMatrix,g)}createInversionMatrix(a,u){const{center:f}=a,g=ty(zl(u));return w1(g,g,be(f.lng)),BE(g,g,be(f.lat)),fd(g,g,[a._pixelsPerMercatorPixel,a._pixelsPerMercatorPixel,1]),Float32Array.from(g)}pointCoordinate(a,u,f,g){return DR(a,u,f,!0)||new ap(0,0)}pointCoordinate3D(a,u,f){const g=this.pointCoordinate(a,u,f,0);return[g.x,g.y,g.z]}isPointAboveHorizon(a,u){return!DR(a,u.x,u.y,!1)}farthestPixelDistance(a){const u=function(g,b){const E=g.cameraToCenterDistance,C=g._centerAltitude*b,P=g._camera,M=g._camera.forward(),D=Ic([],la([],M,-E),[0,0,C]),N=g.worldSize/(2*Math.PI),V=[0,0,-N],H=g.width/g.height,W=Math.tan(g.fovAboveCenter),Q=la([],P.up(),W),oe=la([],P.right(),W*H),xe=rs([],Ic([],Ic([],M,Q),oe)),Me=[];let we;if(new VE(D,xe).closestPointOnSphere(V,N,Me)){const Ie=Ic([],Me,V),Fe=al([],Ie,D);we=Math.cos(g.fovAboveCenter)*Kg(Fe)}else{const Ie=al([],D,V),Fe=al([],V,D);rs(Fe,Fe);const De=Kg(Ie)-N;we=Math.sqrt(De*(De+2*N));const lt=Math.acos(we/(N+De))-Math.acos(Ra(M,Fe));we*=Math.cos(lt)}return 1.01*we}(a,this.pixelsPerMeter(a.center.lat,a.worldSize)),f=sp(a.zoom);if(f>0){const g=iO(a,ll(1,a.center.lat)*a.worldSize),b=a.worldSize/(2*Math.PI),E=Math.max(a.width,a.height)/a.worldSize*Math.PI;return Ci(u,g+b*(1-Math.cos(E)),Math.pow(f,10))}return u}upVector(a,u,f){return ey(u,f,a,1)}upVectorScale(a){return{metersToTile:E1(S1(zl(a)))}}}function lO(c){const a=c.parallels,u=!!a&&Math.abs(a[0]+a[1])<.01;switch(c.name){case"mercator":return new rO(c);case"equirectangular":return new fH(c);case"naturalEarth":return new mH(c);case"equalEarth":return new dH(c);case"winkelTripel":return new gH(c);case"albers":return u?new aO(c):new hH(c);case"lambertConformalConic":return u?new aO(c):new pH(c);case"globe":return new yH(c)}throw new Error(`Invalid projection name: ${c.name}`)}const vH=k1.types,_H=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Z1(c,a,u,f,g,b,E,C,P,M,D,N,V){const H=C?Math.min(Vu,Math.round(C[0])):0,W=C?Math.min(Vu,Math.round(C[1])):0;c.emplaceBack(a,u,Math.round(32*f),Math.round(32*g),b,E,(H<<1)+(P?1:0),W,16*M,16*D,256*N,256*V)}function q1(c,a,u,f,g,b,E){c.emplaceBack(a,u,f,g,b,E)}function Y1(c,a,u,f,g){c.emplaceBack(a,u,f,g),c.emplaceBack(a,u,f,g),c.emplaceBack(a,u,f,g),c.emplaceBack(a,u,f,g)}function bH(c){for(const a of c.sections)if(LE(a.text))return!0;return!1}class TT{constructor(a){this.layoutVertexArray=new Mt,this.indexArray=new Sn,this.programConfigurations=a,this.segments=new Zr,this.dynamicLayoutVertexArray=new Bt,this.opacityVertexArray=new In,this.placedSymbolArray=new Xr,this.globeExtVertexArray=new Gt}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(a,u,f,g){this.isEmpty()||(f&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,PG.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,u),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,MG.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,_H,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=a.createVertexBuffer(this.globeExtVertexArray,IG.members,!0)),this.opacityVertexBuffer.itemSize=1),(f||g)&&this.programConfigurations.upload(a))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}dn(TT,"SymbolBuffers");class ST{constructor(a,u,f){this.layoutVertexArray=new a,this.layoutAttributes=u,this.indexArray=new f,this.segments=new Zr,this.collisionVertexArray=new yi,this.collisionVertexArrayExt=new gi}upload(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=a.createVertexBuffer(this.collisionVertexArray,RG.members,!0),this.collisionVertexBufferExt=a.createVertexBuffer(this.collisionVertexArrayExt,LG.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}dn(ST,"CollisionBuffers");class $u{constructor(a){this.collisionBoxArray=a.collisionBoxArray,this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(E=>E.id),this.index=a.index,this.pixelRatio=a.pixelRatio,this.sourceLayerIndex=a.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=sl([]),this.placementViewportMatrix=sl([]);const u=this.layers[0]._unevaluatedLayout._values;this.textSizeData=fT(this.zoom,u["text-size"]),this.iconSizeData=fT(this.zoom,u["icon-size"]);const f=this.layers[0].layout,g=f.get("symbol-sort-key"),b=f.get("symbol-z-order");this.canOverlap=f.get("text-allow-overlap")||f.get("icon-allow-overlap")||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=b!=="viewport-y"&&g.constantOr(1)!==void 0,this.sortFeaturesByY=(b==="viewport-y"||b==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=f.get("text-writing-mode").map(E=>ua[E]),this.stateDependentLayerIds=this.layers.filter(E=>E.isStateDependent()).map(E=>E.id),this.sourceID=a.sourceID,this.projection=a.projection}createArrays(){this.text=new TT(new hd(this.layers,this.zoom,a=>/^text/.test(a))),this.icon=new TT(new hd(this.layers,this.zoom,a=>/^icon/.test(a))),this.glyphOffsetArray=new is,this.lineVertexArray=new ep,this.symbolInstances=new dr}calculateGlyphDependencies(a,u,f,g,b){for(let E=0;E<a.length;E++)if(u[a.charCodeAt(E)]=!0,g&&b){const C=dy[a.charAt(E)];C&&(u[C.charCodeAt(0)]=!0)}}populate(a,u,f,g){const b=this.layers[0],E=b.layout,C=this.projection.name==="globe",P=E.get("text-font"),M=E.get("text-field"),D=E.get("icon-image"),N=(M.value.kind!=="constant"||M.value.value instanceof xi&&!M.value.value.isEmpty()||M.value.value.toString().length>0)&&(P.value.kind!=="constant"||P.value.value.length>0),V=D.value.kind!=="constant"||!!D.value.value||Object.keys(D.parameters).length>0,H=E.get("symbol-sort-key");if(this.features=[],!N&&!V)return;const W=u.iconDependencies,Q=u.glyphDependencies,oe=u.availableImages,xe=new z(this.zoom);for(const{feature:Me,id:we,index:Ie,sourceLayerIndex:Fe}of a){const De=b._featureFilter.needGeometry,lt=yd(Me,De);if(!b._featureFilter.filter(xe,lt,f))continue;if(De||(lt.geometry=Mc(Me,f,g)),C&&Me.type!==1&&f.z<=5){const ft=lt.geometry,St=.98078528056,Ct=(Dt,Kt)=>Ra(ey(Dt.x,Dt.y,f,1),ey(Kt.x,Kt.y,f,1))<St;for(let Dt=0;Dt<ft.length;Dt++)ft[Dt]=M$(ft[Dt],Ct)}let it,_t;if(N){const ft=b.getValueAndResolveTokens("text-field",lt,f,oe),St=xi.factory(ft);bH(St)&&(this.hasRTLText=!0),(!this.hasRTLText||A()==="unavailable"||this.hasRTLText&&O.isParsed())&&(it=kG(St,b,lt))}if(V){const ft=b.getValueAndResolveTokens("icon-image",lt,f,oe);_t=ft instanceof Si?ft:Si.fromString(ft)}if(!it&&!_t)continue;const Vt=this.sortFeaturesByKey?H.evaluate(lt,{},f):void 0;if(this.features.push({id:we,text:it,icon:_t,index:Ie,sourceLayerIndex:Fe,geometry:lt.geometry,properties:Me.properties,type:vH[Me.type],sortKey:Vt}),_t&&(W[_t.name]=!0),it){const ft=P.evaluate(lt,{},f).join(","),St=E.get("text-rotation-alignment")==="map"&&E.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ua.vertical)>=0;for(const Ct of it.sections)if(Ct.image)W[Ct.image.name]=!0;else{const Dt=Ng(it.toString()),Kt=Ct.fontStack||ft,vt=Q[Kt]=Q[Kt]||{};this.calculateGlyphDependencies(Ct.text,vt,St,this.allowVerticalPlacement,Dt)}}}E.get("symbol-placement")==="line"&&(this.features=function(Me){const we={},Ie={},Fe=[];let De=0;function lt(ft){Fe.push(Me[ft]),De++}function it(ft,St,Ct){const Dt=Ie[ft];return delete Ie[ft],Ie[St]=Dt,Fe[Dt].geometry[0].pop(),Fe[Dt].geometry[0]=Fe[Dt].geometry[0].concat(Ct[0]),Dt}function _t(ft,St,Ct){const Dt=we[St];return delete we[St],we[ft]=Dt,Fe[Dt].geometry[0].shift(),Fe[Dt].geometry[0]=Ct[0].concat(Fe[Dt].geometry[0]),Dt}function Vt(ft,St,Ct){const Dt=Ct?St[0][St[0].length-1]:St[0][0];return`${ft}:${Dt.x}:${Dt.y}`}for(let ft=0;ft<Me.length;ft++){const St=Me[ft],Ct=St.geometry,Dt=St.text?St.text.toString():null;if(!Dt){lt(ft);continue}const Kt=Vt(Dt,Ct),vt=Vt(Dt,Ct,!0);if(Kt in Ie&&vt in we&&Ie[Kt]!==we[vt]){const rn=_t(Kt,vt,Ct),yn=it(Kt,vt,Fe[rn].geometry);delete we[Kt],delete Ie[vt],Ie[Vt(Dt,Fe[yn].geometry,!0)]=yn,Fe[rn].geometry=null}else Kt in Ie?it(Kt,vt,Ct):vt in we?_t(Kt,vt,Ct):(lt(ft),we[Kt]=De-1,Ie[vt]=De-1)}return Fe.filter(ft=>ft.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Me,we)=>Me.sortKey-we.sortKey)}update(a,u,f,g){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(a,u,this.layers,f,g),this.icon.programConfigurations.updatePaintArrays(a,u,this.layers,f,g))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(a){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(a),this.iconCollisionBox.upload(a)),this.text.upload(a,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(a,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=lO(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(a,u){const f=this.lineVertexArray.length;if(a.segment!==void 0)for(const{x:g,y:b}of u)this.lineVertexArray.emplaceBack(g,b);return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(a,u,f,g,b,E,C,P,M,D,N,V,H,W){const Q=a.indexArray,oe=a.layoutVertexArray,xe=a.globeExtVertexArray,Me=a.segments.prepareSegment(4*u.length,oe,Q,this.canOverlap?E.sortKey:void 0),we=this.glyphOffsetArray.length,Ie=Me.vertexLength,Fe=this.allowVerticalPlacement&&C===ua.vertical?Math.PI/2:0,De=E.text&&E.text.sections;for(let it=0;it<u.length;it++){const{tl:_t,tr:Vt,bl:ft,br:St,tex:Ct,pixelOffsetTL:Dt,pixelOffsetBR:Kt,minFontScaleX:vt,minFontScaleY:rn,glyphOffset:yn,isSDF:sn,sectionIndex:oi}=u[it],Zt=Me.vertexLength,Rn=yn[1];if(Z1(oe,M.x,M.y,_t.x,Rn+_t.y,Ct.x,Ct.y,f,sn,Dt.x,Dt.y,vt,rn),Z1(oe,M.x,M.y,Vt.x,Rn+Vt.y,Ct.x+Ct.w,Ct.y,f,sn,Kt.x,Dt.y,vt,rn),Z1(oe,M.x,M.y,ft.x,Rn+ft.y,Ct.x,Ct.y+Ct.h,f,sn,Dt.x,Kt.y,vt,rn),Z1(oe,M.x,M.y,St.x,Rn+St.y,Ct.x+Ct.w,Ct.y+Ct.h,f,sn,Kt.x,Kt.y,vt,rn),P){const{x:si,y:Ii,z:ai}=P.anchor,[Nn,ar,hi]=P.up;q1(xe,si,Ii,ai,Nn,ar,hi),q1(xe,si,Ii,ai,Nn,ar,hi),q1(xe,si,Ii,ai,Nn,ar,hi),q1(xe,si,Ii,ai,Nn,ar,hi),Y1(a.dynamicLayoutVertexArray,si,Ii,ai,Fe)}else Y1(a.dynamicLayoutVertexArray,M.x,M.y,M.z,Fe);Q.emplaceBack(Zt,Zt+1,Zt+2),Q.emplaceBack(Zt+1,Zt+2,Zt+3),Me.vertexLength+=4,Me.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(yn[0]),it!==u.length-1&&oi===u[it+1].sectionIndex||a.programConfigurations.populatePaintArrays(oe.length,E,E.index,{},H,W,De&&De[oi])}const lt=P?P.anchor:M;a.placedSymbolArray.emplaceBack(lt.x,lt.y,lt.z,M.x,M.y,we,this.glyphOffsetArray.length-we,Ie,D,N,M.segment,f?f[0]:0,f?f[1]:0,g[0],g[1],C,0,!1,0,V,0)}_commitLayoutVertex(a,u,f,g,b,E,C){a.emplaceBack(u,f,g,b,E,Math.round(C.x),Math.round(C.y))}_addCollisionDebugVertices(a,u,f,g,b,E,C){const P=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),M=P.vertexLength,D=C.tileAnchorX,N=C.tileAnchorY;for(let H=0;H<4;H++)f.collisionVertexArray.emplaceBack(0,0,0,0);f.collisionVertexArrayExt.emplaceBack(u,-a.padding,-a.padding),f.collisionVertexArrayExt.emplaceBack(u,a.padding,-a.padding),f.collisionVertexArrayExt.emplaceBack(u,a.padding,a.padding),f.collisionVertexArrayExt.emplaceBack(u,-a.padding,a.padding),this._commitLayoutVertex(f.layoutVertexArray,g,b,E,D,N,new J(a.x1,a.y1)),this._commitLayoutVertex(f.layoutVertexArray,g,b,E,D,N,new J(a.x2,a.y1)),this._commitLayoutVertex(f.layoutVertexArray,g,b,E,D,N,new J(a.x2,a.y2)),this._commitLayoutVertex(f.layoutVertexArray,g,b,E,D,N,new J(a.x1,a.y2)),P.vertexLength+=4;const V=f.indexArray;V.emplaceBack(M,M+1),V.emplaceBack(M+1,M+2),V.emplaceBack(M+2,M+3),V.emplaceBack(M+3,M),P.primitiveLength+=4}_addTextDebugCollisionBoxes(a,u,f,g,b,E){for(let C=g;C<b;C++){const P=f.get(C),M=this.getSymbolInstanceTextSize(a,E,u,C);this._addCollisionDebugVertices(P,M,this.textCollisionBox,P.projectedAnchorX,P.projectedAnchorY,P.projectedAnchorZ,E)}}_addIconDebugCollisionBoxes(a,u,f,g,b,E){for(let C=g;C<b;C++){const P=f.get(C),M=this.getSymbolInstanceIconSize(a,u,E.placedIconSymbolIndex);this._addCollisionDebugVertices(P,M,this.iconCollisionBox,P.projectedAnchorX,P.projectedAnchorY,P.projectedAnchorZ,E)}}generateCollisionDebugBuffers(a,u){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ST(gn,AL.members,Eo),this.iconCollisionBox=new ST(gn,AL.members,Eo);const f=dp(this.iconSizeData,a),g=dp(this.textSizeData,a);for(let b=0;b<this.symbolInstances.length;b++){const E=this.symbolInstances.get(b);this._addTextDebugCollisionBoxes(g,a,u,E.textBoxStartIndex,E.textBoxEndIndex,E),this._addTextDebugCollisionBoxes(g,a,u,E.verticalTextBoxStartIndex,E.verticalTextBoxEndIndex,E),this._addIconDebugCollisionBoxes(f,a,u,E.iconBoxStartIndex,E.iconBoxEndIndex,E),this._addIconDebugCollisionBoxes(f,a,u,E.verticalIconBoxStartIndex,E.verticalIconBoxEndIndex,E)}}getSymbolInstanceTextSize(a,u,f,g){const b=this.text.placedSymbolArray.get(u.rightJustifiedTextSymbolIndex>=0?u.rightJustifiedTextSymbolIndex:u.centerJustifiedTextSymbolIndex>=0?u.centerJustifiedTextSymbolIndex:u.leftJustifiedTextSymbolIndex>=0?u.leftJustifiedTextSymbolIndex:u.verticalPlacedTextSymbolIndex>=0?u.verticalPlacedTextSymbolIndex:g),E=N1(this.textSizeData,a,b)/Lo;return this.tilePixelRatio*E}getSymbolInstanceIconSize(a,u,f){const g=this.icon.placedSymbolArray.get(f),b=N1(this.iconSizeData,a,g);return this.tilePixelRatio*b}_commitDebugCollisionVertexUpdate(a,u,f){a.emplaceBack(u,-f,-f),a.emplaceBack(u,f,-f),a.emplaceBack(u,f,f),a.emplaceBack(u,-f,f)}_updateTextDebugCollisionBoxes(a,u,f,g,b,E){for(let C=g;C<b;C++){const P=f.get(C),M=this.getSymbolInstanceTextSize(a,E,u,C);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,M,P.padding)}}_updateIconDebugCollisionBoxes(a,u,f,g,b,E){for(let C=g;C<b;C++){const P=f.get(C),M=this.getSymbolInstanceIconSize(a,u,E);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,M,P.padding)}}updateCollisionDebugBuffers(a,u){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const f=dp(this.iconSizeData,a),g=dp(this.textSizeData,a);for(let b=0;b<this.symbolInstances.length;b++){const E=this.symbolInstances.get(b);this._updateTextDebugCollisionBoxes(g,a,u,E.textBoxStartIndex,E.textBoxEndIndex,E),this._updateTextDebugCollisionBoxes(g,a,u,E.verticalTextBoxStartIndex,E.verticalTextBoxEndIndex,E),this._updateIconDebugCollisionBoxes(f,a,u,E.iconBoxStartIndex,E.iconBoxEndIndex,E.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(f,a,u,E.verticalIconBoxStartIndex,E.verticalIconBoxEndIndex,E.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(a,u,f,g,b,E,C,P,M){const D={};if(u<f){const{x1:N,y1:V,x2:H,y2:W,padding:Q,projectedAnchorX:oe,projectedAnchorY:xe,projectedAnchorZ:Me,tileAnchorX:we,tileAnchorY:Ie,featureIndex:Fe}=a.get(u);D.textBox={x1:N,y1:V,x2:H,y2:W,padding:Q,projectedAnchorX:oe,projectedAnchorY:xe,projectedAnchorZ:Me,tileAnchorX:we,tileAnchorY:Ie},D.textFeatureIndex=Fe}if(g<b){const{x1:N,y1:V,x2:H,y2:W,padding:Q,projectedAnchorX:oe,projectedAnchorY:xe,projectedAnchorZ:Me,tileAnchorX:we,tileAnchorY:Ie,featureIndex:Fe}=a.get(g);D.verticalTextBox={x1:N,y1:V,x2:H,y2:W,padding:Q,projectedAnchorX:oe,projectedAnchorY:xe,projectedAnchorZ:Me,tileAnchorX:we,tileAnchorY:Ie},D.verticalTextFeatureIndex=Fe}if(E<C){const{x1:N,y1:V,x2:H,y2:W,padding:Q,projectedAnchorX:oe,projectedAnchorY:xe,projectedAnchorZ:Me,tileAnchorX:we,tileAnchorY:Ie,featureIndex:Fe}=a.get(E);D.iconBox={x1:N,y1:V,x2:H,y2:W,padding:Q,projectedAnchorX:oe,projectedAnchorY:xe,projectedAnchorZ:Me,tileAnchorX:we,tileAnchorY:Ie},D.iconFeatureIndex=Fe}if(P<M){const{x1:N,y1:V,x2:H,y2:W,padding:Q,projectedAnchorX:oe,projectedAnchorY:xe,projectedAnchorZ:Me,tileAnchorX:we,tileAnchorY:Ie,featureIndex:Fe}=a.get(P);D.verticalIconBox={x1:N,y1:V,x2:H,y2:W,padding:Q,projectedAnchorX:oe,projectedAnchorY:xe,projectedAnchorZ:Me,tileAnchorX:we,tileAnchorY:Ie},D.verticalIconFeatureIndex=Fe}return D}deserializeCollisionBoxes(a){this.collisionArrays=[];for(let u=0;u<this.symbolInstances.length;u++){const f=this.symbolInstances.get(u);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(a,u){const f=a.placedSymbolArray.get(u),g=f.vertexStartIndex+4*f.numGlyphs;for(let b=f.vertexStartIndex;b<g;b+=4)a.indexArray.emplaceBack(b,b+1,b+2),a.indexArray.emplaceBack(b+1,b+2,b+3)}getSortedSymbolIndexes(a){if(this.sortedAngle===a&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const u=Math.sin(a),f=Math.cos(a),g=[],b=[],E=[];for(let C=0;C<this.symbolInstances.length;++C){E.push(C);const P=this.symbolInstances.get(C);g.push(0|Math.round(u*P.tileAnchorX+f*P.tileAnchorY)),b.push(P.featureIndex)}return E.sort((C,P)=>g[C]-g[P]||b[P]-b[C]),E}addToSortKeyRanges(a,u){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===u?f.symbolInstanceEnd=a+1:this.sortKeyRanges.push({sortKey:u,symbolInstanceStart:a,symbolInstanceEnd:a+1})}sortFeatures(a){if(this.sortFeaturesByY&&this.sortedAngle!==a&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(a),this.sortedAngle=a,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const u of this.symbolInstanceIndexes){const f=this.symbolInstances.get(u);this.featureSortOrder.push(f.featureIndex);const{rightJustifiedTextSymbolIndex:g,centerJustifiedTextSymbolIndex:b,leftJustifiedTextSymbolIndex:E,verticalPlacedTextSymbolIndex:C,placedIconSymbolIndex:P,verticalPlacedIconSymbolIndex:M}=f;g>=0&&this.addIndicesForPlacedSymbol(this.text,g),b>=0&&b!==g&&this.addIndicesForPlacedSymbol(this.text,b),E>=0&&E!==b&&E!==g&&this.addIndicesForPlacedSymbol(this.text,E),C>=0&&this.addIndicesForPlacedSymbol(this.text,C),P>=0&&this.addIndicesForPlacedSymbol(this.icon,P),M>=0&&this.addIndicesForPlacedSymbol(this.icon,M)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}dn($u,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),$u.MAX_GLYPHS=65535,$u.addDynamicAttributes=Y1;const xH=new Se({"symbol-placement":new Y(yt.layout_symbol["symbol-placement"]),"symbol-spacing":new Y(yt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Y(yt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ce(yt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Y(yt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Y(yt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Y(yt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Y(yt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Y(yt.layout_symbol["icon-rotation-alignment"]),"icon-size":new ce(yt.layout_symbol["icon-size"]),"icon-text-fit":new Y(yt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Y(yt.layout_symbol["icon-text-fit-padding"]),"icon-image":new ce(yt.layout_symbol["icon-image"]),"icon-rotate":new ce(yt.layout_symbol["icon-rotate"]),"icon-padding":new Y(yt.layout_symbol["icon-padding"]),"icon-keep-upright":new Y(yt.layout_symbol["icon-keep-upright"]),"icon-offset":new ce(yt.layout_symbol["icon-offset"]),"icon-anchor":new ce(yt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Y(yt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Y(yt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Y(yt.layout_symbol["text-rotation-alignment"]),"text-field":new ce(yt.layout_symbol["text-field"]),"text-font":new ce(yt.layout_symbol["text-font"]),"text-size":new ce(yt.layout_symbol["text-size"]),"text-max-width":new ce(yt.layout_symbol["text-max-width"]),"text-line-height":new ce(yt.layout_symbol["text-line-height"]),"text-letter-spacing":new ce(yt.layout_symbol["text-letter-spacing"]),"text-justify":new ce(yt.layout_symbol["text-justify"]),"text-radial-offset":new ce(yt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Y(yt.layout_symbol["text-variable-anchor"]),"text-anchor":new ce(yt.layout_symbol["text-anchor"]),"text-max-angle":new Y(yt.layout_symbol["text-max-angle"]),"text-writing-mode":new Y(yt.layout_symbol["text-writing-mode"]),"text-rotate":new ce(yt.layout_symbol["text-rotate"]),"text-padding":new Y(yt.layout_symbol["text-padding"]),"text-keep-upright":new Y(yt.layout_symbol["text-keep-upright"]),"text-transform":new ce(yt.layout_symbol["text-transform"]),"text-offset":new ce(yt.layout_symbol["text-offset"]),"text-allow-overlap":new Y(yt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Y(yt.layout_symbol["text-ignore-placement"]),"text-optional":new Y(yt.layout_symbol["text-optional"])});var CT={paint:new Se({"icon-opacity":new ce(yt.paint_symbol["icon-opacity"]),"icon-color":new ce(yt.paint_symbol["icon-color"]),"icon-halo-color":new ce(yt.paint_symbol["icon-halo-color"]),"icon-halo-width":new ce(yt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ce(yt.paint_symbol["icon-halo-blur"]),"icon-translate":new Y(yt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Y(yt.paint_symbol["icon-translate-anchor"]),"text-opacity":new ce(yt.paint_symbol["text-opacity"]),"text-color":new ce(yt.paint_symbol["text-color"],{runtimeType:yo,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new ce(yt.paint_symbol["text-halo-color"]),"text-halo-width":new ce(yt.paint_symbol["text-halo-width"]),"text-halo-blur":new ce(yt.paint_symbol["text-halo-blur"]),"text-translate":new Y(yt.paint_symbol["text-translate"]),"text-translate-anchor":new Y(yt.paint_symbol["text-translate-anchor"])}),layout:xH};class cO{constructor(a){this.type=a.property.overrides?a.property.overrides.runtimeType:Ts,this.defaultValue=a}evaluate(a){if(a.formattedSection){const u=this.defaultValue.property.overrides;if(u&&u.hasOverride(a.formattedSection))return u.getOverride(a.formattedSection)}return a.feature&&a.featureState?this.defaultValue.evaluate(a.feature,a.featureState):this.defaultValue.property.specification.default}eachChild(a){this.defaultValue.isConstant()||a(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}dn(cO,"FormatSectionOverride",{omit:["defaultValue"]});class J1 extends ol{constructor(a){super(a,CT)}recalculate(a,u){super.recalculate(a,u),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const f=this.layout.get("text-writing-mode");if(f){const g=[];for(const b of f)g.indexOf(b)<0&&g.push(b);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(a,u,f,g){const b=this.layout.get(a).evaluate(u,{},f,g),E=this._unevaluatedLayout._values[a];return E.isDataDriven()||Ru(E.value)||!b?b:function(C,P){return P.replace(/{([^{}]+)}/g,(M,D)=>D in C?String(C[D]):"")}(u.properties,b)}createBucket(a){return new $u(a)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const a of CT.paint.overridableProperties){if(!J1.hasPaintOverride(this.layout,a))continue;const u=this.paint.get(a),f=new cO(u),g=new Wf(f,u.property.specification);let b=null;b=u.value.kind==="constant"||u.value.kind==="source"?new Pg("source",g):new nd("composite",g,u.value.zoomStops,u.value._interpolationType),this.paint._values[a]=new pe(u.property,b,u.parameters)}}_handleOverridablePaintPropertyUpdate(a,u,f){return!(!this.layout||u.isDataDriven()||f.isDataDriven())&&J1.hasPaintOverride(this.layout,a)}static hasPaintOverride(a,u){const f=a.get("text-field"),g=CT.paint.properties[u];let b=!1;const E=C=>{for(const P of C)if(g.overrides&&g.overrides.hasOverride(P))return void(b=!0)};if(f.value.kind==="constant"&&f.value.value instanceof xi)E(f.value.value.sections);else if(f.value.kind==="source"){const C=M=>{b||(M instanceof oa&&Ei(M.value)===Ya?E(M.value.sections):M instanceof qo?E(M.sections):M.eachChild(C))},P=f.value;P._styleExpression&&C(P._styleExpression.expression)}return b}getProgramConfiguration(a){return new zu(this,a)}}var wH={paint:new Se({"background-color":new Y(yt.paint_background["background-color"]),"background-pattern":new Y(yt.paint_background["background-pattern"]),"background-opacity":new Y(yt.paint_background["background-opacity"])})},EH={paint:new Se({"raster-opacity":new Y(yt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Y(yt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Y(yt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Y(yt.paint_raster["raster-brightness-max"]),"raster-saturation":new Y(yt.paint_raster["raster-saturation"]),"raster-contrast":new Y(yt.paint_raster["raster-contrast"]),"raster-resampling":new Y(yt.paint_raster["raster-resampling"]),"raster-fade-duration":new Y(yt.paint_raster["raster-fade-duration"])})};class TH extends ol{constructor(a){super(a,{}),this.implementation=a}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(a){this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)}onRemove(a){this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)}}var SH={paint:new Se({"sky-type":new Y(yt.paint_sky["sky-type"]),"sky-atmosphere-sun":new Y(yt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Y(yt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Y(yt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Y(yt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Ee(yt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Y(yt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Y(yt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Y(yt.paint_sky["sky-opacity"])})};function AT(c,a,u){const f=[0,0,1],g=PR([]);return MR(g,g,u?-be(c)+Math.PI:be(c)),IR(g,g,-be(a)),TR(f,f,g),rs(f,f)}const CH={circle:class extends ol{constructor(c){super(c,B$)}createBucket(c){return new QE(c)}queryRadius(c){const a=c;return lp("circle-radius",this,a)+lp("circle-stroke-width",this,a)+P1(this.paint.get("circle-translate"))}queryIntersectsFeature(c,a,u,f,g,b,E,C){const P=JR(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),b.angle,c.pixelToTileUnitsFactor),M=this.paint.get("circle-radius").evaluate(a,u)+this.paint.get("circle-stroke-width").evaluate(a,u);return QR(c,f,b,E,C,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",P,M)}getProgramIds(){return["circle"]}getProgramConfiguration(c){return new zu(this,c)}},heatmap:class extends ol{createBucket(c){return new tL(c)}constructor(c){super(c,V$),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=iT({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(c){return lp("heatmap-radius",this,c)}queryIntersectsFeature(c,a,u,f,g,b,E,C){const P=this.paint.get("heatmap-radius").evaluate(a,u);return QR(c,f,b,E,C,!0,!0,new J(0,0),P)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(c){return new zu(this,c)}},hillshade:class extends ol{constructor(c){super(c,j$)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends ol{constructor(c){super(c,rG)}getProgramIds(){const c=this.paint.get("fill-pattern"),a=c&&c.constantOr(1),u=[a?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&u.push(a&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),u}getProgramConfiguration(c){return new zu(this,c)}recalculate(c,a){super.recalculate(c,a);const u=this.paint._values["fill-outline-color"];u.value.kind==="constant"&&u.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new O1(c)}queryRadius(){return P1(this.paint.get("fill-translate"))}queryIntersectsFeature(c,a,u,f,g,b){return!c.queryGeometry.isAboveHorizon&&KR(YR(c.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),b.angle,c.pixelToTileUnitsFactor),f)}isTileClipped(){return!0}},"fill-extrusion":class extends ol{constructor(c){super(c,bG)}createBucket(c){return new cy(c)}queryRadius(){return P1(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(c){return new zu(this,c)}queryIntersectsFeature(c,a,u,f,g,b,E,C,P){const M=JR(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),b.angle,c.pixelToTileUnitsFactor),D=this.paint.get("fill-extrusion-height").evaluate(a,u),N=this.paint.get("fill-extrusion-base").evaluate(a,u),V=[0,0],H=C&&b.elevation,W=b.elevation?b.elevation.exaggeration():1,Q=c.tile.getBucket(this);if(H&&Q instanceof cy){const Ie=Q.centroidVertexArray,Fe=P+1;Fe<Ie.length&&(V[0]=Ie.geta_centroid_pos0(Fe),V[1]=Ie.geta_centroid_pos1(Fe))}if(V[0]===0&&V[1]===1)return!1;b.projection.name==="globe"&&(f=_L([f],[new J(0,0),new J(On,On)],c.tileID.canonical).map(Ie=>Ie.polygon).flat());const oe=H?C:null,[xe,Me]=function(Ie,Fe,De,lt,it,_t,Vt,ft,St,Ct,Dt){return Ie.projection.name==="globe"?function(Kt,vt,rn,yn,sn,oi,Zt,Rn,si,Ii,ai){const Nn=[],ar=[],hi=Kt.projection.upVectorScale(ai,Kt.center.lat,Kt.worldSize).metersToTile,di=[0,0,0,1],qi=[0,0,0,1],nr=(Yi,Tr,Lr,Yr)=>{Yi[0]=Tr,Yi[1]=Lr,Yi[2]=Yr,Yi[3]=1},ir=vL();rn>0&&(rn+=ir),yn+=ir;for(const Yi of vt){const Tr=[],Lr=[];for(const Yr of Yi){const Ji=Yr.x+sn.x,oo=Yr.y+sn.y,Jr=Kt.projection.projectTilePoint(Ji,oo,ai),Pr=Kt.projection.upVector(ai,Yr.x,Yr.y);let Di=rn,Qr=yn;if(Zt){const rr=EL(Ji,oo,rn,yn,Zt,Rn,si,Ii);Di+=rr.base,Qr+=rr.top}rn!==0?nr(di,Jr.x+Pr[0]*hi*Di,Jr.y+Pr[1]*hi*Di,Jr.z+Pr[2]*hi*Di):nr(di,Jr.x,Jr.y,Jr.z),nr(qi,Jr.x+Pr[0]*hi*Qr,Jr.y+Pr[1]*hi*Qr,Jr.z+Pr[2]*hi*Qr),zr(di,di,oi),zr(qi,qi,oi),Tr.push(new hp(di[0],di[1],di[2])),Lr.push(new hp(qi[0],qi[1],qi[2]))}Nn.push(Tr),ar.push(Lr)}return[Nn,ar]}(Ie,Fe,De,lt,it,_t,Vt,ft,St,Ct,Dt):Vt?function(Kt,vt,rn,yn,sn,oi,Zt,Rn,si){const Ii=[],ai=[],Nn=[0,0,0,1];for(const ar of Kt){const hi=[],di=[];for(const qi of ar){const nr=qi.x+yn.x,ir=qi.y+yn.y,Yi=EL(nr,ir,vt,rn,oi,Zt,Rn,si);Nn[0]=nr,Nn[1]=ir,Nn[2]=Yi.base,Nn[3]=1,pd(Nn,Nn,sn),Nn[3]=Math.max(Nn[3],1e-5);const Tr=new hp(Nn[0]/Nn[3],Nn[1]/Nn[3],Nn[2]/Nn[3]);Nn[0]=nr,Nn[1]=ir,Nn[2]=Yi.top,Nn[3]=1,pd(Nn,Nn,sn),Nn[3]=Math.max(Nn[3],1e-5);const Lr=new hp(Nn[0]/Nn[3],Nn[1]/Nn[3],Nn[2]/Nn[3]);hi.push(Tr),di.push(Lr)}Ii.push(hi),ai.push(di)}return[Ii,ai]}(Fe,De,lt,it,_t,Vt,ft,St,Ct):function(Kt,vt,rn,yn,sn){const oi=[],Zt=[],Rn=sn[8]*vt,si=sn[9]*vt,Ii=sn[10]*vt,ai=sn[11]*vt,Nn=sn[8]*rn,ar=sn[9]*rn,hi=sn[10]*rn,di=sn[11]*rn;for(const qi of Kt){const nr=[],ir=[];for(const Yi of qi){const Tr=Yi.x+yn.x,Lr=Yi.y+yn.y,Yr=sn[0]*Tr+sn[4]*Lr+sn[12],Ji=sn[1]*Tr+sn[5]*Lr+sn[13],oo=sn[2]*Tr+sn[6]*Lr+sn[14],Jr=sn[3]*Tr+sn[7]*Lr+sn[15],Pr=Yr+Rn,Di=Ji+si,Qr=oo+Ii,rr=Math.max(Jr+ai,1e-5),as=Yr+Nn,eo=Ji+ar,Oo=oo+hi,To=Math.max(Jr+di,1e-5);nr.push(new hp(Pr/rr,Di/rr,Qr/rr)),ir.push(new hp(as/To,eo/To,Oo/To))}oi.push(nr),Zt.push(ir)}return[oi,Zt]}(Fe,De,lt,it,_t)}(b,f,N,D,M,E,oe,V,W,b.center.lat,c.tileID.canonical),we=c.queryGeometry;return function(Ie,Fe,De){let lt=1/0;KR(De,Fe)&&(lt=wL(De,Fe[0]));for(let it=0;it<Fe.length;it++){const _t=Fe[it],Vt=Ie[it];for(let ft=0;ft<_t.length-1;ft++){const St=_t[ft],Ct=[St,_t[ft+1],Vt[ft+1],Vt[ft],St];WR(De,Ct)&&(lt=Math.min(lt,wL(De,Ct)))}}return lt!==1/0&&lt}(xe,Me,we.isPointQuery()?we.screenBounds:we.screenGeometry)}},line:class extends ol{constructor(c){super(c,TL),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(c){if(c==="line-gradient"){const a=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=a._styleExpression&&a._styleExpression.expression instanceof mg,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(c,a){super.recalculate(c,a),this.paint._values["line-floorwidth"]=SL.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new z1(c)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(c){return new zu(this,c)}queryRadius(c){const a=c,u=CL(lp("line-width",this,a),lp("line-gap-width",this,a)),f=lp("line-offset",this,a);return u/2+Math.abs(f)+P1(this.paint.get("line-translate"))}queryIntersectsFeature(c,a,u,f,g,b){if(c.queryGeometry.isAboveHorizon)return!1;const E=YR(c.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),b.angle,c.pixelToTileUnitsFactor),C=c.pixelToTileUnitsFactor/2*CL(this.paint.get("line-width").evaluate(a,u),this.paint.get("line-gap-width").evaluate(a,u)),P=this.paint.get("line-offset").evaluate(a,u);return P&&(f=function(M,D){const N=[],V=new J(0,0);for(let H=0;H<M.length;H++){const W=M[H],Q=[];for(let oe=0;oe<W.length;oe++){const xe=W[oe],Me=W[oe+1],we=oe===0?V:xe.sub(W[oe-1])._unit()._perp(),Ie=oe===W.length-1?V:Me.sub(xe)._unit()._perp(),Fe=we._add(Ie)._unit();Fe._mult(1/(Fe.x*Ie.x+Fe.y*Ie.y)),Q.push(Fe._mult(D)._add(xe))}N.push(Q)}return N}(f,P*c.pixelToTileUnitsFactor)),function(M,D,N){for(let V=0;V<D.length;V++){const H=D[V];if(M.length>=3){for(let W=0;W<H.length;W++)if(vd(M,H[W]))return!0}if(O$(M,H,N))return!0}return!1}(E,f,C)}isTileClipped(){return!0}},symbol:J1,background:class extends ol{constructor(c){super(c,wH)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends ol{constructor(c){super(c,EH)}getProgramIds(){return["raster"]}},sky:class extends ol{constructor(c){super(c,SH),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="sky-gradient"?this._updateColorRamp():c!=="sky-atmosphere-sun"&&c!=="sky-atmosphere-halo-color"&&c!=="sky-atmosphere-color"&&c!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=iT({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(c){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const a=c.style.light.properties.get("position");return this._lightPosition.azimuthal!==a.azimuthal||this._lightPosition.polar!==a.polar}return!1}getCenter(c,a){if(this.paint.get("sky-type")==="atmosphere"){const f=this.paint.get("sky-atmosphere-sun"),g=!f,b=c.style.light,E=b.properties.get("position");return g&&b.properties.get("anchor")==="viewport"&&tt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),g?AT(E.azimuthal,90-E.polar,a):AT(f[0],90-f[1],a)}const u=this.paint.get("sky-gradient-center");return AT(u[0],90-u[1],a)}is3D(){return!1}isSky(){return!0}markSkyboxValid(c){this._skyboxInvalidated=!1,this._lightPosition=c.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const c=this.paint.get("sky-type");return c==="atmosphere"?["skyboxCapture","skybox"]:c==="gradient"?["skyboxGradient"]:null}}};class by{constructor(a,u,f,g){this.context=a,this.format=f,this.texture=a.gl.createTexture(),this.update(u,g)}update(a,u,f){const{width:g,height:b}=a,{context:E}=this,{gl:C}=E,{HTMLImageElement:P,HTMLCanvasElement:M,HTMLVideoElement:D,ImageData:N,ImageBitmap:V}=d;if(C.bindTexture(C.TEXTURE_2D,this.texture),E.pixelStoreUnpackFlipY.set(!1),E.pixelStoreUnpack.set(1),E.pixelStoreUnpackPremultiplyAlpha.set(this.format===C.RGBA&&(!u||u.premultiply!==!1)),f||this.size&&this.size[0]===g&&this.size[1]===b){const{x:H,y:W}=f||{x:0,y:0};a instanceof P||a instanceof M||a instanceof D||a instanceof N||V&&a instanceof V?C.texSubImage2D(C.TEXTURE_2D,0,H,W,C.RGBA,C.UNSIGNED_BYTE,a):C.texSubImage2D(C.TEXTURE_2D,0,H,W,g,b,C.RGBA,C.UNSIGNED_BYTE,a.data)}else this.size=[g,b],a instanceof P||a instanceof M||a instanceof D||a instanceof N||V&&a instanceof V?C.texImage2D(C.TEXTURE_2D,0,this.format,this.format,C.UNSIGNED_BYTE,a):C.texImage2D(C.TEXTURE_2D,0,this.format,g,b,0,this.format,C.UNSIGNED_BYTE,a.data);this.useMipmap=!!(u&&u.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&C.generateMipmap(C.TEXTURE_2D)}bind(a,u){const{context:f}=this,{gl:g}=f;g.bindTexture(g.TEXTURE_2D,this.texture),a!==this.filter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,a),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,this.useMipmap?a===g.NEAREST?g.NEAREST_MIPMAP_NEAREST:g.LINEAR_MIPMAP_NEAREST:a),this.filter=a),u!==this.wrap&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,u),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,u),this.wrap=u)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:a}=this.context;a.deleteTexture(this.texture),this.texture=null}}class AH{constructor(a){this._callback=a,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class PH{constructor(){this.tasks={},this.taskQueue=[],Ke(["process"],this),this.invoker=new AH(this.process),this.nextId=0}add(a,u){const f=this.nextId++,g=function({type:b,isSymbolTile:E,zoom:C}){return C=C||0,b==="message"?0:b!=="maybePrepare"||E?b!=="parseTile"||E?b==="parseTile"&&E?300-C:b==="maybePrepare"&&E?400-C:500:200-C:100-C}(u);if(g===0){tn();try{a()}finally{}return{cancel:()=>{}}}return this.tasks[f]={fn:a,metadata:u,priority:g,id:f},this.taskQueue.push(f),this.invoker.trigger(),{cancel:()=>{delete this.tasks[f]}}}process(){tn();try{if(this.taskQueue=this.taskQueue.filter(f=>!!this.tasks[f]),!this.taskQueue.length)return;const a=this.pick();if(a===null)return;const u=this.tasks[a];if(delete this.tasks[a],this.taskQueue.length&&this.invoker.trigger(),!u)return;u.fn()}finally{}}pick(){let a=null,u=1/0;for(let g=0;g<this.taskQueue.length;g++){const b=this.tasks[this.taskQueue[g]];b.priority<u&&(u=b.priority,a=g)}if(a===null)return null;const f=this.taskQueue[a];return this.taskQueue.splice(a,1),f}remove(){this.invoker.remove()}}class uO{constructor(a){this._stringToNumber={},this._numberToString=[];for(let u=0;u<a.length;u++){const f=a[u];this._stringToNumber[f]=u,this._numberToString[u]=f}}encode(a){return this._stringToNumber[a]}decode(a){return this._numberToString[a]}}const IH=["tile","layer","source","sourceLayer","state"];class hO{constructor(a,u,f,g,b){this.type="Feature",this._vectorTileFeature=a,this._z=u,this._x=f,this._y=g,this.properties=a.properties,this.id=b}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(a){this._geometry=a}toJSON(){const a={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(a.id=this.id);for(const u of IH)this[u]!==void 0&&(a[u]=this[u]);return a}}const Da=32,Vl=33,Gu=new Uint16Array(8184);for(let c=0;c<2046;c++){let a=c+2,u=0,f=0,g=0,b=0,E=0,C=0;for(1&a?g=b=E=Da:u=f=C=Da;(a>>=1)>1;){const M=u+g>>1,D=f+b>>1;1&a?(g=u,b=f,u=E,f=C):(u=g,f=b,g=E,b=C),E=M,C=D}const P=4*c;Gu[P+0]=u,Gu[P+1]=f,Gu[P+2]=g,Gu[P+3]=b}const jl=new Uint16Array(2178),Hu=new Uint8Array(1089),Q1=new Uint16Array(1089);function dO(c){return c===0?-.03125:c===32?.03125:0}var fO=Xe([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const pO={type:2,extent:On,loadGeometry:()=>[[new J(0,0),new J(On+1,0),new J(On+1,On+1),new J(0,On+1),new J(0,0)]]};class PT{constructor(a,u,f,g,b){this.tileID=a,this.uid=Bn(),this.uses=0,this.tileSize=u,this.tileZoom=f,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=b,this.expiredRequestCount=0,this.state="loading",g&&g.transform&&(this.projection=g.transform.projection)}registerFadeDuration(a){const u=a+this.timeAdded;u<bo.now()||this.fadeEndTime&&u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=bd(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(a,u,f){if(this.unloadVectorData(),this.state="loaded",a){a.featureIndex&&(this.latestFeatureIndex=a.featureIndex,a.rawTileData?(this.latestRawTileData=a.rawTileData,this.latestFeatureIndex.rawTileData=a.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=a.collisionBoxArray,this.buckets=function(g,b){const E={};if(!b)return E;for(const C of g){const P=C.layerIds.map(M=>b.getLayer(M)).filter(Boolean);if(P.length!==0){C.layers=P,C.stateDependentLayerIds&&(C.stateDependentLayers=C.stateDependentLayerIds.map(M=>P.filter(D=>D.id===M)[0]));for(const M of P)E[M.id]=C}}return E}(a.buckets,u.style),this.hasSymbolBuckets=!1;for(const g in this.buckets){const b=this.buckets[g];if(b instanceof $u){if(this.hasSymbolBuckets=!0,!f)break;b.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const g in this.buckets){const b=this.buckets[g];if(b instanceof $u&&b.hasRTLText){this.hasRTLText=!0,O.isLoading()||O.isLoaded()||A()!=="deferred"||R();break}}this.queryPadding=0;for(const g in this.buckets){const b=this.buckets[g];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(g).queryRadius(b))}a.imageAtlas&&(this.imageAtlas=a.imageAtlas),a.glyphAtlasImage&&(this.glyphAtlasImage=a.glyphAtlasImage),a.lineAtlas&&(this.lineAtlas=a.lineAtlas)}else this.collisionBoxArray=new Xi}unloadVectorData(){if(this.hasData()){for(const a in this.buckets)this.buckets[a].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(a){return this.buckets[a.id]}upload(a){for(const f in this.buckets){const g=this.buckets[f];g.uploadPending()&&g.upload(a)}const u=a.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new by(a,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new by(a,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new by(a,this.lineAtlas.image,u.ALPHA),this.lineAtlas.uploaded=!0)}prepare(a){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(a,this.imageAtlasTexture)}queryRenderedFeatures(a,u,f,g,b,E,C,P){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:g,pixelPosMatrix:C,transform:E,params:b,tileTransform:this.tileTransform},a,u,f):{}}querySourceFeatures(a,u){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const g=f.loadVTLayers(),b=u?u.sourceLayer:"",E=g._geojsonTileLayer||g[b];if(!E)return;const C=qf(u&&u.filter),{z:P,x:M,y:D}=this.tileID.canonical,N={z:P,x:M,y:D};for(let V=0;V<E.length;V++){const H=E.feature(V);if(C.needGeometry){const oe=yd(H,!0);if(!C.filter(new z(this.tileID.overscaledZ),oe,this.tileID.canonical))continue}else if(!C.filter(new z(this.tileID.overscaledZ),H))continue;const W=f.getId(H,b),Q=new hO(H,P,M,D,W);Q.tile=N,a.push(Q)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(a){const u=this.expirationTime;if(a.cacheControl){const f=Wt(a.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else a.expires&&(this.expirationTime=new Date(a.expires).getTime());if(this.expirationTime){const f=Date.now();let g=!1;if(this.expirationTime>f)g=!1;else if(u)if(this.expirationTime<u)g=!0;else{const b=this.expirationTime-u;b?this.expirationTime=f+Math.max(b,3e4):g=!0}else g=!0;g?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(a,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(a).length===0||!u)return;const f=this.latestFeatureIndex.loadVTLayers(),g=u.style.listImages();for(const b in this.buckets){if(!u.style.hasLayer(b))continue;const E=this.buckets[b],C=E.layers[0].sourceLayer||"_geojsonTileLayer",P=f[C],M=a[C];if(!P||!M||Object.keys(M).length===0)continue;if(E.update(M,P,g,this.imageAtlas&&this.imageAtlas.patternPositions||{}),E instanceof z1||E instanceof O1){const N=u.style._getSourceCache(E.layers[0].source);u._terrain&&u._terrain.enabled&&N&&E.programConfigurations.needsUpload&&u._terrain._clearRenderCacheForTile(N.id,this.tileID)}const D=u&&u.style&&u.style.getLayer(b);D&&(this.queryPadding=Math.max(this.queryPadding,D.queryRadius(E)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<bo.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(a){this.symbolFadeHoldUntil=bo.now()+a}setTexture(a,u){const f=u.context,g=f.gl;this.texture=this.texture||u.getTileTexture(a.width),this.texture?this.texture.update(a,{useMipmap:!0}):(this.texture=new by(f,a,g.RGBA,{useMipmap:!0}),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE))}setDependencies(a,u){const f={};for(const g of u)f[g]=!0;this.dependencies[a]=f}hasDependency(a,u){for(const f of a){const g=this.dependencies[f];if(g){for(const b of u)if(g[b])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(a,u){if(!u||u.name==="mercator"||this._tileDebugBuffer)return;const f=Mc(pO,this.tileID.canonical,this.tileTransform)[0],g=new Ut,b=new Ns;for(let E=0;E<f.length;E++){const{x:C,y:P}=f[E];g.emplaceBack(C,P),b.emplaceBack(E)}b.emplaceBack(0),this._tileDebugIndexBuffer=a.createIndexBuffer(b),this._tileDebugBuffer=a.createVertexBuffer(g,Jg.members),this._tileDebugSegments=Zr.simpleSegment(0,0,g.length,b.length)}_makeTileBoundsBuffers(a,u){if(this._tileBoundsBuffer||!u||u.name==="mercator")return;const f=Mc(pO,this.tileID.canonical,this.tileTransform)[0];let g,b;if(this.isRaster){const E=function(C,P){const M=bd(C,P),D=Math.pow(2,C.z);for(let oe=0;oe<Vl;oe++)for(let xe=0;xe<Vl;xe++){const Me=ca((C.x+(xe+dO(xe))/Da)/D),we=jo((C.y+(oe+dO(oe))/Da)/D),Ie=P.project(Me,we),Fe=oe*Vl+xe;jl[2*Fe+0]=Math.round((Ie.x*M.scale-M.x)*On),jl[2*Fe+1]=Math.round((Ie.y*M.scale-M.y)*On)}Hu.fill(0),Q1.fill(0);for(let oe=2045;oe>=0;oe--){const xe=4*oe,Me=Gu[xe+0],we=Gu[xe+1],Ie=Gu[xe+2],Fe=Gu[xe+3],De=Me+Ie>>1,lt=we+Fe>>1,it=De+lt-we,_t=lt+Me-De,Vt=we*Vl+Me,ft=Fe*Vl+Ie,St=lt*Vl+De,Ct=Math.hypot((jl[2*Vt+0]+jl[2*ft+0])/2-jl[2*St+0],(jl[2*Vt+1]+jl[2*ft+1])/2-jl[2*St+1])>=16;Hu[St]=Hu[St]||(Ct?1:0),oe<1022&&(Hu[St]=Hu[St]||Hu[(we+_t>>1)*Vl+(Me+it>>1)]||Hu[(Fe+_t>>1)*Vl+(Ie+it>>1)])}const N=new wt,V=new Sn;let H=0;function W(oe,xe){const Me=xe*Vl+oe;return Q1[Me]===0&&(N.emplaceBack(jl[2*Me+0],jl[2*Me+1],oe*On/Da,xe*On/Da),Q1[Me]=++H),Q1[Me]-1}function Q(oe,xe,Me,we,Ie,Fe){const De=oe+Me>>1,lt=xe+we>>1;if(Math.abs(oe-Ie)+Math.abs(xe-Fe)>1&&Hu[lt*Vl+De])Q(Ie,Fe,oe,xe,De,lt),Q(Me,we,Ie,Fe,De,lt);else{const it=W(oe,xe),_t=W(Me,we),Vt=W(Ie,Fe);V.emplaceBack(it,_t,Vt)}}return Q(0,0,Da,Da,Da,0),Q(Da,Da,0,0,0,Da),{vertices:N,indices:V}}(this.tileID.canonical,u);g=E.vertices,b=E.indices}else{g=new wt,b=new Sn;for(const{x:C,y:P}of f)g.emplaceBack(C,P,0,0);const E=lT(g.int16,void 0,4);for(let C=0;C<E.length;C+=3)b.emplaceBack(E[C],E[C+1],E[C+2])}this._tileBoundsBuffer=a.createVertexBuffer(g,fO.members),this._tileBoundsIndexBuffer=a.createIndexBuffer(b),this._tileBoundsSegments=Zr.simpleSegment(0,0,g.length,b.length)}_makeGlobeTileDebugBuffers(a,u){const f=u.projection;if(!f||f.name!=="globe"||u.freezeTileCoverage)return;const g=this.tileID.canonical,b=ty(kR(g,u)),E=sp(u.zoom);let C;E>0&&(C=FE(new Float64Array(16),u.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(a,g,u,b,C,E),this._makeGlobeTileDebugTextBuffer(a,g,u,b,C,E)}_globePoint(a,u,f,g,b,E,C){let P=ey(a,u,f);if(E){const M=1<<f.z,D=Nl(g.center.lng),N=Ul(g.center.lat),V=(f.x+.5)/M-D;let H=0;V>.5?H=-1:V<-.5&&(H=1);let W=(a/On+f.x)/M+H,Q=(u/On+f.y)/M;W=(W-D)*g._pixelsPerMercatorPixel+D,Q=(Q-N)*g._pixelsPerMercatorPixel+N;const oe=[W*g.worldSize,Q*g.worldSize,0];zr(oe,oe,E),P=gd(P,oe,C)}return zr(P,P,b)}_makeGlobeTileDebugBorderBuffer(a,u,f,g,b,E){const C=new Ut,P=new Ns,M=new nt,D=(V,H,W,Q,oe)=>{const xe=(W-V)/(oe-1),Me=(Q-H)/(oe-1),we=C.length;for(let Ie=0;Ie<oe;Ie++){const Fe=V+Ie*xe,De=H+Ie*Me;C.emplaceBack(Fe,De);const lt=this._globePoint(Fe,De,u,f,g,b,E);M.emplaceBack(lt[0],lt[1],lt[2]),P.emplaceBack(we+Ie)}},N=On;D(0,0,N,0,16),D(N,0,N,N,16),D(N,N,0,N,16),D(0,N,0,0,16),this._tileDebugIndexBuffer=a.createIndexBuffer(P),this._tileDebugBuffer=a.createVertexBuffer(C,Jg.members),this._globeTileDebugBorderBuffer=a.createVertexBuffer(M,LR.members),this._tileDebugSegments=Zr.simpleSegment(0,0,C.length,P.length)}_makeGlobeTileDebugTextBuffer(a,u,f,g,b,E){const C=On/4,P=new Ut,M=new Sn,D=new nt,N=25;M.reserve(32),P.reserve(N),D.reserve(N);const V=(H,W)=>N*H+W;for(let H=0;H<N;H++){const W=H*C;for(let Q=0;Q<N;Q++){const oe=Q*C;P.emplaceBack(oe,W);const xe=this._globePoint(oe,W,u,f,g,b,E);D.emplaceBack(xe[0],xe[1],xe[2])}}for(let H=0;H<4;H++)for(let W=0;W<4;W++){const Q=V(H,W),oe=V(H,W+1),xe=V(H+1,W),Me=V(H+1,W+1);M.emplaceBack(Q,oe,xe),M.emplaceBack(xe,oe,Me)}this._tileDebugTextIndexBuffer=a.createIndexBuffer(M),this._tileDebugTextBuffer=a.createVertexBuffer(P,Jg.members),this._globeTileDebugTextBuffer=a.createVertexBuffer(D,LR.members),this._tileDebugTextSegments=Zr.simpleSegment(0,0,N,32)}}class MH{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(a,u,f){const g=String(u);if(this.stateChanges[a]=this.stateChanges[a]||{},this.stateChanges[a][g]=this.stateChanges[a][g]||{},An(this.stateChanges[a][g],f),this.deletedStates[a]===null){this.deletedStates[a]={};for(const b in this.state[a])b!==g&&(this.deletedStates[a][b]=null)}else if(this.deletedStates[a]&&this.deletedStates[a][g]===null){this.deletedStates[a][g]={};for(const b in this.state[a][g])f[b]||(this.deletedStates[a][g][b]=null)}else for(const b in f)this.deletedStates[a]&&this.deletedStates[a][g]&&this.deletedStates[a][g][b]===null&&delete this.deletedStates[a][g][b]}removeFeatureState(a,u,f){if(this.deletedStates[a]===null)return;const g=String(u);if(this.deletedStates[a]=this.deletedStates[a]||{},f&&u!==void 0)this.deletedStates[a][g]!==null&&(this.deletedStates[a][g]=this.deletedStates[a][g]||{},this.deletedStates[a][g][f]=null);else if(u!==void 0)if(this.stateChanges[a]&&this.stateChanges[a][g])for(f in this.deletedStates[a][g]={},this.stateChanges[a][g])this.deletedStates[a][g][f]=null;else this.deletedStates[a][g]=null;else this.deletedStates[a]=null}getState(a,u){const f=String(u),g=An({},(this.state[a]||{})[f],(this.stateChanges[a]||{})[f]);if(this.deletedStates[a]===null)return{};if(this.deletedStates[a]){const b=this.deletedStates[a][u];if(b===null)return{};for(const E in b)delete g[E]}return g}initializeTileState(a,u){a.setFeatureState(this.state,u)}coalesceChanges(a,u){const f={};for(const g in this.stateChanges){this.state[g]=this.state[g]||{};const b={};for(const E in this.stateChanges[g])this.state[g][E]||(this.state[g][E]={}),An(this.state[g][E],this.stateChanges[g][E]),b[E]=this.state[g][E];f[g]=b}for(const g in this.deletedStates){this.state[g]=this.state[g]||{};const b={};if(this.deletedStates[g]===null)for(const E in this.state[g])b[E]={},this.state[g][E]={};else for(const E in this.deletedStates[g]){if(this.deletedStates[g][E]===null)this.state[g][E]={};else if(this.state[g][E])for(const C of Object.keys(this.deletedStates[g][E]))delete this.state[g][E][C];b[E]=this.state[g][E]}f[g]=f[g]||{},An(f[g],b)}if(this.stateChanges={},this.deletedStates={},Object.keys(f).length!==0)for(const g in a)a[g].setFeatureState(f,u)}}class mO{constructor(a){this.size=a,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(a,u){const f=this.toIdx(a,u);return{min:this.minimums[f],max:this.maximums[f]}}isLeaf(a,u){return this.leaves[this.toIdx(a,u)]}toIdx(a,u){return u*this.size+a}}function gO(c,a,u,f){let g=0,b=Number.MAX_VALUE;for(let E=0;E<3;E++)if(Math.abs(f[E])<1e-15){if(u[E]<c[E]||u[E]>a[E])return null}else{const C=1/f[E];let P=(c[E]-u[E])*C,M=(a[E]-u[E])*C;if(P>M){const D=P;P=M,M=D}if(P>g&&(g=P),M<b&&(b=M),g>b)return null}return g}function yO(c,a,u,f,g,b,E,C,P,M,D){const N=f-c,V=g-a,H=b-u,W=E-c,Q=C-a,oe=P-u,xe=D[1]*oe-D[2]*Q,Me=D[2]*W-D[0]*oe,we=D[0]*Q-D[1]*W,Ie=N*xe+V*Me+H*we;if(Math.abs(Ie)<1e-15)return null;const Fe=1/Ie,De=M[0]-c,lt=M[1]-a,it=M[2]-u,_t=(De*xe+lt*Me+it*we)*Fe;if(_t<0||_t>1)return null;const Vt=lt*H-it*V,ft=it*N-De*H,St=De*V-lt*N,Ct=(D[0]*Vt+D[1]*ft+D[2]*St)*Fe;return Ct<0||_t+Ct>1?null:(W*Vt+Q*ft+oe*St)*Fe}function vO(c,a,u){return(c-a)/(u-a)}function _O(c,a,u,f,g,b,E,C,P){const M=1<<u,D=b-f,N=E-g,V=(c+1)/M*D+f,H=(a+0)/M*N+g,W=(a+1)/M*N+g;C[0]=(c+0)/M*D+f,C[1]=H,P[0]=V,P[1]=W}class bO{constructor(a){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=a,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const u=function(b){const E=Math.ceil(Math.log2(b.dim/8)),C=[];let P=Math.ceil(Math.pow(2,E));const M=1/P,D=(H,W,Q,oe,xe)=>{const Me=oe?1:0,we=(H+1)*Q-Me,Ie=W*Q,Fe=(W+1)*Q-Me;xe[0]=H*Q,xe[1]=Ie,xe[2]=we,xe[3]=Fe};let N=new mO(P);const V=[];for(let H=0;H<P*P;H++){D(H%P,Math.floor(H/P),M,!1,V);const W=Wu(V[0],V[1],b),Q=Wu(V[2],V[1],b),oe=Wu(V[2],V[3],b),xe=Wu(V[0],V[3],b);N.minimums.push(Math.min(W,Q,oe,xe)),N.maximums.push(Math.max(W,Q,oe,xe)),N.leaves.push(1)}for(C.push(N),P/=2;P>=1;P/=2){const H=C[C.length-1];N=new mO(P);for(let W=0;W<P*P;W++){D(W%P,Math.floor(W/P),2,!0,V);const Q=H.getElevation(V[0],V[1]),oe=H.getElevation(V[2],V[1]),xe=H.getElevation(V[2],V[3]),Me=H.getElevation(V[0],V[3]),we=H.isLeaf(V[0],V[1]),Ie=H.isLeaf(V[2],V[1]),Fe=H.isLeaf(V[2],V[3]),De=H.isLeaf(V[0],V[3]),lt=Math.min(Q.min,oe.min,xe.min,Me.min),it=Math.max(Q.max,oe.max,xe.max,Me.max),_t=we&&Ie&&Fe&&De;N.maximums.push(it),N.minimums.push(lt),N.leaves.push(it-lt<=5&&_t?1:0)}C.push(N)}return C}(this.dem),f=u.length-1,g=u[f];this._addNode(g.minimums[0],g.maximums[0],g.leaves[0]),this._construct(u,0,0,f,0)}raycastRoot(a,u,f,g,b,E,C=1){return gO([a,u,-100],[f,g,this.maximums[0]*C],b,E)}raycast(a,u,f,g,b,E,C=1){if(!this.nodeCount)return null;const P=this.raycastRoot(a,u,f,g,b,E,C);if(P==null)return null;const M=[],D=[],N=[],V=[],H=[{idx:0,t:P,nodex:0,nodey:0,depth:0}];for(;H.length>0;){const{idx:W,t:Q,nodex:oe,nodey:xe,depth:Me}=H.pop();if(this.leaves[W]){_O(oe,xe,Me,a,u,f,g,N,V);const Ie=1<<Me,Fe=(oe+0)/Ie,De=(oe+1)/Ie,lt=(xe+0)/Ie,it=(xe+1)/Ie,_t=Wu(Fe,lt,this.dem)*C,Vt=Wu(De,lt,this.dem)*C,ft=Wu(De,it,this.dem)*C,St=Wu(Fe,it,this.dem)*C,Ct=yO(N[0],N[1],_t,V[0],N[1],Vt,V[0],V[1],ft,b,E),Dt=yO(V[0],V[1],ft,N[0],V[1],St,N[0],N[1],_t,b,E),Kt=Math.min(Ct!==null?Ct:Number.MAX_VALUE,Dt!==null?Dt:Number.MAX_VALUE);if(Kt!==Number.MAX_VALUE)return Kt;{const vt=qg([],b,E,Q);if(xO(_t,Vt,St,ft,vO(vt[0],N[0],V[0]),vO(vt[1],N[1],V[1]))>=vt[2])return Q}continue}let we=0;for(let Ie=0;Ie<this._siblingOffset.length;Ie++){_O((oe<<1)+this._siblingOffset[Ie][0],(xe<<1)+this._siblingOffset[Ie][1],Me+1,a,u,f,g,N,V),N[2]=-100,V[2]=this.maximums[this.childOffsets[W]+Ie]*C;const Fe=gO(N,V,b,E);if(Fe!=null){const De=Fe;M[Ie]=De;let lt=!1;for(let it=0;it<we&&!lt;it++)De>=M[D[it]]&&(D.splice(it,0,Ie),lt=!0);lt||(D[we]=Ie),we++}}for(let Ie=0;Ie<we;Ie++){const Fe=D[Ie];H.push({idx:this.childOffsets[W]+Fe,t:M[Fe],nodex:(oe<<1)+this._siblingOffset[Fe][0],nodey:(xe<<1)+this._siblingOffset[Fe][1],depth:Me+1})}}return null}_addNode(a,u,f){return this.minimums.push(a),this.maximums.push(u),this.leaves.push(f),this.childOffsets.push(0),this.nodeCount++}_construct(a,u,f,g,b){if(a[g].isLeaf(u,f)===1)return;this.childOffsets[b]||(this.childOffsets[b]=this.nodeCount);const E=g-1,C=a[E];let P=0,M=0;for(let D=0;D<this._siblingOffset.length;D++){const N=2*u+this._siblingOffset[D][0],V=2*f+this._siblingOffset[D][1],H=C.getElevation(N,V),W=C.isLeaf(N,V),Q=this._addNode(H.min,H.max,W);W&&(P|=1<<D),M||(M=Q)}for(let D=0;D<this._siblingOffset.length;D++)P&1<<D||this._construct(a,2*u+this._siblingOffset[D][0],2*f+this._siblingOffset[D][1],E,M+D)}}function xO(c,a,u,f,g,b){return Ci(Ci(c,u,b),Ci(a,f,b),g)}function Wu(c,a,u){const f=u.dim,g=bt(c*f-.5,0,f-1),b=bt(a*f-.5,0,f-1),E=Math.floor(g),C=Math.floor(b),P=Math.min(E+1,f-1),M=Math.min(C+1,f-1);return xO(u.get(E,C),u.get(P,C),u.get(E,M),u.get(P,M),g-E,b-C)}const wO={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function RH(c,a,u){return(256*c*256+256*a+u)/10-1e4}function LH(c,a,u){return 256*c+a+u/256-32768}class eb{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(a,u,f,g=!1,b=!1){if(this.uid=a,u.height!==u.width)throw new RangeError("DEM tiles must be square");if(f&&f!=="mapbox"&&f!=="terrarium")return tt(`"${f}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=u.height;const E=this.dim=u.height-2,C=new Uint32Array(u.data.buffer);if(this.pixels=new Uint8Array(u.data.buffer),this.encoding=f||"mapbox",this.borderReady=g,!g){for(let P=0;P<E;P++)C[this._idx(-1,P)]=C[this._idx(0,P)],C[this._idx(E,P)]=C[this._idx(E-1,P)],C[this._idx(P,-1)]=C[this._idx(P,0)],C[this._idx(P,E)]=C[this._idx(P,E-1)];C[this._idx(-1,-1)]=C[this._idx(0,0)],C[this._idx(E,-1)]=C[this._idx(E-1,0)],C[this._idx(-1,E)]=C[this._idx(0,E-1)],C[this._idx(E,E)]=C[this._idx(E-1,E-1)],b&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new bO(this)}get(a,u,f=!1){f&&(a=bt(a,-1,this.dim),u=bt(u,-1,this.dim));const g=4*this._idx(a,u);return(this.encoding==="terrarium"?LH:RH)(this.pixels[g],this.pixels[g+1],this.pixels[g+2])}static getUnpackVector(a){return wO[a]}get unpackVector(){return wO[this.encoding]}_idx(a,u){if(a<-1||a>=this.dim+1||u<-1||u>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(u+1)*this.stride+(a+1)}static pack(a,u){const f=[0,0,0,0],g=eb.getUnpackVector(u);let b=Math.floor((a+g[3])/g[2]);return f[2]=b%256,b=Math.floor(b/256),f[1]=b%256,b=Math.floor(b/256),f[0]=b,f}getPixels(){return new Vs({width:this.stride,height:this.stride},this.pixels)}backfillBorder(a,u,f){if(this.dim!==a.dim)throw new Error("dem dimension mismatch");let g=u*this.dim,b=u*this.dim+this.dim,E=f*this.dim,C=f*this.dim+this.dim;switch(u){case-1:g=b-1;break;case 1:b=g+1}switch(f){case-1:E=C-1;break;case 1:C=E+1}const P=-u*this.dim,M=-f*this.dim;for(let D=E;D<C;D++)for(let N=g;N<b;N++){const V=4*this._idx(N,D),H=4*this._idx(N+P,D+M);this.pixels[V+0]=a.pixels[H+0],this.pixels[V+1]=a.pixels[H+1],this.pixels[V+2]=a.pixels[H+2],this.pixels[V+3]=a.pixels[H+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}dn(eb,"DEMData"),dn(bO,"DemMinMaxQuadTree",{omit:["dem"]});class OH{constructor(a,u){this.max=a,this.onRemove=u,this.reset()}reset(){for(const a in this.data)for(const u of this.data[a])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(a,u,f){const g=a.wrapped().key;this.data[g]===void 0&&(this.data[g]=[]);const b={value:u,timeout:void 0};if(f!==void 0&&(b.timeout=setTimeout(()=>{this.remove(a,b)},f)),this.data[g].push(b),this.order.push(g),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(a){return a.wrapped().key in this.data}getAndRemove(a){return this.has(a)?this._getAndRemoveByKey(a.wrapped().key):null}_getAndRemoveByKey(a){const u=this.data[a].shift();return u.timeout&&clearTimeout(u.timeout),this.data[a].length===0&&delete this.data[a],this.order.splice(this.order.indexOf(a),1),u.value}getByKey(a){const u=this.data[a];return u?u[0].value:null}get(a){return this.has(a)?this.data[a.wrapped().key][0].value:null}remove(a,u){if(!this.has(a))return this;const f=a.wrapped().key,g=u===void 0?0:this.data[f].indexOf(u),b=this.data[f][g];return this.data[f].splice(g,1),b.timeout&&clearTimeout(b.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(b.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(a){for(this.max=a;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(a){const u=[];for(const f in this.data)for(const g of this.data[f])a(g.value)||u.push(g);for(const f of u)this.remove(f.value.tileID,f)}}class xp{constructor(a,u,f){this.func=a,this.mask=u,this.range=f}}xp.ReadOnly=!1,xp.ReadWrite=!0,xp.disabled=new xp(519,xp.ReadOnly,[0,1]);const IT=7680;class MT{constructor(a,u,f,g,b,E){this.test=a,this.ref=u,this.mask=f,this.fail=g,this.depthFail=b,this.pass=E}}MT.disabled=new MT({func:519,mask:0},0,0,IT,IT,IT);class $l{constructor(a,u,f){this.blendFunction=a,this.blendColor=u,this.mask=f}}$l.Replace=[1,0],$l.disabled=new $l($l.Replace,on.transparent,[!1,!1,!1,!1]),$l.unblended=new $l($l.Replace,on.transparent,[!0,!0,!0,!0]),$l.alphaBlended=new $l([1,771],on.transparent,[!0,!0,!0,!0]);const RT=1029,LT=2305;class hl{constructor(a,u,f){this.enable=a,this.mode=u,this.frontFace=f}}hl.disabled=new hl(!1,RT,LT),hl.backCCW=new hl(!0,RT,LT),hl.backCW=new hl(!0,RT,2304),hl.frontCW=new hl(!0,1028,2304),hl.frontCCW=new hl(!0,1028,LT);class xd extends Mo{constructor(a,u,f){super(),this.id=a,this._onlySymbols=f,u.on("data",g=>{g.dataType==="source"&&g.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&g.dataType==="source"&&g.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),u.on("error",()=>{this._sourceErrored=!0}),this._source=u,this._tiles={},this._cache=new OH(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=u.minTileCacheSize,this._maxTileCacheSize=u.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new MH,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(a){this.map=a,this._minTileCacheSize=this._minTileCacheSize===void 0&&a?a._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&a?a._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const a in this._tiles){const u=this._tiles[a];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const a=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,a&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(a,u){return a.isSymbolTile=this._onlySymbols,this._source.loadTile(a,u)}_unloadTile(a){if(this._source.unloadTile)return this._source.unloadTile(a,()=>{})}_abortTile(a){if(this._source.abortTile)return this._source.abortTile(a,()=>{})}serialize(){return this._source.serialize()}prepare(a){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const f=this._tiles[u];f.upload(a),f.prepare(this.map.style.imageManager)}}getIds(){return xn(this._tiles).map(a=>a.tileID).sort(EO).map(a=>a.key)}getRenderableIds(a){const u=[];for(const f in this._tiles)this._isIdRenderable(+f,a)&&u.push(this._tiles[f]);return a?u.sort((f,g)=>{const b=f.tileID,E=g.tileID,C=new J(b.canonical.x,b.canonical.y)._rotate(this.transform.angle),P=new J(E.canonical.x,E.canonical.y)._rotate(this.transform.angle);return b.overscaledZ-E.overscaledZ||P.y-C.y||P.x-C.x}).map(f=>f.tileID.key):u.map(f=>f.tileID).sort(EO).map(f=>f.key)}hasRenderableParent(a){const u=this.findLoadedParent(a,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(a,u){return this._tiles[a]&&this._tiles[a].hasData()&&!this._coveredTiles[a]&&(u||!this._tiles[a].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const a in this._tiles)this._tiles[a].state!=="errored"&&this._reloadTile(+a,"reloading")}}_reloadTile(a,u){const f=this._tiles[a];f&&(f.state!=="loading"&&(f.state=u),this._loadTile(f,this._tileLoaded.bind(this,f,a,u)))}_tileLoaded(a,u,f,g){if(g)if(a.state="errored",g.status!==404)this._source.fire(new Br(g,{tile:a}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const b=this.map.painter.terrain;this.update(this.transform,b.getScaledDemTileSize(),!0),b.resetTileLookupCache(this.id)}else this.update(this.transform);else a.timeAdded=bo.now(),f==="expired"&&(a.refreshedUponExpiration=!0),this._setTileReloadTimer(u,a),this._source.type==="raster-dem"&&a.dem&&this._backfillDEM(a),this._state.initializeTileState(a,this.map?this.map.painter:null),this._source.fire(new Zo("data",{dataType:"source",tile:a,coord:a.tileID,sourceCacheId:this.id}))}_backfillDEM(a){const u=this.getRenderableIds();for(let g=0;g<u.length;g++){const b=u[g];if(a.neighboringTiles&&a.neighboringTiles[b]){const E=this.getTileByID(b);f(a,E),f(E,a)}}function f(g,b){if(!g.dem||g.dem.borderReady)return;g.needsHillshadePrepare=!0,g.needsDEMTextureUpload=!0;let E=b.tileID.canonical.x-g.tileID.canonical.x;const C=b.tileID.canonical.y-g.tileID.canonical.y,P=Math.pow(2,g.tileID.canonical.z),M=b.tileID.key;E===0&&C===0||Math.abs(C)>1||(Math.abs(E)>1&&(Math.abs(E+P)===1?E+=P:Math.abs(E-P)===1&&(E-=P)),b.dem&&g.dem&&(g.dem.backfillBorder(b.dem,E,C),g.neighboringTiles&&g.neighboringTiles[M]&&(g.neighboringTiles[M].backfilled=!0)))}}getTile(a){return this.getTileByID(a.key)}getTileByID(a){return this._tiles[a]}_retainLoadedChildren(a,u,f,g){for(const b in this._tiles){let E=this._tiles[b];if(g[b]||!E.hasData()||E.tileID.overscaledZ<=u||E.tileID.overscaledZ>f)continue;let C=E.tileID;for(;E&&E.tileID.overscaledZ>u+1;){const M=E.tileID.scaledTo(E.tileID.overscaledZ-1);E=this._tiles[M.key],E&&E.hasData()&&(C=M)}let P=C;for(;P.overscaledZ>u;)if(P=P.scaledTo(P.overscaledZ-1),a[P.key]){g[C.key]=C;break}}}findLoadedParent(a,u){if(a.key in this._loadedParentTiles){const f=this._loadedParentTiles[a.key];return f&&f.tileID.overscaledZ>=u?f:null}for(let f=a.overscaledZ-1;f>=u;f--){const g=a.scaledTo(f),b=this._getLoadedTile(g);if(b)return b}}_getLoadedTile(a){const u=this._tiles[a.key];return u&&u.hasData()?u:this._cache.getByKey(this._source.reparseOverscaled?a.wrapped().key:a.canonical.key)}updateCacheSize(a,u){u=u||this._source.tileSize;const f=Math.ceil(a.width/u)+1,g=Math.ceil(a.height/u)+1,b=Math.floor(f*g*5),E=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,b):b,C=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,E):E;this._cache.setMaxSize(C)}handleWrapJump(a){const u=Math.round((a-(this._prevLng===void 0?a:this._prevLng))/360);if(this._prevLng=a,u){const f={};for(const g in this._tiles){const b=this._tiles[g];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+u),f[b.tileID.key]=b}this._tiles=f;for(const g in this._timers)clearTimeout(this._timers[g]),delete this._timers[g];for(const g in this._tiles)this._setTileReloadTimer(+g,this._tiles[g])}}update(a,u,f){if(this.transform=a,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!f)return;let g;this.updateCacheSize(a,u),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?g=a.getVisibleUnwrappedCoordinates(this._source.tileID).map(C=>new ss(C.canonical.z,C.wrap,C.canonical.z,C.canonical.x,C.canonical.y)):(g=a.coveringTiles({tileSize:u||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!f,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(g=g.filter(C=>this._source.hasTile(C)))):g=[];const b=this._updateRetainedTiles(g);if(TO(this._source.type)&&g.length!==0){const C={},P={},M=Object.keys(b);for(const N of M){const V=b[N],H=this._tiles[N];if(!H||H.fadeEndTime&&H.fadeEndTime<=bo.now())continue;const W=this.findLoadedParent(V,Math.max(V.overscaledZ-xd.maxOverzooming,this._source.minzoom));W&&(this._addTile(W.tileID),C[W.tileID.key]=W.tileID),P[N]=V}const D=g[g.length-1].overscaledZ;for(const N in this._tiles){const V=this._tiles[N];if(b[N]||!V.hasData())continue;let H=V.tileID;for(;H.overscaledZ>D;){H=H.scaledTo(H.overscaledZ-1);const W=this._tiles[H.key];if(W&&W.hasData()&&P[H.key]){b[N]=V.tileID;break}}}for(const N in C)b[N]||(this._coveredTiles[N]=!0,b[N]=C[N])}for(const C in b)this._tiles[C].clearFadeHold();const E=function(C,P){const M=[];for(const D in C)D in P||M.push(D);return M}(this._tiles,b);for(const C of E){const P=this._tiles[C];P.hasSymbolBuckets&&!P.holdingForFade()?P.setHoldDuration(this.map._fadeDuration):P.hasSymbolBuckets&&!P.symbolFadeFinished()||this._removeTile(+C)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const a in this._tiles)this._tiles[a].holdingForFade()&&this._removeTile(+a)}_updateRetainedTiles(a){const u={};if(a.length===0)return u;const f={},g=a.reduce((M,D)=>Math.min(M,D.overscaledZ),1/0),b=a[0].overscaledZ,E=Math.max(b-xd.maxOverzooming,this._source.minzoom),C=Math.max(b+xd.maxUnderzooming,this._source.minzoom),P={};for(const M of a){const D=this._addTile(M);u[M.key]=M,D.hasData()||g<this._source.maxzoom&&(P[M.key]=M)}this._retainLoadedChildren(P,g,C,u);for(const M of a){let D=this._tiles[M.key];if(D.hasData())continue;if(M.canonical.z>=this._source.maxzoom){const V=M.children(this._source.maxzoom)[0],H=this.getTile(V);if(H&&H.hasData()){u[V.key]=V;continue}}else{const V=M.children(this._source.maxzoom);if(u[V[0].key]&&u[V[1].key]&&u[V[2].key]&&u[V[3].key])continue}let N=D.wasRequested();for(let V=M.overscaledZ-1;V>=E;--V){const H=M.scaledTo(V);if(f[H.key]||(f[H.key]=!0,D=this.getTile(H),!D&&N&&(D=this._addTile(H)),D&&(u[H.key]=H,N=D.wasRequested(),D.hasData())))break}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const a in this._tiles){const u=[];let f,g=this._tiles[a].tileID;for(;g.overscaledZ>0;){if(g.key in this._loadedParentTiles){f=this._loadedParentTiles[g.key];break}u.push(g.key);const b=g.scaledTo(g.overscaledZ-1);if(f=this._getLoadedTile(b),f)break;g=b}for(const b of u)this._loadedParentTiles[b]=f}}_addTile(a){let u=this._tiles[a.key];if(u)return u;u=this._cache.getAndRemove(a),u&&(this._setTileReloadTimer(a.key,u),u.tileID=a,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[a.key]&&(clearTimeout(this._cacheTimers[a.key]),delete this._cacheTimers[a.key],this._setTileReloadTimer(a.key,u)));const f=!!u;if(!f){const g=this.map?this.map.painter:null;u=new PT(a,this._source.tileSize*a.overscaleFactor(),this.transform.tileZoom,g,this._isRaster),this._loadTile(u,this._tileLoaded.bind(this,u,a.key,u.state))}return u?(u.uses++,this._tiles[a.key]=u,f||this._source.fire(new Zo("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u):null}_setTileReloadTimer(a,u){a in this._timers&&(clearTimeout(this._timers[a]),delete this._timers[a]);const f=u.getExpiryTimeout();f&&(this._timers[a]=setTimeout(()=>{this._reloadTile(a,"expired"),delete this._timers[a]},f))}_removeTile(a){const u=this._tiles[a];u&&(u.uses--,delete this._tiles[a],this._timers[a]&&(clearTimeout(this._timers[a]),delete this._timers[a]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const a in this._tiles)this._removeTile(+a);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(a,u,f){const g=[],b=this.transform;if(!b)return g;const E=b.projection.name==="globe",C=Nl(b.center.lng);for(const P in this._tiles){const M=this._tiles[P];if(f&&M.clearQueryDebugViz(),M.holdingForFade())continue;let D;if(E){const N=M.tileID.canonical;if(N.z===0){const V=[Math.abs(bt(C,...xy(N,-1))-C),Math.abs(bt(C,...xy(N,1))-C)];D=[0,2*V.indexOf(Math.min(...V))-1]}else{const V=[Math.abs(bt(C,...xy(N,-1))-C),Math.abs(bt(C,...xy(N,0))-C),Math.abs(bt(C,...xy(N,1))-C)];D=[V.indexOf(Math.min(...V))-1]}}else D=[0];for(const N of D){const V=a.containsTile(M,b,u,N);V&&g.push(V)}}return g}getVisibleCoordinates(a){const u=this.getRenderableIds(a).map(f=>this._tiles[f].tileID);for(const f of u)f.projMatrix=this.transform.calculateProjMatrix(f.toUnwrapped());return u}hasTransition(){if(this._source.hasTransition())return!0;if(TO(this._source.type))for(const a in this._tiles){const u=this._tiles[a];if(u.fadeEndTime!==void 0&&u.fadeEndTime>=bo.now())return!0}return!1}setFeatureState(a,u,f){this._state.updateState(a=a||"_geojsonTileLayer",u,f)}removeFeatureState(a,u,f){this._state.removeFeatureState(a=a||"_geojsonTileLayer",u,f)}getFeatureState(a,u){return this._state.getState(a=a||"_geojsonTileLayer",u)}setDependencies(a,u,f){const g=this._tiles[a];g&&g.setDependencies(u,f)}reloadTilesForDependencies(a,u){for(const f in this._tiles)this._tiles[f].hasDependency(a,u)&&this._reloadTile(+f,"reloading");this._cache.filter(f=>!f.hasDependency(a,u))}_preloadTiles(a,u){if(!this._sourceLoaded){const C=()=>{this._sourceLoaded&&(this._source.off("data",C),this._preloadTiles(a,u))};return void this._source.on("data",C)}const f=new Map,g=Array.isArray(a)?a:[a],b=this.map.painter.terrain,E=this.usedForTerrain&&b?b.getScaledDemTileSize():this._source.tileSize;for(const C of g){const P=C.coveringTiles({tileSize:E,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const M of P)f.set(M.key,M);this.usedForTerrain&&C.updateElevation(!1)}pn(Array.from(f.values()),(C,P)=>{const M=new PT(C,this._source.tileSize*C.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(M,D=>{this._source.type==="raster-dem"&&M.dem&&this._backfillDEM(M),P(D,M)})},u)}}function EO(c,a){const u=Math.abs(2*c.wrap)-+(c.wrap<0),f=Math.abs(2*a.wrap)-+(a.wrap<0);return c.overscaledZ-a.overscaledZ||f-u||a.canonical.y-c.canonical.y||a.canonical.x-c.canonical.x}function TO(c){return c==="raster"||c==="image"||c==="video"||c==="custom"}function xy(c,a){const u=1<<c.z;return[c.x/u+a,(c.x+1)/u+a]}xd.maxOverzooming=10,xd.maxUnderzooming=3;class tb{constructor(a,u,f){this._demTile=a,this._dem=this._demTile.dem,this._scale=u,this._offset=f}static create(a,u,f){const g=f||a.findDEMTileFor(u);if(!g||!g.dem)return;const b=g.dem,E=g.tileID,C=1<<u.canonical.z-E.canonical.z;return new tb(g,g.tileSize/On/C,[(u.canonical.x/C-E.canonical.x)*b.dim,(u.canonical.y/C-E.canonical.y)*b.dim])}tileCoordToPixel(a,u){const f=u*this._scale+this._offset[1],g=Math.floor(a*this._scale+this._offset[0]),b=Math.floor(f);return new J(g,b)}getElevationAt(a,u,f,g){const b=a*this._scale+this._offset[0],E=u*this._scale+this._offset[1],C=Math.floor(b),P=Math.floor(E),M=this._dem;return g=!!g,f?Ci(Ci(M.get(C,P,g),M.get(C,P+1,g),E-P),Ci(M.get(C+1,P,g),M.get(C+1,P+1,g),E-P),b-C):M.get(C,P,g)}getElevationAtPixel(a,u,f){return this._dem.get(a,u,!!f)}getMeterToDEM(a){return(1<<this._demTile.tileID.canonical.z)*ll(1,a)*this._dem.stride}}class SO{constructor(a,u){this.tileID=a,this.x=a.canonical.x,this.y=a.canonical.y,this.z=a.canonical.z,this.grid=new Ec(On,16,0),this.featureIndexArray=new cd,this.promoteId=u}insert(a,u,f,g,b,E=0){const C=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,g,b,E);const P=this.grid;for(let M=0;M<u.length;M++){const D=u[M],N=[1/0,1/0,-1/0,-1/0];for(let V=0;V<D.length;V++){const H=D[V];N[0]=Math.min(N[0],H.x),N[1]=Math.min(N[1],H.y),N[2]=Math.max(N[2],H.x),N[3]=Math.max(N[3],H.y)}N[0]<On&&N[1]<On&&N[2]>=0&&N[3]>=0&&P.insert(C,N[0],N[1],N[2],N[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new dT(new V1(this.rawTileData)).layers,this.sourceLayerCoder=new uO(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const a in this.vtLayers)this.vtFeatures[a]=[]}return this.vtLayers}query(a,u,f,g){this.loadVTLayers();const b=a.params||{},E=qf(b.filter),C=a.tileResult,P=a.transform,M=C.bufferedTilespaceBounds,D=this.grid.query(M.min.x,M.min.y,M.max.x,M.max.y,(W,Q,oe,xe)=>qR(C.bufferedTilespaceGeometry,W,Q,oe,xe));D.sort(DH);let N=null;P.elevation&&D.length>0&&(N=tb.create(P.elevation,this.tileID));const V={};let H;for(let W=0;W<D.length;W++){const Q=D[W];if(Q===H)continue;H=Q;const oe=this.featureIndexArray.get(Q);let xe=null;this.loadMatchingFeature(V,oe,E,b.layers,b.availableImages,u,f,g,(Me,we,Ie,Fe=0)=>(xe||(xe=Mc(Me,this.tileID.canonical,a.tileTransform)),we.queryIntersectsFeature(C,Me,Ie,xe,this.z,a.transform,a.pixelPosMatrix,N,Fe)))}return V}loadMatchingFeature(a,u,f,g,b,E,C,P,M){const{featureIndex:D,bucketIndex:N,sourceLayerIndex:V,layoutVertexArrayOffset:H}=u,W=this.bucketLayerIDs[N];if(g&&!function(Me,we){for(let Ie=0;Ie<Me.length;Ie++)if(we.indexOf(Me[Ie])>=0)return!0;return!1}(g,W))return;const Q=this.sourceLayerCoder.decode(V),oe=this.vtLayers[Q].feature(D);if(f.needGeometry){const Me=yd(oe,!0);if(!f.filter(new z(this.tileID.overscaledZ),Me,this.tileID.canonical))return}else if(!f.filter(new z(this.tileID.overscaledZ),oe))return;const xe=this.getId(oe,Q);for(let Me=0;Me<W.length;Me++){const we=W[Me];if(g&&g.indexOf(we)<0)continue;const Ie=E[we];if(!Ie)continue;let Fe={};xe!==void 0&&P&&(Fe=P.getState(Ie.sourceLayer||"_geojsonTileLayer",xe));const De=An({},C[we]);De.paint=CO(De.paint,Ie.paint,oe,Fe,b),De.layout=CO(De.layout,Ie.layout,oe,Fe,b);const lt=!M||M(oe,Ie,Fe,H);if(!lt)continue;const it=new hO(oe,this.z,this.x,this.y,xe);it.layer=De;let _t=a[we];_t===void 0&&(_t=a[we]=[]),_t.push({featureIndex:D,feature:it,intersectionZ:lt})}}lookupSymbolFeatures(a,u,f,g,b,E,C,P){const M={};this.loadVTLayers();const D=qf(b);for(const N of a)this.loadMatchingFeature(M,{bucketIndex:f,sourceLayerIndex:g,featureIndex:N,layoutVertexArrayOffset:0},D,E,C,P,u);return M}loadFeature(a){const{featureIndex:u,sourceLayerIndex:f}=a;this.loadVTLayers();const g=this.sourceLayerCoder.decode(f),b=this.vtFeatures[g];if(b[u])return b[u];const E=this.vtLayers[g].feature(u);return b[u]=E,E}hasLayer(a){for(const u of this.bucketLayerIDs)for(const f of u)if(a===f)return!0;return!1}getId(a,u){let f=a.id;if(this.promoteId){const g=typeof this.promoteId=="string"?this.promoteId:this.promoteId[u];g!=null&&(f=a.properties[g]),typeof f=="boolean"&&(f=Number(f))}return f}}function CO(c,a,u,f,g){return Pt(c,(b,E)=>{const C=a instanceof _e?a.get(E):null;return C&&C.evaluate?C.evaluate(u,f,g):C})}function DH(c,a){return a-c}dn(SO,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class AO{constructor(a,u){this.width=a,this.height=u,this.nextRow=0,this.image=new Rc({width:a,height:u}),this.positions={},this.uploaded=!1}getDash(a,u){const f=this.getKey(a,u);return this.positions[f]}trim(){const a=this.width,u=this.height=We(this.nextRow);this.image.resize({width:a,height:u})}getKey(a,u){return a.join(",")+u}getDashRanges(a,u,f){const g=[];let b=a.length%2==1?-a[a.length-1]*f:0,E=a[0]*f,C=!0;g.push({left:b,right:E,isDash:C,zeroLength:a[0]===0});let P=a[0];for(let M=1;M<a.length;M++){C=!C;const D=a[M];b=P*f,P+=D,E=P*f,g.push({left:b,right:E,isDash:C,zeroLength:D===0})}return g}addRoundDash(a,u,f){const g=u/2;for(let b=-f;b<=f;b++){const E=this.width*(this.nextRow+f+b);let C=0,P=a[C];for(let M=0;M<this.width;M++){M/P.right>1&&(P=a[++C]);const D=Math.abs(M-P.left),N=Math.abs(M-P.right),V=Math.min(D,N);let H;const W=b/f*(g+1);if(P.isDash){const Q=g-Math.abs(W);H=Math.sqrt(V*V+Q*Q)}else H=g-Math.sqrt(V*V+W*W);this.image.data[E+M]=Math.max(0,Math.min(255,H+128))}}}addRegularDash(a,u){for(let P=a.length-1;P>=0;--P){const M=a[P],D=a[P+1];M.zeroLength?a.splice(P,1):D&&D.isDash===M.isDash&&(D.left=M.left,a.splice(P,1))}const f=a[0],g=a[a.length-1];f.isDash===g.isDash&&(f.left=g.left-this.width,g.right=f.right+this.width);const b=this.width*this.nextRow;let E=0,C=a[E];for(let P=0;P<this.width;P++){P/C.right>1&&(C=a[++E]);const M=Math.abs(P-C.left),D=Math.abs(P-C.right),N=Math.min(M,D);this.image.data[b+P]=Math.max(0,Math.min(255,(C.isDash?N:-N)+u+128))}}addDash(a,u){const f=this.getKey(a,u);if(this.positions[f])return this.positions[f];const g=u==="round",b=g?7:0,E=2*b+1;if(this.nextRow+E>this.height)return tt("LineAtlas out of space"),null;a.length===0&&a.push(1);let C=0;for(let D=0;D<a.length;D++)a[D]<0&&(tt("Negative value is found in line dasharray, replacing values with 0"),a[D]=0),C+=a[D];if(C!==0){const D=this.width/C,N=this.getDashRanges(a,this.width,D);g?this.addRoundDash(N,D,b):this.addRegularDash(N,u==="square"?.5*D:0)}const P=this.nextRow+b;this.nextRow+=E;const M={tl:[P,b],br:[C,0]};return this.positions[f]=M,M}}dn(AO,"LineAtlas");const PO=1*ul;class IO{constructor(a){const u={},f=[];for(const C in a){const P=a[C],M=u[C]={};for(const D in P.glyphs){const N=P.glyphs[+D];if(!N||N.bitmap.width===0||N.bitmap.height===0)continue;const V=N.metrics.localGlyph?PO:1,H={x:0,y:0,w:N.bitmap.width+2*V,h:N.bitmap.height+2*V};f.push(H),M[D]=H}}const{w:g,h:b}=gT(f),E=new Rc({width:g||1,height:b||1});for(const C in a){const P=a[C];for(const M in P.glyphs){const D=P.glyphs[+M];if(!D||D.bitmap.width===0||D.bitmap.height===0)continue;const N=u[C][M],V=D.metrics.localGlyph?PO:1;Rc.copy(D.bitmap,E,{x:0,y:0},{x:N.x+V,y:N.y+V},D.bitmap)}}this.image=E,this.positions=u}}dn(IO,"GlyphAtlas");class kH{constructor(a){this.tileID=new ss(a.tileID.overscaledZ,a.tileID.wrap,a.tileID.canonical.z,a.tileID.canonical.x,a.tileID.canonical.y),this.tileZoom=a.tileZoom,this.uid=a.uid,this.zoom=a.zoom,this.canonical=a.tileID.canonical,this.pixelRatio=a.pixelRatio,this.tileSize=a.tileSize,this.source=a.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=a.showCollisionBoxes,this.collectResourceTiming=!!a.collectResourceTiming,this.returnDependencies=!!a.returnDependencies,this.promoteId=a.promoteId,this.enableTerrain=!!a.enableTerrain,this.isSymbolTile=a.isSymbolTile,this.tileTransform=bd(a.tileID.canonical,a.projection),this.projection=a.projection}parse(a,u,f,g,b){this.status="parsing",this.data=a,this.collisionBoxArray=new Xi;const E=new uO(Object.keys(a.layers).sort()),C=new SO(this.tileID,this.promoteId);C.bucketLayerIDs=[];const P={},M=new AO(256,256),D={featureIndex:C,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:M,availableImages:f},N=u.familiesBySource[this.source];for(const Fe in N){const De=a.layers[Fe];if(!De)continue;let lt=!1,it=!1;for(const ft of N[Fe])ft[0].type==="symbol"?lt=!0:it=!0;if(this.isSymbolTile===!0&&!lt||this.isSymbolTile===!1&&!it)continue;De.version===1&&tt(`Vector tile source "${this.source}" layer "${Fe}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const _t=E.encode(Fe),Vt=[];for(let ft=0;ft<De.length;ft++){const St=De.feature(ft),Ct=C.getId(St,Fe);Vt.push({feature:St,id:Ct,index:ft,sourceLayerIndex:_t})}for(const ft of N[Fe]){const St=ft[0];this.isSymbolTile!==void 0&&St.type==="symbol"!==this.isSymbolTile||St.minzoom&&this.zoom<Math.floor(St.minzoom)||St.maxzoom&&this.zoom>=St.maxzoom||St.visibility!=="none"&&(OT(ft,this.zoom,f),(P[St.id]=St.createBucket({index:C.bucketLayerIDs.length,layers:ft,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:_t,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:f})).populate(Vt,D,this.tileID.canonical,this.tileTransform),C.bucketLayerIDs.push(ft.map(Ct=>Ct.id)))}}let V,H,W,Q;M.trim();const oe={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},xe=()=>{if(V)return b(V);if(H&&W&&Q){const Fe=new IO(H),De=new FL(W,Q);for(const lt in P){const it=P[lt];it instanceof $u?(OT(it.layers,this.zoom,f),aH(it,H,Fe.positions,W,De.iconPositions,this.showCollisionBoxes,f,this.tileID.canonical,this.tileZoom,this.projection)):it.hasPattern&&(it instanceof z1||it instanceof O1||it instanceof cy)&&(OT(it.layers,this.zoom,f),it.addFeatures(D,this.tileID.canonical,De.patternPositions,f,this.tileTransform))}this.status="done",b(null,{buckets:xn(P).filter(lt=>!lt.isEmpty()),featureIndex:C,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Fe.image,lineAtlas:M,imageAtlas:De,glyphMap:this.returnDependencies?H:null,iconMap:this.returnDependencies?W:null,glyphPositions:this.returnDependencies?Fe.positions:null})}},Me=Pt(D.glyphDependencies,Fe=>Object.keys(Fe).map(Number));Object.keys(Me).length?g.send("getGlyphs",{uid:this.uid,stacks:Me},(Fe,De)=>{V||(V=Fe,H=De,xe())},void 0,!1,oe):H={};const we=Object.keys(D.iconDependencies);we.length?g.send("getImages",{icons:we,source:this.source,tileID:this.tileID,type:"icons"},(Fe,De)=>{V||(V=Fe,W=De,xe())},void 0,!1,oe):W={};const Ie=Object.keys(D.patternDependencies);Ie.length?g.send("getImages",{icons:Ie,source:this.source,tileID:this.tileID,type:"patterns"},(Fe,De)=>{V||(V=Fe,Q=De,xe())},void 0,!1,oe):Q={},xe()}}function OT(c,a,u){const f=new z(a);for(const g of c)g.recalculate(f,u)}class MO{constructor(a){this.entries={},this.scheduler=a}request(a,u,f,g){const b=this.entries[a]=this.entries[a]||{callbacks:[]};if(b.result){const[E,C]=b.result;return this.scheduler?this.scheduler.add(()=>{g(E,C)},u):g(E,C),()=>{}}return b.callbacks.push(g),b.cancel||(b.cancel=f((E,C)=>{b.result=[E,C];for(const P of b.callbacks)this.scheduler?this.scheduler.add(()=>{P(E,C)},u):P(E,C);setTimeout(()=>delete this.entries[a],3e3)})),()=>{b.result||(b.callbacks=b.callbacks.filter(E=>E!==g),b.callbacks.length||(b.cancel(),delete this.entries[a]))}}}function RO(c,a,u){const f=JSON.stringify(c.request);return c.data&&(this.deduped.entries[f]={result:[null,c.data]}),this.deduped.request(f,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom},g=>{const b=Hn(c.request,(E,C,P,M)=>{E?g(E):C&&g(null,{vectorTile:u?void 0:new dT(new V1(C)),rawData:C,cacheControl:P,expires:M})});return()=>{b.cancel(),g()}},a)}const LO=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class DT{static from(a){if(!(a instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[u,f]=new Uint8Array(a,0,2);if(u!==219)throw new Error("Data does not appear to be in a KDBush format.");const g=f>>4;if(g!==1)throw new Error(`Got v${g} data when expected v1.`);const b=LO[15&f];if(!b)throw new Error("Unrecognized array type.");const[E]=new Uint16Array(a,2,1),[C]=new Uint32Array(a,4,1);return new DT(C,E,b,a)}constructor(a,u=64,f=Float64Array,g){if(isNaN(a)||a<0)throw new Error(`Unpexpected numItems value: ${a}.`);this.numItems=+a,this.nodeSize=Math.min(Math.max(+u,2),65535),this.ArrayType=f,this.IndexArrayType=a<65536?Uint16Array:Uint32Array;const b=LO.indexOf(this.ArrayType),E=2*a*this.ArrayType.BYTES_PER_ELEMENT,C=a*this.IndexArrayType.BYTES_PER_ELEMENT,P=(8-C%8)%8;if(b<0)throw new Error(`Unexpected typed array class: ${f}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+C+P,2*a),this._pos=2*a,this._finished=!0):(this.data=new ArrayBuffer(8+E+C+P),this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+C+P,2*a),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+b]),new Uint16Array(this.data,2,1)[0]=u,new Uint32Array(this.data,4,1)[0]=a)}add(a,u){const f=this._pos>>1;return this.ids[f]=f,this.coords[this._pos++]=a,this.coords[this._pos++]=u,f}finish(){const a=this._pos>>1;if(a!==this.numItems)throw new Error(`Added ${a} items when expected ${this.numItems}.`);return kT(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(a,u,f,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:b,coords:E,nodeSize:C}=this,P=[0,b.length-1,0],M=[];for(;P.length;){const D=P.pop()||0,N=P.pop()||0,V=P.pop()||0;if(N-V<=C){for(let oe=V;oe<=N;oe++){const xe=E[2*oe],Me=E[2*oe+1];xe>=a&&xe<=f&&Me>=u&&Me<=g&&M.push(b[oe])}continue}const H=V+N>>1,W=E[2*H],Q=E[2*H+1];W>=a&&W<=f&&Q>=u&&Q<=g&&M.push(b[H]),(D===0?a<=W:u<=Q)&&(P.push(V),P.push(H-1),P.push(1-D)),(D===0?f>=W:g>=Q)&&(P.push(H+1),P.push(N),P.push(1-D))}return M}within(a,u,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:b,nodeSize:E}=this,C=[0,g.length-1,0],P=[],M=f*f;for(;C.length;){const D=C.pop()||0,N=C.pop()||0,V=C.pop()||0;if(N-V<=E){for(let oe=V;oe<=N;oe++)DO(b[2*oe],b[2*oe+1],a,u)<=M&&P.push(g[oe]);continue}const H=V+N>>1,W=b[2*H],Q=b[2*H+1];DO(W,Q,a,u)<=M&&P.push(g[H]),(D===0?a-f<=W:u-f<=Q)&&(C.push(V),C.push(H-1),C.push(1-D)),(D===0?a+f>=W:u+f>=Q)&&(C.push(H+1),C.push(N),C.push(1-D))}return P}}function kT(c,a,u,f,g,b){if(g-f<=u)return;const E=f+g>>1;OO(c,a,E,f,g,b),kT(c,a,u,f,E-1,1-b),kT(c,a,u,E+1,g,1-b)}function OO(c,a,u,f,g,b){for(;g>f;){if(g-f>600){const M=g-f+1,D=u-f+1,N=Math.log(M),V=.5*Math.exp(2*N/3),H=.5*Math.sqrt(N*V*(M-V)/M)*(D-M/2<0?-1:1);OO(c,a,u,Math.max(f,Math.floor(u-D*V/M+H)),Math.min(g,Math.floor(u+(M-D)*V/M+H)),b)}const E=a[2*u+b];let C=f,P=g;for(wy(c,a,f,u),a[2*g+b]>E&&wy(c,a,f,g);C<P;){for(wy(c,a,C,P),C++,P--;a[2*C+b]<E;)C++;for(;a[2*P+b]>E;)P--}a[2*f+b]===E?wy(c,a,f,P):(P++,wy(c,a,P,g)),P<=u&&(f=P+1),u<=P&&(g=P-1)}}function wy(c,a,u,f){FT(c,u,f),FT(a,2*u,2*f),FT(a,2*u+1,2*f+1)}function FT(c,a,u){const f=c[a];c[a]=c[u],c[u]=f}function DO(c,a,u,f){const g=c-u,b=a-f;return g*g+b*b}s.ARRAY_TYPE=Us,s.AUTH_ERR_MSG=Pe,s.Aabb=os,s.Actor=class{constructor(c,a,u){this.target=c,this.parent=a,this.mapId=u,this.callbacks={},this.cancelCallbacks={},Ke(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=tn()?c:d,this.scheduler=new PH}send(c,a,u,f,g=!1,b){const E=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(u.metadata=b,this.callbacks[E]=u);const C=It(this.globalScope)?void 0:[];return this.target.postMessage({id:E,type:c,hasCallback:!!u,targetMapId:f,mustQueue:g,sourceMapId:this.mapId,data:ku(a,C)},C),{cancel:()=>{u&&delete this.callbacks[E],this.target.postMessage({id:E,type:"<cancel>",targetMapId:f,sourceMapId:this.mapId})}}}receive(c){const a=c.data,u=a.id;if(u&&(!a.targetMapId||this.mapId===a.targetMapId))if(a.type==="<cancel>"){const f=this.cancelCallbacks[u];delete this.cancelCallbacks[u],f&&f.cancel()}else if(a.mustQueue||tn()){const f=this.callbacks[u];this.cancelCallbacks[u]=this.scheduler.add(()=>this.processTask(u,a),f&&f.metadata||{type:"message"})}else this.processTask(u,a)}processTask(c,a){if(a.type==="<response>"){const u=this.callbacks[c];delete this.callbacks[c],u&&(a.error?u(Tc(a.error)):u(null,Tc(a.data)))}else{const u=It(this.globalScope)?void 0:[],f=a.hasCallback?(b,E)=>{delete this.cancelCallbacks[c],this.target.postMessage({id:c,type:"<response>",sourceMapId:this.mapId,error:b?ku(b):null,data:ku(E,u)},u)}:b=>{},g=Tc(a.data);if(this.parent[a.type])this.parent[a.type](a.sourceMapId,g,f);else if(this.parent.getWorkerSource){const b=a.type.split(".");this.parent.getWorkerSource(a.sourceMapId,b[0],g.source)[b[1]](g,f)}else f(new Error(`Could not find function ${a.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},s.CanonicalTileID=B1,s.Color=on,s.ColorMode=$l,s.CullFaceMode=hl,s.DEMData=eb,s.DataConstantProperty=Y,s.DedupedRequest=MO,s.DepthMode=xp,s.EXTENT=On,s.Elevation=class{isDataAvailableAtPoint(c){const a=this._source();if(this.isUsingMockSource()||!a||c.y<0||c.y>1)return!1;const u=a.getSource().maxzoom,f=1<<u,g=Math.floor(c.x),b=Math.floor((c.x-g)*f),E=Math.floor(c.y*f),C=this.findDEMTileFor(new ss(u,g,u,b,E));return!(!C||!C.dem)}getAtPointOrZero(c,a=0){return this.getAtPoint(c,a)||0}getAtPoint(c,a,u=!0){if(this.isUsingMockSource())return null;a==null&&(a=null);const f=this._source();if(!f||c.y<0||c.y>1)return a;const g=f.getSource().maxzoom,b=1<<g,E=Math.floor(c.x),C=c.x-E,P=new ss(g,E,g,Math.floor(C*b),Math.floor(c.y*b)),M=this.findDEMTileFor(P);if(!M||!M.dem)return a;const D=M.dem,N=1<<M.tileID.canonical.z,V=(C*N-M.tileID.canonical.x)*D.dim,H=(c.y*N-M.tileID.canonical.y)*D.dim,W=Math.floor(V),Q=Math.floor(H);return(u?this.exaggeration():1)*Ci(Ci(D.get(W,Q),D.get(W,Q+1),H-Q),Ci(D.get(W+1,Q),D.get(W+1,Q+1),H-Q),V-W)}getAtTileOffset(c,a,u){const f=1<<c.canonical.z;return this.getAtPointOrZero(new ap(c.wrap+(c.canonical.x+a/On)/f,(c.canonical.y+u/On)/f))}getAtTileOffsetFunc(c,a,u,f){return g=>{const b=this.getAtTileOffset(c,g.x,g.y),E=f.upVector(c.canonical,g.x,g.y);return la(E,E,b*f.upVectorScale(c.canonical,a,u).metersToTile),E}}getForTilePoints(c,a,u,f){if(this.isUsingMockSource())return!1;const g=tb.create(this,c,f);return!!g&&(a.forEach(b=>{b[2]=this.exaggeration()*g.getElevationAt(b[0],b[1],u)}),!0)}getMinMaxForTile(c){if(this.isUsingMockSource())return null;const a=this.findDEMTileFor(c);if(!a||!a.dem)return null;const u=a.dem.tree,f=a.tileID,g=1<<c.canonical.z-f.canonical.z;let b=c.canonical.x/g-f.canonical.x,E=c.canonical.y/g-f.canonical.y,C=0;for(let P=0;P<c.canonical.z-f.canonical.z&&!u.leaves[C];P++){b*=2,E*=2;const M=2*Math.floor(E)+Math.floor(b);C=u.childOffsets[C]+M,b%=1,E%=1}return{min:this.exaggeration()*u.minimums[C],max:this.exaggeration()*u.maximums[C]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(c,a,u){throw new Error("Pure virtual method called.")}pointCoordinate(c){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(c){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},s.ErrorEvent=Br,s.EvaluationParameters=z,s.Event=Zo,s.Evented=Mo,s.FillExtrusionBucket=cy,s.Frustum=$E,s.FrustumCorners=jE,s.GLOBE_RADIUS=Bl,s.GLOBE_SCALE_MATCH_LATITUDE=45,s.GLOBE_ZOOM_THRESHOLD_MAX=OR,s.GLOBE_ZOOM_THRESHOLD_MIN=GE,s.GlobeSharedBuffers=class{constructor(c){this._createGrid(c),this._createPoles(c)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const c of this._poleSegments)c.destroy();for(const c of this._gridSegments)c.withSkirts.destroy(),c.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const c of this._wireframeSegments)c.destroy()}}_fillGridMeshWithLods(c,a){const u=new Ut,f=new Sn,g=[],b=c+1+2,E=a[0]+1,C=a[0]+1+(1+a.length),P=(M,D,N)=>{let V=M===b-1?M-2:M===0?M:M-1;return V+=N?24575:0,[V,D]};for(let M=0;M<b;++M)u.emplaceBack(...P(M,0,!0));for(let M=0;M<E;++M)for(let D=0;D<b;++D)u.emplaceBack(...P(D,M,(D===0||D===b-1)&&!0));for(let M=0;M<a.length;++M){const D=a[M];for(let N=0;N<b;++N)u.emplaceBack(...P(N,D,!0))}for(let M=0;M<a.length;++M){const D=f.length,N=a[M]+1+2,V=new Sn;for(let Q=0;Q<N-1;Q++){const oe=Q===N-2,xe=oe?b*(C-a.length+M-Q):b;for(let Me=0;Me<b-1;Me++){const we=Q*b+Me;Q===0||oe||Me===0||Me===b-2?(V.emplaceBack(we+1,we,we+xe),V.emplaceBack(we+xe,we+xe+1,we+1)):(f.emplaceBack(we+1,we,we+xe),f.emplaceBack(we+xe,we+xe+1,we+1))}}const H=Zr.simpleSegment(0,D,u.length,f.length-D);for(let Q=0;Q<V.uint16.length;Q+=3)f.emplaceBack(V.uint16[Q],V.uint16[Q+1],V.uint16[Q+2]);const W=Zr.simpleSegment(0,D,u.length,f.length-D);g.push({withoutSkirts:H,withSkirts:W})}return{vertices:u,indices:f,segments:g}}_createGrid(c){const a=this._fillGridMeshWithLods(md,Qg);this._gridSegments=a.segments,this._gridBuffer=c.createVertexBuffer(a.vertices,Jg.members),this._gridIndexBuffer=c.createIndexBuffer(a.indices,!0)}_createPoles(c){const a=new Sn;for(let g=0;g<=md;g++)a.emplaceBack(0,g+1,g+2);this._poleIndexBuffer=c.createIndexBuffer(a,!0);const u=new Ki,f=new Ki;this._poleSegments=[];for(let g=0,b=0;g<GE;g++){const E=360/(1<<g);u.emplaceBack(0,-Bl,0,.5,0),f.emplaceBack(0,-Bl,0,.5,1);for(let C=0;C<=md;C++){const P=C/md,M=Ci(0,E,P),[D,N,V]=rp(P$,I$,M,Bl);u.emplaceBack(D,N,V,P,0),f.emplaceBack(D,N,V,P,1)}this._poleSegments.push(Zr.simpleSegment(b,0,66,64)),b+=66}this._poleNorthVertexBuffer=c.createVertexBuffer(u,RR,!1),this._poleSouthVertexBuffer=c.createVertexBuffer(f,RR,!1)}getGridBuffers(c,a){return[this._gridBuffer,this._gridIndexBuffer,a?this._gridSegments[c].withSkirts:this._gridSegments[c].withoutSkirts]}getPoleBuffers(c){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[c]]}getWirefameBuffers(c,a){if(!this._wireframeSegments){const u=new Eo,f=md,g=f+1+2,b=1;this._wireframeSegments=[];for(let E=0,C=0;E<Qg.length;E++){const P=Qg[E];for(let D=b;D<P+b;D++)for(let N=b;N<f+b;N++){const V=D*g+N;u.emplaceBack(V,V+1),u.emplaceBack(V,V+g),u.emplaceBack(V,V+g+1)}const M=P*f*3;this._wireframeSegments.push(Zr.simpleSegment(0,C,(P+1)*g,M)),C+=M}this._wireframeIndexBuffer=c.createIndexBuffer(u)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[a]]}},s.GlyphManager=gp,s.ImagePosition=yT,s.KDBush=DT,s.LivePerformanceUtils=na,s.LngLat=Zi,s.LngLatBounds=Nu,s.LocalGlyphMode=bT,s.MAX_MERCATOR_LATITUDE=$o,s.MercatorCoordinate=ap,s.ONE_EM=Lo,s.OverscaledTileID=ss,s.PerformanceMarkers=Bo,s.Point=J,s.Properties=Se,s.RGBAImage=Vs,s.Ray=VE,s.RequestManager=class{constructor(c,a,u){this._transformRequestFn=c,this._customAccessToken=a,this._silenceAuthErrors=!!u,this._createSkuToken()}_createSkuToken(){const c=function(){let a="";for(let u=0;u<10;u++)a+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",B,a].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=c.token,this._skuTokenExpiresAt=c.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(c,a){return this._transformRequestFn&&this._transformRequestFn(c,a)||{url:c}}normalizeStyleURL(c,a){if(!$e(c))return c;const u=Xt(c);return u.path=`/styles/v1${u.path}`,this._makeAPIURL(u,this._customAccessToken||a)}normalizeGlyphsURL(c,a){if(!$e(c))return c;const u=Xt(c);return u.path=`/fonts/v1${u.path}`,this._makeAPIURL(u,this._customAccessToken||a)}normalizeSourceURL(c,a,u,f){if(!$e(c))return c;const g=Xt(c);return g.path=`/v4/${g.authority}.json`,g.params.push("secure"),u&&g.params.push(`language=${u}`),f&&g.params.push(`worldview=${f}`),this._makeAPIURL(g,this._customAccessToken||a)}normalizeSpriteURL(c,a,u,f){const g=Xt(c);return $e(c)?(g.path=`/styles/v1${g.path}/sprite${a}${u}`,this._makeAPIURL(g,this._customAccessToken||f)):(g.path+=`${a}${u}`,Ft(g))}normalizeTileURL(c,a,u){if(this._isSkuTokenExpired()&&this._createSkuToken(),c&&!$e(c))return c;const f=Xt(c);f.path=f.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${a||u&&f.authority!=="raster"&&u===512?"@2x":""}${w.supported?".webp":"$1"}`),f.authority==="raster"?f.path=`/${v.RASTER_URL_PREFIX}${f.path}`:(f.path=f.path.replace(/^.+\/v4\//,"/"),f.path=`/${v.TILE_URL_VERSION}${f.path}`);const g=this._customAccessToken||function(b){for(const E of b){const C=E.match(/^access_token=(.*)$/);if(C)return C[1]}return null}(f.params)||v.ACCESS_TOKEN;return v.REQUIRE_ACCESS_TOKEN&&g&&this._skuToken&&f.params.push(`sku=${this._skuToken}`),this._makeAPIURL(f,g)}canonicalizeTileURL(c,a){const u=Xt(c);if(!u.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!u.path.match(/\.[\w]+$/))return c;let f="mapbox://";u.path.match(/^\/raster\/v1\//)?f+=`raster/${u.path.replace(`/${v.RASTER_URL_PREFIX}/`,"")}`:f+=`tiles/${u.path.replace(`/${v.TILE_URL_VERSION}/`,"")}`;let g=u.params;return a&&(g=g.filter(b=>!b.match(/^access_token=/))),g.length&&(f+=`?${g.join("&")}`),f}canonicalizeTileset(c,a){const u=!!a&&$e(a),f=[];for(const g of c.tiles||[])Je(g)?f.push(this.canonicalizeTileURL(g,u)):f.push(g);return f}_makeAPIURL(c,a){const u="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",f=Xt(v.API_URL);if(c.protocol=f.protocol,c.authority=f.authority,c.protocol==="http"){const g=c.params.indexOf("secure");g>=0&&c.params.splice(g,1)}if(f.path!=="/"&&(c.path=`${f.path}${c.path}`),!v.REQUIRE_ACCESS_TOKEN)return Ft(c);if(a=a||v.ACCESS_TOKEN,!this._silenceAuthErrors){if(!a)throw new Error(`An API access token is required to use Mapbox GL. ${u}`);if(a[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${u}`)}return c.params=c.params.filter(g=>g.indexOf("access_token")===-1),c.params.push(`access_token=${a||""}`),Ft(c)}},s.ResourceType=mt,s.SegmentVector=Zr,s.SourceCache=xd,s.StencilMode=MT,s.StructArrayLayout1ui2=Ns,s.StructArrayLayout2f1f2i16=Fn,s.StructArrayLayout2i4=Ut,s.StructArrayLayout2ui4=Eo,s.StructArrayLayout3f12=gi,s.StructArrayLayout3ui6=Sn,s.StructArrayLayout4i8=wt,s.StructArrayLayout5f20=Ki,s.Texture=by,s.Tile=PT,s.Transitionable=Z,s.Uniform1f=b1,s.Uniform1i=class extends Ac{constructor(c){super(c),this.current=0}set(c,a,u){this.fetchUniformLocation(c,a)&&this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}},s.Uniform2f=class extends Ac{constructor(c){super(c),this.current=[0,0]}set(c,a,u){this.fetchUniformLocation(c,a)&&(u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1])))}},s.Uniform3f=class extends Ac{constructor(c){super(c),this.current=[0,0,0]}set(c,a,u){this.fetchUniformLocation(c,a)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2])))}},s.Uniform4f=pR,s.UniformColor=mR,s.UniformMatrix2f=class extends Ac{constructor(c){super(c),this.current=d$}set(c,a,u){if(this.fetchUniformLocation(c,a)){for(let f=0;f<4;f++)if(u[f]!==this.current[f]){this.current=u,this.gl.uniformMatrix2fv(this.location,!1,u);break}}}},s.UniformMatrix3f=class extends Ac{constructor(c){super(c),this.current=h$}set(c,a,u){if(this.fetchUniformLocation(c,a)){for(let f=0;f<9;f++)if(u[f]!==this.current[f]){this.current=u,this.gl.uniformMatrix3fv(this.location,!1,u);break}}}},s.UniformMatrix4f=class extends Ac{constructor(c){super(c),this.current=u$}set(c,a,u){if(this.fetchUniformLocation(c,a)){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let f=1;f<16;f++)if(u[f]!==this.current[f]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}}},s.UnwrappedTileID=xL,s.ValidationError=ln,s.VectorTileFeature=k1,s.VectorTileWorkerSource=class extends Mo{constructor(c,a,u,f,g){super(),this.actor=c,this.layerIndex=a,this.availableImages=u,this.loadVectorData=g||RO,this.loading={},this.loaded={},this.deduped=new MO(c.scheduler),this.isSpriteLoaded=f,this.scheduler=c.scheduler}loadTile(c,a){const u=c.uid,f=c&&c.request,g=f&&f.collectResourceTiming,b=this.loading[u]=new kH(c);b.abort=this.loadVectorData(c,(E,C)=>{const P=!this.loading[u];if(delete this.loading[u],P||E||!C)return b.status="done",P||(this.loaded[u]=b),a(E);const M=C.rawData,D={};C.expires&&(D.expires=C.expires),C.cacheControl&&(D.cacheControl=C.cacheControl),b.vectorTile=C.vectorTile||new dT(new V1(M));const N=()=>{b.parse(b.vectorTile,this.layerIndex,this.availableImages,this.actor,(V,H)=>{if(V||!H)return a(V);const W={};if(g){const Q=Xo(f);Q.length>0&&(W.resourceTiming=JSON.parse(JSON.stringify(Q)))}a(null,An({rawTileData:M.slice(0)},H,D,W))})};this.isSpriteLoaded?N():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(N,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom}):N()}),this.loaded=this.loaded||{},this.loaded[u]=b})}reloadTile(c,a){const u=this.loaded,f=c.uid,g=this;if(u&&u[f]){const b=u[f];b.showCollisionBoxes=c.showCollisionBoxes,b.enableTerrain=!!c.enableTerrain,b.projection=c.projection,b.tileTransform=bd(c.tileID.canonical,c.projection);const E=(C,P)=>{const M=b.reloadCallback;M&&(delete b.reloadCallback,b.parse(b.vectorTile,g.layerIndex,this.availableImages,g.actor,M)),a(C,P)};b.status==="parsing"?b.reloadCallback=E:b.status==="done"&&(b.vectorTile?b.parse(b.vectorTile,this.layerIndex,this.availableImages,this.actor,E):E())}}abortTile(c,a){const u=c.uid,f=this.loading[u];f&&(f.abort&&f.abort(),delete this.loading[u]),a()}removeTile(c,a){const u=this.loaded,f=c.uid;u&&u[f]&&delete u[f],a()}},s.WritingMode=ua,s.ZoomDependentExpression=nd,s.add=Ic,s.addDynamicAttributes=Y1,s.adjoint=function(c,a){var u=a[0],f=a[1],g=a[2],b=a[3],E=a[4],C=a[5],P=a[6],M=a[7],D=a[8];return c[0]=E*D-C*M,c[1]=g*M-f*D,c[2]=f*C-g*E,c[3]=C*P-b*D,c[4]=u*D-g*P,c[5]=g*b-u*C,c[6]=b*M-E*P,c[7]=f*P-u*M,c[8]=u*E-f*b,c},s.asyncAll=pn,s.bezier=et,s.bindAll=Ke,s.boundsAttributes=fO,s.bufferConvexPolygon=function(c,a){const u=[];for(let f=0;f<c.length;f++){const g=cn(f-1,-1,c.length-1),b=cn(f+1,-1,c.length-1),E=c[f],C=c[b],P=c[g].sub(E).unit(),M=C.sub(E).unit(),D=M.angleWithSep(P.x,P.y),N=P.add(M).unit().mult(-1*a/Math.sin(D/2));u.push(E.add(N))}return u},s.cacheEntryPossiblyAdded=function(c){rt++,rt>ei&&(c.getActor().send("enforceCacheSizeLimit",zn),rt=0)},s.calculateGlobeLabelMatrix=function(c,a){const{x:u,y:f}=c.point,g=zR(u,f,c.worldSize/c._pixelsPerMercatorPixel,0,0);return dd(g,g,KE(zl(a)))},s.calculateGlobeMatrix=function(c){const{x:a,y:u}=c.point,{lng:f,lat:g}=c._center;return zR(a,u,c.worldSize,f,g)},s.calculateGlobeMercatorMatrix=function(c){const a=c.pixelsPerMeter,u=a/ll(1,c.center.lat),f=sl(new Float64Array(16));return Wg(f,f,[c.point.x,c.point.y,0]),fd(f,f,[u,u,a]),Float32Array.from(f)},s.circumferenceAtLatitude=ZE,s.clamp=bt,s.clearTileCache=function(c){if(!ie())return;const a=d.caches.delete(En);c&&a.catch(c).then(()=>c())},s.clipLine=ZL,s.clone=function(c){var a=new Us(16);return a[0]=c[0],a[1]=c[1],a[2]=c[2],a[3]=c[3],a[4]=c[4],a[5]=c[5],a[6]=c[6],a[7]=c[7],a[8]=c[8],a[9]=c[9],a[10]=c[10],a[11]=c[11],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15],a},s.clone$1=Ae,s.collisionCircleLayout=OG,s.config=v,s.conjugate=function(c,a){return c[0]=-a[0],c[1]=-a[1],c[2]=-a[2],c[3]=a[3],c},s.create=function(){var c=new Us(16);return Us!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c},s.create$1=vR,s.createExpression=Lu,s.createLayout=Xe,s.createStyleLayer=function(c){return c.type==="custom"?new TH(c):new CH[c.type](c)},s.cross=UE,s.degToRad=be,s.distance=function(c,a){return Math.hypot(a[0]-c[0],a[1]-c[1],a[2]-c[2])},s.div=function(c,a,u){return c[0]=a[0]/u[0],c[1]=a[1]/u[1],c[2]=a[2]/u[2],c},s.dot=Ra,s.earthRadius=ny,s.ease=Et,s.easeCubicInOut=ut,s.ecefToLatLng=function([c,a,u]){const f=Math.hypot(c,a,u),g=Math.atan2(c,u),b=.5*Math.PI-Math.acos(-a/f);return new Zi(Te(g),Te(b))},s.emitValidationErrors=p1,s.endsWith=ht,s.enforceCacheSizeLimit=function(c){K(),ti&&ti.then(a=>{a.keys().then(u=>{for(let f=0;f<u.length-c;f++)a.delete(u[f])})})},s.evaluateSizeForFeature=N1,s.evaluateSizeForZoom=dp,s.evaluateVariableOffset=eO,s.evented=S,s.exactEquals=function(c,a){return c[0]===a[0]&&c[1]===a[1]&&c[2]===a[2]&&c[3]===a[3]},s.exactEquals$1=function(c,a){return c[0]===a[0]&&c[1]===a[1]&&c[2]===a[2]},s.exported=bo,s.exported$1=w,s.extend=An,s.extend$1=No,s.fillExtrusionHeightLift=vL,s.filterObject=ae,s.fromMat4=function(c,a){return c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[4],c[4]=a[5],c[5]=a[6],c[6]=a[8],c[7]=a[9],c[8]=a[10],c},s.fromQuat=function(c,a){var u=a[0],f=a[1],g=a[2],b=a[3],E=u+u,C=f+f,P=g+g,M=u*E,D=f*E,N=f*C,V=g*E,H=g*C,W=g*P,Q=b*E,oe=b*C,xe=b*P;return c[0]=1-N-W,c[1]=D+xe,c[2]=V-oe,c[3]=0,c[4]=D-xe,c[5]=1-M-W,c[6]=H+Q,c[7]=0,c[8]=V+oe,c[9]=H-Q,c[10]=1-M-N,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c},s.fromRotation=function(c,a){var u=Math.sin(a),f=Math.cos(a);return c[0]=f,c[1]=u,c[2]=0,c[3]=-u,c[4]=f,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},s.fromScaling=bR,s.furthestTileCorner=function(c){const a=Math.round((c+45+360)%360/90)%4;return ke[a]},s.getAABBPointSquareDist=function(c,a,u){let f=0;for(let g=0;g<2;++g){const b=u?u[g]:0;c[g]>b&&(f+=(c[g]-b)*(c[g]-b)),a[g]<b&&(f+=(b-a[g])*(b-a[g]))}return f},s.getAnchorAlignment=_T,s.getAnchorJustification=wT,s.getBounds=function(c){let a=1/0,u=1/0,f=-1/0,g=-1/0;for(const b of c)a=Math.min(a,b.x),u=Math.min(u,b.y),f=Math.max(f,b.x),g=Math.max(g,b.y);return{min:new J(a,u),max:new J(f,g)}},s.getColumn=hn,s.getDefaultExportFromCjs=G,s.getGridMatrix=function(c,a,u,f){const g=a.getNorth(),b=a.getSouth(),E=a.getWest(),C=a.getEast(),P=1<<c.z,M=C-E,D=g-b,N=M/md,V=-D/Qg[u],H=[0,N,0,V,0,0,g,E,0];if(c.z>0){const W=180/f;_R(H,H,[W/M+1,0,0,0,W/D+1,0,-.5*W/N,.5*W/V,1])}return H[2]=P,H[5]=c.x,H[8]=c.y,H},s.getImage=de,s.getJSON=function(c,a){return bn(An(c,{type:"json"}),a)},s.getLatitudinalLod=function(c){const a=$o-5;c=bt(c,-a,a)/a*90;const u=Math.pow(Math.abs(Math.sin(be(c))),3);return Math.round(u*(Qg.length-1))},s.getMapSessionAPI=Cr,s.getPerformanceMeasurement=Xo,s.getProjection=lO,s.getRTLTextPluginStatus=A,s.getReferrer=en,s.getTilePoint=function(c,{x:a,y:u},f=0){return new J(((a-f)*c.scale-c.x)*On,(u*c.scale-c.y)*On)},s.getTileVec3=function(c,a,u=0){return ip(((a.x-u)*c.scale-c.x)*On,(a.y*c.scale-c.y)*On,jR(a.z,a.y))},s.getVideo=function(c,a){const u=d.document.createElement("video");u.muted=!0,u.onloadstart=function(){a(null,u)};for(let f=0;f<c.length;f++){const g=d.document.createElement("source");Pn(c[f])||(u.crossOrigin="Anonymous"),g.src=c[f],u.appendChild(g)}return{cancel:()=>{}}},s.globeCenterToScreenPoint=function(c){const a=[0,0,0],u=sl(new Float64Array(16));return dd(u,c.pixelMatrix,c.globeMatrix),zr(a,a,u),new J(a[0],a[1])},s.globeDenormalizeECEF=KE,s.globeECEFOrigin=function(c,a){const u=[0,0,0];return zr(u,u,ty(zl(a.canonical))),zr(u,u,c),u},s.globeMetersToEcef=E1,s.globeNormalizeECEF=ty,s.globePixelsToTileUnits=function(c,a){return On/(512*Math.pow(2,c))*S1(zl(a))},s.globePoleMatrixForTile=function(c,a,u){const f=sl(new Float64Array(16)),g=(a/(1<<c)-.5)*Math.PI*2;return w1(f,u.globeMatrix,g),Float32Array.from(f)},s.globeTileBounds=zl,s.globeTiltAtLngLat=NR,s.globeToMercatorTransition=sp,s.globeUseCustomAntiAliasing=function(c,a,u){const f=sp(u.zoom),g=c.style.map._antialias,b=!!a.extStandardDerivatives,E=a.extStandardDerivativesForceOff||c.terrain&&c.terrain.exaggeration()>0;return f===0&&!g&&!E&&b},s.identity=sl,s.identity$1=PR,s.invert=FE,s.isFullscreen=function(){return!!d.document.fullscreenElement||!!d.document.webkitFullscreenElement},s.isLngLatBehindGlobe=XE,s.isMapAuthenticated=function(c){return Kr.has(c)},s.isMapboxURL=$e,s.isSafariWithAntialiasingBug=function(c){const a=c.navigator?c.navigator.userAgent:null;return!!It(c)&&a&&(a.match("Version/15.4")||a.match("Version/15.5")||a.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},s.latFromMercatorY=jo,s.latLngToECEF=op,s.len=x$,s.length=Kg,s.length$1=function(c){return Math.hypot(c[0],c[1],c[2],c[3])},s.lngFromMercatorX=ca,s.loadVectorTile=RO,s.makeRequest=bn,s.mapValue=function(c,a,u,f,g){return bt((c-a)/(u-a)*(g-f)+f,f,g)},s.mercatorScale=$R,s.mercatorXfromLng=Nl,s.mercatorYfromLat=Ul,s.mercatorZfromAltitude=ll,s.mul=_$,s.mul$1=b$,s.multiply=dd,s.multiply$1=_R,s.multiply$2=ER,s.nextPowerOfTwo=We,s.normalize=rs,s.normalize$1=w$,s.normalize$2=CR,s.number=Ci,s.ortho=function(c,a,u,f,g,b,E){var C=1/(a-u),P=1/(f-g),M=1/(b-E);return c[0]=-2*C,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*P,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*M,c[11]=0,c[12]=(a+u)*C,c[13]=(g+f)*P,c[14]=(E+b)*M,c[15]=1,c},s.pbf=PL,s.perspective=function(c,a,u,f,g){var b,E=1/Math.tan(a/2);return c[0]=E/u,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=E,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,g!=null&&g!==1/0?(c[10]=(g+f)*(b=1/(f-g)),c[14]=2*g*f*b):(c[10]=-1,c[14]=-2*f),c},s.pick=function(c,a){const u={};for(let f=0;f<a.length;f++){const g=a[f];g in c&&(u[g]=c[g])}return u},s.plugin=O,s.pointGeometry=ye,s.polesInViewport=function(c){const a=sl(new Float64Array(16));dd(a,c.pixelMatrix,c.globeMatrix);const u=[0,La,0],f=[0,Oa,0];return zr(u,u,a),zr(f,f,a),[u[0]>0&&u[0]<=c.width&&u[1]>0&&u[1]<=c.height&&!XE(c,new Zi(c.center.lat,90)),f[0]>0&&f[0]<=c.width&&f[1]>0&&f[1]<=c.height&&!XE(c,new Zi(c.center.lat,-90))]},s.polygonContainsPoint=vd,s.polygonIntersectsBox=qR,s.polygonIntersectsPolygon=WR,s.polygonizeBounds=function(c,a,u=0,f=!0){const g=new J(u,u),b=c.sub(g),E=a.add(g),C=[b,new J(E.x,b.y),E,new J(b.x,E.y)];return f&&C.push(b.clone()),C},s.posAttributes=Jg,s.postMapLoadEvent=hr,s.postPerformanceEvent=xr,s.postTurnstileEvent=mi,s.potpack=gT,s.prevPowerOfTwo=function(c){return c<=1?1:Math.pow(2,Math.floor(Math.log(c)/Math.LN2))},s.radToDeg=Te,s.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.registerForPluginStateChange=function(c){return c({pluginStatus:_,pluginURL:h}),S.on("pluginStateChange",c),c},s.removeAuthState=function(c){Kr.delete(c)},s.renderColorRamp=iT,s.resample=GR,s.rotateX=BE,s.rotateX$1=IR,s.rotateY=w1,s.rotateY$1=MR,s.rotateZ=function(c,a,u){var f=Math.sin(u),g=Math.cos(u),b=a[0],E=a[1],C=a[2],P=a[3],M=a[4],D=a[5],N=a[6],V=a[7];return a!==c&&(c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]),c[0]=b*g+M*f,c[1]=E*g+D*f,c[2]=C*g+N*f,c[3]=P*g+V*f,c[4]=M*g-b*f,c[5]=D*g-E*f,c[6]=N*g-C*f,c[7]=V*g-P*f,c},s.rotateZ$1=function(c,a,u){u*=.5;var f=a[0],g=a[1],b=a[2],E=a[3],C=Math.sin(u),P=Math.cos(u);return c[0]=f*P+g*C,c[1]=g*P-f*C,c[2]=b*P+E*C,c[3]=E*P-b*C,c},s.scale=fd,s.scale$1=SR,s.scale$2=la,s.scaleAndAdd=qg,s.set=function(c,a,u,f){return c[0]=a,c[1]=u,c[2]=f,c},s.setCacheLimits=function(c,a){zn=c,ei=a},s.setColumn=function(c,a,u){c[4*a+0]=u[0],c[4*a+1]=u[1],c[4*a+2]=u[2],c[4*a+3]=u[3]},s.setRTLTextPlugin=function(c,a,u=!1){if(_===Vg||_===jg||_===$g)throw new Error("setRTLTextPlugin cannot be called multiple times.");h=bo.resolveURL(c),_=Vg,Fu=a,x(),u||R()},s.smoothstep=Qt,s.spec=yt,s.squaredLength=function(c){var a=c[0],u=c[1],f=c[2];return a*a+u*u+f*f},s.storeAuthState=function(c,a){a?Kr.add(c):Kr.delete(c)},s.sub=al,s.subtract=NE,s.symbolSize=DG,s.tileAABB=function(c,a,u,f,g,b,E,C,P){if(P.name==="globe")return A$(c,a,new B1(u,f,g));const M=bd({z:u,x:f,y:g},P);return new os([(b+M.x/M.scale)*a,a*(M.y/M.scale),E],[(b+M.x2/M.scale)*a,a*(M.y2/M.scale),C])},s.tileCornersToBounds=T1,s.tileTransform=bd,s.transformMat3=function(c,a,u){var f=a[0],g=a[1],b=a[2];return c[0]=f*u[0]+g*u[3]+b*u[6],c[1]=f*u[1]+g*u[4]+b*u[7],c[2]=f*u[2]+g*u[5]+b*u[8],c},s.transformMat4=zr,s.transformMat4$1=pd,s.transformQuat=TR,s.transitionTileAABBinECEF=kR,s.translate=Wg,s.transpose=function(c,a){if(c===a){var u=a[1],f=a[2],g=a[5];c[1]=a[3],c[2]=a[6],c[3]=u,c[5]=a[7],c[6]=f,c[7]=g}else c[0]=a[0],c[1]=a[3],c[2]=a[6],c[3]=a[1],c[4]=a[4],c[5]=a[7],c[6]=a[2],c[7]=a[5],c[8]=a[8];return c},s.triggerPluginCompletionEvent=m,s.uniqueId=Bn,s.updateGlobeVertexNormal=function(c,a,u,f,g){const b=5*a+2;c.float32[b+0]=u,c.float32[b+1]=f,c.float32[b+2]=g},s.validateCustomStyleLayer=function(c){const a=[],u=c.id;return u===void 0&&a.push({message:`layers.${u}: missing required property "id"`}),c.render===void 0&&a.push({message:`layers.${u}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&a.push({message:`layers.${u}: property "renderingMode" must be either "2d" or "3d"`}),a},s.validateFilter=c=>zs(ad(c)),s.validateFog=c=>zs(h1(c)),s.validateLayer=c=>zs(a1(c)),s.validateLight=c=>zs(u1(c)),s.validateSource=c=>zs(c1(c)),s.validateStyle=f1,s.validateTerrain=c=>zs(Fg(c)),s.values=xn,s.vectorTile=D1,s.version=p,s.warnOnce=tt,s.window=d,s.wrap=cn}),o(["./shared"],function(s){function d(ue){if(typeof ue=="number"||typeof ue=="boolean"||typeof ue=="string"||ue==null)return JSON.stringify(ue);if(Array.isArray(ue)){let te="[";for(const de of ue)te+=`${d(de)},`;return`${te}]`}let X="{";for(const te of Object.keys(ue).sort())X+=`${te}:${d(ue[te])},`;return`${X}}`}function p(ue){let X="";for(const te of s.refProperties)X+=`/${d(ue[te])}`;return X}class y{constructor(X){this.keyCache={},X&&this.replace(X)}replace(X){this._layerConfigs={},this._layers={},this.update(X,[])}update(X,te){for(const Pe of X)this._layerConfigs[Pe.id]=Pe,(this._layers[Pe.id]=s.createStyleLayer(Pe)).compileFilter(),this.keyCache[Pe.id]&&delete this.keyCache[Pe.id];for(const Pe of te)delete this.keyCache[Pe],delete this._layerConfigs[Pe],delete this._layers[Pe];this.familiesBySource={};const de=function(Pe,$e){const Je={};for(let Ge=0;Ge<Pe.length;Ge++){const ct=$e&&$e[Pe[Ge].id]||p(Pe[Ge]);$e&&($e[Pe[Ge].id]=ct);let Ht=Je[ct];Ht||(Ht=Je[ct]=[]),Ht.push(Pe[Ge])}const qe=[];for(const Ge in Je)qe.push(Je[Ge]);return qe}(s.values(this._layerConfigs),this.keyCache);for(const Pe of de){const $e=Pe.map(Xt=>this._layers[Xt.id]),Je=$e[0];if(Je.visibility==="none")continue;const qe=Je.source||"";let Ge=this.familiesBySource[qe];Ge||(Ge=this.familiesBySource[qe]={});const ct=Je.sourceLayer||"_geojsonTileLayer";let Ht=Ge[ct];Ht||(Ht=Ge[ct]=[]),Ht.push($e)}}}class v{loadTile(X,te){const{uid:de,encoding:Pe,rawImageData:$e,padding:Je,buildQuadTree:qe}=X,Ge=s.window.ImageBitmap&&$e instanceof s.window.ImageBitmap?this.getImageData($e,Je):$e;te(null,new s.DEMData(de,Ge,Pe,Je<1,qe))}getImageData(X,te){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(X.width,X.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=X.width,this.offscreenCanvas.height=X.height,this.offscreenCanvasContext.drawImage(X,0,0,X.width,X.height);const de=this.offscreenCanvasContext.getImageData(-te,-te,X.width+2*te,X.height+2*te);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),de}}function w(ue,X){if(ue.length!==0){T(ue[0],X);for(var te=1;te<ue.length;te++)T(ue[te],!X)}}function T(ue,X){for(var te=0,de=0,Pe=0,$e=ue.length,Je=$e-1;Pe<$e;Je=Pe++){var qe=(ue[Pe][0]-ue[Je][0])*(ue[Je][1]+ue[Pe][1]),Ge=te+qe;de+=Math.abs(te)>=Math.abs(qe)?te-Ge+qe:qe-Ge+te,te=Ge}te+de>=0!=!!X&&ue.reverse()}var I=s.getDefaultExportFromCjs(function ue(X,te){var de,Pe=X&&X.type;if(Pe==="FeatureCollection")for(de=0;de<X.features.length;de++)ue(X.features[de],te);else if(Pe==="GeometryCollection")for(de=0;de<X.geometries.length;de++)ue(X.geometries[de],te);else if(Pe==="Feature")ue(X.geometry,te);else if(Pe==="Polygon")w(X.coordinates,te);else if(Pe==="MultiPolygon")for(de=0;de<X.coordinates.length;de++)w(X.coordinates[de],te);return X});const L=s.VectorTileFeature.prototype.toGeoJSON;var k={exports:{}},F=s.pointGeometry,B=s.vectorTile.VectorTileFeature,G=U;function U(ue,X){this.options=X||{},this.features=ue,this.length=ue.length}function ee(ue,X){this.id=typeof ue.id=="number"?ue.id:void 0,this.type=ue.type,this.rawGeometry=ue.type===1?[ue.geometry]:ue.geometry,this.properties=ue.tags,this.extent=X||4096}U.prototype.feature=function(ue){return new ee(this.features[ue],this.options.extent)},ee.prototype.loadGeometry=function(){var ue=this.rawGeometry;this.geometry=[];for(var X=0;X<ue.length;X++){for(var te=ue[X],de=[],Pe=0;Pe<te.length;Pe++)de.push(new F(te[Pe][0],te[Pe][1]));this.geometry.push(de)}return this.geometry},ee.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ue=this.geometry,X=1/0,te=-1/0,de=1/0,Pe=-1/0,$e=0;$e<ue.length;$e++)for(var Je=ue[$e],qe=0;qe<Je.length;qe++){var Ge=Je[qe];X=Math.min(X,Ge.x),te=Math.max(te,Ge.x),de=Math.min(de,Ge.y),Pe=Math.max(Pe,Ge.y)}return[X,de,te,Pe]},ee.prototype.toGeoJSON=B.prototype.toGeoJSON;var ne=s.pbf,ye=G;function fe(ue){var X=new ne;return function(te,de){for(var Pe in te.layers)de.writeMessage(3,J,te.layers[Pe])}(ue,X),X.finish()}function J(ue,X){var te;X.writeVarintField(15,ue.version||1),X.writeStringField(1,ue.name||""),X.writeVarintField(5,ue.extent||4096);var de={keys:[],values:[],keycache:{},valuecache:{}};for(te=0;te<ue.length;te++)de.feature=ue.feature(te),X.writeMessage(2,Ce,de);var Pe=de.keys;for(te=0;te<Pe.length;te++)X.writeStringField(3,Pe[te]);var $e=de.values;for(te=0;te<$e.length;te++)X.writeMessage(4,ut,$e[te])}function Ce(ue,X){var te=ue.feature;te.id!==void 0&&X.writeVarintField(1,te.id),X.writeMessage(2,me,ue),X.writeVarintField(3,te.type),X.writeMessage(4,ke,te)}function me(ue,X){var te=ue.feature,de=ue.keys,Pe=ue.values,$e=ue.keycache,Je=ue.valuecache;for(var qe in te.properties){var Ge=te.properties[qe],ct=$e[qe];if(Ge!==null){ct===void 0&&(de.push(qe),$e[qe]=ct=de.length-1),X.writeVarint(ct);var Ht=typeof Ge;Ht!=="string"&&Ht!=="boolean"&&Ht!=="number"&&(Ge=JSON.stringify(Ge));var Xt=Ht+":"+Ge,Ft=Je[Xt];Ft===void 0&&(Pe.push(Ge),Je[Xt]=Ft=Pe.length-1),X.writeVarint(Ft)}}}function be(ue,X){return(X<<3)+(7&ue)}function Te(ue){return ue<<1^ue>>31}function ke(ue,X){for(var te=ue.loadGeometry(),de=ue.type,Pe=0,$e=0,Je=te.length,qe=0;qe<Je;qe++){var Ge=te[qe],ct=1;de===1&&(ct=Ge.length),X.writeVarint(be(1,ct));for(var Ht=de===3?Ge.length-1:Ge.length,Xt=0;Xt<Ht;Xt++){Xt===1&&de!==1&&X.writeVarint(be(2,Ht-1));var Ft=Ge[Xt].x-Pe,qn=Ge[Xt].y-$e;X.writeVarint(Te(Ft)),X.writeVarint(Te(qn)),Pe+=Ft,$e+=qn}de===3&&X.writeVarint(be(7,1))}}function ut(ue,X){var te=typeof ue;te==="string"?X.writeStringField(1,ue):te==="boolean"?X.writeBooleanField(7,ue):te==="number"&&(ue%1!=0?X.writeDoubleField(3,ue):ue<0?X.writeSVarintField(6,ue):X.writeVarintField(5,ue))}k.exports=fe,k.exports.fromVectorTileJs=fe,k.exports.fromGeojsonVt=function(ue,X){X=X||{};var te={};for(var de in ue)te[de]=new ye(ue[de].features,X),te[de].name=de,te[de].version=X.version,te[de].extent=X.extent;return fe({layers:te})},k.exports.GeoJSONWrapper=ye;var et=s.getDefaultExportFromCjs(k.exports);const Et={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ue=>ue},bt=Math.fround||(Qt=new Float32Array(1),ue=>(Qt[0]=+ue,Qt[0]));var Qt;const cn=3,pn=5,xn=6;class An{constructor(X){this.options=Object.assign(Object.create(Et),X),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(X){const{log:te,minZoom:de,maxZoom:Pe}=this.options;te&&console.time("total time");const $e=`prepare ${X.length} points`;te&&console.time($e),this.points=X;const Je=[];for(let Ge=0;Ge<X.length;Ge++){const ct=X[Ge];if(!ct.geometry)continue;const[Ht,Xt]=ct.geometry.coordinates,Ft=bt(Nt(Ht)),qn=bt(We(Xt));Je.push(Ft,qn,1/0,Ge,-1,1),this.options.reduce&&Je.push(0)}let qe=this.trees[Pe+1]=this._createTree(Je);te&&console.timeEnd($e);for(let Ge=Pe;Ge>=de;Ge--){const ct=+Date.now();qe=this.trees[Ge]=this._createTree(this._cluster(qe,Ge)),te&&console.log("z%d: %d clusters in %dms",Ge,qe.numItems,+Date.now()-ct)}return te&&console.timeEnd("total time"),this}getClusters(X,te){let de=((X[0]+180)%360+360)%360-180;const Pe=Math.max(-90,Math.min(90,X[1]));let $e=X[2]===180?180:((X[2]+180)%360+360)%360-180;const Je=Math.max(-90,Math.min(90,X[3]));if(X[2]-X[0]>=360)de=-180,$e=180;else if(de>$e){const Xt=this.getClusters([de,Pe,180,Je],te),Ft=this.getClusters([-180,Pe,$e,Je],te);return Xt.concat(Ft)}const qe=this.trees[this._limitZoom(te)],Ge=qe.range(Nt(de),We(Je),Nt($e),We(Pe)),ct=qe.data,Ht=[];for(const Xt of Ge){const Ft=this.stride*Xt;Ht.push(ct[Ft+pn]>1?kn(ct,Ft,this.clusterProps):this.points[ct[Ft+cn]])}return Ht}getChildren(X){const te=this._getOriginId(X),de=this._getOriginZoom(X),Pe="No cluster with the specified id.",$e=this.trees[de];if(!$e)throw new Error(Pe);const Je=$e.data;if(te*this.stride>=Je.length)throw new Error(Pe);const qe=this.options.radius/(this.options.extent*Math.pow(2,de-1)),Ge=$e.within(Je[te*this.stride],Je[te*this.stride+1],qe),ct=[];for(const Ht of Ge){const Xt=Ht*this.stride;Je[Xt+4]===X&&ct.push(Je[Xt+pn]>1?kn(Je,Xt,this.clusterProps):this.points[Je[Xt+cn]])}if(ct.length===0)throw new Error(Pe);return ct}getLeaves(X,te,de){const Pe=[];return this._appendLeaves(Pe,X,te=te||10,de=de||0,0),Pe}getTile(X,te,de){const Pe=this.trees[this._limitZoom(X)],$e=Math.pow(2,X),{extent:Je,radius:qe}=this.options,Ge=qe/Je,ct=(de-Ge)/$e,Ht=(de+1+Ge)/$e,Xt={features:[]};return this._addTileFeatures(Pe.range((te-Ge)/$e,ct,(te+1+Ge)/$e,Ht),Pe.data,te,de,$e,Xt),te===0&&this._addTileFeatures(Pe.range(1-Ge/$e,ct,1,Ht),Pe.data,$e,de,$e,Xt),te===$e-1&&this._addTileFeatures(Pe.range(0,ct,Ge/$e,Ht),Pe.data,-1,de,$e,Xt),Xt.features.length?Xt:null}getClusterExpansionZoom(X){let te=this._getOriginZoom(X)-1;for(;te<=this.options.maxZoom;){const de=this.getChildren(X);if(te++,de.length!==1)break;X=de[0].properties.cluster_id}return te}_appendLeaves(X,te,de,Pe,$e){const Je=this.getChildren(te);for(const qe of Je){const Ge=qe.properties;if(Ge&&Ge.cluster?$e+Ge.point_count<=Pe?$e+=Ge.point_count:$e=this._appendLeaves(X,Ge.cluster_id,de,Pe,$e):$e<Pe?$e++:X.push(qe),X.length===de)break}return $e}_createTree(X){const te=new s.KDBush(X.length/this.stride|0,this.options.nodeSize,Float32Array);for(let de=0;de<X.length;de+=this.stride)te.add(X[de],X[de+1]);return te.finish(),te.data=X,te}_addTileFeatures(X,te,de,Pe,$e,Je){for(const qe of X){const Ge=qe*this.stride,ct=te[Ge+pn]>1;let Ht,Xt,Ft;if(ct)Ht=Bn(te,Ge,this.clusterProps),Xt=te[Ge],Ft=te[Ge+1];else{const Yn=this.points[te[Ge+cn]];Ht=Yn.properties;const[ii,mi]=Yn.geometry.coordinates;Xt=Nt(ii),Ft=We(mi)}const qn={type:1,geometry:[[Math.round(this.options.extent*(Xt*$e-de)),Math.round(this.options.extent*(Ft*$e-Pe))]],tags:Ht};let ci;ci=ct||this.options.generateId?te[Ge+cn]:this.points[te[Ge+cn]].id,ci!==void 0&&(qn.id=ci),Je.features.push(qn)}}_limitZoom(X){return Math.max(this.options.minZoom,Math.min(Math.floor(+X),this.options.maxZoom+1))}_cluster(X,te){const{radius:de,extent:Pe,reduce:$e,minPoints:Je}=this.options,qe=de/(Pe*Math.pow(2,te)),Ge=X.data,ct=[],Ht=this.stride;for(let Xt=0;Xt<Ge.length;Xt+=Ht){if(Ge[Xt+2]<=te)continue;Ge[Xt+2]=te;const Ft=Ge[Xt],qn=Ge[Xt+1],ci=X.within(Ge[Xt],Ge[Xt+1],qe),Yn=Ge[Xt+pn];let ii=Yn;for(const mi of ci){const Vi=mi*Ht;Ge[Vi+2]>te&&(ii+=Ge[Vi+pn])}if(ii>Yn&&ii>=Je){let mi,Vi=Ft*Yn,hr=qn*Yn,Fr=-1;const xr=((Xt/Ht|0)<<5)+(te+1)+this.points.length;for(const Ko of ci){const Cr=Ko*Ht;if(Ge[Cr+2]<=te)continue;Ge[Cr+2]=te;const Kr=Ge[Cr+pn];Vi+=Ge[Cr]*Kr,hr+=Ge[Cr+1]*Kr,Ge[Cr+4]=xr,$e&&(mi||(mi=this._map(Ge,Xt,!0),Fr=this.clusterProps.length,this.clusterProps.push(mi)),$e(mi,this._map(Ge,Cr)))}Ge[Xt+4]=xr,ct.push(Vi/ii,hr/ii,1/0,xr,-1,ii),$e&&ct.push(Fr)}else{for(let mi=0;mi<Ht;mi++)ct.push(Ge[Xt+mi]);if(ii>1)for(const mi of ci){const Vi=mi*Ht;if(!(Ge[Vi+2]<=te)){Ge[Vi+2]=te;for(let hr=0;hr<Ht;hr++)ct.push(Ge[Vi+hr])}}}}return ct}_getOriginId(X){return X-this.points.length>>5}_getOriginZoom(X){return(X-this.points.length)%32}_map(X,te,de){if(X[te+pn]>1){const Je=this.clusterProps[X[te+xn]];return de?Object.assign({},Je):Je}const Pe=this.points[X[te+cn]].properties,$e=this.options.map(Pe);return de&&$e===Pe?Object.assign({},$e):$e}}function kn(ue,X,te){return{type:"Feature",id:ue[X+cn],properties:Bn(ue,X,te),geometry:{type:"Point",coordinates:[(de=ue[X],360*(de-.5)),kt(ue[X+1])]}};var de}function Bn(ue,X,te){const de=ue[X+pn],Pe=de>=1e4?`${Math.round(de/1e3)}k`:de>=1e3?Math.round(de/100)/10+"k":de,$e=ue[X+xn],Je=$e===-1?{}:Object.assign({},te[$e]);return Object.assign(Je,{cluster:!0,cluster_id:ue[X+cn],point_count:de,point_count_abbreviated:Pe})}function Nt(ue){return ue/360+.5}function We(ue){const X=Math.sin(ue*Math.PI/180),te=.5-.25*Math.log((1+X)/(1-X))/Math.PI;return te<0?0:te>1?1:te}function kt(ue){const X=(180-360*ue)*Math.PI/180;return 360*Math.atan(Math.exp(X))/Math.PI-90}function Ke(ue,X,te,de){for(var Pe,$e=de,Je=te-X>>1,qe=te-X,Ge=ue[X],ct=ue[X+1],Ht=ue[te],Xt=ue[te+1],Ft=X+3;Ft<te;Ft+=3){var qn=ht(ue[Ft],ue[Ft+1],Ge,ct,Ht,Xt);if(qn>$e)Pe=Ft,$e=qn;else if(qn===$e){var ci=Math.abs(Ft-Je);ci<qe&&(Pe=Ft,qe=ci)}}$e>de&&(Pe-X>3&&Ke(ue,X,Pe,de),ue[Pe+2]=$e,te-Pe>3&&Ke(ue,Pe,te,de))}function ht(ue,X,te,de,Pe,$e){var Je=Pe-te,qe=$e-de;if(Je!==0||qe!==0){var Ge=((ue-te)*Je+(X-de)*qe)/(Je*Je+qe*qe);Ge>1?(te=Pe,de=$e):Ge>0&&(te+=Je*Ge,de+=qe*Ge)}return(Je=ue-te)*Je+(qe=X-de)*qe}function Pt(ue,X,te,de){var Pe={id:ue===void 0?null:ue,type:X,geometry:te,tags:de,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function($e){var Je=$e.geometry,qe=$e.type;if(qe==="Point"||qe==="MultiPoint"||qe==="LineString")ae($e,Je);else if(qe==="Polygon"||qe==="MultiLineString")for(var Ge=0;Ge<Je.length;Ge++)ae($e,Je[Ge]);else if(qe==="MultiPolygon")for(Ge=0;Ge<Je.length;Ge++)for(var ct=0;ct<Je[Ge].length;ct++)ae($e,Je[Ge][ct])}(Pe),Pe}function ae(ue,X){for(var te=0;te<X.length;te+=3)ue.minX=Math.min(ue.minX,X[te]),ue.minY=Math.min(ue.minY,X[te+1]),ue.maxX=Math.max(ue.maxX,X[te]),ue.maxY=Math.max(ue.maxY,X[te+1])}function Ae(ue,X,te,de){if(X.geometry){var Pe=X.geometry.coordinates,$e=X.geometry.type,Je=Math.pow(te.tolerance/((1<<te.maxZoom)*te.extent),2),qe=[],Ge=X.id;if(te.promoteId?Ge=X.properties[te.promoteId]:te.generateId&&(Ge=de||0),$e==="Point")je(Pe,qe);else if($e==="MultiPoint")for(var ct=0;ct<Pe.length;ct++)je(Pe[ct],qe);else if($e==="LineString")tt(Pe,qe,Je,!1);else if($e==="MultiLineString"){if(te.lineMetrics){for(ct=0;ct<Pe.length;ct++)tt(Pe[ct],qe=[],Je,!1),ue.push(Pt(Ge,"LineString",qe,X.properties));return}pt(Pe,qe,Je,!1)}else if($e==="Polygon")pt(Pe,qe,Je,!0);else{if($e!=="MultiPolygon"){if($e==="GeometryCollection"){for(ct=0;ct<X.geometry.geometries.length;ct++)Ae(ue,{id:Ge,geometry:X.geometry.geometries[ct],properties:X.properties},te,de);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ct=0;ct<Pe.length;ct++){var Ht=[];pt(Pe[ct],Ht,Je,!0),qe.push(Ht)}}ue.push(Pt(Ge,$e,qe,X.properties))}}function je(ue,X){X.push(Tt(ue[0])),X.push(tn(ue[1])),X.push(0)}function tt(ue,X,te,de){for(var Pe,$e,Je=0,qe=0;qe<ue.length;qe++){var Ge=Tt(ue[qe][0]),ct=tn(ue[qe][1]);X.push(Ge),X.push(ct),X.push(0),qe>0&&(Je+=de?(Pe*ct-Ge*$e)/2:Math.sqrt(Math.pow(Ge-Pe,2)+Math.pow(ct-$e,2))),Pe=Ge,$e=ct}var Ht=X.length-3;X[2]=1,Ke(X,0,Ht,te),X[Ht+2]=1,X.size=Math.abs(Je),X.start=0,X.end=X.size}function pt(ue,X,te,de){for(var Pe=0;Pe<ue.length;Pe++){var $e=[];tt(ue[Pe],$e,te,de),X.push($e)}}function Tt(ue){return ue/360+.5}function tn(ue){var X=Math.sin(ue*Math.PI/180),te=.5-.25*Math.log((1+X)/(1-X))/Math.PI;return te<0?0:te>1?1:te}function Wt(ue,X,te,de,Pe,$e,Je,qe){if(de/=X,$e>=(te/=X)&&Je<de)return ue;if(Je<te||$e>=de)return null;for(var Ge=[],ct=0;ct<ue.length;ct++){var Ht=ue[ct],Xt=Ht.geometry,Ft=Ht.type,qn=Pe===0?Ht.minX:Ht.minY,ci=Pe===0?Ht.maxX:Ht.maxY;if(qn>=te&&ci<de)Ge.push(Ht);else if(!(ci<te||qn>=de)){var Yn=[];if(Ft==="Point"||Ft==="MultiPoint")qt(Xt,Yn,te,de,Pe);else if(Ft==="LineString")It(Xt,Yn,te,de,Pe,!1,qe.lineMetrics);else if(Ft==="MultiLineString")hn(Xt,Yn,te,de,Pe,!1);else if(Ft==="Polygon")hn(Xt,Yn,te,de,Pe,!0);else if(Ft==="MultiPolygon")for(var ii=0;ii<Xt.length;ii++){var mi=[];hn(Xt[ii],mi,te,de,Pe,!0),mi.length&&Yn.push(mi)}if(Yn.length){if(qe.lineMetrics&&Ft==="LineString"){for(ii=0;ii<Yn.length;ii++)Ge.push(Pt(Ht.id,Ft,Yn[ii],Ht.tags));continue}Ft!=="LineString"&&Ft!=="MultiLineString"||(Yn.length===1?(Ft="LineString",Yn=Yn[0]):Ft="MultiLineString"),Ft!=="Point"&&Ft!=="MultiPoint"||(Ft=Yn.length===3?"Point":"MultiPoint"),Ge.push(Pt(Ht.id,Ft,Yn,Ht.tags))}}}return Ge.length?Ge:null}function qt(ue,X,te,de,Pe){for(var $e=0;$e<ue.length;$e+=3){var Je=ue[$e+Pe];Je>=te&&Je<=de&&(X.push(ue[$e]),X.push(ue[$e+1]),X.push(ue[$e+2]))}}function It(ue,X,te,de,Pe,$e,Je){for(var qe,Ge,ct=wn(ue),Ht=Pe===0?zn:ei,Xt=ue.start,Ft=0;Ft<ue.length-3;Ft+=3){var qn=ue[Ft],ci=ue[Ft+1],Yn=ue[Ft+2],ii=ue[Ft+3],mi=ue[Ft+4],Vi=Pe===0?qn:ci,hr=Pe===0?ii:mi,Fr=!1;Je&&(qe=Math.sqrt(Math.pow(qn-ii,2)+Math.pow(ci-mi,2))),Vi<te?hr>te&&(Ge=Ht(ct,qn,ci,ii,mi,te),Je&&(ct.start=Xt+qe*Ge)):Vi>de?hr<de&&(Ge=Ht(ct,qn,ci,ii,mi,de),Je&&(ct.start=Xt+qe*Ge)):En(ct,qn,ci,Yn),hr<te&&Vi>=te&&(Ge=Ht(ct,qn,ci,ii,mi,te),Fr=!0),hr>de&&Vi<=de&&(Ge=Ht(ct,qn,ci,ii,mi,de),Fr=!0),!$e&&Fr&&(Je&&(ct.end=Xt+qe*Ge),X.push(ct),ct=wn(ue)),Je&&(Xt+=qe)}var xr=ue.length-3;qn=ue[xr],ci=ue[xr+1],Yn=ue[xr+2],(Vi=Pe===0?qn:ci)>=te&&Vi<=de&&En(ct,qn,ci,Yn),xr=ct.length-3,$e&&xr>=3&&(ct[xr]!==ct[0]||ct[xr+1]!==ct[1])&&En(ct,ct[0],ct[1],ct[2]),ct.length&&X.push(ct)}function wn(ue){var X=[];return X.size=ue.size,X.start=ue.start,X.end=ue.end,X}function hn(ue,X,te,de,Pe,$e){for(var Je=0;Je<ue.length;Je++)It(ue[Je],X,te,de,Pe,$e,!1)}function En(ue,X,te,de){ue.push(X),ue.push(te),ue.push(de)}function zn(ue,X,te,de,Pe,$e){var Je=($e-X)/(de-X);return ue.push($e),ue.push(te+(Pe-te)*Je),ue.push(1),Je}function ei(ue,X,te,de,Pe,$e){var Je=($e-te)/(Pe-te);return ue.push(X+(de-X)*Je),ue.push($e),ue.push(1),Je}function ti(ue,X){for(var te=[],de=0;de<ue.length;de++){var Pe,$e=ue[de],Je=$e.type;if(Je==="Point"||Je==="MultiPoint"||Je==="LineString")Pe=li($e.geometry,X);else if(Je==="MultiLineString"||Je==="Polygon"){Pe=[];for(var qe=0;qe<$e.geometry.length;qe++)Pe.push(li($e.geometry[qe],X))}else if(Je==="MultiPolygon")for(Pe=[],qe=0;qe<$e.geometry.length;qe++){for(var Ge=[],ct=0;ct<$e.geometry[qe].length;ct++)Ge.push(li($e.geometry[qe][ct],X));Pe.push(Ge)}te.push(Pt($e.id,Je,Pe,$e.tags))}return te}function li(ue,X){var te=[];te.size=ue.size,ue.start!==void 0&&(te.start=ue.start,te.end=ue.end);for(var de=0;de<ue.length;de+=3)te.push(ue[de]+X,ue[de+1],ue[de+2]);return te}function ie(ue,X){if(ue.transformed)return ue;var te,de,Pe,$e=1<<ue.z,Je=ue.x,qe=ue.y;for(te=0;te<ue.features.length;te++){var Ge=ue.features[te],ct=Ge.geometry,Ht=Ge.type;if(Ge.geometry=[],Ht===1)for(de=0;de<ct.length;de+=2)Ge.geometry.push(K(ct[de],ct[de+1],X,$e,Je,qe));else for(de=0;de<ct.length;de++){var Xt=[];for(Pe=0;Pe<ct[de].length;Pe+=2)Xt.push(K(ct[de][Pe],ct[de][Pe+1],X,$e,Je,qe));Ge.geometry.push(Xt)}}return ue.transformed=!0,ue}function K(ue,X,te,de,Pe,$e){return[Math.round(te*(ue*de-Pe)),Math.round(te*(X*de-$e))]}function Be(ue,X,te,de,Pe){for(var $e=X===Pe.maxZoom?0:Pe.tolerance/((1<<X)*Pe.extent),Je={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:te,y:de,z:X,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},qe=0;qe<ue.length;qe++){Je.numFeatures++,rt(Je,ue[qe],$e,Pe);var Ge=ue[qe].minX,ct=ue[qe].minY,Ht=ue[qe].maxX,Xt=ue[qe].maxY;Ge<Je.minX&&(Je.minX=Ge),ct<Je.minY&&(Je.minY=ct),Ht>Je.maxX&&(Je.maxX=Ht),Xt>Je.maxY&&(Je.maxY=Xt)}return Je}function rt(ue,X,te,de){var Pe=X.geometry,$e=X.type,Je=[];if($e==="Point"||$e==="MultiPoint")for(var qe=0;qe<Pe.length;qe+=3)Je.push(Pe[qe]),Je.push(Pe[qe+1]),ue.numPoints++,ue.numSimplified++;else if($e==="LineString")mt(Je,Pe,ue,te,!1,!1);else if($e==="MultiLineString"||$e==="Polygon")for(qe=0;qe<Pe.length;qe++)mt(Je,Pe[qe],ue,te,$e==="Polygon",qe===0);else if($e==="MultiPolygon")for(var Ge=0;Ge<Pe.length;Ge++){var ct=Pe[Ge];for(qe=0;qe<ct.length;qe++)mt(Je,ct[qe],ue,te,!0,qe===0)}if(Je.length){var Ht=X.tags||null;if($e==="LineString"&&de.lineMetrics){for(var Xt in Ht={},X.tags)Ht[Xt]=X.tags[Xt];Ht.mapbox_clip_start=Pe.start/Pe.size,Ht.mapbox_clip_end=Pe.end/Pe.size}var Ft={geometry:Je,type:$e==="Polygon"||$e==="MultiPolygon"?3:$e==="LineString"||$e==="MultiLineString"?2:1,tags:Ht};X.id!==null&&(Ft.id=X.id),ue.features.push(Ft)}}function mt(ue,X,te,de,Pe,$e){var Je=de*de;if(de>0&&X.size<(Pe?Je:de))te.numPoints+=X.length/3;else{for(var qe=[],Ge=0;Ge<X.length;Ge+=3)(de===0||X[Ge+2]>Je)&&(te.numSimplified++,qe.push(X[Ge]),qe.push(X[Ge+1])),te.numPoints++;Pe&&function(ct,Ht){for(var Xt=0,Ft=0,qn=ct.length,ci=qn-2;Ft<qn;ci=Ft,Ft+=2)Xt+=(ct[Ft]-ct[ci])*(ct[Ft+1]+ct[ci+1]);if(Xt>0===Ht)for(Ft=0,qn=ct.length;Ft<qn/2;Ft+=2){var Yn=ct[Ft],ii=ct[Ft+1];ct[Ft]=ct[qn-2-Ft],ct[Ft+1]=ct[qn-1-Ft],ct[qn-2-Ft]=Yn,ct[qn-1-Ft]=ii}}(qe,$e),ue.push(qe)}}function zt(ue,X){var te=(X=this.options=function(Pe,$e){for(var Je in $e)Pe[Je]=$e[Je];return Pe}(Object.create(this.options),X)).debug;if(te&&console.time("preprocess data"),X.maxZoom<0||X.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(X.promoteId&&X.generateId)throw new Error("promoteId and generateId cannot be used together.");var de=function(Pe,$e){var Je=[];if(Pe.type==="FeatureCollection")for(var qe=0;qe<Pe.features.length;qe++)Ae(Je,Pe.features[qe],$e,qe);else Ae(Je,Pe.type==="Feature"?Pe:{geometry:Pe},$e);return Je}(ue,X);this.tiles={},this.tileCoords=[],te&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",X.indexMaxZoom,X.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),de=function(Pe,$e){var Je=$e.buffer/$e.extent,qe=Pe,Ge=Wt(Pe,1,-1-Je,Je,0,-1,2,$e),ct=Wt(Pe,1,1-Je,2+Je,0,-1,2,$e);return(Ge||ct)&&(qe=Wt(Pe,1,-Je,1+Je,0,-1,2,$e)||[],Ge&&(qe=ti(Ge,1).concat(qe)),ct&&(qe=qe.concat(ti(ct,-1)))),qe}(de,X),de.length&&this.splitTile(de,0,0,0),te&&(de.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function en(ue,X,te){return 32*((1<<ue)*te+X)+ue}function bn(ue,X){const te=ue.tileID.canonical;if(!this._geoJSONIndex)return X(null,null);const de=this._geoJSONIndex.getTile(te.z,te.x,te.y);if(!de)return X(null,null);const Pe=new class{constructor(Je){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.EXTENT,this.length=Je.length,this._features=Je}feature(Je){return new class{constructor(qe){this._feature=qe,this.extent=s.EXTENT,this.type=qe.type,this.properties=qe.tags,"id"in qe&&!isNaN(qe.id)&&(this.id=parseInt(qe.id,10))}loadGeometry(){if(this._feature.type===1){const qe=[];for(const Ge of this._feature.geometry)qe.push([new s.Point(Ge[0],Ge[1])]);return qe}{const qe=[];for(const Ge of this._feature.geometry){const ct=[];for(const Ht of Ge)ct.push(new s.Point(Ht[0],Ht[1]));qe.push(ct)}return qe}}toGeoJSON(qe,Ge,ct){return L.call(this,qe,Ge,ct)}}(this._features[Je])}}(de.features);let $e=et(Pe);$e.byteOffset===0&&$e.byteLength===$e.buffer.byteLength||($e=new Uint8Array($e)),X(null,{vectorTile:Pe,rawData:$e.buffer})}zt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},zt.prototype.splitTile=function(ue,X,te,de,Pe,$e,Je){for(var qe=[ue,X,te,de],Ge=this.options,ct=Ge.debug;qe.length;){de=qe.pop(),te=qe.pop(),X=qe.pop(),ue=qe.pop();var Ht=1<<X,Xt=en(X,te,de),Ft=this.tiles[Xt];if(!Ft&&(ct>1&&console.time("creation"),Ft=this.tiles[Xt]=Be(ue,X,te,de,Ge),this.tileCoords.push({z:X,x:te,y:de}),ct)){ct>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",X,te,de,Ft.numFeatures,Ft.numPoints,Ft.numSimplified),console.timeEnd("creation"));var qn="z"+X;this.stats[qn]=(this.stats[qn]||0)+1,this.total++}if(Ft.source=ue,Pe){if(X===Ge.maxZoom||X===Pe)continue;var ci=1<<Pe-X;if(te!==Math.floor($e/ci)||de!==Math.floor(Je/ci))continue}else if(X===Ge.indexMaxZoom||Ft.numPoints<=Ge.indexMaxPoints)continue;if(Ft.source=null,ue.length!==0){ct>1&&console.time("clipping");var Yn,ii,mi,Vi,hr,Fr,xr=.5*Ge.buffer/Ge.extent,Ko=.5-xr,Cr=.5+xr,Kr=1+xr;Yn=ii=mi=Vi=null,hr=Wt(ue,Ht,te-xr,te+Cr,0,Ft.minX,Ft.maxX,Ge),Fr=Wt(ue,Ht,te+Ko,te+Kr,0,Ft.minX,Ft.maxX,Ge),ue=null,hr&&(Yn=Wt(hr,Ht,de-xr,de+Cr,1,Ft.minY,Ft.maxY,Ge),ii=Wt(hr,Ht,de+Ko,de+Kr,1,Ft.minY,Ft.maxY,Ge),hr=null),Fr&&(mi=Wt(Fr,Ht,de-xr,de+Cr,1,Ft.minY,Ft.maxY,Ge),Vi=Wt(Fr,Ht,de+Ko,de+Kr,1,Ft.minY,Ft.maxY,Ge),Fr=null),ct>1&&console.timeEnd("clipping"),qe.push(Yn||[],X+1,2*te,2*de),qe.push(ii||[],X+1,2*te,2*de+1),qe.push(mi||[],X+1,2*te+1,2*de),qe.push(Vi||[],X+1,2*te+1,2*de+1)}}},zt.prototype.getTile=function(ue,X,te){var de=this.options,Pe=de.extent,$e=de.debug;if(ue<0||ue>24)return null;var Je=1<<ue,qe=en(ue,X=(X%Je+Je)%Je,te);if(this.tiles[qe])return ie(this.tiles[qe],Pe);$e>1&&console.log("drilling down to z%d-%d-%d",ue,X,te);for(var Ge,ct=ue,Ht=X,Xt=te;!Ge&&ct>0;)ct--,Ht=Math.floor(Ht/2),Xt=Math.floor(Xt/2),Ge=this.tiles[en(ct,Ht,Xt)];return Ge&&Ge.source?($e>1&&console.log("found parent tile z%d-%d-%d",ct,Ht,Xt),$e>1&&console.time("drilling down"),this.splitTile(Ge.source,ct,Ht,Xt,ue,X,te),$e>1&&console.timeEnd("drilling down"),this.tiles[qe]?ie(this.tiles[qe],Pe):null):null};class Hn extends s.VectorTileWorkerSource{constructor(X,te,de,Pe,$e){super(X,te,de,Pe,bn),$e&&(this.loadGeoJSON=$e)}loadData(X,te){const de=X&&X.request,Pe=de&&de.collectResourceTiming;this.loadGeoJSON(X,($e,Je)=>{if($e||!Je)return te($e);if(typeof Je!="object")return te(new Error(`Input data given to '${X.source}' is not a valid GeoJSON object.`));{I(Je,!0);try{if(X.filter){const Ge=s.createExpression(X.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ge.result==="error")throw new Error(Ge.value.map(Ht=>`${Ht.key}: ${Ht.message}`).join(", "));Je={type:"FeatureCollection",features:Je.features.filter(Ht=>Ge.value.evaluate({zoom:0},Ht))}}this._geoJSONIndex=X.cluster?new An(function({superclusterOptions:Ge,clusterProperties:ct}){if(!ct||!Ge)return Ge;const Ht={},Xt={},Ft={accumulated:null,zoom:0},qn={properties:null},ci=Object.keys(ct);for(const Yn of ci){const[ii,mi]=ct[Yn],Vi=s.createExpression(mi),hr=s.createExpression(typeof ii=="string"?[ii,["accumulated"],["get",Yn]]:ii);Ht[Yn]=Vi.value,Xt[Yn]=hr.value}return Ge.map=Yn=>{qn.properties=Yn;const ii={};for(const mi of ci)ii[mi]=Ht[mi].evaluate(Ft,qn);return ii},Ge.reduce=(Yn,ii)=>{qn.properties=ii;for(const mi of ci)Ft.accumulated=Yn[mi],Yn[mi]=Xt[mi].evaluate(Ft,qn)},Ge}(X)).load(Je.features):function(Ge,ct){return new zt(Ge,ct)}(Je,X.geojsonVtOptions)}catch(Ge){return te(Ge)}this.loaded={};const qe={};if(Pe){const Ge=s.getPerformanceMeasurement(de);Ge&&(qe.resourceTiming={},qe.resourceTiming[X.source]=JSON.parse(JSON.stringify(Ge)))}te(null,qe)}})}reloadTile(X,te){const de=this.loaded;return de&&de[X.uid]?super.reloadTile(X,te):this.loadTile(X,te)}loadGeoJSON(X,te){if(X.request)s.getJSON(X.request,te);else{if(typeof X.data!="string")return te(new Error(`Input data given to '${X.source}' is not a valid GeoJSON object.`));try{return te(null,JSON.parse(X.data))}catch{return te(new Error(`Input data given to '${X.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(X,te){try{te(null,this._geoJSONIndex.getClusterExpansionZoom(X.clusterId))}catch(de){te(de)}}getClusterChildren(X,te){try{te(null,this._geoJSONIndex.getChildren(X.clusterId))}catch(de){te(de)}}getClusterLeaves(X,te){try{te(null,this._geoJSONIndex.getLeaves(X.clusterId,X.limit,X.offset))}catch(de){te(de)}}}class Pn{constructor(X){this.self=X,this.actor=new s.Actor(X,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=s.getProjection({name:"mercator"}),this.workerSourceTypes={vector:s.VectorTileWorkerSource,geojson:Hn},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(te,de)=>{if(this.workerSourceTypes[te])throw new Error(`Worker source with name "${te}" already registered.`);this.workerSourceTypes[te]=de},this.self.registerRTLTextPlugin=te=>{if(s.plugin.isParsed())throw new Error("RTL text plugin already registered.");s.plugin.applyArabicShaping=te.applyArabicShaping,s.plugin.processBidirectionalText=te.processBidirectionalText,s.plugin.processStyledBidirectionalText=te.processStyledBidirectionalText}}clearCaches(X,te,de){delete this.layerIndexes[X],delete this.availableImages[X],delete this.workerSources[X],delete this.demWorkerSources[X],de()}checkIfReady(X,te,de){de()}setReferrer(X,te){this.referrer=te}spriteLoaded(X,te){this.isSpriteLoaded[X]=te;for(const de in this.workerSources[X]){const Pe=this.workerSources[X][de];for(const $e in Pe)Pe[$e]instanceof s.VectorTileWorkerSource&&(Pe[$e].isSpriteLoaded=te,Pe[$e].fire(new s.Event("isSpriteLoaded")))}}setImages(X,te,de){this.availableImages[X]=te;for(const Pe in this.workerSources[X]){const $e=this.workerSources[X][Pe];for(const Je in $e)$e[Je].availableImages=te}de()}enableTerrain(X,te,de){this.terrain=te,de()}setProjection(X,te){this.projections[X]=s.getProjection(te)}setLayers(X,te,de){this.getLayerIndex(X).replace(te),de()}updateLayers(X,te,de){this.getLayerIndex(X).update(te.layers,te.removedIds),de()}loadTile(X,te,de){const Pe=this.enableTerrain?s.extend({enableTerrain:this.terrain},te):te;Pe.projection=this.projections[X]||this.defaultProjection,this.getWorkerSource(X,te.type,te.source).loadTile(Pe,de)}loadDEMTile(X,te,de){const Pe=this.enableTerrain?s.extend({buildQuadTree:this.terrain},te):te;this.getDEMWorkerSource(X,te.source).loadTile(Pe,de)}reloadTile(X,te,de){const Pe=this.enableTerrain?s.extend({enableTerrain:this.terrain},te):te;Pe.projection=this.projections[X]||this.defaultProjection,this.getWorkerSource(X,te.type,te.source).reloadTile(Pe,de)}abortTile(X,te,de){this.getWorkerSource(X,te.type,te.source).abortTile(te,de)}removeTile(X,te,de){this.getWorkerSource(X,te.type,te.source).removeTile(te,de)}removeSource(X,te,de){if(!this.workerSources[X]||!this.workerSources[X][te.type]||!this.workerSources[X][te.type][te.source])return;const Pe=this.workerSources[X][te.type][te.source];delete this.workerSources[X][te.type][te.source],Pe.removeSource!==void 0?Pe.removeSource(te,de):de()}loadWorkerSource(X,te,de){try{this.self.importScripts(te.url),de()}catch(Pe){de(Pe.toString())}}syncRTLPluginState(X,te,de){try{s.plugin.setState(te);const Pe=s.plugin.getPluginURL();if(s.plugin.isLoaded()&&!s.plugin.isParsed()&&Pe!=null){this.self.importScripts(Pe);const $e=s.plugin.isParsed();de($e?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Pe}`),$e)}}catch(Pe){de(Pe.toString())}}getAvailableImages(X){let te=this.availableImages[X];return te||(te=[]),te}getLayerIndex(X){let te=this.layerIndexes[X];return te||(te=this.layerIndexes[X]=new y),te}getWorkerSource(X,te,de){if(this.workerSources[X]||(this.workerSources[X]={}),this.workerSources[X][te]||(this.workerSources[X][te]={}),!this.workerSources[X][te][de]){const Pe={send:($e,Je,qe,Ge,ct,Ht)=>{this.actor.send($e,Je,qe,X,ct,Ht)},scheduler:this.actor.scheduler};this.workerSources[X][te][de]=new this.workerSourceTypes[te](Pe,this.getLayerIndex(X),this.getAvailableImages(X),this.isSpriteLoaded[X])}return this.workerSources[X][te][de]}getDEMWorkerSource(X,te){return this.demWorkerSources[X]||(this.demWorkerSources[X]={}),this.demWorkerSources[X][te]||(this.demWorkerSources[X][te]=new v),this.demWorkerSources[X][te]}enforceCacheSizeLimit(X,te){s.enforceCacheSizeLimit(te)}getWorkerPerformanceMetrics(X,te,de){de(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Pn(self)),Pn}),o(["./shared"],function(s){function d(_,h){if(Array.isArray(_)){if(!Array.isArray(h)||_.length!==h.length)return!1;for(let m=0;m<_.length;m++)if(!d(_[m],h[m]))return!1;return!0}if(typeof _=="object"&&_!==null&&h!==null){if(typeof h!="object"||Object.keys(_).length!==Object.keys(h).length)return!1;for(const m in _)if(!d(_[m],h[m]))return!1;return!0}return _===h}var p=y;function y(_){return!function(h){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var x,S,A=new Blob([""],{type:"text/javascript"}),R=URL.createObjectURL(A);try{S=new Worker(R),x=!0}catch{x=!1}return S&&S.terminate(),URL.revokeObjectURL(R),x}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var x=document.createElement("canvas");x.width=x.height=1;var S=x.getContext("2d");if(!S)return!1;var A=S.getImageData(0,0,1,1);return A&&A.width===x.width}()?(v[m=h&&h.failIfMajorPerformanceCaveat]===void 0&&(v[m]=function(x){var S,A=function(R){var O=document.createElement("canvas"),z=Object.create(y.webGLContextAttributes);return z.failIfMajorPerformanceCaveat=R,O.getContext("webgl",z)||O.getContext("experimental-webgl",z)}(x);if(!A)return!1;try{S=A.createShader(A.VERTEX_SHADER)}catch{return!1}return!(!S||A.isContextLost())&&(A.shaderSource(S,"void main() {}"),A.compileShader(S),A.getShaderParameter(S,A.COMPILE_STATUS)===!0)}(m)),v[m]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var m}(_)}var v={};function w(_,h,m){const x=s.window.document.createElement(_);return h!==void 0&&(x.className=h),m&&m.appendChild(x),x}function T(_,h,m){const x=s.window.document.createElementNS("http://www.w3.org/2000/svg",_);for(const S of Object.keys(h))x.setAttributeNS(null,S,h[S]);return m&&m.appendChild(x),x}y.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const I=s.window.document&&s.window.document.documentElement.style,L=I&&I.userSelect!==void 0?"userSelect":"WebkitUserSelect";let k;function F(){I&&L&&(k=I[L],I[L]="none")}function B(){I&&L&&(I[L]=k)}function G(_){_.preventDefault(),_.stopPropagation(),s.window.removeEventListener("click",G,!0)}function U(){s.window.addEventListener("click",G,!0),s.window.setTimeout(()=>{s.window.removeEventListener("click",G,!0)},0)}function ee(_,h){const m=_.getBoundingClientRect();return fe(_,m,h)}function ne(_,h){const m=_.getBoundingClientRect(),x=[];for(let S=0;S<h.length;S++)x.push(fe(_,m,h[S]));return x}function ye(_){return s.window.InstallTrigger!==void 0&&_.button===2&&_.ctrlKey&&s.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:_.button}function fe(_,h,m){const x=_.offsetWidth===h.width?1:_.offsetWidth/h.width;return new s.Point((m.clientX-h.left)*x,(m.clientY-h.top)*x)}function J(_,h){var m=h[0],x=h[1],S=h[2],A=h[3],R=m*A-S*x;return R?(_[0]=A*(R=1/R),_[1]=-x*R,_[2]=-S*R,_[3]=m*R,_):null}function Ce(_){const{userImage:h}=_;return!!(h&&h.render&&h.render())&&(_.data.replace(new Uint8Array(h.data.buffer)),!0)}class me extends s.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(h){if(this.loaded!==h&&(this.loaded=h,h)){for(const{ids:m,callback:x}of this.requestors)this._notify(m,x);this.requestors=[]}}hasImage(h){return!!this.getImage(h)}getImage(h){return this.images[h]}addImage(h,m){this._validate(h,m)&&(this.images[h]=m)}_validate(h,m){let x=!0;return this._validateStretch(m.stretchX,m.data&&m.data.width)||(this.fire(new s.ErrorEvent(new Error(`Image "${h}" has invalid "stretchX" value`))),x=!1),this._validateStretch(m.stretchY,m.data&&m.data.height)||(this.fire(new s.ErrorEvent(new Error(`Image "${h}" has invalid "stretchY" value`))),x=!1),this._validateContent(m.content,m)||(this.fire(new s.ErrorEvent(new Error(`Image "${h}" has invalid "content" value`))),x=!1),x}_validateStretch(h,m){if(!h)return!0;let x=0;for(const S of h){if(S[0]<x||S[1]<S[0]||m<S[1])return!1;x=S[1]}return!0}_validateContent(h,m){return!(h&&(h.length!==4||h[0]<0||m.data.width<h[0]||h[1]<0||m.data.height<h[1]||h[2]<0||m.data.width<h[2]||h[3]<0||m.data.height<h[3]||h[2]<h[0]||h[3]<h[1]))}updateImage(h,m){m.version=this.images[h].version+1,this.images[h]=m,this.updatedImages[h]=!0}removeImage(h){const m=this.images[h];delete this.images[h],delete this.patterns[h],m.userImage&&m.userImage.onRemove&&m.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(h,m){let x=!0;if(!this.isLoaded())for(const S of h)this.images[S]||(x=!1);this.isLoaded()||x?this._notify(h,m):this.requestors.push({ids:h,callback:m})}_notify(h,m){const x={};for(const S of h){this.images[S]||this.fire(new s.Event("styleimagemissing",{id:S}));const A=this.images[S];A?x[S]={data:A.data.clone(),pixelRatio:A.pixelRatio,sdf:A.sdf,version:A.version,stretchX:A.stretchX,stretchY:A.stretchY,content:A.content,hasRenderCallback:!!(A.userImage&&A.userImage.render)}:s.warnOnce(`Image "${S}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}m(null,x)}getPixelSize(){const{width:h,height:m}=this.atlasImage;return{width:h,height:m}}getPattern(h){const m=this.patterns[h],x=this.getImage(h);if(!x)return null;if(m&&m.position.version===x.version)return m.position;if(m)m.position.version=x.version;else{const S={w:x.data.width+2,h:x.data.height+2,x:0,y:0},A=new s.ImagePosition(S,x);this.patterns[h]={bin:S,position:A}}return this._updatePatternAtlas(),this.patterns[h].position}bind(h){const m=h.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.Texture(h,this.atlasImage,m.RGBA),this.atlasTexture&&this.atlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE)}_updatePatternAtlas(){const h=[];for(const A in this.patterns)h.push(this.patterns[A].bin);const{w:m,h:x}=s.potpack(h),S=this.atlasImage;S.resize({width:m||1,height:x||1});for(const A in this.patterns){const{bin:R}=this.patterns[A],O=R.x+1,z=R.y+1,$=this.images[A].data,j=$.width,Z=$.height;s.RGBAImage.copy($,S,{x:0,y:0},{x:O,y:z},{width:j,height:Z}),s.RGBAImage.copy($,S,{x:0,y:Z-1},{x:O,y:z-1},{width:j,height:1}),s.RGBAImage.copy($,S,{x:0,y:0},{x:O,y:z+Z},{width:j,height:1}),s.RGBAImage.copy($,S,{x:j-1,y:0},{x:O-1,y:z},{width:1,height:Z}),s.RGBAImage.copy($,S,{x:0,y:0},{x:O+j,y:z},{width:1,height:Z})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(h){for(const m of h){if(this.callbackDispatchedThisFrame[m])continue;this.callbackDispatchedThisFrame[m]=!0;const x=this.images[m];Ce(x)&&this.updateImage(m,x)}}}const be=new s.Properties({anchor:new s.DataConstantProperty(s.spec.light.anchor),position:new class{constructor(){this.specification=s.spec.light.position}possiblyEvaluate(_,h){return function([m,x,S]){const A=s.degToRad(x+90),R=s.degToRad(S);return{x:m*Math.cos(A)*Math.sin(R),y:m*Math.sin(A)*Math.sin(R),z:m*Math.cos(R),azimuthal:x,polar:S}}(_.expression.evaluate(h))}interpolate(_,h,m){return{x:s.number(_.x,h.x,m),y:s.number(_.y,h.y,m),z:s.number(_.z,h.z,m),azimuthal:s.number(_.azimuthal,h.azimuthal,m),polar:s.number(_.polar,h.polar,m)}}},color:new s.DataConstantProperty(s.spec.light.color),intensity:new s.DataConstantProperty(s.spec.light.intensity)});class Te extends s.Evented{constructor(h){super(),this._transitionable=new s.Transitionable(be),this.setLight(h),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(h,m={}){if(!this._validate(s.validateLight,h,m))for(const x in h){const S=h[x];s.endsWith(x,"-transition")?this._transitionable.setTransition(x.slice(0,-11),S):this._transitionable.setValue(x,S)}}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}_validate(h,m,x){return(!x||x.validate!==!1)&&s.emitValidationErrors(this,h.call(s.validateStyle,s.extend({value:m,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}const ke=new s.Properties({source:new s.DataConstantProperty(s.spec.terrain.source),exaggeration:new s.DataConstantProperty(s.spec.terrain.exaggeration)});let ut=class extends s.Evented{constructor(_,h){super(),this._transitionable=new s.Transitionable(ke),this.set(_),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=h}get(){return this._transitionable.serialize()}set(_){for(const h in _){const m=_[h];s.endsWith(h,"-transition")?this._transitionable.setTransition(h.slice(0,-11),m):this._transitionable.setValue(h,m)}}updateTransitions(_){this._transitioning=this._transitionable.transitioned(_,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(_){this.properties=this._transitioning.possiblyEvaluate(_)}};function et(_,h,m,x){const S=s.smoothstep(45,65,m),[A,R]=Et(_,x),O=s.length(h);let z=1-Math.min(1,Math.exp((O-A)/(R-A)*-6));return z*=z*z,z=Math.min(1,1.00747*z),z*S*_.alpha}function Et(_,h){const m=.5/Math.tan(.5*h);return[_.range[0]+m,_.range[1]+m]}const bt=new s.Properties({range:new s.DataConstantProperty(s.spec.fog.range),color:new s.DataConstantProperty(s.spec.fog.color),"high-color":new s.DataConstantProperty(s.spec.fog["high-color"]),"space-color":new s.DataConstantProperty(s.spec.fog["space-color"]),"horizon-blend":new s.DataConstantProperty(s.spec.fog["horizon-blend"]),"star-intensity":new s.DataConstantProperty(s.spec.fog["star-intensity"])});class Qt extends s.Evented{constructor(h,m){super(),this._transitionable=new s.Transitionable(bt),this.set(h),this._transitioning=this._transitionable.untransitioned(),this._transform=m}get state(){const h=this._transform,m=h.projection.name==="globe",x=s.globeToMercatorTransition(h.zoom),S=this.properties.get("range"),A=[.5,3];return{range:m?[s.number(A[0],S[0],x),s.number(A[1],S[1],x)]:S,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(h,m={}){if(!this._validate(s.validateFog,h,m)){for(const x of Object.keys(s.spec.fog))h&&h[x]===void 0&&(h[x]=s.spec.fog[x].default);for(const x in h){const S=h[x];s.endsWith(x,"-transition")?this._transitionable.setTransition(x.slice(0,-11),S):this._transitionable.setValue(x,S)}}}getOpacity(h){if(!this._transform.projection.supportsFog)return 0;const m=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:s.smoothstep(45,65,h))*m.a}getOpacityAtLatLng(h,m){return this._transform.projection.supportsFog?function(x,S,A){const R=s.MercatorCoordinate.fromLngLat(S),O=A.elevation?A.elevation.getAtPointOrZero(R):0,z=[R.x,R.y,O];return s.transformMat4(z,z,A.mercatorFogMatrix),et(x,z,A.pitch,A._fov)}(this.state,h,m):0}getFovAdjustedRange(h){return this._transform.projection.supportsFog?Et(this.state,h):[0,1]}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}_validate(h,m,x){return(!x||x.validate!==!1)&&s.emitValidationErrors(this,h.call(s.validateStyle,s.extend({value:m,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}class cn{constructor(h,m){this.workerPool=h,this.actors=[],this.currentActor=0,this.id=s.uniqueId();const x=this.workerPool.acquire(this.id);for(let S=0;S<x.length;S++){const A=new cn.Actor(x[S],m,this.id);A.name=`Worker ${S}`,this.actors.push(A)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(h,m,x){s.asyncAll(this.actors,(S,A)=>{S.send(h,m,A)},x=x||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(h=>{h.remove()}),this.actors=[],this.workerPool.release(this.id)}}function pn(_,h,m){return h*(s.EXTENT/(_.tileSize*Math.pow(2,m-_.tileID.overscaledZ)))}cn.Actor=s.Actor;class xn{constructor(h,m,x,S){this.screenBounds=h,this.cameraPoint=m,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=x,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,S)}static createFromScreenPoints(h,m){let x,S;if(h instanceof s.Point||typeof h[0]=="number"){const A=s.Point.convert(h);x=[A],S=m.isPointAboveHorizon(A)}else{const A=s.Point.convert(h[0]),R=s.Point.convert(h[1]);x=[A,R],S=s.polygonizeBounds(A,R).every(O=>m.isPointAboveHorizon(O))}return new xn(x,m.getCameraPoint(),S,m)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(h){return s.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],h)}bufferedCameraGeometry(h){const m=this.screenBounds[0],x=this.screenBounds.length===1?this.screenBounds[0].add(new s.Point(1,1)):this.screenBounds[1],S=s.polygonizeBounds(m,x,0,!1);return this.cameraPoint.y>x.y&&(this.cameraPoint.x>m.x&&this.cameraPoint.x<x.x?S.splice(3,0,this.cameraPoint):this.cameraPoint.x>=x.x?S[2]=this.cameraPoint:this.cameraPoint.x<=m.x&&(S[3]=this.cameraPoint)),s.bufferConvexPolygon(S,h)}bufferedCameraGeometryGlobe(h){const m=this.screenBounds[0],x=this.screenBounds.length===1?this.screenBounds[0].add(new s.Point(1,1)):this.screenBounds[1],S=s.polygonizeBounds(m,x,h),A=this.cameraPoint.clone();switch(3*((A.y>m.y)+(A.y>x.y))+((A.x>m.x)+(A.x>x.x))){case 0:S[0]=A,S[4]=A.clone();break;case 1:S.splice(1,0,A);break;case 2:S[1]=A;break;case 3:S.splice(4,0,A);break;case 5:S.splice(2,0,A);break;case 6:S[3]=A;break;case 7:S.splice(3,0,A);break;case 8:S[2]=A}return S}containsTile(h,m,x,S=0){const A=h.queryPadding/m._pixelsPerMercatorPixel+1,R=x?this._bufferedCameraMercator(A,m):this._bufferedScreenMercator(A,m);let O=h.tileID.wrap+(R.unwrapped?S:0);const z=R.polygon.map(_e=>s.getTilePoint(h.tileTransform,_e,O));if(!s.polygonIntersectsBox(z,0,0,s.EXTENT,s.EXTENT))return;O=h.tileID.wrap+(this.screenGeometryMercator.unwrapped?S:0);const $=this.screenGeometryMercator.polygon.map(_e=>s.getTileVec3(h.tileTransform,_e,O)),j=$.map(_e=>new s.Point(_e[0],_e[1])),Z=m.getFreeCameraOptions().position||new s.MercatorCoordinate(0,0,0),re=s.getTileVec3(h.tileTransform,Z,O),he=$.map(_e=>{const Y=s.sub(_e,_e,re);return s.normalize(Y,Y),new s.Ray(re,Y)}),ge=pn(h,1,m.zoom)*m._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:j,tilespaceRays:he,bufferedTilespaceGeometry:z,bufferedTilespaceBounds:(pe=s.getBounds(z),pe.min.x=s.clamp(pe.min.x,0,s.EXTENT),pe.min.y=s.clamp(pe.min.y,0,s.EXTENT),pe.max.x=s.clamp(pe.max.x,0,s.EXTENT),pe.max.y=s.clamp(pe.max.y,0,s.EXTENT),pe),tile:h,tileID:h.tileID,pixelToTileUnitsFactor:ge};var pe}_bufferedScreenMercator(h,m){const x=Bn(h);if(this._screenRaycastCache[x])return this._screenRaycastCache[x];{let S;return S=m.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(h),m):{polygon:this.bufferedScreenGeometry(h).map(A=>m.pointCoordinate3D(A)),unwrapped:!0},this._screenRaycastCache[x]=S,S}}_bufferedCameraMercator(h,m){const x=Bn(h);if(this._cameraRaycastCache[x])return this._cameraRaycastCache[x];{let S;return S=m.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(h),m):{polygon:this.bufferedCameraGeometry(h).map(A=>m.pointCoordinate3D(A)),unwrapped:!0},this._cameraRaycastCache[x]=S,S}}_projectAndResample(h,m){const x=function(A,R){const O=s.multiply([],R.pixelMatrix,R.globeMatrix),z=[0,-s.GLOBE_RADIUS,0,1],$=[0,s.GLOBE_RADIUS,0,1],j=[0,0,0,1];s.transformMat4$1(z,z,O),s.transformMat4$1($,$,O),s.transformMat4$1(j,j,O);const Z=new s.Point(z[0]/z[3],z[1]/z[3]),re=new s.Point($[0]/$[3],$[1]/$[3]),he=s.polygonContainsPoint(A,Z)&&z[3]<j[3],ge=s.polygonContainsPoint(A,re)&&$[3]<j[3];if(!he&&!ge)return null;const pe=function(Ne,Ye,Xe){for(let st=1;st<Ne.length;st++){const Ut=kn(Ye.pointCoordinate3D(Ne[st-1]).x),nt=kn(Ye.pointCoordinate3D(Ne[st]).x);if(Xe<0){if(Ut<nt)return{idx:st,t:-Ut/(nt-1-Ut)}}else if(nt<Ut)return{idx:st,t:(1-Ut)/(nt+1-Ut)}}return null}(A,R,he?-1:1);if(!pe)return null;const{idx:_e,t:Y}=pe;let ce=_e>1?An(A.slice(0,_e),R):[],Ee=_e<A.length?An(A.slice(_e),R):[];ce=ce.map(Ne=>new s.Point(kn(Ne.x),Ne.y)),Ee=Ee.map(Ne=>new s.Point(kn(Ne.x),Ne.y));const Se=[...ce];Se.length===0&&Se.push(Ee[Ee.length-1]);const ze=s.number(Se[Se.length-1].y,(Ee.length===0?ce[0]:Ee[0]).y,Y);let Ve;return Ve=he?[new s.Point(0,ze),new s.Point(0,0),new s.Point(1,0),new s.Point(1,ze)]:[new s.Point(1,ze),new s.Point(1,1),new s.Point(0,1),new s.Point(0,ze)],Se.push(...Ve),Ee.length===0?Se.push(ce[0]):Se.push(...Ee),{polygon:Se.map(Ne=>new s.MercatorCoordinate(Ne.x,Ne.y)),unwrapped:!1}}(h,m);if(x)return x;const S=function(A,R){let O=!1,z=-1/0,$=0;for(let Z=0;Z<A.length-1;Z++)A[Z].x>z&&(z=A[Z].x,$=Z);for(let Z=0;Z<A.length-1;Z++){const re=($+Z)%(A.length-1),he=A[re],ge=A[re+1];Math.abs(he.x-ge.x)>.5&&(he.x<ge.x?(he.x+=1,re===0&&(A[A.length-1].x+=1)):(ge.x+=1,re+1===A.length-1&&(A[0].x+=1)),O=!0)}const j=s.mercatorXfromLng(R.center.lng);return O&&j<Math.abs(j-1)&&A.forEach(Z=>{Z.x-=1}),{polygon:A,unwrapped:O}}(An(h,m).map(A=>new s.Point(kn(A.x),A.y)),m);return{polygon:S.polygon.map(A=>new s.MercatorCoordinate(A.x,A.y)),unwrapped:S.unwrapped}}}function An(_,h){return s.resample(_,m=>{const x=h.pointCoordinate3D(m);m.x=x.x,m.y=x.y},1/256)}function kn(_){return _<0?1+_%1:_%1}function Bn(_){return 100*_|0}function Nt(_,h,m,x,S){const A=function(R,O){if(R)return S(R);if(O){_.url&&O.tiles&&_.tiles&&delete _.tiles;const z=s.pick(s.extend(O,_),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);O.vector_layers&&(z.vectorLayers=O.vector_layers,z.vectorLayerIds=z.vectorLayers.map($=>$.id)),z.tiles=h.canonicalizeTileset(z,_.url),S(null,z)}};return _.url?s.getJSON(h.transformRequest(h.normalizeSourceURL(_.url,null,m,x),s.ResourceType.Source),A):s.exported.frame(()=>A(null,_))}class We{constructor(h,m,x){this.bounds=s.LngLatBounds.convert(this.validateBounds(h)),this.minzoom=m||0,this.maxzoom=x||24}validateBounds(h){return Array.isArray(h)&&h.length===4?[Math.max(-180,h[0]),Math.max(-90,h[1]),Math.min(180,h[2]),Math.min(90,h[3])]:[-180,-90,180,90]}contains(h){const m=Math.pow(2,h.z),x=Math.floor(s.mercatorXfromLng(this.bounds.getWest())*m),S=Math.floor(s.mercatorYfromLat(this.bounds.getNorth())*m),A=Math.ceil(s.mercatorXfromLng(this.bounds.getEast())*m),R=Math.ceil(s.mercatorYfromLat(this.bounds.getSouth())*m);return h.x>=x&&h.x<A&&h.y>=S&&h.y<R}}class kt{constructor(h,m,x){this.context=h;const S=h.gl;this.buffer=S.createBuffer(),this.dynamicDraw=!!x,this.context.unbindVAO(),h.bindElementBuffer.set(this.buffer),S.bufferData(S.ELEMENT_ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||m.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(h){const m=this.context.gl;this.context.unbindVAO(),this.bind(),m.bufferSubData(m.ELEMENT_ARRAY_BUFFER,0,h.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ke={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ht{constructor(h,m,x,S){this.length=m.length,this.attributes=x,this.itemSize=m.bytesPerElement,this.dynamicDraw=S,this.context=h;const A=h.gl;this.buffer=A.createBuffer(),h.bindVertexBuffer.set(this.buffer),A.bufferData(A.ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?A.DYNAMIC_DRAW:A.STATIC_DRAW),this.dynamicDraw||m.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(h){const m=this.context.gl;this.bind(),m.bufferSubData(m.ARRAY_BUFFER,0,h.arrayBuffer)}enableAttributes(h,m){for(let x=0;x<this.attributes.length;x++){const S=m.attributes[this.attributes[x].name];S!==void 0&&h.enableVertexAttribArray(S)}}setVertexAttribPointers(h,m,x){for(let S=0;S<this.attributes.length;S++){const A=this.attributes[S],R=m.attributes[A.name];R!==void 0&&h.vertexAttribPointer(R,A.components,h[Ke[A.type]],!1,this.itemSize,A.offset+this.itemSize*(x||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Pt{constructor(h){this.gl=h.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(h){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ae extends Pt{getDefault(){return s.Color.transparent}set(h){const m=this.current;(h.r!==m.r||h.g!==m.g||h.b!==m.b||h.a!==m.a||this.dirty)&&(this.gl.clearColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)}}class Ae extends Pt{getDefault(){return 1}set(h){(h!==this.current||this.dirty)&&(this.gl.clearDepth(h),this.current=h,this.dirty=!1)}}class je extends Pt{getDefault(){return 0}set(h){(h!==this.current||this.dirty)&&(this.gl.clearStencil(h),this.current=h,this.dirty=!1)}}class tt extends Pt{getDefault(){return[!0,!0,!0,!0]}set(h){const m=this.current;(h[0]!==m[0]||h[1]!==m[1]||h[2]!==m[2]||h[3]!==m[3]||this.dirty)&&(this.gl.colorMask(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)}}class pt extends Pt{getDefault(){return!0}set(h){(h!==this.current||this.dirty)&&(this.gl.depthMask(h),this.current=h,this.dirty=!1)}}class Tt extends Pt{getDefault(){return 255}set(h){(h!==this.current||this.dirty)&&(this.gl.stencilMask(h),this.current=h,this.dirty=!1)}}class tn extends Pt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(h){const m=this.current;(h.func!==m.func||h.ref!==m.ref||h.mask!==m.mask||this.dirty)&&(this.gl.stencilFunc(h.func,h.ref,h.mask),this.current=h,this.dirty=!1)}}class Wt extends Pt{getDefault(){const h=this.gl;return[h.KEEP,h.KEEP,h.KEEP]}set(h){const m=this.current;(h[0]!==m[0]||h[1]!==m[1]||h[2]!==m[2]||this.dirty)&&(this.gl.stencilOp(h[0],h[1],h[2]),this.current=h,this.dirty=!1)}}class qt extends Pt{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;h?m.enable(m.STENCIL_TEST):m.disable(m.STENCIL_TEST),this.current=h,this.dirty=!1}}class It extends Pt{getDefault(){return[0,1]}set(h){const m=this.current;(h[0]!==m[0]||h[1]!==m[1]||this.dirty)&&(this.gl.depthRange(h[0],h[1]),this.current=h,this.dirty=!1)}}class wn extends Pt{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;h?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST),this.current=h,this.dirty=!1}}class hn extends Pt{getDefault(){return this.gl.LESS}set(h){(h!==this.current||this.dirty)&&(this.gl.depthFunc(h),this.current=h,this.dirty=!1)}}class En extends Pt{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;h?m.enable(m.BLEND):m.disable(m.BLEND),this.current=h,this.dirty=!1}}class zn extends Pt{getDefault(){const h=this.gl;return[h.ONE,h.ZERO]}set(h){const m=this.current;(h[0]!==m[0]||h[1]!==m[1]||this.dirty)&&(this.gl.blendFunc(h[0],h[1]),this.current=h,this.dirty=!1)}}class ei extends Pt{getDefault(){return s.Color.transparent}set(h){const m=this.current;(h.r!==m.r||h.g!==m.g||h.b!==m.b||h.a!==m.a||this.dirty)&&(this.gl.blendColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)}}class ti extends Pt{getDefault(){return this.gl.FUNC_ADD}set(h){(h!==this.current||this.dirty)&&(this.gl.blendEquation(h),this.current=h,this.dirty=!1)}}class li extends Pt{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;h?m.enable(m.CULL_FACE):m.disable(m.CULL_FACE),this.current=h,this.dirty=!1}}class ie extends Pt{getDefault(){return this.gl.BACK}set(h){(h!==this.current||this.dirty)&&(this.gl.cullFace(h),this.current=h,this.dirty=!1)}}class K extends Pt{getDefault(){return this.gl.CCW}set(h){(h!==this.current||this.dirty)&&(this.gl.frontFace(h),this.current=h,this.dirty=!1)}}let Be,rt=class extends Pt{getDefault(){return null}set(_){(_!==this.current||this.dirty)&&(this.gl.useProgram(_),this.current=_,this.dirty=!1)}};class mt extends Pt{getDefault(){return this.gl.TEXTURE0}set(h){(h!==this.current||this.dirty)&&(this.gl.activeTexture(h),this.current=h,this.dirty=!1)}}class zt extends Pt{getDefault(){const h=this.gl;return[0,0,h.drawingBufferWidth,h.drawingBufferHeight]}set(h){const m=this.current;(h[0]!==m[0]||h[1]!==m[1]||h[2]!==m[2]||h[3]!==m[3]||this.dirty)&&(this.gl.viewport(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)}}class en extends Pt{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;m.bindFramebuffer(m.FRAMEBUFFER,h),this.current=h,this.dirty=!1}}class bn extends Pt{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;m.bindRenderbuffer(m.RENDERBUFFER,h),this.current=h,this.dirty=!1}}class Hn extends Pt{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;m.bindTexture(m.TEXTURE_2D,h),this.current=h,this.dirty=!1}}class Pn extends Pt{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;m.bindBuffer(m.ARRAY_BUFFER,h),this.current=h,this.dirty=!1}}class ue extends Pt{getDefault(){return null}set(h){const m=this.gl;m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,h),this.current=h,this.dirty=!1}}class X extends Pt{constructor(h){super(h),this.vao=h.extVertexArrayObject}getDefault(){return null}set(h){this.vao&&(h!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(h),this.current=h,this.dirty=!1)}}class te extends Pt{getDefault(){return 4}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_ALIGNMENT,h),this.current=h,this.dirty=!1}}class de extends Pt{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_PREMULTIPLY_ALPHA_WEBGL,h),this.current=h,this.dirty=!1}}class Pe extends Pt{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,h),this.current=h,this.dirty=!1}}class $e extends Pt{constructor(h,m){super(h),this.context=h,this.parent=m}getDefault(){return null}}class Je extends $e{setDirty(){this.dirty=!0}set(h){if(h===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,h,0),this.current=h,this.dirty=!1}}class qe extends $e{attachment(){return this.gl.DEPTH_ATTACHMENT}set(h){if(h===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferRenderbuffer(m.FRAMEBUFFER,this.attachment(),m.RENDERBUFFER,h),this.current=h,this.dirty=!1}}class Ge extends qe{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class ct{constructor(h,m,x,S){this.context=h,this.width=m,this.height=x;const A=this.framebuffer=h.gl.createFramebuffer();this.colorAttachment=new Je(h,A),S&&(this.depthAttachment=new qe(h,A))}destroy(){const h=this.context.gl,m=this.colorAttachment.get();if(m&&h.deleteTexture(m),this.depthAttachment){const x=this.depthAttachment.get();x&&h.deleteRenderbuffer(x)}h.deleteFramebuffer(this.framebuffer)}}class Ht{constructor(h,m=!1){if(this.gl=h,this.isWebGL2=m,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),m){const x=h;this.extVertexArrayObject={createVertexArrayOES:x.createVertexArray.bind(h),deleteVertexArrayOES:x.deleteVertexArray.bind(h),bindVertexArrayOES:x.bindVertexArray.bind(h)}}this.clearColor=new ae(this),this.clearDepth=new Ae(this),this.clearStencil=new je(this),this.colorMask=new tt(this),this.depthMask=new pt(this),this.stencilMask=new Tt(this),this.stencilFunc=new tn(this),this.stencilOp=new Wt(this),this.stencilTest=new qt(this),this.depthRange=new It(this),this.depthTest=new wn(this),this.depthFunc=new hn(this),this.blend=new En(this),this.blendFunc=new zn(this),this.blendColor=new ei(this),this.blendEquation=new ti(this),this.cullFace=new li(this),this.cullFaceSide=new ie(this),this.frontFace=new K(this),this.program=new rt(this),this.activeTexture=new mt(this),this.viewport=new zt(this),this.bindFramebuffer=new en(this),this.bindRenderbuffer=new bn(this),this.bindTexture=new Hn(this),this.bindVertexBuffer=new Pn(this),this.bindElementBuffer=new ue(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new X(this),this.pixelStoreUnpack=new te(this),this.pixelStoreUnpackPremultiplyAlpha=new de(this),this.pixelStoreUnpackFlipY=new Pe(this),this.extTextureFilterAnisotropic=h.getExtension("EXT_texture_filter_anisotropic")||h.getExtension("MOZ_EXT_texture_filter_anisotropic")||h.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=h.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=h.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=h.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=h.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),m||(this.extTextureHalfFloat=h.getExtension("OES_texture_half_float")),(m||this.extTextureHalfFloat&&h.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=h.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=m||h.getExtension("OES_standard_derivatives"),this.extTimerQuery=h.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=h.getParameter(h.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(h,m){return new kt(this,h,m)}createVertexBuffer(h,m,x){return new ht(this,h,m,x)}createRenderbuffer(h,m,x){const S=this.gl,A=S.createRenderbuffer();return this.bindRenderbuffer.set(A),S.renderbufferStorage(S.RENDERBUFFER,h,m,x),this.bindRenderbuffer.set(null),A}createFramebuffer(h,m,x){return new ct(this,h,m,x)}clear({color:h,depth:m,stencil:x}){const S=this.gl;let A=0;h&&(A|=S.COLOR_BUFFER_BIT,this.clearColor.set(h),this.colorMask.set([!0,!0,!0,!0])),m!==void 0&&(A|=S.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(m),this.depthMask.set(!0)),x!==void 0&&(A|=S.STENCIL_BUFFER_BIT,this.clearStencil.set(x),this.stencilMask.set(255)),S.clear(A)}setCullFace(h){h.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(h.mode),this.frontFace.set(h.frontFace))}setDepthMode(h){h.func!==this.gl.ALWAYS||h.mask?(this.depthTest.set(!0),this.depthFunc.set(h.func),this.depthMask.set(h.mask),this.depthRange.set(h.range)):this.depthTest.set(!1)}setStencilMode(h){h.test.func!==this.gl.ALWAYS||h.mask?(this.stencilTest.set(!0),this.stencilMask.set(h.mask),this.stencilOp.set([h.fail,h.depthFail,h.pass]),this.stencilFunc.set({func:h.test.func,ref:h.ref,mask:h.test.mask})):this.stencilTest.set(!1)}setColorMode(h){d(h.blendFunction,s.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(h.blendFunction),this.blendColor.set(h.blendColor)),this.colorMask.set(h.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Xt extends s.Evented{constructor(h,m,x,S){if(super(),this.id=h,this.dispatcher=x,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.extend(this,s.pick(m,["url","scheme","tileSize","promoteId"])),this._options=s.extend({type:"vector"},m),this._collectResourceTiming=m.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(S),this._tileWorkers={},this._deduped=new s.DedupedRequest}load(h){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"}));const m=Array.isArray(this.map._language)?this.map._language.join():this.map._language,x=this.map._worldview;this._tileJSONRequest=Nt(this._options,this.map._requestManager,m,x,(S,A)=>{this._tileJSONRequest=null,this._loaded=!0,S?(m&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${m}`),x&&x.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${x}`),this.fire(new s.ErrorEvent(S))):A&&(s.extend(this,A),A.bounds&&(this.tileBounds=new We(A.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(A.tiles,this.map._requestManager._customAccessToken),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),h&&h(S)})}loaded(){return this._loaded}hasTile(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)}onAdd(h){this.map=h,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(h){return this._options.tiles=h,this.reload(),this}setUrl(h){return this.url=h,this._options.url=h,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}loadTile(h,m){const x=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme)),S={request:this.map._requestManager.transformRequest(x,s.ResourceType.Tile),data:void 0,uid:h.uid,tileID:h.tileID,tileZoom:h.tileZoom,zoom:h.tileID.overscaledZ,tileSize:this.tileSize*h.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:h.isSymbolTile};if(S.request.collectResourceTiming=this._collectResourceTiming,h.actor&&h.state!=="expired")h.state==="loading"?h.reloadCallback=m:h.request=h.actor.send("reloadTile",S,A.bind(this));else if(h.actor=this._tileWorkers[x]=this._tileWorkers[x]||this.dispatcher.getActor(),this.dispatcher.ready)h.request=h.actor.send("loadTile",S,A.bind(this),void 0,!0);else{const R=s.loadVectorTile.call({deduped:this._deduped},S,(O,z)=>{O||!z?A.call(this,O):(S.data={cacheControl:z.cacheControl,expires:z.expires,rawData:z.rawData.slice(0)},h.actor&&h.actor.send("loadTile",S,A.bind(this),void 0,!0))},!0);h.request={cancel:R}}function A(R,O){return delete h.request,h.aborted?m(null):R&&R.status!==404?m(R):(O&&O.resourceTiming&&(h.resourceTiming=O.resourceTiming),this.map._refreshExpiredTiles&&O&&h.setExpiryData(O),h.loadVectorData(O,this.map.painter),s.cacheEntryPossiblyAdded(this.dispatcher),m(null),void(h.reloadCallback&&(this.loadTile(h,h.reloadCallback),h.reloadCallback=null)))}}abortTile(h){h.request&&(h.request.cancel(),delete h.request),h.actor&&h.actor.send("abortTile",{uid:h.uid,type:this.type,source:this.id})}unloadTile(h){h.unloadVectorData(),h.actor&&h.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Ft extends s.Evented{constructor(h,m,x,S){super(),this.id=h,this.dispatcher=x,this.setEventedParent(S),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.extend({type:"raster"},m),s.extend(this,s.pick(m,["url","scheme","tileSize"]))}load(h){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Nt(this._options,this.map._requestManager,null,null,(m,x)=>{this._tileJSONRequest=null,this._loaded=!0,m?this.fire(new s.ErrorEvent(m)):x&&(s.extend(this,x),x.bounds&&(this.tileBounds=new We(x.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(x.tiles),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),h&&h(m)})}loaded(){return this._loaded}onAdd(h){this.map=h,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(h){return this._options.tiles=h,this.reload(),this}setUrl(h){return this.url=h,this._options.url=h,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}hasTile(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)}loadTile(h,m){const x=s.exported.devicePixelRatio>=2,S=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),x,this.tileSize);h.request=s.getImage(this.map._requestManager.transformRequest(S,s.ResourceType.Tile),(A,R,O,z)=>(delete h.request,h.aborted?(h.state="unloaded",m(null)):A?(h.state="errored",m(A)):R?(this.map._refreshExpiredTiles&&h.setExpiryData({cacheControl:O,expires:z}),h.setTexture(R,this.map.painter),h.state="loaded",s.cacheEntryPossiblyAdded(this.dispatcher),void m(null)):m(null)))}static loadTileData(h,m,x){h.setTexture(m,x)}static unloadTileData(h,m){h.texture&&m.saveTileTexture(h.texture)}abortTile(h,m){h.request&&(h.request.cancel(),delete h.request),m()}unloadTile(h,m){h.texture&&this.map.painter.saveTileTexture(h.texture),m()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function qn(_,h,m,x,S,A,R,O){const z=[_,m,S,h,x,A,1,1,1],$=[R,O,1],j=s.adjoint([],z),[Z,re,he]=s.transformMat3($,$,s.transpose(j,j));return s.multiply$1(z,[Z,0,0,0,re,0,0,0,he],z)}class ci extends s.Evented{constructor(h,m,x,S){super(),this.id=h,this.dispatcher=x,this.coordinates=m.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(S),this.options=m,this._dirty=!1}load(h,m){this._loaded=m||!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=s.getImage(this.map._requestManager.transformRequest(this.url,s.ResourceType.Image),(x,S)=>{if(this._imageRequest=null,this._loaded=!0,x)this.fire(new s.ErrorEvent(x));else if(S){const{HTMLImageElement:A}=s.window;this.image=S instanceof A?s.exported.getImageData(S):S,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,h&&(this.coordinates=h),this._finishLoading()}})}loaded(){return this._loaded}updateImage(h){return this.image&&h.url?(this._imageRequest&&h.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=h.url,this.load(h.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(h){this.map=h,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(h){this.coordinates=h,this._boundsArray=void 0;const m=h.map(s.MercatorCoordinate.fromLngLat);return this.tileID=function(x){let S=1/0,A=1/0,R=-1/0,O=-1/0;for(const Z of x)S=Math.min(S,Z.x),A=Math.min(A,Z.y),R=Math.max(R,Z.x),O=Math.max(O,Z.y);const z=Math.max(R-S,O-A),$=Math.max(0,Math.floor(-Math.log(z)/Math.LN2)),j=Math.pow(2,$);return new s.CanonicalTileID($,Math.floor((S+R)/2*j),Math.floor((A+O)/2*j))}(m),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(h){for(const z in this.tiles){const $=this.tiles[z];$.state!=="loaded"&&($.state="loaded",$.texture=this.texture)}if(this._boundsArray)return;const m=s.tileTransform(this.tileID,this.map.transform.projection),[x,S,A,R]=this.coordinates.map(z=>{const $=m.projection.project(z[0],z[1]);return s.getTilePoint(m,$)._round()});this.perspectiveTransform=function(z,$,j,Z,re,he,ge,pe,_e,Y){const ce=qn(0,0,z,0,0,$,z,$),Ee=qn(j,Z,re,he,ge,pe,_e,Y);return s.multiply$1(Ee,s.adjoint(ce,ce),Ee),[Ee[6]/Ee[8]*z/s.EXTENT,Ee[7]/Ee[8]*$/s.EXTENT]}(this.width,this.height,x.x,x.y,S.x,S.y,R.x,R.y,A.x,A.y);const O=this._boundsArray=new s.StructArrayLayout4i8;O.emplaceBack(x.x,x.y,0,0),O.emplaceBack(S.x,S.y,s.EXTENT,0),O.emplaceBack(R.x,R.y,0,s.EXTENT),O.emplaceBack(A.x,A.y,s.EXTENT,s.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=h.createVertexBuffer(O,s.boundsAttributes.members),this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const h=this.map.painter.context,m=h.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new s.Texture(h,this.image,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(h)}loadTile(h,m){this.tileID&&this.tileID.equals(h.tileID.canonical)?(this.tiles[String(h.tileID.wrap)]=h,h.buckets={},m(null)):(h.state="errored",m(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Yn={vector:Xt,raster:Ft,"raster-dem":class extends Ft{constructor(_,h,m,x){super(_,h,m,x),this.type="raster-dem",this.maxzoom=22,this._options=s.extend({type:"raster-dem"},h),this.encoding=h.encoding||"mapbox"}loadTile(_,h){const m=this.map._requestManager.normalizeTileURL(_.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function x(S,A){S&&(_.state="errored",h(S)),A&&(_.dem=A,_.dem.onDeserialize(),_.needsHillshadePrepare=!0,_.needsDEMTextureUpload=!0,_.state="loaded",h(null))}_.request=s.getImage(this.map._requestManager.transformRequest(m,s.ResourceType.Tile),(function(S,A,R,O){if(delete _.request,_.aborted)_.state="unloaded",h(null);else if(S)_.state="errored",h(S);else if(A){this.map._refreshExpiredTiles&&_.setExpiryData({cacheControl:R,expires:O});const z=s.window.ImageBitmap&&A instanceof s.window.ImageBitmap&&(Be==null&&(Be=s.window.OffscreenCanvas&&new s.window.OffscreenCanvas(1,1).getContext("2d")&&typeof s.window.createImageBitmap=="function"),Be),$=1-(A.width-s.prevPowerOfTwo(A.width))/2;$<1||_.neighboringTiles||(_.neighboringTiles=this._getNeighboringTiles(_.tileID));const j=z?A:s.exported.getImageData(A,$),Z={uid:_.uid,coord:_.tileID,source:this.id,rawImageData:j,encoding:this.encoding,padding:$};_.actor&&_.state!=="expired"||(_.actor=this.dispatcher.getActor(),_.actor.send("loadDEMTile",Z,x.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(_){const h=_.canonical,m=Math.pow(2,h.z),x=(h.x-1+m)%m,S=h.x===0?_.wrap-1:_.wrap,A=(h.x+1+m)%m,R=h.x+1===m?_.wrap+1:_.wrap,O={};return O[new s.OverscaledTileID(_.overscaledZ,S,h.z,x,h.y).key]={backfilled:!1},O[new s.OverscaledTileID(_.overscaledZ,R,h.z,A,h.y).key]={backfilled:!1},h.y>0&&(O[new s.OverscaledTileID(_.overscaledZ,S,h.z,x,h.y-1).key]={backfilled:!1},O[new s.OverscaledTileID(_.overscaledZ,_.wrap,h.z,h.x,h.y-1).key]={backfilled:!1},O[new s.OverscaledTileID(_.overscaledZ,R,h.z,A,h.y-1).key]={backfilled:!1}),h.y+1<m&&(O[new s.OverscaledTileID(_.overscaledZ,S,h.z,x,h.y+1).key]={backfilled:!1},O[new s.OverscaledTileID(_.overscaledZ,_.wrap,h.z,h.x,h.y+1).key]={backfilled:!1},O[new s.OverscaledTileID(_.overscaledZ,R,h.z,A,h.y+1).key]={backfilled:!1}),O}unloadTile(_){_.demTexture&&this.map.painter.saveTileTexture(_.demTexture),_.fbo&&(_.fbo.destroy(),delete _.fbo),_.dem&&delete _.dem,delete _.neighboringTiles,_.state="unloaded"}},geojson:class extends s.Evented{constructor(_,h,m,x){super(),this.id=_,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=m.getActor(),this.setEventedParent(x),this._data=h.data,this._options=s.extend({},h),this._collectResourceTiming=h.collectResourceTiming,h.maxzoom!==void 0&&(this.maxzoom=h.maxzoom),h.type&&(this.type=h.type),h.attribution&&(this.attribution=h.attribution),this.promoteId=h.promoteId;const S=s.EXTENT/this.tileSize;this.workerOptions=s.extend({source:this.id,cluster:h.cluster||!1,geojsonVtOptions:{buffer:(h.buffer!==void 0?h.buffer:128)*S,tolerance:(h.tolerance!==void 0?h.tolerance:.375)*S,extent:s.EXTENT,maxZoom:this.maxzoom,lineMetrics:h.lineMetrics||!1,generateId:h.generateId||!1},superclusterOptions:{maxZoom:h.clusterMaxZoom!==void 0?h.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,h.clusterMinPoints||2),extent:s.EXTENT,radius:(h.clusterRadius!==void 0?h.clusterRadius:50)*S,log:!1,generateId:h.generateId||!1},clusterProperties:h.clusterProperties,filter:h.filter},h.workerOptions)}onAdd(_){this.map=_,this.setData(this._data)}setData(_){return this._data=_,this._updateWorkerData(),this}getClusterExpansionZoom(_,h){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:_,source:this.id},h),this}getClusterChildren(_,h){return this.actor.send("geojson.getClusterChildren",{clusterId:_,source:this.id},h),this}getClusterLeaves(_,h,m,x){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:_,limit:h,offset:m},x),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new s.Event("dataloading",{dataType:"source"})),this._loaded=!1;const _=s.extend({},this.workerOptions),h=this._data;typeof h=="string"?(_.request=this.map._requestManager.transformRequest(s.exported.resolveURL(h),s.ResourceType.Source),_.request.collectResourceTiming=this._collectResourceTiming):_.data=JSON.stringify(h),this._pendingLoad=this.actor.send(`${this.type}.loadData`,_,(m,x)=>{if(this._loaded=!0,this._pendingLoad=null,m)this.fire(new s.ErrorEvent(m));else{const S={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&x&&x.resourceTiming&&x.resourceTiming[this.id]&&(S.resourceTiming=x.resourceTiming[this.id]),this.fire(new s.Event("data",S)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(_,h){const m=_.actor?"reloadTile":"loadTile";_.actor=this.actor,_.request=this.actor.send(m,{type:this.type,uid:_.uid,tileID:_.tileID,tileZoom:_.tileZoom,zoom:_.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(x,S)=>(delete _.request,_.unloadVectorData(),_.aborted?h(null):x?h(x):(_.loadVectorData(S,this.map.painter,m==="reloadTile"),h(null))),void 0,m==="loadTile")}abortTile(_){_.request&&(_.request.cancel(),delete _.request),_.aborted=!0}unloadTile(_){_.unloadVectorData(),this.actor.send("removeTile",{uid:_.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return s.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends ci{constructor(_,h,m,x){super(_,h,m,x),this.roundZoom=!0,this.type="video",this.options=h}load(){this._loaded=!1;const _=this.options;this.urls=[];for(const h of _.urls)this.urls.push(this.map._requestManager.transformRequest(h,s.ResourceType.Source).url);s.getVideo(this.urls,(h,m)=>{this._loaded=!0,h?this.fire(new s.ErrorEvent(h)):m&&(this.video=m,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(_){if(this.video){const h=this.video.seekable;_<h.start(0)||_>h.end(0)?this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${h.start(0)} and ${h.end(0)}-second mark.`))):this.video.currentTime=_}}getVideo(){return this.video}onAdd(_){this.map||(this.map=_,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const _=this.map.painter.context,h=_.gl;this.texture?this.video.paused||(this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),h.texSubImage2D(h.TEXTURE_2D,0,0,0,h.RGBA,h.UNSIGNED_BYTE,this.video)):(this.texture=new s.Texture(_,this.video,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(_)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:ci,canvas:class extends ci{constructor(_,h,m,x){super(_,h,m,x),h.coordinates?Array.isArray(h.coordinates)&&h.coordinates.length===4&&!h.coordinates.some(S=>!Array.isArray(S)||S.length!==2||S.some(A=>typeof A!="number"))||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${_}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${_}`,null,'missing required property "coordinates"'))),h.animate&&typeof h.animate!="boolean"&&this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${_}`,null,'optional "animate" property must be a boolean value'))),h.canvas?typeof h.canvas=="string"||h.canvas instanceof s.window.HTMLCanvasElement||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${_}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${_}`,null,'missing required property "canvas"'))),this.options=h,this.animate=h.animate===void 0||h.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof s.window.HTMLCanvasElement?this.options.canvas:s.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(_){this.map=_,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let _=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,_=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,_=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const h=this.map.painter.context;this.texture?(_||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.Texture(h,this.canvas,h.gl.RGBA,{premultiply:!0}),this._prepareData(h)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const _ of[this.canvas.width,this.canvas.height])if(isNaN(_)||_<=0)return!0;return!1}},custom:class extends s.Evented{constructor(_,h,m,x){super(),this.id=_,this.type="custom",this._dataType="raster",this._dispatcher=m,this._implementation=h,this.setEventedParent(x),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new s.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new s.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new We(this._implementation.bounds,this.minzoom,this.maxzoom)),h.update=this._update.bind(this),h.clearTiles=this._clearTiles.bind(this),h.coveringTiles=this._coveringTiles.bind(this),s.extend(this,s.pick(h,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return s.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(_){this._map=_,this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(_),this.load()}onRemove(_){this._implementation.onRemove&&this._implementation.onRemove(_)}hasTile(_){if(this._implementation.hasTile){const{x:h,y:m,z:x}=_.canonical;return this._implementation.hasTile({x:h,y:m,z:x})}return!this.tileBounds||this.tileBounds.contains(_.canonical)}loadTile(_,h){const{x:m,y:x,z:S}=_.tileID.canonical,A=new s.window.AbortController;_.request=Promise.resolve(this._implementation.loadTile({x:m,y:x,z:S},{signal:A.signal})).then((function(R){return delete _.request,_.aborted?(_.state="unloaded",h(null)):R===void 0?(_.state="errored",h(null)):R===null?(this.loadTileData(_,{width:this.tileSize,height:this.tileSize,data:null}),_.state="loaded",h(null)):function(O){return O instanceof s.window.ImageData||O instanceof s.window.HTMLCanvasElement||O instanceof s.window.ImageBitmap||O instanceof s.window.HTMLImageElement}(R)?(this.loadTileData(_,R),_.state="loaded",void h(null)):(_.state="errored",h(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(R=>{R.code!==20&&(_.state="errored",h(R))}),_.request.cancel=()=>A.abort()}loadTileData(_,h){Ft.loadTileData(_,h,this._map.painter)}unloadTileData(_){Ft.unloadTileData(_,this._map.painter)}unloadTile(_,h){if(this.unloadTileData(_),this._implementation.unloadTile){const{x:m,y:x,z:S}=_.tileID.canonical;this._implementation.unloadTile({x:m,y:x,z:S})}h()}abortTile(_,h){_.request&&_.request.cancel&&(_.request.cancel(),delete _.request),h()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(_=>({x:_.canonical.x,y:_.canonical.y,z:_.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}}},ii=function(_,h,m,x){const S=new Yn[h.type](_,h,m,x);if(S.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${S.id}`);return s.bindAll(["load","abort","unload","serialize","prepare"],S),S};function mi(_,h){const m=s.identity([]);return s.scale(m,m,[.5*_.width,.5*-_.height,1]),s.translate(m,m,[1,-1,0]),s.multiply(m,m,_.calculateProjMatrix(h.toUnwrapped())),Float32Array.from(m)}function Vi(_,h,m,x,S,A,R,O=!1){const z=_.tilesIn(x,R,O);z.sort(Fr);const $=[];for(const Z of z)$.push({wrappedTileID:Z.tile.tileID.wrapped().key,queryResults:Z.tile.queryRenderedFeatures(h,m,_._state,Z,S,A,mi(_.transform,Z.tile.tileID),O)});const j=function(Z){const re={},he={};for(const ge of Z){const pe=ge.queryResults,_e=ge.wrappedTileID,Y=he[_e]=he[_e]||{};for(const ce in pe){const Ee=pe[ce],Se=Y[ce]=Y[ce]||{},ze=re[ce]=re[ce]||[];for(const Ve of Ee)Se[Ve.featureIndex]||(Se[Ve.featureIndex]=!0,ze.push(Ve))}}return re}($);for(const Z in j)j[Z].forEach(re=>{const he=re.feature,ge=he.layer;ge&&ge.type!=="background"&&ge.type!=="sky"&&(he.source=ge.source,ge["source-layer"]&&(he.sourceLayer=ge["source-layer"]),he.state=he.id!==void 0?_.getFeatureState(ge["source-layer"],he.id):{})});return j}function hr(_,h){const m=_.getRenderableIds().map(A=>_.getTileByID(A)),x=[],S={};for(let A=0;A<m.length;A++){const R=m[A],O=R.tileID.canonical.key;S[O]||(S[O]=!0,R.querySourceFeatures(x,h))}return x}function Fr(_,h){const m=_.tileID,x=h.tileID;return m.overscaledZ-x.overscaledZ||m.canonical.y-x.canonical.y||m.wrap-x.wrap||m.canonical.x-x.canonical.x}function xr(){return Fu.workerClass!=null?new Fu.workerClass:new s.window.Worker(Fu.workerUrl)}const Ko="mapboxgl_preloaded_worker_pool";class Cr{constructor(){this.active={}}acquire(h){if(!this.workers)for(this.workers=[];this.workers.length<Cr.workerCount;)this.workers.push(new xr);return this.active[h]=!0,this.workers.slice()}release(h){delete this.active[h],this.numActive()===0&&(this.workers.forEach(m=>{m.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Ko]}numActive(){return Object.keys(this.active).length}}let Kr;function Bo(){return Kr||(Kr=new Cr),Kr}function na(_,h){const m={};for(const x in _)x!=="ref"&&(m[x]=_[x]);return s.refProperties.forEach(x=>{x in h&&(m[x]=h[x])}),m}function Fs(_){_=_.slice();const h=Object.create(null);for(let m=0;m<_.length;m++)h[_[m].id]=_[m];for(let m=0;m<_.length;m++)"ref"in _[m]&&(_[m]=na(_[m],h[_[m].ref]));return _}Cr.workerCount=2;const vi={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Xo(_,h,m){m.push({command:vi.addSource,args:[_,h[_]]})}function Za(_,h,m){h.push({command:vi.removeSource,args:[_]}),m[_]=!0}function Dl(_,h,m,x){Za(_,m,x),Xo(_,h,m)}function ia(_,h,m){let x;for(x in _[m])if(_[m].hasOwnProperty(x)&&x!=="data"&&!d(_[m][x],h[m][x]))return!1;for(x in h[m])if(h[m].hasOwnProperty(x)&&x!=="data"&&!d(_[m][x],h[m][x]))return!1;return!0}function wr(_,h,m,x,S,A){let R;for(R in h=h||{},_=_||{})_.hasOwnProperty(R)&&(d(_[R],h[R])||m.push({command:A,args:[x,R,h[R],S]}));for(R in h)h.hasOwnProperty(R)&&!_.hasOwnProperty(R)&&(d(_[R],h[R])||m.push({command:A,args:[x,R,h[R],S]}))}function bo(_){return _.id}function zo(_,h){return _[h.id]=h,_}class Io{constructor(h,m){this.reset(h,m)}reset(h,m){this.points=h||[],this._distances=[0];for(let x=1;x<this.points.length;x++)this._distances[x]=this._distances[x-1]+this.points[x].dist(this.points[x-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(m||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(h){if(this.points.length===1)return this.points[0];h=s.clamp(h,0,1);let m=1,x=this._distances[m];const S=h*this.paddedLength+this.padding;for(;x<S&&m<this._distances.length;)x=this._distances[++m];const A=m-1,R=this._distances[A],O=x-R,z=O>0?(S-R)/O:0;return this.points[A].mult(1-z).add(this.points[m].mult(z))}}class Zo{constructor(h,m,x){const S=this.boxCells=[],A=this.circleCells=[];this.xCellCount=Math.ceil(h/x),this.yCellCount=Math.ceil(m/x);for(let R=0;R<this.xCellCount*this.yCellCount;R++)S.push([]),A.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=h,this.height=m,this.xScale=this.xCellCount/h,this.yScale=this.yCellCount/m,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(h,m,x,S,A){this._forEachCell(m,x,S,A,this._insertBoxCell,this.boxUid++),this.boxKeys.push(h),this.bboxes.push(m),this.bboxes.push(x),this.bboxes.push(S),this.bboxes.push(A)}insertCircle(h,m,x,S){this._forEachCell(m-S,x-S,m+S,x+S,this._insertCircleCell,this.circleUid++),this.circleKeys.push(h),this.circles.push(m),this.circles.push(x),this.circles.push(S)}_insertBoxCell(h,m,x,S,A,R){this.boxCells[A].push(R)}_insertCircleCell(h,m,x,S,A,R){this.circleCells[A].push(R)}_query(h,m,x,S,A,R){if(x<0||h>this.width||S<0||m>this.height)return!A&&[];const O=[];if(h<=0&&m<=0&&this.width<=x&&this.height<=S){if(A)return!0;for(let z=0;z<this.boxKeys.length;z++)O.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(let z=0;z<this.circleKeys.length;z++){const $=this.circles[3*z],j=this.circles[3*z+1],Z=this.circles[3*z+2];O.push({key:this.circleKeys[z],x1:$-Z,y1:j-Z,x2:$+Z,y2:j+Z})}return R?O.filter(R):O}return this._forEachCell(h,m,x,S,this._queryCell,O,{hitTest:A,seenUids:{box:{},circle:{}}},R),A?O.length>0:O}_queryCircle(h,m,x,S,A){const R=h-x,O=h+x,z=m-x,$=m+x;if(O<0||R>this.width||$<0||z>this.height)return!S&&[];const j=[];return this._forEachCell(R,z,O,$,this._queryCellCircle,j,{hitTest:S,circle:{x:h,y:m,radius:x},seenUids:{box:{},circle:{}}},A),S?j.length>0:j}query(h,m,x,S,A){return this._query(h,m,x,S,!1,A)}hitTest(h,m,x,S,A){return this._query(h,m,x,S,!0,A)}hitTestCircle(h,m,x,S){return this._queryCircle(h,m,x,!0,S)}_queryCell(h,m,x,S,A,R,O,z){const $=O.seenUids,j=this.boxCells[A];if(j!==null){const re=this.bboxes;for(const he of j)if(!$.box[he]){$.box[he]=!0;const ge=4*he;if(h<=re[ge+2]&&m<=re[ge+3]&&x>=re[ge+0]&&S>=re[ge+1]&&(!z||z(this.boxKeys[he]))){if(O.hitTest)return R.push(!0),!0;R.push({key:this.boxKeys[he],x1:re[ge],y1:re[ge+1],x2:re[ge+2],y2:re[ge+3]})}}}const Z=this.circleCells[A];if(Z!==null){const re=this.circles;for(const he of Z)if(!$.circle[he]){$.circle[he]=!0;const ge=3*he;if(this._circleAndRectCollide(re[ge],re[ge+1],re[ge+2],h,m,x,S)&&(!z||z(this.circleKeys[he]))){if(O.hitTest)return R.push(!0),!0;{const pe=re[ge],_e=re[ge+1],Y=re[ge+2];R.push({key:this.circleKeys[he],x1:pe-Y,y1:_e-Y,x2:pe+Y,y2:_e+Y})}}}}}_queryCellCircle(h,m,x,S,A,R,O,z){const $=O.circle,j=O.seenUids,Z=this.boxCells[A];if(Z!==null){const he=this.bboxes;for(const ge of Z)if(!j.box[ge]){j.box[ge]=!0;const pe=4*ge;if(this._circleAndRectCollide($.x,$.y,$.radius,he[pe+0],he[pe+1],he[pe+2],he[pe+3])&&(!z||z(this.boxKeys[ge])))return R.push(!0),!0}}const re=this.circleCells[A];if(re!==null){const he=this.circles;for(const ge of re)if(!j.circle[ge]){j.circle[ge]=!0;const pe=3*ge;if(this._circlesCollide(he[pe],he[pe+1],he[pe+2],$.x,$.y,$.radius)&&(!z||z(this.circleKeys[ge])))return R.push(!0),!0}}}_forEachCell(h,m,x,S,A,R,O,z){const $=this._convertToXCellCoord(h),j=this._convertToYCellCoord(m),Z=this._convertToXCellCoord(x),re=this._convertToYCellCoord(S);for(let he=$;he<=Z;he++)for(let ge=j;ge<=re;ge++)if(A.call(this,h,m,x,S,this.xCellCount*ge+he,R,O,z))return}_convertToXCellCoord(h){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(h*this.xScale)))}_convertToYCellCoord(h){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(h*this.yScale)))}_circlesCollide(h,m,x,S,A,R){const O=S-h,z=A-m,$=x+R;return $*$>O*O+z*z}_circleAndRectCollide(h,m,x,S,A,R,O){const z=(R-S)/2,$=Math.abs(h-(S+z));if($>z+x)return!1;const j=(O-A)/2,Z=Math.abs(m-(A+j));if(Z>j+x)return!1;if($<=z||Z<=j)return!0;const re=$-z,he=Z-j;return re*re+he*he<=x*x}}const Br={unknown:0,flipRequired:1,flipNotRequired:2},Mo=Math.tan(85*Math.PI/180);function yt(_,h,m,x,S,A,R){const O=s.create();if(m)if(A.name==="globe"){const z=s.calculateGlobeLabelMatrix(S,h);s.multiply(O,O,z)}else{const z=J([],R);O[0]=z[0],O[1]=z[1],O[4]=z[2],O[5]=z[3],x||s.rotateZ(O,O,S.angle)}else s.multiply(O,S.labelPlaneMatrix,_);return O}function No(_,h,m,x,S,A,R){const O=yt(_,h,m,x,S,A,R);return A.name==="globe"&&m||(O[2]=O[6]=O[10]=O[14]=0),O}function sr(_,h,m,x,S,A,R){if(m){if(A.name==="globe"){const O=yt(_,h,m,x,S,A,R);return s.invert(O,O),s.multiply(O,_,O),O}{const O=s.clone(_),z=s.identity([]);return z[0]=R[0],z[1]=R[1],z[4]=R[2],z[5]=R[3],s.multiply(O,O,z),x||s.rotateZ(O,O,-S.angle),O}}return S.glCoordMatrix}function Ai(_,h,m,x){const S=[_,h,m,1];m?s.transformMat4$1(S,S,x):ni(S,S,x);const A=S[3];return S[0]/=A,S[1]/=A,S[2]/=A,S}function er(_,h){return Math.min(.5+_/h*.5,1.5)}function go(_,h){const m=_[0]/_[3],x=_[1]/_[3];return m>=-h[0]&&m<=h[0]&&x>=-h[1]&&x<=h[1]}function ra(_,h,m,x,S,A,R,O,z,$){const j=m.transform,Z=x?_.textSizeData:_.iconSizeData,re=s.evaluateSizeForZoom(Z,m.transform.zoom),he=j.projection.name==="globe",ge=[256/m.width*2+1,256/m.height*2+1],pe=x?_.text.dynamicLayoutVertexArray:_.icon.dynamicLayoutVertexArray;pe.clear();let _e=null;he&&(_e=x?_.text.globeExtVertexArray:_.icon.globeExtVertexArray);const Y=_.lineVertexArray,ce=x?_.text.placedSymbolArray:_.icon.placedSymbolArray,Ee=m.transform.width/m.transform.height;let Se,ze=!1;for(let Ve=0;Ve<ce.length;Ve++){const Ne=ce.get(Ve),{numGlyphs:Ye,writingMode:Xe}=Ne;if(Xe!==s.WritingMode.vertical||ze||Se===s.WritingMode.horizontal||(ze=!0),Se=Xe,(Ne.hidden||Xe===s.WritingMode.vertical)&&!ze){xo(Ye,pe);continue}ze=!1;const st=new s.Point(Ne.tileAnchorX,Ne.tileAnchorY);let{x:Ut,y:nt,z:wt}=j.projection.projectTilePoint(st.x,st.y,$.canonical);if(z){const[Qn,gn,Fn]=z(st);Ut+=Qn,nt+=gn,wt+=Fn}const dt=[Ut,nt,wt,1];if(s.transformMat4$1(dt,dt,h),!go(dt,ge)){xo(Ye,pe);continue}const Bt=er(m.transform.cameraToCenterDistance,dt[3]),ot=s.evaluateSizeForFeature(Z,re,Ne),xt=R?ot/Bt:ot*Bt,jt=Ai(Ut,nt,wt,S);if(jt[3]<=0){xo(Ye,pe);continue}let Mt={};const Gt=R?null:z,In=nn(Ne,xt,!1,O,h,S,A,_.glyphOffsetArray,Y,pe,_e,jt,st,Mt,Ee,Gt,j.projection,$,R);ze=In.useVertical,Gt&&In.needsFlipping&&(Mt={}),(In.notEnoughRoom||ze||In.needsFlipping&&nn(Ne,xt,!0,O,h,S,A,_.glyphOffsetArray,Y,pe,_e,jt,st,Mt,Ee,Gt,j.projection,$,R).notEnoughRoom)&&xo(Ye,pe)}x?(_.text.dynamicLayoutVertexBuffer.updateData(pe),_e&&_.text.globeExtVertexBuffer.updateData(_e)):(_.icon.dynamicLayoutVertexBuffer.updateData(pe),_e&&_.icon.globeExtVertexBuffer.updateData(_e))}function qa(_,h,m,x,S,A,R,O,z,$,j,Z,re,he,ge,pe){const{lineStartIndex:_e,glyphStartIndex:Y,segment:ce}=O,Ee=Y+O.numGlyphs,Se=_e+O.lineLength,ze=h.getoffsetX(Y),Ve=h.getoffsetX(Ee-1),Ne=yo(_*ze,m,x,S,A,R,ce,_e,Se,z,$,j,Z,re,!0,he,ge,pe);if(!Ne)return null;const Ye=yo(_*Ve,m,x,S,A,R,ce,_e,Se,z,$,j,Z,re,!0,he,ge,pe);return Ye?{first:Ne,last:Ye}:null}function Ts(_,h,m,x){return _===s.WritingMode.horizontal&&Math.abs(x)>Math.abs(m)?{useVertical:!0}:_===s.WritingMode.vertical?x>0?{needsFlipping:!0}:null:h!==Br.unknown&&function(S,A){return S===0||Math.abs(A/S)>Mo}(m,x)?h===Br.flipRequired?{needsFlipping:!0}:null:m<0?{needsFlipping:!0}:null}function nn(_,h,m,x,S,A,R,O,z,$,j,Z,re,he,ge,pe,_e,Y,ce){const Ee=h/24,Se=_.lineOffsetX*Ee,ze=_.lineOffsetY*Ee,{lineStartIndex:Ve,glyphStartIndex:Ne,numGlyphs:Ye,segment:Xe,writingMode:st,flipState:Ut}=_,nt=Ve+_.lineLength,wt=dt=>{if(j){const[jt,Mt,Gt]=dt.up,In=$.length;s.updateGlobeVertexNormal(j,In+0,jt,Mt,Gt),s.updateGlobeVertexNormal(j,In+1,jt,Mt,Gt),s.updateGlobeVertexNormal(j,In+2,jt,Mt,Gt),s.updateGlobeVertexNormal(j,In+3,jt,Mt,Gt)}const[Bt,ot,xt]=dt.point;s.addDynamicAttributes($,Bt,ot,xt,dt.angle)};if(Ye>1){const dt=qa(Ee,O,Se,ze,m,Z,re,_,z,A,he,pe,!1,_e,Y,ce);if(!dt)return{notEnoughRoom:!0};if(x&&!m){let[Bt,ot,xt]=dt.first.point,[jt,Mt,Gt]=dt.last.point;[Bt,ot]=Ai(Bt,ot,xt,R),[jt,Mt]=Ai(jt,Mt,Gt,R);const In=Ts(st,Ut,(jt-Bt)*ge,Mt-ot);if(_.flipState=In&&In.needsFlipping?Br.flipRequired:Br.flipNotRequired,In)return In}wt(dt.first);for(let Bt=Ne+1;Bt<Ne+Ye-1;Bt++){const ot=yo(Ee*O.getoffsetX(Bt),Se,ze,m,Z,re,Xe,Ve,nt,z,A,he,pe,!1,!1,_e,Y,ce);if(!ot)return $.length-=4*(Bt-Ne),{notEnoughRoom:!0};wt(ot)}wt(dt.last)}else{if(x&&!m){const Bt=Ai(re.x,re.y,0,S),ot=Ve+Xe+1,xt=new s.Point(z.getx(ot),z.gety(ot)),jt=Ai(xt.x,xt.y,0,S),Mt=jt[3]>0?jt:Jn(re,xt,Bt,1,S,void 0,_e,Y.canonical),Gt=Ts(st,Ut,(Mt[0]-Bt[0])*ge,Mt[1]-Bt[1]);if(_.flipState=Gt&&Gt.needsFlipping?Br.flipRequired:Br.flipNotRequired,Gt)return Gt}const dt=yo(Ee*O.getoffsetX(Ne),Se,ze,m,Z,re,Xe,Ve,nt,z,A,he,pe,!1,!1,_e,Y,ce);if(!dt)return{notEnoughRoom:!0};wt(dt)}return{}}function Kn(_,h,m,x,S){const{x:A,y:R,z:O}=x.projectTilePoint(_.x,_.y,h);if(!S)return Ai(A,R,O,m);const[z,$,j]=S(_);return Ai(A+z,R+$,O+j,m)}function Jn(_,h,m,x,S,A,R,O){const z=Kn(_.sub(h)._unit()._add(_),O,S,R,A);return s.sub(z,m,z),s.normalize(z,z),s.scaleAndAdd(z,m,z,x)}function yo(_,h,m,x,S,A,R,O,z,$,j,Z,re,he,ge,pe,_e,Y){const ce=x?_-h:_+h;let Ee=ce>0?1:-1,Se=0;x&&(Ee*=-1,Se=Math.PI),Ee<0&&(Se+=Math.PI);let ze=O+R+(Ee>0?0:1)|0,Ve=S,Ne=S,Ye=0,Xe=0;const st=Math.abs(ce),Ut=[],nt=[];let wt=A,dt=wt;const Bt=()=>Jn(dt,wt,Ne,st-Ye+1,j,re,pe,_e.canonical);for(;Ye+Xe<=st;){if(ze+=Ee,ze<O||ze>=z)return null;if(Ne=Ve,dt=wt,Ut.push(Ne),he&&nt.push(dt),wt=new s.Point($.getx(ze),$.gety(ze)),Ve=Z[ze],!Ve){const Fn=Kn(wt,_e.canonical,j,pe,re);Ve=Fn[3]>0?Z[ze]=Fn:Bt()}Ye+=Xe,Xe=s.distance(Ne,Ve)}ge&&re&&(Z[ze]&&(Ve=Bt(),Xe=s.distance(Ne,Ve)),Z[ze]=Ve);const ot=(st-Ye)/Xe,xt=wt.sub(dt)._mult(ot)._add(dt),jt=s.sub([],Ve,Ne),Mt=s.scaleAndAdd([],Ne,jt,ot);let Gt=[0,0,1],In=jt[0],Qn=jt[1];if(Y&&(Gt=pe.upVector(_e.canonical,xt.x,xt.y),Gt[0]!==0||Gt[1]!==0||Gt[2]!==1)){const Fn=[Gt[2],0,-Gt[0]],yi=s.cross([],Gt,Fn);s.normalize(Fn,Fn),s.normalize(yi,yi),In=s.dot(jt,Fn),Qn=s.dot(jt,yi)}if(m){const Fn=s.cross([],Gt,jt);s.normalize(Fn,Fn),s.scaleAndAdd(Mt,Mt,Fn,m*Ee)}const gn=Se+Math.atan2(Qn,In);return Ut.push(Mt),he&&nt.push(xt),{point:Mt,angle:gn,path:Ut,tilePath:nt,up:Gt}}function xo(_,h){const m=h.length,x=m+4*_;h.resize(x),h.float32.fill(-1/0,4*m,4*x)}function ni(_,h,m){const x=h[0],S=h[1];return _[0]=m[0]*x+m[4]*S+m[12],_[1]=m[1]*x+m[5]*S+m[13],_[3]=m[3]*x+m[7]*S+m[15],_}const Ro=100;class Ya{constructor(h,m,x=new Zo(h.width+200,h.height+200,25),S=new Zo(h.width+200,h.height+200,25)){this.transform=h,this.grid=x,this.ignoredGrid=S,this.pitchfactor=Math.cos(h._pitch)*h.cameraToCenterDistance,this.screenRightBoundary=h.width+Ro,this.screenBottomBoundary=h.height+Ro,this.gridRightBoundary=h.width+200,this.gridBottomBoundary=h.height+200,this.fogState=m}placeCollisionBox(h,m,x,S,A,R,O,z){let $=x.projectedAnchorX,j=x.projectedAnchorY,Z=x.projectedAnchorZ;const re=x.elevation,he=x.tileID,ge=h.getProjection();if(re&&he){const[Ve,Ne,Ye]=ge.upVector(he.canonical,x.tileAnchorX,x.tileAnchorY),Xe=ge.upVectorScale(he.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;$+=Ve*re*Xe,j+=Ne*re*Xe,Z+=Ye*re*Xe}const pe=this.projectAndGetPerspectiveRatio(O,$,j,Z,x.tileID,ge.name==="globe"||!!re||this.transform.pitch>0,ge),_e=R*pe.perspectiveRatio,Y=(x.x1*m+S.x-x.padding)*_e+pe.point.x,ce=(x.y1*m+S.y-x.padding)*_e+pe.point.y,Ee=(x.x2*m+S.x+x.padding)*_e+pe.point.x,Se=(x.y2*m+S.y+x.padding)*_e+pe.point.y,ze=pe.perspectiveRatio<=.55||pe.occluded;return!this.isInsideGrid(Y,ce,Ee,Se)||!A&&this.grid.hitTest(Y,ce,Ee,Se,z)||ze?{box:[],offscreen:!1,occluded:pe.occluded}:{box:[Y,ce,Ee,Se],offscreen:this.isOffscreen(Y,ce,Ee,Se),occluded:!1}}placeCollisionCircles(h,m,x,S,A,R,O,z,$,j,Z,re,he,ge,pe){const _e=[],Y=this.transform.elevation,ce=h.getProjection(),Ee=Y?Y.getAtTileOffsetFunc(pe,this.transform.center.lat,this.transform.worldSize,ce):null,Se=new s.Point(x.tileAnchorX,x.tileAnchorY);let{x:ze,y:Ve,z:Ne}=ce.projectTilePoint(Se.x,Se.y,pe.canonical);if(Ee){const[xt,jt,Mt]=Ee(Se);ze+=xt,Ve+=jt,Ne+=Mt}const Ye=ce.name==="globe",Xe=this.projectAndGetPerspectiveRatio(O,ze,Ve,Ne,pe,Ye||!!Y||this.transform.pitch>0,ce),{perspectiveRatio:st}=Xe,Ut=(Z?R/st:R*st)/s.ONE_EM,nt=Ai(ze,Ve,Ne,z),wt=Xe.signedDistanceFromCamera>0?qa(Ut,A,x.lineOffsetX*Ut,x.lineOffsetY*Ut,!1,nt,Se,x,S,z,{},Y&&!Z?Ee:null,Z&&!!Y,ce,pe,Z):null;let dt=!1,Bt=!1,ot=!0;if(wt&&!Xe.occluded){const xt=.5*he*st+ge,jt=new s.Point(-100,-100),Mt=new s.Point(this.screenRightBoundary,this.screenBottomBoundary),Gt=new Io,{first:In,last:Qn}=wt,gn=In.path.length;let Fn=[];for(let Sn=gn-1;Sn>=1;Sn--)Fn.push(In.path[Sn]);for(let Sn=1;Sn<Qn.path.length;Sn++)Fn.push(Qn.path[Sn]);const yi=2.5*xt;$&&(Fn=Fn.map(([Sn,Ui,Hi],Wi)=>(Ee&&!Ye&&(Hi=Ee(Wi<gn-1?In.tilePath[gn-1-Wi]:Qn.tilePath[Wi-gn+2])[2]),Ai(Sn,Ui,Hi,$))),Fn.some(Sn=>Sn[3]<=0)&&(Fn=[]));let gi=[];if(Fn.length>0){let Sn=1/0,Ui=-1/0,Hi=1/0,Wi=-1/0;for(const Ki of Fn)Sn=Math.min(Sn,Ki[0]),Hi=Math.min(Hi,Ki[1]),Ui=Math.max(Ui,Ki[0]),Wi=Math.max(Wi,Ki[1]);Ui>=jt.x&&Sn<=Mt.x&&Wi>=jt.y&&Hi<=Mt.y&&(gi=[Fn.map(Ki=>new s.Point(Ki[0],Ki[1]))],(Sn<jt.x||Ui>Mt.x||Hi<jt.y||Wi>Mt.y)&&(gi=s.clipLine(gi,jt.x,jt.y,Mt.x,Mt.y)))}for(const Sn of gi){Gt.reset(Sn,.25*xt);let Ui=0;Ui=Gt.length<=.5*xt?1:Math.ceil(Gt.paddedLength/yi)+1;for(let Hi=0;Hi<Ui;Hi++){const Wi=Hi/Math.max(Ui-1,1),Ki=Gt.lerp(Wi),Vo=Ki.x+Ro,Eo=Ki.y+Ro;_e.push(Vo,Eo,xt,0);const Ns=Vo-xt,Ma=Eo-xt,yr=Vo+xt,Xi=Eo+xt;if(ot=ot&&this.isOffscreen(Ns,Ma,yr,Xi),Bt=Bt||this.isInsideGrid(Ns,Ma,yr,Xi),!m&&this.grid.hitTestCircle(Vo,Eo,xt,re)&&(dt=!0,!j))return{circles:[],offscreen:!1,collisionDetected:dt,occluded:!1}}}}return{circles:!j&&dt||!Bt?[]:_e,offscreen:ot,collisionDetected:dt,occluded:Xe.occluded}}queryRenderedSymbols(h){if(h.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const m=[];let x=1/0,S=1/0,A=-1/0,R=-1/0;for(const j of h){const Z=new s.Point(j.x+Ro,j.y+Ro);x=Math.min(x,Z.x),S=Math.min(S,Z.y),A=Math.max(A,Z.x),R=Math.max(R,Z.y),m.push(Z)}const O=this.grid.query(x,S,A,R).concat(this.ignoredGrid.query(x,S,A,R)),z={},$={};for(const j of O){const Z=j.key;if(z[Z.bucketInstanceId]===void 0&&(z[Z.bucketInstanceId]={}),z[Z.bucketInstanceId][Z.featureIndex])continue;const re=[new s.Point(j.x1,j.y1),new s.Point(j.x2,j.y1),new s.Point(j.x2,j.y2),new s.Point(j.x1,j.y2)];s.polygonIntersectsPolygon(m,re)&&(z[Z.bucketInstanceId][Z.featureIndex]=!0,$[Z.bucketInstanceId]===void 0&&($[Z.bucketInstanceId]=[]),$[Z.bucketInstanceId].push(Z.featureIndex))}return $}insertCollisionBox(h,m,x,S,A){(m?this.ignoredGrid:this.grid).insert({bucketInstanceId:x,featureIndex:S,collisionGroupID:A},h[0],h[1],h[2],h[3])}insertCollisionCircles(h,m,x,S,A){const R=m?this.ignoredGrid:this.grid,O={bucketInstanceId:x,featureIndex:S,collisionGroupID:A};for(let z=0;z<h.length;z+=4)R.insertCircle(O,h[z],h[z+1],h[z+2])}projectAndGetPerspectiveRatio(h,m,x,S,A,R,O){const z=[m,x,S,1];let $=!1;S||this.transform.pitch>0?(s.transformMat4$1(z,z,h),this.fogState&&A&&O.name!=="globe"&&($=function(re,he,ge,pe,_e,Y){const ce=Y.calculateFogTileMatrix(_e),Ee=[he,ge,pe];return s.transformMat4(Ee,Ee,ce),et(re,Ee,Y.pitch,Y._fov)}(this.fogState,m,x,S,A.toUnwrapped(),this.transform)>.9)):ni(z,z,h);const j=z[3];return{point:new s.Point((z[0]/j+1)/2*this.transform.width+Ro,(-z[1]/j+1)/2*this.transform.height+Ro),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(O)/j*.5,1.5),signedDistanceFromCamera:j,occluded:R&&z[2]>j||$}}isOffscreen(h,m,x,S){return x<Ro||h>=this.screenRightBoundary||S<Ro||m>this.screenBottomBoundary}isInsideGrid(h,m,x,S){return x>=0&&h<this.gridRightBoundary&&S>=0&&m<this.gridBottomBoundary}getViewportMatrix(){const h=s.identity([]);return s.translate(h,h,[-100,-100,0]),h}}function se(_,h,m){const x=h.createTileMatrix(_,_.worldSize,m.toUnwrapped());return s.multiply(new Float32Array(16),_.projMatrix,x)}function ve(_,h,m){if(h.projection.name===m.projection.name)return _.projMatrix;const x=m.clone();return x.setProjection(h.projection),se(x,h.getProjection(),_)}function Re(_,h,m){return h.name===m.projection.name?_.projMatrix:se(m,h,_)}class gt{constructor(h,m,x,S){this.opacity=h?Math.max(0,Math.min(1,h.opacity+(h.placed?m:-m))):S&&x?1:0,this.placed=x}isHidden(){return this.opacity===0&&!this.placed}}class $t{constructor(h,m,x,S,A,R=!1){this.text=new gt(h?h.text:null,m,x,A),this.icon=new gt(h?h.icon:null,m,S,A),this.clipped=R}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class vn{constructor(h,m,x,S=!1){this.text=h,this.icon=m,this.skipFade=x,this.clipped=S}}class ui{constructor(){this.invProjMatrix=s.create(),this.viewportMatrix=s.create(),this.circles=[]}}class Oe{constructor(h,m,x,S,A){this.bucketInstanceId=h,this.featureIndex=m,this.sourceLayerIndex=x,this.bucketIndex=S,this.tileID=A}}class Ze{constructor(h){this.crossSourceCollisions=h,this.maxGroupID=0,this.collisionGroups={}}get(h){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[h]){const m=++this.maxGroupID;this.collisionGroups[h]={ID:m,predicate:x=>x.collisionGroupID===m}}return this.collisionGroups[h]}}function at(_,h,m,x,S){const{horizontalAlign:A,verticalAlign:R}=s.getAnchorAlignment(_),O=-(A-.5)*h,z=-(R-.5)*m,$=s.evaluateVariableOffset(_,x);return new s.Point(O+$[0]*S,z+$[1]*S)}function Ot(_,h,m,x,S){const A=new s.Point(_,h);return m&&A._rotate(x?S:-S),A}class mn{constructor(h,m,x,S,A){this.transform=h.clone(),this.projection=h.projection.name,this.collisionIndex=new Ya(this.transform,A),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=m,this.retainedQueryData={},this.collisionGroups=new Ze(x),this.collisionCircleArrays={},this.prevPlacement=S,S&&(S.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(h,m,x,S){const A=x.getBucket(m),R=x.latestFeatureIndex;if(!A||!R||m.id!==A.layerIds[0])return;const O=A.layers[0].layout,z=x.collisionBoxArray,$=Math.pow(2,this.transform.zoom-x.tileID.overscaledZ),j=x.tileSize/s.EXTENT,Z=x.tileID.toUnwrapped();this.transform.setProjection(A.projection);const re=(he=x.tileID,ge=A.getProjection(),pe=this.transform,ge.name===this.projection?pe.calculateProjMatrix(he.toUnwrapped()):se(pe,ge,he));var he,ge,pe;const _e=O.get("text-pitch-alignment")==="map",Y=O.get("text-rotation-alignment")==="map";m.compileFilter();const ce=m.dynamicFilter(),Ee=m.dynamicFilterNeedsFeature(),Se=this.transform.calculatePixelsToTileUnitsMatrix(x),ze=No(re,x.tileID.canonical,_e,Y,this.transform,A.getProjection(),Se);let Ve=null;if(_e){const Xe=sr(re,x.tileID.canonical,_e,Y,this.transform,A.getProjection(),Se);Ve=s.multiply([],this.transform.labelPlaneMatrix,Xe)}let Ne=null;ce&&x.latestFeatureIndex&&(Ne={unwrappedTileID:Z,dynamicFilter:ce,dynamicFilterNeedsFeature:Ee,featureIndex:x.latestFeatureIndex}),this.retainedQueryData[A.bucketInstanceId]=new Oe(A.bucketInstanceId,R,A.sourceLayerIndex,A.index,x.tileID);const Ye={bucket:A,layout:O,posMatrix:re,textLabelPlaneMatrix:ze,labelToScreenMatrix:Ve,clippingData:Ne,scale:$,textPixelRatio:j,holdingForFade:x.holdingForFade(),collisionBoxArray:z,partiallyEvaluatedTextSize:s.evaluateSizeForZoom(A.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:s.evaluateSizeForZoom(A.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(A.sourceID)};if(S)for(const Xe of A.sortKeyRanges){const{sortKey:st,symbolInstanceStart:Ut,symbolInstanceEnd:nt}=Xe;h.push({sortKey:st,symbolInstanceStart:Ut,symbolInstanceEnd:nt,parameters:Ye})}else h.push({symbolInstanceStart:0,symbolInstanceEnd:A.symbolInstances.length,parameters:Ye})}attemptAnchorPlacement(h,m,x,S,A,R,O,z,$,j,Z,re,he,ge,pe,_e,Y,ce){const{textOffset0:Ee,textOffset1:Se,crossTileID:ze}=re,Ve=[Ee,Se],Ne=at(h,x,S,Ve,A),Ye=this.collisionIndex.placeCollisionBox(ge,A,m,Ot(Ne.x,Ne.y,R,O,this.transform.angle),Z,z,$,j.predicate);if(_e){const Xe=ge.getSymbolInstanceIconSize(ce,this.transform.zoom,re.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ge,Xe,_e,Ot(Ne.x,Ne.y,R,O,this.transform.angle),Z,z,$,j.predicate).box.length===0)return}if(Ye.box.length>0){let Xe;return this.prevPlacement&&this.prevPlacement.variableOffsets[ze]&&this.prevPlacement.placements[ze]&&this.prevPlacement.placements[ze].text&&(Xe=this.prevPlacement.variableOffsets[ze].anchor),this.variableOffsets[ze]={textOffset:Ve,width:x,height:S,anchor:h,textScale:A,prevAnchor:Xe},this.markUsedJustification(ge,h,re,pe),ge.allowVerticalPlacement&&(this.markUsedOrientation(ge,pe,re),this.placedOrientations[ze]=pe),{shift:Ne,placedGlyphBoxes:Ye}}}placeLayerBucketPart(h,m,x,S){const{bucket:A,layout:R,posMatrix:O,textLabelPlaneMatrix:z,labelToScreenMatrix:$,clippingData:j,textPixelRatio:Z,holdingForFade:re,collisionBoxArray:he,partiallyEvaluatedTextSize:ge,partiallyEvaluatedIconSize:pe,collisionGroup:_e}=h.parameters,Y=R.get("text-optional"),ce=R.get("icon-optional"),Ee=R.get("text-allow-overlap"),Se=R.get("icon-allow-overlap"),ze=R.get("text-rotation-alignment")==="map",Ve=R.get("text-pitch-alignment")==="map",Ne=R.get("icon-text-fit")!=="none",Ye=R.get("symbol-z-order")==="viewport-y";this.transform.setProjection(A.projection);let Xe=Ee&&(Se||!A.hasIconData()||ce),st=Se&&(Ee||!A.hasTextData()||Y);!A.collisionArrays&&he&&A.deserializeCollisionBoxes(he),x&&S&&A.updateCollisionDebugBuffers(this.transform.zoom,he);const Ut=(nt,wt,dt)=>{const{crossTileID:Bt,numVerticalGlyphVertices:ot}=nt;if(j){const yr={zoom:this.transform.zoom,pitch:this.transform.pitch};let Xi=null;if(j.dynamicFilterNeedsFeature){const Oi=this.retainedQueryData[A.bucketInstanceId];Xi=j.featureIndex.loadFeature({featureIndex:nt.featureIndex,bucketIndex:Oi.bucketIndex,sourceLayerIndex:Oi.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,j.dynamicFilter)(yr,Xi,this.retainedQueryData[A.bucketInstanceId].tileID.canonical,new s.Point(nt.tileAnchorX,nt.tileAnchorY),this.transform.calculateDistanceTileData(j.unwrappedTileID)))return this.placements[Bt]=new vn(!1,!1,!1,!0),void m.add(Bt)}if(m.has(Bt))return;if(re)return void(this.placements[Bt]=new vn(!1,!1,!1));let xt=!1,jt=!1,Mt=!0,Gt=!1,In=!1,Qn=null,gn={box:null,offscreen:null,occluded:null},Fn={box:null,offscreen:null,occluded:null},yi=null,gi=null,Sn=null,Ui=0,Hi=0,Wi=0;dt.textFeatureIndex?Ui=dt.textFeatureIndex:nt.useRuntimeCollisionCircles&&(Ui=nt.featureIndex),dt.verticalTextFeatureIndex&&(Hi=dt.verticalTextFeatureIndex);const Ki=yr=>{yr.tileID=this.retainedQueryData[A.bucketInstanceId].tileID;const Xi=this.transform.elevation;(Xi||yr.elevation)&&(yr.elevation=Xi?Xi.getAtTileOffset(yr.tileID,yr.tileAnchorX,yr.tileAnchorY):0)},Vo=dt.textBox;if(Vo){Ki(Vo);const yr=Oi=>{let Xr=s.WritingMode.horizontal;if(A.allowVerticalPlacement&&!Oi&&this.prevPlacement){const Yo=this.prevPlacement.placedOrientations[Bt];Yo&&(this.placedOrientations[Bt]=Yo,Xr=Yo,this.markUsedOrientation(A,Xr,nt))}return Xr},Xi=(Oi,Xr)=>{if(A.allowVerticalPlacement&&ot>0&&dt.verticalTextBox){for(const Yo of A.writingModes)if(Yo===s.WritingMode.vertical?(gn=Xr(),Fn=gn):gn=Oi(),gn&&gn.box&&gn.box.length)break}else gn=Oi()};if(R.get("text-variable-anchor")){let Oi=R.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Bt]){const dr=this.prevPlacement.variableOffsets[Bt];Oi.indexOf(dr.anchor)>0&&(Oi=Oi.filter(is=>is!==dr.anchor),Oi.unshift(dr.anchor))}const Xr=(dr,is,ep)=>{const Sc=A.getSymbolInstanceTextSize(ge,nt,this.transform.zoom,wt),cd=(dr.x2-dr.x1)*Sc+2*dr.padding,il=(dr.y2-dr.y1)*Sc+2*dr.padding,Fl=Ne&&!Se?is:null;Fl&&Ki(Fl);let Cc={box:[],offscreen:!1,occluded:!1};const tp=Ee?2*Oi.length:Oi.length;for(let ud=0;ud<tp;++ud){const Gg=this.attemptAnchorPlacement(Oi[ud%Oi.length],dr,cd,il,Sc,ze,Ve,Z,O,_e,ud>=Oi.length,nt,wt,A,ep,Fl,ge,pe);if(Gg&&(Cc=Gg.placedGlyphBoxes,Cc&&Cc.box&&Cc.box.length)){xt=!0,Qn=Gg.shift;break}}return Cc};Xi(()=>Xr(Vo,dt.iconBox,s.WritingMode.horizontal),()=>{const dr=dt.verticalTextBox;return dr&&Ki(dr),A.allowVerticalPlacement&&!(gn&&gn.box&&gn.box.length)&&ot>0&&dr?Xr(dr,dt.verticalIconBox,s.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),gn&&(xt=gn.box,Mt=gn.offscreen,Gt=gn.occluded);const Yo=yr(!(!gn||!gn.box));if(!xt&&this.prevPlacement){const dr=this.prevPlacement.variableOffsets[Bt];dr&&(this.variableOffsets[Bt]=dr,this.markUsedJustification(A,dr.anchor,nt,Yo))}}else{const Oi=(Xr,Yo)=>{const dr=A.getSymbolInstanceTextSize(ge,nt,this.transform.zoom,wt),is=this.collisionIndex.placeCollisionBox(A,dr,Xr,new s.Point(0,0),Ee,Z,O,_e.predicate);return is&&is.box&&is.box.length&&(this.markUsedOrientation(A,Yo,nt),this.placedOrientations[Bt]=Yo),is};Xi(()=>Oi(Vo,s.WritingMode.horizontal),()=>{const Xr=dt.verticalTextBox;return A.allowVerticalPlacement&&ot>0&&Xr?(Ki(Xr),Oi(Xr,s.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),yr(!!(gn&&gn.box&&gn.box.length))}}if(yi=gn,xt=yi&&yi.box&&yi.box.length>0,Mt=yi&&yi.offscreen,Gt=yi&&yi.occluded,nt.useRuntimeCollisionCircles){const yr=A.text.placedSymbolArray.get(nt.centerJustifiedTextSymbolIndex>=0?nt.centerJustifiedTextSymbolIndex:nt.verticalPlacedTextSymbolIndex),Xi=s.evaluateSizeForFeature(A.textSizeData,ge,yr),Oi=R.get("text-padding");gi=this.collisionIndex.placeCollisionCircles(A,Ee,yr,A.lineVertexArray,A.glyphOffsetArray,Xi,O,z,$,x,Ve,_e.predicate,nt.collisionCircleDiameter*Xi/s.ONE_EM,Oi,this.retainedQueryData[A.bucketInstanceId].tileID),xt=Ee||gi.circles.length>0&&!gi.collisionDetected,Mt=Mt&&gi.offscreen,Gt=gi.occluded}if(dt.iconFeatureIndex&&(Wi=dt.iconFeatureIndex),dt.iconBox){const yr=Xi=>{Ki(Xi);const Oi=Ne&&Qn?Ot(Qn.x,Qn.y,ze,Ve,this.transform.angle):new s.Point(0,0),Xr=A.getSymbolInstanceIconSize(pe,this.transform.zoom,nt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(A,Xr,Xi,Oi,Se,Z,O,_e.predicate)};Fn&&Fn.box&&Fn.box.length&&dt.verticalIconBox?(Sn=yr(dt.verticalIconBox),jt=Sn.box.length>0):(Sn=yr(dt.iconBox),jt=Sn.box.length>0),Mt=Mt&&Sn.offscreen,In=Sn.occluded}const Eo=Y||nt.numHorizontalGlyphVertices===0&&ot===0,Ns=ce||nt.numIconVertices===0;if(Eo||Ns?Ns?Eo||(jt=jt&&xt):xt=jt&&xt:jt=xt=jt&&xt,xt&&yi&&yi.box&&this.collisionIndex.insertCollisionBox(yi.box,R.get("text-ignore-placement"),A.bucketInstanceId,Fn&&Fn.box&&Hi?Hi:Ui,_e.ID),jt&&Sn&&this.collisionIndex.insertCollisionBox(Sn.box,R.get("icon-ignore-placement"),A.bucketInstanceId,Wi,_e.ID),gi&&(xt&&this.collisionIndex.insertCollisionCircles(gi.circles,R.get("text-ignore-placement"),A.bucketInstanceId,Ui,_e.ID),x)){const yr=A.bucketInstanceId;let Xi=this.collisionCircleArrays[yr];Xi===void 0&&(Xi=this.collisionCircleArrays[yr]=new ui);for(let Oi=0;Oi<gi.circles.length;Oi+=4)Xi.circles.push(gi.circles[Oi+0]),Xi.circles.push(gi.circles[Oi+1]),Xi.circles.push(gi.circles[Oi+2]),Xi.circles.push(gi.collisionDetected?1:0)}const Ma=A.projection.name!=="globe";Xe=Xe&&(Ma||!Gt),st=st&&(Ma||!In),this.placements[Bt]=new vn(xt||Xe,jt||st,Mt||A.justReloaded),m.add(Bt)};if(Ye){const nt=A.getSortedSymbolIndexes(this.transform.angle);for(let wt=nt.length-1;wt>=0;--wt){const dt=nt[wt];Ut(A.symbolInstances.get(dt),dt,A.collisionArrays[dt])}}else for(let nt=h.symbolInstanceStart;nt<h.symbolInstanceEnd;nt++)Ut(A.symbolInstances.get(nt),nt,A.collisionArrays[nt]);if(x&&A.bucketInstanceId in this.collisionCircleArrays){const nt=this.collisionCircleArrays[A.bucketInstanceId];s.invert(nt.invProjMatrix,O),nt.viewportMatrix=this.collisionIndex.getViewportMatrix()}A.justReloaded=!1}markUsedJustification(h,m,x,S){const{leftJustifiedTextSymbolIndex:A,centerJustifiedTextSymbolIndex:R,rightJustifiedTextSymbolIndex:O,verticalPlacedTextSymbolIndex:z,crossTileID:$}=x,j=s.getAnchorJustification(m),Z=S===s.WritingMode.vertical?z:j==="left"?A:j==="center"?R:j==="right"?O:-1;A>=0&&(h.text.placedSymbolArray.get(A).crossTileID=Z>=0&&A!==Z?0:$),R>=0&&(h.text.placedSymbolArray.get(R).crossTileID=Z>=0&&R!==Z?0:$),O>=0&&(h.text.placedSymbolArray.get(O).crossTileID=Z>=0&&O!==Z?0:$),z>=0&&(h.text.placedSymbolArray.get(z).crossTileID=Z>=0&&z!==Z?0:$)}markUsedOrientation(h,m,x){const S=m===s.WritingMode.horizontal||m===s.WritingMode.horizontalOnly?m:0,A=m===s.WritingMode.vertical?m:0,{leftJustifiedTextSymbolIndex:R,centerJustifiedTextSymbolIndex:O,rightJustifiedTextSymbolIndex:z,verticalPlacedTextSymbolIndex:$}=x,j=h.text.placedSymbolArray;R>=0&&(j.get(R).placedOrientation=S),O>=0&&(j.get(O).placedOrientation=S),z>=0&&(j.get(z).placedOrientation=S),$>=0&&(j.get($).placedOrientation=A)}commit(h){this.commitTime=h,this.zoomAtLastRecencyCheck=this.transform.zoom;const m=this.prevPlacement;let x=!1;this.prevZoomAdjustment=m?m.zoomAdjustment(this.transform.zoom):0;const S=m?m.symbolFadeChange(h):1,A=m?m.opacities:{},R=m?m.variableOffsets:{},O=m?m.placedOrientations:{};for(const z in this.placements){const $=this.placements[z],j=A[z];j?(this.opacities[z]=new $t(j,S,$.text,$.icon,null,$.clipped),x=x||$.text!==j.text.placed||$.icon!==j.icon.placed):(this.opacities[z]=new $t(null,S,$.text,$.icon,$.skipFade,$.clipped),x=x||$.text||$.icon)}for(const z in A){const $=A[z];if(!this.opacities[z]){const j=new $t($,S,!1,!1);j.isHidden()||(this.opacities[z]=j,x=x||$.text.placed||$.icon.placed)}}for(const z in R)this.variableOffsets[z]||!this.opacities[z]||this.opacities[z].isHidden()||(this.variableOffsets[z]=R[z]);for(const z in O)this.placedOrientations[z]||!this.opacities[z]||this.opacities[z].isHidden()||(this.placedOrientations[z]=O[z]);x?this.lastPlacementChangeTime=h:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=m?m.lastPlacementChangeTime:h)}updateLayerOpacities(h,m){const x=new Set;for(const S of m){const A=S.getBucket(h);A&&S.latestFeatureIndex&&h.id===A.layerIds[0]&&this.updateBucketOpacities(A,x,S.collisionBoxArray)}}updateBucketOpacities(h,m,x){h.hasTextData()&&h.text.opacityVertexArray.clear(),h.hasIconData()&&h.icon.opacityVertexArray.clear(),h.hasIconCollisionBoxData()&&h.iconCollisionBox.collisionVertexArray.clear(),h.hasTextCollisionBoxData()&&h.textCollisionBox.collisionVertexArray.clear();const S=h.layers[0].layout,A=!!h.layers[0].dynamicFilter(),R=new $t(null,0,!1,!1,!0),O=S.get("text-allow-overlap"),z=S.get("icon-allow-overlap"),$=S.get("text-variable-anchor"),j=S.get("text-rotation-alignment")==="map",Z=S.get("text-pitch-alignment")==="map",re=S.get("icon-text-fit")!=="none",he=new $t(null,0,O&&(z||!h.hasIconData()||S.get("icon-optional")),z&&(O||!h.hasTextData()||S.get("text-optional")),!0);!h.collisionArrays&&x&&(h.hasIconCollisionBoxData()||h.hasTextCollisionBoxData())&&h.deserializeCollisionBoxes(x);const ge=(_e,Y,ce)=>{for(let Ee=0;Ee<Y/4;Ee++)_e.opacityVertexArray.emplaceBack(ce)};let pe=0;for(let _e=0;_e<h.symbolInstances.length;_e++){const Y=h.symbolInstances.get(_e),{numHorizontalGlyphVertices:ce,numVerticalGlyphVertices:Ee,crossTileID:Se,numIconVertices:ze}=Y,Ve=m.has(Se);let Ne=this.opacities[Se];Ve?Ne=R:Ne||(Ne=he,this.opacities[Se]=Ne),m.add(Se);const Ye=ce>0||Ee>0,Xe=ze>0,st=this.placedOrientations[Se],Ut=st===s.WritingMode.vertical,nt=st===s.WritingMode.horizontal||st===s.WritingMode.horizontalOnly;if(!Ye&&!Xe||Ne.isHidden()||pe++,Ye){const wt=Ar(Ne.text);ge(h.text,ce,Ut?Ei:wt),ge(h.text,Ee,nt?Ei:wt);const dt=Ne.text.isHidden(),{leftJustifiedTextSymbolIndex:Bt,centerJustifiedTextSymbolIndex:ot,rightJustifiedTextSymbolIndex:xt,verticalPlacedTextSymbolIndex:jt}=Y,Mt=h.text.placedSymbolArray,Gt=dt||Ut?1:0;Bt>=0&&(Mt.get(Bt).hidden=Gt),ot>=0&&(Mt.get(ot).hidden=Gt),xt>=0&&(Mt.get(xt).hidden=Gt),jt>=0&&(Mt.get(jt).hidden=dt||nt?1:0);const In=this.variableOffsets[Se];In&&this.markUsedJustification(h,In.anchor,Y,st);const Qn=this.placedOrientations[Se];Qn&&(this.markUsedJustification(h,"left",Y,Qn),this.markUsedOrientation(h,Qn,Y))}if(Xe){const wt=Ar(Ne.icon),{placedIconSymbolIndex:dt,verticalPlacedIconSymbolIndex:Bt}=Y,ot=h.icon.placedSymbolArray,xt=Ne.icon.isHidden()?1:0;dt>=0&&(ge(h.icon,ze,Ut?Ei:wt),ot.get(dt).hidden=xt),Bt>=0&&(ge(h.icon,Y.numVerticalIconVertices,nt?Ei:wt),ot.get(Bt).hidden=xt)}if(h.hasIconCollisionBoxData()||h.hasTextCollisionBoxData()){const wt=h.collisionArrays[_e];if(wt){let dt=new s.Point(0,0),Bt=!0;if(wt.textBox||wt.verticalTextBox){if($){const xt=this.variableOffsets[Se];xt?(dt=at(xt.anchor,xt.width,xt.height,xt.textOffset,xt.textScale),j&&dt._rotate(Z?this.transform.angle:-this.transform.angle)):Bt=!1}A&&(Bt=!Ne.clipped),wt.textBox&&un(h.textCollisionBox.collisionVertexArray,Ne.text.placed,!Bt||Ut,dt.x,dt.y),wt.verticalTextBox&&un(h.textCollisionBox.collisionVertexArray,Ne.text.placed,!Bt||nt,dt.x,dt.y)}const ot=Bt&&!!(!nt&&wt.verticalIconBox);wt.iconBox&&un(h.iconCollisionBox.collisionVertexArray,Ne.icon.placed,ot,re?dt.x:0,re?dt.y:0),wt.verticalIconBox&&un(h.iconCollisionBox.collisionVertexArray,Ne.icon.placed,!ot,re?dt.x:0,re?dt.y:0)}}}if(h.fullyClipped=pe===0,h.sortFeatures(this.transform.angle),this.retainedQueryData[h.bucketInstanceId]&&(this.retainedQueryData[h.bucketInstanceId].featureSortOrder=h.featureSortOrder),h.hasTextData()&&h.text.opacityVertexBuffer&&h.text.opacityVertexBuffer.updateData(h.text.opacityVertexArray),h.hasIconData()&&h.icon.opacityVertexBuffer&&h.icon.opacityVertexBuffer.updateData(h.icon.opacityVertexArray),h.hasIconCollisionBoxData()&&h.iconCollisionBox.collisionVertexBuffer&&h.iconCollisionBox.collisionVertexBuffer.updateData(h.iconCollisionBox.collisionVertexArray),h.hasTextCollisionBoxData()&&h.textCollisionBox.collisionVertexBuffer&&h.textCollisionBox.collisionVertexBuffer.updateData(h.textCollisionBox.collisionVertexArray),h.bucketInstanceId in this.collisionCircleArrays){const _e=this.collisionCircleArrays[h.bucketInstanceId];h.placementInvProjMatrix=_e.invProjMatrix,h.placementViewportMatrix=_e.viewportMatrix,h.collisionCircleArray=_e.circles,delete this.collisionCircleArrays[h.bucketInstanceId]}}symbolFadeChange(h){return this.fadeDuration===0?1:(h-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(h){return Math.max(0,(this.transform.zoom-h)/1.5)}hasTransitions(h){return this.stale||h-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(h,m){const x=this.zoomAtLastRecencyCheck===m?1-this.zoomAdjustment(m):1;return this.zoomAtLastRecencyCheck=m,this.commitTime+this.fadeDuration*x>h}setStale(){this.stale=!0}}function un(_,h,m,x,S){_.emplaceBack(h?1:0,m?1:0,x||0,S||0),_.emplaceBack(h?1:0,m?1:0,x||0,S||0),_.emplaceBack(h?1:0,m?1:0,x||0,S||0),_.emplaceBack(h?1:0,m?1:0,x||0,S||0)}const jn=Math.pow(2,25),on=Math.pow(2,24),Er=Math.pow(2,17),mr=Math.pow(2,16),xi=Math.pow(2,9),Si=Math.pow(2,8),ji=Math.pow(2,1);function Ar(_){if(_.opacity===0&&!_.placed)return 0;if(_.opacity===1&&_.placed)return 4294967295;const h=_.placed?1:0,m=Math.floor(127*_.opacity);return m*jn+h*on+m*Er+h*mr+m*xi+h*Si+m*ji+h}const Ei=0;class gr{constructor(h){this._sortAcrossTiles=h.layout.get("symbol-z-order")!=="viewport-y"&&h.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(h,m,x,S,A){const R=this._bucketParts;for(;this._currentTileIndex<h.length;)if(m.getBucketParts(R,S,h[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,A())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,R.sort((O,z)=>O.sortKey-z.sortKey));this._currentPartIndex<R.length;){const O=R[this._currentPartIndex];if(m.placeLayerBucketPart(O,this._seenCrossTileIDs,x,O.symbolInstanceStart===0),this._currentPartIndex++,A())return!0}return!1}}class vu{constructor(h,m,x,S,A,R,O,z){this.placement=new mn(h,A,R,O,z),this._currentPlacementIndex=m.length-1,this._forceFullPlacement=x,this._showCollisionBoxes=S,this._done=!1}isDone(){return this._done}continuePlacement(h,m,x){const S=s.exported.now(),A=()=>{const R=s.exported.now()-S;return!this._forceFullPlacement&&R>2};for(;this._currentPlacementIndex>=0;){const R=m[h[this._currentPlacementIndex]],O=this.placement.collisionIndex.transform.zoom;if(R.type==="symbol"&&(!R.minzoom||R.minzoom<=O)&&(!R.maxzoom||R.maxzoom>O)){if(this._inProgressLayer||(this._inProgressLayer=new gr(R)),this._inProgressLayer.continuePlacement(x[R.source],this.placement,this._showCollisionBoxes,R,A))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(h){return this.placement.commit(h),this.placement}}const oa=512/s.EXTENT/2;class ro{constructor(h,m,x){this.tileID=h,this.bucketInstanceId=x,this.index=new s.KDBush(m.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const S=h.canonical.x*s.EXTENT,A=h.canonical.y*s.EXTENT;for(let R=0;R<m.length;R++){const{key:O,crossTileID:z,tileAnchorX:$,tileAnchorY:j}=m.get(R),Z=Math.floor((S+$)*oa),re=Math.floor((A+j)*oa);this.index.add(Z,re),this.keys.push(O),this.crossTileIDs.push(z)}this.index.finish()}findMatches(h,m,x){const S=this.tileID.canonical.z<m.canonical.z?1:Math.pow(2,this.tileID.canonical.z-m.canonical.z),A=oa/Math.pow(2,m.canonical.z-this.tileID.canonical.z),R=m.canonical.x*s.EXTENT,O=m.canonical.y*s.EXTENT;for(let z=0;z<h.length;z++){const $=h.get(z);if($.crossTileID)continue;const{key:j,tileAnchorX:Z,tileAnchorY:re}=$,he=Math.floor((R+Z)*A),ge=Math.floor((O+re)*A),pe=this.index.range(he-S,ge-S,he+S,ge+S);for(const _e of pe){const Y=this.crossTileIDs[_e];if(this.keys[_e]===j&&!x.has(Y)){x.add(Y),$.crossTileID=Y;break}}}}}class _u{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class bu{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(h){const m=Math.round((h-this.lng)/360);if(m!==0)for(const x in this.indexes){const S=this.indexes[x],A={};for(const R in S){const O=S[R];O.tileID=O.tileID.unwrapTo(O.tileID.wrap+m),A[O.tileID.key]=O}this.indexes[x]=A}this.lng=h}addBucket(h,m,x){if(this.indexes[h.overscaledZ]&&this.indexes[h.overscaledZ][h.key]){if(this.indexes[h.overscaledZ][h.key].bucketInstanceId===m.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(h.overscaledZ,this.indexes[h.overscaledZ][h.key])}for(let A=0;A<m.symbolInstances.length;A++)m.symbolInstances.get(A).crossTileID=0;this.usedCrossTileIDs[h.overscaledZ]||(this.usedCrossTileIDs[h.overscaledZ]=new Set);const S=this.usedCrossTileIDs[h.overscaledZ];for(const A in this.indexes){const R=this.indexes[A];if(Number(A)>h.overscaledZ)for(const O in R){const z=R[O];z.tileID.isChildOf(h)&&z.findMatches(m.symbolInstances,h,S)}else{const O=R[h.scaledTo(Number(A)).key];O&&O.findMatches(m.symbolInstances,h,S)}}for(let A=0;A<m.symbolInstances.length;A++){const R=m.symbolInstances.get(A);R.crossTileID||(R.crossTileID=x.generate(),S.add(R.crossTileID))}return this.indexes[h.overscaledZ]===void 0&&(this.indexes[h.overscaledZ]={}),this.indexes[h.overscaledZ][h.key]=new ro(h,m.symbolInstances,m.bucketInstanceId),!0}removeBucketCrossTileIDs(h,m){for(const x of m.crossTileIDs)this.usedCrossTileIDs[h].delete(x)}removeStaleBuckets(h){let m=!1;for(const x in this.indexes){const S=this.indexes[x];for(const A in S)h[S[A].bucketInstanceId]||(this.removeBucketCrossTileIDs(x,S[A]),delete S[A],m=!0)}return m}}class Ss{constructor(){this.layerIndexes={},this.crossTileIDs=new _u,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(h,m,x,S){let A=this.layerIndexes[h.id];A===void 0&&(A=this.layerIndexes[h.id]=new bu);let R=!1;const O={};S.name!=="globe"&&A.handleWrapJump(x);for(const z of m){const $=z.getBucket(h);$&&h.id===$.layerIds[0]&&($.bucketInstanceId||($.bucketInstanceId=++this.maxBucketInstanceId),A.addBucket(z.tileID,$,this.crossTileIDs)&&(R=!0),O[$.bucketInstanceId]=!0)}return A.removeStaleBuckets(O)&&(R=!0),R}pruneUnusedLayers(h){const m={};h.forEach(x=>{m[x]=!0});for(const x in this.layerIndexes)m[x]||delete this.layerIndexes[x]}}const qo=(_,h)=>s.emitValidationErrors(_,h&&h.filter(m=>m.identifier!=="source.canvas")),vc=s.pick(vi,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),hE=s.pick(vi,["setCenter","setZoom","setBearing","setPitch"]),sg={version:8,layers:[],sources:{}},xu={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Aa extends s.Evented{constructor(h,m={}){super(),this.map=h,this.dispatcher=new cn(Bo(),this),this.imageManager=new me,this.imageManager.setEventedParent(this),this.glyphManager=new s.GlyphManager(h._requestManager,m.localFontFamily?s.LocalGlyphMode.all:m.localIdeographFontFamily?s.LocalGlyphMode.ideographs:s.LocalGlyphMode.none,m.localFontFamily||m.localIdeographFontFamily),this.crossTileSymbolIndex=new Ss,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",s.getReferrer());const x=this;this._rtlTextPluginCallback=Aa.registerForPluginStateChange(S=>{x.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:S.pluginStatus,pluginURL:S.pluginURL},(A,R)=>{if(s.triggerPluginCompletionEvent(A),R&&R.every(O=>O))for(const O in x._sourceCaches){const z=x._sourceCaches[O],$=z.getSource().type;$!=="vector"&&$!=="geojson"||z.reload()}})}),this.on("data",S=>{if(S.dataType!=="source"||S.sourceDataType!=="metadata")return;const A=this.getSource(S.sourceId);if(A&&A.vectorLayerIds)for(const R in this._layers){const O=this._layers[R];O.source===A.id&&this._validateLayer(O)}})}loadURL(h,m={}){this.fire(new s.Event("dataloading",{dataType:"style"}));const x=typeof m.validate=="boolean"?m.validate:!s.isMapboxURL(h);h=this.map._requestManager.normalizeStyleURL(h,m.accessToken);const S=this.map._requestManager.transformRequest(h,s.ResourceType.Style);this._request=s.getJSON(S,(A,R)=>{this._request=null,A?this.fire(new s.ErrorEvent(A)):R&&this._load(R,x)})}loadJSON(h,m={}){this.fire(new s.Event("dataloading",{dataType:"style"})),this._request=s.exported.frame(()=>{this._request=null,this._load(h,m.validate!==!1)})}loadEmpty(){this.fire(new s.Event("dataloading",{dataType:"style"})),this._load(sg,!1)}_updateLayerCount(h,m){const x=m?1:-1;h.is3D()&&(this._num3DLayers+=x),h.type==="circle"&&(this._numCircleLayers+=x),h.type==="symbol"&&(this._numSymbolLayers+=x)}_load(h,m){if(m&&qo(this,s.validateStyle(h)))return;this._loaded=!0,this.stylesheet=s.clone$1(h),this._updateMapProjection();for(const S in h.sources)this.addSource(S,h.sources[S],{validate:!1});this._changed=!1,h.sprite?this._loadSprite(h.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(h.glyphs);const x=Fs(this.stylesheet.layers);this._order=x.map(S=>S.id),this._layers={},this._serializedLayers={};for(const S of x){const A=s.createStyleLayer(S);A.setEventedParent(this,{layer:{id:A.id}}),this._layers[A.id]=A,this._serializedLayers[A.id]=A.serialize(),this._updateLayerCount(A,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Te(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new s.Event("data",{dataType:"style"})),this.fire(new s.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(h){h?this.stylesheet.projection=h:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(h){this._spriteRequest=function(m,x,S){let A,R,O;const z=s.exported.devicePixelRatio>1?"@2x":"";let $=s.getJSON(x.transformRequest(x.normalizeSpriteURL(m,z,".json"),s.ResourceType.SpriteJSON),(re,he)=>{$=null,O||(O=re,A=he,Z())}),j=s.getImage(x.transformRequest(x.normalizeSpriteURL(m,z,".png"),s.ResourceType.SpriteImage),(re,he)=>{j=null,O||(O=re,R=he,Z())});function Z(){if(O)S(O);else if(A&&R){const re=s.exported.getImageData(R),he={};for(const ge in A){const{width:pe,height:_e,x:Y,y:ce,sdf:Ee,pixelRatio:Se,stretchX:ze,stretchY:Ve,content:Ne}=A[ge],Ye=new s.RGBAImage({width:pe,height:_e});s.RGBAImage.copy(re,Ye,{x:Y,y:ce},{x:0,y:0},{width:pe,height:_e}),he[ge]={data:Ye,pixelRatio:Se,sdf:Ee,stretchX:ze,stretchY:Ve,content:Ne}}S(null,he)}}return{cancel(){$&&($.cancel(),$=null),j&&(j.cancel(),j=null)}}}(h,this.map._requestManager,(m,x)=>{if(this._spriteRequest=null,m)this.fire(new s.ErrorEvent(m));else if(x)for(const S in x)this.imageManager.addImage(S,x[S]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new s.Event("data",{dataType:"style"}))})}_validateLayer(h){const m=this.getSource(h.source);if(!m)return;const x=h.sourceLayer;x&&(m.type==="geojson"||m.vectorLayerIds&&m.vectorLayerIds.indexOf(x)===-1)&&this.fire(new s.ErrorEvent(new Error(`Source layer "${x}" does not exist on source "${m.id}" as specified by style layer "${h.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const h in this._sourceCaches)if(!this._sourceCaches[h].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(h){const m=[];for(const x of h){const S=this._layers[x];S.type!=="custom"&&m.push(S.serialize())}return m}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const h in this._sourceCaches)if(this._sourceCaches[h].hasTransition())return!0;for(const h in this._layers)if(this._layers[h].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(h){return!!this.terrain&&(typeof h.isLayerDraped=="function"?h.isLayerDraped():xu[h.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(h){if(!this._loaded)return;const m=this._changed;if(this._changed){const S=Object.keys(this._updatedLayers),A=Object.keys(this._removedLayers);(S.length||A.length)&&this._updateWorkerLayers(S,A);for(const R in this._updatedSources){const O=this._updatedSources[R];O==="reload"?this._reloadSource(R):O==="clear"&&this._clearSource(R)}this._updateTilesForChangedImages();for(const R in this._updatedPaintProps)this._layers[R].updateTransitions(h);this.light.updateTransitions(h),this.fog&&this.fog.updateTransitions(h),this._resetUpdates()}const x={};for(const S in this._sourceCaches){const A=this._sourceCaches[S];x[S]=A.used,A.used=!1}for(const S of this._order){const A=this._layers[S];if(A.recalculate(h,this._availableImages),!A.isHidden(h.zoom)){const O=this._getLayerSourceCache(A);O&&(O.used=!0)}const R=this.map.painter;if(R){const O=A.getProgramIds();if(!O)continue;const z=A.getProgramConfiguration(h.zoom);for(const $ of O)R.useProgram($,z)}}for(const S in x){const A=this._sourceCaches[S];x[S]!==A.used&&A.getSource().fire(new s.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:A.getSource().id}))}this.light.recalculate(h),this.terrain&&this.terrain.recalculate(h),this.fog&&this.fog.recalculate(h),this.z=h.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),m&&this.fire(new s.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const h=Object.keys(this._changedImages);if(h.length){for(const m in this._sourceCaches)this._sourceCaches[m].reloadTilesForDependencies(["icons","patterns"],h);this._changedImages={}}}_updateWorkerLayers(h,m){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(h),removedIds:m})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(h){if(this._checkLoaded(),qo(this,s.validateStyle(h)))return!1;(h=s.clone$1(h)).layers=Fs(h.layers);const m=function(S,A){if(!S)return[{command:vi.setStyle,args:[A]}];let R=[];try{if(!d(S.version,A.version))return[{command:vi.setStyle,args:[A]}];d(S.center,A.center)||R.push({command:vi.setCenter,args:[A.center]}),d(S.zoom,A.zoom)||R.push({command:vi.setZoom,args:[A.zoom]}),d(S.bearing,A.bearing)||R.push({command:vi.setBearing,args:[A.bearing]}),d(S.pitch,A.pitch)||R.push({command:vi.setPitch,args:[A.pitch]}),d(S.sprite,A.sprite)||R.push({command:vi.setSprite,args:[A.sprite]}),d(S.glyphs,A.glyphs)||R.push({command:vi.setGlyphs,args:[A.glyphs]}),d(S.transition,A.transition)||R.push({command:vi.setTransition,args:[A.transition]}),d(S.light,A.light)||R.push({command:vi.setLight,args:[A.light]}),d(S.fog,A.fog)||R.push({command:vi.setFog,args:[A.fog]}),d(S.projection,A.projection)||R.push({command:vi.setProjection,args:[A.projection]});const O={},z=[];(function(Z,re,he,ge){let pe;for(pe in re=re||{},Z=Z||{})Z.hasOwnProperty(pe)&&(re.hasOwnProperty(pe)||Za(pe,he,ge));for(pe in re){if(!re.hasOwnProperty(pe))continue;const _e=re[pe];Z.hasOwnProperty(pe)?d(Z[pe],_e)||(Z[pe].type==="geojson"&&_e.type==="geojson"&&ia(Z,re,pe)?he.push({command:vi.setGeoJSONSourceData,args:[pe,_e.data]}):Dl(pe,re,he,ge)):Xo(pe,re,he)}})(S.sources,A.sources,z,O);const $=[];S.layers&&S.layers.forEach(Z=>{Z.source&&O[Z.source]?R.push({command:vi.removeLayer,args:[Z.id]}):$.push(Z)});let j=S.terrain;j&&O[j.source]&&(R.push({command:vi.setTerrain,args:[void 0]}),j=void 0),R=R.concat(z),d(j,A.terrain)||R.push({command:vi.setTerrain,args:[A.terrain]}),function(Z,re,he){re=re||[];const ge=(Z=Z||[]).map(bo),pe=re.map(bo),_e=Z.reduce(zo,{}),Y=re.reduce(zo,{}),ce=ge.slice(),Ee=Object.create(null);let Se,ze,Ve,Ne,Ye,Xe,st;for(Se=0,ze=0;Se<ge.length;Se++)Ve=ge[Se],Y.hasOwnProperty(Ve)?ze++:(he.push({command:vi.removeLayer,args:[Ve]}),ce.splice(ce.indexOf(Ve,ze),1));for(Se=0,ze=0;Se<pe.length;Se++)Ve=pe[pe.length-1-Se],ce[ce.length-1-Se]!==Ve&&(_e.hasOwnProperty(Ve)?(he.push({command:vi.removeLayer,args:[Ve]}),ce.splice(ce.lastIndexOf(Ve,ce.length-ze),1)):ze++,Xe=ce[ce.length-Se],he.push({command:vi.addLayer,args:[Y[Ve],Xe]}),ce.splice(ce.length-Se,0,Ve),Ee[Ve]=!0);for(Se=0;Se<pe.length;Se++)if(Ve=pe[Se],Ne=_e[Ve],Ye=Y[Ve],!Ee[Ve]&&!d(Ne,Ye))if(d(Ne.source,Ye.source)&&d(Ne["source-layer"],Ye["source-layer"])&&d(Ne.type,Ye.type)){for(st in wr(Ne.layout,Ye.layout,he,Ve,null,vi.setLayoutProperty),wr(Ne.paint,Ye.paint,he,Ve,null,vi.setPaintProperty),d(Ne.filter,Ye.filter)||he.push({command:vi.setFilter,args:[Ve,Ye.filter]}),d(Ne.minzoom,Ye.minzoom)&&d(Ne.maxzoom,Ye.maxzoom)||he.push({command:vi.setLayerZoomRange,args:[Ve,Ye.minzoom,Ye.maxzoom]}),Ne)Ne.hasOwnProperty(st)&&st!=="layout"&&st!=="paint"&&st!=="filter"&&st!=="metadata"&&st!=="minzoom"&&st!=="maxzoom"&&(st.indexOf("paint.")===0?wr(Ne[st],Ye[st],he,Ve,st.slice(6),vi.setPaintProperty):d(Ne[st],Ye[st])||he.push({command:vi.setLayerProperty,args:[Ve,st,Ye[st]]}));for(st in Ye)Ye.hasOwnProperty(st)&&!Ne.hasOwnProperty(st)&&st!=="layout"&&st!=="paint"&&st!=="filter"&&st!=="metadata"&&st!=="minzoom"&&st!=="maxzoom"&&(st.indexOf("paint.")===0?wr(Ne[st],Ye[st],he,Ve,st.slice(6),vi.setPaintProperty):d(Ne[st],Ye[st])||he.push({command:vi.setLayerProperty,args:[Ve,st,Ye[st]]}))}else he.push({command:vi.removeLayer,args:[Ve]}),Xe=ce[ce.lastIndexOf(Ve)+1],he.push({command:vi.addLayer,args:[Ye,Xe]})}($,A.layers,R)}catch(O){console.warn("Unable to compute style diff:",O),R=[{command:vi.setStyle,args:[A]}]}return R}(this.serialize(),h).filter(S=>!(S.command in hE));if(m.length===0)return!1;const x=m.filter(S=>!(S.command in vc));if(x.length>0)throw new Error(`Unimplemented: ${x.map(S=>S.command).join(", ")}.`);return m.forEach(S=>{S.command!=="setTransition"&&S.command!=="setProjection"&&this[S.command].apply(this,S.args)}),this.stylesheet=h,this._updateMapProjection(),!0}addImage(h,m){return this.getImage(h)?this.fire(new s.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(h,m),this._afterImageUpdated(h),this)}updateImage(h,m){this.imageManager.updateImage(h,m)}getImage(h){return this.imageManager.getImage(h)}removeImage(h){return this.getImage(h)?(this.imageManager.removeImage(h),this._afterImageUpdated(h),this):this.fire(new s.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(h){this._availableImages=this.imageManager.listImages(),this._changedImages[h]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(h,m,x={}){if(this._checkLoaded(),this.getSource(h)!==void 0)throw new Error("There is already a source with this ID");if(!m.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(m).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(m.type)>=0&&this._validate(s.validateSource,`sources.${h}`,m,null,x))return;this.map&&this.map._collectResourceTiming&&(m.collectResourceTiming=!0);const S=ii(h,m,this.dispatcher,this);S.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(h),source:S.serialize(),sourceId:h}));const A=R=>{const O=(R?"symbol:":"other:")+h,z=this._sourceCaches[O]=new s.SourceCache(O,S,R);(R?this._symbolSourceCaches:this._otherSourceCaches)[h]=z,z.style=this,z.onAdd(this.map)};A(!1),m.type!=="vector"&&m.type!=="geojson"||A(!0),S.onAdd&&S.onAdd(this.map),this._changed=!0}removeSource(h){this._checkLoaded();const m=this.getSource(h);if(!m)throw new Error("There is no source with this ID");for(const S in this._layers)if(this._layers[S].source===h)return this.fire(new s.ErrorEvent(new Error(`Source "${h}" cannot be removed while layer "${S}" is using it.`)));if(this.terrain&&this.terrain.get().source===h)return this.fire(new s.ErrorEvent(new Error(`Source "${h}" cannot be removed while terrain is using it.`)));const x=this._getSourceCaches(h);for(const S of x)delete this._sourceCaches[S.id],delete this._updatedSources[S.id],S.fire(new s.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:S.getSource().id})),S.setEventedParent(null),S.clearTiles();return delete this._otherSourceCaches[h],delete this._symbolSourceCaches[h],m.setEventedParent(null),m.onRemove&&m.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(h,m){this._checkLoaded(),this.getSource(h).setData(m),this._changed=!0}getSource(h){const m=this._getSourceCache(h);return m&&m.getSource()}_getSources(){const h=[];for(const m in this._otherSourceCaches){const x=this._getSourceCache(m);x&&h.push(x.getSource())}return h}addLayer(h,m,x={}){this._checkLoaded();const S=h.id;if(this.getLayer(S))return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${S}" already exists on this map`)));let A;if(h.type==="custom"){if(qo(this,s.validateCustomStyleLayer(h)))return;A=s.createStyleLayer(h)}else{if(typeof h.source=="object"&&(this.addSource(S,h.source),h=s.clone$1(h),h=s.extend(h,{source:S})),this._validate(s.validateLayer,`layers.${S}`,h,{arrayIndex:-1},x))return;A=s.createStyleLayer(h),this._validateLayer(A),A.setEventedParent(this,{layer:{id:S}}),this._serializedLayers[A.id]=A.serialize(),this._updateLayerCount(A,!0)}const R=m?this._order.indexOf(m):this._order.length;if(m&&R===-1)return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${m}" does not exist on this map.`)));this._order.splice(R,0,S),this._layerOrderChanged=!0,this._layers[S]=A;const O=this._getLayerSourceCache(A);if(this._removedLayers[S]&&A.source&&O&&A.type!=="custom"){const z=this._removedLayers[S];delete this._removedLayers[S],z.type!==A.type?this._updatedSources[A.source]="clear":(this._updatedSources[A.source]="reload",O.pause())}this._updateLayer(A),A.onAdd&&A.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(h,m){if(this._checkLoaded(),this._changed=!0,!this._layers[h])return void this.fire(new s.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be moved.`)));if(h===m)return;const x=this._order.indexOf(h);this._order.splice(x,1);const S=m?this._order.indexOf(m):this._order.length;m&&S===-1?this.fire(new s.ErrorEvent(new Error(`Layer with id "${m}" does not exist on this map.`))):(this._order.splice(S,0,h),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(h){this._checkLoaded();const m=this._layers[h];if(!m)return void this.fire(new s.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be removed.`)));m.setEventedParent(null),this._updateLayerCount(m,!1);const x=this._order.indexOf(h);this._order.splice(x,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[h]=m,delete this._layers[h],delete this._serializedLayers[h],delete this._updatedLayers[h],delete this._updatedPaintProps[h],m.onRemove&&m.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(h){return this._layers[h]}hasLayer(h){return h in this._layers}hasLayerType(h){for(const m in this._layers)if(this._layers[m].type===h)return!0;return!1}setLayerZoomRange(h,m,x){this._checkLoaded();const S=this.getLayer(h);S?S.minzoom===m&&S.maxzoom===x||(m!=null&&(S.minzoom=m),x!=null&&(S.maxzoom=x),this._updateLayer(S)):this.fire(new s.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(h,m,x={}){this._checkLoaded();const S=this.getLayer(h);if(S){if(!d(S.filter,m))return m==null?(S.filter=void 0,void this._updateLayer(S)):void(this._validate(s.validateFilter,`layers.${S.id}.filter`,m,{layerType:S.type},x)||(S.filter=s.clone$1(m),this._updateLayer(S)))}else this.fire(new s.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be filtered.`)))}getFilter(h){const m=this.getLayer(h);return m&&s.clone$1(m.filter)}setLayoutProperty(h,m,x,S={}){this._checkLoaded();const A=this.getLayer(h);A?d(A.getLayoutProperty(m),x)||(A.setLayoutProperty(m,x,S),this._updateLayer(A)):this.fire(new s.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(h,m){const x=this.getLayer(h);if(x)return x.getLayoutProperty(m);this.fire(new s.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style.`)))}setPaintProperty(h,m,x,S={}){this._checkLoaded();const A=this.getLayer(h);A?d(A.getPaintProperty(m),x)||(A.setPaintProperty(m,x,S)&&this._updateLayer(A),this._changed=!0,this._updatedPaintProps[h]=!0):this.fire(new s.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(h,m){const x=this.getLayer(h);return x&&x.getPaintProperty(m)}setFeatureState(h,m){this._checkLoaded();const x=h.source,S=h.sourceLayer,A=this.getSource(x);if(!A)return void this.fire(new s.ErrorEvent(new Error(`The source '${x}' does not exist in the map's style.`)));const R=A.type;if(R==="geojson"&&S)return void this.fire(new s.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(R==="vector"&&!S)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));h.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided.")));const O=this._getSourceCaches(x);for(const z of O)z.setFeatureState(S,h.id,m)}removeFeatureState(h,m){this._checkLoaded();const x=h.source,S=this.getSource(x);if(!S)return void this.fire(new s.ErrorEvent(new Error(`The source '${x}' does not exist in the map's style.`)));const A=S.type,R=A==="vector"?h.sourceLayer:void 0;if(A==="vector"&&!R)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(m&&typeof h.id!="string"&&typeof h.id!="number")return void this.fire(new s.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const O=this._getSourceCaches(x);for(const z of O)z.removeFeatureState(R,h.id,m)}getFeatureState(h){this._checkLoaded();const m=h.source,x=h.sourceLayer,S=this.getSource(m);if(S){if(S.type!=="vector"||x)return h.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(m)[0].getFeatureState(x,h.id);this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)))}getTransition(){return s.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const h={};for(const m in this._sourceCaches){const x=this._sourceCaches[m].getSource();h[x.id]||(h[x.id]=x.serialize())}return s.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:h,layers:this._serializeLayers(this._order)},m=>m!==void 0)}_updateLayer(h){this._updatedLayers[h.id]=!0;const m=this._getLayerSourceCache(h);h.source&&!this._updatedSources[h.source]&&m&&m.getSource().type!=="raster"&&(this._updatedSources[h.source]="reload",m.pause()),this._changed=!0,h.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(h){const m=R=>this._layers[R].type==="fill-extrusion",x={},S=[];for(let R=this._order.length-1;R>=0;R--){const O=this._order[R];if(m(O)){x[O]=R;for(const z of h){const $=z[O];if($)for(const j of $)S.push(j)}}}S.sort((R,O)=>O.intersectionZ-R.intersectionZ);const A=[];for(let R=this._order.length-1;R>=0;R--){const O=this._order[R];if(m(O))for(let z=S.length-1;z>=0;z--){const $=S[z].feature;if(x[$.layer.id]<R)break;A.push($),S.pop()}else for(const z of h){const $=z[O];if($)for(const j of $)A.push(j.feature)}}return A}queryRenderedFeatures(h,m,x){m&&m.filter&&this._validate(s.validateFilter,"queryRenderedFeatures.filter",m.filter,null,m);const S={};if(m&&m.layers){if(!Array.isArray(m.layers))return this.fire(new s.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const z of m.layers){const $=this._layers[z];if(!$)return this.fire(new s.ErrorEvent(new Error(`The layer '${z}' does not exist in the map's style and cannot be queried for features.`))),[];S[$.source]=!0}}const A=[];m.availableImages=this._availableImages;const R=m&&m.layers?m.layers.some(z=>{const $=this.getLayer(z);return $&&$.is3D()}):this.has3DLayers(),O=xn.createFromScreenPoints(h,x);for(const z in this._sourceCaches){const $=this._sourceCaches[z].getSource().id;m.layers&&!S[$]||A.push(Vi(this._sourceCaches[z],this._layers,this._serializedLayers,O,m,x,R,!!this.map._showQueryGeometry))}return this.placement&&A.push(function(z,$,j,Z,re,he,ge){const pe={},_e=he.queryRenderedSymbols(Z),Y=[];for(const ce of Object.keys(_e).map(Number))Y.push(ge[ce]);Y.sort(Fr);for(const ce of Y){const Ee=ce.featureIndex.lookupSymbolFeatures(_e[ce.bucketInstanceId],$,ce.bucketIndex,ce.sourceLayerIndex,re.filter,re.layers,re.availableImages,z);for(const Se in Ee){const ze=pe[Se]=pe[Se]||[],Ve=Ee[Se];Ve.sort((Ne,Ye)=>{const Xe=ce.featureSortOrder;if(Xe){const st=Xe.indexOf(Ne.featureIndex);return Xe.indexOf(Ye.featureIndex)-st}return Ye.featureIndex-Ne.featureIndex});for(const Ne of Ve)ze.push(Ne)}}for(const ce in pe)pe[ce].forEach(Ee=>{const Se=Ee.feature,ze=j(z[ce]);if(!ze)return;const Ve=ze.getFeatureState(Se.layer["source-layer"],Se.id);Se.source=Se.layer.source,Se.layer["source-layer"]&&(Se.sourceLayer=Se.layer["source-layer"]),Se.state=Ve});return pe}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),O.screenGeometry,m,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(A)}querySourceFeatures(h,m){m&&m.filter&&this._validate(s.validateFilter,"querySourceFeatures.filter",m.filter,null,m);const x=this._getSourceCaches(h);let S=[];for(const A of x)S=S.concat(hr(A,m));return S}addSourceType(h,m,x){return Aa.getSourceType(h)?x(new Error(`A source type called "${h}" already exists.`)):(Aa.setSourceType(h,m),m.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:h,url:m.workerSourceURL},x):x(null,null))}getLight(){return this.light.getLight()}setLight(h,m={}){this._checkLoaded();const x=this.light.getLight();let S=!1;for(const R in h)if(!d(h[R],x[R])){S=!0;break}if(!S)return;const A=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(h,m),this.light.updateTransitions(A)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(h,m=1){if(this._checkLoaded(),!h)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let x=h;if(m===1){if(typeof x.source=="object"){const S="terrain-dem-src";this.addSource(S,x.source),x=s.clone$1(x),x=s.extend(x,{source:S})}if(this._validate(s.validateTerrain,"terrain",x))return}if(!this.terrain||this.terrain&&m!==this.terrain.drapeRenderMode){if(!x)return;this._createTerrain(x,m)}else{const S=this.terrain,A=S.get();for(const R of Object.keys(s.spec.terrain))!x.hasOwnProperty(R)&&s.spec.terrain[R].default&&(x[R]=s.spec.terrain[R].default);for(const R in x)if(!d(x[R],A[R])){S.set(x),this.stylesheet.terrain=x;const O=this._setTransitionParameters({duration:0});S.updateTransitions(O);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(h){const m=this.fog=new Qt(h,this.map.transform);this.stylesheet.fog=h;const x=this._setTransitionParameters({duration:0});m.updateTransitions(x)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const h of this.map._markers)h._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(h){if(this._checkLoaded(),!h)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const m=this.fog,x=m.get();Object.keys(h).length===0&&m.set(h);for(const S in h)if(!d(h[S],x[S])){m.set(h),this.stylesheet.fog=h;const A=this._setTransitionParameters({duration:0});m.updateTransitions(A);break}}else this._createFog(h);this._markersNeedUpdate=!0}_setTransitionParameters(h){return{now:s.exported.now(),transition:s.extend(h,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const h=this._order.filter(x=>this.isLayerDraped(this._layers[x])),m=this._order.filter(x=>!this.isLayerDraped(this._layers[x]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...h),this._drapedFirstOrder.push(...m)}_createTerrain(h,m){const x=this.terrain=new ut(h,m);this.stylesheet.terrain=h,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const S=this._setTransitionParameters({duration:0});x.updateTransitions(S)}_force3DLayerUpdate(){for(const h in this._layers){const m=this._layers[h];m.type==="fill-extrusion"&&this._updateLayer(m)}}_forceSymbolLayerUpdate(){for(const h in this._layers){const m=this._layers[h];m.type==="symbol"&&this._updateLayer(m)}}_validate(h,m,x,S,A={}){return(!A||A.validate!==!1)&&qo(this,h.call(s.validateStyle,s.extend({key:m,style:this.serialize(),value:x,styleSpec:s.spec},S)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const h in this._layers)this._layers[h].setEventedParent(null);for(const h in this._sourceCaches)this._sourceCaches[h].clearTiles(),this._sourceCaches[h].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(h){const m=this._getSourceCaches(h);for(const x of m)x.clearTiles()}_reloadSource(h){const m=this._getSourceCaches(h);for(const x of m)x.resume(),x.reload()}_reloadSources(){for(const h of this._getSources())h.reload&&h.reload()}_updateSources(h){for(const m in this._sourceCaches)this._sourceCaches[m].update(h)}_generateCollisionBoxes(){for(const h in this._sourceCaches){const m=this._sourceCaches[h];m.resume(),m.reload()}}_updatePlacement(h,m,x,S,A=!1){let R=!1,O=!1;const z={};for(const $ of this._order){const j=this._layers[$];if(j.type!=="symbol")continue;if(!z[j.source]){const re=this._getLayerSourceCache(j);if(!re)continue;z[j.source]=re.getRenderableIds(!0).map(he=>re.getTileByID(he)).sort((he,ge)=>ge.tileID.overscaledZ-he.tileID.overscaledZ||(he.tileID.isLessThan(ge.tileID)?-1:1))}const Z=this.crossTileSymbolIndex.addLayer(j,z[j.source],h.center.lng,h.projection);R=R||Z}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),A=A||this._layerOrderChanged||x===0,this._layerOrderChanged&&this.fire(new s.Event("neworder")),(A||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.exported.now(),h.zoom))&&(this.pauseablePlacement=new vu(h,this._order,A,m,x,S,this.placement,this.fog&&h.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,z),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.exported.now()),O=!0),R&&this.pauseablePlacement.placement.setStale()),O||R)for(const $ of this._order){const j=this._layers[$];j.type==="symbol"&&this.placement.updateLayerOpacities(j,z[j.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.exported.now())}_releaseSymbolFadeTiles(){for(const h in this._sourceCaches)this._sourceCaches[h].releaseSymbolFadeTiles()}getImages(h,m,x){this.imageManager.getImages(m.icons,x),this._updateTilesForChangedImages();const S=A=>{A&&A.setDependencies(m.tileID.key,m.type,m.icons)};S(this._otherSourceCaches[m.source]),S(this._symbolSourceCaches[m.source])}getGlyphs(h,m,x){this.glyphManager.getGlyphs(m.stacks,x)}getResource(h,m,x){return s.makeRequest(m,x)}_getSourceCache(h){return this._otherSourceCaches[h]}_getLayerSourceCache(h){return h.type==="symbol"?this._symbolSourceCaches[h.source]:this._otherSourceCaches[h.source]}_getSourceCaches(h){const m=[];return this._otherSourceCaches[h]&&m.push(this._otherSourceCaches[h]),this._symbolSourceCaches[h]&&m.push(this._symbolSourceCaches[h]),m}_isSourceCacheLoaded(h){const m=this._getSourceCaches(h);return m.length===0?(this.fire(new s.ErrorEvent(new Error(`There is no source with ID '${h}'`))),!1):m.every(x=>x.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Aa.getSourceType=function(_){return Yn[_]},Aa.setSourceType=function(_,h){Yn[_]=h},Aa.registerForPluginStateChange=s.registerForPluginStateChange;var ag=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,_c="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Ja=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,Wh=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Qa=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let If={},wu={};const Kh=[];Eu(ag,Kh),Eu(Ja,Kh),Eu(Wh,Kh),Eu(Qa,Kh),If=Fi("",Ja),wu=Fi(Qa,Wh);const B_=Fi(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Mf=ag,lg=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var cg={background:Fi(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Fi(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Fi(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Fi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Fi(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Fi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Fi("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Fi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Fi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Fi(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Fi(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Fi(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Fi(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Fi(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Fi(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Fi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Fi(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Fi(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Fi(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Fi(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Fi(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Fi(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Fi(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Fi(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Fi(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Fi(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,_c),skyboxGradient:Fi(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,_c),skyboxCapture:Fi(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Fi(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Fi(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function Eu(_,h){const m=_.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let x of m)if(x=x.trim(),x[0]==="#"&&x.includes("if")&&!x.includes("endif")){x=x.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const S=x.split(" ");for(const A of S)h.includes(A)||h.push(A)}}function Fi(_,h){const m=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,x=h.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),S={},A=[...Kh];return Eu(_,A),Eu(h,A),{fragmentSource:_=_.replace(m,(R,O,z,$,j)=>(S[j]=!0,O==="define"?`
#ifndef HAS_UNIFORM_u_${j}
varying ${z} ${$} ${j};
#else
uniform ${z} ${$} u_${j};
#endif
`:`
#ifdef HAS_UNIFORM_u_${j}
    ${z} ${$} ${j} = u_${j};
#endif
`)),vertexSource:h=h.replace(m,(R,O,z,$,j)=>{const Z=$==="float"?"vec2":"vec4",re=j.match(/color/)?"color":Z;return S[j]?O==="define"?`
#ifndef HAS_UNIFORM_u_${j}
uniform lowp float u_${j}_t;
attribute ${z} ${Z} a_${j};
varying ${z} ${$} ${j};
#else
uniform ${z} ${$} u_${j};
#endif
`:re==="vec4"?`
#ifndef HAS_UNIFORM_u_${j}
    ${j} = a_${j};
#else
    ${z} ${$} ${j} = u_${j};
#endif
`:`
#ifndef HAS_UNIFORM_u_${j}
    ${j} = unpack_mix_${re}(a_${j}, u_${j}_t);
#else
    ${z} ${$} ${j} = u_${j};
#endif
`:O==="define"?`
#ifndef HAS_UNIFORM_u_${j}
uniform lowp float u_${j}_t;
attribute ${z} ${Z} a_${j};
#else
uniform ${z} ${$} u_${j};
#endif
`:re==="vec4"?`
#ifndef HAS_UNIFORM_u_${j}
    ${z} ${$} ${j} = a_${j};
#else
    ${z} ${$} ${j} = u_${j};
#endif
`:`
#ifndef HAS_UNIFORM_u_${j}
    ${z} ${$} ${j} = unpack_mix_${re}(a_${j}, u_${j}_t);
#else
    ${z} ${$} ${j} = u_${j};
#endif
`}),staticAttributes:x,usedDefines:A}}class dE{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(h,m,x,S,A,R,O){this.context=h;let z=this.boundPaintVertexBuffers.length!==S.length;for(let j=0;!z&&j<S.length;j++)this.boundPaintVertexBuffers[j]!==S[j]&&(z=!0);let $=this.boundDynamicVertexBuffers.length!==O.length;for(let j=0;!$&&j<O.length;j++)this.boundDynamicVertexBuffers[j]!==O[j]&&($=!0);if(!h.extVertexArrayObject||!this.vao||this.boundProgram!==m||this.boundLayoutVertexBuffer!==x||z||$||this.boundIndexBuffer!==A||this.boundVertexOffset!==R)this.freshBind(m,x,S,A,R,O);else{h.bindVertexArrayOES.set(this.vao);for(const j of O)j&&j.bind();A&&A.dynamicDraw&&A.bind()}}freshBind(h,m,x,S,A,R){let O;const z=h.numAttributes,$=this.context,j=$.gl;if($.extVertexArrayObject)this.vao&&this.destroy(),this.vao=$.extVertexArrayObject.createVertexArrayOES(),$.bindVertexArrayOES.set(this.vao),O=0,this.boundProgram=h,this.boundLayoutVertexBuffer=m,this.boundPaintVertexBuffers=x,this.boundIndexBuffer=S,this.boundVertexOffset=A,this.boundDynamicVertexBuffers=R;else{O=$.currentNumAttributes||0;for(let Z=z;Z<O;Z++)j.disableVertexAttribArray(Z)}m.enableAttributes(j,h),m.bind(),m.setVertexAttribPointers(j,h,A);for(const Z of x)Z.enableAttributes(j,h),Z.bind(),Z.setVertexAttribPointers(j,h,A);for(const Z of R)Z&&(Z.enableAttributes(j,h),Z.bind(),Z.setVertexAttribPointers(j,h,A));S&&S.bind(),$.currentNumAttributes=z}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function ug(_,h){const m=Math.pow(2,h.canonical.z),x=h.canonical.y;return[new s.MercatorCoordinate(0,x/m).toLngLat().lat,new s.MercatorCoordinate(0,(x+1)/m).toLngLat().lat]}function z_(_,h,m,x,S,A,R){const O=_.context,z=O.gl,$=m.fbo;if(!$)return;_.prepareDrawTile();const j=_.useProgram("hillshade");O.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,$.colorAttachment.get());const Z=((pe,_e,Y,ce)=>{const Ee=Y.paint.get("hillshade-shadow-color"),Se=Y.paint.get("hillshade-highlight-color"),ze=Y.paint.get("hillshade-accent-color");let Ve=Y.paint.get("hillshade-illumination-direction")*(Math.PI/180);Y.paint.get("hillshade-illumination-anchor")==="viewport"&&(Ve-=pe.transform.angle);const Ne=!pe.options.moving;return{u_matrix:ce||pe.transform.calculateProjMatrix(_e.tileID.toUnwrapped(),Ne),u_image:0,u_latrange:ug(0,_e.tileID),u_light:[Y.paint.get("hillshade-exaggeration"),Ve],u_shadow:Ee,u_highlight:Se,u_accent:ze}})(_,m,x,_.terrain?h.projMatrix:null);_.prepareDrawProgram(O,j,h.toUnwrapped());const{tileBoundsBuffer:re,tileBoundsIndexBuffer:he,tileBoundsSegments:ge}=_.getTileBoundsBuffers(m);j.draw(O,z.TRIANGLES,S,A,R,s.CullFaceMode.disabled,Z,x.id,re,he,ge)}function hg(_,h,m){if(!h.needsDEMTextureUpload)return;const x=_.context,S=x.gl;x.pixelStoreUnpackPremultiplyAlpha.set(!1),h.demTexture=h.demTexture||_.getTileTexture(m.stride);const A=m.getPixels();h.demTexture?h.demTexture.update(A,{premultiply:!1}):h.demTexture=new s.Texture(x,A,S.RGBA,{premultiply:!1}),h.needsDEMTextureUpload=!1}function N_(_,h,m,x,S,A){const R=_.context,O=R.gl;if(!h.dem)return;const z=h.dem;if(R.activeTexture.set(O.TEXTURE1),hg(_,h,z),!h.demTexture)return;h.demTexture.bind(O.NEAREST,O.CLAMP_TO_EDGE);const $=z.dim;R.activeTexture.set(O.TEXTURE0);let j=h.fbo;if(!j){const ge=new s.Texture(R,{width:$,height:$,data:null},O.RGBA);ge.bind(O.LINEAR,O.CLAMP_TO_EDGE),j=h.fbo=R.createFramebuffer($,$,!0),j.colorAttachment.set(ge.texture)}R.bindFramebuffer.set(j.framebuffer),R.viewport.set([0,0,$,$]);const{tileBoundsBuffer:Z,tileBoundsIndexBuffer:re,tileBoundsSegments:he}=_.getMercatorTileBoundsBuffers();_.useProgram("hillshadePrepare").draw(R,O.TRIANGLES,x,S,A,s.CullFaceMode.disabled,((ge,pe)=>{const _e=pe.stride,Y=s.create();return s.ortho(Y,0,s.EXTENT,-s.EXTENT,0,0,1),s.translate(Y,Y,[0,-s.EXTENT,0]),{u_matrix:Y,u_image:1,u_dimension:[_e,_e],u_zoom:ge.overscaledZ,u_unpack:pe.unpackVector}})(h.tileID,z),m.id,Z,re,he),h.needsHillshadePrepare=!1}const dg=_=>({u_matrix:new s.UniformMatrix4f(_),u_image0:new s.Uniform1i(_),u_skirt_height:new s.Uniform1f(_)}),Tu=(_,h)=>({u_matrix:_,u_image0:0,u_skirt_height:h}),Rf=(_,h,m,x,S,A,R,O,z,$,j,Z,re,he,ge)=>({u_proj_matrix:Float32Array.from(_),u_globe_matrix:h,u_normalize_matrix:Float32Array.from(x),u_merc_matrix:m,u_zoom_transition:S,u_merc_center:A,u_image0:0,u_frustum_tl:R,u_frustum_tr:O,u_frustum_br:z,u_frustum_bl:$,u_globe_pos:j,u_globe_radius:Z,u_viewport:re,u_grid_matrix:ge?Float32Array.from(ge):new Float32Array(9),u_skirt_height:he});function Su(_,h){return _!=null&&h!=null&&!(!_.hasData()||!h.hasData())&&_.demTexture!=null&&h.demTexture!=null&&_.tileID.key!==h.tileID.key}const el=new class{constructor(){this.operations={}}newMorphing(_,h,m,x,S){if(_ in this.operations){const A=this.operations[_];A.to.tileID.key!==m.tileID.key&&(A.queued=m)}else this.operations[_]={startTime:x,phase:0,duration:S,from:h,to:m,queued:null}}getMorphValuesForProxy(_){if(!(_ in this.operations))return null;const h=this.operations[_];return{from:h.from,to:h.to,phase:h.phase}}update(_){for(const h in this.operations){const m=this.operations[h];for(m.phase=(_-m.startTime)/m.duration;m.phase>=1||!this._validOp(m);)if(!this._nextOp(m,_)){delete this.operations[h];break}}}_nextOp(_,h){return!!_.queued&&(_.from=_.to,_.to=_.queued,_.queued=null,_.phase=0,_.startTime=h,!0)}_validOp(_){return _.from.hasData()&&_.to.hasData()}},bc={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Lf(_){return 6*Math.pow(1.5,22-_)}function U_(_,h){const m=1<<_.z;return!h&&(_.x===0||_.x===m-1)||_.y===0||_.y===m-1}const Xh=_=>({u_matrix:_});function fg(_,h,m,x,S){if(S>0){const A=s.exported.now(),R=(A-_.timeAdded)/S,O=h?(A-h.timeAdded)/S:-1,z=m.getSource(),$=x.coveringZoomLevel({tileSize:z.tileSize,roundZoom:z.roundZoom}),j=!h||Math.abs(h.tileID.overscaledZ-$)>Math.abs(_.tileID.overscaledZ-$),Z=j&&_.refreshedUponExpiration?1:s.clamp(j?R:1-O,0,1);return _.refreshedUponExpiration&&R>=1&&(_.refreshedUponExpiration=!1),h?{opacity:1,mix:1-Z}:{opacity:Z,mix:0}}return{opacity:1,mix:0}}class pg extends s.SourceCache{constructor(h){const m={type:"raster-dem",maxzoom:h.transform.maxZoom},x=new cn(Bo(),null),S=ii("mock-dem",m,x,h.style);super("mock-dem",S,!1),S.setEventedParent(this),this._sourceLoaded=!0}_loadTile(h,m){h.state="loaded",m(null)}}class Of extends s.SourceCache{constructor(h){const m=ii("proxy",{type:"geojson",maxzoom:h.transform.maxZoom},new cn(Bo(),null),h.style);super("proxy",m,!1),m.setEventedParent(this),this.map=this.getSource().map=h,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(h,m,x){if(h.freezeTileCoverage)return;this.transform=h;const S=h.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((A,R)=>{if(A[R.key]="",!this._tiles[R.key]){const O=new s.Tile(R,this._source.tileSize*R.overscaleFactor(),h.tileZoom);O.state="loaded",this._tiles[R.key]=O}return A},{});for(const A in this._tiles)A in S||(this.freeFBO(A),this._tiles[A].unloadVectorData(),delete this._tiles[A])}freeFBO(h){const m=this.proxyCachedFBO[h];if(m!==void 0){const x=Object.values(m);this.renderCachePool.push(...x),delete this.proxyCachedFBO[h]}}deallocRenderCache(){this.renderCache.forEach(h=>h.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Df extends s.OverscaledTileID{constructor(h,m,x){super(h.overscaledZ,h.wrap,h.canonical.z,h.canonical.x,h.canonical.y),this.proxyTileKey=m,this.projMatrix=x}}class mg extends s.Elevation{constructor(h,m){super(),this.painter=h,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[x,S,A]=function(z){const $=new s.StructArrayLayout2i4,j=new s.StructArrayLayout3ui6,Z=131;$.reserve(17161),j.reserve(33800);const re=s.EXTENT/128,he=s.EXTENT+re/2,ge=he+re;for(let _e=-re;_e<ge;_e+=re)for(let Y=-re;Y<ge;Y+=re){const ce=Y<0||Y>he||_e<0||_e>he?24575:0,Ee=s.clamp(Math.round(Y),0,s.EXTENT),Se=s.clamp(Math.round(_e),0,s.EXTENT);$.emplaceBack(Ee+ce,Se)}const pe=(_e,Y)=>{const ce=Y*Z+_e;j.emplaceBack(ce+1,ce,ce+Z),j.emplaceBack(ce+Z,ce+Z+1,ce+1)};for(let _e=1;_e<129;_e++)for(let Y=1;Y<129;Y++)pe(Y,_e);return[0,129].forEach(_e=>{for(let Y=0;Y<130;Y++)pe(Y,_e),pe(_e,Y)}),[$,j,32768]}(),R=h.context;this.gridBuffer=R.createVertexBuffer(x,s.posAttributes.members),this.gridIndexBuffer=R.createIndexBuffer(S),this.gridSegments=s.SegmentVector.simpleSegment(0,0,x.length,S.length),this.gridNoSkirtSegments=s.SegmentVector.simpleSegment(0,0,x.length,A),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Of(m.map),this.orthoMatrix=s.create(),s.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,s.EXTENT,0,s.EXTENT,0,1);const O=R.gl;this._overlapStencilMode=new s.StencilMode({func:O.GEQUAL,mask:255},0,255,O.KEEP,O.KEEP,O.REPLACE),this._previousZoom=h.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=m,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new pg(m.map)}set style(h){h.on("data",this._onStyleDataEvent.bind(this)),h.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=h,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(h,m,x){if(h&&h.terrain){this._style!==h&&(this.style=h),this.enabled=!0;const S=h.terrain.properties;this.sourceCache=h.terrain.drapeRenderMode===0?this._mockSourceCache:h._getSourceCache(S.get("source")),this._exaggeration=S.get("exaggeration");const A=()=>{this.sourceCache.used&&s.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const R=this.getScaledDemTileSize();this.sourceCache.update(m,R,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,A(),this._initializing=!0),A(),m.updateElevation(!0,x),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(m),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(h){this._findCoveringTileCache[h]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const h=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||h.efficiency!==100&&s.warnOnce(`Terrain render cache efficiency is not optimal (${h.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${h.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(h){h.coord&&h.dataType==="source"?this._clearRenderCacheForTile(h.sourceCacheId,h.coord):h.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const h in this._style._sourceCaches)this._style._sourceCaches[h].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(h=>h.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const h=2*this.proxySourceCache.getSource().tileSize;return[h,h]}set useVertexMorphing(h){this._useVertexMorphing=h}updateTileBinding(h){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const m=this.proxySourceCache,x=this.painter.transform;this._initializing&&(this._initializing=x._centerAltitude===0&&this.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(x.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const S=this.proxyCoords=m.getIds().map(z=>{const $=m.getTileByID(z).tileID;return $.projMatrix=x.calculateProjMatrix($.toUnwrapped()),$});(function(z,$){const j=$.transform.pointCoordinate($.transform.getCameraPoint()),Z=new s.Point(j.x,j.y);z.sort((re,he)=>{if(he.overscaledZ-re.overscaledZ)return he.overscaledZ-re.overscaledZ;const ge=new s.Point(re.canonical.x+(1<<re.canonical.z)*re.wrap,re.canonical.y),pe=new s.Point(he.canonical.x+(1<<he.canonical.z)*he.wrap,he.canonical.y),_e=Z.mult(1<<re.canonical.z);return _e.x-=.5,_e.y-=.5,_e.distSqr(ge)-_e.distSqr(pe)})})(S,this.painter),this._previousZoom=x.zoom;const A=this.proxyToSource||{};this.proxyToSource={},S.forEach(z=>{this.proxyToSource[z.key]={}}),this.terrainTileForTile={};const R=this._style._sourceCaches;for(const z in R){const $=R[z];if(!$.used||($!==this.sourceCache&&this.resetTileLookupCache($.id),this._setupProxiedCoordsForOrtho($,h[z],A),$.usedForTerrain))continue;const j=h[z];$.getSource().reparseOverscaled&&this._assignTerrainTiles(j)}this.proxiedCoords[m.id]=S.map(z=>new Df(z,z.key,this.orthoMatrix)),this._assignTerrainTiles(S),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(A),this.renderingToTexture=!1,this._updateTimestamp=s.exported.now();const O={};this._visibleDemTiles=[];for(const z of this.proxyCoords){const $=this.terrainTileForTile[z.key];if(!$)continue;const j=$.tileID.key;j in O||(this._visibleDemTiles.push($),O[j]=j)}}_assignTerrainTiles(h){this._initializing||h.forEach(m=>{if(this.terrainTileForTile[m.key])return;const x=this._findTileCoveringTileID(m,this.sourceCache);x&&(this.terrainTileForTile[m.key]=x)})}_prepareDEMTextures(){const h=this.painter.context,m=h.gl;for(const x in this.terrainTileForTile){const S=this.terrainTileForTile[x],A=S.dem;!A||S.demTexture&&!S.needsDEMTextureUpload||(h.activeTexture.set(m.TEXTURE1),hg(this.painter,S,A))}}_prepareDemTileUniforms(h,m,x,S){if(!m||m.demTexture==null)return!1;const A=h.tileID.canonical,R=Math.pow(2,m.tileID.canonical.z-A.z),O=S||"";return x[`u_dem_tl${O}`]=[A.x*R%1,A.y*R%1],x[`u_dem_scale${O}`]=R,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const h=this.painter.context,m=h.gl;if(!this._emptyDepthBufferTexture){const x=new s.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new s.Texture(h,x,m.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let h=0;const m=this._visibleDemTiles.reduce((x,S)=>{if(!S.dem)return x;const A=S.dem.tree.minimums[0];return A>0&&h++,x+A},0);return h?m/h:0}_updateEmptyDEMTexture(){const h=this.painter.context,m=h.gl;h.activeTexture.set(m.TEXTURE2);const x=this._getLoadedAreaMinimum(),S=new s.RGBAImage({width:1,height:1},new Uint8Array(s.DEMData.pack(x,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let A=this._emptyDEMTexture;return A?A.update(S,{premultiply:!1}):A=this._emptyDEMTexture=new s.Texture(h,S,m.RGBA,{premultiply:!1}),A}setupElevationDraw(h,m,x){const S=this.painter.context,A=S.gl,R=(O=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:s.DEMData.getUnpackVector(O),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var O;R.u_dem_size=this.sourceCache.getSource().tileSize,R.u_exaggeration=this.exaggeration();let z=null,$=null,j=1;if(x&&x.morphing&&this._useVertexMorphing){const Z=x.morphing.srcDemTile,re=x.morphing.dstDemTile;j=x.morphing.phase,Z&&re&&(this._prepareDemTileUniforms(h,Z,R,"_prev")&&($=Z),this._prepareDemTileUniforms(h,re,R)&&(z=re))}if($&&z?(S.activeTexture.set(A.TEXTURE2),z.demTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE,A.NEAREST),S.activeTexture.set(A.TEXTURE4),$.demTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE,A.NEAREST),R.u_dem_lerp=j):(z=this.terrainTileForTile[h.tileID.key],S.activeTexture.set(A.TEXTURE2),(this._prepareDemTileUniforms(h,z,R)?z.demTexture:this.emptyDEMTexture).bind(A.NEAREST,A.CLAMP_TO_EDGE)),S.activeTexture.set(A.TEXTURE3),x&&x.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE),this._depthFBO&&(R.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE),R.u_depth_size_inv=[1,1]),x&&x.useMeterToDem&&z){const Z=(1<<z.tileID.canonical.z)*s.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;R.u_meter_to_dem=Z}if(x&&x.labelPlaneMatrixInv&&(R.u_label_plane_matrix_inv=x.labelPlaneMatrixInv),m.setTerrainUniformValues(S,R),this.painter.transform.projection.name==="globe"){const Z=this.globeUniformValues(this.painter.transform,h.tileID.canonical,x&&x.useDenormalizedUpVectorScale);m.setGlobeUniformValues(S,Z)}}globeUniformValues(h,m,x){const S=h.projection;return{u_tile_tl_up:S.upVector(m,0,0),u_tile_tr_up:S.upVector(m,s.EXTENT,0),u_tile_br_up:S.upVector(m,s.EXTENT,s.EXTENT),u_tile_bl_up:S.upVector(m,0,s.EXTENT),u_tile_up_scale:x?s.globeMetersToEcef(1):S.upVectorScale(m,h.center.lat,h.worldSize).metersToTile}}renderToBackBuffer(h){const m=this.painter,x=this.painter.context;h.length!==0&&(x.bindFramebuffer.set(null),x.viewport.set([0,0,m.width,m.height]),m.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(S,A,R,O,z){if(S.transform.projection.name==="globe")(function($,j,Z,re,he){const ge=$.context,pe=ge.gl;let _e,Y;const ce=$.options.showTerrainWireframe?2:0,Ee=$.transform,Se=s.globeUseCustomAntiAliasing($,ge,Ee),ze=(Bt,ot)=>{if(Y===Bt)return;const xt=[bc[Bt],"PROJECTION_GLOBE_VIEW"];Se&&xt.push("CUSTOM_ANTIALIASING"),ot&&xt.push(bc[ce]),_e=$.useProgram("globeRaster",null,xt),Y=Bt},Ve=$.colorModeForRenderPass(),Ne=new s.DepthMode(pe.LEQUAL,s.DepthMode.ReadWrite,$.depthRangeFor3D);el.update(he);const Ye=s.calculateGlobeMercatorMatrix(Ee),Xe=[s.mercatorXfromLng(Ee.center.lng),s.mercatorYfromLat(Ee.center.lat)],st=ce?[!1,!0]:[!1],Ut=$.globeSharedBuffers,nt=[Ee.width*s.exported.devicePixelRatio,Ee.height*s.exported.devicePixelRatio],wt=Float32Array.from(Ee.globeMatrix),dt={useDenormalizedUpVectorScale:!0};if(st.forEach(Bt=>{const ot=$.transform,xt=Lf(ot.zoom)*j.exaggeration();Y=-1;const jt=Bt?pe.LINES:pe.TRIANGLES;for(const Mt of re){const Gt=Z.getTile(Mt),In=s.StencilMode.disabled,Qn=j.prevTerrainTileForTile[Mt.key],gn=j.terrainTileForTile[Mt.key];Su(Qn,gn)&&el.newMorphing(Mt.key,Qn,gn,he,250),ge.activeTexture.set(pe.TEXTURE0),Gt.texture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE);const Fn=el.getMorphValuesForProxy(Mt.key),yi=Fn?1:0;Fn&&s.extend$1(dt,{morphing:{srcDemTile:Fn.from,dstDemTile:Fn.to,phase:s.easeCubicInOut(Fn.phase)}});const gi=s.tileCornersToBounds(Mt.canonical),Sn=s.getLatitudinalLod(gi.getCenter().lat),Ui=s.getGridMatrix(Mt.canonical,gi,Sn,ot.worldSize/ot._pixelsPerMercatorPixel),Hi=s.globeNormalizeECEF(s.globeTileBounds(Mt.canonical)),Wi=Rf(ot.projMatrix,wt,Ye,Hi,s.globeToMercatorTransition(ot.zoom),Xe,ot.frustumCorners.TL,ot.frustumCorners.TR,ot.frustumCorners.BR,ot.frustumCorners.BL,ot.globeCenterInViewSpace,ot.globeRadius,nt,xt,Ui);if(ze(yi,Bt),j.setupElevationDraw(Gt,_e,dt),$.prepareDrawProgram(ge,_e,Mt.toUnwrapped()),Ut){const[Ki,Vo,Eo]=Bt?Ut.getWirefameBuffers($.context,Sn):Ut.getGridBuffers(Sn,xt!==0);_e.draw(ge,jt,Ne,In,Ve,s.CullFaceMode.backCCW,Wi,"globe_raster",Ki,Vo,Eo)}}}),Ut){const Bt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Se&&Bt.push("CUSTOM_ANTIALIASING"),_e=$.useProgram("globeRaster",null,Bt);for(const ot of re){const{x:xt,y:jt,z:Mt}=ot.canonical,Gt=jt===0,In=jt===(1<<Mt)-1,[Qn,gn,Fn,yi]=Ut.getPoleBuffers(Mt);if(yi&&(Gt||In)){const gi=Z.getTile(ot);ge.activeTexture.set(pe.TEXTURE0),gi.texture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE);let Sn=s.globePoleMatrixForTile(Mt,xt,Ee);const Ui=s.globeNormalizeECEF(s.globeTileBounds(ot.canonical)),Hi=(Wi,Ki)=>Wi.draw(ge,pe.TRIANGLES,Ne,s.StencilMode.disabled,Ve,s.CullFaceMode.disabled,Rf(Ee.projMatrix,Sn,Sn,Ui,0,Xe,Ee.frustumCorners.TL,Ee.frustumCorners.TR,Ee.frustumCorners.BR,Ee.frustumCorners.BL,Ee.globeCenterInViewSpace,Ee.globeRadius,nt,0),"globe_pole_raster",Ki,Fn,yi);j.setupElevationDraw(gi,_e,dt),$.prepareDrawProgram(ge,_e,ot.toUnwrapped()),Gt&&Hi(_e,Qn),In&&(Sn=s.scale(s.create(),Sn,[1,-1,1]),Hi(_e,gn))}}}})(S,A,R,O,z);else{const $=S.context,j=$.gl;let Z,re;const he=S.options.showTerrainWireframe?2:0,ge=(Ee,Se)=>{if(re===Ee)return;const ze=[bc[Ee]];Se&&ze.push(bc[he]),Z=S.useProgram("terrainRaster",null,ze),re=Ee},pe=S.colorModeForRenderPass(),_e=new s.DepthMode(j.LEQUAL,s.DepthMode.ReadWrite,S.depthRangeFor3D);el.update(z);const Y=S.transform,ce=Lf(Y.zoom)*A.exaggeration();(he?[!1,!0]:[!1]).forEach(Ee=>{re=-1;const Se=Ee?j.LINES:j.TRIANGLES,[ze,Ve]=Ee?A.getWirefameBuffer():[A.gridIndexBuffer,A.gridSegments];for(const Ne of O){const Ye=R.getTile(Ne),Xe=s.StencilMode.disabled,st=A.prevTerrainTileForTile[Ne.key],Ut=A.terrainTileForTile[Ne.key];Su(st,Ut)&&el.newMorphing(Ne.key,st,Ut,z,250),$.activeTexture.set(j.TEXTURE0),Ye.texture.bind(j.LINEAR,j.CLAMP_TO_EDGE,j.LINEAR_MIPMAP_NEAREST);const nt=el.getMorphValuesForProxy(Ne.key),wt=nt?1:0;let dt;nt&&(dt={morphing:{srcDemTile:nt.from,dstDemTile:nt.to,phase:s.easeCubicInOut(nt.phase)}});const Bt=Tu(Ne.projMatrix,U_(Ne.canonical,Y.renderWorldCopies)?ce/10:ce);ge(wt,Ee),A.setupElevationDraw(Ye,Z,dt),S.prepareDrawProgram($,Z,Ne.toUnwrapped()),Z.draw($,Se,_e,Xe,pe,s.CullFaceMode.backCCW,Bt,"terrain_raster",A.gridBuffer,ze,Ve)}})}}(m,this,this.proxySourceCache,h,this._updateTimestamp),this.renderingToTexture=!0,m.gpuTimingDeferredRenderEnd(),h.splice(0,h.length))}renderBatch(h){if(this._drapedRenderBatches.length===0)return h+1;this.renderingToTexture=!0;const m=this.painter,x=this.painter.context,S=this.proxySourceCache,A=this.proxiedCoords[S.id],R=this._drapedRenderBatches.shift(),O=[],z=m.style.order;let $=0;for(const j of A){const Z=S.getTileByID(j.proxyTileKey),re=S.proxyCachedFBO[j.key]?S.proxyCachedFBO[j.key][h]:void 0,he=re!==void 0?S.renderCache[re]:this.pool[$++],ge=re!==void 0;if(Z.texture=he.tex,ge&&!he.dirty){O.push(Z.tileID);continue}let pe;x.bindFramebuffer.set(he.fb.framebuffer),this.renderedToTile=!1,he.dirty&&(x.clear({color:s.Color.transparent,stencil:0}),he.dirty=!1);for(let _e=R.start;_e<=R.end;++_e){const Y=m.style._layers[z[_e]];if(Y.isHidden(m.transform.zoom))continue;const ce=m.style._getLayerSourceCache(Y),Ee=ce?this.proxyToSource[j.key][ce.id]:[j];if(!Ee)continue;const Se=Ee;x.viewport.set([0,0,he.fb.width,he.fb.height]),pe!==(ce?ce.id:null)&&(this._setupStencil(he,Ee,Y,ce),pe=ce?ce.id:null),m.renderLayer(m,ce,Y,Se)}this.renderedToTile?(he.dirty=!0,O.push(Z.tileID)):ge||--$,$===5&&($=0,this.renderToBackBuffer(O))}return this.renderToBackBuffer(O),this.renderingToTexture=!1,x.bindFramebuffer.set(null),x.viewport.set([0,0,m.width,m.height]),R.end+1}postRender(){}renderCacheEfficiency(h){const m=h.order.length;if(m===0)return{efficiency:100};let x,S=0,A=0,R=!1;for(let O=0;O<m;++O){const z=h._layers[h.order[O]];this._style.isLayerDraped(z)?(R&&++S,++A):R||(R=!0,x=z.id)}return A===0?{efficiency:100}:{efficiency:100*(1-S/A),firstUndrapedLayer:x}}getMinElevationBelowMSL(){let h=0;return this._visibleDemTiles.filter(m=>m.dem).forEach(m=>{h=Math.min(h,m.dem.tree.minimums[0])}),h===0?h:(h-30)*this._exaggeration}raycast(h,m,x){if(!this._visibleDemTiles)return null;const S=this._visibleDemTiles.filter(A=>A.dem).map(A=>{const R=A.tileID,O=1<<R.overscaledZ,{x:z,y:$}=R.canonical,j=z/O,Z=(z+1)/O,re=$/O,he=($+1)/O;return{minx:j,miny:re,maxx:Z,maxy:he,t:A.dem.tree.raycastRoot(j,re,Z,he,h,m,x),tile:A}});S.sort((A,R)=>(A.t!==null?A.t:Number.MAX_VALUE)-(R.t!==null?R.t:Number.MAX_VALUE));for(const A of S){if(A.t==null)return null;const R=A.tile.dem.tree.raycast(A.minx,A.miny,A.maxx,A.maxy,h,m,x);if(R!=null)return R}return null}_createFBO(){const h=this.painter.context,m=h.gl,x=this.drapeBufferSize;h.activeTexture.set(m.TEXTURE0);const S=new s.Texture(h,{width:x[0],height:x[1],data:null},m.RGBA);S.bind(m.LINEAR,m.CLAMP_TO_EDGE);const A=h.createFramebuffer(x[0],x[1],!1);return A.colorAttachment.set(S.texture),A.depthAttachment=new Ge(h,A.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=h.createRenderbuffer(h.gl.DEPTH_STENCIL,x[0],x[1]),this._stencilRef=0,A.depthAttachment.set(this._sharedDepthStencil),h.clear({stencil:0})):A.depthAttachment.set(this._sharedDepthStencil),h.extTextureFilterAnisotropic&&!h.extTextureFilterAnisotropicForceOff&&m.texParameterf(m.TEXTURE_2D,h.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,h.extTextureFilterAnisotropicMax),{fb:A,tex:S,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const h in this._style._sourceCaches)if(this._style._sourceCaches[h].hasTransition())return!0;return this._style.order.some(h=>{const m=this._style._layers[h],x=m.isHidden(this.painter.transform.zoom);return m.type==="custom"?!x&&m.shouldRedrape():!x&&m.hasTransition()})}_clearLineLayersFromRenderCache(){let h=!1;for(const x of this._style._getSources())if(x instanceof Xt){h=!0;break}if(!h)return;const m={};for(let x=0;x<this._style.order.length;++x){const S=this._style._layers[this._style.order[x]],A=this._style._getLayerSourceCache(S);if(A&&!m[A.id]&&!S.isHidden(this.painter.transform.zoom)&&S.type==="line"&&S.widthExpression()instanceof s.ZoomDependentExpression){m[A.id]=!0;for(const R of this.proxyCoords){const O=this.proxyToSource[R.key][A.id];if(O)for(const z of O)this._clearRenderCacheForTile(A.id,z)}}}}_clearRasterLayersFromRenderCache(){let h=!1;for(const x in this._style._sourceCaches)if(this._style._sourceCaches[x]._source instanceof Ft){h=!0;break}if(!h)return;const m={};for(let x=0;x<this._style.order.length;++x){const S=this._style._layers[this._style.order[x]],A=this._style._getLayerSourceCache(S);if(!A||m[A.id]||S.isHidden(this.painter.transform.zoom)||S.type!=="raster")continue;const R=S.paint.get("raster-fade-duration");for(const O of this.proxyCoords){const z=this.proxyToSource[O.key][A.id];if(z)for(const $ of z){const j=fg(A.getTile($),A.findLoadedParent($,0),A,this.painter.transform,R);(j.opacity!==1||j.mix!==0)&&this._clearRenderCacheForTile(A.id,$)}}}}_setupDrapedRenderBatches(){const h=this._style.order,m=h.length;if(m===0)return;const x=[];let S,A=0,R=this._style._layers[h[A]];for(;!this._style.isLayerDraped(R)&&R.isHidden(this.painter.transform.zoom)&&++A<m;)R=this._style._layers[h[A]];for(;A<m;++A){const O=this._style._layers[h[A]];O.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(O)?S===void 0&&(S=A):S!==void 0&&(x.push({start:S,end:A-1}),S=void 0))}S!==void 0&&x.push({start:S,end:A-1}),this._drapedRenderBatches=x}_setupRenderCache(h){const m=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,m.renderCache.length>m.renderCachePool.length){const R=Object.values(m.proxyCachedFBO);m.proxyCachedFBO={};for(let O=0;O<R.length;++O){const z=Object.values(R[O]);m.renderCachePool.push(...z)}}return}this._clearRasterLayersFromRenderCache();const x=this.proxyCoords,S=this._tilesDirty;for(let R=x.length-1;R>=0;R--){const O=x[R];if(m.getTileByID(O.key),m.proxyCachedFBO[O.key]!==void 0){const z=h[O.key],$=this.proxyToSource[O.key];let j=0;for(const Z in $){const re=$[Z],he=z[Z];if(!he||he.length!==re.length||re.some((ge,pe)=>ge!==he[pe]||S[Z]&&S[Z].hasOwnProperty(ge.key))){j=-1;break}++j}for(const Z in m.proxyCachedFBO[O.key])m.renderCache[m.proxyCachedFBO[O.key][Z]].dirty=j<0||j!==Object.values(z).length}}const A=[...this._drapedRenderBatches];A.sort((R,O)=>O.end-O.start-(R.end-R.start));for(const R of A)for(const O of x){if(m.proxyCachedFBO[O.key])continue;let z=m.renderCachePool.pop();z===void 0&&m.renderCache.length<50&&(z=m.renderCache.length,m.renderCache.push(this._createFBO())),z!==void 0&&(m.proxyCachedFBO[O.key]={},m.proxyCachedFBO[O.key][R.start]=z,m.renderCache[z].dirty=!0)}this._tilesDirty={}}_setupStencil(h,m,x,S){if(!S||!this._sourceTilesOverlap[S.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const A=this.painter.context,R=A.gl;if(m.length<=1)return void(this._overlapStencilType=!1);let O;if(x.isTileClipped())O=m.length,this._overlapStencilMode.test={func:R.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(m[0].overscaledZ>m[m.length-1].overscaledZ))return void(this._overlapStencilType=!1);O=1,this._overlapStencilMode.test={func:R.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+O>255&&(A.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=O,this._overlapStencilMode.ref=this._stencilRef,x.isTileClipped()&&this._renderTileClippingMasks(m,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(h){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[h.key]),this._overlapStencilMode):s.StencilMode.disabled}_renderTileClippingMasks(h,m){const x=this.painter,S=this.painter.context,A=S.gl;x._tileClippingMaskIDs={},S.setColorMode(s.ColorMode.disabled),S.setDepthMode(s.DepthMode.disabled);const R=x.useProgram("clippingMask");for(const O of h){const z=x._tileClippingMaskIDs[O.key]=--m;R.draw(S,A.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:A.ALWAYS,mask:0},z,255,A.KEEP,A.KEEP,A.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,Xh(O.projMatrix),"$clipping",x.tileExtentBuffer,x.quadTriangleIndexBuffer,x.tileExtentSegments)}}pointCoordinate(h){const m=this.painter.transform;if(h.x<0||h.x>m.width||h.y<0||h.y>m.height)return null;const x=[h.x,h.y,1,1];s.transformMat4$1(x,x,m.pixelMatrixInverse),s.scale$1(x,x,1/x[3]),x[0]/=m.worldSize,x[1]/=m.worldSize;const S=m._camera.position,A=s.mercatorZfromAltitude(1,m.center.lat),R=[S[0],S[1],S[2]/A,0],O=s.subtract([],x.slice(0,3),R);s.normalize(O,O);const z=this.raycast(R,O,this._exaggeration);return z!==null&&z?(s.scaleAndAdd(R,R,O,z),R[3]=R[2],R[2]*=A,R):null}drawDepth(){const h=this.painter,m=h.context,x=this.proxySourceCache,S=Math.ceil(h.width),A=Math.ceil(h.height);if(!this._depthFBO||this._depthFBO.width===S&&this._depthFBO.height===A||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const R=m.gl,O=m.createFramebuffer(S,A,!0);m.activeTexture.set(R.TEXTURE0);const z=new s.Texture(m,{width:S,height:A,data:null},R.RGBA);z.bind(R.NEAREST,R.CLAMP_TO_EDGE),O.colorAttachment.set(z.texture);const $=m.createRenderbuffer(m.gl.DEPTH_COMPONENT16,S,A);O.depthAttachment.set($),this._depthFBO=O,this._depthTexture=z}m.bindFramebuffer.set(this._depthFBO.framebuffer),m.viewport.set([0,0,S,A]),function(R,O,z,$){if(R.transform.projection.name==="globe")return;const j=R.context,Z=j.gl;j.clear({depth:1});const re=R.useProgram("terrainDepth"),he=new s.DepthMode(Z.LESS,s.DepthMode.ReadWrite,R.depthRangeFor3D);for(const ge of $){const pe=z.getTile(ge),_e=Tu(ge.projMatrix,0);O.setupElevationDraw(pe,re),re.draw(j,Z.TRIANGLES,he,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.backCCW,_e,"terrain_depth",O.gridBuffer,O.gridIndexBuffer,O.gridNoSkirtSegments)}}(h,this,x,this.proxyCoords)}_setupProxiedCoordsForOrtho(h,m,x){if(h.getSource()instanceof ci)return this._setupProxiedCoordsForImageSource(h,m,x);this._findCoveringTileCache[h.id]=this._findCoveringTileCache[h.id]||{};const S=this.proxiedCoords[h.id]=[],A=this.proxyCoords;for(let O=0;O<A.length;O++){const z=A[O],$=this._findTileCoveringTileID(z,h);if($){const j=this._createProxiedId(z,$,x[z.key]&&x[z.key][h.id]);S.push(j),this.proxyToSource[z.key][h.id]=[j]}}let R=!1;for(let O=0;O<m.length;O++){const z=h.getTile(m[O]);if(!z||!z.hasData())continue;const $=this._findTileCoveringTileID(z.tileID,this.proxySourceCache);if($&&$.tileID.canonical.z!==z.tileID.canonical.z){const j=this.proxyToSource[$.tileID.key][h.id],Z=this._createProxiedId($.tileID,z,x[$.tileID.key]&&x[$.tileID.key][h.id]);j?j.splice(j.length-1,0,Z):this.proxyToSource[$.tileID.key][h.id]=[Z],S.push(Z),R=!0}}this._sourceTilesOverlap[h.id]=R}_setupProxiedCoordsForImageSource(h,m,x){if(!h.getSource().loaded())return;const S=this.proxiedCoords[h.id]=[],A=this.proxyCoords,R=h.getSource(),O=new s.Point(R.tileID.x,R.tileID.y)._div(1<<R.tileID.z),z=R.coordinates.map(s.MercatorCoordinate.fromLngLat).reduce((j,Z)=>(j.min.x=Math.min(j.min.x,Z.x-O.x),j.min.y=Math.min(j.min.y,Z.y-O.y),j.max.x=Math.max(j.max.x,Z.x-O.x),j.max.y=Math.max(j.max.y,Z.y-O.y),j),{min:new s.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new s.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),$=(j,Z)=>{const re=j.wrap+j.canonical.x/(1<<j.canonical.z),he=j.canonical.y/(1<<j.canonical.z),ge=s.EXTENT/(1<<j.canonical.z),pe=Z.wrap+Z.canonical.x/(1<<Z.canonical.z),_e=Z.canonical.y/(1<<Z.canonical.z);return re+ge<pe+z.min.x||re>pe+z.max.x||he+ge<_e+z.min.y||he>_e+z.max.y};for(let j=0;j<A.length;j++){const Z=A[j];for(let re=0;re<m.length;re++){const he=h.getTile(m[re]);if(!he||!he.hasData()||$(Z,he.tileID))continue;const ge=this._createProxiedId(Z,he,x[Z.key]&&x[Z.key][h.id]),pe=this.proxyToSource[Z.key][h.id];pe?pe.push(ge):this.proxyToSource[Z.key][h.id]=[ge],S.push(ge)}}}_createProxiedId(h,m,x){let S=this.orthoMatrix;if(x){const A=x.find(R=>R.key===m.tileID.key);if(A)return A}if(m.tileID.key!==h.key){const A=h.canonical.z-m.tileID.canonical.z;let R,O,z;S=s.create();const $=m.tileID.wrap-h.wrap<<h.overscaledZ;A>0?(R=s.EXTENT>>A,O=R*((m.tileID.canonical.x<<A)-h.canonical.x+$),z=R*((m.tileID.canonical.y<<A)-h.canonical.y)):(R=s.EXTENT<<-A,O=s.EXTENT*(m.tileID.canonical.x-(h.canonical.x+$<<-A)),z=s.EXTENT*(m.tileID.canonical.y-(h.canonical.y<<-A))),s.ortho(S,0,R,0,R,0,1),s.translate(S,S,[O,z,0])}return new Df(m.tileID,h.key,S)}_findTileCoveringTileID(h,m){let x=m.getTile(h);if(x&&x.hasData())return x;const S=this._findCoveringTileCache[m.id],A=S[h.key];if(x=A?m.getTileByID(A):null,x&&x.hasData()||A===null)return x;let R=x?x.tileID:h,O=R.overscaledZ;const z=m.getSource().minzoom,$=[];if(!A){const Z=m.getSource().maxzoom;if(h.canonical.z>=Z){const re=h.canonical.z-Z;m.getSource().reparseOverscaled?(O=Math.max(h.canonical.z+2,m.transform.tileZoom),R=new s.OverscaledTileID(O,h.wrap,Z,h.canonical.x>>re,h.canonical.y>>re)):re!==0&&(O=Z,R=new s.OverscaledTileID(O,h.wrap,Z,h.canonical.x>>re,h.canonical.y>>re))}R.key!==h.key&&($.push(R.key),x=m.getTile(R))}const j=Z=>{$.forEach(re=>{S[re]=Z}),$.length=0};for(O-=1;O>=z&&(!x||!x.hasData());O--){x&&j(x.tileID.key);const Z=R.calculateScaledKey(O);if(x=m.getTileByID(Z),x&&x.hasData())break;const re=S[Z];if(re===null)break;re===void 0?$.push(Z):x=m.getTileByID(re)}return j(x?x.tileID.key:null),x&&x.hasData()?x:null}findDEMTileFor(h){return this.enabled?this._findTileCoveringTileID(h,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(h,m){let x=this._tilesDirty[h];x||(x=this._tilesDirty[h]={}),x[m.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const h=function(m){let x=0;const S=new s.StructArrayLayout2ui4,A=131;for(let R=1;R<129;R++){for(let O=1;O<129;O++)x=R*A+O,S.emplaceBack(x,x+1),S.emplaceBack(x,x+A),S.emplaceBack(x+1,x+A),R===128&&S.emplaceBack(x+A,x+A+1);S.emplaceBack(x+1,x+1+A)}return S}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(h),this.wireframeSegments=s.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,h.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Ci{static cacheKey(h,m,x,S){let A=`${m}${S?S.cacheKey:""}`;for(const R of x)h.usedDefines.includes(R)&&(A+=`/${R}`);return A}constructor(h,m,x,S,A,R){const O=h.gl;this.program=O.createProgram();const z=function(Y){const ce=[];for(let Ee=0;Ee<Y.length;Ee++){if(Y[Ee]===null)continue;const Se=Y[Ee].split(" ");ce.push(Se.pop())}return ce}(x.staticAttributes),$=S?S.getBinderAttributes():[],j=z.concat($);let Z=S?S.defines():[];Z=Z.concat(R.map(Y=>`#define ${Y}`));const re=h.isWebGL2?`#version 300 es
`:"",he=re+Z.concat(h.extStandardDerivatives&&re.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(lg):lg,lg,Mf,B_.fragmentSource,wu.fragmentSource,x.fragmentSource).join(`
`),ge=re+Z.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Mf,B_.vertexSource,wu.vertexSource,If.vertexSource,x.vertexSource).join(`
`),pe=O.createShader(O.FRAGMENT_SHADER);if(O.isContextLost())return void(this.failedToCreate=!0);O.shaderSource(pe,he),O.compileShader(pe),O.attachShader(this.program,pe);const _e=O.createShader(O.VERTEX_SHADER);if(O.isContextLost())this.failedToCreate=!0;else{O.shaderSource(_e,ge),O.compileShader(_e),O.attachShader(this.program,_e),this.attributes={},this.numAttributes=j.length;for(let Y=0;Y<this.numAttributes;Y++)j[Y]&&(O.bindAttribLocation(this.program,Y,j[Y]),this.attributes[j[Y]]=Y);O.linkProgram(this.program),O.deleteShader(_e),O.deleteShader(pe),this.fixedUniforms=A(h),this.binderUniforms=S?S.getUniforms(h):[],R.includes("TERRAIN")&&(this.terrainUniforms=(Y=>({u_dem:new s.Uniform1i(Y),u_dem_prev:new s.Uniform1i(Y),u_dem_unpack:new s.Uniform4f(Y),u_dem_tl:new s.Uniform2f(Y),u_dem_scale:new s.Uniform1f(Y),u_dem_tl_prev:new s.Uniform2f(Y),u_dem_scale_prev:new s.Uniform1f(Y),u_dem_size:new s.Uniform1f(Y),u_dem_lerp:new s.Uniform1f(Y),u_exaggeration:new s.Uniform1f(Y),u_depth:new s.Uniform1i(Y),u_depth_size_inv:new s.Uniform2f(Y),u_meter_to_dem:new s.Uniform1f(Y),u_label_plane_matrix_inv:new s.UniformMatrix4f(Y)}))(h)),R.includes("GLOBE")&&(this.globeUniforms=(Y=>({u_tile_tl_up:new s.Uniform3f(Y),u_tile_tr_up:new s.Uniform3f(Y),u_tile_br_up:new s.Uniform3f(Y),u_tile_bl_up:new s.Uniform3f(Y),u_tile_up_scale:new s.Uniform1f(Y)}))(h)),R.includes("FOG")&&(this.fogUniforms=(Y=>({u_fog_matrix:new s.UniformMatrix4f(Y),u_fog_range:new s.Uniform2f(Y),u_fog_color:new s.Uniform4f(Y),u_fog_horizon_blend:new s.Uniform1f(Y),u_fog_temporal_offset:new s.Uniform1f(Y),u_frustum_tl:new s.Uniform3f(Y),u_frustum_tr:new s.Uniform3f(Y),u_frustum_br:new s.Uniform3f(Y),u_frustum_bl:new s.Uniform3f(Y),u_globe_pos:new s.Uniform3f(Y),u_globe_radius:new s.Uniform1f(Y),u_globe_transition:new s.Uniform1f(Y),u_is_globe:new s.Uniform1i(Y),u_viewport:new s.Uniform2f(Y)}))(h))}}setTerrainUniformValues(h,m){if(!this.terrainUniforms)return;const x=this.terrainUniforms;if(!this.failedToCreate){h.program.set(this.program);for(const S in m)x[S]&&x[S].set(this.program,S,m[S])}}setGlobeUniformValues(h,m){if(!this.globeUniforms)return;const x=this.globeUniforms;if(!this.failedToCreate){h.program.set(this.program);for(const S in m)x[S]&&x[S].set(this.program,S,m[S])}}setFogUniformValues(h,m){if(!this.fogUniforms)return;const x=this.fogUniforms;if(!this.failedToCreate){h.program.set(this.program);for(const S in m)x[S].set(this.program,S,m[S])}}draw(h,m,x,S,A,R,O,z,$,j,Z,re,he,ge,pe){const _e=h.gl;if(this.failedToCreate)return;h.program.set(this.program),h.setDepthMode(x),h.setStencilMode(S),h.setColorMode(A),h.setCullFace(R);for(const ce of Object.keys(this.fixedUniforms))this.fixedUniforms[ce].set(this.program,ce,O[ce]);ge&&ge.setUniforms(this.program,h,this.binderUniforms,re,{zoom:he});const Y={[_e.LINES]:2,[_e.TRIANGLES]:3,[_e.LINE_STRIP]:1}[m];for(const ce of Z.get()){const Ee=ce.vaos||(ce.vaos={});(Ee[z]||(Ee[z]=new dE)).bind(h,this,$,ge?ge.getPaintVertexBuffers():[],j,ce.vertexOffset,pe||[]),_e.drawElements(m,ce.primitiveLength*Y,_e.UNSIGNED_SHORT,ce.primitiveOffset*Y*2)}}}function Zh(_,h){const m=Math.pow(2,h.tileID.overscaledZ),x=h.tileSize*Math.pow(2,_.transform.tileZoom)/m,S=x*(h.tileID.canonical.x+h.tileID.wrap*m),A=x*h.tileID.canonical.y;return{u_image:0,u_texsize:h.imageAtlasTexture.size,u_tile_units_to_pixels:1/pn(h,1,_.transform.tileZoom),u_pixel_coord_upper:[S>>16,A>>16],u_pixel_coord_lower:[65535&S,65535&A]}}const V_=s.create(),gg=(_,h,m,x,S,A,R,O,z,$,j)=>{const Z=h.style.light,re=Z.properties.get("position"),he=[re.x,re.y,re.z],ge=s.create$1();Z.properties.get("anchor")==="viewport"&&(s.fromRotation(ge,-h.transform.angle),s.transformMat3(he,he,ge));const pe=Z.properties.get("color"),_e=h.transform,Y={u_matrix:_,u_lightpos:he,u_lightintensity:Z.properties.get("intensity"),u_lightcolor:[pe.r,pe.g,pe.b],u_vertical_gradient:+m,u_opacity:x,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:V_,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:S,u_edge_radius:A};return _e.projection.name==="globe"&&(Y.u_tile_id=[R.canonical.x,R.canonical.y,1<<R.canonical.z],Y.u_zoom_transition=z,Y.u_inv_rot_matrix=j,Y.u_merc_center=$,Y.u_up_dir=_e.projection.upVector(new s.CanonicalTileID(0,0,0),$[0]*s.EXTENT,$[1]*s.EXTENT),Y.u_height_lift=O),Y},j_=(_,h,m,x,S,A,R,O,z,$,j,Z)=>{const re=gg(_,h,m,x,S,A,R,z,$,j,Z),he={u_height_factor:-Math.pow(2,R.overscaledZ)/O.tileSize/8};return s.extend(re,Zh(h,O),he)},xc=_=>({u_matrix:_}),yg=(_,h,m)=>s.extend(xc(_),Zh(h,m)),fE=(_,h)=>({u_matrix:_,u_world:h}),pE=(_,h,m,x)=>s.extend(yg(_,h,m),{u_world:x}),mE=s.create(),vg=(_,h,m,x,S,A)=>{const R=_.transform,O=R.projection.name==="globe";let z;if(A.paint.get("circle-pitch-alignment")==="map")if(O){const j=s.globePixelsToTileUnits(R.zoom,h.canonical)*R._pixelsPerMercatorPixel;z=Float32Array.from([j,0,0,j])}else z=R.calculatePixelsToTileUnitsMatrix(m);else z=new Float32Array([R.pixelsToGLUnits[0],0,0,R.pixelsToGLUnits[1]]);const $={u_camera_to_center_distance:R.cameraToCenterDistance,u_matrix:_.translatePosMatrix(h.projMatrix,m,A.paint.get("circle-translate"),A.paint.get("circle-translate-anchor")),u_device_pixel_ratio:s.exported.devicePixelRatio,u_extrude_scale:z,u_inv_rot_matrix:mE,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(O){$.u_inv_rot_matrix=x,$.u_merc_center=S,$.u_tile_id=[h.canonical.x,h.canonical.y,1<<h.canonical.z],$.u_zoom_transition=s.globeToMercatorTransition(R.zoom);const j=S[0]*s.EXTENT,Z=S[1]*s.EXTENT;$.u_up_dir=R.projection.upVector(new s.CanonicalTileID(0,0,0),j,Z)}return $},_g=_=>{const h=[];return _.paint.get("circle-pitch-alignment")==="map"&&h.push("PITCH_WITH_MAP"),_.paint.get("circle-pitch-scale")==="map"&&h.push("SCALE_WITH_MAP"),h},bg=(_,h,m,x)=>{const S=s.EXTENT/m.tileSize;return{u_matrix:_,u_camera_to_center_distance:h.getCameraToCenterDistance(x),u_extrude_scale:[h.pixelsToGLUnits[0]/S,h.pixelsToGLUnits[1]/S]}},kf=(_,h,m=1)=>({u_matrix:_,u_color:h,u_overlay:0,u_overlay_scale:m}),$_=s.create(),G_=(_,h,m,x,S,A,R)=>{const O=_.transform,z=O.projection.name==="globe",$=z?s.globePixelsToTileUnits(O.zoom,h.canonical)*O._pixelsPerMercatorPixel:pn(m,1,A),j={u_matrix:h.projMatrix,u_extrude_scale:$,u_intensity:R,u_inv_rot_matrix:$_,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(z){j.u_inv_rot_matrix=x,j.u_merc_center=S,j.u_tile_id=[h.canonical.x,h.canonical.y,1<<h.canonical.z],j.u_zoom_transition=s.globeToMercatorTransition(O.zoom);const Z=S[0]*s.EXTENT,re=S[1]*s.EXTENT;j.u_up_dir=O.projection.upVector(new s.CanonicalTileID(0,0,0),Z,re)}return j},gE=(_,h,m,x,S,A,R)=>{const O=_.transform,z=O.calculatePixelsToTileUnitsMatrix(h);return{u_matrix:xg(_,h,m,x),u_pixels_to_tile_units:z,u_device_pixel_ratio:A,u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:S,u_texsize:Yh(m)?h.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Cu(h,_.transform),u_alpha_discard_threshold:0,u_trim_offset:R}},qh=(_,h,m,x,S)=>{const A=_.transform;return{u_matrix:xg(_,h,m,x),u_texsize:h.imageAtlasTexture.size,u_pixels_to_tile_units:A.calculatePixelsToTileUnitsMatrix(h),u_device_pixel_ratio:S,u_image:0,u_tile_units_to_pixels:Cu(h,A),u_units_to_pixels:[1/A.pixelsToGLUnits[0],1/A.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Cu(_,h){return 1/pn(_,1,h.tileZoom)}function xg(_,h,m,x){return _.translatePosMatrix(x||h.tileID.projMatrix,h,m.paint.get("line-translate"),m.paint.get("line-translate-anchor"))}function Yh(_){const h=_.paint.get("line-dasharray").value;return h.value||h.kind!=="constant"}const wg=(_,h,m,x,S,A)=>{return{u_matrix:_,u_tl_parent:h,u_scale_parent:m,u_fade_t:x.mix,u_opacity:x.opacity*S.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:S.paint.get("raster-brightness-min"),u_brightness_high:S.paint.get("raster-brightness-max"),u_saturation_factor:(O=S.paint.get("raster-saturation"),O>0?1-1/(1.001-O):-O),u_contrast_factor:(R=S.paint.get("raster-contrast"),R>0?1/(1-R):1+R),u_spin_weights:Pa(S.paint.get("raster-hue-rotate")),u_perspective_transform:A};var R,O};function Pa(_){_*=Math.PI/180;const h=Math.sin(_),m=Math.cos(_);return[(2*m+1)/3,(-Math.sqrt(3)*h-m+1)/3,(Math.sqrt(3)*h-m+1)/3]}const Ff=s.create(),Eg=(_,h,m,x,S,A,R,O,z,$,j,Z,re,he,ge,pe)=>{const _e=S.transform,Y={u_is_size_zoom_constant:+(_==="constant"||_==="source"),u_is_size_feature_constant:+(_==="constant"||_==="camera"),u_size_t:h?h.uSizeT:0,u_size:h?h.uSize:0,u_camera_to_center_distance:_e.cameraToCenterDistance,u_rotate_symbol:+m,u_aspect_ratio:_e.width/_e.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_matrix:A,u_label_plane_matrix:R,u_coord_matrix:O,u_is_text:+z,u_pitch_with_map:+x,u_texsize:$,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Ff,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Ff,u_up_vector:[0,-1,0]};return pe.name==="globe"&&(Y.u_tile_id=[j.canonical.x,j.canonical.y,1<<j.canonical.z],Y.u_zoom_transition=Z,Y.u_inv_rot_matrix=he,Y.u_merc_center=re,Y.u_camera_forward=_e._camera.forward(),Y.u_ecef_origin=s.globeECEFOrigin(_e.globeMatrix,j.toUnwrapped()),Y.u_tile_matrix=Float32Array.from(_e.globeMatrix),Y.u_up_vector=ge),Y},Bf=(_,h,m,x,S,A,R,O,z,$,j,Z,re,he,ge,pe,_e)=>s.extend(Eg(_,h,m,x,S,A,R,O,z,$,Z,re,he,ge,pe,_e),{u_gamma_scale:x?S.transform.cameraToCenterDistance*Math.cos(S.terrain?0:S.transform._pitch):1,u_device_pixel_ratio:s.exported.devicePixelRatio,u_is_halo:+j}),H_=(_,h,m,x,S,A,R,O,z,$,j,Z,re,he,ge,pe)=>s.extend(Bf(_,h,m,x,S,A,R,O,!0,z,!0,j,Z,re,he,ge,pe),{u_texsize_icon:$,u_texture_icon:1}),Tg=(_,h,m)=>({u_matrix:_,u_opacity:h,u_color:m}),yE=(_,h,m,x,S)=>s.extend(function(A,R,O){const z=R.imageManager.getPattern(A.toString()),{width:$,height:j}=R.imageManager.getPixelSize(),Z=Math.pow(2,O.tileID.overscaledZ),re=O.tileSize*Math.pow(2,R.transform.tileZoom)/Z,he=re*(O.tileID.canonical.x+O.tileID.wrap*Z),ge=re*O.tileID.canonical.y;return{u_image:0,u_pattern_tl:z.tl,u_pattern_br:z.br,u_texsize:[$,j],u_pattern_size:z.displaySize,u_tile_units_to_pixels:1/pn(O,1,R.transform.tileZoom),u_pixel_coord_upper:[he>>16,ge>>16],u_pixel_coord_lower:[65535&he,65535&ge]}}(x,m,S),{u_matrix:_,u_opacity:h}),Sg={fillExtrusion:_=>({u_matrix:new s.UniformMatrix4f(_),u_lightpos:new s.Uniform3f(_),u_lightintensity:new s.Uniform1f(_),u_lightcolor:new s.Uniform3f(_),u_vertical_gradient:new s.Uniform1f(_),u_opacity:new s.Uniform1f(_),u_edge_radius:new s.Uniform1f(_),u_ao:new s.Uniform2f(_),u_tile_id:new s.Uniform3f(_),u_zoom_transition:new s.Uniform1f(_),u_inv_rot_matrix:new s.UniformMatrix4f(_),u_merc_center:new s.Uniform2f(_),u_up_dir:new s.Uniform3f(_),u_height_lift:new s.Uniform1f(_)}),fillExtrusionPattern:_=>({u_matrix:new s.UniformMatrix4f(_),u_lightpos:new s.Uniform3f(_),u_lightintensity:new s.Uniform1f(_),u_lightcolor:new s.Uniform3f(_),u_vertical_gradient:new s.Uniform1f(_),u_height_factor:new s.Uniform1f(_),u_edge_radius:new s.Uniform1f(_),u_ao:new s.Uniform2f(_),u_tile_id:new s.Uniform3f(_),u_zoom_transition:new s.Uniform1f(_),u_inv_rot_matrix:new s.UniformMatrix4f(_),u_merc_center:new s.Uniform2f(_),u_up_dir:new s.Uniform3f(_),u_height_lift:new s.Uniform1f(_),u_image:new s.Uniform1i(_),u_texsize:new s.Uniform2f(_),u_pixel_coord_upper:new s.Uniform2f(_),u_pixel_coord_lower:new s.Uniform2f(_),u_tile_units_to_pixels:new s.Uniform1f(_),u_opacity:new s.Uniform1f(_)}),fill:_=>({u_matrix:new s.UniformMatrix4f(_)}),fillPattern:_=>({u_matrix:new s.UniformMatrix4f(_),u_image:new s.Uniform1i(_),u_texsize:new s.Uniform2f(_),u_pixel_coord_upper:new s.Uniform2f(_),u_pixel_coord_lower:new s.Uniform2f(_),u_tile_units_to_pixels:new s.Uniform1f(_)}),fillOutline:_=>({u_matrix:new s.UniformMatrix4f(_),u_world:new s.Uniform2f(_)}),fillOutlinePattern:_=>({u_matrix:new s.UniformMatrix4f(_),u_world:new s.Uniform2f(_),u_image:new s.Uniform1i(_),u_texsize:new s.Uniform2f(_),u_pixel_coord_upper:new s.Uniform2f(_),u_pixel_coord_lower:new s.Uniform2f(_),u_tile_units_to_pixels:new s.Uniform1f(_)}),circle:_=>({u_camera_to_center_distance:new s.Uniform1f(_),u_extrude_scale:new s.UniformMatrix2f(_),u_device_pixel_ratio:new s.Uniform1f(_),u_matrix:new s.UniformMatrix4f(_),u_inv_rot_matrix:new s.UniformMatrix4f(_),u_merc_center:new s.Uniform2f(_),u_tile_id:new s.Uniform3f(_),u_zoom_transition:new s.Uniform1f(_),u_up_dir:new s.Uniform3f(_)}),collisionBox:_=>({u_matrix:new s.UniformMatrix4f(_),u_camera_to_center_distance:new s.Uniform1f(_),u_extrude_scale:new s.Uniform2f(_)}),collisionCircle:_=>({u_matrix:new s.UniformMatrix4f(_),u_inv_matrix:new s.UniformMatrix4f(_),u_camera_to_center_distance:new s.Uniform1f(_),u_viewport_size:new s.Uniform2f(_)}),debug:_=>({u_color:new s.UniformColor(_),u_matrix:new s.UniformMatrix4f(_),u_overlay:new s.Uniform1i(_),u_overlay_scale:new s.Uniform1f(_)}),clippingMask:_=>({u_matrix:new s.UniformMatrix4f(_)}),heatmap:_=>({u_extrude_scale:new s.Uniform1f(_),u_intensity:new s.Uniform1f(_),u_matrix:new s.UniformMatrix4f(_),u_inv_rot_matrix:new s.UniformMatrix4f(_),u_merc_center:new s.Uniform2f(_),u_tile_id:new s.Uniform3f(_),u_zoom_transition:new s.Uniform1f(_),u_up_dir:new s.Uniform3f(_)}),heatmapTexture:_=>({u_image:new s.Uniform1i(_),u_color_ramp:new s.Uniform1i(_),u_opacity:new s.Uniform1f(_)}),hillshade:_=>({u_matrix:new s.UniformMatrix4f(_),u_image:new s.Uniform1i(_),u_latrange:new s.Uniform2f(_),u_light:new s.Uniform2f(_),u_shadow:new s.UniformColor(_),u_highlight:new s.UniformColor(_),u_accent:new s.UniformColor(_)}),hillshadePrepare:_=>({u_matrix:new s.UniformMatrix4f(_),u_image:new s.Uniform1i(_),u_dimension:new s.Uniform2f(_),u_zoom:new s.Uniform1f(_),u_unpack:new s.Uniform4f(_)}),line:_=>({u_matrix:new s.UniformMatrix4f(_),u_pixels_to_tile_units:new s.UniformMatrix2f(_),u_device_pixel_ratio:new s.Uniform1f(_),u_units_to_pixels:new s.Uniform2f(_),u_dash_image:new s.Uniform1i(_),u_gradient_image:new s.Uniform1i(_),u_image_height:new s.Uniform1f(_),u_texsize:new s.Uniform2f(_),u_tile_units_to_pixels:new s.Uniform1f(_),u_alpha_discard_threshold:new s.Uniform1f(_),u_trim_offset:new s.Uniform2f(_)}),linePattern:_=>({u_matrix:new s.UniformMatrix4f(_),u_texsize:new s.Uniform2f(_),u_pixels_to_tile_units:new s.UniformMatrix2f(_),u_device_pixel_ratio:new s.Uniform1f(_),u_image:new s.Uniform1i(_),u_units_to_pixels:new s.Uniform2f(_),u_tile_units_to_pixels:new s.Uniform1f(_),u_alpha_discard_threshold:new s.Uniform1f(_)}),raster:_=>({u_matrix:new s.UniformMatrix4f(_),u_tl_parent:new s.Uniform2f(_),u_scale_parent:new s.Uniform1f(_),u_fade_t:new s.Uniform1f(_),u_opacity:new s.Uniform1f(_),u_image0:new s.Uniform1i(_),u_image1:new s.Uniform1i(_),u_brightness_low:new s.Uniform1f(_),u_brightness_high:new s.Uniform1f(_),u_saturation_factor:new s.Uniform1f(_),u_contrast_factor:new s.Uniform1f(_),u_spin_weights:new s.Uniform3f(_),u_perspective_transform:new s.Uniform2f(_)}),symbolIcon:_=>({u_is_size_zoom_constant:new s.Uniform1i(_),u_is_size_feature_constant:new s.Uniform1i(_),u_size_t:new s.Uniform1f(_),u_size:new s.Uniform1f(_),u_camera_to_center_distance:new s.Uniform1f(_),u_rotate_symbol:new s.Uniform1i(_),u_aspect_ratio:new s.Uniform1f(_),u_fade_change:new s.Uniform1f(_),u_matrix:new s.UniformMatrix4f(_),u_label_plane_matrix:new s.UniformMatrix4f(_),u_coord_matrix:new s.UniformMatrix4f(_),u_is_text:new s.Uniform1i(_),u_pitch_with_map:new s.Uniform1i(_),u_texsize:new s.Uniform2f(_),u_tile_id:new s.Uniform3f(_),u_zoom_transition:new s.Uniform1f(_),u_inv_rot_matrix:new s.UniformMatrix4f(_),u_merc_center:new s.Uniform2f(_),u_camera_forward:new s.Uniform3f(_),u_tile_matrix:new s.UniformMatrix4f(_),u_up_vector:new s.Uniform3f(_),u_ecef_origin:new s.Uniform3f(_),u_texture:new s.Uniform1i(_)}),symbolSDF:_=>({u_is_size_zoom_constant:new s.Uniform1i(_),u_is_size_feature_constant:new s.Uniform1i(_),u_size_t:new s.Uniform1f(_),u_size:new s.Uniform1f(_),u_camera_to_center_distance:new s.Uniform1f(_),u_rotate_symbol:new s.Uniform1i(_),u_aspect_ratio:new s.Uniform1f(_),u_fade_change:new s.Uniform1f(_),u_matrix:new s.UniformMatrix4f(_),u_label_plane_matrix:new s.UniformMatrix4f(_),u_coord_matrix:new s.UniformMatrix4f(_),u_is_text:new s.Uniform1i(_),u_pitch_with_map:new s.Uniform1i(_),u_texsize:new s.Uniform2f(_),u_texture:new s.Uniform1i(_),u_gamma_scale:new s.Uniform1f(_),u_device_pixel_ratio:new s.Uniform1f(_),u_tile_id:new s.Uniform3f(_),u_zoom_transition:new s.Uniform1f(_),u_inv_rot_matrix:new s.UniformMatrix4f(_),u_merc_center:new s.Uniform2f(_),u_camera_forward:new s.Uniform3f(_),u_tile_matrix:new s.UniformMatrix4f(_),u_up_vector:new s.Uniform3f(_),u_ecef_origin:new s.Uniform3f(_),u_is_halo:new s.Uniform1i(_)}),symbolTextAndIcon:_=>({u_is_size_zoom_constant:new s.Uniform1i(_),u_is_size_feature_constant:new s.Uniform1i(_),u_size_t:new s.Uniform1f(_),u_size:new s.Uniform1f(_),u_camera_to_center_distance:new s.Uniform1f(_),u_rotate_symbol:new s.Uniform1i(_),u_aspect_ratio:new s.Uniform1f(_),u_fade_change:new s.Uniform1f(_),u_matrix:new s.UniformMatrix4f(_),u_label_plane_matrix:new s.UniformMatrix4f(_),u_coord_matrix:new s.UniformMatrix4f(_),u_is_text:new s.Uniform1i(_),u_pitch_with_map:new s.Uniform1i(_),u_texsize:new s.Uniform2f(_),u_texsize_icon:new s.Uniform2f(_),u_texture:new s.Uniform1i(_),u_texture_icon:new s.Uniform1i(_),u_gamma_scale:new s.Uniform1f(_),u_device_pixel_ratio:new s.Uniform1f(_),u_is_halo:new s.Uniform1i(_)}),background:_=>({u_matrix:new s.UniformMatrix4f(_),u_opacity:new s.Uniform1f(_),u_color:new s.UniformColor(_)}),backgroundPattern:_=>({u_matrix:new s.UniformMatrix4f(_),u_opacity:new s.Uniform1f(_),u_image:new s.Uniform1i(_),u_pattern_tl:new s.Uniform2f(_),u_pattern_br:new s.Uniform2f(_),u_texsize:new s.Uniform2f(_),u_pattern_size:new s.Uniform2f(_),u_pixel_coord_upper:new s.Uniform2f(_),u_pixel_coord_lower:new s.Uniform2f(_),u_tile_units_to_pixels:new s.Uniform1f(_)}),terrainRaster:dg,terrainDepth:dg,skybox:_=>({u_matrix:new s.UniformMatrix4f(_),u_sun_direction:new s.Uniform3f(_),u_cubemap:new s.Uniform1i(_),u_opacity:new s.Uniform1f(_),u_temporal_offset:new s.Uniform1f(_)}),skyboxGradient:_=>({u_matrix:new s.UniformMatrix4f(_),u_color_ramp:new s.Uniform1i(_),u_center_direction:new s.Uniform3f(_),u_radius:new s.Uniform1f(_),u_opacity:new s.Uniform1f(_),u_temporal_offset:new s.Uniform1f(_)}),skyboxCapture:_=>({u_matrix_3f:new s.UniformMatrix3f(_),u_sun_direction:new s.Uniform3f(_),u_sun_intensity:new s.Uniform1f(_),u_color_tint_r:new s.Uniform4f(_),u_color_tint_m:new s.Uniform4f(_),u_luminance:new s.Uniform1f(_)}),globeRaster:_=>({u_proj_matrix:new s.UniformMatrix4f(_),u_globe_matrix:new s.UniformMatrix4f(_),u_normalize_matrix:new s.UniformMatrix4f(_),u_merc_matrix:new s.UniformMatrix4f(_),u_zoom_transition:new s.Uniform1f(_),u_merc_center:new s.Uniform2f(_),u_image0:new s.Uniform1i(_),u_grid_matrix:new s.UniformMatrix3f(_),u_skirt_height:new s.Uniform1f(_),u_frustum_tl:new s.Uniform3f(_),u_frustum_tr:new s.Uniform3f(_),u_frustum_br:new s.Uniform3f(_),u_frustum_bl:new s.Uniform3f(_),u_globe_pos:new s.Uniform3f(_),u_globe_radius:new s.Uniform1f(_),u_viewport:new s.Uniform2f(_)}),globeAtmosphere:_=>({u_frustum_tl:new s.Uniform3f(_),u_frustum_tr:new s.Uniform3f(_),u_frustum_br:new s.Uniform3f(_),u_frustum_bl:new s.Uniform3f(_),u_horizon:new s.Uniform1f(_),u_transition:new s.Uniform1f(_),u_fadeout_range:new s.Uniform1f(_),u_color:new s.Uniform4f(_),u_high_color:new s.Uniform4f(_),u_space_color:new s.Uniform4f(_),u_star_intensity:new s.Uniform1f(_),u_star_density:new s.Uniform1f(_),u_star_size:new s.Uniform1f(_),u_temporal_offset:new s.Uniform1f(_),u_horizon_angle:new s.Uniform1f(_),u_rotation_matrix:new s.UniformMatrix4f(_)})};let zf;function Jh(_,h,m,x,S,A,R){const O=_.context,z=O.gl,$=_.transform,j=_.useProgram("collisionBox"),Z=[];let re=0,he=0;for(let Se=0;Se<x.length;Se++){const ze=x[Se],Ve=h.getTile(ze),Ne=Ve.getBucket(m);if(!Ne)continue;const Ye=ve(ze,Ne,$);let Xe=Ye;S[0]===0&&S[1]===0||(Xe=_.translatePosMatrix(Ye,Ve,S,A));const st=R?Ne.textCollisionBox:Ne.iconCollisionBox,Ut=Ne.collisionCircleArray;if(Ut.length>0){const nt=s.create(),wt=Xe;s.mul(nt,Ne.placementInvProjMatrix,$.glCoordMatrix),s.mul(nt,nt,Ne.placementViewportMatrix),Z.push({circleArray:Ut,circleOffset:he,transform:wt,invTransform:nt,projection:Ne.getProjection()}),re+=Ut.length/4,he=re}st&&(_.terrain&&_.terrain.setupElevationDraw(Ve,j),j.draw(O,z.LINES,s.DepthMode.disabled,s.StencilMode.disabled,_.colorModeForRenderPass(),s.CullFaceMode.disabled,bg(Xe,$,Ve,Ne.getProjection()),m.id,st.layoutVertexBuffer,st.indexBuffer,st.segments,null,$.zoom,null,[st.collisionVertexBuffer,st.collisionVertexBufferExt]))}if(!R||!Z.length)return;const ge=_.useProgram("collisionCircle"),pe=new s.StructArrayLayout2f1f2i16;pe.resize(4*re),pe._trim();let _e=0;for(const Se of Z)for(let ze=0;ze<Se.circleArray.length/4;ze++){const Ve=4*ze,Ne=Se.circleArray[Ve+0],Ye=Se.circleArray[Ve+1],Xe=Se.circleArray[Ve+2],st=Se.circleArray[Ve+3];pe.emplace(_e++,Ne,Ye,Xe,st,0),pe.emplace(_e++,Ne,Ye,Xe,st,1),pe.emplace(_e++,Ne,Ye,Xe,st,2),pe.emplace(_e++,Ne,Ye,Xe,st,3)}(!zf||zf.length<2*re)&&(zf=function(Se){const ze=2*Se,Ve=new s.StructArrayLayout3ui6;Ve.resize(ze),Ve._trim();for(let Ne=0;Ne<ze;Ne++){const Ye=6*Ne;Ve.uint16[Ye+0]=4*Ne+0,Ve.uint16[Ye+1]=4*Ne+1,Ve.uint16[Ye+2]=4*Ne+2,Ve.uint16[Ye+3]=4*Ne+2,Ve.uint16[Ye+4]=4*Ne+3,Ve.uint16[Ye+5]=4*Ne+0}return Ve}(re));const Y=O.createIndexBuffer(zf,!0),ce=O.createVertexBuffer(pe,s.collisionCircleLayout.members,!0);for(const Se of Z){const ze={u_matrix:Se.transform,u_inv_matrix:Se.invTransform,u_camera_to_center_distance:(Ee=$).getCameraToCenterDistance(Se.projection),u_viewport_size:[Ee.width,Ee.height]};ge.draw(O,z.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,_.colorModeForRenderPass(),s.CullFaceMode.disabled,ze,m.id,ce,Y,s.SegmentVector.simpleSegment(0,2*Se.circleOffset,Se.circleArray.length,Se.circleArray.length/2),null,$.zoom)}var Ee;ce.destroy(),Y.destroy()}const W_=s.create();function Cg({width:_,height:h,anchor:m,textOffset:x,textScale:S},A){const{horizontalAlign:R,verticalAlign:O}=s.getAnchorAlignment(m),z=-(R-.5)*_,$=-(O-.5)*h,j=s.evaluateVariableOffset(m,x);return new s.Point((z/S+j[0])*A,($/S+j[1])*A)}function vE(_,h,m,x,S,A,R,O,z,$,j){const Z=_.text.placedSymbolArray,re=_.text.dynamicLayoutVertexArray,he=_.icon.dynamicLayoutVertexArray,ge={},pe=_.getProjection(),_e=Re(O,pe,A),Y=A.elevation,ce=pe.upVectorScale(O.canonical,A.center.lat,A.worldSize).metersToTile;re.clear();for(let Ee=0;Ee<Z.length;Ee++){const Se=Z.get(Ee),{tileAnchorX:ze,tileAnchorY:Ve,numGlyphs:Ne}=Se,Ye=Se.hidden||!Se.crossTileID||_.allowVerticalPlacement&&!Se.placedOrientation?null:x[Se.crossTileID];if(Ye){let Xe=0,st=0,Ut=0;if(Y){const Gt=Y?Y.getAtTileOffset(O,ze,Ve):0,[In,Qn,gn]=pe.upVector(O.canonical,ze,Ve);Xe=Gt*In*ce,st=Gt*Qn*ce,Ut=Gt*gn*ce}let[nt,wt,dt,Bt]=Ai(Se.projectedAnchorX+Xe,Se.projectedAnchorY+st,Se.projectedAnchorZ+Ut,m?_e:R);const ot=er(A.getCameraToCenterDistance(pe),Bt);let xt=S.evaluateSizeForFeature(_.textSizeData,$,Se)*ot/s.ONE_EM;m&&(xt*=_.tilePixelRatio/z);const jt=Cg(Ye,xt);m?({x:nt,y:wt,z:dt}=pe.projectTilePoint(ze+jt.x,Ve+jt.y,O.canonical),[nt,wt,dt]=Ai(nt+Xe,wt+st,dt+Ut,R)):(h&&jt._rotate(-A.angle),nt+=jt.x,wt+=jt.y,dt=0);const Mt=_.allowVerticalPlacement&&Se.placedOrientation===s.WritingMode.vertical?Math.PI/2:0;for(let Gt=0;Gt<Ne;Gt++)s.addDynamicAttributes(re,nt,wt,dt,Mt);j&&Se.associatedIconIndex>=0&&(ge[Se.associatedIconIndex]={x:nt,y:wt,z:dt,angle:Mt})}else xo(Ne,re)}if(j){he.clear();const Ee=_.icon.placedSymbolArray;for(let Se=0;Se<Ee.length;Se++){const ze=Ee.get(Se),{numGlyphs:Ve}=ze,Ne=ge[Se];if(ze.hidden||!Ne)xo(Ve,he);else{const{x:Ye,y:Xe,z:st,angle:Ut}=Ne;for(let nt=0;nt<Ve;nt++)s.addDynamicAttributes(he,Ye,Xe,st,Ut)}}_.icon.dynamicLayoutVertexBuffer.updateData(he)}_.text.dynamicLayoutVertexBuffer.updateData(re)}function Ag(_,h,m){return m.iconsInText&&h?"symbolTextAndIcon":_?"symbolSDF":"symbolIcon"}function K_(_,h,m,x,S,A,R,O,z,$,j,Z){const re=_.context,he=re.gl,ge=_.transform,pe=O==="map",_e=z==="map",Y=pe&&m.layout.get("symbol-placement")!=="point",ce=pe&&!_e&&!Y,Ee=m.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Se=!1;const ze=_.depthModeForSublayer(0,s.DepthMode.ReadOnly),Ve=[s.mercatorXfromLng(ge.center.lng),s.mercatorYfromLat(ge.center.lat)],Ne=m.layout.get("text-variable-anchor"),Ye=ge.projection.name==="globe",Xe=[],st=[0,-1,0];let Ut=st;!Ye&&!ge.mercatorFromTransition||pe||(Ut=function(nt){const wt=nt._camera.getWorldToCamera(nt.worldSize,1),dt=s.multiply([],wt,nt.globeMatrix);s.invert(dt,dt);const Bt=[0,0,0],ot=[0,1,0,0];return s.transformMat4$1(ot,ot,dt),Bt[0]=ot[0],Bt[1]=ot[1],Bt[2]=ot[2],s.normalize(Bt,Bt),Bt}(ge));for(const nt of x){const wt=h.getTile(nt),dt=wt.getBucket(m);if(!dt||dt.projection.name==="mercator"&&Ye)continue;const Bt=S?dt.text:dt.icon;if(!Bt||dt.fullyClipped||!Bt.segments.get().length)continue;const ot=Bt.programConfigurations.get(m.id),xt=S||dt.sdfIcons,jt=S?dt.textSizeData:dt.iconSizeData,Mt=_e||ge.pitch!==0,Gt=s.evaluateSizeForZoom(jt,ge.zoom);let In,Qn,gn,Fn,yi=[0,0],gi=null;if(S)Qn=wt.glyphAtlasTexture,gn=he.LINEAR,In=wt.glyphAtlasTexture.size,dt.iconsInText&&(yi=wt.imageAtlasTexture.size,gi=wt.imageAtlasTexture,Fn=Mt||_.options.rotating||_.options.zooming||jt.kind==="composite"||jt.kind==="camera"?he.LINEAR:he.NEAREST);else{const il=m.layout.get("icon-size").constantOr(0)!==1||dt.iconsNeedLinear;Qn=wt.imageAtlasTexture,gn=xt||_.options.rotating||_.options.zooming||il||Mt?he.LINEAR:he.NEAREST,In=wt.imageAtlasTexture.size}const Sn=dt.projection.name==="globe",Ui=Sn?Ut:st,Hi=Sn?s.globeToMercatorTransition(ge.zoom):0,Wi=Re(nt,dt.getProjection(),ge),Ki=ge.calculatePixelsToTileUnitsMatrix(wt),Vo=yt(Wi,wt.tileID.canonical,_e,pe,ge,dt.getProjection(),Ki),Eo=_.terrain&&_e&&Y?s.invert(s.create(),Vo):W_,Ns=sr(Wi,wt.tileID.canonical,_e,pe,ge,dt.getProjection(),Ki),Ma=Ne&&dt.hasTextData(),yr=m.layout.get("icon-text-fit")!=="none"&&Ma&&dt.hasIconData();if(Y){const il=ge.elevation,Fl=il?il.getAtTileOffsetFunc(nt,ge.center.lat,ge.worldSize,dt.getProjection()):null,Cc=No(Wi,wt.tileID.canonical,_e,pe,ge,dt.getProjection(),Ki);ra(dt,Wi,_,S,Cc,Ns,_e,$,Fl,nt)}const Xi=Y||S&&Ne||yr,Oi=_.translatePosMatrix(Wi,wt,A,R),Xr=Xi?W_:Vo,Yo=_.translatePosMatrix(Ns,wt,A,R,!0),dr=dt.getProjection().createInversionMatrix(ge,nt.canonical),is=[];_.terrainRenderModeElevated()&&_e&&is.push("PITCH_WITH_MAP_TERRAIN"),Sn&&is.push("PROJECTION_GLOBE_VIEW"),Xi&&is.push("PROJECTED_POS_ON_VIEWPORT");const ep=xt&&m.paint.get(S?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Sc;Sc=xt?dt.iconsInText?H_(jt.kind,Gt,ce,_e,_,Oi,Xr,Yo,In,yi,nt,Hi,Ve,dr,Ui,dt.getProjection()):Bf(jt.kind,Gt,ce,_e,_,Oi,Xr,Yo,S,In,!0,nt,Hi,Ve,dr,Ui,dt.getProjection()):Eg(jt.kind,Gt,ce,_e,_,Oi,Xr,Yo,S,In,nt,Hi,Ve,dr,Ui,dt.getProjection());const cd={program:_.useProgram(Ag(xt,S,dt),ot,is),buffers:Bt,uniformValues:Sc,atlasTexture:Qn,atlasTextureIcon:gi,atlasInterpolation:gn,atlasInterpolationIcon:Fn,isSDF:xt,hasHalo:ep,tile:wt,labelPlaneMatrixInv:Eo};if(Ee&&dt.canOverlap){Se=!0;const il=Bt.segments.get();for(const Fl of il)Xe.push({segments:new s.SegmentVector([Fl]),sortKey:Fl.sortKey,state:cd})}else Xe.push({segments:Bt.segments,sortKey:0,state:cd})}Se&&Xe.sort((nt,wt)=>nt.sortKey-wt.sortKey);for(const nt of Xe){const wt=nt.state;if(_.terrain&&_.terrain.setupElevationDraw(wt.tile,wt.program,{useDepthForOcclusion:!Ye,labelPlaneMatrixInv:wt.labelPlaneMatrixInv}),re.activeTexture.set(he.TEXTURE0),wt.atlasTexture.bind(wt.atlasInterpolation,he.CLAMP_TO_EDGE),wt.atlasTextureIcon&&(re.activeTexture.set(he.TEXTURE1),wt.atlasTextureIcon&&wt.atlasTextureIcon.bind(wt.atlasInterpolationIcon,he.CLAMP_TO_EDGE)),wt.isSDF){const dt=wt.uniformValues;wt.hasHalo&&(dt.u_is_halo=1,Qh(wt.buffers,nt.segments,m,_,wt.program,ze,j,Z,dt)),dt.u_is_halo=0}Qh(wt.buffers,nt.segments,m,_,wt.program,ze,j,Z,wt.uniformValues)}}function Qh(_,h,m,x,S,A,R,O,z){const $=x.context,j=[_.dynamicLayoutVertexBuffer,_.opacityVertexBuffer,_.globeExtVertexBuffer];S.draw($,$.gl.TRIANGLES,A,R,O,s.CullFaceMode.disabled,z,m.id,_.layoutVertexBuffer,_.indexBuffer,h,m.paint,x.transform.zoom,_.programConfigurations.get(m.id),j)}function X_(_,h,m,x,S,A,R){const O=_.context.gl,z=m.paint.get("fill-pattern"),$=z&&z.constantOr(1);let j,Z,re,he,ge;R?(Z=$&&!m.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",j=O.LINES):(Z=$?"fillPattern":"fill",j=O.TRIANGLES);for(const pe of x){const _e=h.getTile(pe);if($&&!_e.patternsLoaded())continue;const Y=_e.getBucket(m);if(!Y)continue;_.prepareDrawTile();const ce=Y.programConfigurations.get(m.id),Ee=_.useProgram(Z,ce);$&&(_.context.activeTexture.set(O.TEXTURE0),_e.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),ce.updatePaintBuffers());const Se=z.constantOr(null);if(Se&&_e.imageAtlas){const Ve=_e.imageAtlas.patternPositions[Se.toString()];Ve&&ce.setConstantPatternPositions(Ve)}const ze=_.translatePosMatrix(pe.projMatrix,_e,m.paint.get("fill-translate"),m.paint.get("fill-translate-anchor"));if(R){he=Y.indexBuffer2,ge=Y.segments2;const Ve=_.terrain&&_.terrain.renderingToTexture?_.terrain.drapeBufferSize:[O.drawingBufferWidth,O.drawingBufferHeight];re=Z==="fillOutlinePattern"&&$?pE(ze,_,_e,Ve):fE(ze,Ve)}else he=Y.indexBuffer,ge=Y.segments,re=$?yg(ze,_,_e):xc(ze);_.prepareDrawProgram(_.context,Ee,pe.toUnwrapped()),Ee.draw(_.context,j,S,_.stencilModeForClipping(pe),A,s.CullFaceMode.disabled,re,m.id,Y.layoutVertexBuffer,he,ge,m.paint,_.transform.zoom,ce)}}function Nf(_,h,m,x,S,A,R){const O=_.context,z=O.gl,$=_.transform,j=m.paint.get("fill-extrusion-pattern"),Z=j.constantOr(1),re=m.paint.get("fill-extrusion-opacity"),he=[m.paint.get("fill-extrusion-ambient-occlusion-intensity"),m.paint.get("fill-extrusion-ambient-occlusion-radius")],ge=m.layout.get("fill-extrusion-edge-radius"),pe=ge>0&&!m.paint.get("fill-extrusion-rounded-roof"),_e=pe?0:ge,Y=$.projection.name==="globe"?s.fillExtrusionHeightLift():0,ce=$.projection.name==="globe",Ee=ce?s.globeToMercatorTransition($.zoom):0,Se=[s.mercatorXfromLng($.center.lng),s.mercatorYfromLat($.center.lat)],ze=[];ce&&ze.push("PROJECTION_GLOBE_VIEW"),he[0]>0&&ze.push("FAUX_AO"),pe&&ze.push("ZERO_ROOF_RADIUS");for(const Ve of x){const Ne=h.getTile(Ve),Ye=Ne.getBucket(m);if(!Ye||Ye.projection.name!==$.projection.name)continue;const Xe=Ye.programConfigurations.get(m.id),st=_.useProgram(Z?"fillExtrusionPattern":"fillExtrusion",Xe,ze);if(_.terrain){const xt=_.terrain;if(_.style.terrainSetForDrapingOnly())xt.setupElevationDraw(Ne,st,{useMeterToDem:!0});else{if(!Ye.enableTerrain)continue;if(xt.setupElevationDraw(Ne,st,{useMeterToDem:!0}),Z_(O,h,Ve,Ye,m,xt),!Ye.centroidVertexBuffer){const jt=st.attributes.a_centroid_pos;jt!==void 0&&z.vertexAttrib2f(jt,0,0)}}}Z&&(_.context.activeTexture.set(z.TEXTURE0),Ne.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),Xe.updatePaintBuffers());const Ut=j.constantOr(null);if(Ut&&Ne.imageAtlas){const xt=Ne.imageAtlas.patternPositions[Ut.toString()];xt&&Xe.setConstantPatternPositions(xt)}const nt=_.translatePosMatrix(Ve.projMatrix,Ne,m.paint.get("fill-extrusion-translate"),m.paint.get("fill-extrusion-translate-anchor")),wt=$.projection.createInversionMatrix($,Ve.canonical),dt=m.paint.get("fill-extrusion-vertical-gradient"),Bt=Z?j_(nt,_,dt,re,he,_e,Ve,Ne,Y,Ee,Se,wt):gg(nt,_,dt,re,he,_e,Ve,Y,Ee,Se,wt);_.prepareDrawProgram(O,st,Ve.toUnwrapped());const ot=[];_.terrain&&ot.push(Ye.centroidVertexBuffer),ce&&ot.push(Ye.layoutVertexExtBuffer),st.draw(O,O.gl.TRIANGLES,S,A,R,s.CullFaceMode.backCCW,Bt,m.id,Ye.layoutVertexBuffer,Ye.indexBuffer,Ye.segments,m.paint,_.transform.zoom,Xe,ot)}}function Z_(_,h,m,x,S,A){const R=[Y=>{let ce=Y.canonical.x-1,Ee=Y.wrap;return ce<0&&(ce=(1<<Y.canonical.z)-1,Ee--),new s.OverscaledTileID(Y.overscaledZ,Ee,Y.canonical.z,ce,Y.canonical.y)},Y=>{let ce=Y.canonical.x+1,Ee=Y.wrap;return ce===1<<Y.canonical.z&&(ce=0,Ee++),new s.OverscaledTileID(Y.overscaledZ,Ee,Y.canonical.z,ce,Y.canonical.y)},Y=>new s.OverscaledTileID(Y.overscaledZ,Y.wrap,Y.canonical.z,Y.canonical.x,(Y.canonical.y===0?1<<Y.canonical.z:Y.canonical.y)-1),Y=>new s.OverscaledTileID(Y.overscaledZ,Y.wrap,Y.canonical.z,Y.canonical.x,Y.canonical.y===(1<<Y.canonical.z)-1?0:Y.canonical.y+1)],O=Y=>{const ce=h.getSource().minzoom,Ee=ze=>{const Ve=h.getTileByID(ze);if(Ve&&Ve.hasData())return Ve.getBucket(S)},Se=[0,-1,1];for(const ze of Se){if(Y.overscaledZ+ze<ce)continue;const Ve=Ee(Y.calculateScaledKey(Y.overscaledZ+ze));if(Ve)return Ve}},z=[0,0,0],$=(Y,ce)=>(z[0]=Math.min(Y.min.y,ce.min.y),z[1]=Math.max(Y.max.y,ce.max.y),z[2]=s.EXTENT-ce.min.x>Y.max.x?ce.min.x-s.EXTENT:Y.max.x,z),j=(Y,ce)=>(z[0]=Math.min(Y.min.x,ce.min.x),z[1]=Math.max(Y.max.x,ce.max.x),z[2]=s.EXTENT-ce.min.y>Y.max.y?ce.min.y-s.EXTENT:Y.max.y,z),Z=[(Y,ce)=>$(Y,ce),(Y,ce)=>$(ce,Y),(Y,ce)=>j(Y,ce),(Y,ce)=>j(ce,Y)],re=new s.Point(0,0);let he,ge,pe;const _e=(Y,ce,Ee,Se,ze)=>{const Ve=[[Se?Ee:Y,Se?Y:Ee,0],[Se?Ee:ce,Se?ce:Ee,0]],Ne=ze<0?s.EXTENT+ze:ze,Ye=[Se?Ne:(Y+ce)/2,Se?(Y+ce)/2:Ne,0];return Ee===0&&ze<0||Ee!==0&&ze>0?A.getForTilePoints(pe,[Ye],!0,ge):Ve.push(Ye),A.getForTilePoints(m,Ve,!0,he),Math.max(Ve[0][2],Ve[1][2],Ye[2])/A.exaggeration()};for(let Y=0;Y<4;Y++){const ce=(Y<2?1:5)-Y,Ee=x.borders[Y];if(Ee.length===0)continue;const Se=pe=R[Y](m),ze=O(Se);if(!(ze&&ze instanceof s.FillExtrusionBucket&&ze.enableTerrain)||x.borderDoneWithNeighborZ[Y]===ze.canonical.z&&ze.borderDoneWithNeighborZ[ce]===x.canonical.z||(ge=A.findDEMTileFor(Se),!ge||!ge.dem))continue;if(!he){const Xe=A.findDEMTileFor(m);if(!Xe||!Xe.dem)return;he=Xe}const Ve=ze.borders[ce];let Ne=0;const Ye=ze.borderDoneWithNeighborZ[ce]!==x.canonical.z;if(x.canonical.z===ze.canonical.z){for(let Xe=0;Xe<Ee.length;Xe++){const st=x.featuresOnBorder[Ee[Xe]],Ut=st.borders[Y];let nt;for(;Ne<Ve.length&&(nt=ze.featuresOnBorder[Ve[Ne]],!(nt.borders[ce][1]>Ut[0]+3));)Ye&&ze.encodeCentroid(void 0,nt,!1),Ne++;if(nt&&Ne<Ve.length){const wt=Ne;let dt=0;for(;!(nt.borders[ce][0]>Ut[1]-3)&&(dt++,++Ne!==Ve.length);)nt=ze.featuresOnBorder[Ve[Ne]];if(nt=ze.featuresOnBorder[Ve[wt]],st.intersectsCount()>1||nt.intersectsCount()>1||dt!==1){dt!==1&&(Ne=wt),x.encodeCentroid(void 0,st,!1),Ye&&ze.encodeCentroid(void 0,nt,!1);continue}const Bt=Z[Y](st,nt),ot=Y%2?s.EXTENT-1:0;re.x=_e(Bt[0],Math.min(s.EXTENT-1,Bt[1]),ot,Y<2,Bt[2]),re.y=0,x.encodeCentroid(re,st,!1),Ye&&ze.encodeCentroid(re,nt,!1)}else x.encodeCentroid(void 0,st,!1)}x.borderDoneWithNeighborZ[Y]=ze.canonical.z,x.needsCentroidUpdate=!0,Ye&&(ze.borderDoneWithNeighborZ[ce]=x.canonical.z,ze.needsCentroidUpdate=!0)}else{for(const Xe of Ee)x.encodeCentroid(void 0,x.featuresOnBorder[Xe],!1);if(Ye){for(const Xe of Ve)ze.encodeCentroid(void 0,ze.featuresOnBorder[Xe],!1);ze.borderDoneWithNeighborZ[ce]=x.canonical.z,ze.needsCentroidUpdate=!0}x.borderDoneWithNeighborZ[Y]=ze.canonical.z,x.needsCentroidUpdate=!0}}(x.needsCentroidUpdate||!x.centroidVertexBuffer&&x.centroidVertexArray.length!==0)&&x.uploadCentroid(_)}const Au=new s.Color(1,0,0,1),_E=new s.Color(0,1,0,1),bE=new s.Color(0,0,1,1),xE=new s.Color(1,0,1,1),wE=new s.Color(0,1,1,1);function EE(_,h,m){const x=_.context,S=_.transform,A=x.gl,R=S.projection.name==="globe",O=R?["PROJECTION_GLOBE_VIEW"]:null;let z=m.projMatrix;if(R&&s.globeToMercatorTransition(S.zoom)>0){const st=s.transitionTileAABBinECEF(m.canonical,S),Ut=s.globeDenormalizeECEF(st);z=s.multiply(new Float32Array(16),S.globeMatrix,Ut),s.multiply(z,S.projMatrix,z)}const $=_.useProgram("debug",null,O),j=h.getTileByID(m.key);_.terrain&&_.terrain.setupElevationDraw(j,$);const Z=s.DepthMode.disabled,re=s.StencilMode.disabled,he=_.colorModeForRenderPass(),ge="$debug";x.activeTexture.set(A.TEXTURE0),_.emptyTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),R?j._makeGlobeTileDebugBuffers(_.context,S):j._makeDebugTileBoundsBuffers(_.context,S.projection);const pe=j._tileDebugBuffer||_.debugBuffer,_e=j._tileDebugIndexBuffer||_.debugIndexBuffer,Y=j._tileDebugSegments||_.debugSegments;$.draw(x,A.LINE_STRIP,Z,re,he,s.CullFaceMode.disabled,kf(z,s.Color.red),ge,pe,_e,Y,null,null,null,[j._globeTileDebugBorderBuffer]);const ce=j.latestRawTileData,Ee=Math.floor((ce&&ce.byteLength||0)/1024),Se=h.getTile(m).tileSize,ze=512/Math.min(Se,512)*(m.overscaledZ/S.zoom)*.5;let Ve=m.canonical.toString();m.overscaledZ!==m.canonical.z&&(Ve+=` => ${m.overscaledZ}`),Ve+=` ${Ee}kb`,function(st,Ut){st.initDebugOverlayCanvas();const nt=st.debugOverlayCanvas,wt=st.context.gl,dt=st.debugOverlayCanvas.getContext("2d");dt.clearRect(0,0,nt.width,nt.height),dt.shadowColor="white",dt.shadowBlur=2,dt.lineWidth=1.5,dt.strokeStyle="white",dt.textBaseline="top",dt.font="bold 36px Open Sans, sans-serif",dt.fillText(Ut,5,5),dt.strokeText(Ut,5,5),st.debugOverlayTexture.update(nt),st.debugOverlayTexture.bind(wt.LINEAR,wt.CLAMP_TO_EDGE)}(_,Ve);const Ne=j._tileDebugTextBuffer||_.debugBuffer,Ye=j._tileDebugTextIndexBuffer||_.quadTriangleIndexBuffer,Xe=j._tileDebugTextSegments||_.debugSegments;$.draw(x,A.TRIANGLES,Z,re,s.ColorMode.alphaBlended,s.CullFaceMode.disabled,kf(z,s.Color.transparent,ze),ge,Ne,Ye,Xe,null,null,null,[j._globeTileDebugTextBuffer])}function q_(_,h,m,x){Pu(_,0,h+m/2,_.transform.width,m,x)}function Uf(_,h,m,x){Pu(_,h-m/2,0,m,_.transform.height,x)}function Pu(_,h,m,x,S,A){const R=_.context,O=R.gl;O.enable(O.SCISSOR_TEST),O.scissor(h*s.exported.devicePixelRatio,m*s.exported.devicePixelRatio,x*s.exported.devicePixelRatio,S*s.exported.devicePixelRatio),R.clear({color:A}),O.disable(O.SCISSOR_TEST)}const Y_=s.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:J_}=Y_;function tl(_,h,m,x){_.emplaceBack(h,m,x)}class Vf{constructor(h){this.vertexArray=new s.StructArrayLayout3f12,this.indices=new s.StructArrayLayout3ui6,tl(this.vertexArray,-1,-1,1),tl(this.vertexArray,1,-1,1),tl(this.vertexArray,-1,1,1),tl(this.vertexArray,1,1,1),tl(this.vertexArray,-1,-1,-1),tl(this.vertexArray,1,-1,-1),tl(this.vertexArray,-1,1,-1),tl(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=h.createVertexBuffer(this.vertexArray,J_),this.indexBuffer=h.createIndexBuffer(this.indices),this.segment=s.SegmentVector.simpleSegment(0,0,36,12)}}function Bs(_,h,m,x,S,A){const R=_.gl,O=h.paint.get("sky-atmosphere-color"),z=h.paint.get("sky-atmosphere-halo-color"),$=h.paint.get("sky-atmosphere-sun-intensity"),j=((Z,re,he,ge,pe)=>({u_matrix_3f:Z,u_sun_direction:re,u_sun_intensity:he,u_color_tint_r:[ge.r,ge.g,ge.b,ge.a],u_color_tint_m:[pe.r,pe.g,pe.b,pe.a],u_luminance:5e-5}))(s.fromMat4(s.create$1(),x),S,$,O,z);R.framebufferTexture2D(R.FRAMEBUFFER,R.COLOR_ATTACHMENT0,R.TEXTURE_CUBE_MAP_POSITIVE_X+A,h.skyboxTexture,0),m.draw(_,R.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.frontCW,j,"skyboxCapture",h.skyboxGeometry.vertexBuffer,h.skyboxGeometry.indexBuffer,h.skyboxGeometry.segment)}const ed=s.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Q_{constructor(h){const m=new s.StructArrayLayout5f20;m.emplaceBack(-1,1,1,0,0),m.emplaceBack(1,1,1,1,0),m.emplaceBack(1,-1,1,1,1),m.emplaceBack(-1,-1,1,0,1);const x=new s.StructArrayLayout3ui6;x.emplaceBack(0,1,2),x.emplaceBack(2,3,0),this.vertexBuffer=h.createVertexBuffer(m,ed.members),this.indexBuffer=h.createIndexBuffer(x),this.segments=s.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const wc={symbol:function(_,h,m,x,S){if(_.renderPass!=="translucent")return;const A=s.StencilMode.disabled,R=_.colorModeForRenderPass();m.layout.get("text-variable-anchor")&&function(O,z,$,j,Z,re,he){const ge=z.transform,pe=Z==="map",_e=re==="map";for(const Y of O){const ce=j.getTile(Y),Ee=ce.getBucket($);if(!Ee||!Ee.text||!Ee.text.segments.get().length)continue;const Se=s.evaluateSizeForZoom(Ee.textSizeData,ge.zoom),ze=Re(Y,Ee.getProjection(),ge),Ve=ge.calculatePixelsToTileUnitsMatrix(ce),Ne=yt(ze,ce.tileID.canonical,_e,pe,ge,Ee.getProjection(),Ve),Ye=$.layout.get("icon-text-fit")!=="none"&&Ee.hasIconData();if(Se){const Xe=Math.pow(2,ge.zoom-ce.tileID.overscaledZ);vE(Ee,pe,_e,he,s.symbolSize,ge,Ne,Y,Xe,Se,Ye)}}}(x,_,m,h,m.layout.get("text-rotation-alignment"),m.layout.get("text-pitch-alignment"),S),m.paint.get("icon-opacity").constantOr(1)!==0&&K_(_,h,m,x,!1,m.paint.get("icon-translate"),m.paint.get("icon-translate-anchor"),m.layout.get("icon-rotation-alignment"),m.layout.get("icon-pitch-alignment"),m.layout.get("icon-keep-upright"),A,R),m.paint.get("text-opacity").constantOr(1)!==0&&K_(_,h,m,x,!0,m.paint.get("text-translate"),m.paint.get("text-translate-anchor"),m.layout.get("text-rotation-alignment"),m.layout.get("text-pitch-alignment"),m.layout.get("text-keep-upright"),A,R),h.map.showCollisionBoxes&&(Jh(_,h,m,x,m.paint.get("text-translate"),m.paint.get("text-translate-anchor"),!0),Jh(_,h,m,x,m.paint.get("icon-translate"),m.paint.get("icon-translate-anchor"),!1))},circle:function(_,h,m,x){if(_.renderPass!=="translucent")return;const S=m.paint.get("circle-opacity"),A=m.paint.get("circle-stroke-width"),R=m.paint.get("circle-stroke-opacity"),O=m.layout.get("circle-sort-key").constantOr(1)!==void 0;if(S.constantOr(1)===0&&(A.constantOr(1)===0||R.constantOr(1)===0))return;const z=_.context,$=z.gl,j=_.transform,Z=_.depthModeForSublayer(0,s.DepthMode.ReadOnly),re=s.StencilMode.disabled,he=_.colorModeForRenderPass(),ge=j.projection.name==="globe",pe=[s.mercatorXfromLng(j.center.lng),s.mercatorYfromLat(j.center.lat)],_e=[];for(let ce=0;ce<x.length;ce++){const Ee=x[ce],Se=h.getTile(Ee),ze=Se.getBucket(m);if(!ze||ze.projection.name!==j.projection.name)continue;const Ve=ze.programConfigurations.get(m.id),Ne=_g(m);ge&&Ne.push("PROJECTION_GLOBE_VIEW");const Ye=_.useProgram("circle",Ve,Ne),Xe=ze.layoutVertexBuffer,st=ze.globeExtVertexBuffer,Ut=ze.indexBuffer,nt=j.projection.createInversionMatrix(j,Ee.canonical),wt={programConfiguration:Ve,program:Ye,layoutVertexBuffer:Xe,globeExtVertexBuffer:st,indexBuffer:Ut,uniformValues:vg(_,Ee,Se,nt,pe,m),tile:Se};if(O){const dt=ze.segments.get();for(const Bt of dt)_e.push({segments:new s.SegmentVector([Bt]),sortKey:Bt.sortKey,state:wt})}else _e.push({segments:ze.segments,sortKey:0,state:wt})}O&&_e.sort((ce,Ee)=>ce.sortKey-Ee.sortKey);const Y={useDepthForOcclusion:!ge};for(const ce of _e){const{programConfiguration:Ee,program:Se,layoutVertexBuffer:ze,globeExtVertexBuffer:Ve,indexBuffer:Ne,uniformValues:Ye,tile:Xe}=ce.state,st=ce.segments;_.terrain&&_.terrain.setupElevationDraw(Xe,Se,Y),_.prepareDrawProgram(z,Se,Xe.tileID.toUnwrapped()),Se.draw(z,$.TRIANGLES,Z,re,he,s.CullFaceMode.disabled,Ye,m.id,ze,Ne,st,m.paint,j.zoom,Ee,[Ve])}},heatmap:function(_,h,m,x){if(m.paint.get("heatmap-opacity")!==0)if(_.renderPass==="offscreen"){const S=_.context,A=S.gl,R=s.StencilMode.disabled,O=new s.ColorMode([A.ONE,A.ONE],s.Color.transparent,[!0,!0,!0,!0]);(function(he,ge,pe,_e){const Y=he.gl,ce=ge.width*_e,Ee=ge.height*_e;he.activeTexture.set(Y.TEXTURE1),he.viewport.set([0,0,ce,Ee]);let Se=pe.heatmapFbo;if(!Se||Se&&(Se.width!==ce||Se.height!==Ee)){Se&&Se.destroy();const ze=Y.createTexture();Y.bindTexture(Y.TEXTURE_2D,ze),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_S,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_T,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MIN_FILTER,Y.LINEAR),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MAG_FILTER,Y.LINEAR),Se=pe.heatmapFbo=he.createFramebuffer(ce,Ee,!1),function(Ve,Ne,Ye,Xe,st,Ut){const nt=Ve.gl;nt.texImage2D(nt.TEXTURE_2D,0,Ve.isWebGL2&&Ve.extRenderToTextureHalfFloat?nt.RGBA16F:nt.RGBA,st,Ut,0,nt.RGBA,Ve.extRenderToTextureHalfFloat?Ve.isWebGL2?nt.HALF_FLOAT:Ve.extTextureHalfFloat.HALF_FLOAT_OES:nt.UNSIGNED_BYTE,null),Xe.colorAttachment.set(Ye)}(he,0,ze,Se,ce,Ee)}else Y.bindTexture(Y.TEXTURE_2D,Se.colorAttachment.get()),he.bindFramebuffer.set(Se.framebuffer)})(S,_,m,_.transform.projection.name==="globe"?.5:.25),S.clear({color:s.Color.transparent});const z=_.transform,$=z.projection.name==="globe",j=$?["PROJECTION_GLOBE_VIEW"]:null,Z=$?s.CullFaceMode.frontCCW:s.CullFaceMode.disabled,re=[s.mercatorXfromLng(z.center.lng),s.mercatorYfromLat(z.center.lat)];for(let he=0;he<x.length;he++){const ge=x[he];if(h.hasRenderableParent(ge))continue;const pe=h.getTile(ge),_e=pe.getBucket(m);if(!_e||_e.projection.name!==z.projection.name)continue;const Y=_e.programConfigurations.get(m.id),ce=_.useProgram("heatmap",Y,j),{zoom:Ee}=_.transform;_.terrain&&_.terrain.setupElevationDraw(pe,ce),_.prepareDrawProgram(S,ce,ge.toUnwrapped());const Se=z.projection.createInversionMatrix(z,ge.canonical);ce.draw(S,A.TRIANGLES,s.DepthMode.disabled,R,O,Z,G_(_,ge,pe,Se,re,Ee,m.paint.get("heatmap-intensity")),m.id,_e.layoutVertexBuffer,_e.indexBuffer,_e.segments,m.paint,_.transform.zoom,Y,$?[_e.globeExtVertexBuffer]:null)}S.viewport.set([0,0,_.width,_.height])}else _.renderPass==="translucent"&&(_.context.setColorMode(_.colorModeForRenderPass()),function(S,A){const R=S.context,O=R.gl,z=A.heatmapFbo;if(!z)return;R.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,z.colorAttachment.get()),R.activeTexture.set(O.TEXTURE1);let $=A.colorRampTexture;$||($=A.colorRampTexture=new s.Texture(R,A.colorRamp,O.RGBA)),$.bind(O.LINEAR,O.CLAMP_TO_EDGE),S.useProgram("heatmapTexture").draw(R,O.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,S.colorModeForRenderPass(),s.CullFaceMode.disabled,((j,Z,re,he)=>({u_image:0,u_color_ramp:1,u_opacity:Z.paint.get("heatmap-opacity")}))(0,A),A.id,S.viewportBuffer,S.quadTriangleIndexBuffer,S.viewportSegments,A.paint,S.transform.zoom)}(_,m))},line:function(_,h,m,x){if(_.renderPass!=="translucent")return;const S=m.paint.get("line-opacity"),A=m.paint.get("line-width");if(S.constantOr(1)===0||A.constantOr(1)===0)return;const R=_.depthModeForSublayer(0,s.DepthMode.ReadOnly),O=_.colorModeForRenderPass(),z=_.terrain&&_.terrain.renderingToTexture?1:s.exported.devicePixelRatio,$=m.paint.get("line-dasharray"),j=$.constantOr(1),Z=m.layout.get("line-cap"),re=m.paint.get("line-pattern"),he=re.constantOr(1),ge=m.paint.get("line-gradient"),pe=he?"linePattern":"line",_e=_.context,Y=_e.gl,ce=(Se=>{const ze=[];Yh(Se)&&ze.push("RENDER_LINE_DASH"),Se.paint.get("line-gradient")&&ze.push("RENDER_LINE_GRADIENT");const Ve=Se.paint.get("line-trim-offset");Ve[0]===0&&Ve[1]===0||ze.push("RENDER_LINE_TRIM_OFFSET");const Ne=Se.paint.get("line-pattern").constantOr(1),Ye=Se.paint.get("line-opacity").constantOr(1)!==1;return!Ne&&Ye&&ze.push("RENDER_LINE_ALPHA_DISCARD"),ze})(m);let Ee=ce.includes("RENDER_LINE_ALPHA_DISCARD");_.terrain&&_.terrain.clipOrMaskOverlapStencilType()&&(Ee=!1);for(const Se of x){const ze=h.getTile(Se);if(he&&!ze.patternsLoaded())continue;const Ve=ze.getBucket(m);if(!Ve)continue;_.prepareDrawTile();const Ne=Ve.programConfigurations.get(m.id),Ye=_.useProgram(pe,Ne,ce),Xe=re.constantOr(null);if(Xe&&ze.imageAtlas){const xt=ze.imageAtlas.patternPositions[Xe.toString()];xt&&Ne.setConstantPatternPositions(xt)}const st=$.constantOr(null),Ut=Z.constantOr(null);if(!he&&st&&Ut&&ze.lineAtlas){const xt=ze.lineAtlas.getDash(st,Ut);xt&&Ne.setConstantPatternPositions(xt)}let[nt,wt]=m.paint.get("line-trim-offset");(Ut==="round"||Ut==="square")&&nt!==wt&&(nt===0&&(nt-=1),wt===1&&(wt+=1));const dt=_.terrain?Se.projMatrix:null,Bt=he?qh(_,ze,m,dt,z):gE(_,ze,m,dt,Ve.lineClipsArray.length,z,[nt,wt]);if(ge){const xt=Ve.gradients[m.id];let jt=xt.texture;if(m.gradientVersion!==xt.version){let Mt=256;if(m.stepInterpolant){const Gt=h.getSource().maxzoom,In=Se.canonical.z===Gt?Math.ceil(1<<_.transform.maxZoom-Se.canonical.z):1;Mt=s.clamp(s.nextPowerOfTwo(Ve.maxLineLength/s.EXTENT*1024*In),256,_e.maxTextureSize)}xt.gradient=s.renderColorRamp({expression:m.gradientExpression(),evaluationKey:"lineProgress",resolution:Mt,image:xt.gradient||void 0,clips:Ve.lineClipsArray}),xt.texture?xt.texture.update(xt.gradient):xt.texture=new s.Texture(_e,xt.gradient,Y.RGBA),xt.version=m.gradientVersion,jt=xt.texture}_e.activeTexture.set(Y.TEXTURE1),jt.bind(m.stepInterpolant?Y.NEAREST:Y.LINEAR,Y.CLAMP_TO_EDGE)}j&&(_e.activeTexture.set(Y.TEXTURE0),ze.lineAtlasTexture.bind(Y.LINEAR,Y.REPEAT),Ne.updatePaintBuffers()),he&&(_e.activeTexture.set(Y.TEXTURE0),ze.imageAtlasTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),Ne.updatePaintBuffers()),_.prepareDrawProgram(_e,Ye,Se.toUnwrapped());const ot=xt=>{Ye.draw(_e,Y.TRIANGLES,R,xt,O,s.CullFaceMode.disabled,Bt,m.id,Ve.layoutVertexBuffer,Ve.indexBuffer,Ve.segments,m.paint,_.transform.zoom,Ne,[Ve.layoutVertexBuffer2])};if(Ee){const xt=_.stencilModeForClipping(Se).ref;xt===0&&_.terrain&&_e.clear({stencil:0});const jt={func:Y.EQUAL,mask:255};Bt.u_alpha_discard_threshold=.8,ot(new s.StencilMode(jt,xt,255,Y.KEEP,Y.KEEP,Y.INVERT)),Bt.u_alpha_discard_threshold=0,ot(new s.StencilMode(jt,xt,255,Y.KEEP,Y.KEEP,Y.KEEP))}else ot(_.stencilModeForClipping(Se))}Ee&&(_.resetStencilClippingMasks(),_.terrain&&_e.clear({stencil:0}))},fill:function(_,h,m,x){const S=m.paint.get("fill-color"),A=m.paint.get("fill-opacity");if(A.constantOr(1)===0)return;const R=_.colorModeForRenderPass(),O=m.paint.get("fill-pattern"),z=_.opaquePassEnabledForLayer()&&!O.constantOr(1)&&S.constantOr(s.Color.transparent).a===1&&A.constantOr(0)===1?"opaque":"translucent";if(_.renderPass===z){const $=_.depthModeForSublayer(1,_.renderPass==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly);X_(_,h,m,x,$,R,!1)}if(_.renderPass==="translucent"&&m.paint.get("fill-antialias")){const $=_.depthModeForSublayer(m.getPaintProperty("fill-outline-color")?2:0,s.DepthMode.ReadOnly);X_(_,h,m,x,$,R,!0)}},"fill-extrusion":function(_,h,m,x){const S=m.paint.get("fill-extrusion-opacity");if(S!==0&&_.renderPass==="translucent"){const A=new s.DepthMode(_.context.gl.LEQUAL,s.DepthMode.ReadWrite,_.depthRangeFor3D);if(S!==1||m.paint.get("fill-extrusion-pattern").constantOr(1))Nf(_,h,m,x,A,s.StencilMode.disabled,s.ColorMode.disabled),Nf(_,h,m,x,A,_.stencilModeFor3D(),_.colorModeForRenderPass()),_.resetStencilClippingMasks();else{const R=_.colorModeForRenderPass();Nf(_,h,m,x,A,s.StencilMode.disabled,R)}}},hillshade:function(_,h,m,x){if(_.renderPass!=="offscreen"&&_.renderPass!=="translucent")return;const S=_.context,A=_.depthModeForSublayer(0,s.DepthMode.ReadOnly),R=_.colorModeForRenderPass(),O=_.terrain&&_.terrain.renderingToTexture,[z,$]=_.renderPass!=="translucent"||O?[{},x]:_.stencilConfigForOverlap(x);for(const j of $){const Z=h.getTile(j);if(Z.needsHillshadePrepare&&_.renderPass==="offscreen")N_(_,Z,m,A,s.StencilMode.disabled,R);else if(_.renderPass==="translucent"){const re=O&&_.terrain?_.terrain.stencilModeForRTTOverlap(j):z[j.overscaledZ];z_(_,j,Z,m,A,re,R)}}S.viewport.set([0,0,_.width,_.height]),_.resetStencilClippingMasks()},raster:function(_,h,m,x,S,A){if(_.renderPass!=="translucent"||m.paint.get("raster-opacity")===0||!x.length)return;const R=_.context,O=R.gl,z=h.getSource(),$=_.useProgram("raster"),j=_.colorModeForRenderPass(),Z=_.terrain&&_.terrain.renderingToTexture,[re,he]=z instanceof ci||Z?[{},x]:_.stencilConfigForOverlap(x),ge=he[he.length-1].overscaledZ,pe=!_.options.moving;for(const _e of he){const Y=Z?s.DepthMode.disabled:_.depthModeForSublayer(_e.overscaledZ-ge,m.paint.get("raster-opacity")===1?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly,O.LESS),ce=_e.toUnwrapped(),Ee=h.getTile(_e);if(Z&&(!Ee||!Ee.hasData()))continue;const Se=Z?_e.projMatrix:_.transform.calculateProjMatrix(ce,pe),ze=_.terrain&&Z?_.terrain.stencilModeForRTTOverlap(_e):re[_e.overscaledZ],Ve=A?0:m.paint.get("raster-fade-duration");Ee.registerFadeDuration(Ve);const Ne=h.findLoadedParent(_e,0),Ye=fg(Ee,Ne,h,_.transform,Ve);let Xe,st;_.terrain&&_.terrain.prepareDrawTile();const Ut=m.paint.get("raster-resampling")==="nearest"?O.NEAREST:O.LINEAR;R.activeTexture.set(O.TEXTURE0),Ee.texture.bind(Ut,O.CLAMP_TO_EDGE),R.activeTexture.set(O.TEXTURE1),Ne?(Ne.texture.bind(Ut,O.CLAMP_TO_EDGE),Xe=Math.pow(2,Ne.tileID.overscaledZ-Ee.tileID.overscaledZ),st=[Ee.tileID.canonical.x*Xe%1,Ee.tileID.canonical.y*Xe%1]):Ee.texture.bind(Ut,O.CLAMP_TO_EDGE),Ee.texture.useMipmap&&R.extTextureFilterAnisotropic&&_.transform.pitch>20&&O.texParameterf(O.TEXTURE_2D,R.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,R.extTextureFilterAnisotropicMax);const nt=wg(Se,st||[0,0],Xe||1,Ye,m,z instanceof ci?z.perspectiveTransform:[0,0]);if(_.prepareDrawProgram(R,$,ce),z instanceof ci)z.boundsBuffer&&z.boundsSegments&&$.draw(R,O.TRIANGLES,Y,s.StencilMode.disabled,j,s.CullFaceMode.disabled,nt,m.id,z.boundsBuffer,_.quadTriangleIndexBuffer,z.boundsSegments);else{const{tileBoundsBuffer:wt,tileBoundsIndexBuffer:dt,tileBoundsSegments:Bt}=_.getTileBoundsBuffers(Ee);$.draw(R,O.TRIANGLES,Y,ze,j,s.CullFaceMode.disabled,nt,m.id,wt,dt,Bt)}}_.resetStencilClippingMasks()},background:function(_,h,m,x){const S=m.paint.get("background-color"),A=m.paint.get("background-opacity");if(A===0)return;const R=_.context,O=R.gl,z=_.transform,$=z.tileSize,j=m.paint.get("background-pattern");if(_.isPatternMissing(j))return;const Z=!j&&S.a===1&&A===1&&_.opaquePassEnabledForLayer()?"opaque":"translucent";if(_.renderPass!==Z)return;const re=s.StencilMode.disabled,he=_.depthModeForSublayer(0,Z==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly),ge=_.colorModeForRenderPass(),pe=_.useProgram(j?"backgroundPattern":"background");let _e,Y=x;Y||(_e=_.getBackgroundTiles(),Y=Object.values(_e).map(ce=>ce.tileID)),j&&(R.activeTexture.set(O.TEXTURE0),_.imageManager.bind(_.context));for(const ce of Y){const Ee=ce.toUnwrapped(),Se=x?ce.projMatrix:_.transform.calculateProjMatrix(Ee);_.prepareDrawTile();const ze=h?h.getTile(ce):_e?_e[ce.key]:new s.Tile(ce,$,z.zoom,_),Ve=j?yE(Se,A,_,j,{tileID:ce,tileSize:$}):Tg(Se,A,S);_.prepareDrawProgram(R,pe,Ee);const{tileBoundsBuffer:Ne,tileBoundsIndexBuffer:Ye,tileBoundsSegments:Xe}=_.getTileBoundsBuffers(ze);pe.draw(R,O.TRIANGLES,he,re,ge,s.CullFaceMode.disabled,Ve,m.id,Ne,Ye,Xe)}},sky:function(_,h,m){const x=_.transform,S=x.projection.name==="mercator"||x.projection.name==="globe"?1:s.smoothstep(7,8,x.zoom),A=m.paint.get("sky-opacity")*S;if(A===0)return;const R=_.context,O=m.paint.get("sky-type"),z=new s.DepthMode(R.gl.LEQUAL,s.DepthMode.ReadOnly,[0,1]),$=_.frameCounter/1e3%1;O==="atmosphere"?_.renderPass==="offscreen"?m.needsSkyboxCapture(_)&&(function(j,Z,re,he){const ge=j.context,pe=ge.gl;let _e=Z.skyboxFbo;if(!_e){_e=Z.skyboxFbo=ge.createFramebuffer(32,32,!1),Z.skyboxGeometry=new Vf(ge),Z.skyboxTexture=ge.gl.createTexture(),pe.bindTexture(pe.TEXTURE_CUBE_MAP,Z.skyboxTexture),pe.texParameteri(pe.TEXTURE_CUBE_MAP,pe.TEXTURE_WRAP_S,pe.CLAMP_TO_EDGE),pe.texParameteri(pe.TEXTURE_CUBE_MAP,pe.TEXTURE_WRAP_T,pe.CLAMP_TO_EDGE),pe.texParameteri(pe.TEXTURE_CUBE_MAP,pe.TEXTURE_MIN_FILTER,pe.LINEAR),pe.texParameteri(pe.TEXTURE_CUBE_MAP,pe.TEXTURE_MAG_FILTER,pe.LINEAR);for(let Se=0;Se<6;++Se)pe.texImage2D(pe.TEXTURE_CUBE_MAP_POSITIVE_X+Se,0,pe.RGBA,32,32,0,pe.RGBA,pe.UNSIGNED_BYTE,null)}ge.bindFramebuffer.set(_e.framebuffer),ge.viewport.set([0,0,32,32]);const Y=Z.getCenter(j,!0),ce=j.useProgram("skyboxCapture"),Ee=new Float64Array(16);s.identity(Ee),s.rotateY(Ee,Ee,.5*-Math.PI),Bs(ge,Z,ce,Ee,Y,0),s.identity(Ee),s.rotateY(Ee,Ee,.5*Math.PI),Bs(ge,Z,ce,Ee,Y,1),s.identity(Ee),s.rotateX(Ee,Ee,.5*-Math.PI),Bs(ge,Z,ce,Ee,Y,2),s.identity(Ee),s.rotateX(Ee,Ee,.5*Math.PI),Bs(ge,Z,ce,Ee,Y,3),s.identity(Ee),Bs(ge,Z,ce,Ee,Y,4),s.identity(Ee),s.rotateY(Ee,Ee,Math.PI),Bs(ge,Z,ce,Ee,Y,5),ge.viewport.set([0,0,j.width,j.height])}(_,m),m.markSkyboxValid(_)):_.renderPass==="sky"&&function(j,Z,re,he,ge){const pe=j.context,_e=pe.gl,Y=j.transform,ce=j.useProgram("skybox");pe.activeTexture.set(_e.TEXTURE0),_e.bindTexture(_e.TEXTURE_CUBE_MAP,Z.skyboxTexture);const Ee=((Se,ze,Ve,Ne,Ye)=>({u_matrix:Se,u_sun_direction:ze,u_cubemap:0,u_opacity:Ne,u_temporal_offset:Ye}))(Y.skyboxMatrix,Z.getCenter(j,!1),0,he,ge);j.prepareDrawProgram(pe,ce),ce.draw(pe,_e.TRIANGLES,re,s.StencilMode.disabled,j.colorModeForRenderPass(),s.CullFaceMode.backCW,Ee,"skybox",Z.skyboxGeometry.vertexBuffer,Z.skyboxGeometry.indexBuffer,Z.skyboxGeometry.segment)}(_,m,z,A,$):O==="gradient"&&_.renderPass==="sky"&&function(j,Z,re,he,ge){const pe=j.context,_e=pe.gl,Y=j.transform,ce=j.useProgram("skyboxGradient");Z.skyboxGeometry||(Z.skyboxGeometry=new Vf(pe)),pe.activeTexture.set(_e.TEXTURE0);let Ee=Z.colorRampTexture;Ee||(Ee=Z.colorRampTexture=new s.Texture(pe,Z.colorRamp,_e.RGBA)),Ee.bind(_e.LINEAR,_e.CLAMP_TO_EDGE);const Se=((ze,Ve,Ne,Ye,Xe)=>({u_matrix:ze,u_color_ramp:0,u_center_direction:Ve,u_radius:s.degToRad(Ne),u_opacity:Ye,u_temporal_offset:Xe}))(Y.skyboxMatrix,Z.getCenter(j,!1),Z.paint.get("sky-gradient-radius"),he,ge);j.prepareDrawProgram(pe,ce),ce.draw(pe,_e.TRIANGLES,re,s.StencilMode.disabled,j.colorModeForRenderPass(),s.CullFaceMode.backCW,Se,"skyboxGradient",Z.skyboxGeometry.vertexBuffer,Z.skyboxGeometry.indexBuffer,Z.skyboxGeometry.segment)}(_,m,z,A,$)},debug:function(_,h,m){for(let x=0;x<m.length;x++)EE(_,h,m[x])},custom:function(_,h,m,x){const S=_.context,A=m.implementation;if(!_.transform.projection.unsupportedLayers||!_.transform.projection.unsupportedLayers.includes("custom")||_.terrain&&(_.terrain.renderingToTexture||_.renderPass==="offscreen")&&m.isLayerDraped()){if(_.renderPass==="offscreen"){const R=A.prerender;if(R){if(_.setCustomLayerDefaults(),S.setColorMode(_.colorModeForRenderPass()),_.transform.projection.name==="globe"){const O=_.transform.pointMerc;R.call(A,S.gl,_.transform.customLayerMatrix(),_.transform.getProjection(),_.transform.globeToMercatorMatrix(),s.globeToMercatorTransition(_.transform.zoom),[O.x,O.y],_.transform.pixelsPerMeterRatio)}else R.call(A,S.gl,_.transform.customLayerMatrix());S.setDirty(),_.setBaseState()}}else if(_.renderPass==="translucent"){if(_.terrain&&_.terrain.renderingToTexture){const O=A.renderToTile;if(O){const z=x[0].canonical,$=new s.MercatorCoordinate(z.x+x[0].wrap*(1<<z.z),z.y,z.z);S.setDepthMode(s.DepthMode.disabled),S.setStencilMode(s.StencilMode.disabled),S.setColorMode(_.colorModeForRenderPass()),_.setCustomLayerDefaults(),O.call(A,S.gl,$),S.setDirty(),_.setBaseState()}return}_.setCustomLayerDefaults(),S.setColorMode(_.colorModeForRenderPass()),S.setStencilMode(s.StencilMode.disabled);const R=A.renderingMode==="3d"?new s.DepthMode(_.context.gl.LEQUAL,s.DepthMode.ReadWrite,_.depthRangeFor3D):_.depthModeForSublayer(0,s.DepthMode.ReadOnly);if(S.setDepthMode(R),_.transform.projection.name==="globe"){const O=_.transform.pointMerc;A.render(S.gl,_.transform.customLayerMatrix(),_.transform.getProjection(),_.transform.globeToMercatorMatrix(),s.globeToMercatorTransition(_.transform.zoom),[O.x,O.y],_.transform.pixelsPerMeterRatio)}else A.render(S.gl,_.transform.customLayerMatrix());S.setDirty(),_.setBaseState(),S.bindFramebuffer.set(null)}}else s.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class Iu{constructor(h,m,x=!1){this.context=new Ht(h,x),this.transform=m,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=s.SourceCache.maxUnderzooming+s.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(h,m){const x=!!h&&!!h.terrain&&this.transform.projection.supportsTerrain;if(!(x||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new mg(this,h));const S=this._terrain;this.transform.elevation=x?S:null,S.update(h,this.transform,m)}_updateFog(h){const m=h.fog;if(!m||this.transform.projection.name==="globe"||m.getOpacity(this.transform.pitch)<1||m.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[x,S]=m.getFovAdjustedRange(this.transform._fov);if(x>S)return void(this.transform.fogCullDistSq=null);const A=x+.78*(S-x);this.transform.fogCullDistSq=A*A}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(h,m){if(this.width=h*s.exported.devicePixelRatio,this.height=m*s.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const x of this.style.order)this.style._layers[x].resize()}setup(){const h=this.context,m=new s.StructArrayLayout2i4;m.emplaceBack(0,0),m.emplaceBack(s.EXTENT,0),m.emplaceBack(0,s.EXTENT),m.emplaceBack(s.EXTENT,s.EXTENT),this.tileExtentBuffer=h.createVertexBuffer(m,s.posAttributes.members),this.tileExtentSegments=s.SegmentVector.simpleSegment(0,0,4,2);const x=new s.StructArrayLayout2i4;x.emplaceBack(0,0),x.emplaceBack(s.EXTENT,0),x.emplaceBack(0,s.EXTENT),x.emplaceBack(s.EXTENT,s.EXTENT),this.debugBuffer=h.createVertexBuffer(x,s.posAttributes.members),this.debugSegments=s.SegmentVector.simpleSegment(0,0,4,5);const S=new s.StructArrayLayout2i4;S.emplaceBack(-1,-1),S.emplaceBack(1,-1),S.emplaceBack(-1,1),S.emplaceBack(1,1),this.viewportBuffer=h.createVertexBuffer(S,s.posAttributes.members),this.viewportSegments=s.SegmentVector.simpleSegment(0,0,4,2);const A=new s.StructArrayLayout4i8;A.emplaceBack(0,0,0,0),A.emplaceBack(s.EXTENT,0,s.EXTENT,0),A.emplaceBack(0,s.EXTENT,0,s.EXTENT),A.emplaceBack(s.EXTENT,s.EXTENT,s.EXTENT,s.EXTENT),this.mercatorBoundsBuffer=h.createVertexBuffer(A,s.boundsAttributes.members),this.mercatorBoundsSegments=s.SegmentVector.simpleSegment(0,0,4,2);const R=new s.StructArrayLayout3ui6;R.emplaceBack(0,1,2),R.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=h.createIndexBuffer(R);const O=new s.StructArrayLayout1ui2;for(const $ of[0,1,3,2,0])O.emplaceBack($);this.debugIndexBuffer=h.createIndexBuffer(O),this.emptyTexture=new s.Texture(h,new s.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),h.gl.RGBA),this.identityMat=s.create();const z=this.context.gl;this.stencilClearMode=new s.StencilMode({func:z.ALWAYS,mask:0},0,255,z.ZERO,z.ZERO,z.ZERO),this.loadTimeStamps.push(s.window.performance.now()),this.atmosphereBuffer=new Q_(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(h){return h._makeTileBoundsBuffers(this.context,this.transform.projection),h._tileBoundsBuffer?{tileBoundsBuffer:h._tileBoundsBuffer,tileBoundsIndexBuffer:h._tileBoundsIndexBuffer,tileBoundsSegments:h._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const h=this.context,m=h.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(h,m.TRIANGLES,s.DepthMode.disabled,this.stencilClearMode,s.ColorMode.disabled,s.CullFaceMode.disabled,Xh(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(h,m,x){if(!m||this.currentStencilSource===m.id||!h.isTileClipped()||!x||x.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let O=!1;for(const z of x)if(this._tileClippingMaskIDs[z.key]===void 0){O=!0;break}if(!O)return}this.currentStencilSource=m.id;const S=this.context,A=S.gl;this.nextStencilID+x.length>256&&this.clearStencil(),S.setColorMode(s.ColorMode.disabled),S.setDepthMode(s.DepthMode.disabled);const R=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const O of x){const z=m.getTile(O),$=this._tileClippingMaskIDs[O.key]=this.nextStencilID++,{tileBoundsBuffer:j,tileBoundsIndexBuffer:Z,tileBoundsSegments:re}=this.getTileBoundsBuffers(z);R.draw(S,A.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:A.ALWAYS,mask:0},$,255,A.KEEP,A.KEEP,A.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,Xh(O.projMatrix),"$clipping",j,Z,re)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const h=this.nextStencilID++,m=this.context.gl;return new s.StencilMode({func:m.NOTEQUAL,mask:255},h,255,m.KEEP,m.KEEP,m.REPLACE)}stencilModeForClipping(h){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(h);const m=this.context.gl;return new s.StencilMode({func:m.EQUAL,mask:255},this._tileClippingMaskIDs[h.key],0,m.KEEP,m.KEEP,m.REPLACE)}stencilConfigForOverlap(h){const m=this.context.gl,x=h.sort((R,O)=>O.overscaledZ-R.overscaledZ),S=x[x.length-1].overscaledZ,A=x[0].overscaledZ-S+1;if(A>1){this.currentStencilSource=void 0,this.nextStencilID+A>256&&this.clearStencil();const R={};for(let O=0;O<A;O++)R[O+S]=new s.StencilMode({func:m.GEQUAL,mask:255},O+this.nextStencilID,255,m.KEEP,m.KEEP,m.REPLACE);return this.nextStencilID+=A,[R,x]}return[{[S]:s.StencilMode.disabled},x]}colorModeForRenderPass(){const h=this.context.gl;return this._showOverdrawInspector?new s.ColorMode([h.CONSTANT_COLOR,h.ONE],new s.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?s.ColorMode.unblended:s.ColorMode.alphaBlended}depthModeForSublayer(h,m,x){if(!this.opaquePassEnabledForLayer())return s.DepthMode.disabled;const S=1-((1+this.currentLayer)*this.numSublayers+h)*this.depthEpsilon;return new s.DepthMode(x||this.context.gl.LEQUAL,m,[S,S])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(h,m){this.style=h,this.options=m,this.imageManager=h.imageManager,this.glyphManager=h.glyphManager,this.symbolFadeChange=h.placement.symbolFadeChange(s.exported.now()),this.imageManager.beginFrame();const x=this.style.order,S=this.style._sourceCaches;for(const $ in S){const j=S[$];j.used&&j.prepare(this.context)}const A={},R={},O={};for(const $ in S){const j=S[$];A[$]=j.getVisibleCoordinates(),R[$]=A[$].slice().reverse(),O[$]=j.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let $=0;$<x.length;$++)if(this.style._layers[x[$]].is3D()){this.opaquePassCutoff=$;break}if(this.terrain&&(this.terrain.updateTileBinding(O),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new s.GlobeSharedBuffers(this.context)),!s.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const $ of x){const j=this.style._layers[$],Z=h._getLayerSourceCache(j);if(!j.hasOffscreenPass()||j.isHidden(this.transform.zoom))continue;const re=Z?R[Z.id]:void 0;(j.type==="custom"||j.isSky()||re&&re.length)&&this.renderLayer(this,Z,j,re)}this.depthRangeFor3D=[0,1-(h.order.length+2)*this.numSublayers*this.depthEpsilon];const z=this.terrain;if(z&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&z.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:m.showOverdrawInspector?s.Color.black:s.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=m.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=x.length-1;this.currentLayer>=0;this.currentLayer--){const $=this.style._layers[x[this.currentLayer]],j=h._getLayerSourceCache($);if($.isSky())continue;const Z=j?R[j.id]:void 0;this._renderTileClippingMasks($,j,Z),this.renderLayer(this,j,$,Z)}if(this.style.fog&&this.transform.projection.supportsFog&&function($,j){const Z=$.context,re=Z.gl,he=$.transform,ge=new s.DepthMode(re.LEQUAL,s.DepthMode.ReadOnly,[0,1]),pe=$.useProgram("globeAtmosphere",null,he.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),_e=s.globeToMercatorTransition(he.zoom),Y=j.properties.get("color").toArray01(),ce=j.properties.get("high-color").toArray01(),Ee=j.properties.get("space-color").toArray01PremultipliedAlpha(),Se=s.identity$1([]);s.rotateY$1(Se,Se,-s.degToRad(he._center.lng)),s.rotateX$1(Se,Se,s.degToRad(he._center.lat)),s.rotateZ$1(Se,Se,he.angle),s.rotateX$1(Se,Se,-he._pitch);const ze=s.fromQuat(new Float32Array(16),Se),Ve=s.mapValue(j.properties.get("star-intensity"),0,1,0,.25),Ne=5e-4,Ye=s.mapValue(j.properties.get("horizon-blend"),0,1,Ne,.25),Xe=s.globeUseCustomAntiAliasing($,Z,he)&&Ye===Ne?he.worldSize/(2*Math.PI*1.025)-1:he.globeRadius,st=$.frameCounter/1e3%1,Ut=s.length(he.globeCenterInViewSpace),nt=Math.sqrt(Math.pow(Ut,2)-Math.pow(Xe,2)),wt=Math.acos(nt/Ut),dt=((ot,xt,jt,Mt,Gt,In,Qn,gn,Fn,yi,gi,Sn,Ui,Hi)=>({u_frustum_tl:ot,u_frustum_tr:xt,u_frustum_br:jt,u_frustum_bl:Mt,u_horizon:Gt,u_transition:In,u_fadeout_range:Qn,u_color:gn,u_high_color:Fn,u_space_color:yi,u_star_intensity:gi,u_star_size:5*s.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Sn,u_horizon_angle:Ui,u_rotation_matrix:Hi}))(he.frustumCorners.TL,he.frustumCorners.TR,he.frustumCorners.BR,he.frustumCorners.BL,he.frustumCorners.horizon,_e,Ye,Y,ce,Ee,Ve,st,wt,ze);$.prepareDrawProgram(Z,pe);const Bt=$.atmosphereBuffer;Bt&&pe.draw(Z,re.TRIANGLES,ge,s.StencilMode.disabled,s.ColorMode.alphaBlended,s.CullFaceMode.backCW,dt,"skybox",Bt.vertexBuffer,Bt.indexBuffer,Bt.segments)}(this,this.style.fog),this.renderPass="sky",(s.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<x.length;this.currentLayer++){const $=this.style._layers[x[this.currentLayer]],j=h._getLayerSourceCache($);$.isSky()&&this.renderLayer(this,j,$,j?R[j.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<x.length;){const $=this.style._layers[x[this.currentLayer]],j=h._getLayerSourceCache($);if($.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped($)){if($.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const Z=j?($.type==="symbol"?O:R)[j.id]:void 0;this._renderTileClippingMasks($,j,j?A[j.id]:void 0),this.renderLayer(this,j,$,Z),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let $=null;s.values(this.style._layers).forEach(j=>{const Z=h._getLayerSourceCache(j);Z&&!j.isHidden(this.transform.zoom)&&(!$||$.getSource().maxzoom<Z.getSource().maxzoom)&&($=Z)}),$&&this.options.showTileBoundaries&&wc.debug(this,$,$.getVisibleCoordinates())}this.options.showPadding&&function($){const j=$.transform.padding;q_($,$.transform.height-(j.top||0),3,Au),q_($,j.bottom||0,3,_E),Uf($,j.left||0,3,bE),Uf($,$.transform.width-(j.right||0),3,xE);const Z=$.transform.centerPoint;(function(re,he,ge,pe){Pu(re,he-1,ge-10,2,20,pe),Pu(re,he-10,ge-1,20,2,pe)})($,Z.x,$.transform.height-Z.y,wE)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(s.window.performance.now()),this.saveCanvasCopy())}renderLayer(h,m,x,S){x.isHidden(this.transform.zoom)||(x.type==="background"||x.type==="sky"||x.type==="custom"||S&&S.length)&&(this.id=x.id,this.gpuTimingStart(x),(!h.transform.projection.unsupportedLayers||!h.transform.projection.unsupportedLayers.includes(x.type)||h.terrain&&x.type==="custom")&&wc[x.type](h,m,x,S,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(h){if(!this.options.gpuTiming)return;const m=this.context.extTimerQuery;let x=this.gpuTimers[h.id];x||(x=this.gpuTimers[h.id]={calls:0,cpuTime:0,query:m.createQueryEXT()}),x.calls++,m.beginQueryEXT(m.TIME_ELAPSED_EXT,x.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const h=this.context.extTimerQuery,m=h.createQueryEXT();this.deferredRenderGpuTimeQueries.push(m),h.beginQueryEXT(h.TIME_ELAPSED_EXT,m)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const h=this.context.extTimerQuery;h.endQueryEXT(h.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const h=this.context.extTimerQuery;h.endQueryEXT(h.TIME_ELAPSED_EXT)}collectGpuTimers(){const h=this.gpuTimers;return this.gpuTimers={},h}collectDeferredRenderGpuQueries(){const h=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],h}queryGpuTimers(h){const m={};for(const x in h){const S=h[x],A=this.context.extTimerQuery,R=A.getQueryObjectEXT(S.query,A.QUERY_RESULT_EXT)/1e6;A.deleteQueryEXT(S.query),m[x]=R}return m}queryGpuTimeDeferredRender(h){if(!this.options.gpuTimingDeferredRender)return 0;const m=this.context.extTimerQuery;let x=0;for(const S of h)x+=m.getQueryObjectEXT(S,m.QUERY_RESULT_EXT)/1e6,m.deleteQueryEXT(S);return x}translatePosMatrix(h,m,x,S,A){if(!x[0]&&!x[1])return h;const R=A?S==="map"?this.transform.angle:0:S==="viewport"?-this.transform.angle:0;if(R){const $=Math.sin(R),j=Math.cos(R);x=[x[0]*j-x[1]*$,x[0]*$+x[1]*j]}const O=[A?x[0]:pn(m,x[0],this.transform.zoom),A?x[1]:pn(m,x[1],this.transform.zoom),0],z=new Float32Array(16);return s.translate(z,h,O),z}saveTileTexture(h){const m=this._tileTextures[h.size[0]];m?m.push(h):this._tileTextures[h.size[0]]=[h]}getTileTexture(h){const m=this._tileTextures[h];return m&&m.length>0?m.pop():null}isPatternMissing(h){return h===null||h!==void 0&&!this.imageManager.getPattern(h.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const h=this.terrain&&this.terrain.renderingToTexture,m=this.terrain&&this.terrain.exaggeration()===0,x=this.style&&this.style.fog,S=[];return this.terrainRenderModeElevated()&&S.push("TERRAIN"),this.transform.projection.name==="globe"&&S.push("GLOBE"),m&&S.push("ZERO_EXAGGERATION"),x&&!h&&x.getOpacity(this.transform.pitch)!==0&&S.push("FOG"),h&&S.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&S.push("OVERDRAW_INSPECTOR"),S}useProgram(h,m,x){this.cache=this.cache||{};const S=x||[],A=this.currentGlobalDefines().concat(S),R=Ci.cacheKey(cg[h],h,A,m);return this.cache[R]||(this.cache[R]=new Ci(this.context,h,cg[h],m,Sg[h],A)),this.cache[R]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const h=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(h.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=s.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(h,m,x){if(this.terrain&&this.terrain.renderingToTexture)return;const S=this.style.fog;if(S){const A=S.getOpacity(this.transform.pitch),R=((O,z,$,j,Z,re,he,ge,pe,_e,Y)=>{const ce=O.transform,Ee=z.properties.get("color").toArray01();Ee[3]=j;const Se=O.frameCounter/1e3%1;return{u_fog_matrix:$?ce.calculateFogTileMatrix($):O.identityMat,u_fog_range:z.getFovAdjustedRange(ce._fov),u_fog_color:Ee,u_fog_horizon_blend:z.properties.get("horizon-blend"),u_fog_temporal_offset:Se,u_frustum_tl:Z,u_frustum_tr:re,u_frustum_br:he,u_frustum_bl:ge,u_globe_pos:pe,u_globe_radius:_e,u_viewport:Y,u_globe_transition:s.globeToMercatorTransition(ce.zoom),u_is_globe:+(ce.projection.name==="globe")}})(this,S,x,A,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*s.exported.devicePixelRatio,this.transform.height*s.exported.devicePixelRatio]);m.setFogUniformValues(h,R)}}setTileLoadedFlag(h){this.tileLoaded=h}saveCanvasCopy(){const h=this.canvasCopy();h&&(this.frameCopies.push(h),this.tileLoaded=!1)}canvasCopy(){const h=this.context.gl,m=h.createTexture();return h.bindTexture(h.TEXTURE_2D,m),h.copyTexImage2D(h.TEXTURE_2D,0,h.RGBA,0,0,h.drawingBufferWidth,h.drawingBufferHeight,0),m}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const h=this.style&&this.style.fog;return!!h&&h.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const h=this._backgroundTiles,m=this._backgroundTiles={},x=this.transform.coveringTiles({tileSize:512});for(const S of x)m[S.key]=h[S.key]||new s.Tile(S,512,this.transform.tileZoom,this);return m}clearBackgroundTiles(){this._backgroundTiles={}}}class jf{constructor(h=0,m=0,x=0,S=0){if(isNaN(h)||h<0||isNaN(m)||m<0||isNaN(x)||x<0||isNaN(S)||S<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=h,this.bottom=m,this.left=x,this.right=S}interpolate(h,m,x){return m.top!=null&&h.top!=null&&(this.top=s.number(h.top,m.top,x)),m.bottom!=null&&h.bottom!=null&&(this.bottom=s.number(h.bottom,m.bottom,x)),m.left!=null&&h.left!=null&&(this.left=s.number(h.left,m.left,x)),m.right!=null&&h.right!=null&&(this.right=s.number(h.right,m.right,x)),this}getCenter(h,m){const x=s.clamp((this.left+h-this.right)/2,0,h),S=s.clamp((this.top+m-this.bottom)/2,0,m);return new s.Point(x,S)}equals(h){return this.top===h.top&&this.bottom===h.bottom&&this.left===h.left&&this.right===h.right}clone(){return new jf(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function $f(_,h){const m=s.getColumn(_,3);s.fromQuat(_,h),s.setColumn(_,3,m)}function Pi(_,h){const m=s.identity$1([]);return s.rotateZ$1(m,m,-h),s.rotateX$1(m,m,-_),m}function td(_,h){const m=[_[0],_[1],0],x=[h[0],h[1],0];if(s.length(m)>=1e-15){const R=s.normalize([],m);s.scale$2(x,R,s.dot(x,R)),h[0]=x[0],h[1]=x[1]}const S=s.cross([],h,_);if(s.len(S)<1e-15)return null;const A=Math.atan2(-S[1],S[0]);return Pi(Math.atan2(Math.sqrt(_[0]*_[0]+_[1]*_[1]),-_[2]),A)}class e1{constructor(h,m){this.position=h,this.orientation=m}get position(){return this._position}set position(h){if(h){const m=h instanceof s.MercatorCoordinate?h:new s.MercatorCoordinate(h[0],h[1],h[2]);this._renderWorldCopies&&(m.x=s.wrap(m.x,0,1)),this._position=m}else this._position=null}lookAtPoint(h,m){if(this.orientation=null,!this.position)return;const x=this.position,S=this._elevation?this._elevation.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(h)):0,A=s.MercatorCoordinate.fromLngLat(h,S),R=[A.x-x.x,A.y-x.y,A.z-x.z];m||(m=[0,0,1]),m[2]=Math.abs(m[2]),this.orientation=td(R,m)}setPitchBearing(h,m){this.orientation=Pi(s.degToRad(h),s.degToRad(-m))}}class Gf{constructor(h,m){this._transform=s.identity([]),this.orientation=m,this.position=h}get mercatorPosition(){const h=this.position;return new s.MercatorCoordinate(h[0],h[1],h[2])}get position(){const h=s.getColumn(this._transform,3);return[h[0],h[1],h[2]]}set position(h){var m;h&&s.setColumn(this._transform,3,[(m=h)[0],m[1],m[2],1])}get orientation(){return this._orientation}set orientation(h){this._orientation=h||s.identity$1([]),h&&$f(this._transform,this._orientation)}getPitchBearing(){const h=this.forward(),m=this.right();return{bearing:Math.atan2(-m[1],m[0]),pitch:Math.atan2(Math.sqrt(h[0]*h[0]+h[1]*h[1]),-h[2])}}setPitchBearing(h,m){this._orientation=Pi(h,m),$f(this._transform,this._orientation)}forward(){const h=s.getColumn(this._transform,2);return[-h[0],-h[1],-h[2]]}up(){const h=s.getColumn(this._transform,1);return[-h[0],-h[1],-h[2]]}right(){const h=s.getColumn(this._transform,0);return[h[0],h[1],h[2]]}getCameraToWorld(h,m){const x=new Float64Array(16);return s.invert(x,this.getWorldToCamera(h,m)),x}getWorldToCameraPosition(h,m,x){const S=this.position;s.scale$2(S,S,-h);const A=new Float64Array(16);return s.fromScaling(A,[x,x,x]),s.translate(A,A,S),A[10]*=m,A}getWorldToCamera(h,m){const x=new Float64Array(16),S=new Float64Array(4),A=this.position;return s.conjugate(S,this._orientation),s.scale$2(A,A,-h),s.fromQuat(x,S),s.translate(x,x,A),x[1]*=-1,x[5]*=-1,x[9]*=-1,x[13]*=-1,x[8]*=m,x[9]*=m,x[10]*=m,x[11]*=m,x}getCameraToClipPerspective(h,m,x,S){const A=new Float64Array(16);return s.perspective(A,h,m,x,S),A}getDistanceToElevation(h,m=!1){const x=h===0?0:s.mercatorZfromAltitude(h,m?s.latFromMercatorY(this.position[1]):this.position[1]),S=this.forward();return(x-this.position[2])/S[2]}clone(){return new Gf([...this.position],[...this.orientation])}}function Mu(_,h){const m=Hf(_.projection,_.zoom,_.width,_.height),x=function(A,R,O,z,$){const j=new s.LngLat(O.lng-180*nl,O.lat),Z=new s.LngLat(O.lng+180*nl,O.lat),re=A.project(j.lng,j.lat),he=A.project(Z.lng,Z.lat),ge=-Math.atan2(he.y-re.y,he.x-re.x),pe=s.MercatorCoordinate.fromLngLat(O);pe.y=s.clamp(pe.y,-1+nl,1-nl);const _e=pe.toLngLat(),Y=A.project(_e.lng,_e.lat),ce=s.MercatorCoordinate.fromLngLat(_e);ce.x+=nl;const Ee=ce.toLngLat(),Se=A.project(Ee.lng,Ee.lat),ze=Wf(Se.x-Y.x,Se.y-Y.y,ge),Ve=s.MercatorCoordinate.fromLngLat(_e);Ve.y+=nl;const Ne=Ve.toLngLat(),Ye=A.project(Ne.lng,Ne.lat),Xe=Wf(Ye.x-Y.x,Ye.y-Y.y,ge),st=Math.abs(ze.x)/Math.abs(Xe.y),Ut=s.identity([]);s.rotateZ(Ut,Ut,-ge*(1-($?0:z)));const nt=s.identity([]);return s.scale(nt,nt,[1,1-(1-st)*z,1]),nt[4]=-Xe.x/Xe.y*z,s.rotateZ(nt,nt,ge),s.multiply(nt,Ut,nt),nt}(_.projection,0,_.center,m,h),S=t1(_);return s.scale(x,x,[S,S,1]),x}function t1(_){const h=_.projection,m=Hf(_.projection,_.zoom,_.width,_.height),x=n1(h,_.center),S=n1(h,s.LngLat.convert(h.center));return Math.pow(2,x*m+(1-m)*S)}function Hf(_,h,m,x,S=1/0){const A=_.range;if(!A)return 0;const R=Math.min(S,Math.max(m,x)),O=Math.log(R/1024)/Math.LN2;return s.smoothstep(A[0]+O,A[1]+O,h)}const nl=1/4e4;function n1(_,h){const m=s.clamp(h.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),x=new s.LngLat(h.lng-180*nl,m),S=new s.LngLat(h.lng+180*nl,m),A=_.project(x.lng,m),R=_.project(S.lng,m),O=s.MercatorCoordinate.fromLngLat(x),z=s.MercatorCoordinate.fromLngLat(S),$=R.x-A.x,j=R.y-A.y,Z=z.x-O.x,re=z.y-O.y,he=Math.sqrt((Z*Z+re*re)/($*$+j*j));return Math.log(he)/Math.LN2}function Wf(_,h,m){const x=Math.cos(m),S=Math.sin(m);return{x:_*x-h*S,y:_*S+h*x}}class Ru{constructor(h,m,x,S,A,R,O){this.tileSize=512,this._renderWorldCopies=A===void 0||A,this._minZoom=h||0,this._maxZoom=m||22,this._minPitch=x??0,this._maxPitch=S??60,this.setProjection(R),this.setMaxBounds(O),this.width=0,this.height=0,this._center=new s.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new jf,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Gf,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const h=new Ru(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return h._elevation=this._elevation,h._centerAltitude=this._centerAltitude,h._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,h.tileSize=this.tileSize,h.mercatorFromTransition=this.mercatorFromTransition,h.width=this.width,h.height=this.height,h.cameraElevationReference=this.cameraElevationReference,h._center=this._center,h._setZoom(this.zoom),h._seaLevelZoom=this._seaLevelZoom,h.angle=this.angle,h._fov=this._fov,h._pitch=this._pitch,h._nearZ=this._nearZ,h._farZ=this._farZ,h._averageElevation=this._averageElevation,h._unmodified=this._unmodified,h._edgeInsets=this._edgeInsets.clone(),h._camera=this._camera.clone(),h._calcMatrices(),h.freezeTileCoverage=this.freezeTileCoverage,h.frustumCorners=this.frustumCorners,h}get elevation(){return this._elevation}set elevation(h){this._elevation!==h&&(this._elevation=h,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(h,m=!1){const x=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||x)&&this._updateCameraOnTerrain(),(h||x)&&this._constrainCamera(m),this._calcMatrices()}getProjection(){return s.pick(this.projection,["name","center","parallels"])}setProjection(h){this.projectionOptions=h||{name:"mercator"};const m=this.projection?this.getProjection():void 0;this.projection=s.getProjection(this.projectionOptions);const x=!d(m,this.getProjection());return x&&this._calcMatrices(),this.mercatorFromTransition=!1,x}setMercatorFromTransition(){const h=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=s.getProjection({name:"mercator"});const m=h!==this.projection.name;return m&&this._calcMatrices(),m}get minZoom(){return this._minZoom}set minZoom(h){this._minZoom!==h&&(this._minZoom=h,this.zoom=Math.max(this.zoom,h))}get maxZoom(){return this._maxZoom}set maxZoom(h){this._maxZoom!==h&&(this._maxZoom=h,this.zoom=Math.min(this.zoom,h))}get minPitch(){return this._minPitch}set minPitch(h){this._minPitch!==h&&(this._minPitch=h,this.pitch=Math.max(this.pitch,h))}get maxPitch(){return this._maxPitch}set maxPitch(h){this._maxPitch!==h&&(this._maxPitch=h,this.pitch=Math.min(this.pitch,h))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(h){h===void 0?h=!0:h===null&&(h=!1),this._renderWorldCopies=h}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const h=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(h))}get cameraWorldSize(){const h=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(h))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return s.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.Point(this.width,this.height)}get bearing(){return s.wrap(this.rotation,-180,180)}set bearing(h){this.rotation=h}get rotation(){return-this.angle/Math.PI*180}set rotation(h){const m=-h*Math.PI/180;var x;this.angle!==m&&(this._unmodified=!1,this.angle=m,this._calcMatrices(),this.rotationMatrix=(x=new s.ARRAY_TYPE(4),s.ARRAY_TYPE!=Float32Array&&(x[1]=0,x[2]=0),x[0]=1,x[3]=1,x),function(S,A,R){var O=A[0],z=A[1],$=A[2],j=A[3],Z=Math.sin(R),re=Math.cos(R);S[0]=O*re+$*Z,S[1]=z*re+j*Z,S[2]=O*-Z+$*re,S[3]=z*-Z+j*re}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(h){const m=s.clamp(h,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==m&&(this._unmodified=!1,this._pitch=m,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const h=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/h)}set fov(h){h=Math.max(.01,Math.min(60,h)),this._fov!==h&&(this._unmodified=!1,this._fov=s.degToRad(h),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(h){this._averageElevation=h,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(h){const m=Math.min(Math.max(h,this.minZoom),this.maxZoom);this._zoom!==m&&(this._unmodified=!1,this._setZoom(m),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(h){this._zoom=h,this.scale=this.zoomScale(h),this.tileZoom=Math.floor(h),this.zoomFraction=h-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const h=this._elevation;this._centerAltitude=h.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=h.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const h=this._elevation,m=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],x=this.horizonLineFromTop();let S=0,A=0;for(let R=0;R<m.length;R++){const O=new s.Point(m[R][0]*this.width,x+m[R][1]*(this.height-x)),z=h.pointCoordinate(O);if(!z)continue;const $=1/Math.hypot(z[0]-this._camera.position[0],z[1]-this._camera.position[1]);S+=z[3]*$,A+=$}return A===0?NaN:S/A}get center(){return this._center}set center(h){h.lat===this._center.lat&&h.lng===this._center.lng||(this._unmodified=!1,this._center=h,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const h=this._seaLevelZoom,m=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),x=this.pixelsPerMeter/this.worldSize*m,S=this._mercatorZfromZoom(h),A=this._mercatorZfromZoom(this._maxZoom),R=Math.max(S-x,A);this._setZoom(this._zoomFromMercatorZ(R))}get padding(){return this._edgeInsets.toJSON()}set padding(h){this._edgeInsets.equals(h)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,h,1),this._calcMatrices())}computeZoomRelativeTo(h){const m=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,h.toAltitude()));let x;x=h.z<this._camera.position[2]?[m.x,m.y,m.z]:[h.x,h.y,h.z];const S=s.length(s.sub([],this._camera.position,x));return s.clamp(this._zoomFromMercatorZ(S),this._minZoom,this._maxZoom)}setFreeCameraOptions(h){if(!this.height||!h.position&&!h.orientation)return;this._updateCameraState();let m=!1;if(h.orientation&&!s.exactEquals(h.orientation,this._camera.orientation)&&(m=this._setCameraOrientation(h.orientation)),h.position){const x=[h.position.x,h.position.y,h.position.z];s.exactEquals$1(x,this._camera.position)||(this._setCameraPosition(x),m=!0)}m&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const h=this._camera.position,m=new e1;return m.position=new s.MercatorCoordinate(h[0],h[1],h[2]),m.orientation=this._camera.orientation,m._elevation=this.elevation,m._renderWorldCopies=this.renderWorldCopies,m}_setCameraOrientation(h){if(!s.length$1(h))return!1;s.normalize$1(h,h);const m=s.transformQuat([],[0,0,-1],h),x=s.transformQuat([],[0,-1,0],h);if(x[2]<0)return!1;const S=td(m,x);return!!S&&(this._camera.orientation=S,!0)}_setCameraPosition(h){const m=this.zoomScale(this.minZoom)*this.tileSize,x=this.zoomScale(this.maxZoom)*this.tileSize,S=this.cameraToCenterDistance;h[2]=s.clamp(h[2],S/x,S/m),this._camera.position=h}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(h){return this._edgeInsets.equals(h)}interpolatePadding(h,m,x){this._unmodified=!1,this._edgeInsets.interpolate(h,m,x),this._constrain(),this._calcMatrices()}coveringZoomLevel(h){const m=(h.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/h.tileSize));return Math.max(0,m)}getVisibleUnwrappedCoordinates(h){const m=[new s.UnwrappedTileID(0,h)];if(this.renderWorldCopies){const x=this.pointCoordinate(new s.Point(0,0)),S=this.pointCoordinate(new s.Point(this.width,0)),A=this.pointCoordinate(new s.Point(this.width,this.height)),R=this.pointCoordinate(new s.Point(0,this.height)),O=Math.floor(Math.min(x.x,S.x,A.x,R.x)),z=Math.floor(Math.max(x.x,S.x,A.x,R.x)),$=1;for(let j=O-$;j<=z+$;j++)j!==0&&m.push(new s.UnwrappedTileID(j,h))}return m}coveringTiles(h){let m=this.coveringZoomLevel(h);const x=m,S=this.elevation&&!h.isTerrainDEM,A=this.projection.name==="mercator";if(h.minzoom!==void 0&&m<h.minzoom)return[];h.maxzoom!==void 0&&m>h.maxzoom&&(m=h.maxzoom);const R=this.locationCoordinate(this.center),O=this.center.lat,z=1<<m,$=[z*R.x,z*R.y,0],j=this.projection.name==="globe",Z=!j,re=s.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,m,Z),he=j?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ge=z*s.mercatorZfromAltitude(1,this.center.lat),pe=this._camera.position[2]/s.mercatorZfromAltitude(1,this.center.lat),_e=[z*he.x,z*he.y,pe*(Z?1:ge)],Y=this.cameraToCenterDistance/h.tileSize*(h.roundZoom?1:.502),ce=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?m:0,Ee=h.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,Se=h.isTerrainDEM?-Ee:this._elevation?this._elevation.getMinElevationBelowMSL():0,ze=this.projection.isReprojectedInTileSpace?t1(this):1,Ve=ot=>{const jt=new s.MercatorCoordinate(ot.x+25e-6,ot.y,ot.z),Mt=new s.MercatorCoordinate(ot.x,ot.y+25e-6,ot.z),Gt=ot.toLngLat(),In=jt.toLngLat(),Qn=Mt.toLngLat(),gn=this.locationCoordinate(Gt),Fn=this.locationCoordinate(In),yi=this.locationCoordinate(Qn),gi=Math.hypot(Fn.x-gn.x,Fn.y-gn.y),Sn=Math.hypot(yi.x-gn.x,yi.y-gn.y);return Math.sqrt(gi*Sn)*ze/25e-6},Ne=ot=>{const xt=Ee,jt=Se;return{aabb:s.tileAABB(this,z,0,0,0,ot,jt,xt,this.projection),zoom:0,x:0,y:0,minZ:jt,maxZ:xt,wrap:ot,fullyVisible:!1}},Ye=[];let Xe=[];const st=m,Ut=h.reparseOverscaled?x:m,nt=ot=>ot*ot,wt=nt((pe-this._centerAltitude)*ge),dt=ot=>{if(!this._elevation||!ot.tileID||!A)return;const xt=this._elevation.getMinMaxForTile(ot.tileID),jt=ot.aabb;xt?(jt.min[2]=xt.min,jt.max[2]=xt.max,jt.center[2]=(jt.min[2]+jt.max[2])/2):(ot.shouldSplit=Bt(ot),ot.shouldSplit||(jt.min[2]=jt.max[2]=jt.center[2]=this._centerAltitude))},Bt=ot=>{if(ot.zoom<ce)return!0;if(ot.zoom===st)return!1;if(ot.shouldSplit!=null)return ot.shouldSplit;const xt=ot.aabb.distanceX(_e),jt=ot.aabb.distanceY(_e);let Mt=wt,Gt=1;if(j){Mt=nt(ot.aabb.distanceZ(_e));const gn=Math.pow(2,ot.zoom),Fn=s.latFromMercatorY((ot.y+1)/gn),yi=s.latFromMercatorY(ot.y/gn),gi=Math.min(Math.max(O,Fn),yi),Sn=s.circumferenceAtLatitude(gi)/s.circumferenceAtLatitude(O);if(Gt=gi===O?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Sn/this._mercatorScaleRatio),this.zoom<=s.GLOBE_ZOOM_THRESHOLD_MIN&&ot.zoom===st-1&&Sn>=.9)return!0}else if(S&&(Mt=nt(ot.aabb.distanceZ(_e)*ge)),this.projection.isReprojectedInTileSpace&&x<=5){const gn=Math.pow(2,ot.zoom),Fn=Ve(new s.MercatorCoordinate((ot.x+.5)/gn,(ot.y+.5)/gn));Gt=Fn>.85?1:Fn}const In=xt*xt+jt*jt+Mt,Qn=nt((1<<st-ot.zoom)*Y*Gt*((gn,Fn)=>{if(Fn*nt(.707)<gn)return 1;const yi=Math.sqrt(Fn/gn);return yi/(1.4144271570014144+(Math.pow(1.1,yi-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Mt,wt),In));return In<Qn};if(this.renderWorldCopies)for(let ot=1;ot<=3;ot++)Ye.push(Ne(-ot)),Ye.push(Ne(ot));for(Ye.push(Ne(0));Ye.length>0;){const ot=Ye.pop(),xt=ot.x,jt=ot.y;let Mt=ot.fullyVisible;if(!Mt){const Gt=ot.aabb.intersects(re);if(Gt===0)continue;Mt=Gt===2}if(ot.zoom!==st&&Bt(ot))for(let Gt=0;Gt<4;Gt++){const In=(xt<<1)+Gt%2,Qn=(jt<<1)+(Gt>>1),gn={aabb:A?ot.aabb.quadrant(Gt):s.tileAABB(this,z,ot.zoom+1,In,Qn,ot.wrap,ot.minZ,ot.maxZ,this.projection),zoom:ot.zoom+1,x:In,y:Qn,wrap:ot.wrap,fullyVisible:Mt,tileID:void 0,shouldSplit:void 0,minZ:ot.minZ,maxZ:ot.maxZ};S&&!j&&(gn.tileID=new s.OverscaledTileID(ot.zoom+1===st?Ut:ot.zoom+1,ot.wrap,ot.zoom+1,In,Qn),dt(gn)),Ye.push(gn)}else{const Gt=ot.zoom===st?Ut:ot.zoom;if(h.minzoom&&h.minzoom>Gt)continue;const In=$[0]-(.5+xt+(ot.wrap<<ot.zoom))*(1<<m-ot.zoom),Qn=$[1]-.5-jt,gn=ot.tileID?ot.tileID:new s.OverscaledTileID(Gt,ot.wrap,ot.zoom,xt,jt);Xe.push({tileID:gn,distanceSq:In*In+Qn*Qn})}}if(this.fogCullDistSq){const ot=this.fogCullDistSq,xt=this.horizonLineFromTop();Xe=Xe.filter(jt=>{const Mt=[0,0,0,1],Gt=[s.EXTENT,s.EXTENT,0,1],In=this.calculateFogTileMatrix(jt.tileID.toUnwrapped());s.transformMat4$1(Mt,Mt,In),s.transformMat4$1(Gt,Gt,In);const Qn=s.getAABBPointSquareDist(Mt,Gt);if(Qn===0)return!0;let gn=!1;const Fn=this._elevation;if(Fn&&Qn>ot&&xt!==0){const yi=this.calculateProjMatrix(jt.tileID.toUnwrapped());let gi;h.isTerrainDEM||(gi=Fn.getMinMaxForTile(jt.tileID)),gi||(gi={min:Se,max:Ee});const Sn=s.furthestTileCorner(this.rotation),Ui=[Sn[0]*s.EXTENT,Sn[1]*s.EXTENT,gi.max];s.transformMat4(Ui,Ui,yi),gn=(1-Ui[1])*this.height*.5<xt}return Qn<ot||gn})}return Xe.sort((ot,xt)=>ot.distanceSq-xt.distanceSq).map(ot=>ot.tileID)}resize(h,m){this.width=h,this.height=m,this.pixelsToGLUnits=[2/h,-2/m],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(h){return Math.pow(2,h)}scaleZoom(h){return Math.log(h)/Math.LN2}project(h){const m=s.clamp(h.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),x=this.projection.project(h.lng,m);return new s.Point(x.x*this.worldSize,x.y*this.worldSize)}unproject(h){return this.projection.unproject(h.x/this.worldSize,h.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/s.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(h,m){let x,S;const A=this.centerPoint;if(this.projection.name==="globe"){const O=this.worldSize;x=(m.x-A.x)/O,S=(m.y-A.y)/O}else{const O=this.pointCoordinate(m),z=this.pointCoordinate(A);x=O.x-z.x,S=O.y-z.y}const R=this.locationCoordinate(h);this.setLocation(new s.MercatorCoordinate(R.x-x,R.y-S))}setLocation(h){this.center=this.coordinateLocation(h),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(h){return this.projection.locationPoint(this,h)}locationPoint3D(h){return this.projection.locationPoint(this,h,!0)}pointLocation(h){return this.coordinateLocation(this.pointCoordinate(h))}pointLocation3D(h){return this.coordinateLocation(this.pointCoordinate3D(h))}locationCoordinate(h,m){const x=m?s.mercatorZfromAltitude(m,h.lat):void 0,S=this.projection.project(h.lng,h.lat);return new s.MercatorCoordinate(S.x,S.y,x)}coordinateLocation(h){return this.projection.unproject(h.x,h.y)}pointRayIntersection(h,m){const x=m??this._centerAltitude,S=[h.x,h.y,0,1],A=[h.x,h.y,1,1];s.transformMat4$1(S,S,this.pixelMatrixInverse),s.transformMat4$1(A,A,this.pixelMatrixInverse);const R=A[3];s.scale$1(S,S,1/S[3]),s.scale$1(A,A,1/R);const O=S[2],z=A[2];return{p0:S,p1:A,t:O===z?0:(x-O)/(z-O)}}screenPointToMercatorRay(h){const m=[h.x,h.y,0,1],x=[h.x,h.y,1,1];return s.transformMat4$1(m,m,this.pixelMatrixInverse),s.transformMat4$1(x,x,this.pixelMatrixInverse),s.scale$1(m,m,1/m[3]),s.scale$1(x,x,1/x[3]),m[2]=s.mercatorZfromAltitude(m[2],this._center.lat)*this.worldSize,x[2]=s.mercatorZfromAltitude(x[2],this._center.lat)*this.worldSize,s.scale$1(m,m,1/this.worldSize),s.scale$1(x,x,1/this.worldSize),new s.Ray([m[0],m[1],m[2]],s.normalize([],s.sub([],x,m)))}rayIntersectionCoordinate(h){const{p0:m,p1:x,t:S}=h,A=s.mercatorZfromAltitude(m[2],this._center.lat),R=s.mercatorZfromAltitude(x[2],this._center.lat);return new s.MercatorCoordinate(s.number(m[0],x[0],S)/this.worldSize,s.number(m[1],x[1],S)/this.worldSize,s.number(A,R,S))}pointCoordinate(h,m=this._centerAltitude){return this.projection.pointCoordinate(this,h.x,h.y,m)}pointCoordinate3D(h){if(!this.elevation)return this.pointCoordinate(h);let m=this.projection.pointCoordinate3D(this,h.x,h.y);if(m)return new s.MercatorCoordinate(m[0],m[1],m[2]);let x=0,S=this.horizonLineFromTop();if(h.y>S)return this.pointCoordinate(h);const A=.02*S,R=h.clone();for(let O=0;O<10&&S-x>A;O++){R.y=s.number(x,S,.66);const z=this.projection.pointCoordinate3D(this,R.x,R.y);z?(S=R.y,m=z):x=R.y}return m?new s.MercatorCoordinate(m[0],m[1],m[2]):this.pointCoordinate(h)}isPointAboveHorizon(h){return this.projection.isPointAboveHorizon(this,h)}isPointOnSurface(h){if(h.y<0||h.y>this.height||h.x<0||h.x>this.width)return!1;if(this.elevation||this.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(h);const m=this.pointCoordinate(h);return m.y>=0&&m.y<=1}_coordinatePoint(h,m){const x=m&&this.elevation?this.elevation.getAtPointOrZero(h,this._centerAltitude):this._centerAltitude,S=[h.x*this.worldSize,h.y*this.worldSize,x+h.toAltitude(),1];return s.transformMat4$1(S,S,this.pixelMatrix),S[3]>0?new s.Point(S[0]/S[3],S[1]/S[3]):new s.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:h,left:m}=this._edgeInsets,x=this.height-this._edgeInsets.bottom,S=this.width-this._edgeInsets.right,A=this.pointLocation3D(new s.Point(m,h)),R=this.pointLocation3D(new s.Point(S,h)),O=this.pointLocation3D(new s.Point(S,x)),z=this.pointLocation3D(new s.Point(m,x));let $=Math.min(A.lng,R.lng,O.lng,z.lng),j=Math.max(A.lng,R.lng,O.lng,z.lng),Z=Math.min(A.lat,R.lat,O.lat,z.lat),re=Math.max(A.lat,R.lat,O.lat,z.lat);const he=Math.pow(2,-this.zoom)/16*270,ge=this.projection.name==="globe"?1:4,pe=(_e,Y,ce,Ee,Se)=>{const ze=(_e+ce)/2,Ve=(Y+Ee)/2,Ne=new s.Point(ze,Ve),{lng:Ye,lat:Xe}=this.pointLocation3D(Ne),st=Math.max(0,$-Ye,Z-Xe,Ye-j,Xe-re);$=Math.min($,Ye),j=Math.max(j,Ye),Z=Math.min(Z,Xe),re=Math.max(re,Xe),(Se<ge||st>he)&&(pe(_e,Y,ze,Ve,Se+1),pe(ze,Ve,ce,Ee,Se+1))};if(pe(m,h,S,h,1),pe(S,h,S,x,1),pe(S,x,m,x,1),pe(m,x,m,h,1),this.projection.name==="globe"){const[_e,Y]=s.polesInViewport(this);_e?(re=90,j=180,$=-180):Y&&(Z=-90,j=180,$=-180)}return new s.LngLatBounds(new s.LngLat($,Z),new s.LngLat(j,re))}_getBoundsRectangular(h,m){const{top:x,left:S}=this._edgeInsets,A=this.height-this._edgeInsets.bottom,R=this.width-this._edgeInsets.right,O=new s.Point(S,x),z=new s.Point(R,x),$=new s.Point(R,A),j=new s.Point(S,A);let Z=this.pointCoordinate(O,h),re=this.pointCoordinate(z,h);const he=this.pointCoordinate($,m),ge=this.pointCoordinate(j,m),pe=(_e,Y)=>(Y.y-_e.y)/(Y.x-_e.x);return Z.y>1&&re.y>=0?Z=new s.MercatorCoordinate((1-ge.y)/pe(ge,Z)+ge.x,1):Z.y<0&&re.y<=1&&(Z=new s.MercatorCoordinate(-ge.y/pe(ge,Z)+ge.x,0)),re.y>1&&Z.y>=0?re=new s.MercatorCoordinate((1-he.y)/pe(he,re)+he.x,1):re.y<0&&Z.y<=1&&(re=new s.MercatorCoordinate(-he.y/pe(he,re)+he.x,0)),new s.LngLatBounds().extend(this.coordinateLocation(Z)).extend(this.coordinateLocation(re)).extend(this.coordinateLocation(ge)).extend(this.coordinateLocation(he))}_getBoundsRectangularTerrain(){const h=this.elevation;if(!h.visibleDemTiles.length||h.isUsingMockSource())return this._getBoundsRectangular(0,0);const m=h.visibleDemTiles.reduce((x,S)=>{if(S.dem){const A=S.dem.tree;x.min=Math.min(x.min,A.minimums[0]),x.max=Math.max(x.max,A.maximums[0])}return x},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(m.min*h.exaggeration(),m.max*h.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(h=!0){const m=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,x=this.height/2-m*(1-this._horizonShift);return h?Math.max(0,x):x}getMaxBounds(){return this.maxBounds}setMaxBounds(h){this.maxBounds=h,this.minLat=-s.MAX_MERCATOR_LATITUDE,this.maxLat=s.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,h&&(this.minLat=h.getSouth(),this.maxLat=h.getNorth(),this.minLng=h.getWest(),this.maxLng=h.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=s.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=s.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=s.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=s.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(h,m){return this.projection.createTileMatrix(this,m,h)}calculateDistanceTileData(h){const m=h.key,x=this._distanceTileDataCache;if(x[m])return x[m];const S=h.canonical,A=1/this.height,R=this.cameraWorldSize,O=R/this.zoomScale(S.z),z=(S.x+Math.pow(2,S.z)*h.wrap)*O,$=S.y*O,j=this.point;j.x*=R/this.worldSize,j.y*=R/this.worldSize;const Z=this.angle,re=Math.sin(-Z),he=-Math.cos(-Z);return x[m]={bearing:[re,he],center:[(j.x-z)*A,(j.y-$)*A],scale:O/s.EXTENT*A},x[m]}calculateFogTileMatrix(h){const m=h.key,x=this._fogTileMatrixCache;if(x[m])return x[m];const S=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,h);return s.multiply(S,this.worldToFogMatrix,S),x[m]=new Float32Array(S),x[m]}calculateProjMatrix(h,m=!1){const x=h.key,S=m?this._alignedProjMatrixCache:this._projMatrixCache;if(S[x])return S[x];const A=this.calculatePosMatrix(h,this.worldSize);return s.multiply(A,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:m?this.alignedProjMatrix:this.projMatrix,A),S[x]=new Float32Array(A),S[x]}calculatePixelsToTileUnitsMatrix(h){const m=h.tileID.key,x=this._pixelsToTileUnitsCache;if(x[m])return x[m];const S=function(A,R){const{scale:O}=A.tileTransform,z=O*s.EXTENT/(A.tileSize*Math.pow(2,R.zoom-A.tileID.overscaledZ+A.tileID.canonical.z));return $=new Float32Array(4),re=(j=R.inverseAdjustmentMatrix)[1],he=j[2],ge=j[3],_e=(Z=[z,z])[1],$[0]=j[0]*(pe=Z[0]),$[1]=re*pe,$[2]=he*_e,$[3]=ge*_e,$;var $,j,Z,re,he,ge,pe,_e}(h,this);return x[m]=S,x[m]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const h=1/this.worldSize,m=s.fromScaling([],[h,h,h]);return s.multiply(m,m,this.globeMatrix),m}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const h=this._elevation;this._updateCameraState();const m=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(m),S=this._camera.forward(),A=s.mercatorZfromAltitude(1,this._center.lat);x[2]/=A,S[2]/=A,s.normalize(S,S);const R=h.raycast(x,S,h.exaggeration());if(R){const O=s.scaleAndAdd([],x,S,R),z=new s.MercatorCoordinate(O[0],O[1],s.mercatorZfromAltitude(O[2],s.latFromMercatorY(O[1]))),$=(z.z+s.length([z.x-x[0],z.y-x[1],z.z-x[2]*A]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ($),this._centerAltitude=z.toAltitude(),this._center=this.coordinateLocation(z),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(h=!1){if(!this._elevation)return;const m=this._elevation,x=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,S=this._computeCameraPosition(x),A=m.getAtPointOrZero(new s.MercatorCoordinate(...S)),R=this.pixelsPerMeter/this.worldSize*A,O=this._minimumHeightOverTerrain(),z=S[2]-R;if(z<=O)if(z<0||h){const $=this.locationCoordinate(this._center,this._centerAltitude),j=[S[0],S[1],$.z-S[2]],Z=s.length(j);j[2]-=(O-z)/this._pixelsPerMercatorPixel;const re=s.length(j);if(re===0)return;s.scale$2(j,j,Z/re*this._pixelsPerMercatorPixel),this._camera.position=[S[0],S[1],$.z*this._pixelsPerMercatorPixel-j[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const h=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||h){const re=this.center;return re.lat=s.clamp(re.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!h)&&(re.lng=s.clamp(re.lng,this.minLng,this.maxLng)),this.center=re,void(this._constraining=!1)}const m=this._unmodified,{x,y:S}=this.point;let A=0,R=x,O=S;const z=this.width/2,$=this.height/2,j=this.worldMinY*this.scale,Z=this.worldMaxY*this.scale;if(S-$<j&&(O=j+$),S+$>Z&&(O=Z-$),Z-j<this.height&&(A=Math.max(A,this.height/(Z-j)),O=(Z+j)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const re=this.worldMinX*this.scale,he=this.worldMaxX*this.scale,ge=this.worldSize/2-(re+he)/2;R=(x+ge+this.worldSize)%this.worldSize-ge,R-z<re&&(R=re+z),R+z>he&&(R=he-z),he-re<this.width&&(A=Math.max(A,this.width/(he-re)),R=(he+re)/2)}R===x&&O===S||(this.center=this.unproject(new s.Point(R,O))),A&&(this.zoom+=this.scaleZoom(A)),this._constrainCamera(),this._unmodified=m,this._constraining=!1}_minZoomForBounds(){let h=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(h=Math.max(h,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),h}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const h=this.centerOffset,m=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=s.mercatorZfromAltitude(1,this.center.lat)/s.mercatorZfromAltitude(1,s.GLOBE_SCALE_MATCH_LATITUDE));const x=Hf(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,x),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const S=this.projection.zAxisUnit==="meters"?m:1,A=this._camera.getWorldToCamera(this.worldSize,S),R=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);R[8]=2*-h.x/this.width,R[9]=2*h.y/this.height;let O=s.mul([],R,A);if(this.projection.isReprojectedInTileSpace){const Ve=this.locationCoordinate(this.center),Ne=s.identity([]);s.translate(Ne,Ne,[Ve.x*this.worldSize,Ve.y*this.worldSize,0]),s.multiply(Ne,Ne,Mu(this)),s.translate(Ne,Ne,[-Ve.x*this.worldSize,-Ve.y*this.worldSize,0]),s.multiply(O,O,Ne),this.inverseAdjustmentMatrix=function(Ye){const Xe=Mu(Ye,!0);return J([],[Xe[0],Xe[1],Xe[4],Xe[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=s.scale([],O,[this.worldSize,this.worldSize,this.worldSize/S,1]),this.projMatrix=O,this.invProjMatrix=s.invert(new Float64Array(16),this.projMatrix);const z=s.invert([],R);this.frustumCorners=s.FrustumCorners.fromInvProjectionMatrix(z,this.horizonLineFromTop(),this.height);const $=new Float32Array(16);s.identity($),s.scale($,$,[1,-1,1]),s.rotateX($,$,this._pitch),s.rotateZ($,$,this.angle);const j=s.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),Z=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;j[8]=2*-h.x/this.width,j[9]=2*(h.y+Z)/this.height,this.skyboxMatrix=s.multiply($,j,$);const re=this.point,he=re.x,ge=re.y,pe=this.width%2/2,_e=this.height%2/2,Y=Math.cos(this.angle),ce=Math.sin(this.angle),Ee=he-Math.round(he)+Y*pe+ce*_e,Se=ge-Math.round(ge)+Y*_e+ce*pe,ze=new Float64Array(O);if(s.translate(ze,ze,[Ee>.5?Ee-1:Ee,Se>.5?Se-1:Se,0]),this.alignedProjMatrix=ze,O=s.create(),s.scale(O,O,[this.width/2,-this.height/2,1]),s.translate(O,O,[1,-1,0]),this.labelPlaneMatrix=O,O=s.create(),s.scale(O,O,[1,-1,1]),s.translate(O,O,[-1,-1,0]),s.scale(O,O,[2/this.width,2/this.height,1]),this.glCoordMatrix=O,this.pixelMatrix=s.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},O=s.invert(new Float64Array(16),this.pixelMatrix),!O)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=O,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=s.calculateGlobeMatrix(this);const Ve=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=s.transformMat4(Ve,Ve,A),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=O;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const h=this.cameraWorldSizeForFog,m=this.cameraPixelsPerMeter,x=this._camera.position,S=1/this.height/this._pixelsPerMercatorPixel,A=[h,h,m];s.scale$2(A,A,S),s.scale$2(x,x,-1),s.multiply$2(x,x,A);const R=s.create();s.translate(R,R,x),s.scale(R,R,A),this.mercatorFogMatrix=R,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(h,m,S)}_computeCameraPosition(h){const m=(h=h||this.pixelsPerMeter)/this.pixelsPerMeter,x=this._camera.forward(),S=this.point,A=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*m-h/this.worldSize*this._centerAltitude;return[S.x/this.worldSize-x[0]*A,S.y/this.worldSize-x[1]*A,h/this.worldSize*this._centerAltitude-x[2]*A]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(h){const m=this._maxCameraBoundsDistance()*Math.cos(this._pitch),x=this._camera.position[2],S=h[2];let A=1;this.projection.wrap&&(this.center=this.center.wrap()),S>0&&(A=Math.min((m-x)/S,1)),this._camera.position=s.scaleAndAdd([],this._camera.position,h,A),this._updateStateFromCamera()}_updateStateFromCamera(){const h=this._camera.position,m=this._camera.forward(),{pitch:x,bearing:S}=this._camera.getPitchBearing(),A=s.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,R=this._mercatorZfromZoom(this._maxZoom)*Math.cos(s.degToRad(this._maxPitch)),O=Math.max((h[2]-A)/Math.cos(x),R),z=this._zoomFromMercatorZ(O);s.scaleAndAdd(h,h,m,O),this._pitch=s.clamp(x,s.degToRad(this.minPitch),s.degToRad(this.maxPitch)),this.angle=s.wrap(S,-Math.PI,Math.PI),this._setZoom(s.clamp(z,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new s.MercatorCoordinate(h[0],h[1],h[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(h){return Math.pow(2,h)*this.tileSize}_mercatorZfromZoom(h){return this.cameraToCenterDistance/this._worldSizeFromZoom(h)}_minimumHeightOverTerrain(){const h=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(h)}_zoomFromMercatorZ(h){return this.scaleZoom(this.cameraToCenterDistance/(h*this.tileSize))}zoomFromMercatorZAdjusted(h){let m=0,x=s.GLOBE_ZOOM_THRESHOLD_MAX,S=0,A=1/0;for(;x-m>1e-6&&x>m;){const R=m+.5*(x-m),O=this.tileSize*Math.pow(2,R),z=this.getCameraToCenterDistance(this.projection,R,O),$=this.scaleZoom(z/(h*this.tileSize)),j=Math.abs(R-$);j<A&&(A=j,S=R),R<$?m=R:x=R}return S}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(s.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(h,m){const x=Math.min(h.x,m.x),S=Math.max(h.x,m.x),A=Math.min(h.y,m.y),R=Math.max(h.y,m.y);if(A<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const O=[new s.Point(x,A),new s.Point(S,R),new s.Point(x,R),new s.Point(S,A)],z=this.renderWorldCopies?-3:0,$=this.renderWorldCopies?4:1;for(const j of O){const Z=this.pointRayIntersection(j);if(Z.t<0)return!0;const re=this.rayIntersectionCoordinate(Z);if(re.x<z||re.y<0||re.x>$||re.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+s.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new s.Point(0,0),new s.Point(this.width,this.height))}zoomDeltaToMovement(h,m){const x=s.length(s.sub([],this._camera.position,h)),S=this._zoomFromMercatorZ(x)+m;return x-this._mercatorZfromZoom(S)}getCameraPoint(){if(this.projection.name==="globe"){const h=function([m,x,S],A){const R=[m,x,S,1];s.transformMat4$1(R,R,A);const O=R[3]=Math.max(R[3],1e-6);return R[0]/=O,R[1]/=O,R[2]/=O,R}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new s.Point(h[0],h[1])}{const h=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.Point(0,h))}}getCameraToCenterDistance(h,m=this.zoom,x=this.worldSize){const S=Hf(h,m,this.width,this.height,1024),A=h.pixelSpaceConversion(this.center.lat,x,S);return .5/Math.tan(.5*this._fov)*this.height*A}getWorldToCameraMatrix(){const h=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&s.multiply(h,h,this.globeMatrix),h}}function Lu(_,h){let m=!1,x=null;const S=()=>{x=null,m&&(_(),x=setTimeout(S,h),m=!1)};return()=>(m=!0,x||S(),x)}class Pg{constructor(h){this._hashName=h&&encodeURIComponent(h),s.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Lu(this._updateHashUnthrottled.bind(this),300)}addTo(h){return this._map=h,s.window.addEventListener("hashchange",this._onHashChange,!1),h.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),s.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const h=this._map;if(!h)return"";const m=nd(h);if(this._hashName){const x=this._hashName;let S=!1;const A=s.window.location.hash.slice(1).split("&").map(R=>{const O=R.split("=")[0];return O===x?(S=!0,`${O}=${m}`):R}).filter(R=>R);return S||A.push(`${x}=${m}`),`#${A.join("&")}`}return`#${m}`}_getCurrentHash(){const h=s.window.location.hash.replace("#","");if(this._hashName){let m;return h.split("&").map(x=>x.split("=")).forEach(x=>{x[0]===this._hashName&&(m=x)}),(m&&m[1]||"").split("/")}return h.split("/")}_onHashChange(){const h=this._map;if(!h)return!1;const m=this._getCurrentHash();if(m.length>=3&&!m.some(x=>isNaN(x))){const x=h.dragRotate.isEnabled()&&h.touchZoomRotate.isEnabled()?+(m[3]||0):h.getBearing();return h.jumpTo({center:[+m[2],+m[1]],zoom:+m[0],bearing:x,pitch:+(m[4]||0)}),!0}return!1}_updateHashUnthrottled(){const h=s.window.location.href.replace(/(#.+)?$/,this.getHashString());s.window.history.replaceState(s.window.history.state,null,h)}}function nd(_,h){const m=_.getCenter(),x=Math.round(100*_.getZoom())/100,S=Math.ceil((x*Math.LN2+Math.log(512/360/.5))/Math.LN10),A=Math.pow(10,S),R=Math.round(m.lng*A)/A,O=Math.round(m.lat*A)/A,z=_.getBearing(),$=_.getPitch();let j=h?`/${R}/${O}/${x}`:`${x}/${O}/${R}`;return(z||$)&&(j+="/"+Math.round(10*z)/10),$&&(j+=`/${Math.round($)}`),j}const id={linearity:.3,easing:s.bezier(0,0,.3,1)},Kf=s.extend({deceleration:2500,maxSpeed:1400},id),Xf=s.extend({deceleration:20,maxSpeed:1400},id),ln=s.extend({deceleration:1e3,maxSpeed:360},id),sa=s.extend({deceleration:1e3,maxSpeed:90},id);class i1{constructor(h){this._map=h,this.clear()}clear(){this._inertiaBuffer=[]}record(h){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.exported.now(),settings:h})}_drainInertiaBuffer(){const h=this._inertiaBuffer,m=s.exported.now();for(;h.length>0&&m-h[0].time>160;)h.shift()}_onMoveEnd(h){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const m={zoom:0,bearing:0,pitch:0,pan:new s.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:A}of this._inertiaBuffer)m.zoom+=A.zoomDelta||0,m.bearing+=A.bearingDelta||0,m.pitch+=A.pitchDelta||0,A.panDelta&&m.pan._add(A.panDelta),A.around&&(m.around=A.around),A.pinchAround&&(m.pinchAround=A.pinchAround);const x=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(m.pan.mag()){const A=od(m.pan.mag(),x,s.extend({},Kf,h||{}));S.offset=m.pan.mult(A.amount/m.pan.mag()),S.center=this._map.transform.center,rd(S,A)}if(m.zoom){const A=od(m.zoom,x,Xf);S.zoom=this._map.transform.zoom+A.amount,rd(S,A)}if(m.bearing){const A=od(m.bearing,x,ln);S.bearing=this._map.transform.bearing+s.clamp(A.amount,-179,179),rd(S,A)}if(m.pitch){const A=od(m.pitch,x,sa);S.pitch=this._map.transform.pitch+A.amount,rd(S,A)}if(S.zoom||S.bearing){const A=m.pinchAround===void 0?m.around:m.pinchAround;S.around=A?this._map.unproject(A):this._map.getCenter()}return this.clear(),S.noMoveStart=!0,S}}function rd(_,h){(!_.duration||_.duration<h.duration)&&(_.duration=h.duration,_.easing=h.easing)}function od(_,h,m){const{maxSpeed:x,linearity:S,deceleration:A}=m,R=s.clamp(_*S/(h/1e3),-x,x),O=Math.abs(R)/(A*S);return{easing:m.easing,duration:1e3*O,amount:R*(O/2)}}class wo extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(h,m,x,S={}){const A=ee(m.getCanvasContainer(),x),R=m.unproject(A);super(h,s.extend({point:A,lngLat:R,originalEvent:x},S)),this._defaultPrevented=!1,this.target=m}}class sd extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(h,m,x){const S=h==="touchend"?x.changedTouches:x.touches,A=ne(m.getCanvasContainer(),S),R=A.map(z=>m.unproject(z)),O=A.reduce((z,$,j,Z)=>z.add($.div(Z.length)),new s.Point(0,0));super(h,{points:A,point:O,lngLats:R,lngLat:m.unproject(O),originalEvent:x}),this._defaultPrevented=!1}}class Zf extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(h,m,x){super(h,{originalEvent:x}),this._defaultPrevented=!1}}class Ig{constructor(h,m){this._map=h,this._clickTolerance=m.clickTolerance}reset(){this._mousedownPos=void 0}wheel(h){return this._firePreventable(new Zf(h.type,this._map,h))}mousedown(h,m){return this._mousedownPos=m,this._firePreventable(new wo(h.type,this._map,h))}mouseup(h){this._map.fire(new wo(h.type,this._map,h))}preclick(h){const m=s.extend({},h);m.type="preclick",this._map.fire(new wo(m.type,this._map,m))}click(h,m){this._mousedownPos&&this._mousedownPos.dist(m)>=this._clickTolerance||(this.preclick(h),this._map.fire(new wo(h.type,this._map,h)))}dblclick(h){return this._firePreventable(new wo(h.type,this._map,h))}mouseover(h){this._map.fire(new wo(h.type,this._map,h))}mouseout(h){this._map.fire(new wo(h.type,this._map,h))}touchstart(h){return this._firePreventable(new sd(h.type,this._map,h))}touchmove(h){this._map.fire(new sd(h.type,this._map,h))}touchend(h){this._map.fire(new sd(h.type,this._map,h))}touchcancel(h){this._map.fire(new sd(h.type,this._map,h))}_firePreventable(h){if(this._map.fire(h),h.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class qf{constructor(h){this._map=h}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(h){this._map.fire(new wo(h.type,this._map,h))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new wo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(h){this._delayContextMenu?this._contextMenuEvent=h:this._map.fire(new wo(h.type,this._map,h)),this._map.listens("contextmenu")&&h.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class r1{constructor(h,m){this._map=h,this._el=h.getCanvasContainer(),this._container=h.getContainer(),this._clickTolerance=m.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(h,m){this.isEnabled()&&h.shiftKey&&h.button===0&&(F(),this._startPos=this._lastPos=m,this._active=!0)}mousemoveWindow(h,m){if(!this._active)return;const x=m,S=this._startPos,A=this._lastPos;if(!S||!A||A.equals(x)||!this._box&&x.dist(S)<this._clickTolerance)return;this._lastPos=x,this._box||(this._box=w("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",h));const R=Math.min(S.x,x.x),O=Math.max(S.x,x.x),z=Math.min(S.y,x.y),$=Math.max(S.y,x.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${R}px,${z}px)`,this._box.style.width=O-R+"px",this._box.style.height=$-z+"px")})}mouseupWindow(h,m){if(!this._active)return;const x=this._startPos,S=m;if(x&&h.button===0){if(this.reset(),U(),x.x!==S.x||x.y!==S.y)return this._map.fire(new s.Event("boxzoomend",{originalEvent:h})),{cameraAnimation:A=>A.fitScreenCoordinates(x,S,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",h)}}keydown(h){this._active&&h.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",h))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),B(),delete this._startPos,delete this._lastPos}_fireEvent(h,m){return this._map.fire(new s.Event(h,{originalEvent:m}))}}function Yf(_,h){const m={};for(let x=0;x<_.length;x++)m[_[x].identifier]=h[x];return m}class Ou{constructor(h){this.reset(),this.numTouches=h.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(h,m,x){(this.centroid||x.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=h.timeStamp),x.length===this.numTouches&&(this.centroid=function(S){const A=new s.Point(0,0);for(const R of S)A._add(R);return A.div(S.length)}(m),this.touches=Yf(x,m)))}touchmove(h,m,x){if(this.aborted||!this.centroid)return;const S=Yf(x,m);for(const A in this.touches){const R=S[A];(!R||R.dist(this.touches[A])>30)&&(this.aborted=!0)}}touchend(h,m,x){if((!this.centroid||h.timeStamp-this.startTime>500)&&(this.aborted=!0),x.length===0){const S=!this.aborted&&this.centroid;if(this.reset(),S)return S}}}class Mg{constructor(h){this.singleTap=new Ou(h),this.numTaps=h.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(h,m,x){this.singleTap.touchstart(h,m,x)}touchmove(h,m,x){this.singleTap.touchmove(h,m,x)}touchend(h,m,x){const S=this.singleTap.touchend(h,m,x);if(S){const A=h.timeStamp-this.lastTime<500,R=!this.lastTap||this.lastTap.dist(S)<30;if(A&&R||this.reset(),this.count++,this.lastTime=h.timeStamp,this.lastTap=S,this.count===this.numTaps)return this.reset(),S}}}class TE{constructor(){this._zoomIn=new Mg({numTouches:1,numTaps:2}),this._zoomOut=new Mg({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(h,m,x){this._zoomIn.touchstart(h,m,x),this._zoomOut.touchstart(h,m,x)}touchmove(h,m,x){this._zoomIn.touchmove(h,m,x),this._zoomOut.touchmove(h,m,x)}touchend(h,m,x){const S=this._zoomIn.touchend(h,m,x),A=this._zoomOut.touchend(h,m,x);return S?(this._active=!0,h.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:R.getZoom()+1,around:R.unproject(S)},{originalEvent:h})}):A?(this._active=!0,h.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:R.getZoom()-1,around:R.unproject(A)},{originalEvent:h})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const o1={0:1,2:2};class Du{constructor(h){this.reset(),this._clickTolerance=h.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(h,m){return!1}_move(h,m){return{}}mousedown(h,m){if(this._lastPoint)return;const x=ye(h);this._correctButton(h,x)&&(this._lastPoint=m,this._eventButton=x)}mousemoveWindow(h,m){const x=this._lastPoint;if(x){if(h.preventDefault(),this._eventButton!=null&&function(S,A){const R=o1[A];return S.buttons===void 0||(S.buttons&R)!==R}(h,this._eventButton))this.reset();else if(this._moved||!(m.dist(x)<this._clickTolerance))return this._moved=!0,this._lastPoint=m,this._move(x,m)}}mouseupWindow(h){this._lastPoint&&ye(h)===this._eventButton&&(this._moved&&U(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Rg extends Du{mousedown(h,m){super.mousedown(h,m),this._lastPoint&&(this._active=!0)}_correctButton(h,m){return m===0&&!h.ctrlKey}_move(h,m){return{around:m,panDelta:m.sub(h)}}}class Lg extends Du{_correctButton(h,m){return m===0&&h.ctrlKey||m===2}_move(h,m){const x=.8*(m.x-h.x);if(x)return this._active=!0,{bearingDelta:x}}contextmenu(h){h.preventDefault()}}class Og extends Du{_correctButton(h,m){return m===0&&h.ctrlKey||m===2}_move(h,m){const x=-.5*(m.y-h.y);if(x)return this._active=!0,{pitchDelta:x}}contextmenu(h){h.preventDefault()}}class Jf{constructor(h,m){this._map=h,this._el=h.getCanvasContainer(),this._minTouches=1,this._clickTolerance=m.clickTolerance||1,this.reset(),s.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new s.Point(0,0)}touchstart(h,m,x){return this._calculateTransform(h,m,x)}touchmove(h,m,x){if(this._active&&!(x.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(x.length===1&&!s.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return h.cancelable&&h.preventDefault(),this._calculateTransform(h,m,x)}}touchend(h,m,x){this._calculateTransform(h,m,x),this._active&&x.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(h,m,x){x.length>0&&(this._active=!0);const S=Yf(x,m),A=new s.Point(0,0),R=new s.Point(0,0);let O=0;for(const $ in S){const j=S[$],Z=this._touches[$];Z&&(A._add(j),R._add(j.sub(Z)),O++,S[$]=j)}if(this._touches=S,O<this._minTouches||!R.mag())return;const z=R.div(O);return this._sum._add(z),this._sum.mag()<this._clickTolerance?void 0:{around:A.div(O),panDelta:z}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=w("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class ad{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(h){}_move(h,m,x){return{}}touchstart(h,m,x){this._firstTwoTouches||x.length<2||(this._firstTwoTouches=[x[0].identifier,x[1].identifier],this._start([m[0],m[1]]))}touchmove(h,m,x){const S=this._firstTwoTouches;if(!S)return;h.preventDefault();const[A,R]=S,O=ld(x,m,A),z=ld(x,m,R);if(!O||!z)return;const $=this._aroundCenter?null:O.add(z).div(2);return this._move([O,z],$,h)}touchend(h,m,x){if(!this._firstTwoTouches)return;const[S,A]=this._firstTwoTouches,R=ld(x,m,S),O=ld(x,m,A);R&&O||(this._active&&U(),this.reset())}touchcancel(){this.reset()}enable(h){this._enabled=!0,this._aroundCenter=!!h&&h.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ld(_,h,m){for(let x=0;x<_.length;x++)if(_[x].identifier===m)return h[x]}function Dg(_,h){return Math.log(_/h)/Math.LN2}class s1 extends ad{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(h){this._startDistance=this._distance=h[0].dist(h[1])}_move(h,m){const x=this._distance;if(this._distance=h[0].dist(h[1]),this._active||!(Math.abs(Dg(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Dg(this._distance,x),pinchAround:m}}}function kg(_,h){return 180*_.angleWith(h)/Math.PI}class a1 extends ad{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(h){this._startVector=this._vector=h[0].sub(h[1]),this._minDiameter=h[0].dist(h[1])}_move(h,m){const x=this._vector;if(this._vector=h[0].sub(h[1]),x&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:kg(this._vector,x),pinchAround:m}}_isBelowThreshold(h){this._minDiameter=Math.min(this._minDiameter,h.mag());const m=25/(Math.PI*this._minDiameter)*360,x=this._startVector;if(!x)return!1;const S=kg(h,x);return Math.abs(S)<m}}function kl(_){return Math.abs(_.y)>Math.abs(_.x)}class l1 extends ad{constructor(h){super(),this._map=h}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(h){this._lastPoints=h,kl(h[0].sub(h[1]))&&(this._valid=!1)}_move(h,m,x){const S=this._lastPoints;if(!S)return;const A=h[0].sub(S[0]),R=h[1].sub(S[1]);return this._map._cooperativeGestures&&!s.isFullscreen()&&x.touches.length<3||(this._valid=this.gestureBeginsVertically(A,R,x.timeStamp),!this._valid)?void 0:(this._lastPoints=h,this._active=!0,{pitchDelta:(A.y+R.y)/2*-.5})}gestureBeginsVertically(h,m,x){if(this._valid!==void 0)return this._valid;const S=h.mag()>=2,A=m.mag()>=2;if(!S&&!A)return;if(!S||!A)return this._firstMove==null&&(this._firstMove=x),x-this._firstMove<100&&void 0;const R=h.y>0==m.y>0;return kl(h)&&kl(m)&&R}}const c1={panStep:100,bearingStep:15,pitchStep:10};class SE{constructor(){const h=c1;this._panStep=h.panStep,this._bearingStep=h.bearingStep,this._pitchStep=h.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(h){if(h.altKey||h.ctrlKey||h.metaKey)return;let m=0,x=0,S=0,A=0,R=0;switch(h.keyCode){case 61:case 107:case 171:case 187:m=1;break;case 189:case 109:case 173:m=-1;break;case 37:h.shiftKey?x=-1:(h.preventDefault(),A=-1);break;case 39:h.shiftKey?x=1:(h.preventDefault(),A=1);break;case 38:h.shiftKey?S=1:(h.preventDefault(),R=-1);break;case 40:h.shiftKey?S=-1:(h.preventDefault(),R=1);break;default:return}return this._rotationDisabled&&(x=0,S=0),{cameraAnimation:O=>{const z=O.getZoom();O.easeTo({duration:300,easeId:"keyboardHandler",easing:u1,zoom:m?Math.round(z)+m*(h.shiftKey?2:1):z,bearing:O.getBearing()+x*this._bearingStep,pitch:O.getPitch()+S*this._pitchStep,offset:[-A*this._panStep,-R*this._panStep],center:O.getCenter()},{originalEvent:h})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function u1(_){return _*(2-_)}const Fg=4.000244140625;class h1{constructor(h,m){this._map=h,this._el=h.getCanvasContainer(),this._handler=m,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,s.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(h){this._defaultZoomRate=h}setWheelZoomRate(h){this._wheelZoomRate=h}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(h){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!h&&h.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(h){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(h.ctrlKey||h.metaKey||this.isZooming()||s.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let m=h.deltaMode===s.window.WheelEvent.DOM_DELTA_LINE?40*h.deltaY:h.deltaY;const x=s.exported.now(),S=x-(this._lastWheelEventTime||0);this._lastWheelEventTime=x,m!==0&&m%Fg==0?this._type="wheel":m!==0&&Math.abs(m)<4?this._type="trackpad":S>400?(this._type=null,this._lastValue=m,this._timeout=setTimeout(this._onTimeout,40,h)):this._type||(this._type=Math.abs(S*m)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,m+=this._lastValue)),h.shiftKey&&m&&(m/=4),this._type&&(this._lastWheelEvent=h,this._delta-=m,this._active||this._start(h)),h.preventDefault()}_onTimeout(h){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(h)}_start(h){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const m=ee(this._el,h);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:m,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const h=this._map.transform;this._type==="wheel"&&h.projection.wrap&&(h._center.lng>=180||h._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const m=()=>h._terrainEnabled()&&this._aroundCoord?h.computeZoomRelativeTo(this._aroundCoord):h.zoom;if(this._delta!==0){const z=this._type==="wheel"&&Math.abs(this._delta)>Fg?this._wheelZoomRate:this._defaultZoomRate;let $=2/(1+Math.exp(-Math.abs(this._delta*z)));this._delta<0&&$!==0&&($=1/$);const j=m(),Z=Math.pow(2,j),re=typeof this._targetZoom=="number"?h.zoomScale(this._targetZoom):Z;this._targetZoom=Math.min(h.maxZoom,Math.max(h.minZoom,h.scaleZoom(re*$))),this._type==="wheel"&&(this._startZoom=j,this._easing=this._smoothOutEasing(200)),this._delta=0}const x=typeof this._targetZoom=="number"?this._targetZoom:m(),S=this._startZoom,A=this._easing;let R,O=!1;if(this._type==="wheel"&&S&&A){const z=Math.min((s.exported.now()-this._lastWheelEventTime)/200,1),$=A(z);R=s.number(S,x,$),z<1?this._frameId||(this._frameId=!0):O=!0}else R=x,O=!0;return this._active=!0,O&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!O,zoomDelta:R-m(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(h){let m=s.ease;if(this._prevEase){const x=this._prevEase,S=(s.exported.now()-x.start)/x.duration,A=x.easing(S+.01)-x.easing(S),R=.27/Math.sqrt(A*A+1e-4)*.01,O=Math.sqrt(.0729-R*R);m=s.bezier(R,O,.25,1)}return this._prevEase={start:s.exported.now(),duration:h,easing:m},m}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=w("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(s.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class d1{constructor(h,m){this._clickZoom=h,this._tapZoom=m}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Uo{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(h,m){return h.preventDefault(),{cameraAnimation:x=>{x.easeTo({duration:300,zoom:x.getZoom()+(h.shiftKey?-1:1),around:x.unproject(m)},{originalEvent:h})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class CE{constructor(){this._tap=new Mg({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(h,m,x){this._swipePoint||(this._tapTime&&h.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?x.length>0&&(this._swipePoint=m[0],this._swipeTouch=x[0].identifier):this._tap.touchstart(h,m,x))}touchmove(h,m,x){if(this._tapTime){if(this._swipePoint){if(x[0].identifier!==this._swipeTouch)return;const S=m[0],A=S.y-this._swipePoint.y;return this._swipePoint=S,h.preventDefault(),this._active=!0,{zoomDelta:A/128}}}else this._tap.touchmove(h,m,x)}touchend(h,m,x){this._tapTime?this._swipePoint&&x.length===0&&this.reset():this._tap.touchend(h,m,x)&&(this._tapTime=h.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class f1{constructor(h,m,x){this._el=h,this._mousePan=m,this._touchPan=x}enable(h){this._inertiaOptions=h||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class AE{constructor(h,m,x){this._pitchWithRotate=h.pitchWithRotate,this._mouseRotate=m,this._mousePitch=x}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class PE{constructor(h,m,x,S){this._el=h,this._touchZoom=m,this._touchRotate=x,this._tapDragZoom=S,this._rotationDisabled=!1,this._enabled=!0}enable(h){this._touchZoom.enable(h),this._rotationDisabled||this._touchRotate.enable(h),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const zs=_=>_.zoom||_.drag||_.pitch||_.rotate;class p1 extends s.Event{}class IE{constructor(){this.constants=[1,1,.01],this.radius=0}setup(h,m){const x=s.sub([],m,h);this.radius=s.length(x[2]<0?s.div([],x,this.constants):[x[0],x[1],0])}projectRay(h){s.div(h,h,this.constants),s.normalize(h,h),s.mul$1(h,h,this.constants);const m=s.scale$2([],h,this.radius);if(m[2]>0){const x=s.scale$2([],[0,0,1],s.dot(m,[0,0,1])),S=s.scale$2([],s.normalize([],[m[0],m[1],0]),this.radius),A=s.add([],m,s.scale$2([],s.sub([],s.add([],S,x),m),2));m[0]=A[0],m[1]=A[1]}return m}}function aa(_){return _.panDelta&&_.panDelta.mag()||_.zoomDelta||_.bearingDelta||_.pitchDelta}class Ia{constructor(h,m){this._map=h,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new i1(h),this._bearingSnap=m.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new IE,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(m),s.bindAll(["handleEvent","handleWindowEvent"],this);const x=this._el;this._listeners=[[x,"touchstart",{passive:!0}],[x,"touchmove",{passive:!1}],[x,"touchend",void 0],[x,"touchcancel",void 0],[x,"mousedown",void 0],[x,"mousemove",void 0],[x,"mouseup",void 0],[s.window.document,"mousemove",{capture:!0}],[s.window.document,"mouseup",void 0],[x,"mouseover",void 0],[x,"mouseout",void 0],[x,"dblclick",void 0],[x,"click",void 0],[x,"keydown",{capture:!1}],[x,"keyup",void 0],[x,"wheel",{passive:!1}],[x,"contextmenu",void 0],[s.window,"blur",void 0]];for(const[S,A,R]of this._listeners)S.addEventListener(A,S===s.window.document?this.handleWindowEvent:this.handleEvent,R)}destroy(){for(const[h,m,x]of this._listeners)h.removeEventListener(m,h===s.window.document?this.handleWindowEvent:this.handleEvent,x)}_addDefaultHandlers(h){const m=this._map,x=m.getCanvasContainer();this._add("mapEvent",new Ig(m,h));const S=m.boxZoom=new r1(m,h);this._add("boxZoom",S);const A=new TE,R=new Uo;m.doubleClickZoom=new d1(R,A),this._add("tapZoom",A),this._add("clickZoom",R);const O=new CE;this._add("tapDragZoom",O);const z=m.touchPitch=new l1(m);this._add("touchPitch",z);const $=new Lg(h),j=new Og(h);m.dragRotate=new AE(h,$,j),this._add("mouseRotate",$,["mousePitch"]),this._add("mousePitch",j,["mouseRotate"]);const Z=new Rg(h),re=new Jf(m,h);m.dragPan=new f1(x,Z,re),this._add("mousePan",Z),this._add("touchPan",re,["touchZoom","touchRotate"]);const he=new a1,ge=new s1;m.touchZoomRotate=new PE(x,ge,he,O),this._add("touchRotate",he,["touchPan","touchZoom"]),this._add("touchZoom",ge,["touchPan","touchRotate"]),this._add("blockableMapEvent",new qf(m));const pe=m.scrollZoom=new h1(m,this);this._add("scrollZoom",pe,["mousePan"]);const _e=m.keyboard=new SE;this._add("keyboard",_e);for(const Y of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])h.interactive&&h[Y]&&m[Y].enable(h[Y])}_add(h,m,x){this._handlers.push({handlerName:h,handler:m,allowed:x}),this._handlersById[h]=m}stop(h){if(!this._updatingCamera){for(const{handler:m}of this._handlers)m.reset();this._inertia.clear(),this._fireEvents({},{},h),this._changes=[]}}isActive(){for(const{handler:h}of this._handlers)if(h.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!zs(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(h,m,x){for(const S in h)if(S!==x&&(!m||m.indexOf(S)<0))return!0;return!1}handleWindowEvent(h){this.handleEvent(h,`${h.type}Window`)}_getMapTouches(h){const m=[];for(const x of h)this._el.contains(x.target)&&m.push(x);return m}handleEvent(h,m){this._updatingCamera=!0;const x=h.type==="renderFrame",S=x?void 0:h,A={needsRenderFrame:!1},R={},O={},z=h.touches?this._getMapTouches(h.touches):void 0,$=z?ne(this._el,z):x?void 0:ee(this._el,h);for(const{handlerName:re,handler:he,allowed:ge}of this._handlers){if(!he.isEnabled())continue;let pe;this._blockedByActive(O,ge,re)?he.reset():he[m||h.type]&&(pe=he[m||h.type](h,$,z),this.mergeHandlerResult(A,R,pe,re,S),pe&&pe.needsRenderFrame&&this._triggerRenderFrame()),(pe||he.isActive())&&(O[re]=he)}const j={};for(const re in this._previousActiveHandlers)O[re]||(j[re]=S);this._previousActiveHandlers=O,(Object.keys(j).length||aa(A))&&(this._changes.push([A,R,j]),this._triggerRenderFrame()),(Object.keys(O).length||aa(A))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Z}=A;Z&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Z(this._map))}mergeHandlerResult(h,m,x,S,A){if(!x)return;s.extend(h,x);const R={handlerName:S,originalEvent:x.originalEvent||A};x.zoomDelta!==void 0&&(m.zoom=R),x.panDelta!==void 0&&(m.drag=R),x.pitchDelta!==void 0&&(m.pitch=R),x.bearingDelta!==void 0&&(m.rotate=R)}_applyChanges(){const h={},m={},x={};for(const[S,A,R]of this._changes)S.panDelta&&(h.panDelta=(h.panDelta||new s.Point(0,0))._add(S.panDelta)),S.zoomDelta&&(h.zoomDelta=(h.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(h.bearingDelta=(h.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(h.pitchDelta=(h.pitchDelta||0)+S.pitchDelta),S.around!==void 0&&(h.around=S.around),S.aroundCoord!==void 0&&(h.aroundCoord=S.aroundCoord),S.pinchAround!==void 0&&(h.pinchAround=S.pinchAround),S.noInertia&&(h.noInertia=S.noInertia),s.extend(m,A),s.extend(x,R);this._updateMapTransform(h,m,x),this._changes=[]}_updateMapTransform(h,m,x){const S=this._map,A=S.transform,R=ce=>[ce.x,ce.y,ce.z];if((ce=>{const Ee=this._eventsInProgress.drag;return Ee&&!this._handlersById[Ee.handlerName].isActive()})()&&!aa(h)){const ce=A.zoom;A.cameraElevationReference="sea",A.recenterOnTerrain(),A.cameraElevationReference="ground",ce!==A.zoom&&this._map._update(!0)}if(A._isCameraConstrained&&S._stop(!0),!aa(h))return void this._fireEvents(m,x,!0);let{panDelta:O,zoomDelta:z,bearingDelta:$,pitchDelta:j,around:Z,aroundCoord:re,pinchAround:he}=h;A._isCameraConstrained&&(z>0&&(z=0),A._isCameraConstrained=!1),he!==void 0&&(Z=he),(z||(ce=>m[ce]&&!this._eventsInProgress[ce])("drag"))&&Z&&(this._dragOrigin=R(A.pointCoordinate3D(Z)),this._trackingEllipsoid.setup(A._camera.position,this._dragOrigin)),A.cameraElevationReference="sea",S._stop(!0),Z=Z||S.transform.centerPoint,$&&(A.bearing+=$),j&&(A.pitch+=j),A._updateCameraState();const ge=[0,0,0];if(O)if(A.projection.name==="mercator"){const ce=this._trackingEllipsoid.projectRay(A.screenPointToMercatorRay(Z).dir),Ee=this._trackingEllipsoid.projectRay(A.screenPointToMercatorRay(Z.sub(O)).dir);ge[0]=Ee[0]-ce[0],ge[1]=Ee[1]-ce[1]}else{const ce=A.pointCoordinate(Z);if(A.projection.name==="globe"){O=O.rotate(-A.angle);const Ee=A._pixelsPerMercatorPixel/A.worldSize;ge[0]=-O.x*s.mercatorScale(s.latFromMercatorY(ce.y))*Ee,ge[1]=-O.y*s.mercatorScale(A.center.lat)*Ee}else{const Ee=A.pointCoordinate(Z.sub(O));ce&&Ee&&(ge[0]=Ee.x-ce.x,ge[1]=Ee.y-ce.y)}}const pe=A.zoom,_e=[0,0,0];if(z){const ce=R(re||A.pointCoordinate3D(Z)),Ee={dir:s.normalize([],s.sub([],ce,A._camera.position))};if(Ee.dir[2]<0){const Se=A.zoomDeltaToMovement(ce,z);s.scale$2(_e,Ee.dir,Se)}}const Y=s.add(ge,ge,_e);A._translateCameraConstrained(Y),z&&Math.abs(A.zoom-pe)>1e-4&&A.recenterOnTerrain(),A.cameraElevationReference="ground",this._map._update(),h.noInertia||this._inertia.record(h),this._fireEvents(m,x,!0)}_fireEvents(h,m,x){const S=zs(this._eventsInProgress),A=zs(h),R={};for(const j in h){const{originalEvent:Z}=h[j];this._eventsInProgress[j]||(R[`${j}start`]=Z),this._eventsInProgress[j]=h[j]}!S&&A&&this._fireEvent("movestart",A.originalEvent);for(const j in R)this._fireEvent(j,R[j]);A&&this._fireEvent("move",A.originalEvent);for(const j in h){const{originalEvent:Z}=h[j];this._fireEvent(j,Z)}const O={};let z;for(const j in this._eventsInProgress){const{handlerName:Z,originalEvent:re}=this._eventsInProgress[j];this._handlersById[Z].isActive()||(delete this._eventsInProgress[j],z=m[Z]||re,O[`${j}end`]=z)}for(const j in O)this._fireEvent(j,O[j]);const $=zs(this._eventsInProgress);if(x&&(S||A)&&!$){this._updatingCamera=!0;const j=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Z=re=>re!==0&&-this._bearingSnap<re&&re<this._bearingSnap;j?(Z(j.bearing||this._map.getBearing())&&(j.bearing=0),this._map.easeTo(j,{originalEvent:z})):(this._map.fire(new s.Event("moveend",{originalEvent:z})),Z(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(h,m){this._map.fire(new s.Event(h,m?{originalEvent:m}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(h=>{this._frameId=void 0,this.handleEvent(new p1("renderFrame",{timeStamp:h})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Ec="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Qf extends s.Evented{constructor(h,m){super(),this._moving=!1,this._zooming=!1,this.transform=h,this._bearingSnap=m.bearingSnap,this._respectPrefersReducedMotion=m.respectPrefersReducedMotion!==!1,s.bindAll(["_renderFrameCallback"],this)}getCenter(){return new s.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(h,m){return this.jumpTo({center:h},m)}panBy(h,m,x){return h=s.Point.convert(h).mult(-1),this.panTo(this.transform.center,s.extend({offset:h},m),x)}panTo(h,m,x){return this.easeTo(s.extend({center:h},m),x)}getZoom(){return this.transform.zoom}setZoom(h,m){return this.jumpTo({zoom:h},m),this}zoomTo(h,m,x){return this.easeTo(s.extend({zoom:h},m),x)}zoomIn(h,m){return this.zoomTo(this.getZoom()+1,h,m),this}zoomOut(h,m){return this.zoomTo(this.getZoom()-1,h,m),this}getBearing(){return this.transform.bearing}setBearing(h,m){return this.jumpTo({bearing:h},m),this}getPadding(){return this.transform.padding}setPadding(h,m){return this.jumpTo({padding:h},m),this}rotateTo(h,m,x){return this.easeTo(s.extend({bearing:h},m),x)}resetNorth(h,m){return this.rotateTo(0,s.extend({duration:1e3},h),m),this}resetNorthPitch(h,m){return this.easeTo(s.extend({bearing:0,pitch:0,duration:1e3},h),m),this}snapToNorth(h,m){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(h,m):this}getPitch(){return this.transform.pitch}setPitch(h,m){return this.jumpTo({pitch:h},m),this}cameraForBounds(h,m){h=s.LngLatBounds.convert(h);const x=m&&m.bearing||0,S=m&&m.pitch||0,A=h.getNorthWest(),R=h.getSouthEast();return this._cameraForBounds(this.transform,A,R,x,S,m)}_extendCameraOptions(h){const m={top:0,bottom:0,right:0,left:0};if(typeof(h=s.extend({padding:m,offset:[0,0],maxZoom:this.transform.maxZoom},h)).padding=="number"){const x=h.padding;h.padding={top:x,bottom:x,right:x,left:x}}return h.padding=s.extend(m,h.padding),h}_minimumAABBFrustumDistance(h,m){const x=m.max[0]-m.min[0],S=m.max[1]-m.min[1];return x/S>h.aspect?x/(2*Math.tan(.5*h.fovX)*h.aspect):S/(2*Math.tan(.5*h.fovY)*h.aspect)}_cameraForBoundsOnGlobe(h,m,x,S,A,R){const O=h.clone(),z=this._extendCameraOptions(R);O.bearing=S,O.pitch=A;const $=s.LngLat.convert(m),j=s.LngLat.convert(x),Z=.5*($.lat+j.lat),re=.5*($.lng+j.lng),he=s.latLngToECEF(Z,re),ge=s.normalize([],he),pe=s.normalize([],s.cross([],ge,[0,1,0])),_e=s.cross([],pe,ge),Y=[pe[0],pe[1],pe[2],0,_e[0],_e[1],_e[2],0,ge[0],ge[1],ge[2],0,0,0,0,1],ce=[he,s.latLngToECEF($.lat,$.lng),s.latLngToECEF(j.lat,$.lng),s.latLngToECEF(j.lat,j.lng),s.latLngToECEF($.lat,j.lng),s.latLngToECEF(Z,$.lng),s.latLngToECEF(Z,j.lng),s.latLngToECEF($.lat,re),s.latLngToECEF(j.lat,re)];let Ee=s.Aabb.fromPoints(ce.map(Mt=>[s.dot(pe,Mt),s.dot(_e,Mt),s.dot(ge,Mt)]));const Se=s.transformMat4([],Ee.center,Y);s.squaredLength(Se)===0&&s.set(Se,0,0,1),s.normalize(Se,Se),s.scale$2(Se,Se,s.GLOBE_RADIUS),O.center=s.ecefToLatLng(Se);const ze=O.getWorldToCameraMatrix(),Ve=s.invert(new Float64Array(16),ze);Ee=s.Aabb.applyTransform(Ee,s.multiply([],ze,Y)),s.transformMat4(Se,Se,ze);const Ne=.5*(Ee.max[2]-Ee.min[2]),Ye=this._minimumAABBFrustumDistance(O,Ee),Xe=s.scale$2([],[0,0,1],Ne),st=s.add(Xe,Se,Xe),Ut=Ye+(O.pitch===0?0:s.distance(Se,st)),nt=O.globeCenterInViewSpace,wt=s.sub([],Se,[nt[0],nt[1],nt[2]]);s.normalize(wt,wt),s.scale$2(wt,wt,Ut);const dt=s.add([],Se,wt);s.transformMat4(dt,dt,Ve);const Bt=s.earthRadius/s.GLOBE_RADIUS,ot=s.length(dt),xt=s.mercatorZfromAltitude(Math.max(ot*Bt-s.earthRadius,Number.EPSILON),0),jt=Math.min(O.zoomFromMercatorZAdjusted(xt),z.maxZoom);return jt>.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(O.setProjection({name:"mercator"}),O.zoom=jt,this._cameraForBounds(O,m,x,S,A,R)):{center:O.center,zoom:jt,bearing:S,pitch:A}}queryTerrainElevation(h,m){const x=this.transform.elevation;return x?(m=s.extend({},{exaggerated:!0},m),x.getAtPoint(s.MercatorCoordinate.fromLngLat(h),null,m.exaggerated)):null}_cameraForBounds(h,m,x,S,A,R){if(h.projection.name==="globe")return this._cameraForBoundsOnGlobe(h,m,x,S,A,R);const O=h.clone(),z=this._extendCameraOptions(R),$=O.padding;O.bearing=S,O.pitch=A;const j=s.LngLat.convert(m),Z=s.LngLat.convert(x),re=new s.LngLat(j.lng,Z.lat),he=new s.LngLat(Z.lng,j.lat),ge=O.project(j),pe=O.project(Z),_e=this.queryTerrainElevation(j),Y=this.queryTerrainElevation(Z),ce=this.queryTerrainElevation(re),Ee=this.queryTerrainElevation(he),Se=[[ge.x,ge.y,Math.min(_e||0,Y||0,ce||0,Ee||0)],[pe.x,pe.y,Math.max(_e||0,Y||0,ce||0,Ee||0)]];let ze=s.Aabb.fromPoints(Se);const Ve=O.getWorldToCameraMatrix(),Ne=s.invert(new Float64Array(16),Ve);ze=s.Aabb.applyTransform(ze,Ve);const Ye=s.sub([],ze.max,ze.min),Xe=$.left||0,st=$.right||0,Ut=$.bottom||0,nt=$.top||0,{left:wt,right:dt,top:Bt,bottom:ot}=z.padding,xt=.5*(Xe+st),jt=.5*(nt+Ut),Mt=Math.min(O.scaleZoom(O.scale*Math.min((O.width-(Xe+st+wt+dt))/Ye[0],(O.height-(Ut+nt+ot+Bt))/Ye[1])),z.maxZoom),Gt=O.scale/O.zoomScale(Mt);ze=new s.Aabb([ze.min[0]-(wt+xt)*Gt,ze.min[1]-(ot+jt)*Gt,ze.min[2]],[ze.max[0]+(dt+xt)*Gt,ze.max[1]+(Bt+jt)*Gt,ze.max[2]]);const In=.5*Ye[2],Qn=this._minimumAABBFrustumDistance(O,ze),gn=[0,0,1,0];s.transformMat4$1(gn,gn,Ve),s.normalize$2(gn,gn);const Fn=s.scale$2([],gn,Qn+In),yi=s.add([],ze.center,Fn),gi=(typeof z.offset.x=="number"&&typeof z.offset.y=="number"?new s.Point(z.offset.x,z.offset.y):s.Point.convert(z.offset)).rotate(-s.degToRad(S));ze.center[0]-=gi.x*Gt,ze.center[1]+=gi.y*Gt,s.transformMat4(ze.center,ze.center,Ne),s.transformMat4(yi,yi,Ne);const Sn=[ze.center[0],ze.center[1],yi[2]*O.pixelsPerMeter];s.scale$2(Sn,Sn,1/O.worldSize);const Ui=s.lngFromMercatorX(Sn[0]),Hi=s.latFromMercatorY(Sn[1]),Wi=Math.min(O._zoomFromMercatorZ(Sn[2]),z.maxZoom),Ki=new s.LngLat(Ui,Hi);return O.mercatorFromTransition&&Wi<.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(O.setProjection({name:"globe"}),O.zoom=Wi,this._cameraForBounds(O,m,x,S,A,R)):{center:Ki,zoom:Wi,bearing:S,pitch:A}}fitBounds(h,m,x){const S=this.cameraForBounds(h,m);return this._fitInternal(S,m,x)}fitScreenCoordinates(h,m,x,S,A){const R=s.Point.convert(h),O=s.Point.convert(m),z=new s.Point(Math.min(R.x,O.x),Math.min(R.y,O.y)),$=new s.Point(Math.max(R.x,O.x),Math.max(R.y,O.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(R,O))return this;const j=this.transform.pointLocation3D(z),Z=this.transform.pointLocation3D($),re=this.transform.pointLocation3D(new s.Point(z.x,$.y)),he=this.transform.pointLocation3D(new s.Point($.x,z.y)),ge=[Math.min(j.lng,Z.lng,re.lng,he.lng),Math.min(j.lat,Z.lat,re.lat,he.lat)],pe=[Math.max(j.lng,Z.lng,re.lng,he.lng),Math.max(j.lat,Z.lat,re.lat,he.lat)],_e=S&&S.pitch?S.pitch:this.getPitch(),Y=this._cameraForBounds(this.transform,ge,pe,x,_e,S);return this._fitInternal(Y,S,A)}_fitInternal(h,m,x){return h?(delete(m=s.extend(h,m)).padding,m.linear?this.easeTo(m,x):this.flyTo(m,x)):this}jumpTo(h,m){this.stop();const x=h.preloadOnly?this.transform.clone():this.transform;let S=!1,A=!1,R=!1;return"zoom"in h&&x.zoom!==+h.zoom&&(S=!0,x.zoom=+h.zoom),h.center!==void 0&&(x.center=s.LngLat.convert(h.center)),"bearing"in h&&x.bearing!==+h.bearing&&(A=!0,x.bearing=+h.bearing),"pitch"in h&&x.pitch!==+h.pitch&&(R=!0,x.pitch=+h.pitch),h.padding==null||x.isPaddingEqual(h.padding)||(x.padding=h.padding),h.preloadOnly?(this._preloadTiles(x),this):(this.fire(new s.Event("movestart",m)).fire(new s.Event("move",m)),S&&this.fire(new s.Event("zoomstart",m)).fire(new s.Event("zoom",m)).fire(new s.Event("zoomend",m)),A&&this.fire(new s.Event("rotatestart",m)).fire(new s.Event("rotate",m)).fire(new s.Event("rotateend",m)),R&&this.fire(new s.Event("pitchstart",m)).fire(new s.Event("pitch",m)).fire(new s.Event("pitchend",m)),this.fire(new s.Event("moveend",m)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||s.warnOnce(Ec),this.transform.getFreeCameraOptions()}setFreeCameraOptions(h,m){const x=this.transform;if(!x.projection.supportsFreeCamera)return s.warnOnce(Ec),this;this.stop();const S=x.zoom,A=x.pitch,R=x.bearing;x.setFreeCameraOptions(h);const O=S!==x.zoom,z=A!==x.pitch,$=R!==x.bearing;return this.fire(new s.Event("movestart",m)).fire(new s.Event("move",m)),O&&this.fire(new s.Event("zoomstart",m)).fire(new s.Event("zoom",m)).fire(new s.Event("zoomend",m)),$&&this.fire(new s.Event("rotatestart",m)).fire(new s.Event("rotate",m)).fire(new s.Event("rotateend",m)),z&&this.fire(new s.Event("pitchstart",m)).fire(new s.Event("pitch",m)).fire(new s.Event("pitchend",m)),this.fire(new s.Event("moveend",m)),this}easeTo(h,m){this._stop(!1,h.easeId),((h=s.extend({offset:[0,0],duration:500,easing:s.ease},h)).animate===!1||this._prefersReducedMotion(h))&&(h.duration=0);const x=this.transform,S=this.getZoom(),A=this.getBearing(),R=this.getPitch(),O=this.getPadding(),z="zoom"in h?+h.zoom:S,$="bearing"in h?this._normalizeBearing(h.bearing,A):A,j="pitch"in h?+h.pitch:R,Z="padding"in h?h.padding:x.padding,re=s.Point.convert(h.offset);let he,ge,pe;if(x.projection.name==="globe"){const Xe=s.MercatorCoordinate.fromLngLat(x.center),st=re.rotate(-x.angle);Xe.x+=st.x/x.worldSize,Xe.y+=st.y/x.worldSize;const Ut=Xe.toLngLat(),nt=s.LngLat.convert(h.center||Ut);this._normalizeCenter(nt),he=x.centerPoint.add(st),ge=new s.Point(Xe.x,Xe.y).mult(x.worldSize),pe=new s.Point(s.mercatorXfromLng(nt.lng),s.mercatorYfromLat(nt.lat)).mult(x.worldSize).sub(ge)}else{he=x.centerPoint.add(re);const Xe=x.pointLocation(he),st=s.LngLat.convert(h.center||Xe);this._normalizeCenter(st),ge=x.project(Xe),pe=x.project(st).sub(ge)}const _e=x.zoomScale(z-S);let Y,ce;h.around&&(Y=s.LngLat.convert(h.around),ce=x.locationPoint(Y));const Ee=this._zooming||z!==S,Se=this._rotating||A!==$,ze=this._pitching||j!==R,Ve=!x.isPaddingEqual(Z),Ne=Xe=>st=>{if(Ee&&(Xe.zoom=s.number(S,z,st)),Se&&(Xe.bearing=s.number(A,$,st)),ze&&(Xe.pitch=s.number(R,j,st)),Ve&&(Xe.interpolatePadding(O,Z,st),he=Xe.centerPoint.add(re)),Y)Xe.setLocationAtPoint(Y,ce);else{const Ut=Xe.zoomScale(Xe.zoom-S),nt=z>S?Math.min(2,_e):Math.max(.5,_e),wt=Math.pow(nt,1-st),dt=Xe.unproject(ge.add(pe.mult(st*wt)).mult(Ut));Xe.setLocationAtPoint(Xe.renderWorldCopies?dt.wrap():dt,he)}return h.preloadOnly||this._fireMoveEvents(m),Xe};if(h.preloadOnly){const Xe=this._emulate(Ne,h.duration,x);return this._preloadTiles(Xe),this}const Ye={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Ee,this._rotating=Se,this._pitching=ze,this._padding=Ve,this._easeId=h.easeId,this._prepareEase(m,h.noMoveStart,Ye),this._ease(Ne(x),Xe=>{x.recenterOnTerrain(),this._afterEase(m,Xe)},h),this}_prepareEase(h,m,x={}){this._moving=!0,this.transform.cameraElevationReference="sea",m||x.moving||this.fire(new s.Event("movestart",h)),this._zooming&&!x.zooming&&this.fire(new s.Event("zoomstart",h)),this._rotating&&!x.rotating&&this.fire(new s.Event("rotatestart",h)),this._pitching&&!x.pitching&&this.fire(new s.Event("pitchstart",h))}_fireMoveEvents(h){this.fire(new s.Event("move",h)),this._zooming&&this.fire(new s.Event("zoom",h)),this._rotating&&this.fire(new s.Event("rotate",h)),this._pitching&&this.fire(new s.Event("pitch",h))}_afterEase(h,m){if(this._easeId&&m&&this._easeId===m)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const x=this._zooming,S=this._rotating,A=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,x&&this.fire(new s.Event("zoomend",h)),S&&this.fire(new s.Event("rotateend",h)),A&&this.fire(new s.Event("pitchend",h)),this.fire(new s.Event("moveend",h))}flyTo(h,m){if(this._prefersReducedMotion(h)){const Mt=s.pick(h,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Mt,m)}this.stop(),h=s.extend({offset:[0,0],speed:1.2,curve:1.42,easing:s.ease},h);const x=this.transform,S=this.getZoom(),A=this.getBearing(),R=this.getPitch(),O=this.getPadding(),z="zoom"in h?s.clamp(+h.zoom,x.minZoom,x.maxZoom):S,$="bearing"in h?this._normalizeBearing(h.bearing,A):A,j="pitch"in h?+h.pitch:R,Z="padding"in h?h.padding:x.padding,re=x.zoomScale(z-S),he=s.Point.convert(h.offset);let ge=x.centerPoint.add(he);const pe=x.pointLocation(ge),_e=s.LngLat.convert(h.center||pe);this._normalizeCenter(_e);const Y=x.project(pe),ce=x.project(_e).sub(Y);let Ee=h.curve;const Se=Math.max(x.width,x.height),ze=Se/re,Ve=ce.mag();if("minZoom"in h){const Mt=s.clamp(Math.min(h.minZoom,S,z),x.minZoom,x.maxZoom),Gt=Se/x.zoomScale(Mt-S);Ee=Math.sqrt(Gt/Ve*2)}const Ne=Ee*Ee;function Ye(Mt){const Gt=(ze*ze-Se*Se+(Mt?-1:1)*Ne*Ne*Ve*Ve)/(2*(Mt?ze:Se)*Ne*Ve);return Math.log(Math.sqrt(Gt*Gt+1)-Gt)}function Xe(Mt){return(Math.exp(Mt)-Math.exp(-Mt))/2}function st(Mt){return(Math.exp(Mt)+Math.exp(-Mt))/2}const Ut=Ye(0);let nt=function(Mt){return st(Ut)/st(Ut+Ee*Mt)},wt=function(Mt){return Se*((st(Ut)*(Xe(Gt=Ut+Ee*Mt)/st(Gt))-Xe(Ut))/Ne)/Ve;var Gt},dt=(Ye(1)-Ut)/Ee;if(Math.abs(Ve)<1e-6||!isFinite(dt)){if(Math.abs(Se-ze)<1e-6)return this.easeTo(h,m);const Mt=ze<Se?-1:1;dt=Math.abs(Math.log(ze/Se))/Ee,wt=function(){return 0},nt=function(Gt){return Math.exp(Mt*Ee*Gt)}}h.duration="duration"in h?+h.duration:1e3*dt/("screenSpeed"in h?+h.screenSpeed/Ee:+h.speed),h.maxDuration&&h.duration>h.maxDuration&&(h.duration=0);const Bt=A!==$,ot=j!==R,xt=!x.isPaddingEqual(Z),jt=Mt=>Gt=>{const In=Gt*dt,Qn=1/nt(In);Mt.zoom=Gt===1?z:S+Mt.scaleZoom(Qn),Bt&&(Mt.bearing=s.number(A,$,Gt)),ot&&(Mt.pitch=s.number(R,j,Gt)),xt&&(Mt.interpolatePadding(O,Z,Gt),ge=Mt.centerPoint.add(he));const gn=Gt===1?_e:Mt.unproject(Y.add(ce.mult(wt(In))).mult(Qn));return Mt.setLocationAtPoint(Mt.renderWorldCopies?gn.wrap():gn,ge),Mt._updateCameraOnTerrain(),h.preloadOnly||this._fireMoveEvents(m),Mt};if(h.preloadOnly){const Mt=this._emulate(jt,h.duration,x);return this._preloadTiles(Mt),this}return this._zooming=!0,this._rotating=Bt,this._pitching=ot,this._padding=xt,this._prepareEase(m,!1),this._ease(jt(x),()=>this._afterEase(m),h),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(h,m){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const x=this._onEaseEnd;this._onEaseEnd=void 0,x.call(this,m)}if(!h){const x=this.handlers;x&&x.stop(!1)}return this}_ease(h,m,x){x.animate===!1||x.duration===0?(h(1),m()):(this._easeStart=s.exported.now(),this._easeOptions=x,this._onEaseFrame=h,this._onEaseEnd=m,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const h=Math.min((s.exported.now()-this._easeStart)/this._easeOptions.duration,1),m=this._onEaseFrame;m&&m(this._easeOptions.easing(h)),h<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(h,m){h=s.wrap(h,-180,180);const x=Math.abs(h-m);return Math.abs(h-360-m)<x&&(h-=360),Math.abs(h+360-m)<x&&(h+=360),h}_normalizeCenter(h){const m=this.transform;if(!m.renderWorldCopies||m.maxBounds)return;const x=h.lng-m.center.lng;h.lng+=x>180?-360:x<-180?360:0}_prefersReducedMotion(h){return this._respectPrefersReducedMotion&&s.exported.prefersReducedMotion&&!(h&&h.essential)}_emulate(h,m,x){const S=Math.ceil(15*m/1e3),A=[],R=h(x.clone());for(let O=0;O<=S;O++){const z=R(O/S);A.push(z.clone())}return A}}class dn{constructor(h={}){this.options=h,s.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(h){const m=this.options&&this.options.compact;return this._map=h,this._container=w("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=w("button","mapboxgl-ctrl-attrib-button",this._container),w("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=w("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),m&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),m===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(h,m){const x=this._map._getUIString(`AttributionControl.${m}`);h.setAttribute("aria-label",x),h.removeAttribute("title"),h.firstElementChild&&h.firstElementChild.setAttribute("title",x)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let h=this._editLink;h||(h=this._editLink=this._container.querySelector(".mapbox-improve-map"));const m=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.config.ACCESS_TOKEN}];if(h){const x=m.reduce((S,A,R)=>(A.value&&(S+=`${A.key}=${A.value}${R<m.length-1?"&":""}`),S),"?");h.href=`${s.config.FEEDBACK_URL}/${x}#${nd(this._map,!0)}`,h.rel="noopener nofollow",this._setElementTitle(h,"MapFeedback")}}_updateData(h){!h||h.sourceDataType!=="metadata"&&h.sourceDataType!=="visibility"&&h.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let h=[];if(this._map.style.stylesheet){const S=this._map.style.stylesheet;this.styleOwner=S.owner,this.styleId=S.id}const m=this._map.style._sourceCaches;for(const S in m){const A=m[S];if(A.used){const R=A.getSource();R.attribution&&h.indexOf(R.attribution)<0&&h.push(R.attribution)}}h.sort((S,A)=>S.length-A.length),h=h.filter((S,A)=>{for(let R=A+1;R<h.length;R++)if(h[R].indexOf(S)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?h=[...this.options.customAttribution,...h]:h.unshift(this.options.customAttribution));const x=h.join(" | ");x!==this._attribHTML&&(this._attribHTML=x,h.length?(this._innerContainer.innerHTML=x,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Bg{constructor(){s.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(h){this._map=h,this._container=w("div","mapboxgl-ctrl");const m=w("a","mapboxgl-ctrl-logo");return m.target="_blank",m.rel="noopener nofollow",m.href="https://www.mapbox.com/",m.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),m.setAttribute("rel","noopener nofollow"),this._container.appendChild(m),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(h){h&&h.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const h=this._map.style._sourceCaches;if(Object.entries(h).length===0)return!0;for(const m in h){const x=h[m].getSource();if(x.hasOwnProperty("mapbox_logo")&&!x.mapbox_logo)return!1}return!0}_updateCompact(){const h=this._container.children;if(h.length){const m=h[0];this._map.getCanvasContainer().offsetWidth<250?m.classList.add("mapboxgl-compact"):m.classList.remove("mapboxgl-compact")}}}class zg{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(h){const m=++this._id;return this._queue.push({callback:h,id:m,cancelled:!1}),m}remove(h){const m=this._currentlyRunning,x=m?this._queue.concat(m):this._queue;for(const S of x)if(S.id===h)return void(S.cancelled=!0)}run(h=0){const m=this._currentlyRunning=this._queue;this._queue=[];for(const x of m)if(!x.cancelled&&(x.callback(h),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function ku(_,h,m){if(_=new s.LngLat(_.lng,_.lat),h){const x=new s.LngLat(_.lng-360,_.lat),S=new s.LngLat(_.lng+360,_.lat),A=360*Math.ceil(Math.abs(_.lng-m.center.lng)/360),R=m.locationPoint(_).distSqr(h),O=h.x<0||h.y<0||h.x>m.width||h.y>m.height;m.locationPoint(x).distSqr(h)<R&&(O||Math.abs(x.lng-m.center.lng)<A)?_=x:m.locationPoint(S).distSqr(h)<R&&(O||Math.abs(S.lng-m.center.lng)<A)&&(_=S)}for(;Math.abs(_.lng-m.center.lng)>180;){const x=m.locationPoint(_);if(x.x>=0&&x.y>=0&&x.x<=m.width&&x.y<=m.height)break;_.lng>m.center.lng?_.lng-=360:_.lng+=360}return _}const Tc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class an extends s.Evented{constructor(h,m){if(super(),(h instanceof s.window.HTMLElement||m)&&(h=s.extend({element:h},m)),s.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=h&&h.anchor||"center",this._color=h&&h.color||"#3FB1CE",this._scale=h&&h.scale||1,this._draggable=h&&h.draggable||!1,this._clickTolerance=h&&h.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=h&&h.rotation||0,this._rotationAlignment=h&&h.rotationAlignment||"auto",this._pitchAlignment=h&&h.pitchAlignment&&h.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=h&&h.occludedOpacity||.2,h&&h.element)this._element=h.element,this._offset=s.Point.convert(h&&h.offset||[0,0]);else{this._defaultMarker=!0,this._element=w("div");const S=41,A=27,R=T("svg",{display:"block",height:S*this._scale+"px",width:A*this._scale+"px",viewBox:`0 0 ${A} ${S}`},this._element),O=T("radialGradient",{id:"shadowGradient"},T("defs",{},R));T("stop",{offset:"10%","stop-opacity":.4},O),T("stop",{offset:"100%","stop-opacity":.05},O),T("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},R),T("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},R),T("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},R),T("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},R),this._offset=s.Point.convert(h&&h.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",S=>{S.preventDefault()}),this._element.addEventListener("mousedown",S=>{S.preventDefault()});const x=this._element.classList;for(const S in Tc)x.remove(`mapboxgl-marker-anchor-${S}`);x.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(h){return h===this._map||(this.remove(),this._map=h,h.getCanvasContainer().appendChild(this._element),h.on("move",this._updateMoving),h.on("moveend",this._update),h.on("remove",this._clearFadeTimer),h._addMarker(this),this.setDraggable(this._draggable),this._update(),h.on("click",this._onMapClick)),this}remove(){const h=this._map;return h&&(h.off("click",this._onMapClick),h.off("move",this._updateMoving),h.off("moveend",this._update),h.off("mousedown",this._addDragHandler),h.off("touchstart",this._addDragHandler),h.off("mouseup",this._onUp),h.off("touchend",this._onUp),h.off("mousemove",this._onMove),h.off("touchmove",this._onMove),h.off("remove",this._clearFadeTimer),h._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(h){return this._lngLat=s.LngLat.convert(h),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(h){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),h){if(!("offset"in h.options)){const S=Math.sqrt(Math.pow(13.5,2)/2);h.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[S,-1*(38.1-13.5+S)],"bottom-right":[-S,-1*(38.1-13.5+S)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=h,h._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(h){const m=h.code,x=h.charCode||h.keyCode;m!=="Space"&&m!=="Enter"&&x!==32&&x!==13||this.togglePopup()}_onMapClick(h){const m=h.originalEvent.target,x=this._element;this._popup&&(m===x||x.contains(m))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const h=this._popup;return h?(h.isOpen()?(h.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(h.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const h=this._map,m=this._pos;if(!h||!m)return!1;const x=h.unproject(m),S=h.getFreeCameraOptions();if(!S.position)return!1;const A=S.position.toLngLat();return A.distanceTo(x)<.9*A.distanceTo(this._lngLat)}_evaluateOpacity(){const h=this._map;if(!h)return;const m=this._pos;if(!m||m.x<0||m.x>h.transform.width||m.y<0||m.y>h.transform.height)return void this._clearFadeTimer();const x=h.unproject(m);let S;h._showingGlobe()&&s.isLngLatBehindGlobe(h.transform,this._lngLat)?S=0:(S=1-h._queryFogOpacity(x),h.transform._terrainEnabled()&&h.getTerrain()&&this._behindTerrain()&&(S*=this._occludedOpacity)),this._element.style.opacity=`${S}`,this._element.style.pointerEvents=S>0?"auto":"none",this._popup&&this._popup._setOpacity(S),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const h=this._pos;if(!h||!this._map)return;const m=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${h.x}px,${h.y}px)
            ${Tc[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${m.x}px,${m.y}px)
        `}_calculateXYTransform(){const h=this._pos,m=this._map,x=this.getPitchAlignment();if(!m||!h||x!=="map")return"";if(!m._showingGlobe()){const z=m.getPitch();return z?`rotateX(${z}deg)`:""}const S=s.radToDeg(s.globeTiltAtLngLat(m.transform,this._lngLat)),A=h.sub(s.globeCenterToScreenPoint(m.transform)),R=Math.abs(A.x)+Math.abs(A.y);if(R===0)return"";const O=S/R;return`rotateX(${-A.y*O}deg) rotateY(${A.x*O}deg)`}_calculateZTransform(){const h=this._pos,m=this._map;if(!m||!h)return"";let x=0;const S=this.getRotationAlignment();if(S==="map")if(m._showingGlobe()){const A=m.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),R=m.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(A);x=s.radToDeg(Math.atan2(R.y,R.x))-90}else x=-m.getBearing();else if(S==="horizon"){const A=s.smoothstep(4,6,m.getZoom()),R=s.globeCenterToScreenPoint(m.transform);R.y+=A*m.transform.height;const O=h.sub(R),z=s.radToDeg(Math.atan2(O.y,O.x));x=(z>90?z-270:z+90)*(1-A)}return x+=this._rotation,x?`rotateZ(${x}deg)`:""}_update(h){s.window.cancelAnimationFrame(this._updateFrameId);const m=this._map;m&&(m.transform.renderWorldCopies&&(this._lngLat=ku(this._lngLat,this._pos,m.transform)),this._pos=m.project(this._lngLat),h===!0?this._updateFrameId=s.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),m._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(m._showingGlobe()||m.getTerrain()||m.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(h){return this._offset=s.Point.convert(h),this._update(),this}_onMove(h){const m=this._map;if(!m)return;const x=this._pointerdownPos,S=this._positionDelta;if(x&&S){if(!this._isDragging){const A=this._clickTolerance||m._clickTolerance;if(h.point.dist(x)<A)return;this._isDragging=!0}this._pos=h.point.sub(S),this._lngLat=m.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.Event("dragstart"))),this.fire(new s.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const h=this._map;h&&(h.off("mousemove",this._onMove),h.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new s.Event("dragend")),this._state="inactive"}_addDragHandler(h){const m=this._map,x=this._pos;m&&x&&this._element.contains(h.originalEvent.target)&&(h.preventDefault(),this._positionDelta=h.point.sub(x),this._pointerdownPos=h.point,this._state="pending",m.on("mousemove",this._onMove),m.on("touchmove",this._onMove),m.once("mouseup",this._onUp),m.once("touchend",this._onUp))}setDraggable(h){this._draggable=!!h;const m=this._map;return m&&(h?(m.on("mousedown",this._addDragHandler),m.on("touchstart",this._addDragHandler)):(m.off("mousedown",this._addDragHandler),m.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(h){return this._rotation=h||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(h){return this._rotationAlignment=h||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(h){return this._pitchAlignment=h||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(h){return this._occludedOpacity=h||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Ng={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},ME=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function m1(_=new s.Point(0,0),h="bottom"){if(typeof _=="number"){const m=Math.round(Math.sqrt(.5*Math.pow(_,2)));switch(h){case"top":return new s.Point(0,_);case"top-left":return new s.Point(m,m);case"top-right":return new s.Point(-m,m);case"bottom":return new s.Point(0,-_);case"bottom-left":return new s.Point(m,-m);case"bottom-right":return new s.Point(-m,-m);case"left":return new s.Point(_,0);case"right":return new s.Point(-_,0)}return new s.Point(0,0)}return _ instanceof s.Point||Array.isArray(_)?s.Point.convert(_):s.Point.convert(_[h]||[0,0])}class Ug{constructor(h){this.jumpTo(h)}getValue(h){if(h<=this._startTime)return this._start;if(h>=this._endTime)return this._end;const m=s.easeCubicInOut((h-this._startTime)/(this._endTime-this._startTime));return this._start*(1-m)+this._end*m}isEasing(h){return h>=this._startTime&&h<=this._endTime}jumpTo(h){this._startTime=-1/0,this._endTime=-1/0,this._start=h,this._end=h}easeTo(h,m,x){this._start=this.getValue(m),this._end=h,this._startTime=m,this._endTime=m+x}}const g1={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},y1={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},RE={showCompass:!0,showZoom:!0,visualizePitch:!1};class LE{constructor(h,m,x=!1){this._clickTolerance=10,this.element=m,this.mouseRotate=new Lg({clickTolerance:h.dragRotate._mouseRotate._clickTolerance}),this.map=h,x&&(this.mousePitch=new Og({clickTolerance:h.dragRotate._mousePitch._clickTolerance})),s.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),m.addEventListener("mousedown",this.mousedown),m.addEventListener("touchstart",this.touchstart,{passive:!1}),m.addEventListener("touchmove",this.touchmove),m.addEventListener("touchend",this.touchend),m.addEventListener("touchcancel",this.reset)}down(h,m){this.mouseRotate.mousedown(h,m),this.mousePitch&&this.mousePitch.mousedown(h,m),F()}move(h,m){const x=this.map,S=this.mouseRotate.mousemoveWindow(h,m),A=S&&S.bearingDelta;if(A&&x.setBearing(x.getBearing()+A),this.mousePitch){const R=this.mousePitch.mousemoveWindow(h,m),O=R&&R.pitchDelta;O&&x.setPitch(x.getPitch()+O)}}off(){const h=this.element;h.removeEventListener("mousedown",this.mousedown),h.removeEventListener("touchstart",this.touchstart,{passive:!1}),h.removeEventListener("touchmove",this.touchmove),h.removeEventListener("touchend",this.touchend),h.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){B(),s.window.removeEventListener("mousemove",this.mousemove),s.window.removeEventListener("mouseup",this.mouseup)}mousedown(h){this.down(s.extend({},h,{ctrlKey:!0,preventDefault:()=>h.preventDefault()}),ee(this.element,h)),s.window.addEventListener("mousemove",this.mousemove),s.window.addEventListener("mouseup",this.mouseup)}mousemove(h){this.move(h,ee(this.element,h))}mouseup(h){this.mouseRotate.mouseupWindow(h),this.mousePitch&&this.mousePitch.mouseupWindow(h),this.offTemp()}touchstart(h){h.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ne(this.element,h.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>h.preventDefault()},this._startPos))}touchmove(h){h.targetTouches.length!==1?this.reset():(this._lastPos=ne(this.element,h.targetTouches)[0],this.move({preventDefault:()=>h.preventDefault()},this._lastPos))}touchend(h){h.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Vg={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},jg={maxWidth:100,unit:"metric"},$g={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Fu={version:s.version,supported:p,setRTLTextPlugin:s.setRTLTextPlugin,getRTLTextPluginStatus:s.getRTLTextPluginStatus,Map:class extends Qf{constructor(_){if(s.LivePerformanceUtils.mark(s.PerformanceMarkers.create),(_=s.extend({},y1,_)).minZoom!=null&&_.maxZoom!=null&&_.minZoom>_.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(_.minPitch!=null&&_.maxPitch!=null&&_.minPitch>_.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(_.minPitch!=null&&_.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(_.maxPitch!=null&&_.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(_.antialias&&s.isSafariWithAntialiasingBug(s.window)&&(_.antialias=!1,s.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Ru(_.minZoom,_.maxZoom,_.minPitch,_.maxPitch,_.renderWorldCopies),_),this._interactive=_.interactive,this._minTileCacheSize=_.minTileCacheSize,this._maxTileCacheSize=_.maxTileCacheSize,this._failIfMajorPerformanceCaveat=_.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=_.preserveDrawingBuffer,this._antialias=_.antialias,this._useWebGL2=_.useWebGL2,this._trackResize=_.trackResize,this._bearingSnap=_.bearingSnap,this._refreshExpiredTiles=_.refreshExpiredTiles,this._fadeDuration=_.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=_.crossSourceCollisions,this._collectResourceTiming=_.collectResourceTiming,this._optimizeForTerrain=_.optimizeForTerrain,this._language=this._parseLanguage(_.language),this._worldview=_.worldview,this._renderTaskQueue=new zg,this._domRenderTaskQueue=new zg,this._controls=[],this._markers=[],this._popups=[],this._mapId=s.uniqueId(),this._locale=s.extend({},g1,_.locale),this._clickTolerance=_.clickTolerance,this._cooperativeGestures=_.cooperativeGestures,this._performanceMetricsCollection=_.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Ug(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new s.RequestManager(_.transformRequest,_.accessToken,_.testMode),this._silenceAuthErrors=!!_.testMode,typeof _.container=="string"){if(this._container=s.window.document.getElementById(_.container),!this._container)throw new Error(`Container '${_.container}' not found.`)}else{if(!(_.container instanceof s.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=_.container}if(this._container.childNodes.length>0&&s.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),_.maxBounds&&this.setMaxBounds(_.maxBounds),s.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),s.window!==void 0&&(s.window.addEventListener("online",this._onWindowOnline,!1),s.window.addEventListener("resize",this._onWindowResize,!1),s.window.addEventListener("orientationchange",this._onWindowResize,!1),s.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Ia(this,_),this._localFontFamily=_.localFontFamily,this._localIdeographFontFamily=_.localIdeographFontFamily,_.style&&this.setStyle(_.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),_.projection&&this.setProjection(_.projection),this._hash=_.hash&&new Pg(typeof _.hash=="string"&&_.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:_.center,zoom:_.zoom,bearing:_.bearing,pitch:_.pitch}),_.bounds&&(this.resize(),this.fitBounds(_.bounds,s.extend({},_.fitBoundsOptions,{duration:0})))),this.resize(),_.attributionControl&&this.addControl(new dn({customAttribution:_.customAttribution})),this._logoControl=new Bg,this.addControl(this._logoControl,_.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",h=>{this._update(h.dataType==="style"),this.fire(new s.Event(`${h.dataType}data`,h))}),this.on("dataloading",h=>{this.fire(new s.Event(`${h.dataType}dataloading`,h))})}_getMapId(){return this._mapId}addControl(_,h){if(h===void 0&&(h=_.getDefaultPosition?_.getDefaultPosition():"top-right"),!_||!_.onAdd)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const m=_.onAdd(this);this._controls.push(_);const x=this._controlPositions[h];return h.indexOf("bottom")!==-1?x.insertBefore(m,x.firstChild):x.appendChild(m),this}removeControl(_){if(!_||!_.onRemove)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const h=this._controls.indexOf(_);return h>-1&&this._controls.splice(h,1),_.onRemove(this),this}hasControl(_){return this._controls.indexOf(_)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(_){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const h=!this._moving;return h&&this.fire(new s.Event("movestart",_)).fire(new s.Event("move",_)),this.fire(new s.Event("resize",_)),h&&this.fire(new s.Event("moveend",_)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(_){return this.transform.setMaxBounds(s.LngLatBounds.convert(_)),this._update()}setMinZoom(_){if((_=_??-2)>=-2&&_<=this.transform.maxZoom)return this.transform.minZoom=_,this._update(),this.getZoom()<_?this.setZoom(_):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(_){if((_=_??22)>=this.transform.minZoom)return this.transform.maxZoom=_,this._update(),this.getZoom()>_?this.setZoom(_):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(_){if((_=_??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(_>=0&&_<=this.transform.maxPitch)return this.transform.minPitch=_,this._update(),this.getPitch()<_?this.setPitch(_):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(_){if((_=_??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(_>=this.transform.minPitch)return this.transform.maxPitch=_,this._update(),this.getPitch()>_?this.setPitch(_):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(_){return this.transform.renderWorldCopies=_,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(_){return _==="auto"?s.window.navigator.language:Array.isArray(_)?_.length===0?void 0:_.map(h=>h==="auto"?s.window.navigator.language:h):_}setLanguage(_){const h=this._parseLanguage(_);if(!this.style||h===this._language)return this;this._language=h,this.style._reloadSources();for(const m of this._controls)m._setLanguage&&m._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(_){return this.style&&_!==this._worldview?(this._worldview=_,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(_){return this._lazyInitEmptyStyle(),_?typeof _=="string"&&(_={name:_}):_=null,this._useExplicitProjection=!!_,this._prioritizeAndUpdateProjection(_,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const _=this.transform,h=_.projection.name;let m;h==="globe"&&_.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?(_.setMercatorFromTransition(),m=!0):h==="mercator"&&_.zoom<s.GLOBE_ZOOM_THRESHOLD_MAX&&(_.setProjection({name:"globe"}),m=!0),m&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(_,h){return this._updateProjection(_||h||{name:"mercator"})}_updateProjection(_){let h;if(h=_.name==="globe"&&this.transform.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(_),this.style.applyProjectionUpdate(),h){this.painter.clearBackgroundTiles();for(const m in this.style._sourceCaches)this.style._sourceCaches[m].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(_){return this.transform.locationPoint3D(s.LngLat.convert(_))}unproject(_){return this.transform.pointLocation3D(s.Point.convert(_))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(_,h,m){if(_==="mouseenter"||_==="mouseover"){let x=!1;const S=R=>{const O=h.filter($=>this.getLayer($)),z=O.length?this.queryRenderedFeatures(R.point,{layers:O}):[];z.length?x||(x=!0,m.call(this,new wo(_,this,R.originalEvent,{features:z}))):x=!1},A=()=>{x=!1};return{layers:new Set(h),listener:m,delegates:{mousemove:S,mouseout:A}}}if(_==="mouseleave"||_==="mouseout"){let x=!1;const S=R=>{const O=h.filter(z=>this.getLayer(z));(O.length?this.queryRenderedFeatures(R.point,{layers:O}):[]).length?x=!0:x&&(x=!1,m.call(this,new wo(_,this,R.originalEvent)))},A=R=>{x&&(x=!1,m.call(this,new wo(_,this,R.originalEvent)))};return{layers:new Set(h),listener:m,delegates:{mousemove:S,mouseout:A}}}{const x=S=>{const A=h.filter(O=>this.getLayer(O)),R=A.length?this.queryRenderedFeatures(S.point,{layers:A}):[];R.length&&(S.features=R,m.call(this,S),delete S.features)};return{layers:new Set(h),listener:m,delegates:{[_]:x}}}}on(_,h,m){if(m===void 0)return super.on(_,h);Array.isArray(h)||(h=[h]);const x=this._createDelegatedListener(_,h,m);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[_]=this._delegatedListeners[_]||[],this._delegatedListeners[_].push(x);for(const S in x.delegates)this.on(S,x.delegates[S]);return this}once(_,h,m){if(m===void 0)return super.once(_,h);Array.isArray(h)||(h=[h]);const x=this._createDelegatedListener(_,h,m);for(const S in x.delegates)this.once(S,x.delegates[S]);return this}off(_,h,m){if(m===void 0)return super.off(_,h);h=new Set(Array.isArray(h)?h:[h]);const x=(A,R)=>{if(A.size!==R.size)return!1;for(const O of A)if(!R.has(O))return!1;return!0},S=this._delegatedListeners?this._delegatedListeners[_]:void 0;return S&&(A=>{for(let R=0;R<A.length;R++){const O=A[R];if(O.listener===m&&x(O.layers,h)){for(const z in O.delegates)this.off(z,O.delegates[z]);return A.splice(R,1),this}}})(S),this}queryRenderedFeatures(_,h){return this.style?(h!==void 0||_===void 0||_ instanceof s.Point||Array.isArray(_)||(h=_,_=void 0),this.style.queryRenderedFeatures(_=_||[[0,0],[this.transform.width,this.transform.height]],h=h||{},this.transform)):[]}querySourceFeatures(_,h){return this.style.querySourceFeatures(_,h)}isPointOnSurface(_){const{name:h}=this.transform.projection;return h!=="globe"&&h!=="mercator"&&s.warnOnce(`${h} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(s.Point.convert(_))}setStyle(_,h){return(h=s.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},h)).diff!==!1&&h.localIdeographFontFamily===this._localIdeographFontFamily&&h.localFontFamily===this._localFontFamily&&this.style&&_?(this._diffStyle(_,h),this):(this._localIdeographFontFamily=h.localIdeographFontFamily,this._localFontFamily=h.localFontFamily,this._updateStyle(_,h))}_getUIString(_){const h=this._locale[_];if(h==null)throw new Error(`Missing UI string '${_}'`);return h}_updateStyle(_,h){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),_&&(this.style=new Aa(this,h||{}),this.style.setEventedParent(this,{style:this.style}),typeof _=="string"?this.style.loadURL(_):this.style.loadJSON(_)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Aa(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(_,h){if(typeof _=="string"){const m=this._requestManager.normalizeStyleURL(_),x=this._requestManager.transformRequest(m,s.ResourceType.Style);s.getJSON(x,(S,A)=>{S?this.fire(new s.ErrorEvent(S)):A&&this._updateDiff(A,h)})}else typeof _=="object"&&this._updateDiff(_,h)}_updateDiff(_,h){try{this.style.setState(_)&&this._update(!0)}catch(m){s.warnOnce(`Unable to perform style diff: ${m.message||m.error||m}.  Rebuilding the style from scratch.`),this._updateStyle(_,h)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(s.warnOnce("There is no style added to the map."),!1)}addSource(_,h){return this._lazyInitEmptyStyle(),this.style.addSource(_,h),this._update(!0)}isSourceLoaded(_){return!!this.style&&this.style._isSourceCacheLoaded(_)}areTilesLoaded(){const _=this.style&&this.style._sourceCaches;for(const h in _){const m=_[h]._tiles;for(const x in m){const S=m[x];if(S.state!=="loaded"&&S.state!=="errored")return!1}}return!0}addSourceType(_,h,m){this._lazyInitEmptyStyle(),this.style.addSourceType(_,h,m)}removeSource(_){return this.style.removeSource(_),this._updateTerrain(),this._update(!0)}getSource(_){return this.style.getSource(_)}addImage(_,h,{pixelRatio:m=1,sdf:x=!1,stretchX:S,stretchY:A,content:R}={}){if(this._lazyInitEmptyStyle(),h instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&h instanceof s.window.ImageBitmap){const{width:O,height:z,data:$}=s.exported.getImageData(h);this.style.addImage(_,{data:new s.RGBAImage({width:O,height:z},$),pixelRatio:m,stretchX:S,stretchY:A,content:R,sdf:x,version:0})}else if(h.width===void 0||h.height===void 0)this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:O,height:z}=h,$=h;this.style.addImage(_,{data:new s.RGBAImage({width:O,height:z},new Uint8Array($.data)),pixelRatio:m,stretchX:S,stretchY:A,content:R,sdf:x,version:0,userImage:$}),$.onAdd&&$.onAdd(this,_)}}updateImage(_,h){const m=this.style.getImage(_);if(!m)return void this.fire(new s.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const x=h instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&h instanceof s.window.ImageBitmap?s.exported.getImageData(h):h,{width:S,height:A}=x;S!==void 0&&A!==void 0?S===m.data.width&&A===m.data.height?(m.data.replace(x.data,!(h instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&h instanceof s.window.ImageBitmap)),this.style.updateImage(_,m)):this.fire(new s.ErrorEvent(new Error(`The width and height of the updated image (${S}, ${A})
                must be that same as the previous version of the image
                (${m.data.width}, ${m.data.height})`))):this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(_){return _?!!this.style.getImage(_):(this.fire(new s.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(_){this.style.removeImage(_)}loadImage(_,h){s.getImage(this._requestManager.transformRequest(_,s.ResourceType.Image),(m,x)=>{h(m,x instanceof s.window.HTMLImageElement?s.exported.getImageData(x):x)})}listImages(){return this.style.listImages()}addLayer(_,h){return this._lazyInitEmptyStyle(),this.style.addLayer(_,h),this._update(!0)}moveLayer(_,h){return this.style.moveLayer(_,h),this._update(!0)}removeLayer(_){return this.style.removeLayer(_),this._update(!0)}getLayer(_){return this.style.getLayer(_)}setLayerZoomRange(_,h,m){return this.style.setLayerZoomRange(_,h,m),this._update(!0)}setFilter(_,h,m={}){return this.style.setFilter(_,h,m),this._update(!0)}getFilter(_){return this.style.getFilter(_)}setPaintProperty(_,h,m,x={}){return this.style.setPaintProperty(_,h,m,x),this._update(!0)}getPaintProperty(_,h){return this.style.getPaintProperty(_,h)}setLayoutProperty(_,h,m,x={}){return this.style.setLayoutProperty(_,h,m,x),this._update(!0)}getLayoutProperty(_,h){return this.style.getLayoutProperty(_,h)}setLight(_,h={}){return this._lazyInitEmptyStyle(),this.style.setLight(_,h),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(_){return this._lazyInitEmptyStyle(),!_&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(_),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(_){return this._lazyInitEmptyStyle(),this.style.setFog(_),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(_){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(s.LngLat.convert(_),this.transform):0}setFeatureState(_,h){return this.style.setFeatureState(_,h),this._update()}removeFeatureState(_,h){return this.style.removeFeatureState(_,h),this._update()}getFeatureState(_){return this.style.getFeatureState(_)}_updateContainerDimensions(){if(!this._container)return;const _=this._container.getBoundingClientRect().width||400,h=this._container.getBoundingClientRect().height||300;let m,x,S,A=this._container;for(;A&&(!x||!S);){const R=s.window.getComputedStyle(A).transform;R&&R!=="none"&&(m=R.match(/matrix.*\((.+)\)/)[1].split(", "),m[0]&&m[0]!=="0"&&m[0]!=="1"&&(x=m[0]),m[3]&&m[3]!=="0"&&m[3]!=="1"&&(S=m[3])),A=A.parentElement}this._containerWidth=x?Math.abs(_/x):_,this._containerHeight=S?Math.abs(h/S):h}_detectMissingCSS(){s.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&s.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const _=this._container;_.classList.add("mapboxgl-map"),(this._missingCSSCanary=w("div","mapboxgl-canary",_)).style.visibility="hidden",this._detectMissingCSS();const h=this._canvasContainer=w("div","mapboxgl-canvas-container",_);this._interactive&&h.classList.add("mapboxgl-interactive"),this._canvas=w("canvas","mapboxgl-canvas",h),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const m=this._controlContainer=w("div","mapboxgl-control-container",_),x=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(S=>{x[S]=w("div",`mapboxgl-ctrl-${S}`,m)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(_,h){const m=s.exported.devicePixelRatio||1;this._canvas.width=m*Math.ceil(_),this._canvas.height=m*Math.ceil(h),this._canvas.style.width=`${_}px`,this._canvas.style.height=`${h}px`}_addMarker(_){this._markers.push(_)}_removeMarker(_){const h=this._markers.indexOf(_);h!==-1&&this._markers.splice(h,1)}_addPopup(_){this._popups.push(_)}_removePopup(_){const h=this._popups.indexOf(_);h!==-1&&this._popups.splice(h,1)}_setupPainter(){const _=s.extend({},p.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),h=this._useWebGL2&&this._canvas.getContext("webgl2",_),m=h||this._canvas.getContext("webgl",_)||this._canvas.getContext("experimental-webgl",_);m?(this._useWebGL2&&!h&&s.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),s.storeAuthState(m,!0),this.painter=new Iu(m,this.transform,!!h),this.on("data",x=>{x.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),s.exported$1.testSupport(m)):this.fire(new s.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(_){_.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.Event("webglcontextlost",{originalEvent:_}))}_contextRestored(_){this._setupPainter(),this.resize(),this._update(),this.fire(new s.Event("webglcontextrestored",{originalEvent:_}))}_onMapScroll(_){if(_.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(_){return this.style?(this._styleDirty=this._styleDirty||_,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(_){return this._update(),this._renderTaskQueue.add(_)}_cancelRenderFrame(_){this._renderTaskQueue.remove(_)}_requestDomTask(_){!this.loaded()||this.loaded()&&!this.isMoving()?_():this._domRenderTaskQueue.add(_)}_render(_){let h;const m=this.painter.context.extTimerQuery,x=s.exported.now();if(this.listens("gpu-timing-frame")&&(h=m.createQueryEXT(),m.beginQueryEXT(m.TIME_ELAPSED_EXT,h)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],s.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],s.window.performance.now())),this._renderTaskQueue.run(_),this._domRenderTaskQueue.run(_),this._removed)return;this._updateProjectionTransition();const S=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const O=this.transform.zoom,z=this.transform.pitch,$=s.exported.now(),j=new s.EvaluationParameters(O,{now:$,fadeDuration:S,pitch:z,transition:this.style.getTransition()});this.style.update(j)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let A=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),A=this._updateAverageElevation(x),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):A=this._updateAverageElevation(x),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,S,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new s.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new s.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),h){const O=s.exported.now()-x;m.endQueryEXT(m.TIME_ELAPSED_EXT,h),setTimeout(()=>{const z=m.getQueryObjectEXT(h,m.QUERY_RESULT_EXT)/1e6;m.deleteQueryEXT(h),this.fire(new s.Event("gpu-timing-frame",{cpuTime:O,gpuTime:z})),s.window.performance.mark("frame-gpu",{startTime:x,detail:{gpuTime:z}})},50)}if(this.listens("gpu-timing-layer")){const O=this.painter.collectGpuTimers();setTimeout(()=>{const z=this.painter.queryGpuTimers(O);this.fire(new s.Event("gpu-timing-layer",{layerTimes:z}))},50)}if(this.listens("gpu-timing-deferred-render")){const O=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const z=this.painter.queryGpuTimeDeferredRender(O);this.fire(new s.Event("gpu-timing-deferred-render",{gpuTime:z}))},50)}const R=this._sourcesDirty||this._styleDirty||this._placementDirty||A;if(R||this._repaint)this.triggerRepaint();else{const O=!this.isMoving()&&this.loaded();if(O&&(A=this._updateAverageElevation(x,!0)),A)this.triggerRepaint();else if(this._triggerFrame(!1),O&&(this.fire(new s.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const z=this._calculateSpeedIndex();this.fire(new s.Event("speedindexcompleted",{speedIndex:z})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||R||(this._fullyLoaded=!0,s.LivePerformanceUtils.mark(s.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&s.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(_){for(const h of this._markers)_&&!this.getRenderWorldCopies()&&(h._lngLat=h._lngLat.wrap()),h._update();for(const h of this._popups)!_||this.getRenderWorldCopies()||h._trackPointer||(h._lngLat=h._lngLat.wrap()),h._update()}_updateAverageElevation(_,h=!1){const m=x=>(this.transform.averageElevation=x,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&m(0);if((h||_-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(_)){const x=this.transform.averageElevation;let S=this.transform.sampleAverageElevation(),A=!1;this.transform.elevation&&(A=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(S)?S=0:this._averageElevationLastSampledAt=_;const R=Math.abs(x-S);if(R>1){if(this._isInitialLoad||A)return this._averageElevation.jumpTo(S),m(S);this._averageElevation.easeTo(S,_,300)}else if(R>1e-4)return this._averageElevation.jumpTo(S),m(S)}return!!this._averageElevation.isEasing(_)&&m(this._averageElevation.getValue(_))}_authenticate(){s.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,_=>{if(_&&(_.message===s.AUTH_ERR_MSG||_.status===401)){const h=this.painter.context.gl;s.storeAuthState(h,!1),this._logoControl instanceof Bg&&this._logoControl._updateLogo(),h&&h.clear(h.DEPTH_BUFFER_BIT|h.COLOR_BUFFER_BIT|h.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new s.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),s.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const _=this._isDragging();this.painter.updateTerrain(this.style,_)}_calculateSpeedIndex(){const _=this.painter.canvasCopy(),h=this.painter.getCanvasCopiesAndTimestamps();h.timeStamps.push(performance.now());const m=this.painter.context.gl,x=m.createFramebuffer();function S(A){m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,A,0);const R=new Uint8Array(m.drawingBufferWidth*m.drawingBufferHeight*4);return m.readPixels(0,0,m.drawingBufferWidth,m.drawingBufferHeight,m.RGBA,m.UNSIGNED_BYTE,R),R}return m.bindFramebuffer(m.FRAMEBUFFER,x),this._canvasPixelComparison(S(_),h.canvasCopies.map(S),h.timeStamps)}_canvasPixelComparison(_,h,m){let x=m[1]-m[0];const S=_.length/4;for(let A=0;A<h.length;A++){const R=h[A];let O=0;for(let z=0;z<R.length;z+=4)R[z]===_[z]&&R[z+1]===_[z+1]&&R[z+2]===_[z+2]&&R[z+3]===_[z+3]&&(O+=1);x+=(m[A+2]-m[A+1])*(1-O/S)}return x}remove(){this._hash&&this._hash.remove();for(const h of this._controls)h.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),s.window!==void 0&&(s.window.removeEventListener("resize",this._onWindowResize,!1),s.window.removeEventListener("orientationchange",this._onWindowResize,!1),s.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.removeEventListener("online",this._onWindowOnline,!1),s.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const _=this.painter.context.gl.getExtension("WEBGL_lose_context");_&&_.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),s.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new s.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(_){this._renderNextFrame=this._renderNextFrame||_,this.style&&!this._frame&&(this._frame=s.exported.frame(h=>{const m=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,m&&this._render(h)}))}_preloadTiles(_){const h=this.style?Object.values(this.style._sourceCaches):[];return s.asyncAll(h,(m,x)=>m._preloadTiles(_,x),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(_){this._trackResize&&this.resize({originalEvent:_})._update()}_onVisibilityChange(){s.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(_){this._showTileBoundaries!==_&&(this._showTileBoundaries=_,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(_){this._showTerrainWireframe!==_&&(this._showTerrainWireframe=_,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(_){this._speedIndexTiming!==_&&(this._speedIndexTiming=_,this._update())}get showPadding(){return!!this._showPadding}set showPadding(_){this._showPadding!==_&&(this._showPadding=_,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(_){this._showCollisionBoxes!==_&&(this._showCollisionBoxes=_,_?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(_){this._showOverdrawInspector!==_&&(this._showOverdrawInspector=_,this._update())}get repaint(){return!!this._repaint}set repaint(_){this._repaint!==_&&(this._repaint=_,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(_){this._vertices=_,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(_){this._showTileAABBs!==_&&(this._showTileAABBs=_,_&&this._update())}_setCacheLimits(_,h){s.setCacheLimits(_,h)}get version(){return s.version}},NavigationControl:class{constructor(_){this.options=s.extend({},RE,_),this._container=w("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",h=>h.preventDefault()),this.options.showZoom&&(s.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",h=>{this._map&&this._map.zoomIn({},{originalEvent:h})}),w("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",h=>{this._map&&this._map.zoomOut({},{originalEvent:h})}),w("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(s.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",h=>{const m=this._map;m&&(this.options.visualizePitch?m.resetNorthPitch({},{originalEvent:h}):m.resetNorth({},{originalEvent:h}))}),this._compassIcon=w("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const _=this._map;if(!_)return;const h=_.getZoom(),m=h===_.getMaxZoom(),x=h===_.getMinZoom();this._zoomInButton.disabled=m,this._zoomOutButton.disabled=x,this._zoomInButton.setAttribute("aria-disabled",m.toString()),this._zoomOutButton.setAttribute("aria-disabled",x.toString())}_rotateCompassArrow(){const _=this._map;if(!_)return;const h=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(_.transform.pitch*(Math.PI/180)),.5)}) rotateX(${_.transform.pitch}deg) rotateZ(${_.transform.angle*(180/Math.PI)}deg)`:`rotate(${_.transform.angle*(180/Math.PI)}deg)`;_._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=h)})}onAdd(_){return this._map=_,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),_.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&_.on("pitch",this._rotateCompassArrow),_.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new LE(_,this._compass,this.options.visualizePitch)),this._container}onRemove(){const _=this._map;_&&(this._container.remove(),this.options.showZoom&&_.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&_.off("pitch",this._rotateCompassArrow),_.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(_,h){const m=w("button",_,this._container);return m.type="button",m.addEventListener("click",h),m}_setButtonTitle(_,h){if(!this._map)return;const m=this._map._getUIString(`NavigationControl.${h}`);_.setAttribute("aria-label",m),_.firstElementChild&&_.firstElementChild.setAttribute("title",m)}},GeolocateControl:class extends s.Evented{constructor(_){super(),this.options=s.extend({geolocation:s.window.navigator.geolocation},Vg,_),s.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Lu(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(_){return this._map=_,this._container=w("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(_){const h=(m=!!this.options.geolocation)=>{this._supportsGeolocation=m,_(m)};this._supportsGeolocation!==void 0?_(this._supportsGeolocation):s.window.navigator.permissions!==void 0?s.window.navigator.permissions.query({name:"geolocation"}).then(m=>h(m.state!=="denied")).catch(()=>h()):h()}_isOutOfMapMaxBounds(_){const h=this._map.getMaxBounds(),m=_.coords;return!!h&&(m.longitude<h.getWest()||m.longitude>h.getEast()||m.latitude<h.getSouth()||m.latitude>h.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(_){if(this._map){if(this._isOutOfMapMaxBounds(_))return this._setErrorState(),this.fire(new s.Event("outofmaxbounds",_)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=_,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(_),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(_),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("geolocate",_)),this._finish()}}_updateCamera(_){const h=new s.LngLat(_.coords.longitude,_.coords.latitude),m=_.coords.accuracy,x=this._map.getBearing(),S=s.extend({bearing:x},this.options.fitBoundsOptions);this._map.fitBounds(h.toBounds(m),S,{geolocateSource:!0})}_updateMarker(_){if(_){const h=new s.LngLat(_.coords.longitude,_.coords.latitude);this._accuracyCircleMarker.setLngLat(h).addTo(this._map),this._userLocationDotMarker.setLngLat(h).addTo(this._map),this._accuracy=_.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const _=this._map.transform,h=s.mercatorZfromAltitude(1,_._center.lat)*_.worldSize,m=Math.ceil(2*this._accuracy*h);this._circleElement.style.width=`${m}px`,this._circleElement.style.height=`${m}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(_){if(this._map){if(this.options.trackUserLocation)if(_.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",h),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",h),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(_.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("error",_)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(_){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",h=>h.preventDefault()),this._geolocateButton=w("button","mapboxgl-ctrl-geolocate",this._container),w("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",_===!1){s.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",h),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",h)}else{const h=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",h),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",h)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=w("div","mapboxgl-user-location"),this._dotElement.appendChild(w("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(w("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new an({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=w("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new an({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",h=>{h.geolocateSource||this._watchState!=="ACTIVE_LOCK"||h.originalEvent&&h.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new s.Event("trackuserlocationend")))})}}_onDeviceOrientation(_){this._userLocationDotMarker&&(_.webkitCompassHeading?this._heading=_.webkitCompassHeading:_.absolute===!0&&(this._heading=-1*_.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return s.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let _;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(_={maximumAge:6e5,timeout:0},this._noTimeout=!0):(_=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,_),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const _=()=>{s.window.addEventListener("ondeviceorientationabsolute"in s.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};s.window.DeviceMotionEvent!==void 0&&typeof s.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(h=>{h==="granted"&&_()}).catch(console.error):_()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),s.window.removeEventListener("deviceorientation",this._onDeviceOrientation),s.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:dn,ScaleControl:class{constructor(_){this.options=s.extend({},jg,_),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),s.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const _=this.options.maxWidth||100,h=this._map,m=h._containerHeight/2,x=h._containerWidth/2-_/2,S=h.unproject([x,m]),A=h.unproject([x+_,m]),R=S.distanceTo(A);if(this.options.unit==="imperial"){const O=3.2808*R;O>5280?this._setScale(_,O/5280,"mile"):this._setScale(_,O,"foot")}else this.options.unit==="nautical"?this._setScale(_,R/1852,"nautical-mile"):R>=1e3?this._setScale(_,R/1e3,"kilometer"):this._setScale(_,R,"meter")}_setScale(_,h,m){this._map._requestDomTask(()=>{const x=function(A){const R=Math.pow(10,`${Math.floor(A)}`.length-1);let O=A/R;return O=O>=10?10:O>=5?5:O>=3?3:O>=2?2:O>=1?1:function(z){const $=Math.pow(10,Math.ceil(-Math.log(z)/Math.LN10));return Math.round(z*$)/$}(O),R*O}(h),S=x/h;this._container.innerHTML=this._isNumberFormatSupported&&m!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:m}).format(x):`${x}&nbsp;${$g[m]}`,this._container.style.width=_*S+"px"})}onAdd(_){return this._map=_,this._language=_.getLanguage(),this._container=w("div","mapboxgl-ctrl mapboxgl-ctrl-scale",_.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(_){this._language=_,this._update()}setUnit(_){this.options.unit=_,this._update()}},FullscreenControl:class{constructor(_){this._fullscreen=!1,_&&_.container&&(_.container instanceof s.window.HTMLElement?this._container=_.container:s.warnOnce("Full screen control 'container' must be a DOM element.")),s.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in s.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in s.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(_){return this._map=_,this._container||(this._container=this._map.getContainer()),this._controlContainer=w("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,s.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!s.window.document.fullscreenEnabled&&!s.window.document.webkitFullscreenEnabled)}_setupUI(){const _=this._fullscreenButton=w("button","mapboxgl-ctrl-fullscreen",this._controlContainer);w("span","mapboxgl-ctrl-icon",_).setAttribute("aria-hidden","true"),_.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),s.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const _=this._getTitle();this._fullscreenButton.setAttribute("aria-label",_),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",_)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(s.window.document.fullscreenElement||s.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?s.window.document.exitFullscreen?s.window.document.exitFullscreen():s.window.document.webkitCancelFullScreen&&s.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends s.Evented{constructor(_){super(),this.options=s.extend(Object.create(Ng),_),s.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(_&&_.className?_.className.trim().split(/\s+/):[])}addTo(_){return this._map&&this.remove(),this._map=_,this.options.closeOnClick&&_.on("preclick",this._onClose),this.options.closeOnMove&&_.on("move",this._onClose),_.on("remove",this.remove),this._update(),_._addPopup(this),this._focusFirstElement(),this._trackPointer?(_.on("mousemove",this._onMouseEvent),_.on("mouseup",this._onMouseEvent),_._canvasContainer.classList.add("mapboxgl-track-pointer")):_.on("move",this._update),this.fire(new s.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const _=this._map;return _&&(_.off("move",this._update),_.off("move",this._onClose),_.off("preclick",this._onClose),_.off("click",this._onClose),_.off("remove",this.remove),_.off("mousemove",this._onMouseEvent),_.off("mouseup",this._onMouseEvent),_.off("drag",this._onMouseEvent),_._canvasContainer&&_._canvasContainer.classList.remove("mapboxgl-track-pointer"),_._removePopup(this),this._map=void 0),this.fire(new s.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(_){this._lngLat=s.LngLat.convert(_),this._pos=null,this._trackPointer=!1,this._update();const h=this._map;return h&&(h.on("move",this._update),h.off("mousemove",this._onMouseEvent),h._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const _=this._map;return _&&(_.off("move",this._update),_.on("mousemove",this._onMouseEvent),_.on("drag",this._onMouseEvent),_._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(_){return this.setDOMContent(s.window.document.createTextNode(_))}setHTML(_){const h=s.window.document.createDocumentFragment(),m=s.window.document.createElement("body");let x;for(m.innerHTML=_;x=m.firstChild,x;)h.appendChild(x);return this.setDOMContent(h)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(_){return this.options.maxWidth=_,this._update(),this}setDOMContent(_){let h=this._content;if(h)for(;h.hasChildNodes();)h.firstChild&&h.removeChild(h.firstChild);else h=this._content=w("div","mapboxgl-popup-content",this._container||void 0);if(h.appendChild(_),this.options.closeButton){const m=this._closeButton=w("button","mapboxgl-popup-close-button",h);m.type="button",m.setAttribute("aria-label","Close popup"),m.setAttribute("aria-hidden","true"),m.innerHTML="&#215;",m.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(_){return this._classList.add(_),this._updateClassList(),this}removeClassName(_){return this._classList.delete(_),this._updateClassList(),this}setOffset(_){return this.options.offset=_,this._update(),this}toggleClassName(_){let h;return this._classList.delete(_)?h=!1:(this._classList.add(_),h=!0),this._updateClassList(),h}_onMouseEvent(_){this._update(_.point)}_getAnchor(_){if(this.options.anchor)return this.options.anchor;const h=this._map,m=this._container,x=this._pos;if(!h||!m||!x)return"bottom";const S=m.offsetWidth,A=m.offsetHeight,R=x.x<S/2,O=x.x>h.transform.width-S/2;if(x.y+_<A)return R?"top-left":O?"top-right":"top";if(x.y>h.transform.height-A){if(R)return"bottom-left";if(O)return"bottom-right"}return R?"left":O?"right":"bottom"}_updateClassList(){const _=this._container;if(!_)return;const h=[...this._classList];h.push("mapboxgl-popup"),this._anchor&&h.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&h.push("mapboxgl-popup-track-pointer"),_.className=h.join(" ")}_update(_){const h=this._map,m=this._content;if(!h||!this._lngLat&&!this._trackPointer||!m)return;let x=this._container;if(x||(x=this._container=w("div","mapboxgl-popup",h.getContainer()),this._tip=w("div","mapboxgl-popup-tip",x),x.appendChild(m)),this.options.maxWidth&&x.style.maxWidth!==this.options.maxWidth&&(x.style.maxWidth=this.options.maxWidth),h.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ku(this._lngLat,this._pos,h.transform)),!this._trackPointer||_){const S=this._pos=this._trackPointer&&_?_:h.project(this._lngLat),A=m1(this.options.offset),R=this._anchor=this._getAnchor(A.y),O=m1(this.options.offset,R),z=S.add(O).round();h._requestDomTask(()=>{this._container&&R&&(this._container.style.transform=`${Tc[R]} translate(${z.x}px,${z.y}px)`)})}if(!this._marker&&h._showingGlobe()){const S=s.isLngLatBehindGlobe(h.transform,this._lngLat)?0:1;this._setOpacity(S)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const _=this._container.querySelector(ME);_&&_.focus()}_onClose(){this.remove()}_setOpacity(_){this._container&&(this._container.style.opacity=`${_}`),this._content&&(this._content.style.pointerEvents=_?"auto":"none")}},Marker:an,Style:Aa,LngLat:s.LngLat,LngLatBounds:s.LngLatBounds,Point:s.Point,MercatorCoordinate:s.MercatorCoordinate,FreeCameraOptions:e1,Evented:s.Evented,config:s.config,prewarm:function(){Bo().acquire(Ko)},clearPrewarmedResources:function(){const _=Kr;_&&(_.isPreloaded()&&_.numActive()===1?(_.release(Ko),Kr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return s.config.ACCESS_TOKEN},set accessToken(_){s.config.ACCESS_TOKEN=_},get baseApiUrl(){return s.config.API_URL},set baseApiUrl(_){s.config.API_URL=_},get workerCount(){return Cr.workerCount},set workerCount(_){Cr.workerCount=_},get maxParallelImageRequests(){return s.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(_){s.config.MAX_PARALLEL_IMAGE_REQUESTS=_},clearStorage(_){s.clearTileCache(_)},workerUrl:"",workerClass:null,setNow:s.exported.setNow,restoreNow:s.exported.restoreNow};return Fu});var l=r;return l})})(JU);var A3=JU.exports;const Z1e=u_(A3),q1e=Q8({__proto__:null,default:Z1e},[A3]),Y1e=["id"],J1e=pr({__name:"MapboxContainer",props:{accessToken:{},mapStyle:{},mapBoxSettings:{}},setup(t){const e=$r(ng),n=$r(mu),i=t;let r=null;const o=s_(),l=Xa();Ds(()=>{console.log("mapbox obj",q1e),r=new A3.Map({...i.mapBoxSettings,...o,style:i.mapStyle,accessToken:i.accessToken,container:`map-${n.mapType}-${n.mapID}`}),r.on("style.load",()=>{r.addSource("mapbox-dem",{type:"raster-dem",url:"mapbox://mapbox.mapbox-terrain-dem-v1",tileSize:512,maxzoom:14}),r.setTerrain({source:"mapbox-dem",exaggeration:1.5})}),r.on("load",function(){r.resize()}),Ri(e,()=>{r.resize()},{immediate:!0});const d=l.deckGLMapState.findIndex(p=>p._metaData.id===n.mapID&&p._metaData.mType==n.mapType&&p._metaData.active);s(l.deckGLMapState[d]._viewState),Ri(l.deckGLMapState[d]._viewState,p=>{s(p)})});function s(d){r.jumpTo({center:[d.longitude,d.latitude],zoom:d.zoom,bearing:d.bearing,pitch:d.pitch})}return(d,p)=>(le(),Ue("div",{id:`map-${Yt(n).mapType}-${Yt(n).mapID}`,ref:`map-${Yt(n).mapType}-${Yt(n).mapID}`,class:"mapboxMap w-full h-full absolute top-0 left-0"},null,8,Y1e))}});const Q1e={id:"map-wrapper",class:"deck-wrapper",style:{width:"100%",height:"100%"}},eV=pr({__name:"SingleMap",setup(t){const e=Xa(),n=$r(mu);let i=`map-${n.mapType}-${n.mapID}`,r={...ipe,container:i};return(o,l)=>(le(),Ue("div",Q1e,[Lt(X1e,null,{default:Cn(()=>[Lt(J1e,{"access-token":Yt(e).accessToken,"map-style":Yt(r).style,"map-box-settings":Yt(r)},null,8,["access-token","map-style","map-box-settings"])]),_:1})]))}});const ebe={},tbe={class:"loading"},nbe=Qe("div",{class:"spinner"},null,-1),ibe=Qe("div",{class:"loading-text"}," Loading... ",-1),rbe=[nbe,ibe];function obe(t,e){return le(),Ue("div",tbe,rbe)}const tV=po(ebe,[["render",obe]]),Rs=E2("dataStore",{state:()=>({data:{}}),actions:{createEntry(t){this.data[t]={}},createFireData(t){this.data[t]={roads:[],temperature:[],humidity:[],wind:[],perimeter:[],frp:[],det:[]}},createWaterData(t){this.data[t]={unmetdemand:{},groundwater:{},shapes:{}}},updateData(t,e,n,i){this.data[t]==null&&(i=="fire"?this.createFireData(t):i=="water"?this.createWaterData(t):console.log("Error: Invalid data type")),this.data[t][n]=e},getPerimeterData(t){return this.data[t].perimeter},getData(t,e){return this.data[t][e]}}}),kP={Overview:"0",Single:"1",ComparisonLeft:"2",ComparisonRight:"3"},sbe={Overview:"1",SingleFire:"2",FireComparison:"3"},Wd={mapIdentifier:kP,templateIdentifier:sbe},abe={headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json"}},Ea=E2("wildfireList",{state:()=>({validFire:{[Wd.mapIdentifier.Overview]:!1,[Wd.mapIdentifier.SingleFire]:!1,[Wd.mapIdentifier.FireComparisonLeft]:!1,[Wd.mapIdentifier.FireComparisonRight]:!1},fire:{},fireList:[],isFireListReady:!1}),getters:{getWildFiresYearRange(){let t=this.fireList.map(n=>n.fire_year<1?new Date(n.start_date).getUTCFullYear():new Date(n.fire_year,0).getUTCFullYear());return new Set(t)},getWildFiresAcresRange(){return this.fireList.map(t=>parseInt(t.acres))},getWildFirePerimeters(){return this.fireList.map(e=>+e.perimeter_count).sort((e,n)=>e>n?1:n>e?-1:0)},getWildfireNames(){return this.fireList.map(t=>t.name)},getWildFirePrettifyList(){return this.fireList.map((t,e)=>(t.fire_year<1?new Date(t.start_date).getUTCFullYear():new Date(t.fire_year,0).getUTCFullYear(),{name:t.name,year:t.fire_year,acres:parseInt(t.acres),perimeters:t.perimeter_count,centroid:t.centroid,id:t.id,key:e}))}},actions:{selectFireChange(t){this.validFire=!1,t.id!==-1&&(this.validFire=!0)},getWildfireByID(t){return this.fireList.find(e=>e.id===t)},getWildfireByName(t){return this.fireList.find(e=>e.name===t)},getWildfiresByYear(t){return this.fireList.filter(e=>e.fire_year===t)},getWildfiresUntilYear(t){return this.fireList.filter(e=>e.fire_year<=t)},getWildfiresByYearAndAcres(t,e){return this.fireList.filter(i=>i.fire_year===t).filter(i=>{let r=isNaN(i.acres)||i.acres===null?0:i.acres;return o=>r<=e})},async fetchFireList(){this.isFireListReady=!1;try{const t=await ps.post("http://infovis.cs.ucdavis.edu/wildfire/api/firedash/wildfires/list",{state:"CA"},abe);this.fireList=t.data,this.isFireListReady=!0,console.log("Fire List Is Ready",t.data[0])}catch(t){throw console.log("error :>> ",t),t.message}}}}),lbe=[{icon:"fbfm40",name:"fbfm40",visibility:!1,type:"TileLayer",parameters:{source:"wmts",data:"fbfm40",url:"http://infovis.cs.ucdavis.edu/mapProxy/wmts/fbfm40/webmercator"},id:0,description:"Fire Behavior Fuel Model 40 Attributes",animated:!1},{icon:"aspect",name:"Aspect",visibility:!1,type:"TileLayer",parameters:{source:"wmts",data:"aspect",url:"http://infovis.cs.ucdavis.edu/mapProxy/wmts/aspect/webmercator"},id:1,description:"Azimuth of the sloped surfaces across a landscape",animated:!1},{icon:"elevation",name:"Elevation",visibility:!1,type:"TileLayer",parameters:{source:"wmts",data:"elevation",url:"http://infovis.cs.ucdavis.edu/mapProxy/wmts/elevation/webmercator"},id:2,description:"Represents land height, in meters, above mean sea level.",animated:!1},{icon:"roads",name:"Roads",visibility:!0,type:"GeoJSON",parameters:{source:"",url:""},id:3,description:"",animated:!1},{icon:"satellite",name:"Satellite",visibility:!0,type:"",parameters:{data:"FRP_DET"},id:4,description:"FRP + Det",animated:!0},{icon:"perimeter",name:"Perimeter",type:"",visibility:!0,parameters:{data:"perimeter"},id:7,description:"Wildfire bounded region",animated:!0},{icon:"wind",name:"Wind",type:"Wind",visibility:!1,parameters:{data:"wind"},id:7,description:"Wildfire bounded region",animated:!0}],cbe=[{icon:"water-tap",name:"Baseline deliveries",visibility:!0,type:"GeoJSON",parameters:{source:"wmts",data:"fbfm40",url:"http://infovis.cs.ucdavis.edu/mapProxy/wmts/fbfm40/webmercator"},id:0,description:"",animated:!0},{icon:"water-tap",name:"bl_h000 deliveries",visibility:!1,type:"GeoJSON",parameters:{source:"wmts",data:"aspect",url:"http://infovis.cs.ucdavis.edu/mapProxy/wmts/aspect/webmercator"},id:1,description:"",animated:!0},{icon:"road-sign",name:"Difference in deliveries (bl_h000 - baseline)",visibility:!1,type:"GeoJSON",id:2,description:"",animated:!0},{icon:"perimeter",name:"Baseline GW deliveries",visibility:!1,type:"GeoJSon",parameters:{source:"wmts",data:"fbfm40",url:"http://infovis.cs.ucdavis.edu/mapProxy/wmts/fbfm40/webmercator"},id:0,description:"",animated:!0}],Rd="http://infovis.cs.ucdavis.edu/wildfire/api/firedash/",bm=(t,e)=>t in Rs().data&&Rs().data[t][e]!=null,va={headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json"}};let ube=class{constructor(e,n){this.fireID=e,this.layerList=JSON.parse(JSON.stringify(lbe)),this.frp=Ao({isFetched:!1}),this.det=Ao({isFetched:!1}),this.roads=Ao({isFetched:!1}),this.perimeter=Ao({isFetched:!1}),this.humidity=Ao({isFetched:!1}),this.temperature=Ao({isFetched:!1}),this.wind=Ao({isFetched:!1}),this.population=Ao({isFetched:!1}),this.annotations=n;const i=this;if(bm(e,"perimeter")?i.perimeter.isFetched=!0:Promise.all([this.fetchPerimetersList()]).then(function(r){let o=[];return r[0].data.forEach(l=>{o.push(ps.post(Rd+"wildfires/perimeter",{state:"CA",exact_date:l.date,fire_id:e},va))}),Promise.all(o)}).then(function(r){let o=[];r.forEach(l=>{o.push({perimeter:l.data.perimeter.coordinates[0][0],perimeter_date:l.data.date,centroid:l.data.centroid.coordinates})}),Rs().updateData(e,o,"perimeter","fire"),i.perimeter.isFetched=!0,console.log("Exiting fetch perimeters")}),bm(e,"frp"))i.frp.isFetched=!0;else{let r=Ea().getWildfireByID(e);this.fetchFRP(r.acres,JSON.parse(r.centroid),r.start_date,r.end_date).then(function(o){let l=[];o.data.forEach(s=>{l.push({centroid:s.centroid.coordinates,confidence:s.confidence,date:s.date,footprint:s.footprint.coordinates,power:s.power,processed_confidence:s.processed_confidence})}),Rs().updateData(e,l,"frp","fire"),i.frp.isFetched=!0,console.log("Exiting fetch FRP")})}bm(e,"roads")?i.roads.isFetched=!0:this.fetchRoads().then(function(r){let o=r.data.map(l=>l.road);Rs().updateData(e,o,"roads","fire"),i.roads.isFetched=!0,console.log("Exiting fetch Roads")})}getDataFromStore(e){return Rs().data[this.fireID][e]}fetchPerimetersList(){const e=Rd+"wildfires/perimeters/list",n={state:"CA",fire_id:this.fireID};return ps.post(e,n,va)}fetchFRP(e,n,i,r){const o=Rd+"fire/radiative_power",l={distance:Math.sqrt(e*4046.86),origin_centroid:n,start_date:i,end_date:r};return ps.post(o,l,va)}fetchDetections(){const e=Rd+"fire/detection",n={distance:32244.5166854,origin_centroid:{type:"Point",coordinates:[-120.065187687,37.841171175]},start_date:"2013-08-19 10:43:00",end_date:"2013-09-26 09:58:00"};return ps.post(e,n,va)}fetchPopulationBlocks(){const e=Rd+"blocks",n={fire_id:this.fireID};return ps.post(e,n,va)}fetchRoads(){const e=Rd+"roads",n={fire_id:this.fireID};return ps.post(e,n,va)}fetchWind(e,n){const i=Rd+"weather/grid",r={fire_id:this.fireID,start_date:e,end_date:n};return ps.post(i,r,va)}};class hbe{constructor(e,n,i){this._metaData=e,this._viewState=n,this._data=i}}class dbe{constructor(e){this.layerList=JSON.parse(JSON.stringify(cbe)),this.annotations=e,this.currentTime=void 0,this.unmetdemand=Ao({isFetched:!1}),this.groundwater=Ao({isFetched:!1}),this.shapes=Ao({isFetched:!1});const n=this;bm("water","unmetdemand")?n.unmetdemand.isFetched=!0:Promise.all(this.fetchUnmetdemand()).then(function(i){let r={baseline:i[0].data,scenario:i[1].data};Rs().updateData("water",r,"unmetdemand","water"),n.unmetdemand.isFetched=!0}),bm("water","groundwater")?n.groundwater.isFetched=!0:Promise.all(this.fetchGroundwater()).then(function(i){let r={baseline:i[0].data,scenario:i[1].data};Rs().updateData("water",r,"groundwater","water"),n.groundwater.isFetched=!0}),bm("water","shapes")?n.shapes.isFetched=!0:Promise.all([this.fetchDemandUnitShapes(),this.fetchGroundwaterShapes()]).then(function(i){i[0].data.features=i[0].data.features.filter(o=>o.properties.DU_ID!=null);let r={demand_units:i[0].data,groundwater:i[1].data};Rs().updateData("water",r,"shapes","water"),n.shapes.isFetched=!0})}fetchUnmetdemand(){const e="http://infovis.cs.ucdavis.edu/geospatial/api/data/baseline_unmetdemand",n="http://infovis.cs.ucdavis.edu/geospatial/api/data/bl_h000_unmetdemand";return[ps.get(e,va),ps.get(n,va)]}fetchGroundwater(){const e="http://infovis.cs.ucdavis.edu/geospatial/api/data/baseline_groundwater",n="http://infovis.cs.ucdavis.edu/geospatial/api/data/bl_h000_groundwater";return[ps.get(e,va),ps.get(n,va)]}fetchDemandUnitShapes(){const e="http://infovis.cs.ucdavis.edu/geospatial/api/shapes/demand_units";return ps.get(e,va)}fetchGroundwaterShapes(){const e="http://infovis.cs.ucdavis.edu/geospatial/api/shapes/groundwater";return ps.get(e,va)}}class fbe{constructor(e,n,i){this._metaData=e,this._viewState=n,this._data=i}}const pbe=t=>(lu("data-v-8979caa5"),t=t(),cu(),t),mbe={id:"singleWater-container",class:"h-full flex flex-col"},gbe={id:"singleWater-label",class:"label-container"},ybe=pbe(()=>Qe("p",{class:"labelStyle"}," Water ",-1)),vbe={id:"singleWater-content",class:"flex-grow"},_be="Single Water",bbe=pr({__name:"SingleWater",props:{mapType:{},mapID:{},annotations:{},SM:{type:Boolean}},setup(t){const e=t,n=Xa(),[i,r]=n.getMapStateComponents(e.mapID,e.mapType);let o=new dbe(e.annotations);n.addDeckMapState(new fbe(i,r,o));const l=Ao({mapType:e.mapType,mapID:e.mapID,templateID:"",fireID:"",annotations:e.annotations,SM:e.SM});Os(mu,l);const s=ur(()=>n.isDataReady(e.mapID,e.mapType,"unmetdemand")&&n.isDataReady(e.mapID,e.mapType,"groundwater")&&n.isDataReady(e.mapID,e.mapType,"shapes"));return bf(()=>{n.deactivateMapState(e.mapType,e.mapID)}),(d,p)=>(le(),Ue("div",mbe,[Qe("div",gbe,[ybe,Lt(m_,{direction:"topRight",description:_be})]),Qe("div",vbe,[s.value?(le(),Rt(eV,{key:0})):(le(),Rt(tV,{key:1}))])]))}});const FP=po(bbe,[["__scopeId","data-v-8979caa5"]]);var xbe=`
@layer primevue {
    .p-tabmenu {
        overflow-x: auto;
    }

    .p-tabmenu-nav {
        display: flex;
        margin: 0;
        padding: 0;
        list-style-type: none;
        flex-wrap: nowrap;
    }

    .p-tabmenu-nav a {
        cursor: pointer;
        user-select: none;
        display: flex;
        align-items: center;
        position: relative;
        text-decoration: none;
        text-decoration: none;
        overflow: hidden;
    }

    .p-tabmenu-nav a:focus {
        z-index: 1;
    }

    .p-tabmenu-nav .p-menuitem-text {
        line-height: 1;
    }

    .p-tabmenu-ink-bar {
        display: none;
        z-index: 1;
    }

    .p-tabmenu::-webkit-scrollbar {
        display: none;
    }
}
`,wbe={root:"p-tabmenu p-component",menu:"p-tabmenu-nav p-reset",menuitem:function(e){var n=e.instance,i=e.props,r=e.index,o=e.item,l=e.isActive,s=e.isExactActive;return["p-tabmenuitem",{"p-highlight":(i.exact?s:l)||n.d_activeIndex===r,"p-disabled":n.disabled(o)}]},action:"p-menuitem-link",icon:"p-menuitem-icon",label:"p-menuitem-text",inkbar:"p-tabmenu-ink-bar"},Ebe=_o.extend({name:"tabmenu",css:xbe,classes:wbe}),Tbe={name:"BaseTabMenu",extends:Ni,props:{model:{type:Array,default:null},exact:{type:Boolean,default:!0},activeIndex:{type:Number,default:0},"aria-labelledby":{type:String,default:null},"aria-label":{type:String,default:null}},style:Ebe,provide:function(){return{$parentInstance:this}}},P3={name:"TabMenu",extends:Tbe,emits:["update:activeIndex","tab-change"],timeout:null,data:function(){return{d_activeIndex:this.activeIndex}},watch:{$route:function(){var e=this;this.timeout=setTimeout(function(){return e.updateInkBar()},50)},activeIndex:function(e){this.d_activeIndex=e}},beforeMount:function(){this.$slots.item||console.warn("In future versions, vue-router support will be removed. Item templating should be used.")},mounted:function(){this.updateInkBar();var e=this.findActiveItem();e&&(e.tabIndex="0")},updated:function(){this.updateInkBar()},beforeUnmount:function(){clearTimeout(this.timeout)},methods:{getPTOptions:function(e,n,i){return this.ptm(e,{context:{item:n,index:i}})},onItemClick:function(e,n,i,r){if(this.disabled(n)){e.preventDefault();return}n.command&&n.command({originalEvent:e,item:n}),n.to&&r&&r(e),i!==this.d_activeIndex&&(this.d_activeIndex=i,this.$emit("update:activeIndex",this.d_activeIndex)),this.$emit("tab-change",{originalEvent:e,index:i})},onKeydownItem:function(e,n,i,r){switch(e.code){case"ArrowRight":{this.navigateToNextItem(e.target),e.preventDefault();break}case"ArrowLeft":{this.navigateToPrevItem(e.target),e.preventDefault();break}case"Home":{this.navigateToFirstItem(e.target),e.preventDefault();break}case"End":{this.navigateToLastItem(e.target),e.preventDefault();break}case"Space":case"Enter":{this.onItemClick(e,n,i,r),e.preventDefault();break}case"Tab":{this.onTabKey();break}}},navigateToNextItem:function(e){var n=this.findNextItem(e);n&&this.setFocusToMenuitem(e,n)},navigateToPrevItem:function(e){var n=this.findPrevItem(e);n&&this.setFocusToMenuitem(e,n)},navigateToFirstItem:function(e){var n=this.findFirstItem(e);n&&this.setFocusToMenuitem(e,n)},navigateToLastItem:function(e){var n=this.findLastItem(e);n&&this.setFocusToMenuitem(e,n)},findNextItem:function(e){var n=e.parentElement.nextElementSibling;return n?He.getAttribute(n,"data-p-disabled")===!0?this.findNextItem(n.children[0]):n.children[0]:null},findPrevItem:function(e){var n=e.parentElement.previousElementSibling;return n?He.getAttribute(n,"data-p-disabled")===!0?this.findPrevItem(n.children[0]):n.children[0]:null},findFirstItem:function(){var e=He.findSingle(this.$refs.nav,'[data-pc-section="menuitem"][data-p-disabled="false"]');return e?e.children[0]:null},findLastItem:function(){var e=He.find(this.$refs.nav,'[data-pc-section="menuitem"][data-p-disabled="false"]');return e?e[e.length-1].children[0]:null},findActiveItem:function(){var e=He.findSingle(this.$refs.nav,'[data-pc-section="menuitem"][data-p-disabled="false"][data-p-highlight="true"]');return e?e.children[0]:null},setFocusToMenuitem:function(e,n){e.tabIndex="-1",n.tabIndex="0",n.focus()},onTabKey:function(){var e=He.findSingle(this.$refs.nav,'[data-pc-section="menuitem"][data-p-disabled="false"][data-p-highlight="true"]'),n=He.findSingle(this.$refs.nav,'[data-pc-section="action"][tabindex="0"]');n!==e.children[0]&&(e&&(e.children[0].tabIndex="0"),n.tabIndex="-1")},visible:function(e){return typeof e.visible=="function"?e.visible():e.visible!==!1},disabled:function(e){return typeof e.disabled=="function"?e.disabled():e.disabled===!0},label:function(e){return typeof e.label=="function"?e.label():e.label},updateInkBar:function(){for(var e=this.$refs.nav.children,n=!1,i=0;i<e.length;i++){var r=e[i];He.getAttribute(r,"data-p-highlight")&&(this.$refs.inkbar.style.width=He.getWidth(r)+"px",this.$refs.inkbar.style.left=He.getOffset(r).left-He.getOffset(this.$refs.nav).left+"px",n=!0)}n||(this.$refs.inkbar.style.width="0px",this.$refs.inkbar.style.left="0px")},getMenuItemProps:function(e,n){var i=this;return{action:Le({class:this.cx("action"),tabindex:-1,onClick:function(o){return i.onItemClick(o,e,n)},onKeyDown:function(o){return i.onKeydownItem(o,e,n)}},this.getPTOptions("action",e,n)),icon:Le({class:[this.cx("icon"),e.icon]},this.getPTOptions("icon",e,n)),label:Le({class:this.cx("label")},this.getPTOptions("label",e,n))}}},directives:{ripple:Rl}},Sbe=["aria-labelledby","aria-label"],Cbe=["data-p-highlight","data-p-disabled"],Abe=["href","aria-label","aria-disabled","onClick","onKeydown"],Pbe=["onClick","onKeydown","data-p-highlight","data-p-disabled"],Ibe=["href","target","aria-label","aria-disabled"];function Mbe(t,e,n,i,r,o){var l=Gn("router-link"),s=ea("ripple");return le(),Ue("div",Le({class:t.cx("root")},t.ptm("root"),{"data-pc-name":"tabmenu"}),[Qe("ul",Le({ref:"nav",class:t.cx("menu"),role:"menubar","aria-labelledby":t.ariaLabelledby,"aria-label":t.ariaLabel},t.ptm("menu")),[(le(!0),Ue(_n,null,or(t.model,function(d,p){return le(),Ue(_n,{key:o.label(d)+"_"+p.toString()},[d.to&&!o.disabled(d)?(le(),Rt(l,{key:0,to:d.to,custom:""},{default:Cn(function(y){var v=y.navigate,w=y.href,T=y.isActive,I=y.isExactActive;return[o.visible(d)?(le(),Ue("li",Le({key:0,ref_for:!0,ref:"tab",class:[t.cx("menuitem",{item:d,isActive:T,isExactActive:I}),d.class],style:d.style,role:"presentation"},o.getPTOptions("menuitem",d,p),{"data-p-highlight":t.exact?I:T,"data-p-disabled":o.disabled(d)}),[t.$slots.item?(le(),Rt(Zn(t.$slots.item),{key:1,item:d,index:p},null,8,["item","index"])):fo((le(),Ue("a",Le({key:0,ref_for:!0,ref:"tabLink",role:"menuitem",href:w,class:t.cx("action"),"aria-label":o.label(d),"aria-disabled":o.disabled(d),tabindex:-1,onClick:function(k){return o.onItemClick(k,d,p,v)},onKeydown:function(k){return o.onKeydownItem(k,d,p,v)}},o.getPTOptions("action",d,p)),[t.$slots.itemicon?(le(),Rt(Zn(t.$slots.itemicon),{key:0,item:d,class:ri([t.cx("icon"),d.icon])},null,8,["item","class"])):d.icon?(le(),Ue("span",Le({key:1,class:[t.cx("icon"),d.icon]},o.getPTOptions("icon",d,p)),null,16)):Jt("",!0),Qe("span",Le({class:t.cx("label")},o.getPTOptions("label",d,p)),ki(o.label(d)),17)],16,Abe)),[[s]])],16,Cbe)):Jt("",!0)]}),_:2},1032,["to"])):o.visible(d)?(le(),Ue("li",Le({key:1,ref_for:!0,ref:"tab",class:[t.cx("menuitem",{item:d,index:p}),d.class],role:"presentation",onClick:function(v){return o.onItemClick(v,d,p)},onKeydown:function(v){return o.onKeydownItem(v,d,p)}},o.getPTOptions("menuitem",d,p),{"data-p-highlight":r.d_activeIndex===p,"data-p-disabled":o.disabled(d)}),[t.$slots.item?(le(),Rt(Zn(t.$slots.item),{key:1,item:d,index:p,label:o.label(d),props:o.getMenuItemProps(d,p)},null,8,["item","index","label","props"])):fo((le(),Ue("a",Le({key:0,ref_for:!0,ref:"tabLink",role:"menuitem",href:d.url,class:t.cx("action"),target:d.target,"aria-label":o.label(d),"aria-disabled":o.disabled(d),tabindex:-1},o.getPTOptions("action",d,p)),[t.$slots.itemicon?(le(),Rt(Zn(t.$slots.itemicon),{key:0,item:d,class:ri([t.cx("icon"),d.icon])},null,8,["item","class"])):d.icon?(le(),Ue("span",Le({key:1,class:[t.cx("icon"),d.icon]},o.getPTOptions("icon",d,p)),null,16)):Jt("",!0),Qe("span",Le({class:t.cx("label")},o.getPTOptions("label",d,p)),ki(o.label(d)),17)],16,Ibe)),[[s]])],16,Pbe)):Jt("",!0)],64)}),128)),Qe("li",Le({ref:"inkbar",role:"none",class:t.cx("inkbar")},t.ptm("inkbar")),null,16)],16,Sbe)],16)}P3.render=Mbe;var nV={exports:{}};const Rbe=Uz(FX);/**!
 * Sortable 1.14.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function oF(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function fc(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?oF(Object(n),!0).forEach(function(i){Lbe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):oF(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Fx(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Fx=function(e){return typeof e}:Fx=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fx(t)}function Lbe(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wa(){return Wa=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Wa.apply(this,arguments)}function Obe(t,e){if(t==null)return{};var n={},i=Object.keys(t),r,o;for(o=0;o<i.length;o++)r=i[o],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}function Dbe(t,e){if(t==null)return{};var n=Obe(t,e),i,r;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)i=o[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function kbe(t){return Fbe(t)||Bbe(t)||zbe(t)||Nbe()}function Fbe(t){if(Array.isArray(t))return BP(t)}function Bbe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function zbe(t,e){if(t){if(typeof t=="string")return BP(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return BP(t,e)}}function BP(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Nbe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Ube="1.14.0";function Yc(t){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(t)}var gu=Yc(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),L_=Yc(/Edge/i),sF=Yc(/firefox/i),z0=Yc(/safari/i)&&!Yc(/chrome/i)&&!Yc(/android/i),iV=Yc(/iP(ad|od|hone)/i),Vbe=Yc(/chrome/i)&&Yc(/android/i),rV={capture:!1,passive:!1};function Bi(t,e,n){t.addEventListener(e,n,!gu&&rV)}function Mi(t,e,n){t.removeEventListener(e,n,!gu&&rV)}function Bw(t,e){if(e){if(e[0]===">"&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch{return!1}return!1}}function jbe(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function ml(t,e,n,i){if(t){n=n||document;do{if(e!=null&&(e[0]===">"?t.parentNode===n&&Bw(t,e):Bw(t,e))||i&&t===n)return t;if(t===n)break}while(t=jbe(t))}return null}var aF=/\s+/g;function no(t,e,n){if(t&&e)if(t.classList)t.classList[n?"add":"remove"](e);else{var i=(" "+t.className+" ").replace(aF," ").replace(" "+e+" "," ");t.className=(i+(n?" "+e:"")).replace(aF," ")}}function Un(t,e,n){var i=t&&t.style;if(i){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),e===void 0?n:n[e];!(e in i)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),i[e]=n+(typeof n=="string"?"":"px")}}function ef(t,e){var n="";if(typeof t=="string")n=t;else do{var i=Un(t,"transform");i&&i!=="none"&&(n=i+" "+n)}while(!e&&(t=t.parentNode));var r=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return r&&new r(n)}function oV(t,e,n){if(t){var i=t.getElementsByTagName(e),r=0,o=i.length;if(n)for(;r<o;r++)n(i[r],r);return i}return[]}function lc(){var t=document.scrollingElement;return t||document.documentElement}function jr(t,e,n,i,r){if(!(!t.getBoundingClientRect&&t!==window)){var o,l,s,d,p,y,v;if(t!==window&&t.parentNode&&t!==lc()?(o=t.getBoundingClientRect(),l=o.top,s=o.left,d=o.bottom,p=o.right,y=o.height,v=o.width):(l=0,s=0,d=window.innerHeight,p=window.innerWidth,y=window.innerHeight,v=window.innerWidth),(e||n)&&t!==window&&(r=r||t.parentNode,!gu))do if(r&&r.getBoundingClientRect&&(Un(r,"transform")!=="none"||n&&Un(r,"position")!=="static")){var w=r.getBoundingClientRect();l-=w.top+parseInt(Un(r,"border-top-width")),s-=w.left+parseInt(Un(r,"border-left-width")),d=l+o.height,p=s+o.width;break}while(r=r.parentNode);if(i&&t!==window){var T=ef(r||t),I=T&&T.a,L=T&&T.d;T&&(l/=L,s/=I,v/=I,y/=L,d=l+y,p=s+v)}return{top:l,left:s,bottom:d,right:p,width:v,height:y}}}function lF(t,e,n){for(var i=bh(t,!0),r=jr(t)[e];i;){var o=jr(i)[n],l=void 0;if(n==="top"||n==="left"?l=r>=o:l=r<=o,!l)return i;if(i===lc())break;i=bh(i,!1)}return!1}function Wm(t,e,n,i){for(var r=0,o=0,l=t.children;o<l.length;){if(l[o].style.display!=="none"&&l[o]!==fi.ghost&&(i||l[o]!==fi.dragged)&&ml(l[o],n.draggable,t,!1)){if(r===e)return l[o];r++}o++}return null}function I3(t,e){for(var n=t.lastElementChild;n&&(n===fi.ghost||Un(n,"display")==="none"||e&&!Bw(n,e));)n=n.previousElementSibling;return n||null}function uo(t,e){var n=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)t.nodeName.toUpperCase()!=="TEMPLATE"&&t!==fi.clone&&(!e||Bw(t,e))&&n++;return n}function cF(t){var e=0,n=0,i=lc();if(t)do{var r=ef(t),o=r.a,l=r.d;e+=t.scrollLeft*o,n+=t.scrollTop*l}while(t!==i&&(t=t.parentNode));return[e,n]}function $be(t,e){for(var n in t)if(t.hasOwnProperty(n)){for(var i in e)if(e.hasOwnProperty(i)&&e[i]===t[n][i])return Number(n)}return-1}function bh(t,e){if(!t||!t.getBoundingClientRect)return lc();var n=t,i=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var r=Un(n);if(n.clientWidth<n.scrollWidth&&(r.overflowX=="auto"||r.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(r.overflowY=="auto"||r.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return lc();if(i||e)return n;i=!0}}while(n=n.parentNode);return lc()}function Gbe(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function bC(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}var N0;function sV(t,e){return function(){if(!N0){var n=arguments,i=this;n.length===1?t.call(i,n[0]):t.apply(i,n),N0=setTimeout(function(){N0=void 0},e)}}}function Hbe(){clearTimeout(N0),N0=void 0}function aV(t,e,n){t.scrollLeft+=e,t.scrollTop+=n}function M3(t){var e=window.Polymer,n=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):n?n(t).clone(!0)[0]:t.cloneNode(!0)}function uF(t,e){Un(t,"position","absolute"),Un(t,"top",e.top),Un(t,"left",e.left),Un(t,"width",e.width),Un(t,"height",e.height)}function xC(t){Un(t,"position",""),Un(t,"top",""),Un(t,"left",""),Un(t,"width",""),Un(t,"height","")}var bs="Sortable"+new Date().getTime();function Wbe(){var t=[],e;return{captureAnimationState:function(){if(t=[],!!this.options.animation){var i=[].slice.call(this.el.children);i.forEach(function(r){if(!(Un(r,"display")==="none"||r===fi.ghost)){t.push({target:r,rect:jr(r)});var o=fc({},t[t.length-1].rect);if(r.thisAnimationDuration){var l=ef(r,!0);l&&(o.top-=l.f,o.left-=l.e)}r.fromRect=o}})}},addAnimationState:function(i){t.push(i)},removeAnimationState:function(i){t.splice($be(t,{target:i}),1)},animateAll:function(i){var r=this;if(!this.options.animation){clearTimeout(e),typeof i=="function"&&i();return}var o=!1,l=0;t.forEach(function(s){var d=0,p=s.target,y=p.fromRect,v=jr(p),w=p.prevFromRect,T=p.prevToRect,I=s.rect,L=ef(p,!0);L&&(v.top-=L.f,v.left-=L.e),p.toRect=v,p.thisAnimationDuration&&bC(w,v)&&!bC(y,v)&&(I.top-v.top)/(I.left-v.left)===(y.top-v.top)/(y.left-v.left)&&(d=Xbe(I,w,T,r.options)),bC(v,y)||(p.prevFromRect=y,p.prevToRect=v,d||(d=r.options.animation),r.animate(p,I,v,d)),d&&(o=!0,l=Math.max(l,d),clearTimeout(p.animationResetTimer),p.animationResetTimer=setTimeout(function(){p.animationTime=0,p.prevFromRect=null,p.fromRect=null,p.prevToRect=null,p.thisAnimationDuration=null},d),p.thisAnimationDuration=d)}),clearTimeout(e),o?e=setTimeout(function(){typeof i=="function"&&i()},l):typeof i=="function"&&i(),t=[]},animate:function(i,r,o,l){if(l){Un(i,"transition",""),Un(i,"transform","");var s=ef(this.el),d=s&&s.a,p=s&&s.d,y=(r.left-o.left)/(d||1),v=(r.top-o.top)/(p||1);i.animatingX=!!y,i.animatingY=!!v,Un(i,"transform","translate3d("+y+"px,"+v+"px,0)"),this.forRepaintDummy=Kbe(i),Un(i,"transition","transform "+l+"ms"+(this.options.easing?" "+this.options.easing:"")),Un(i,"transform","translate3d(0,0,0)"),typeof i.animated=="number"&&clearTimeout(i.animated),i.animated=setTimeout(function(){Un(i,"transition",""),Un(i,"transform",""),i.animated=!1,i.animatingX=!1,i.animatingY=!1},l)}}}}function Kbe(t){return t.offsetWidth}function Xbe(t,e,n,i){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))*i.animation}var Fp=[],wC={initializeByDefault:!0},O_={mount:function(e){for(var n in wC)wC.hasOwnProperty(n)&&!(n in e)&&(e[n]=wC[n]);Fp.forEach(function(i){if(i.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),Fp.push(e)},pluginEvent:function(e,n,i){var r=this;this.eventCanceled=!1,i.cancel=function(){r.eventCanceled=!0};var o=e+"Global";Fp.forEach(function(l){n[l.pluginName]&&(n[l.pluginName][o]&&n[l.pluginName][o](fc({sortable:n},i)),n.options[l.pluginName]&&n[l.pluginName][e]&&n[l.pluginName][e](fc({sortable:n},i)))})},initializePlugins:function(e,n,i,r){Fp.forEach(function(s){var d=s.pluginName;if(!(!e.options[d]&&!s.initializeByDefault)){var p=new s(e,n,e.options);p.sortable=e,p.options=e.options,e[d]=p,Wa(i,p.defaults)}});for(var o in e.options)if(e.options.hasOwnProperty(o)){var l=this.modifyOption(e,o,e.options[o]);typeof l<"u"&&(e.options[o]=l)}},getEventProperties:function(e,n){var i={};return Fp.forEach(function(r){typeof r.eventProperties=="function"&&Wa(i,r.eventProperties.call(n[r.pluginName],e))}),i},modifyOption:function(e,n,i){var r;return Fp.forEach(function(o){e[o.pluginName]&&o.optionListeners&&typeof o.optionListeners[n]=="function"&&(r=o.optionListeners[n].call(e[o.pluginName],i))}),r}};function c0(t){var e=t.sortable,n=t.rootEl,i=t.name,r=t.targetEl,o=t.cloneEl,l=t.toEl,s=t.fromEl,d=t.oldIndex,p=t.newIndex,y=t.oldDraggableIndex,v=t.newDraggableIndex,w=t.originalEvent,T=t.putSortable,I=t.extraEventProperties;if(e=e||n&&n[bs],!!e){var L,k=e.options,F="on"+i.charAt(0).toUpperCase()+i.substr(1);window.CustomEvent&&!gu&&!L_?L=new CustomEvent(i,{bubbles:!0,cancelable:!0}):(L=document.createEvent("Event"),L.initEvent(i,!0,!0)),L.to=l||n,L.from=s||n,L.item=r||n,L.clone=o,L.oldIndex=d,L.newIndex=p,L.oldDraggableIndex=y,L.newDraggableIndex=v,L.originalEvent=w,L.pullMode=T?T.lastPutMode:void 0;var B=fc(fc({},I),O_.getEventProperties(i,e));for(var G in B)L[G]=B[G];n&&n.dispatchEvent(L),k[F]&&k[F].call(e,L)}}var Zbe=["evt"],Gs=function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=i.evt,o=Dbe(i,Zbe);O_.pluginEvent.bind(fi)(e,n,fc({dragEl:fn,parentEl:lo,ghostEl:wi,rootEl:Ur,nextEl:zd,lastDownEl:Bx,cloneEl:co,cloneHidden:gh,dragStarted:u0,putSortable:Qo,activeSortable:fi.active,originalEvent:r,oldIndex:em,oldDraggableIndex:U0,newIndex:ma,newDraggableIndex:mh,hideGhostForTarget:hV,unhideGhostForTarget:dV,cloneNowHidden:function(){gh=!0},cloneNowShown:function(){gh=!1},dispatchSortableEvent:function(s){Ps({sortable:n,name:s,originalEvent:r})}},o))};function Ps(t){c0(fc({putSortable:Qo,cloneEl:co,targetEl:fn,rootEl:Ur,oldIndex:em,oldDraggableIndex:U0,newIndex:ma,newDraggableIndex:mh},t))}var fn,lo,wi,Ur,zd,Bx,co,gh,em,ma,U0,mh,Wb,Qo,Hp=!1,zw=!1,Nw=[],Ld,fl,EC,TC,hF,dF,u0,Bp,V0,j0=!1,Kb=!1,zx,hs,SC=[],zP=!1,Uw=[],K2=typeof document<"u",Xb=iV,fF=L_||gu?"cssFloat":"float",qbe=K2&&!Vbe&&!iV&&"draggable"in document.createElement("div"),lV=function(){if(K2){if(gu)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto",t.style.pointerEvents==="auto"}}(),cV=function(e,n){var i=Un(e),r=parseInt(i.width)-parseInt(i.paddingLeft)-parseInt(i.paddingRight)-parseInt(i.borderLeftWidth)-parseInt(i.borderRightWidth),o=Wm(e,0,n),l=Wm(e,1,n),s=o&&Un(o),d=l&&Un(l),p=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+jr(o).width,y=d&&parseInt(d.marginLeft)+parseInt(d.marginRight)+jr(l).width;if(i.display==="flex")return i.flexDirection==="column"||i.flexDirection==="column-reverse"?"vertical":"horizontal";if(i.display==="grid")return i.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(o&&s.float&&s.float!=="none"){var v=s.float==="left"?"left":"right";return l&&(d.clear==="both"||d.clear===v)?"vertical":"horizontal"}return o&&(s.display==="block"||s.display==="flex"||s.display==="table"||s.display==="grid"||p>=r&&i[fF]==="none"||l&&i[fF]==="none"&&p+y>r)?"vertical":"horizontal"},Ybe=function(e,n,i){var r=i?e.left:e.top,o=i?e.right:e.bottom,l=i?e.width:e.height,s=i?n.left:n.top,d=i?n.right:n.bottom,p=i?n.width:n.height;return r===s||o===d||r+l/2===s+p/2},Jbe=function(e,n){var i;return Nw.some(function(r){var o=r[bs].options.emptyInsertThreshold;if(!(!o||I3(r))){var l=jr(r),s=e>=l.left-o&&e<=l.right+o,d=n>=l.top-o&&n<=l.bottom+o;if(s&&d)return i=r}}),i},uV=function(e){function n(o,l){return function(s,d,p,y){var v=s.options.group.name&&d.options.group.name&&s.options.group.name===d.options.group.name;if(o==null&&(l||v))return!0;if(o==null||o===!1)return!1;if(l&&o==="clone")return o;if(typeof o=="function")return n(o(s,d,p,y),l)(s,d,p,y);var w=(l?s:d).options.group.name;return o===!0||typeof o=="string"&&o===w||o.join&&o.indexOf(w)>-1}}var i={},r=e.group;(!r||Fx(r)!="object")&&(r={name:r}),i.name=r.name,i.checkPull=n(r.pull,!0),i.checkPut=n(r.put),i.revertClone=r.revertClone,e.group=i},hV=function(){!lV&&wi&&Un(wi,"display","none")},dV=function(){!lV&&wi&&Un(wi,"display","")};K2&&document.addEventListener("click",function(t){if(zw)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),zw=!1,!1},!0);var Od=function(e){if(fn){e=e.touches?e.touches[0]:e;var n=Jbe(e.clientX,e.clientY);if(n){var i={};for(var r in e)e.hasOwnProperty(r)&&(i[r]=e[r]);i.target=i.rootEl=n,i.preventDefault=void 0,i.stopPropagation=void 0,n[bs]._onDragOver(i)}}},Qbe=function(e){fn&&fn.parentNode[bs]._isOutsideThisEl(e.target)};function fi(t,e){if(!(t&&t.nodeType&&t.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=Wa({},e),t[bs]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return cV(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(l,s){l.setData("Text",s.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:fi.supportPointer!==!1&&"PointerEvent"in window&&!z0,emptyInsertThreshold:5};O_.initializePlugins(this,t,n);for(var i in n)!(i in e)&&(e[i]=n[i]);uV(e);for(var r in this)r.charAt(0)==="_"&&typeof this[r]=="function"&&(this[r]=this[r].bind(this));this.nativeDraggable=e.forceFallback?!1:qbe,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?Bi(t,"pointerdown",this._onTapStart):(Bi(t,"mousedown",this._onTapStart),Bi(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(Bi(t,"dragover",this),Bi(t,"dragenter",this)),Nw.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),Wa(this,Wbe())}fi.prototype={constructor:fi,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(Bp=null)},_getDirection:function(e,n){return typeof this.options.direction=="function"?this.options.direction.call(this,e,n,fn):this.options.direction},_onTapStart:function(e){if(e.cancelable){var n=this,i=this.el,r=this.options,o=r.preventOnFilter,l=e.type,s=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,d=(s||e).target,p=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||d,y=r.filter;if(axe(i),!fn&&!(/mousedown|pointerdown/.test(l)&&e.button!==0||r.disabled)&&!p.isContentEditable&&!(!this.nativeDraggable&&z0&&d&&d.tagName.toUpperCase()==="SELECT")&&(d=ml(d,r.draggable,i,!1),!(d&&d.animated)&&Bx!==d)){if(em=uo(d),U0=uo(d,r.draggable),typeof y=="function"){if(y.call(this,e,d,this)){Ps({sortable:n,rootEl:p,name:"filter",targetEl:d,toEl:i,fromEl:i}),Gs("filter",n,{evt:e}),o&&e.cancelable&&e.preventDefault();return}}else if(y&&(y=y.split(",").some(function(v){if(v=ml(p,v.trim(),i,!1),v)return Ps({sortable:n,rootEl:v,name:"filter",targetEl:d,fromEl:i,toEl:i}),Gs("filter",n,{evt:e}),!0}),y)){o&&e.cancelable&&e.preventDefault();return}r.handle&&!ml(p,r.handle,i,!1)||this._prepareDragStart(e,s,d)}}},_prepareDragStart:function(e,n,i){var r=this,o=r.el,l=r.options,s=o.ownerDocument,d;if(i&&!fn&&i.parentNode===o){var p=jr(i);if(Ur=o,fn=i,lo=fn.parentNode,zd=fn.nextSibling,Bx=i,Wb=l.group,fi.dragged=fn,Ld={target:fn,clientX:(n||e).clientX,clientY:(n||e).clientY},hF=Ld.clientX-p.left,dF=Ld.clientY-p.top,this._lastX=(n||e).clientX,this._lastY=(n||e).clientY,fn.style["will-change"]="all",d=function(){if(Gs("delayEnded",r,{evt:e}),fi.eventCanceled){r._onDrop();return}r._disableDelayedDragEvents(),!sF&&r.nativeDraggable&&(fn.draggable=!0),r._triggerDragStart(e,n),Ps({sortable:r,name:"choose",originalEvent:e}),no(fn,l.chosenClass,!0)},l.ignore.split(",").forEach(function(y){oV(fn,y.trim(),CC)}),Bi(s,"dragover",Od),Bi(s,"mousemove",Od),Bi(s,"touchmove",Od),Bi(s,"mouseup",r._onDrop),Bi(s,"touchend",r._onDrop),Bi(s,"touchcancel",r._onDrop),sF&&this.nativeDraggable&&(this.options.touchStartThreshold=4,fn.draggable=!0),Gs("delayStart",this,{evt:e}),l.delay&&(!l.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(L_||gu))){if(fi.eventCanceled){this._onDrop();return}Bi(s,"mouseup",r._disableDelayedDrag),Bi(s,"touchend",r._disableDelayedDrag),Bi(s,"touchcancel",r._disableDelayedDrag),Bi(s,"mousemove",r._delayedDragTouchMoveHandler),Bi(s,"touchmove",r._delayedDragTouchMoveHandler),l.supportPointer&&Bi(s,"pointermove",r._delayedDragTouchMoveHandler),r._dragStartTimer=setTimeout(d,l.delay)}else d()}},_delayedDragTouchMoveHandler:function(e){var n=e.touches?e.touches[0]:e;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){fn&&CC(fn),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;Mi(e,"mouseup",this._disableDelayedDrag),Mi(e,"touchend",this._disableDelayedDrag),Mi(e,"touchcancel",this._disableDelayedDrag),Mi(e,"mousemove",this._delayedDragTouchMoveHandler),Mi(e,"touchmove",this._delayedDragTouchMoveHandler),Mi(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,n){n=n||e.pointerType=="touch"&&e,!this.nativeDraggable||n?this.options.supportPointer?Bi(document,"pointermove",this._onTouchMove):n?Bi(document,"touchmove",this._onTouchMove):Bi(document,"mousemove",this._onTouchMove):(Bi(fn,"dragend",this),Bi(Ur,"dragstart",this._onDragStart));try{document.selection?Nx(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,n){if(Hp=!1,Ur&&fn){Gs("dragStarted",this,{evt:n}),this.nativeDraggable&&Bi(document,"dragover",Qbe);var i=this.options;!e&&no(fn,i.dragClass,!1),no(fn,i.ghostClass,!0),fi.active=this,e&&this._appendGhost(),Ps({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(fl){this._lastX=fl.clientX,this._lastY=fl.clientY,hV();for(var e=document.elementFromPoint(fl.clientX,fl.clientY),n=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(fl.clientX,fl.clientY),e!==n);)n=e;if(fn.parentNode[bs]._isOutsideThisEl(e),n)do{if(n[bs]){var i=void 0;if(i=n[bs]._onDragOver({clientX:fl.clientX,clientY:fl.clientY,target:e,rootEl:n}),i&&!this.options.dragoverBubble)break}e=n}while(n=n.parentNode);dV()}},_onTouchMove:function(e){if(Ld){var n=this.options,i=n.fallbackTolerance,r=n.fallbackOffset,o=e.touches?e.touches[0]:e,l=wi&&ef(wi,!0),s=wi&&l&&l.a,d=wi&&l&&l.d,p=Xb&&hs&&cF(hs),y=(o.clientX-Ld.clientX+r.x)/(s||1)+(p?p[0]-SC[0]:0)/(s||1),v=(o.clientY-Ld.clientY+r.y)/(d||1)+(p?p[1]-SC[1]:0)/(d||1);if(!fi.active&&!Hp){if(i&&Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))<i)return;this._onDragStart(e,!0)}if(wi){l?(l.e+=y-(EC||0),l.f+=v-(TC||0)):l={a:1,b:0,c:0,d:1,e:y,f:v};var w="matrix(".concat(l.a,",").concat(l.b,",").concat(l.c,",").concat(l.d,",").concat(l.e,",").concat(l.f,")");Un(wi,"webkitTransform",w),Un(wi,"mozTransform",w),Un(wi,"msTransform",w),Un(wi,"transform",w),EC=y,TC=v,fl=o}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!wi){var e=this.options.fallbackOnBody?document.body:Ur,n=jr(fn,!0,Xb,!0,e),i=this.options;if(Xb){for(hs=e;Un(hs,"position")==="static"&&Un(hs,"transform")==="none"&&hs!==document;)hs=hs.parentNode;hs!==document.body&&hs!==document.documentElement?(hs===document&&(hs=lc()),n.top+=hs.scrollTop,n.left+=hs.scrollLeft):hs=lc(),SC=cF(hs)}wi=fn.cloneNode(!0),no(wi,i.ghostClass,!1),no(wi,i.fallbackClass,!0),no(wi,i.dragClass,!0),Un(wi,"transition",""),Un(wi,"transform",""),Un(wi,"box-sizing","border-box"),Un(wi,"margin",0),Un(wi,"top",n.top),Un(wi,"left",n.left),Un(wi,"width",n.width),Un(wi,"height",n.height),Un(wi,"opacity","0.8"),Un(wi,"position",Xb?"absolute":"fixed"),Un(wi,"zIndex","100000"),Un(wi,"pointerEvents","none"),fi.ghost=wi,e.appendChild(wi),Un(wi,"transform-origin",hF/parseInt(wi.style.width)*100+"% "+dF/parseInt(wi.style.height)*100+"%")}},_onDragStart:function(e,n){var i=this,r=e.dataTransfer,o=i.options;if(Gs("dragStart",this,{evt:e}),fi.eventCanceled){this._onDrop();return}Gs("setupClone",this),fi.eventCanceled||(co=M3(fn),co.draggable=!1,co.style["will-change"]="",this._hideClone(),no(co,this.options.chosenClass,!1),fi.clone=co),i.cloneId=Nx(function(){Gs("clone",i),!fi.eventCanceled&&(i.options.removeCloneOnHide||Ur.insertBefore(co,fn),i._hideClone(),Ps({sortable:i,name:"clone"}))}),!n&&no(fn,o.dragClass,!0),n?(zw=!0,i._loopId=setInterval(i._emulateDragOver,50)):(Mi(document,"mouseup",i._onDrop),Mi(document,"touchend",i._onDrop),Mi(document,"touchcancel",i._onDrop),r&&(r.effectAllowed="move",o.setData&&o.setData.call(i,r,fn)),Bi(document,"drop",i),Un(fn,"transform","translateZ(0)")),Hp=!0,i._dragStartId=Nx(i._dragStarted.bind(i,n,e)),Bi(document,"selectstart",i),u0=!0,z0&&Un(document.body,"user-select","none")},_onDragOver:function(e){var n=this.el,i=e.target,r,o,l,s=this.options,d=s.group,p=fi.active,y=Wb===d,v=s.sort,w=Qo||p,T,I=this,L=!1;if(zP)return;function k(bt,Qt){Gs(bt,I,fc({evt:e,isOwner:y,axis:T?"vertical":"horizontal",revert:l,dragRect:r,targetRect:o,canSort:v,fromSortable:w,target:i,completed:B,onMove:function(pn,xn){return Zb(Ur,n,fn,r,pn,jr(pn),e,xn)},changed:G},Qt))}function F(){k("dragOverAnimationCapture"),I.captureAnimationState(),I!==w&&w.captureAnimationState()}function B(bt){return k("dragOverCompleted",{insertion:bt}),bt&&(y?p._hideClone():p._showClone(I),I!==w&&(no(fn,Qo?Qo.options.ghostClass:p.options.ghostClass,!1),no(fn,s.ghostClass,!0)),Qo!==I&&I!==fi.active?Qo=I:I===fi.active&&Qo&&(Qo=null),w===I&&(I._ignoreWhileAnimating=i),I.animateAll(function(){k("dragOverAnimationComplete"),I._ignoreWhileAnimating=null}),I!==w&&(w.animateAll(),w._ignoreWhileAnimating=null)),(i===fn&&!fn.animated||i===n&&!i.animated)&&(Bp=null),!s.dragoverBubble&&!e.rootEl&&i!==document&&(fn.parentNode[bs]._isOutsideThisEl(e.target),!bt&&Od(e)),!s.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),L=!0}function G(){ma=uo(fn),mh=uo(fn,s.draggable),Ps({sortable:I,name:"change",toEl:n,newIndex:ma,newDraggableIndex:mh,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),i=ml(i,s.draggable,n,!0),k("dragOver"),fi.eventCanceled)return L;if(fn.contains(e.target)||i.animated&&i.animatingX&&i.animatingY||I._ignoreWhileAnimating===i)return B(!1);if(zw=!1,p&&!s.disabled&&(y?v||(l=lo!==Ur):Qo===this||(this.lastPutMode=Wb.checkPull(this,p,fn,e))&&d.checkPut(this,p,fn,e))){if(T=this._getDirection(e,i)==="vertical",r=jr(fn),k("dragOverValid"),fi.eventCanceled)return L;if(l)return lo=Ur,F(),this._hideClone(),k("revert"),fi.eventCanceled||(zd?Ur.insertBefore(fn,zd):Ur.appendChild(fn)),B(!0);var U=I3(n,s.draggable);if(!U||ixe(e,T,this)&&!U.animated){if(U===fn)return B(!1);if(U&&n===e.target&&(i=U),i&&(o=jr(i)),Zb(Ur,n,fn,r,i,o,e,!!i)!==!1)return F(),n.appendChild(fn),lo=n,G(),B(!0)}else if(U&&nxe(e,T,this)){var ee=Wm(n,0,s,!0);if(ee===fn)return B(!1);if(i=ee,o=jr(i),Zb(Ur,n,fn,r,i,o,e,!1)!==!1)return F(),n.insertBefore(fn,ee),lo=n,G(),B(!0)}else if(i.parentNode===n){o=jr(i);var ne=0,ye,fe=fn.parentNode!==n,J=!Ybe(fn.animated&&fn.toRect||r,i.animated&&i.toRect||o,T),Ce=T?"top":"left",me=lF(i,"top","top")||lF(fn,"top","top"),be=me?me.scrollTop:void 0;Bp!==i&&(ye=o[Ce],j0=!1,Kb=!J&&s.invertSwap||fe),ne=rxe(e,i,o,T,J?1:s.swapThreshold,s.invertedSwapThreshold==null?s.swapThreshold:s.invertedSwapThreshold,Kb,Bp===i);var Te;if(ne!==0){var ke=uo(fn);do ke-=ne,Te=lo.children[ke];while(Te&&(Un(Te,"display")==="none"||Te===wi))}if(ne===0||Te===i)return B(!1);Bp=i,V0=ne;var ut=i.nextElementSibling,et=!1;et=ne===1;var Et=Zb(Ur,n,fn,r,i,o,e,et);if(Et!==!1)return(Et===1||Et===-1)&&(et=Et===1),zP=!0,setTimeout(txe,30),F(),et&&!ut?n.appendChild(fn):i.parentNode.insertBefore(fn,et?ut:i),me&&aV(me,0,be-me.scrollTop),lo=fn.parentNode,ye!==void 0&&!Kb&&(zx=Math.abs(ye-jr(i)[Ce])),G(),B(!0)}if(n.contains(fn))return B(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){Mi(document,"mousemove",this._onTouchMove),Mi(document,"touchmove",this._onTouchMove),Mi(document,"pointermove",this._onTouchMove),Mi(document,"dragover",Od),Mi(document,"mousemove",Od),Mi(document,"touchmove",Od)},_offUpEvents:function(){var e=this.el.ownerDocument;Mi(e,"mouseup",this._onDrop),Mi(e,"touchend",this._onDrop),Mi(e,"pointerup",this._onDrop),Mi(e,"touchcancel",this._onDrop),Mi(document,"selectstart",this)},_onDrop:function(e){var n=this.el,i=this.options;if(ma=uo(fn),mh=uo(fn,i.draggable),Gs("drop",this,{evt:e}),lo=fn&&fn.parentNode,ma=uo(fn),mh=uo(fn,i.draggable),fi.eventCanceled){this._nulling();return}Hp=!1,Kb=!1,j0=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),NP(this.cloneId),NP(this._dragStartId),this.nativeDraggable&&(Mi(document,"drop",this),Mi(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),z0&&Un(document.body,"user-select",""),Un(fn,"transform",""),e&&(u0&&(e.cancelable&&e.preventDefault(),!i.dropBubble&&e.stopPropagation()),wi&&wi.parentNode&&wi.parentNode.removeChild(wi),(Ur===lo||Qo&&Qo.lastPutMode!=="clone")&&co&&co.parentNode&&co.parentNode.removeChild(co),fn&&(this.nativeDraggable&&Mi(fn,"dragend",this),CC(fn),fn.style["will-change"]="",u0&&!Hp&&no(fn,Qo?Qo.options.ghostClass:this.options.ghostClass,!1),no(fn,this.options.chosenClass,!1),Ps({sortable:this,name:"unchoose",toEl:lo,newIndex:null,newDraggableIndex:null,originalEvent:e}),Ur!==lo?(ma>=0&&(Ps({rootEl:lo,name:"add",toEl:lo,fromEl:Ur,originalEvent:e}),Ps({sortable:this,name:"remove",toEl:lo,originalEvent:e}),Ps({rootEl:lo,name:"sort",toEl:lo,fromEl:Ur,originalEvent:e}),Ps({sortable:this,name:"sort",toEl:lo,originalEvent:e})),Qo&&Qo.save()):ma!==em&&ma>=0&&(Ps({sortable:this,name:"update",toEl:lo,originalEvent:e}),Ps({sortable:this,name:"sort",toEl:lo,originalEvent:e})),fi.active&&((ma==null||ma===-1)&&(ma=em,mh=U0),Ps({sortable:this,name:"end",toEl:lo,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){Gs("nulling",this),Ur=fn=lo=wi=zd=co=Bx=gh=Ld=fl=u0=ma=mh=em=U0=Bp=V0=Qo=Wb=fi.dragged=fi.ghost=fi.clone=fi.active=null,Uw.forEach(function(e){e.checked=!0}),Uw.length=EC=TC=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":fn&&(this._onDragOver(e),exe(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],n,i=this.el.children,r=0,o=i.length,l=this.options;r<o;r++)n=i[r],ml(n,l.draggable,this.el,!1)&&e.push(n.getAttribute(l.dataIdAttr)||sxe(n));return e},sort:function(e,n){var i={},r=this.el;this.toArray().forEach(function(o,l){var s=r.children[l];ml(s,this.options.draggable,r,!1)&&(i[o]=s)},this),n&&this.captureAnimationState(),e.forEach(function(o){i[o]&&(r.removeChild(i[o]),r.appendChild(i[o]))}),n&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,n){return ml(e,n||this.options.draggable,this.el,!1)},option:function(e,n){var i=this.options;if(n===void 0)return i[e];var r=O_.modifyOption(this,e,n);typeof r<"u"?i[e]=r:i[e]=n,e==="group"&&uV(i)},destroy:function(){Gs("destroy",this);var e=this.el;e[bs]=null,Mi(e,"mousedown",this._onTapStart),Mi(e,"touchstart",this._onTapStart),Mi(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(Mi(e,"dragover",this),Mi(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Nw.splice(Nw.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!gh){if(Gs("hideClone",this),fi.eventCanceled)return;Un(co,"display","none"),this.options.removeCloneOnHide&&co.parentNode&&co.parentNode.removeChild(co),gh=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(gh){if(Gs("showClone",this),fi.eventCanceled)return;fn.parentNode==Ur&&!this.options.group.revertClone?Ur.insertBefore(co,fn):zd?Ur.insertBefore(co,zd):Ur.appendChild(co),this.options.group.revertClone&&this.animate(fn,co),Un(co,"display",""),gh=!1}}};function exe(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault()}function Zb(t,e,n,i,r,o,l,s){var d,p=t[bs],y=p.options.onMove,v;return window.CustomEvent&&!gu&&!L_?d=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(d=document.createEvent("Event"),d.initEvent("move",!0,!0)),d.to=e,d.from=t,d.dragged=n,d.draggedRect=i,d.related=r||e,d.relatedRect=o||jr(e),d.willInsertAfter=s,d.originalEvent=l,t.dispatchEvent(d),y&&(v=y.call(p,d,l)),v}function CC(t){t.draggable=!1}function txe(){zP=!1}function nxe(t,e,n){var i=jr(Wm(n.el,0,n.options,!0)),r=10;return e?t.clientX<i.left-r||t.clientY<i.top&&t.clientX<i.right:t.clientY<i.top-r||t.clientY<i.bottom&&t.clientX<i.left}function ixe(t,e,n){var i=jr(I3(n.el,n.options.draggable)),r=10;return e?t.clientX>i.right+r||t.clientX<=i.right&&t.clientY>i.bottom&&t.clientX>=i.left:t.clientX>i.right&&t.clientY>i.top||t.clientX<=i.right&&t.clientY>i.bottom+r}function rxe(t,e,n,i,r,o,l,s){var d=i?t.clientY:t.clientX,p=i?n.height:n.width,y=i?n.top:n.left,v=i?n.bottom:n.right,w=!1;if(!l){if(s&&zx<p*r){if(!j0&&(V0===1?d>y+p*o/2:d<v-p*o/2)&&(j0=!0),j0)w=!0;else if(V0===1?d<y+zx:d>v-zx)return-V0}else if(d>y+p*(1-r)/2&&d<v-p*(1-r)/2)return oxe(e)}return w=w||l,w&&(d<y+p*o/2||d>v-p*o/2)?d>y+p/2?1:-1:0}function oxe(t){return uo(fn)<uo(t)?1:-1}function sxe(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,i=0;n--;)i+=e.charCodeAt(n);return i.toString(36)}function axe(t){Uw.length=0;for(var e=t.getElementsByTagName("input"),n=e.length;n--;){var i=e[n];i.checked&&Uw.push(i)}}function Nx(t){return setTimeout(t,0)}function NP(t){return clearTimeout(t)}K2&&Bi(document,"touchmove",function(t){(fi.active||Hp)&&t.cancelable&&t.preventDefault()});fi.utils={on:Bi,off:Mi,css:Un,find:oV,is:function(e,n){return!!ml(e,n,e,!1)},extend:Gbe,throttle:sV,closest:ml,toggleClass:no,clone:M3,index:uo,nextTick:Nx,cancelNextTick:NP,detectDirection:cV,getChild:Wm};fi.get=function(t){return t[bs]};fi.mount=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e[0].constructor===Array&&(e=e[0]),e.forEach(function(i){if(!i.prototype||!i.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(i));i.utils&&(fi.utils=fc(fc({},fi.utils),i.utils)),O_.mount(i)})};fi.create=function(t,e){return new fi(t,e)};fi.version=Ube;var Co=[],h0,UP,VP=!1,AC,PC,Vw,d0;function lxe(){function t(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return t.prototype={dragStarted:function(n){var i=n.originalEvent;this.sortable.nativeDraggable?Bi(document,"dragover",this._handleAutoScroll):this.options.supportPointer?Bi(document,"pointermove",this._handleFallbackAutoScroll):i.touches?Bi(document,"touchmove",this._handleFallbackAutoScroll):Bi(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var i=n.originalEvent;!this.options.dragOverBubble&&!i.rootEl&&this._handleAutoScroll(i)},drop:function(){this.sortable.nativeDraggable?Mi(document,"dragover",this._handleAutoScroll):(Mi(document,"pointermove",this._handleFallbackAutoScroll),Mi(document,"touchmove",this._handleFallbackAutoScroll),Mi(document,"mousemove",this._handleFallbackAutoScroll)),pF(),Ux(),Hbe()},nulling:function(){Vw=UP=h0=VP=d0=AC=PC=null,Co.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,i){var r=this,o=(n.touches?n.touches[0]:n).clientX,l=(n.touches?n.touches[0]:n).clientY,s=document.elementFromPoint(o,l);if(Vw=n,i||this.options.forceAutoScrollFallback||L_||gu||z0){IC(n,this.options,s,i);var d=bh(s,!0);VP&&(!d0||o!==AC||l!==PC)&&(d0&&pF(),d0=setInterval(function(){var p=bh(document.elementFromPoint(o,l),!0);p!==d&&(d=p,Ux()),IC(n,r.options,p,i)},10),AC=o,PC=l)}else{if(!this.options.bubbleScroll||bh(s,!0)===lc()){Ux();return}IC(n,this.options,bh(s,!1),!1)}}},Wa(t,{pluginName:"scroll",initializeByDefault:!0})}function Ux(){Co.forEach(function(t){clearInterval(t.pid)}),Co=[]}function pF(){clearInterval(d0)}var IC=sV(function(t,e,n,i){if(e.scroll){var r=(t.touches?t.touches[0]:t).clientX,o=(t.touches?t.touches[0]:t).clientY,l=e.scrollSensitivity,s=e.scrollSpeed,d=lc(),p=!1,y;UP!==n&&(UP=n,Ux(),h0=e.scroll,y=e.scrollFn,h0===!0&&(h0=bh(n,!0)));var v=0,w=h0;do{var T=w,I=jr(T),L=I.top,k=I.bottom,F=I.left,B=I.right,G=I.width,U=I.height,ee=void 0,ne=void 0,ye=T.scrollWidth,fe=T.scrollHeight,J=Un(T),Ce=T.scrollLeft,me=T.scrollTop;T===d?(ee=G<ye&&(J.overflowX==="auto"||J.overflowX==="scroll"||J.overflowX==="visible"),ne=U<fe&&(J.overflowY==="auto"||J.overflowY==="scroll"||J.overflowY==="visible")):(ee=G<ye&&(J.overflowX==="auto"||J.overflowX==="scroll"),ne=U<fe&&(J.overflowY==="auto"||J.overflowY==="scroll"));var be=ee&&(Math.abs(B-r)<=l&&Ce+G<ye)-(Math.abs(F-r)<=l&&!!Ce),Te=ne&&(Math.abs(k-o)<=l&&me+U<fe)-(Math.abs(L-o)<=l&&!!me);if(!Co[v])for(var ke=0;ke<=v;ke++)Co[ke]||(Co[ke]={});(Co[v].vx!=be||Co[v].vy!=Te||Co[v].el!==T)&&(Co[v].el=T,Co[v].vx=be,Co[v].vy=Te,clearInterval(Co[v].pid),(be!=0||Te!=0)&&(p=!0,Co[v].pid=setInterval((function(){i&&this.layer===0&&fi.active._onTouchMove(Vw);var ut=Co[this.layer].vy?Co[this.layer].vy*s:0,et=Co[this.layer].vx?Co[this.layer].vx*s:0;typeof y=="function"&&y.call(fi.dragged.parentNode[bs],et,ut,t,Vw,Co[this.layer].el)!=="continue"||aV(Co[this.layer].el,et,ut)}).bind({layer:v}),24))),v++}while(e.bubbleScroll&&w!==d&&(w=bh(w,!1)));VP=p}},30),fV=function(e){var n=e.originalEvent,i=e.putSortable,r=e.dragEl,o=e.activeSortable,l=e.dispatchSortableEvent,s=e.hideGhostForTarget,d=e.unhideGhostForTarget;if(n){var p=i||o;s();var y=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,v=document.elementFromPoint(y.clientX,y.clientY);d(),p&&!p.el.contains(v)&&(l("spill"),this.onSpill({dragEl:r,putSortable:i}))}};function R3(){}R3.prototype={startIndex:null,dragStart:function(e){var n=e.oldDraggableIndex;this.startIndex=n},onSpill:function(e){var n=e.dragEl,i=e.putSortable;this.sortable.captureAnimationState(),i&&i.captureAnimationState();var r=Wm(this.sortable.el,this.startIndex,this.options);r?this.sortable.el.insertBefore(n,r):this.sortable.el.appendChild(n),this.sortable.animateAll(),i&&i.animateAll()},drop:fV};Wa(R3,{pluginName:"revertOnSpill"});function L3(){}L3.prototype={onSpill:function(e){var n=e.dragEl,i=e.putSortable,r=i||this.sortable;r.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),r.animateAll()},drop:fV};Wa(L3,{pluginName:"removeOnSpill"});var Fa;function cxe(){function t(){this.defaults={swapClass:"sortable-swap-highlight"}}return t.prototype={dragStart:function(n){var i=n.dragEl;Fa=i},dragOverValid:function(n){var i=n.completed,r=n.target,o=n.onMove,l=n.activeSortable,s=n.changed,d=n.cancel;if(l.options.swap){var p=this.sortable.el,y=this.options;if(r&&r!==p){var v=Fa;o(r)!==!1?(no(r,y.swapClass,!0),Fa=r):Fa=null,v&&v!==Fa&&no(v,y.swapClass,!1)}s(),i(!0),d()}},drop:function(n){var i=n.activeSortable,r=n.putSortable,o=n.dragEl,l=r||this.sortable,s=this.options;Fa&&no(Fa,s.swapClass,!1),Fa&&(s.swap||r&&r.options.swap)&&o!==Fa&&(l.captureAnimationState(),l!==i&&i.captureAnimationState(),uxe(o,Fa),l.animateAll(),l!==i&&i.animateAll())},nulling:function(){Fa=null}},Wa(t,{pluginName:"swap",eventProperties:function(){return{swapItem:Fa}}})}function uxe(t,e){var n=t.parentNode,i=e.parentNode,r,o;!n||!i||n.isEqualNode(e)||i.isEqualNode(t)||(r=uo(t),o=uo(e),n.isEqualNode(i)&&r<o&&o++,n.insertBefore(e,n.children[r]),i.insertBefore(t,i.children[o]))}var _i=[],pa=[],Vy,pl,jy=!1,Hs=!1,zp=!1,Mr,$y,qb;function hxe(){function t(e){for(var n in this)n.charAt(0)==="_"&&typeof this[n]=="function"&&(this[n]=this[n].bind(this));e.options.supportPointer?Bi(document,"pointerup",this._deselectMultiDrag):(Bi(document,"mouseup",this._deselectMultiDrag),Bi(document,"touchend",this._deselectMultiDrag)),Bi(document,"keydown",this._checkKeyDown),Bi(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,setData:function(r,o){var l="";_i.length&&pl===e?_i.forEach(function(s,d){l+=(d?", ":"")+s.textContent}):l=o.textContent,r.setData("Text",l)}}}return t.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(n){var i=n.dragEl;Mr=i},delayEnded:function(){this.isMultiDrag=~_i.indexOf(Mr)},setupClone:function(n){var i=n.sortable,r=n.cancel;if(this.isMultiDrag){for(var o=0;o<_i.length;o++)pa.push(M3(_i[o])),pa[o].sortableIndex=_i[o].sortableIndex,pa[o].draggable=!1,pa[o].style["will-change"]="",no(pa[o],this.options.selectedClass,!1),_i[o]===Mr&&no(pa[o],this.options.chosenClass,!1);i._hideClone(),r()}},clone:function(n){var i=n.sortable,r=n.rootEl,o=n.dispatchSortableEvent,l=n.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||_i.length&&pl===i&&(mF(!0,r),o("clone"),l()))},showClone:function(n){var i=n.cloneNowShown,r=n.rootEl,o=n.cancel;this.isMultiDrag&&(mF(!1,r),pa.forEach(function(l){Un(l,"display","")}),i(),qb=!1,o())},hideClone:function(n){var i=this;n.sortable;var r=n.cloneNowHidden,o=n.cancel;this.isMultiDrag&&(pa.forEach(function(l){Un(l,"display","none"),i.options.removeCloneOnHide&&l.parentNode&&l.parentNode.removeChild(l)}),r(),qb=!0,o())},dragStartGlobal:function(n){n.sortable,!this.isMultiDrag&&pl&&pl.multiDrag._deselectMultiDrag(),_i.forEach(function(i){i.sortableIndex=uo(i)}),_i=_i.sort(function(i,r){return i.sortableIndex-r.sortableIndex}),zp=!0},dragStarted:function(n){var i=this,r=n.sortable;if(this.isMultiDrag){if(this.options.sort&&(r.captureAnimationState(),this.options.animation)){_i.forEach(function(l){l!==Mr&&Un(l,"position","absolute")});var o=jr(Mr,!1,!0,!0);_i.forEach(function(l){l!==Mr&&uF(l,o)}),Hs=!0,jy=!0}r.animateAll(function(){Hs=!1,jy=!1,i.options.animation&&_i.forEach(function(l){xC(l)}),i.options.sort&&Yb()})}},dragOver:function(n){var i=n.target,r=n.completed,o=n.cancel;Hs&&~_i.indexOf(i)&&(r(!1),o())},revert:function(n){var i=n.fromSortable,r=n.rootEl,o=n.sortable,l=n.dragRect;_i.length>1&&(_i.forEach(function(s){o.addAnimationState({target:s,rect:Hs?jr(s):l}),xC(s),s.fromRect=l,i.removeAnimationState(s)}),Hs=!1,dxe(!this.options.removeCloneOnHide,r))},dragOverCompleted:function(n){var i=n.sortable,r=n.isOwner,o=n.insertion,l=n.activeSortable,s=n.parentEl,d=n.putSortable,p=this.options;if(o){if(r&&l._hideClone(),jy=!1,p.animation&&_i.length>1&&(Hs||!r&&!l.options.sort&&!d)){var y=jr(Mr,!1,!0,!0);_i.forEach(function(w){w!==Mr&&(uF(w,y),s.appendChild(w))}),Hs=!0}if(!r)if(Hs||Yb(),_i.length>1){var v=qb;l._showClone(i),l.options.animation&&!qb&&v&&pa.forEach(function(w){l.addAnimationState({target:w,rect:$y}),w.fromRect=$y,w.thisAnimationDuration=null})}else l._showClone(i)}},dragOverAnimationCapture:function(n){var i=n.dragRect,r=n.isOwner,o=n.activeSortable;if(_i.forEach(function(s){s.thisAnimationDuration=null}),o.options.animation&&!r&&o.multiDrag.isMultiDrag){$y=Wa({},i);var l=ef(Mr,!0);$y.top-=l.f,$y.left-=l.e}},dragOverAnimationComplete:function(){Hs&&(Hs=!1,Yb())},drop:function(n){var i=n.originalEvent,r=n.rootEl,o=n.parentEl,l=n.sortable,s=n.dispatchSortableEvent,d=n.oldIndex,p=n.putSortable,y=p||this.sortable;if(i){var v=this.options,w=o.children;if(!zp)if(v.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),no(Mr,v.selectedClass,!~_i.indexOf(Mr)),~_i.indexOf(Mr))_i.splice(_i.indexOf(Mr),1),Vy=null,c0({sortable:l,rootEl:r,name:"deselect",targetEl:Mr,originalEvt:i});else{if(_i.push(Mr),c0({sortable:l,rootEl:r,name:"select",targetEl:Mr,originalEvt:i}),i.shiftKey&&Vy&&l.el.contains(Vy)){var T=uo(Vy),I=uo(Mr);if(~T&&~I&&T!==I){var L,k;for(I>T?(k=T,L=I):(k=I,L=T+1);k<L;k++)~_i.indexOf(w[k])||(no(w[k],v.selectedClass,!0),_i.push(w[k]),c0({sortable:l,rootEl:r,name:"select",targetEl:w[k],originalEvt:i}))}}else Vy=Mr;pl=y}if(zp&&this.isMultiDrag){if(Hs=!1,(o[bs].options.sort||o!==r)&&_i.length>1){var F=jr(Mr),B=uo(Mr,":not(."+this.options.selectedClass+")");if(!jy&&v.animation&&(Mr.thisAnimationDuration=null),y.captureAnimationState(),!jy&&(v.animation&&(Mr.fromRect=F,_i.forEach(function(U){if(U.thisAnimationDuration=null,U!==Mr){var ee=Hs?jr(U):F;U.fromRect=ee,y.addAnimationState({target:U,rect:ee})}})),Yb(),_i.forEach(function(U){w[B]?o.insertBefore(U,w[B]):o.appendChild(U),B++}),d===uo(Mr))){var G=!1;_i.forEach(function(U){if(U.sortableIndex!==uo(U)){G=!0;return}}),G&&s("update")}_i.forEach(function(U){xC(U)}),y.animateAll()}pl=y}(r===o||p&&p.lastPutMode!=="clone")&&pa.forEach(function(U){U.parentNode&&U.parentNode.removeChild(U)})}},nullingGlobal:function(){this.isMultiDrag=zp=!1,pa.length=0},destroyGlobal:function(){this._deselectMultiDrag(),Mi(document,"pointerup",this._deselectMultiDrag),Mi(document,"mouseup",this._deselectMultiDrag),Mi(document,"touchend",this._deselectMultiDrag),Mi(document,"keydown",this._checkKeyDown),Mi(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(n){if(!(typeof zp<"u"&&zp)&&pl===this.sortable&&!(n&&ml(n.target,this.options.draggable,this.sortable.el,!1))&&!(n&&n.button!==0))for(;_i.length;){var i=_i[0];no(i,this.options.selectedClass,!1),_i.shift(),c0({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:i,originalEvt:n})}},_checkKeyDown:function(n){n.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(n){n.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},Wa(t,{pluginName:"multiDrag",utils:{select:function(n){var i=n.parentNode[bs];!i||!i.options.multiDrag||~_i.indexOf(n)||(pl&&pl!==i&&(pl.multiDrag._deselectMultiDrag(),pl=i),no(n,i.options.selectedClass,!0),_i.push(n))},deselect:function(n){var i=n.parentNode[bs],r=_i.indexOf(n);!i||!i.options.multiDrag||!~r||(no(n,i.options.selectedClass,!1),_i.splice(r,1))}},eventProperties:function(){var n=this,i=[],r=[];return _i.forEach(function(o){i.push({multiDragElement:o,index:o.sortableIndex});var l;Hs&&o!==Mr?l=-1:Hs?l=uo(o,":not(."+n.options.selectedClass+")"):l=uo(o),r.push({multiDragElement:o,index:l})}),{items:kbe(_i),clones:[].concat(pa),oldIndicies:i,newIndicies:r}},optionListeners:{multiDragKey:function(n){return n=n.toLowerCase(),n==="ctrl"?n="Control":n.length>1&&(n=n.charAt(0).toUpperCase()+n.substr(1)),n}}})}function dxe(t,e){_i.forEach(function(n,i){var r=e.children[n.sortableIndex+(t?Number(i):0)];r?e.insertBefore(n,r):e.appendChild(n)})}function mF(t,e){pa.forEach(function(n,i){var r=e.children[n.sortableIndex+(t?Number(i):0)];r?e.insertBefore(n,r):e.appendChild(n)})}function Yb(){_i.forEach(function(t){t!==Mr&&t.parentNode&&t.parentNode.removeChild(t)})}fi.mount(new lxe);fi.mount(L3,R3);const fxe=Object.defineProperty({__proto__:null,MultiDrag:hxe,Sortable:fi,Swap:cxe,default:fi},Symbol.toStringTag,{value:"Module"}),pxe=Uz(fxe);(function(t,e){(function(i,r){t.exports=r(Rbe,pxe)})(typeof self<"u"?self:Nz,function(n,i){return function(r){var o={};function l(s){if(o[s])return o[s].exports;var d=o[s]={i:s,l:!1,exports:{}};return r[s].call(d.exports,d,d.exports,l),d.l=!0,d.exports}return l.m=r,l.c=o,l.d=function(s,d,p){l.o(s,d)||Object.defineProperty(s,d,{enumerable:!0,get:p})},l.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},l.t=function(s,d){if(d&1&&(s=l(s)),d&8||d&4&&typeof s=="object"&&s&&s.__esModule)return s;var p=Object.create(null);if(l.r(p),Object.defineProperty(p,"default",{enumerable:!0,value:s}),d&2&&typeof s!="string")for(var y in s)l.d(p,y,(function(v){return s[v]}).bind(null,y));return p},l.n=function(s){var d=s&&s.__esModule?function(){return s.default}:function(){return s};return l.d(d,"a",d),d},l.o=function(s,d){return Object.prototype.hasOwnProperty.call(s,d)},l.p="",l(l.s="fb15")}({"00ee":function(r,o,l){var s=l("b622"),d=s("toStringTag"),p={};p[d]="z",r.exports=String(p)==="[object z]"},"0366":function(r,o,l){var s=l("1c0b");r.exports=function(d,p,y){if(s(d),p===void 0)return d;switch(y){case 0:return function(){return d.call(p)};case 1:return function(v){return d.call(p,v)};case 2:return function(v,w){return d.call(p,v,w)};case 3:return function(v,w,T){return d.call(p,v,w,T)}}return function(){return d.apply(p,arguments)}}},"057f":function(r,o,l){var s=l("fc6a"),d=l("241c").f,p={}.toString,y=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],v=function(w){try{return d(w)}catch{return y.slice()}};r.exports.f=function(T){return y&&p.call(T)=="[object Window]"?v(T):d(s(T))}},"06cf":function(r,o,l){var s=l("83ab"),d=l("d1e7"),p=l("5c6c"),y=l("fc6a"),v=l("c04e"),w=l("5135"),T=l("0cfb"),I=Object.getOwnPropertyDescriptor;o.f=s?I:function(k,F){if(k=y(k),F=v(F,!0),T)try{return I(k,F)}catch{}if(w(k,F))return p(!d.f.call(k,F),k[F])}},"0cfb":function(r,o,l){var s=l("83ab"),d=l("d039"),p=l("cc12");r.exports=!s&&!d(function(){return Object.defineProperty(p("div"),"a",{get:function(){return 7}}).a!=7})},"13d5":function(r,o,l){var s=l("23e7"),d=l("d58f").left,p=l("a640"),y=l("ae40"),v=p("reduce"),w=y("reduce",{1:0});s({target:"Array",proto:!0,forced:!v||!w},{reduce:function(I){return d(this,I,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"14c3":function(r,o,l){var s=l("c6b6"),d=l("9263");r.exports=function(p,y){var v=p.exec;if(typeof v=="function"){var w=v.call(p,y);if(typeof w!="object")throw TypeError("RegExp exec method returned something other than an Object or null");return w}if(s(p)!=="RegExp")throw TypeError("RegExp#exec called on incompatible receiver");return d.call(p,y)}},"159b":function(r,o,l){var s=l("da84"),d=l("fdbc"),p=l("17c2"),y=l("9112");for(var v in d){var w=s[v],T=w&&w.prototype;if(T&&T.forEach!==p)try{y(T,"forEach",p)}catch{T.forEach=p}}},"17c2":function(r,o,l){var s=l("b727").forEach,d=l("a640"),p=l("ae40"),y=d("forEach"),v=p("forEach");r.exports=!y||!v?function(T){return s(this,T,arguments.length>1?arguments[1]:void 0)}:[].forEach},"1be4":function(r,o,l){var s=l("d066");r.exports=s("document","documentElement")},"1c0b":function(r,o){r.exports=function(l){if(typeof l!="function")throw TypeError(String(l)+" is not a function");return l}},"1c7e":function(r,o,l){var s=l("b622"),d=s("iterator"),p=!1;try{var y=0,v={next:function(){return{done:!!y++}},return:function(){p=!0}};v[d]=function(){return this},Array.from(v,function(){throw 2})}catch{}r.exports=function(w,T){if(!T&&!p)return!1;var I=!1;try{var L={};L[d]=function(){return{next:function(){return{done:I=!0}}}},w(L)}catch{}return I}},"1d80":function(r,o){r.exports=function(l){if(l==null)throw TypeError("Can't call method on "+l);return l}},"1dde":function(r,o,l){var s=l("d039"),d=l("b622"),p=l("2d00"),y=d("species");r.exports=function(v){return p>=51||!s(function(){var w=[],T=w.constructor={};return T[y]=function(){return{foo:1}},w[v](Boolean).foo!==1})}},"23cb":function(r,o,l){var s=l("a691"),d=Math.max,p=Math.min;r.exports=function(y,v){var w=s(y);return w<0?d(w+v,0):p(w,v)}},"23e7":function(r,o,l){var s=l("da84"),d=l("06cf").f,p=l("9112"),y=l("6eeb"),v=l("ce4e"),w=l("e893"),T=l("94ca");r.exports=function(I,L){var k=I.target,F=I.global,B=I.stat,G,U,ee,ne,ye,fe;if(F?U=s:B?U=s[k]||v(k,{}):U=(s[k]||{}).prototype,U)for(ee in L){if(ye=L[ee],I.noTargetGet?(fe=d(U,ee),ne=fe&&fe.value):ne=U[ee],G=T(F?ee:k+(B?".":"#")+ee,I.forced),!G&&ne!==void 0){if(typeof ye==typeof ne)continue;w(ye,ne)}(I.sham||ne&&ne.sham)&&p(ye,"sham",!0),y(U,ee,ye,I)}}},"241c":function(r,o,l){var s=l("ca84"),d=l("7839"),p=d.concat("length","prototype");o.f=Object.getOwnPropertyNames||function(v){return s(v,p)}},"25f0":function(r,o,l){var s=l("6eeb"),d=l("825a"),p=l("d039"),y=l("ad6d"),v="toString",w=RegExp.prototype,T=w[v],I=p(function(){return T.call({source:"a",flags:"b"})!="/a/b"}),L=T.name!=v;(I||L)&&s(RegExp.prototype,v,function(){var F=d(this),B=String(F.source),G=F.flags,U=String(G===void 0&&F instanceof RegExp&&!("flags"in w)?y.call(F):G);return"/"+B+"/"+U},{unsafe:!0})},"2ca0":function(r,o,l){var s=l("23e7"),d=l("06cf").f,p=l("50c4"),y=l("5a34"),v=l("1d80"),w=l("ab13"),T=l("c430"),I="".startsWith,L=Math.min,k=w("startsWith"),F=!T&&!k&&!!function(){var B=d(String.prototype,"startsWith");return B&&!B.writable}();s({target:"String",proto:!0,forced:!F&&!k},{startsWith:function(G){var U=String(v(this));y(G);var ee=p(L(arguments.length>1?arguments[1]:void 0,U.length)),ne=String(G);return I?I.call(U,ne,ee):U.slice(ee,ee+ne.length)===ne}})},"2d00":function(r,o,l){var s=l("da84"),d=l("342f"),p=s.process,y=p&&p.versions,v=y&&y.v8,w,T;v?(w=v.split("."),T=w[0]+w[1]):d&&(w=d.match(/Edge\/(\d+)/),(!w||w[1]>=74)&&(w=d.match(/Chrome\/(\d+)/),w&&(T=w[1]))),r.exports=T&&+T},"342f":function(r,o,l){var s=l("d066");r.exports=s("navigator","userAgent")||""},"35a1":function(r,o,l){var s=l("f5df"),d=l("3f8c"),p=l("b622"),y=p("iterator");r.exports=function(v){if(v!=null)return v[y]||v["@@iterator"]||d[s(v)]}},"37e8":function(r,o,l){var s=l("83ab"),d=l("9bf2"),p=l("825a"),y=l("df75");r.exports=s?Object.defineProperties:function(w,T){p(w);for(var I=y(T),L=I.length,k=0,F;L>k;)d.f(w,F=I[k++],T[F]);return w}},"3bbe":function(r,o,l){var s=l("861d");r.exports=function(d){if(!s(d)&&d!==null)throw TypeError("Can't set "+String(d)+" as a prototype");return d}},"3ca3":function(r,o,l){var s=l("6547").charAt,d=l("69f3"),p=l("7dd0"),y="String Iterator",v=d.set,w=d.getterFor(y);p(String,"String",function(T){v(this,{type:y,string:String(T),index:0})},function(){var I=w(this),L=I.string,k=I.index,F;return k>=L.length?{value:void 0,done:!0}:(F=s(L,k),I.index+=F.length,{value:F,done:!1})})},"3f8c":function(r,o){r.exports={}},4160:function(r,o,l){var s=l("23e7"),d=l("17c2");s({target:"Array",proto:!0,forced:[].forEach!=d},{forEach:d})},"428f":function(r,o,l){var s=l("da84");r.exports=s},"44ad":function(r,o,l){var s=l("d039"),d=l("c6b6"),p="".split;r.exports=s(function(){return!Object("z").propertyIsEnumerable(0)})?function(y){return d(y)=="String"?p.call(y,""):Object(y)}:Object},"44d2":function(r,o,l){var s=l("b622"),d=l("7c73"),p=l("9bf2"),y=s("unscopables"),v=Array.prototype;v[y]==null&&p.f(v,y,{configurable:!0,value:d(null)}),r.exports=function(w){v[y][w]=!0}},"44e7":function(r,o,l){var s=l("861d"),d=l("c6b6"),p=l("b622"),y=p("match");r.exports=function(v){var w;return s(v)&&((w=v[y])!==void 0?!!w:d(v)=="RegExp")}},4930:function(r,o,l){var s=l("d039");r.exports=!!Object.getOwnPropertySymbols&&!s(function(){return!String(Symbol())})},"4d64":function(r,o,l){var s=l("fc6a"),d=l("50c4"),p=l("23cb"),y=function(v){return function(w,T,I){var L=s(w),k=d(L.length),F=p(I,k),B;if(v&&T!=T){for(;k>F;)if(B=L[F++],B!=B)return!0}else for(;k>F;F++)if((v||F in L)&&L[F]===T)return v||F||0;return!v&&-1}};r.exports={includes:y(!0),indexOf:y(!1)}},"4de4":function(r,o,l){var s=l("23e7"),d=l("b727").filter,p=l("1dde"),y=l("ae40"),v=p("filter"),w=y("filter");s({target:"Array",proto:!0,forced:!v||!w},{filter:function(I){return d(this,I,arguments.length>1?arguments[1]:void 0)}})},"4df4":function(r,o,l){var s=l("0366"),d=l("7b0b"),p=l("9bdd"),y=l("e95a"),v=l("50c4"),w=l("8418"),T=l("35a1");r.exports=function(L){var k=d(L),F=typeof this=="function"?this:Array,B=arguments.length,G=B>1?arguments[1]:void 0,U=G!==void 0,ee=T(k),ne=0,ye,fe,J,Ce,me,be;if(U&&(G=s(G,B>2?arguments[2]:void 0,2)),ee!=null&&!(F==Array&&y(ee)))for(Ce=ee.call(k),me=Ce.next,fe=new F;!(J=me.call(Ce)).done;ne++)be=U?p(Ce,G,[J.value,ne],!0):J.value,w(fe,ne,be);else for(ye=v(k.length),fe=new F(ye);ye>ne;ne++)be=U?G(k[ne],ne):k[ne],w(fe,ne,be);return fe.length=ne,fe}},"4fad":function(r,o,l){var s=l("23e7"),d=l("6f53").entries;s({target:"Object",stat:!0},{entries:function(y){return d(y)}})},"50c4":function(r,o,l){var s=l("a691"),d=Math.min;r.exports=function(p){return p>0?d(s(p),9007199254740991):0}},5135:function(r,o){var l={}.hasOwnProperty;r.exports=function(s,d){return l.call(s,d)}},5319:function(r,o,l){var s=l("d784"),d=l("825a"),p=l("7b0b"),y=l("50c4"),v=l("a691"),w=l("1d80"),T=l("8aa5"),I=l("14c3"),L=Math.max,k=Math.min,F=Math.floor,B=/\$([$&'`]|\d\d?|<[^>]*>)/g,G=/\$([$&'`]|\d\d?)/g,U=function(ee){return ee===void 0?ee:String(ee)};s("replace",2,function(ee,ne,ye,fe){var J=fe.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,Ce=fe.REPLACE_KEEPS_$0,me=J?"$":"$0";return[function(ke,ut){var et=w(this),Et=ke==null?void 0:ke[ee];return Et!==void 0?Et.call(ke,et,ut):ne.call(String(et),ke,ut)},function(Te,ke){if(!J&&Ce||typeof ke=="string"&&ke.indexOf(me)===-1){var ut=ye(ne,Te,this,ke);if(ut.done)return ut.value}var et=d(Te),Et=String(this),bt=typeof ke=="function";bt||(ke=String(ke));var Qt=et.global;if(Qt){var cn=et.unicode;et.lastIndex=0}for(var pn=[];;){var xn=I(et,Et);if(xn===null||(pn.push(xn),!Qt))break;var An=String(xn[0]);An===""&&(et.lastIndex=T(Et,y(et.lastIndex),cn))}for(var kn="",Bn=0,Nt=0;Nt<pn.length;Nt++){xn=pn[Nt];for(var We=String(xn[0]),kt=L(k(v(xn.index),Et.length),0),Ke=[],ht=1;ht<xn.length;ht++)Ke.push(U(xn[ht]));var Pt=xn.groups;if(bt){var ae=[We].concat(Ke,kt,Et);Pt!==void 0&&ae.push(Pt);var Ae=String(ke.apply(void 0,ae))}else Ae=be(We,Et,kt,Ke,Pt,ke);kt>=Bn&&(kn+=Et.slice(Bn,kt)+Ae,Bn=kt+We.length)}return kn+Et.slice(Bn)}];function be(Te,ke,ut,et,Et,bt){var Qt=ut+Te.length,cn=et.length,pn=G;return Et!==void 0&&(Et=p(Et),pn=B),ne.call(bt,pn,function(xn,An){var kn;switch(An.charAt(0)){case"$":return"$";case"&":return Te;case"`":return ke.slice(0,ut);case"'":return ke.slice(Qt);case"<":kn=Et[An.slice(1,-1)];break;default:var Bn=+An;if(Bn===0)return xn;if(Bn>cn){var Nt=F(Bn/10);return Nt===0?xn:Nt<=cn?et[Nt-1]===void 0?An.charAt(1):et[Nt-1]+An.charAt(1):xn}kn=et[Bn-1]}return kn===void 0?"":kn})}})},5692:function(r,o,l){var s=l("c430"),d=l("c6cd");(r.exports=function(p,y){return d[p]||(d[p]=y!==void 0?y:{})})("versions",[]).push({version:"3.6.5",mode:s?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},"56ef":function(r,o,l){var s=l("d066"),d=l("241c"),p=l("7418"),y=l("825a");r.exports=s("Reflect","ownKeys")||function(w){var T=d.f(y(w)),I=p.f;return I?T.concat(I(w)):T}},"5a34":function(r,o,l){var s=l("44e7");r.exports=function(d){if(s(d))throw TypeError("The method doesn't accept regular expressions");return d}},"5c6c":function(r,o){r.exports=function(l,s){return{enumerable:!(l&1),configurable:!(l&2),writable:!(l&4),value:s}}},"5db7":function(r,o,l){var s=l("23e7"),d=l("a2bf"),p=l("7b0b"),y=l("50c4"),v=l("1c0b"),w=l("65f0");s({target:"Array",proto:!0},{flatMap:function(I){var L=p(this),k=y(L.length),F;return v(I),F=w(L,0),F.length=d(F,L,L,k,0,1,I,arguments.length>1?arguments[1]:void 0),F}})},6547:function(r,o,l){var s=l("a691"),d=l("1d80"),p=function(y){return function(v,w){var T=String(d(v)),I=s(w),L=T.length,k,F;return I<0||I>=L?y?"":void 0:(k=T.charCodeAt(I),k<55296||k>56319||I+1===L||(F=T.charCodeAt(I+1))<56320||F>57343?y?T.charAt(I):k:y?T.slice(I,I+2):(k-55296<<10)+(F-56320)+65536)}};r.exports={codeAt:p(!1),charAt:p(!0)}},"65f0":function(r,o,l){var s=l("861d"),d=l("e8b5"),p=l("b622"),y=p("species");r.exports=function(v,w){var T;return d(v)&&(T=v.constructor,typeof T=="function"&&(T===Array||d(T.prototype))?T=void 0:s(T)&&(T=T[y],T===null&&(T=void 0))),new(T===void 0?Array:T)(w===0?0:w)}},"69f3":function(r,o,l){var s=l("7f9a"),d=l("da84"),p=l("861d"),y=l("9112"),v=l("5135"),w=l("f772"),T=l("d012"),I=d.WeakMap,L,k,F,B=function(J){return F(J)?k(J):L(J,{})},G=function(J){return function(Ce){var me;if(!p(Ce)||(me=k(Ce)).type!==J)throw TypeError("Incompatible receiver, "+J+" required");return me}};if(s){var U=new I,ee=U.get,ne=U.has,ye=U.set;L=function(J,Ce){return ye.call(U,J,Ce),Ce},k=function(J){return ee.call(U,J)||{}},F=function(J){return ne.call(U,J)}}else{var fe=w("state");T[fe]=!0,L=function(J,Ce){return y(J,fe,Ce),Ce},k=function(J){return v(J,fe)?J[fe]:{}},F=function(J){return v(J,fe)}}r.exports={set:L,get:k,has:F,enforce:B,getterFor:G}},"6eeb":function(r,o,l){var s=l("da84"),d=l("9112"),p=l("5135"),y=l("ce4e"),v=l("8925"),w=l("69f3"),T=w.get,I=w.enforce,L=String(String).split("String");(r.exports=function(k,F,B,G){var U=G?!!G.unsafe:!1,ee=G?!!G.enumerable:!1,ne=G?!!G.noTargetGet:!1;if(typeof B=="function"&&(typeof F=="string"&&!p(B,"name")&&d(B,"name",F),I(B).source=L.join(typeof F=="string"?F:"")),k===s){ee?k[F]=B:y(F,B);return}else U?!ne&&k[F]&&(ee=!0):delete k[F];ee?k[F]=B:d(k,F,B)})(Function.prototype,"toString",function(){return typeof this=="function"&&T(this).source||v(this)})},"6f53":function(r,o,l){var s=l("83ab"),d=l("df75"),p=l("fc6a"),y=l("d1e7").f,v=function(w){return function(T){for(var I=p(T),L=d(I),k=L.length,F=0,B=[],G;k>F;)G=L[F++],(!s||y.call(I,G))&&B.push(w?[G,I[G]]:I[G]);return B}};r.exports={entries:v(!0),values:v(!1)}},"73d9":function(r,o,l){var s=l("44d2");s("flatMap")},7418:function(r,o){o.f=Object.getOwnPropertySymbols},"746f":function(r,o,l){var s=l("428f"),d=l("5135"),p=l("e538"),y=l("9bf2").f;r.exports=function(v){var w=s.Symbol||(s.Symbol={});d(w,v)||y(w,v,{value:p.f(v)})}},7839:function(r,o){r.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"7b0b":function(r,o,l){var s=l("1d80");r.exports=function(d){return Object(s(d))}},"7c73":function(r,o,l){var s=l("825a"),d=l("37e8"),p=l("7839"),y=l("d012"),v=l("1be4"),w=l("cc12"),T=l("f772"),I=">",L="<",k="prototype",F="script",B=T("IE_PROTO"),G=function(){},U=function(J){return L+F+I+J+L+"/"+F+I},ee=function(J){J.write(U("")),J.close();var Ce=J.parentWindow.Object;return J=null,Ce},ne=function(){var J=w("iframe"),Ce="java"+F+":",me;return J.style.display="none",v.appendChild(J),J.src=String(Ce),me=J.contentWindow.document,me.open(),me.write(U("document.F=Object")),me.close(),me.F},ye,fe=function(){try{ye=document.domain&&new ActiveXObject("htmlfile")}catch{}fe=ye?ee(ye):ne();for(var J=p.length;J--;)delete fe[k][p[J]];return fe()};y[B]=!0,r.exports=Object.create||function(Ce,me){var be;return Ce!==null?(G[k]=s(Ce),be=new G,G[k]=null,be[B]=Ce):be=fe(),me===void 0?be:d(be,me)}},"7dd0":function(r,o,l){var s=l("23e7"),d=l("9ed3"),p=l("e163"),y=l("d2bb"),v=l("d44e"),w=l("9112"),T=l("6eeb"),I=l("b622"),L=l("c430"),k=l("3f8c"),F=l("ae93"),B=F.IteratorPrototype,G=F.BUGGY_SAFARI_ITERATORS,U=I("iterator"),ee="keys",ne="values",ye="entries",fe=function(){return this};r.exports=function(J,Ce,me,be,Te,ke,ut){d(me,Ce,be);var et=function(Nt){if(Nt===Te&&pn)return pn;if(!G&&Nt in Qt)return Qt[Nt];switch(Nt){case ee:return function(){return new me(this,Nt)};case ne:return function(){return new me(this,Nt)};case ye:return function(){return new me(this,Nt)}}return function(){return new me(this)}},Et=Ce+" Iterator",bt=!1,Qt=J.prototype,cn=Qt[U]||Qt["@@iterator"]||Te&&Qt[Te],pn=!G&&cn||et(Te),xn=Ce=="Array"&&Qt.entries||cn,An,kn,Bn;if(xn&&(An=p(xn.call(new J)),B!==Object.prototype&&An.next&&(!L&&p(An)!==B&&(y?y(An,B):typeof An[U]!="function"&&w(An,U,fe)),v(An,Et,!0,!0),L&&(k[Et]=fe))),Te==ne&&cn&&cn.name!==ne&&(bt=!0,pn=function(){return cn.call(this)}),(!L||ut)&&Qt[U]!==pn&&w(Qt,U,pn),k[Ce]=pn,Te)if(kn={values:et(ne),keys:ke?pn:et(ee),entries:et(ye)},ut)for(Bn in kn)(G||bt||!(Bn in Qt))&&T(Qt,Bn,kn[Bn]);else s({target:Ce,proto:!0,forced:G||bt},kn);return kn}},"7f9a":function(r,o,l){var s=l("da84"),d=l("8925"),p=s.WeakMap;r.exports=typeof p=="function"&&/native code/.test(d(p))},"825a":function(r,o,l){var s=l("861d");r.exports=function(d){if(!s(d))throw TypeError(String(d)+" is not an object");return d}},"83ab":function(r,o,l){var s=l("d039");r.exports=!s(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},8418:function(r,o,l){var s=l("c04e"),d=l("9bf2"),p=l("5c6c");r.exports=function(y,v,w){var T=s(v);T in y?d.f(y,T,p(0,w)):y[T]=w}},"861d":function(r,o){r.exports=function(l){return typeof l=="object"?l!==null:typeof l=="function"}},8875:function(r,o,l){var s,d,p;(function(y,v){d=[],s=v,p=typeof s=="function"?s.apply(o,d):s,p!==void 0&&(r.exports=p)})(typeof self<"u"?self:this,function(){function y(){var v=Object.getOwnPropertyDescriptor(document,"currentScript");if(!v&&"currentScript"in document&&document.currentScript||v&&v.get!==y&&document.currentScript)return document.currentScript;try{throw new Error}catch(ye){var w=/.*at [^(]*\((.*):(.+):(.+)\)$/ig,T=/@([^@]*):(\d+):(\d+)\s*$/ig,I=w.exec(ye.stack)||T.exec(ye.stack),L=I&&I[1]||!1,k=I&&I[2]||!1,F=document.location.href.replace(document.location.hash,""),B,G,U,ee=document.getElementsByTagName("script");L===F&&(B=document.documentElement.outerHTML,G=new RegExp("(?:[^\\n]+?\\n){0,"+(k-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),U=B.replace(G,"$1").trim());for(var ne=0;ne<ee.length;ne++)if(ee[ne].readyState==="interactive"||ee[ne].src===L||L===F&&ee[ne].innerHTML&&ee[ne].innerHTML.trim()===U)return ee[ne];return null}}return y})},8925:function(r,o,l){var s=l("c6cd"),d=Function.toString;typeof s.inspectSource!="function"&&(s.inspectSource=function(p){return d.call(p)}),r.exports=s.inspectSource},"8aa5":function(r,o,l){var s=l("6547").charAt;r.exports=function(d,p,y){return p+(y?s(d,p).length:1)}},"8bbf":function(r,o){r.exports=n},"90e3":function(r,o){var l=0,s=Math.random();r.exports=function(d){return"Symbol("+String(d===void 0?"":d)+")_"+(++l+s).toString(36)}},9112:function(r,o,l){var s=l("83ab"),d=l("9bf2"),p=l("5c6c");r.exports=s?function(y,v,w){return d.f(y,v,p(1,w))}:function(y,v,w){return y[v]=w,y}},9263:function(r,o,l){var s=l("ad6d"),d=l("9f7f"),p=RegExp.prototype.exec,y=String.prototype.replace,v=p,w=function(){var k=/a/,F=/b*/g;return p.call(k,"a"),p.call(F,"a"),k.lastIndex!==0||F.lastIndex!==0}(),T=d.UNSUPPORTED_Y||d.BROKEN_CARET,I=/()??/.exec("")[1]!==void 0,L=w||I||T;L&&(v=function(F){var B=this,G,U,ee,ne,ye=T&&B.sticky,fe=s.call(B),J=B.source,Ce=0,me=F;return ye&&(fe=fe.replace("y",""),fe.indexOf("g")===-1&&(fe+="g"),me=String(F).slice(B.lastIndex),B.lastIndex>0&&(!B.multiline||B.multiline&&F[B.lastIndex-1]!==`
`)&&(J="(?: "+J+")",me=" "+me,Ce++),U=new RegExp("^(?:"+J+")",fe)),I&&(U=new RegExp("^"+J+"$(?!\\s)",fe)),w&&(G=B.lastIndex),ee=p.call(ye?U:B,me),ye?ee?(ee.input=ee.input.slice(Ce),ee[0]=ee[0].slice(Ce),ee.index=B.lastIndex,B.lastIndex+=ee[0].length):B.lastIndex=0:w&&ee&&(B.lastIndex=B.global?ee.index+ee[0].length:G),I&&ee&&ee.length>1&&y.call(ee[0],U,function(){for(ne=1;ne<arguments.length-2;ne++)arguments[ne]===void 0&&(ee[ne]=void 0)}),ee}),r.exports=v},"94ca":function(r,o,l){var s=l("d039"),d=/#|\.prototype\./,p=function(I,L){var k=v[y(I)];return k==T?!0:k==w?!1:typeof L=="function"?s(L):!!L},y=p.normalize=function(I){return String(I).replace(d,".").toLowerCase()},v=p.data={},w=p.NATIVE="N",T=p.POLYFILL="P";r.exports=p},"99af":function(r,o,l){var s=l("23e7"),d=l("d039"),p=l("e8b5"),y=l("861d"),v=l("7b0b"),w=l("50c4"),T=l("8418"),I=l("65f0"),L=l("1dde"),k=l("b622"),F=l("2d00"),B=k("isConcatSpreadable"),G=9007199254740991,U="Maximum allowed index exceeded",ee=F>=51||!d(function(){var J=[];return J[B]=!1,J.concat()[0]!==J}),ne=L("concat"),ye=function(J){if(!y(J))return!1;var Ce=J[B];return Ce!==void 0?!!Ce:p(J)},fe=!ee||!ne;s({target:"Array",proto:!0,forced:fe},{concat:function(Ce){var me=v(this),be=I(me,0),Te=0,ke,ut,et,Et,bt;for(ke=-1,et=arguments.length;ke<et;ke++)if(bt=ke===-1?me:arguments[ke],ye(bt)){if(Et=w(bt.length),Te+Et>G)throw TypeError(U);for(ut=0;ut<Et;ut++,Te++)ut in bt&&T(be,Te,bt[ut])}else{if(Te>=G)throw TypeError(U);T(be,Te++,bt)}return be.length=Te,be}})},"9bdd":function(r,o,l){var s=l("825a");r.exports=function(d,p,y,v){try{return v?p(s(y)[0],y[1]):p(y)}catch(T){var w=d.return;throw w!==void 0&&s(w.call(d)),T}}},"9bf2":function(r,o,l){var s=l("83ab"),d=l("0cfb"),p=l("825a"),y=l("c04e"),v=Object.defineProperty;o.f=s?v:function(T,I,L){if(p(T),I=y(I,!0),p(L),d)try{return v(T,I,L)}catch{}if("get"in L||"set"in L)throw TypeError("Accessors not supported");return"value"in L&&(T[I]=L.value),T}},"9ed3":function(r,o,l){var s=l("ae93").IteratorPrototype,d=l("7c73"),p=l("5c6c"),y=l("d44e"),v=l("3f8c"),w=function(){return this};r.exports=function(T,I,L){var k=I+" Iterator";return T.prototype=d(s,{next:p(1,L)}),y(T,k,!1,!0),v[k]=w,T}},"9f7f":function(r,o,l){var s=l("d039");function d(p,y){return RegExp(p,y)}o.UNSUPPORTED_Y=s(function(){var p=d("a","y");return p.lastIndex=2,p.exec("abcd")!=null}),o.BROKEN_CARET=s(function(){var p=d("^r","gy");return p.lastIndex=2,p.exec("str")!=null})},a2bf:function(r,o,l){var s=l("e8b5"),d=l("50c4"),p=l("0366"),y=function(v,w,T,I,L,k,F,B){for(var G=L,U=0,ee=F?p(F,B,3):!1,ne;U<I;){if(U in T){if(ne=ee?ee(T[U],U,w):T[U],k>0&&s(ne))G=y(v,w,ne,d(ne.length),G,k-1)-1;else{if(G>=9007199254740991)throw TypeError("Exceed the acceptable array length");v[G]=ne}G++}U++}return G};r.exports=y},a352:function(r,o){r.exports=i},a434:function(r,o,l){var s=l("23e7"),d=l("23cb"),p=l("a691"),y=l("50c4"),v=l("7b0b"),w=l("65f0"),T=l("8418"),I=l("1dde"),L=l("ae40"),k=I("splice"),F=L("splice",{ACCESSORS:!0,0:0,1:2}),B=Math.max,G=Math.min,U=9007199254740991,ee="Maximum allowed length exceeded";s({target:"Array",proto:!0,forced:!k||!F},{splice:function(ye,fe){var J=v(this),Ce=y(J.length),me=d(ye,Ce),be=arguments.length,Te,ke,ut,et,Et,bt;if(be===0?Te=ke=0:be===1?(Te=0,ke=Ce-me):(Te=be-2,ke=G(B(p(fe),0),Ce-me)),Ce+Te-ke>U)throw TypeError(ee);for(ut=w(J,ke),et=0;et<ke;et++)Et=me+et,Et in J&&T(ut,et,J[Et]);if(ut.length=ke,Te<ke){for(et=me;et<Ce-ke;et++)Et=et+ke,bt=et+Te,Et in J?J[bt]=J[Et]:delete J[bt];for(et=Ce;et>Ce-ke+Te;et--)delete J[et-1]}else if(Te>ke)for(et=Ce-ke;et>me;et--)Et=et+ke-1,bt=et+Te-1,Et in J?J[bt]=J[Et]:delete J[bt];for(et=0;et<Te;et++)J[et+me]=arguments[et+2];return J.length=Ce-ke+Te,ut}})},a4d3:function(r,o,l){var s=l("23e7"),d=l("da84"),p=l("d066"),y=l("c430"),v=l("83ab"),w=l("4930"),T=l("fdbf"),I=l("d039"),L=l("5135"),k=l("e8b5"),F=l("861d"),B=l("825a"),G=l("7b0b"),U=l("fc6a"),ee=l("c04e"),ne=l("5c6c"),ye=l("7c73"),fe=l("df75"),J=l("241c"),Ce=l("057f"),me=l("7418"),be=l("06cf"),Te=l("9bf2"),ke=l("d1e7"),ut=l("9112"),et=l("6eeb"),Et=l("5692"),bt=l("f772"),Qt=l("d012"),cn=l("90e3"),pn=l("b622"),xn=l("e538"),An=l("746f"),kn=l("d44e"),Bn=l("69f3"),Nt=l("b727").forEach,We=bt("hidden"),kt="Symbol",Ke="prototype",ht=pn("toPrimitive"),Pt=Bn.set,ae=Bn.getterFor(kt),Ae=Object[Ke],je=d.Symbol,tt=p("JSON","stringify"),pt=be.f,Tt=Te.f,tn=Ce.f,Wt=ke.f,qt=Et("symbols"),It=Et("op-symbols"),wn=Et("string-to-symbol-registry"),hn=Et("symbol-to-string-registry"),En=Et("wks"),zn=d.QObject,ei=!zn||!zn[Ke]||!zn[Ke].findChild,ti=v&&I(function(){return ye(Tt({},"a",{get:function(){return Tt(this,"a",{value:7}).a}})).a!=7})?function(Pn,ue,X){var te=pt(Ae,ue);te&&delete Ae[ue],Tt(Pn,ue,X),te&&Pn!==Ae&&Tt(Ae,ue,te)}:Tt,li=function(Pn,ue){var X=qt[Pn]=ye(je[Ke]);return Pt(X,{type:kt,tag:Pn,description:ue}),v||(X.description=ue),X},ie=T?function(Pn){return typeof Pn=="symbol"}:function(Pn){return Object(Pn)instanceof je},K=function(ue,X,te){ue===Ae&&K(It,X,te),B(ue);var de=ee(X,!0);return B(te),L(qt,de)?(te.enumerable?(L(ue,We)&&ue[We][de]&&(ue[We][de]=!1),te=ye(te,{enumerable:ne(0,!1)})):(L(ue,We)||Tt(ue,We,ne(1,{})),ue[We][de]=!0),ti(ue,de,te)):Tt(ue,de,te)},Be=function(ue,X){B(ue);var te=U(X),de=fe(te).concat(bn(te));return Nt(de,function(Pe){(!v||mt.call(te,Pe))&&K(ue,Pe,te[Pe])}),ue},rt=function(ue,X){return X===void 0?ye(ue):Be(ye(ue),X)},mt=function(ue){var X=ee(ue,!0),te=Wt.call(this,X);return this===Ae&&L(qt,X)&&!L(It,X)?!1:te||!L(this,X)||!L(qt,X)||L(this,We)&&this[We][X]?te:!0},zt=function(ue,X){var te=U(ue),de=ee(X,!0);if(!(te===Ae&&L(qt,de)&&!L(It,de))){var Pe=pt(te,de);return Pe&&L(qt,de)&&!(L(te,We)&&te[We][de])&&(Pe.enumerable=!0),Pe}},en=function(ue){var X=tn(U(ue)),te=[];return Nt(X,function(de){!L(qt,de)&&!L(Qt,de)&&te.push(de)}),te},bn=function(ue){var X=ue===Ae,te=tn(X?It:U(ue)),de=[];return Nt(te,function(Pe){L(qt,Pe)&&(!X||L(Ae,Pe))&&de.push(qt[Pe])}),de};if(w||(je=function(){if(this instanceof je)throw TypeError("Symbol is not a constructor");var ue=!arguments.length||arguments[0]===void 0?void 0:String(arguments[0]),X=cn(ue),te=function(de){this===Ae&&te.call(It,de),L(this,We)&&L(this[We],X)&&(this[We][X]=!1),ti(this,X,ne(1,de))};return v&&ei&&ti(Ae,X,{configurable:!0,set:te}),li(X,ue)},et(je[Ke],"toString",function(){return ae(this).tag}),et(je,"withoutSetter",function(Pn){return li(cn(Pn),Pn)}),ke.f=mt,Te.f=K,be.f=zt,J.f=Ce.f=en,me.f=bn,xn.f=function(Pn){return li(pn(Pn),Pn)},v&&(Tt(je[Ke],"description",{configurable:!0,get:function(){return ae(this).description}}),y||et(Ae,"propertyIsEnumerable",mt,{unsafe:!0}))),s({global:!0,wrap:!0,forced:!w,sham:!w},{Symbol:je}),Nt(fe(En),function(Pn){An(Pn)}),s({target:kt,stat:!0,forced:!w},{for:function(Pn){var ue=String(Pn);if(L(wn,ue))return wn[ue];var X=je(ue);return wn[ue]=X,hn[X]=ue,X},keyFor:function(ue){if(!ie(ue))throw TypeError(ue+" is not a symbol");if(L(hn,ue))return hn[ue]},useSetter:function(){ei=!0},useSimple:function(){ei=!1}}),s({target:"Object",stat:!0,forced:!w,sham:!v},{create:rt,defineProperty:K,defineProperties:Be,getOwnPropertyDescriptor:zt}),s({target:"Object",stat:!0,forced:!w},{getOwnPropertyNames:en,getOwnPropertySymbols:bn}),s({target:"Object",stat:!0,forced:I(function(){me.f(1)})},{getOwnPropertySymbols:function(ue){return me.f(G(ue))}}),tt){var Hn=!w||I(function(){var Pn=je();return tt([Pn])!="[null]"||tt({a:Pn})!="{}"||tt(Object(Pn))!="{}"});s({target:"JSON",stat:!0,forced:Hn},{stringify:function(ue,X,te){for(var de=[ue],Pe=1,$e;arguments.length>Pe;)de.push(arguments[Pe++]);if($e=X,!(!F(X)&&ue===void 0||ie(ue)))return k(X)||(X=function(Je,qe){if(typeof $e=="function"&&(qe=$e.call(this,Je,qe)),!ie(qe))return qe}),de[1]=X,tt.apply(null,de)}})}je[Ke][ht]||ut(je[Ke],ht,je[Ke].valueOf),kn(je,kt),Qt[We]=!0},a630:function(r,o,l){var s=l("23e7"),d=l("4df4"),p=l("1c7e"),y=!p(function(v){Array.from(v)});s({target:"Array",stat:!0,forced:y},{from:d})},a640:function(r,o,l){var s=l("d039");r.exports=function(d,p){var y=[][d];return!!y&&s(function(){y.call(null,p||function(){throw 1},1)})}},a691:function(r,o){var l=Math.ceil,s=Math.floor;r.exports=function(d){return isNaN(d=+d)?0:(d>0?s:l)(d)}},ab13:function(r,o,l){var s=l("b622"),d=s("match");r.exports=function(p){var y=/./;try{"/./"[p](y)}catch{try{return y[d]=!1,"/./"[p](y)}catch{}}return!1}},ac1f:function(r,o,l){var s=l("23e7"),d=l("9263");s({target:"RegExp",proto:!0,forced:/./.exec!==d},{exec:d})},ad6d:function(r,o,l){var s=l("825a");r.exports=function(){var d=s(this),p="";return d.global&&(p+="g"),d.ignoreCase&&(p+="i"),d.multiline&&(p+="m"),d.dotAll&&(p+="s"),d.unicode&&(p+="u"),d.sticky&&(p+="y"),p}},ae40:function(r,o,l){var s=l("83ab"),d=l("d039"),p=l("5135"),y=Object.defineProperty,v={},w=function(T){throw T};r.exports=function(T,I){if(p(v,T))return v[T];I||(I={});var L=[][T],k=p(I,"ACCESSORS")?I.ACCESSORS:!1,F=p(I,0)?I[0]:w,B=p(I,1)?I[1]:void 0;return v[T]=!!L&&!d(function(){if(k&&!s)return!0;var G={length:-1};k?y(G,1,{enumerable:!0,get:w}):G[1]=1,L.call(G,F,B)})}},ae93:function(r,o,l){var s=l("e163"),d=l("9112"),p=l("5135"),y=l("b622"),v=l("c430"),w=y("iterator"),T=!1,I=function(){return this},L,k,F;[].keys&&(F=[].keys(),"next"in F?(k=s(s(F)),k!==Object.prototype&&(L=k)):T=!0),L==null&&(L={}),!v&&!p(L,w)&&d(L,w,I),r.exports={IteratorPrototype:L,BUGGY_SAFARI_ITERATORS:T}},b041:function(r,o,l){var s=l("00ee"),d=l("f5df");r.exports=s?{}.toString:function(){return"[object "+d(this)+"]"}},b0c0:function(r,o,l){var s=l("83ab"),d=l("9bf2").f,p=Function.prototype,y=p.toString,v=/^\s*function ([^ (]*)/,w="name";s&&!(w in p)&&d(p,w,{configurable:!0,get:function(){try{return y.call(this).match(v)[1]}catch{return""}}})},b622:function(r,o,l){var s=l("da84"),d=l("5692"),p=l("5135"),y=l("90e3"),v=l("4930"),w=l("fdbf"),T=d("wks"),I=s.Symbol,L=w?I:I&&I.withoutSetter||y;r.exports=function(k){return p(T,k)||(v&&p(I,k)?T[k]=I[k]:T[k]=L("Symbol."+k)),T[k]}},b64b:function(r,o,l){var s=l("23e7"),d=l("7b0b"),p=l("df75"),y=l("d039"),v=y(function(){p(1)});s({target:"Object",stat:!0,forced:v},{keys:function(T){return p(d(T))}})},b727:function(r,o,l){var s=l("0366"),d=l("44ad"),p=l("7b0b"),y=l("50c4"),v=l("65f0"),w=[].push,T=function(I){var L=I==1,k=I==2,F=I==3,B=I==4,G=I==6,U=I==5||G;return function(ee,ne,ye,fe){for(var J=p(ee),Ce=d(J),me=s(ne,ye,3),be=y(Ce.length),Te=0,ke=fe||v,ut=L?ke(ee,be):k?ke(ee,0):void 0,et,Et;be>Te;Te++)if((U||Te in Ce)&&(et=Ce[Te],Et=me(et,Te,J),I)){if(L)ut[Te]=Et;else if(Et)switch(I){case 3:return!0;case 5:return et;case 6:return Te;case 2:w.call(ut,et)}else if(B)return!1}return G?-1:F||B?B:ut}};r.exports={forEach:T(0),map:T(1),filter:T(2),some:T(3),every:T(4),find:T(5),findIndex:T(6)}},c04e:function(r,o,l){var s=l("861d");r.exports=function(d,p){if(!s(d))return d;var y,v;if(p&&typeof(y=d.toString)=="function"&&!s(v=y.call(d))||typeof(y=d.valueOf)=="function"&&!s(v=y.call(d))||!p&&typeof(y=d.toString)=="function"&&!s(v=y.call(d)))return v;throw TypeError("Can't convert object to primitive value")}},c430:function(r,o){r.exports=!1},c6b6:function(r,o){var l={}.toString;r.exports=function(s){return l.call(s).slice(8,-1)}},c6cd:function(r,o,l){var s=l("da84"),d=l("ce4e"),p="__core-js_shared__",y=s[p]||d(p,{});r.exports=y},c740:function(r,o,l){var s=l("23e7"),d=l("b727").findIndex,p=l("44d2"),y=l("ae40"),v="findIndex",w=!0,T=y(v);v in[]&&Array(1)[v](function(){w=!1}),s({target:"Array",proto:!0,forced:w||!T},{findIndex:function(L){return d(this,L,arguments.length>1?arguments[1]:void 0)}}),p(v)},c8ba:function(r,o){var l;l=function(){return this}();try{l=l||new Function("return this")()}catch{typeof window=="object"&&(l=window)}r.exports=l},c975:function(r,o,l){var s=l("23e7"),d=l("4d64").indexOf,p=l("a640"),y=l("ae40"),v=[].indexOf,w=!!v&&1/[1].indexOf(1,-0)<0,T=p("indexOf"),I=y("indexOf",{ACCESSORS:!0,1:0});s({target:"Array",proto:!0,forced:w||!T||!I},{indexOf:function(k){return w?v.apply(this,arguments)||0:d(this,k,arguments.length>1?arguments[1]:void 0)}})},ca84:function(r,o,l){var s=l("5135"),d=l("fc6a"),p=l("4d64").indexOf,y=l("d012");r.exports=function(v,w){var T=d(v),I=0,L=[],k;for(k in T)!s(y,k)&&s(T,k)&&L.push(k);for(;w.length>I;)s(T,k=w[I++])&&(~p(L,k)||L.push(k));return L}},caad:function(r,o,l){var s=l("23e7"),d=l("4d64").includes,p=l("44d2"),y=l("ae40"),v=y("indexOf",{ACCESSORS:!0,1:0});s({target:"Array",proto:!0,forced:!v},{includes:function(T){return d(this,T,arguments.length>1?arguments[1]:void 0)}}),p("includes")},cc12:function(r,o,l){var s=l("da84"),d=l("861d"),p=s.document,y=d(p)&&d(p.createElement);r.exports=function(v){return y?p.createElement(v):{}}},ce4e:function(r,o,l){var s=l("da84"),d=l("9112");r.exports=function(p,y){try{d(s,p,y)}catch{s[p]=y}return y}},d012:function(r,o){r.exports={}},d039:function(r,o){r.exports=function(l){try{return!!l()}catch{return!0}}},d066:function(r,o,l){var s=l("428f"),d=l("da84"),p=function(y){return typeof y=="function"?y:void 0};r.exports=function(y,v){return arguments.length<2?p(s[y])||p(d[y]):s[y]&&s[y][v]||d[y]&&d[y][v]}},d1e7:function(r,o,l){var s={}.propertyIsEnumerable,d=Object.getOwnPropertyDescriptor,p=d&&!s.call({1:2},1);o.f=p?function(v){var w=d(this,v);return!!w&&w.enumerable}:s},d28b:function(r,o,l){var s=l("746f");s("iterator")},d2bb:function(r,o,l){var s=l("825a"),d=l("3bbe");r.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var p=!1,y={},v;try{v=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set,v.call(y,[]),p=y instanceof Array}catch{}return function(T,I){return s(T),d(I),p?v.call(T,I):T.__proto__=I,T}}():void 0)},d3b7:function(r,o,l){var s=l("00ee"),d=l("6eeb"),p=l("b041");s||d(Object.prototype,"toString",p,{unsafe:!0})},d44e:function(r,o,l){var s=l("9bf2").f,d=l("5135"),p=l("b622"),y=p("toStringTag");r.exports=function(v,w,T){v&&!d(v=T?v:v.prototype,y)&&s(v,y,{configurable:!0,value:w})}},d58f:function(r,o,l){var s=l("1c0b"),d=l("7b0b"),p=l("44ad"),y=l("50c4"),v=function(w){return function(T,I,L,k){s(I);var F=d(T),B=p(F),G=y(F.length),U=w?G-1:0,ee=w?-1:1;if(L<2)for(;;){if(U in B){k=B[U],U+=ee;break}if(U+=ee,w?U<0:G<=U)throw TypeError("Reduce of empty array with no initial value")}for(;w?U>=0:G>U;U+=ee)U in B&&(k=I(k,B[U],U,F));return k}};r.exports={left:v(!1),right:v(!0)}},d784:function(r,o,l){l("ac1f");var s=l("6eeb"),d=l("d039"),p=l("b622"),y=l("9263"),v=l("9112"),w=p("species"),T=!d(function(){var B=/./;return B.exec=function(){var G=[];return G.groups={a:"7"},G},"".replace(B,"$<a>")!=="7"}),I=function(){return"a".replace(/./,"$0")==="$0"}(),L=p("replace"),k=function(){return/./[L]?/./[L]("a","$0")==="":!1}(),F=!d(function(){var B=/(?:)/,G=B.exec;B.exec=function(){return G.apply(this,arguments)};var U="ab".split(B);return U.length!==2||U[0]!=="a"||U[1]!=="b"});r.exports=function(B,G,U,ee){var ne=p(B),ye=!d(function(){var Te={};return Te[ne]=function(){return 7},""[B](Te)!=7}),fe=ye&&!d(function(){var Te=!1,ke=/a/;return B==="split"&&(ke={},ke.constructor={},ke.constructor[w]=function(){return ke},ke.flags="",ke[ne]=/./[ne]),ke.exec=function(){return Te=!0,null},ke[ne](""),!Te});if(!ye||!fe||B==="replace"&&!(T&&I&&!k)||B==="split"&&!F){var J=/./[ne],Ce=U(ne,""[B],function(Te,ke,ut,et,Et){return ke.exec===y?ye&&!Et?{done:!0,value:J.call(ke,ut,et)}:{done:!0,value:Te.call(ut,ke,et)}:{done:!1}},{REPLACE_KEEPS_$0:I,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:k}),me=Ce[0],be=Ce[1];s(String.prototype,B,me),s(RegExp.prototype,ne,G==2?function(Te,ke){return be.call(Te,this,ke)}:function(Te){return be.call(Te,this)})}ee&&v(RegExp.prototype[ne],"sham",!0)}},d81d:function(r,o,l){var s=l("23e7"),d=l("b727").map,p=l("1dde"),y=l("ae40"),v=p("map"),w=y("map");s({target:"Array",proto:!0,forced:!v||!w},{map:function(I){return d(this,I,arguments.length>1?arguments[1]:void 0)}})},da84:function(r,o,l){(function(s){var d=function(p){return p&&p.Math==Math&&p};r.exports=d(typeof globalThis=="object"&&globalThis)||d(typeof window=="object"&&window)||d(typeof self=="object"&&self)||d(typeof s=="object"&&s)||Function("return this")()}).call(this,l("c8ba"))},dbb4:function(r,o,l){var s=l("23e7"),d=l("83ab"),p=l("56ef"),y=l("fc6a"),v=l("06cf"),w=l("8418");s({target:"Object",stat:!0,sham:!d},{getOwnPropertyDescriptors:function(I){for(var L=y(I),k=v.f,F=p(L),B={},G=0,U,ee;F.length>G;)ee=k(L,U=F[G++]),ee!==void 0&&w(B,U,ee);return B}})},dbf1:function(r,o,l){(function(s){l.d(o,"a",function(){return p});function d(){return typeof window<"u"?window.console:s.console}var p=d()}).call(this,l("c8ba"))},ddb0:function(r,o,l){var s=l("da84"),d=l("fdbc"),p=l("e260"),y=l("9112"),v=l("b622"),w=v("iterator"),T=v("toStringTag"),I=p.values;for(var L in d){var k=s[L],F=k&&k.prototype;if(F){if(F[w]!==I)try{y(F,w,I)}catch{F[w]=I}if(F[T]||y(F,T,L),d[L]){for(var B in p)if(F[B]!==p[B])try{y(F,B,p[B])}catch{F[B]=p[B]}}}}},df75:function(r,o,l){var s=l("ca84"),d=l("7839");r.exports=Object.keys||function(y){return s(y,d)}},e01a:function(r,o,l){var s=l("23e7"),d=l("83ab"),p=l("da84"),y=l("5135"),v=l("861d"),w=l("9bf2").f,T=l("e893"),I=p.Symbol;if(d&&typeof I=="function"&&(!("description"in I.prototype)||I().description!==void 0)){var L={},k=function(){var ne=arguments.length<1||arguments[0]===void 0?void 0:String(arguments[0]),ye=this instanceof k?new I(ne):ne===void 0?I():I(ne);return ne===""&&(L[ye]=!0),ye};T(k,I);var F=k.prototype=I.prototype;F.constructor=k;var B=F.toString,G=String(I("test"))=="Symbol(test)",U=/^Symbol\((.*)\)[^)]+$/;w(F,"description",{configurable:!0,get:function(){var ne=v(this)?this.valueOf():this,ye=B.call(ne);if(y(L,ne))return"";var fe=G?ye.slice(7,-1):ye.replace(U,"$1");return fe===""?void 0:fe}}),s({global:!0,forced:!0},{Symbol:k})}},e163:function(r,o,l){var s=l("5135"),d=l("7b0b"),p=l("f772"),y=l("e177"),v=p("IE_PROTO"),w=Object.prototype;r.exports=y?Object.getPrototypeOf:function(T){return T=d(T),s(T,v)?T[v]:typeof T.constructor=="function"&&T instanceof T.constructor?T.constructor.prototype:T instanceof Object?w:null}},e177:function(r,o,l){var s=l("d039");r.exports=!s(function(){function d(){}return d.prototype.constructor=null,Object.getPrototypeOf(new d)!==d.prototype})},e260:function(r,o,l){var s=l("fc6a"),d=l("44d2"),p=l("3f8c"),y=l("69f3"),v=l("7dd0"),w="Array Iterator",T=y.set,I=y.getterFor(w);r.exports=v(Array,"Array",function(L,k){T(this,{type:w,target:s(L),index:0,kind:k})},function(){var L=I(this),k=L.target,F=L.kind,B=L.index++;return!k||B>=k.length?(L.target=void 0,{value:void 0,done:!0}):F=="keys"?{value:B,done:!1}:F=="values"?{value:k[B],done:!1}:{value:[B,k[B]],done:!1}},"values"),p.Arguments=p.Array,d("keys"),d("values"),d("entries")},e439:function(r,o,l){var s=l("23e7"),d=l("d039"),p=l("fc6a"),y=l("06cf").f,v=l("83ab"),w=d(function(){y(1)}),T=!v||w;s({target:"Object",stat:!0,forced:T,sham:!v},{getOwnPropertyDescriptor:function(L,k){return y(p(L),k)}})},e538:function(r,o,l){var s=l("b622");o.f=s},e893:function(r,o,l){var s=l("5135"),d=l("56ef"),p=l("06cf"),y=l("9bf2");r.exports=function(v,w){for(var T=d(w),I=y.f,L=p.f,k=0;k<T.length;k++){var F=T[k];s(v,F)||I(v,F,L(w,F))}}},e8b5:function(r,o,l){var s=l("c6b6");r.exports=Array.isArray||function(p){return s(p)=="Array"}},e95a:function(r,o,l){var s=l("b622"),d=l("3f8c"),p=s("iterator"),y=Array.prototype;r.exports=function(v){return v!==void 0&&(d.Array===v||y[p]===v)}},f5df:function(r,o,l){var s=l("00ee"),d=l("c6b6"),p=l("b622"),y=p("toStringTag"),v=d(function(){return arguments}())=="Arguments",w=function(T,I){try{return T[I]}catch{}};r.exports=s?d:function(T){var I,L,k;return T===void 0?"Undefined":T===null?"Null":typeof(L=w(I=Object(T),y))=="string"?L:v?d(I):(k=d(I))=="Object"&&typeof I.callee=="function"?"Arguments":k}},f772:function(r,o,l){var s=l("5692"),d=l("90e3"),p=s("keys");r.exports=function(y){return p[y]||(p[y]=d(y))}},fb15:function(r,o,l){if(l.r(o),typeof window<"u"){var s=window.document.currentScript;{var d=l("8875");s=d(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:d})}var p=s&&s.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);p&&(l.p=p[1])}l("99af"),l("4de4"),l("4160"),l("c975"),l("d81d"),l("a434"),l("159b"),l("a4d3"),l("e439"),l("dbb4"),l("b64b");function y(ie,K,Be){return K in ie?Object.defineProperty(ie,K,{value:Be,enumerable:!0,configurable:!0,writable:!0}):ie[K]=Be,ie}function v(ie,K){var Be=Object.keys(ie);if(Object.getOwnPropertySymbols){var rt=Object.getOwnPropertySymbols(ie);K&&(rt=rt.filter(function(mt){return Object.getOwnPropertyDescriptor(ie,mt).enumerable})),Be.push.apply(Be,rt)}return Be}function w(ie){for(var K=1;K<arguments.length;K++){var Be=arguments[K]!=null?arguments[K]:{};K%2?v(Object(Be),!0).forEach(function(rt){y(ie,rt,Be[rt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ie,Object.getOwnPropertyDescriptors(Be)):v(Object(Be)).forEach(function(rt){Object.defineProperty(ie,rt,Object.getOwnPropertyDescriptor(Be,rt))})}return ie}function T(ie){if(Array.isArray(ie))return ie}l("e01a"),l("d28b"),l("e260"),l("d3b7"),l("3ca3"),l("ddb0");function I(ie,K){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(ie)))){var Be=[],rt=!0,mt=!1,zt=void 0;try{for(var en=ie[Symbol.iterator](),bn;!(rt=(bn=en.next()).done)&&(Be.push(bn.value),!(K&&Be.length===K));rt=!0);}catch(Hn){mt=!0,zt=Hn}finally{try{!rt&&en.return!=null&&en.return()}finally{if(mt)throw zt}}return Be}}l("a630"),l("fb6a"),l("b0c0"),l("25f0");function L(ie,K){(K==null||K>ie.length)&&(K=ie.length);for(var Be=0,rt=new Array(K);Be<K;Be++)rt[Be]=ie[Be];return rt}function k(ie,K){if(ie){if(typeof ie=="string")return L(ie,K);var Be=Object.prototype.toString.call(ie).slice(8,-1);if(Be==="Object"&&ie.constructor&&(Be=ie.constructor.name),Be==="Map"||Be==="Set")return Array.from(ie);if(Be==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Be))return L(ie,K)}}function F(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function B(ie,K){return T(ie)||I(ie,K)||k(ie,K)||F()}function G(ie){if(Array.isArray(ie))return L(ie)}function U(ie){if(typeof Symbol<"u"&&Symbol.iterator in Object(ie))return Array.from(ie)}function ee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ne(ie){return G(ie)||U(ie)||k(ie)||ee()}var ye=l("a352"),fe=l.n(ye);function J(ie){ie.parentElement!==null&&ie.parentElement.removeChild(ie)}function Ce(ie,K,Be){var rt=Be===0?ie.children[0]:ie.children[Be-1].nextSibling;ie.insertBefore(K,rt)}var me=l("dbf1");l("13d5"),l("4fad"),l("ac1f"),l("5319");function be(ie){var K=Object.create(null);return function(rt){var mt=K[rt];return mt||(K[rt]=ie(rt))}}var Te=/-(\w)/g,ke=be(function(ie){return ie.replace(Te,function(K,Be){return Be.toUpperCase()})});l("5db7"),l("73d9");var ut=["Start","Add","Remove","Update","End"],et=["Choose","Unchoose","Sort","Filter","Clone"],Et=["Move"],bt=[Et,ut,et].flatMap(function(ie){return ie}).map(function(ie){return"on".concat(ie)}),Qt={manage:Et,manageAndEmit:ut,emit:et};function cn(ie){return bt.indexOf(ie)!==-1}l("caad"),l("2ca0");var pn=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"];function xn(ie){return pn.includes(ie)}function An(ie){return["transition-group","TransitionGroup"].includes(ie)}function kn(ie){return["id","class","role","style"].includes(ie)||ie.startsWith("data-")||ie.startsWith("aria-")||ie.startsWith("on")}function Bn(ie){return ie.reduce(function(K,Be){var rt=B(Be,2),mt=rt[0],zt=rt[1];return K[mt]=zt,K},{})}function Nt(ie){var K=ie.$attrs,Be=ie.componentData,rt=Be===void 0?{}:Be,mt=Bn(Object.entries(K).filter(function(zt){var en=B(zt,2),bn=en[0];return en[1],kn(bn)}));return w(w({},mt),rt)}function We(ie){var K=ie.$attrs,Be=ie.callBackBuilder,rt=Bn(kt(K));Object.entries(Be).forEach(function(zt){var en=B(zt,2),bn=en[0],Hn=en[1];Qt[bn].forEach(function(Pn){rt["on".concat(Pn)]=Hn(Pn)})});var mt="[data-draggable]".concat(rt.draggable||"");return w(w({},rt),{},{draggable:mt})}function kt(ie){return Object.entries(ie).filter(function(K){var Be=B(K,2),rt=Be[0];return Be[1],!kn(rt)}).map(function(K){var Be=B(K,2),rt=Be[0],mt=Be[1];return[ke(rt),mt]}).filter(function(K){var Be=B(K,2),rt=Be[0];return Be[1],!cn(rt)})}l("c740");function Ke(ie,K){if(!(ie instanceof K))throw new TypeError("Cannot call a class as a function")}function ht(ie,K){for(var Be=0;Be<K.length;Be++){var rt=K[Be];rt.enumerable=rt.enumerable||!1,rt.configurable=!0,"value"in rt&&(rt.writable=!0),Object.defineProperty(ie,rt.key,rt)}}function Pt(ie,K,Be){return K&&ht(ie.prototype,K),Be&&ht(ie,Be),ie}var ae=function(K){var Be=K.el;return Be},Ae=function(K,Be){return K.__draggable_context=Be},je=function(K){return K.__draggable_context},tt=function(){function ie(K){var Be=K.nodes,rt=Be.header,mt=Be.default,zt=Be.footer,en=K.root,bn=K.realList;Ke(this,ie),this.defaultNodes=mt,this.children=[].concat(ne(rt),ne(mt),ne(zt)),this.externalComponent=en.externalComponent,this.rootTransition=en.transition,this.tag=en.tag,this.realList=bn}return Pt(ie,[{key:"render",value:function(Be,rt){var mt=this.tag,zt=this.children,en=this._isRootComponent,bn=en?{default:function(){return zt}}:zt;return Be(mt,rt,bn)}},{key:"updated",value:function(){var Be=this.defaultNodes,rt=this.realList;Be.forEach(function(mt,zt){Ae(ae(mt),{element:rt[zt],index:zt})})}},{key:"getUnderlyingVm",value:function(Be){return je(Be)}},{key:"getVmIndexFromDomIndex",value:function(Be,rt){var mt=this.defaultNodes,zt=mt.length,en=rt.children,bn=en.item(Be);if(bn===null)return zt;var Hn=je(bn);if(Hn)return Hn.index;if(zt===0)return 0;var Pn=ae(mt[0]),ue=ne(en).findIndex(function(X){return X===Pn});return Be<ue?0:zt}},{key:"_isRootComponent",get:function(){return this.externalComponent||this.rootTransition}}]),ie}(),pt=l("8bbf");function Tt(ie,K){var Be=ie[K];return Be?Be():[]}function tn(ie){var K=ie.$slots,Be=ie.realList,rt=ie.getKey,mt=Be||[],zt=["header","footer"].map(function(X){return Tt(K,X)}),en=B(zt,2),bn=en[0],Hn=en[1],Pn=K.item;if(!Pn)throw new Error("draggable element must have an item slot");var ue=mt.flatMap(function(X,te){return Pn({element:X,index:te}).map(function(de){return de.key=rt(X),de.props=w(w({},de.props||{}),{},{"data-draggable":!0}),de})});if(ue.length!==mt.length)throw new Error("Item slot must have only one child");return{header:bn,footer:Hn,default:ue}}function Wt(ie){var K=An(ie),Be=!xn(ie)&&!K;return{transition:K,externalComponent:Be,tag:Be?Object(pt.resolveComponent)(ie):K?pt.TransitionGroup:ie}}function qt(ie){var K=ie.$slots,Be=ie.tag,rt=ie.realList,mt=ie.getKey,zt=tn({$slots:K,realList:rt,getKey:mt}),en=Wt(Be);return new tt({nodes:zt,root:en,realList:rt})}function It(ie,K){var Be=this;Object(pt.nextTick)(function(){return Be.$emit(ie.toLowerCase(),K)})}function wn(ie){var K=this;return function(Be,rt){if(K.realList!==null)return K["onDrag".concat(ie)](Be,rt)}}function hn(ie){var K=this,Be=wn.call(this,ie);return function(rt,mt){Be.call(K,rt,mt),It.call(K,ie,rt)}}var En=null,zn={list:{type:Array,required:!1,default:null},modelValue:{type:Array,required:!1,default:null},itemKey:{type:[String,Function],required:!0},clone:{type:Function,default:function(K){return K}},tag:{type:String,default:"div"},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null}},ei=["update:modelValue","change"].concat(ne([].concat(ne(Qt.manageAndEmit),ne(Qt.emit)).map(function(ie){return ie.toLowerCase()}))),ti=Object(pt.defineComponent)({name:"draggable",inheritAttrs:!1,props:zn,emits:ei,data:function(){return{error:!1}},render:function(){try{this.error=!1;var K=this.$slots,Be=this.$attrs,rt=this.tag,mt=this.componentData,zt=this.realList,en=this.getKey,bn=qt({$slots:K,tag:rt,realList:zt,getKey:en});this.componentStructure=bn;var Hn=Nt({$attrs:Be,componentData:mt});return bn.render(pt.h,Hn)}catch(Pn){return this.error=!0,Object(pt.h)("pre",{style:{color:"red"}},Pn.stack)}},created:function(){this.list!==null&&this.modelValue!==null&&me.a.error("modelValue and list props are mutually exclusive! Please set one or another.")},mounted:function(){var K=this;if(!this.error){var Be=this.$attrs,rt=this.$el,mt=this.componentStructure;mt.updated();var zt=We({$attrs:Be,callBackBuilder:{manageAndEmit:function(Hn){return hn.call(K,Hn)},emit:function(Hn){return It.bind(K,Hn)},manage:function(Hn){return wn.call(K,Hn)}}}),en=rt.nodeType===1?rt:rt.parentElement;this._sortable=new fe.a(en,zt),this.targetDomElement=en,en.__draggable_component__=this}},updated:function(){this.componentStructure.updated()},beforeUnmount:function(){this._sortable!==void 0&&this._sortable.destroy()},computed:{realList:function(){var K=this.list;return K||this.modelValue},getKey:function(){var K=this.itemKey;return typeof K=="function"?K:function(Be){return Be[K]}}},watch:{$attrs:{handler:function(K){var Be=this._sortable;Be&&kt(K).forEach(function(rt){var mt=B(rt,2),zt=mt[0],en=mt[1];Be.option(zt,en)})},deep:!0}},methods:{getUnderlyingVm:function(K){return this.componentStructure.getUnderlyingVm(K)||null},getUnderlyingPotencialDraggableComponent:function(K){return K.__draggable_component__},emitChanges:function(K){var Be=this;Object(pt.nextTick)(function(){return Be.$emit("change",K)})},alterList:function(K){if(this.list){K(this.list);return}var Be=ne(this.modelValue);K(Be),this.$emit("update:modelValue",Be)},spliceList:function(){var K=arguments,Be=function(mt){return mt.splice.apply(mt,ne(K))};this.alterList(Be)},updatePosition:function(K,Be){var rt=function(zt){return zt.splice(Be,0,zt.splice(K,1)[0])};this.alterList(rt)},getRelatedContextFromMoveEvent:function(K){var Be=K.to,rt=K.related,mt=this.getUnderlyingPotencialDraggableComponent(Be);if(!mt)return{component:mt};var zt=mt.realList,en={list:zt,component:mt};if(Be!==rt&&zt){var bn=mt.getUnderlyingVm(rt)||{};return w(w({},bn),en)}return en},getVmIndexFromDomIndex:function(K){return this.componentStructure.getVmIndexFromDomIndex(K,this.targetDomElement)},onDragStart:function(K){this.context=this.getUnderlyingVm(K.item),K.item._underlying_vm_=this.clone(this.context.element),En=K.item},onDragAdd:function(K){var Be=K.item._underlying_vm_;if(Be!==void 0){J(K.item);var rt=this.getVmIndexFromDomIndex(K.newIndex);this.spliceList(rt,0,Be);var mt={element:Be,newIndex:rt};this.emitChanges({added:mt})}},onDragRemove:function(K){if(Ce(this.$el,K.item,K.oldIndex),K.pullMode==="clone"){J(K.clone);return}var Be=this.context,rt=Be.index,mt=Be.element;this.spliceList(rt,1);var zt={element:mt,oldIndex:rt};this.emitChanges({removed:zt})},onDragUpdate:function(K){J(K.item),Ce(K.from,K.item,K.oldIndex);var Be=this.context.index,rt=this.getVmIndexFromDomIndex(K.newIndex);this.updatePosition(Be,rt);var mt={element:this.context.element,oldIndex:Be,newIndex:rt};this.emitChanges({moved:mt})},computeFutureIndex:function(K,Be){if(!K.element)return 0;var rt=ne(Be.to.children).filter(function(bn){return bn.style.display!=="none"}),mt=rt.indexOf(Be.related),zt=K.component.getVmIndexFromDomIndex(mt),en=rt.indexOf(En)!==-1;return en||!Be.willInsertAfter?zt:zt+1},onDragMove:function(K,Be){var rt=this.move,mt=this.realList;if(!rt||!mt)return!0;var zt=this.getRelatedContextFromMoveEvent(K),en=this.computeFutureIndex(zt,K),bn=w(w({},this.context),{},{futureIndex:en}),Hn=w(w({},K),{},{relatedContext:zt,draggedContext:bn});return rt(Hn,Be)},onDragEnd:function(){En=null}}}),li=ti;o.default=li},fb6a:function(r,o,l){var s=l("23e7"),d=l("861d"),p=l("e8b5"),y=l("23cb"),v=l("50c4"),w=l("fc6a"),T=l("8418"),I=l("b622"),L=l("1dde"),k=l("ae40"),F=L("slice"),B=k("slice",{ACCESSORS:!0,0:0,1:2}),G=I("species"),U=[].slice,ee=Math.max;s({target:"Array",proto:!0,forced:!F||!B},{slice:function(ye,fe){var J=w(this),Ce=v(J.length),me=y(ye,Ce),be=y(fe===void 0?Ce:fe,Ce),Te,ke,ut;if(p(J)&&(Te=J.constructor,typeof Te=="function"&&(Te===Array||p(Te.prototype))?Te=void 0:d(Te)&&(Te=Te[G],Te===null&&(Te=void 0)),Te===Array||Te===void 0))return U.call(J,me,be);for(ke=new(Te===void 0?Array:Te)(ee(be-me,0)),ut=0;me<be;me++,ut++)me in J&&T(ke,ut,J[me]);return ke.length=ut,ke}})},fc6a:function(r,o,l){var s=l("44ad"),d=l("1d80");r.exports=function(p){return s(d(p))}},fdbc:function(r,o){r.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},fdbf:function(r,o,l){var s=l("4930");r.exports=s&&!Symbol.sham&&typeof Symbol.iterator=="symbol"}}).default})})(nV);var mxe=nV.exports;const MC=u_(mxe),X2=t=>(lu("data-v-ad615bc3"),t=t(),cu(),t),gxe={id:"label",class:"label-container"},yxe=X2(()=>Qe("p",{class:"labelStyle"}," Layer Selection ",-1)),vxe={key:0,id:"display-area",class:"selectlayer-container"},_xe={class:"col"},bxe=X2(()=>Qe("h1",null,"Options",-1)),xxe={class:"col"},wxe=X2(()=>Qe("h1",null,"Active Layers",-1)),Exe={class:"col-trash"},Txe=X2(()=>Qe("h1",null,"Trash",-1)),Sxe={key:1},Cxe="Select Map Layers",Axe=pr({__name:"SelectLayer",props:{mapParams:{}},setup(t){xz(T=>({"4436eb56":r.value}));const e=t,n=Xa(),i=$n(n.findActiveIDX(e.mapParams.mapID,e.mapParams.mapType)!=-1),r=$n("column"),o=$r(ng);Ds(()=>{Ys(()=>{Ri(o,()=>{document.getElementById("display-area").clientWidth>document.getElementById("display-area").clientHeight?r.value="row":r.value="column"},{immediate:!0})})});let l,s,d,p,y;i.value&&(y=n.findActiveIDX(e.mapParams.mapID,e.mapParams.mapType),l=n.deckGLMapState[y]._data.layerList,s=$n(n.deckGLMapState[y]._data.layerList.filter(T=>T.visibility)),d=$n(n.deckGLMapState[y]._data.layerList),p=$n([]));function v(T){n.deckGLMapState[y];let I=T.item.getAttribute("dataID"),L=l.findIndex(k=>k.name==I);l[L].visibility=!0}function w(T){n.deckGLMapState[y];let I=T.item.getAttribute("dataID"),L=l.findIndex(k=>k.name==I);l[L].visibility=!1}return(T,I)=>(le(),Ue(_n,null,[Qe("div",gxe,[yxe,Lt(m_,{direction:"topRight",description:Cxe})]),i.value?(le(),Ue("div",vxe,[Qe("div",_xe,[bxe,Lt(Yt(MC),{modelValue:Yt(d),"onUpdate:modelValue":I[0]||(I[0]=L=>Rr(d)?d.value=L:d=L),"ghost-class":"on-drag",sort:!1,group:{name:"layers",pull:"clone",put:!1},"item-key":"name",animation:"400"},{item:Cn(({element:L})=>[Lt(Lx,{element:L},null,8,["element"])]),_:1},8,["modelValue"])]),Qe("div",xxe,[wxe,Lt(Yt(MC),{modelValue:Yt(s),"onUpdate:modelValue":I[1]||(I[1]=L=>Rr(s)?s.value=L:s=L),group:{name:"layers",pull:!0,put:(L,k,F,B)=>!Array.from(L.el.children).map(G=>G.getAttribute("dataID")).includes(F.getAttribute("dataID"))},onAdd:v,sort:!1,onRemove:w,"ghost-class":"on-drag","item-key":"name",animation:"400"},{item:Cn(({element:L})=>[Lt(Lx,{element:L},null,8,["element"])]),_:1},8,["modelValue","group"])]),Qe("div",Exe,[Txe,Lt(Yt(MC),{modelValue:Yt(p),"onUpdate:modelValue":I[2]||(I[2]=L=>Rr(p)?p.value=L:p=L),"ghost-class":"on-drag",group:{name:"trash",pull:!1,put:!0},"item-key":"name",animation:"400"},{item:Cn(({element:L})=>[Lt(Lx,{class:"trash-element",element:L},null,8,["element"])]),_:1},8,["modelValue"])])])):(le(),Ue("div",Sxe," Found no active map "))],64))}});const pV=po(Axe,[["__scopeId","data-v-ad615bc3"]]),Pxe={class:"h-full flex flex-col"},Ixe={class:"flex-grow"},Mxe=pr({__name:"TabMenuWater",props:{mapParams:{},templateID:{type:Function},preselected:{type:Function}},setup(t){const e=Xa(),n=t;Ea();const i=$n([{label:"Select Map Layers",icon:"pi pi-fw pi-map"}]),r=$n(!0),o=$n(!1);function l(s){s.index==0?(r.value=!0,o.value=!1):s.index==1&&(o.value=!0,r.value=!1)}return(s,d)=>(le(),Ue("div",Pxe,[Lt(Yt(P3),{model:i.value,class:"h-auto",onTabChange:d[0]||(d[0]=p=>l(p))},null,8,["model"]),Qe("div",Ixe,[Yt(e).findActiveIDX(n.mapParams.mapID,n.mapParams.mapType)!=-1?(le(),Rt(pV,{key:0,"map-params":n.mapParams},null,8,["map-params"])):Jt("",!0)])]))}});const jP=po(Mxe,[["__scopeId","data-v-3684e3e3"]]),gF=[{type:"text",id:"Unmet Water Demand",title:"Unmet Water Demand",info:"Net delivery - Applied Water Demand (<code>dnTotVar</code> - <code>awVar</code>)<br> Negative values indicate unmet demand",scales:[{variable:"in Thousand Acre-Feet (TAF)",colorRange:[[255,245,240],[254,225,211],[253,196,173],[252,161,131],[251,125,94],[246,87,63],[227,50,41],[197,25,28],[159,14,21],[108,1,14]],labels:["10","-55","-120","-185","-250"]}]},{type:"text",id:"Difference in Unmet Water Demand",title:"Difference in Unmet Water Demand",info:"Comparing unmet water demand between <code>bl_h000</code> and <code>baseline</code> <br> Specifically, for each demand unit, difference is calculated as <code>unmet_demand_bl_h000 - unmet_demand_baseline</code>",scales:[{variable:"in Thousand Acre-Feet (TAF)",colorRange:[[115,47,128],[154,109,170],[193,164,205],[228,210,230],[239,240,239],[214,238,209],[162,215,158],[92,173,101],[33,120,57],[0,68,27]],labels:["-50","-25","-0","25","50"]}]},{type:"text",id:"Groundwater Data",title:"Groundwater Data",info:"Historical Baseline",scales:[{variable:"in elevations in feet",colorRange:[[227,238,249],[207,225,242],[181,212,233],[147,195,223],[109,174,213],[75,151,201],[47,126,188],[24,100,170],[10,74,144],[8,48,107]],labels:["-250","-12.5","225","462.5","700"]}]}],Rxe=new Uint16Array([0,2,1,0,3,2]),Lxe=new Float32Array([0,1,0,0,1,0,1,1]);function Oxe(t,e){if(!e)return Dxe(t);const n=Math.max(Math.abs(t[0][0]-t[3][0]),Math.abs(t[1][0]-t[2][0])),i=Math.max(Math.abs(t[1][1]-t[0][1]),Math.abs(t[2][1]-t[3][1])),r=Math.ceil(n/e)+1,o=Math.ceil(i/e)+1,l=(r-1)*(o-1)*6,s=new Uint32Array(l),d=new Float32Array(r*o*2),p=new Float64Array(r*o*3);let y=0,v=0;for(let w=0;w<r;w++){const T=w/(r-1);for(let I=0;I<o;I++){const L=I/(o-1),k=kxe(t,T,L);p[y*3+0]=k[0],p[y*3+1]=k[1],p[y*3+2]=k[2]||0,d[y*2+0]=T,d[y*2+1]=1-L,w>0&&I>0&&(s[v++]=y-o,s[v++]=y-o-1,s[v++]=y-1,s[v++]=y-o,s[v++]=y-1,s[v++]=y),y++}}return{vertexCount:l,positions:p,indices:s,texCoords:d}}function Dxe(t){const e=new Float64Array(12);for(let n=0;n<t.length;n++)e[n*3+0]=t[n][0],e[n*3+1]=t[n][1],e[n*3+2]=t[n][2]||0;return{vertexCount:6,positions:e,indices:Rxe,texCoords:Lxe}}function kxe(t,e,n){return Yd(Yd(t[0],t[1],n),Yd(t[3],t[2],n),e)}const Fxe=`
#define SHADER_NAME bitmap-layer-vertex-shader

attribute vec2 texCoords;
attribute vec3 positions;
attribute vec3 positions64Low;

varying vec2 vTexCoord;
varying vec2 vTexPos;

uniform float coordinateConversion;

const vec3 pickingColor = vec3(1.0, 0.0, 0.0);

void main(void) {
  geometry.worldPosition = positions;
  geometry.uv = texCoords;
  geometry.pickingColor = pickingColor;

  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  vTexCoord = texCoords;

  if (coordinateConversion < -0.5) {
    vTexPos = geometry.position.xy + project_uCommonOrigin.xy;
  } else if (coordinateConversion > 0.5) {
    vTexPos = geometry.worldPosition.xy;
  }

  vec4 color = vec4(0.0);
  DECKGL_FILTER_COLOR(color, geometry);
}
`,Bxe=`
vec3 packUVsIntoRGB(vec2 uv) {
  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction
  vec2 uv8bit = floor(uv * 256.);

  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits
  // Scale and clamp to 0-1 range
  vec2 uvFraction = fract(uv * 256.);
  vec2 uvFraction4bit = floor(uvFraction * 16.);

  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates
  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;

  return vec3(uv8bit, fractions) / 255.;
}
`,zxe=`
#define SHADER_NAME bitmap-layer-fragment-shader

#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D bitmapTexture;

varying vec2 vTexCoord;
varying vec2 vTexPos;

uniform float desaturate;
uniform vec4 transparentColor;
uniform vec3 tintColor;
uniform float opacity;

uniform float coordinateConversion;
uniform vec4 bounds;

/* projection utils */
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / PI / 2.0;

// from degrees to Web Mercator
vec2 lnglat_to_mercator(vec2 lnglat) {
  float x = lnglat.x;
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// from Web Mercator to degrees
vec2 mercator_to_lnglat(vec2 xy) {
  xy /= WORLD_SCALE;
  return degrees(vec2(
    xy.x - PI,
    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5
  ));
}
/* End projection utils */

// apply desaturation
vec3 color_desaturate(vec3 color) {
  float luminance = (color.r + color.g + color.b) * 0.333333333;
  return mix(color, vec3(luminance), desaturate);
}

// apply tint
vec3 color_tint(vec3 color) {
  return color * tintColor;
}

// blend with background color
vec4 apply_opacity(vec3 color, float alpha) {
  if (transparentColor.a == 0.0) {
    return vec4(color, alpha);
  }
  float blendedAlpha = alpha + transparentColor.a * (1.0 - alpha);
  float highLightRatio = alpha / blendedAlpha;
  vec3 blendedRGB = mix(transparentColor.rgb, color, highLightRatio);
  return vec4(blendedRGB, blendedAlpha);
}

vec2 getUV(vec2 pos) {
  return vec2(
    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),
    (pos.y - bounds[3]) / (bounds[1] - bounds[3])
  );
}

`.concat(Bxe,`

void main(void) {
  vec2 uv = vTexCoord;
  if (coordinateConversion < -0.5) {
    vec2 lnglat = mercator_to_lnglat(vTexPos);
    uv = getUV(lnglat);
  } else if (coordinateConversion > 0.5) {
    vec2 commonPos = lnglat_to_mercator(vTexPos);
    uv = getUV(commonPos);
  }
  vec4 bitmapColor = texture2D(bitmapTexture, uv);

  gl_FragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);

  geometry.uv = uv;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);

  if (picking_uActive && !picking_uAttribute) {
    // Since instance information is not used, we can use picking color for pixel index
    gl_FragColor.rgb = packUVsIntoRGB(uv);
  }
}
`),Nxe={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:Li.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]},textureParameters:{type:"object",ignore:!0}};class O3 extends Ka{constructor(...e){super(...e),q(this,"state",void 0)}getShaders(){return super.getShaders({vs:Fxe,fs:zxe,modules:[pu,$h]})}initializeState(){const e=this.getAttributeManager();e.remove(["instancePickingColors"]);const n=!0;e.add({indices:{size:1,isIndexed:!0,update:i=>i.value=this.state.mesh.indices,noAlloc:n},positions:{size:3,type:5130,fp64:this.use64bitPositions(),update:i=>i.value=this.state.mesh.positions,noAlloc:n},texCoords:{size:2,update:i=>i.value=this.state.mesh.texCoords,noAlloc:n}})}updateState({props:e,oldProps:n,changeFlags:i}){const r=this.getAttributeManager();if(i.extensionsChanged){var o;const{gl:l}=this.context;(o=this.state.model)===null||o===void 0||o.delete(),this.state.model=this._getModel(l),r.invalidateAll()}if(e.bounds!==n.bounds){const l=this.state.mesh,s=this._createMesh();this.state.model.setVertexCount(s.vertexCount);for(const d in s)l&&l[d]!==s[d]&&r.invalidate(d);this.setState({mesh:s,...this._getCoordinateUniforms()})}else e._imageCoordinateSystem!==n._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(e){const{image:n}=this.props,i=e.info;if(!i.color||!n)return i.bitmap=null,i;const{width:r,height:o}=n;i.index=0;const l=Uxe(i.color),s=[Math.floor(l[0]*r),Math.floor(l[1]*o)];return i.bitmap={size:{width:r,height:o},uv:l,pixel:s},i}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(e){super._updateAutoHighlight({...e,color:this.encodePickingColor(0)})}_createMesh(){const{bounds:e}=this.props;let n=e;return yF(e)&&(n=[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]]]),Oxe(n,this.context.viewport.resolution)}_getModel(e){return e?new Il(e,{...this.getShaders(),id:this.props.id,geometry:new gc({drawMode:4,vertexCount:6}),isInstanced:!1}):null}draw(e){const{uniforms:n,moduleParameters:i}=e,{model:r,coordinateConversion:o,bounds:l,disablePicking:s}=this.state,{image:d,desaturate:p,transparentColor:y,tintColor:v}=this.props;i.pickingActive&&s||d&&r&&r.setUniforms(n).setUniforms({bitmapTexture:d,desaturate:p,transparentColor:y.map(w=>w/255),tintColor:v.slice(0,3).map(w=>w/255),coordinateConversion:o,bounds:l}).draw()}_getCoordinateUniforms(){const{LNGLAT:e,CARTESIAN:n,DEFAULT:i}=Li;let{_imageCoordinateSystem:r}=this.props;if(r!==i){const{bounds:o}=this.props;if(!yF(o))throw new Error("_imageCoordinateSystem only supports rectangular bounds");const l=this.context.viewport.resolution?e:n;if(r=r===e?e:n,r===e&&l===n)return{coordinateConversion:-1,bounds:o};if(r===n&&l===e){const s=Fh([o[0],o[1]]),d=Fh([o[2],o[3]]);return{coordinateConversion:1,bounds:[s[0],s[1],d[0],d[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}q(O3,"layerName","BitmapLayer");q(O3,"defaultProps",Nxe);function Uxe(t){const[e,n,i]=t,r=(i&240)/256,o=(i&15)/16;return[(e+o)/256,(n+r)/256]}function yF(t){return Number.isFinite(t[0])}const Vxe=`#define SHADER_NAME icon-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;
attribute vec4 instanceIconFrames;
attribute float instanceColorModes;
attribute vec2 instanceOffsets;
attribute vec2 instancePixelOffset;

uniform float sizeScale;
uniform vec2 iconsTextureDim;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform bool billboard;
uniform int sizeUnits;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = angle * PI / 180.0;
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;

  vec2 iconSize = instanceIconFrames.zw;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), 
    sizeMinPixels, sizeMaxPixels
  );
  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;
  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
  pixelOffset += instancePixelOffset;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);

  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); 
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }

  vTextureCoords = mix(
    instanceIconFrames.xy,
    instanceIconFrames.xy + iconSize,
    (positions.xy + 1.0) / 2.0
  ) / iconsTextureDim;

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);

  vColorMode = instanceColorModes;
}
`,jxe=`#define SHADER_NAME icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float alphaCutoff;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  vec4 texColor = texture2D(iconsTexture, vTextureCoords);
  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
  float a = texColor.a * opacity * vColor.a;

  if (a < alphaCutoff) {
    discard;
  }

  gl_FragColor = vec4(color, a);
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,$xe=1024,Gxe=4,vF=()=>{},_F={10241:9987,10240:9729,10242:33071,10243:33071};function Hxe(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function Wxe(t,e,n,i){const r=Math.min(n/e.width,i/e.height),o=Math.floor(e.width*r),l=Math.floor(e.height*r);return r===1?{data:e,width:o,height:l}:(t.canvas.height=l,t.canvas.width=o,t.clearRect(0,0,o,l),t.drawImage(e,0,0,e.width,e.height,0,0,o,l),{data:t.canvas,width:o,height:l})}function Lv(t){return t&&(t.id||t.url)}function Kxe(t,e,n,i){const r=t.width,o=t.height,l=new ws(t.gl,{width:e,height:n,parameters:i});return qre(t,l,{targetY:0,width:r,height:o}),t.delete(),l}function bF(t,e,n){for(let i=0;i<e.length;i++){const{icon:r,xOffset:o}=e[i],l=Lv(r);t[l]={...r,x:o,y:n}}}function Xxe({icons:t,buffer:e,mapping:n={},xOffset:i=0,yOffset:r=0,rowHeight:o=0,canvasWidth:l}){let s=[];for(let d=0;d<t.length;d++){const p=t[d],y=Lv(p);if(!n[y]){const{height:v,width:w}=p;i+w+e>l&&(bF(n,s,r),i=0,r=o+r+e,o=0,s=[]),s.push({icon:p,xOffset:i}),i=i+w+e,o=Math.max(o,v)}}return s.length>0&&bF(n,s,r),{mapping:n,rowHeight:o,xOffset:i,yOffset:r,canvasWidth:l,canvasHeight:Hxe(o+r+e)}}function Zxe(t,e,n){if(!t||!e)return null;n=n||{};const i={},{iterable:r,objectInfo:o}=z2(t);for(const l of r){o.index++;const s=e(l,o),d=Lv(s);if(!s)throw new Error("Icon is missing.");if(!s.url)throw new Error("Icon url is missing.");!i[d]&&(!n[d]||s.url!==n[d].url)&&(i[d]={...s,source:l,sourceIndex:o.index})}return i}class qxe{constructor(e,{onUpdate:n=vF,onError:i=vF}){q(this,"gl",void 0),q(this,"onUpdate",void 0),q(this,"onError",void 0),q(this,"_loadOptions",null),q(this,"_texture",null),q(this,"_externalTexture",null),q(this,"_mapping",{}),q(this,"_textureParameters",null),q(this,"_pendingCount",0),q(this,"_autoPacking",!1),q(this,"_xOffset",0),q(this,"_yOffset",0),q(this,"_rowHeight",0),q(this,"_buffer",Gxe),q(this,"_canvasWidth",$xe),q(this,"_canvasHeight",0),q(this,"_canvas",null),this.gl=e,this.onUpdate=n,this.onError=i}finalize(){var e;(e=this._texture)===null||e===void 0||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const n=this._autoPacking?Lv(e):e;return this._mapping[n]||{}}setProps({loadOptions:e,autoPacking:n,iconAtlas:i,iconMapping:r,textureParameters:o}){if(e&&(this._loadOptions=e),n!==void 0&&(this._autoPacking=n),r&&(this._mapping=r),i){var l;(l=this._texture)===null||l===void 0||l.delete(),this._texture=null,this._externalTexture=i}o&&(this._textureParameters=o)}get isLoaded(){return this._pendingCount===0}packIcons(e,n){if(!this._autoPacking||typeof document>"u")return;const i=Object.values(Zxe(e,n,this._mapping)||{});if(i.length>0){const{mapping:r,xOffset:o,yOffset:l,rowHeight:s,canvasHeight:d}=Xxe({icons:i,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=s,this._mapping=r,this._xOffset=o,this._yOffset=l,this._canvasHeight=d,this._texture||(this._texture=new ws(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||_F})),this._texture.height!==this._canvasHeight&&(this._texture=Kxe(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||_F)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(i)}}_loadIcons(e){const n=this._canvas.getContext("2d",{willReadFrequently:!0});for(const i of e)this._pendingCount++,mv(i.url,this._loadOptions).then(r=>{const o=Lv(i),l=this._mapping[o],{x:s,y:d,width:p,height:y}=l,{data:v,width:w,height:T}=Wxe(n,r,p,y);this._texture.setSubImageData({data:v,x:s+(p-w)/2,y:d+(y-T)/2,width:w,height:T}),l.width=w,l.height=T,this._texture.generateMipmap(),this.onUpdate()}).catch(r=>{this.onError({url:i.url,source:i.source,sourceIndex:i.sourceIndex,loadOptions:this._loadOptions,error:r})}).finally(()=>{this._pendingCount--})}}const mV=[0,0,0,255],Yxe={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:mV},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0}};class Gh extends Ka{constructor(...e){super(...e),q(this,"state",void 0)}getShaders(){return super.getShaders({vs:Vxe,fs:jxe,modules:[pu,$h]})}initializeState(){this.state={iconManager:new qxe(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:mV},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:n,oldProps:i,changeFlags:r}=e,o=this.getAttributeManager(),{iconAtlas:l,iconMapping:s,data:d,getIcon:p,textureParameters:y}=n,{iconManager:v}=this.state,w=l||this.internalState.isAsyncPropLoading("iconAtlas");if(v.setProps({loadOptions:n.loadOptions,autoPacking:!w,iconAtlas:l,iconMapping:w?s:null,textureParameters:y}),w?i.iconMapping!==n.iconMapping&&o.invalidate("getIcon"):(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getIcon))&&v.packIcons(d,p),r.extensionsChanged){var T;const{gl:I}=this.context;(T=this.state.model)===null||T===void 0||T.delete(),this.state.model=this._getModel(I),o.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:n,sizeMinPixels:i,sizeMaxPixels:r,sizeUnits:o,billboard:l,alphaCutoff:s}=this.props,{iconManager:d}=this.state,p=d.getTexture();p&&this.state.model.setUniforms(e).setUniforms({iconsTexture:p,iconsTextureDim:[p.width,p.height],sizeUnits:Al[o],sizeScale:n,sizeMinPixels:i,sizeMaxPixels:r,billboard:l,alphaCutoff:s}).draw()}_getModel(e){const n=[-1,-1,-1,1,1,1,1,-1];return new Il(e,{...this.getShaders(),id:this.props.id,geometry:new gc({drawMode:6,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var n;const i=(n=this.getCurrentLayer())===null||n===void 0?void 0:n.props.onIconError;i?i(e):Ti.error(e.error.message)()}getInstanceOffset(e){const{width:n,height:i,anchorX:r=n/2,anchorY:o=i/2}=this.state.iconManager.getIconMapping(e);return[n/2-r,i/2-o]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:n,y:i,width:r,height:o}=this.state.iconManager.getIconMapping(e);return[n,i,r,o]}}q(Gh,"defaultProps",Yxe);q(Gh,"layerName","IconLayer");const Jxe=`#define SHADER_NAME line-layer-vertex-shader

attribute vec3 positions;
attribute vec3 instanceSourcePositions;
attribute vec3 instanceTargetPositions;
attribute vec3 instanceSourcePositions64Low;
attribute vec3 instanceTargetPositions64Low;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;
attribute float instanceWidths;

uniform float opacity;
uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float useShortestPath;
uniform int widthUnits;

varying vec4 vColor;
varying vec2 uv;
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {
  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  return dir_screenspace * offset_direction * width / 2.0;
}

vec3 splitLine(vec3 a, vec3 b, float x) {
  float t = (x - a.x) / (b.x - a.x);
  return vec3(x, mix(a.yz, b.yz, t));
}

void main(void) {
  geometry.worldPosition = instanceSourcePositions;
  geometry.worldPositionAlt = instanceTargetPositions;

  vec3 source_world = instanceSourcePositions;
  vec3 target_world = instanceTargetPositions;
  vec3 source_world_64low = instanceSourcePositions64Low;
  vec3 target_world_64low = instanceTargetPositions64Low;

  if (useShortestPath > 0.5 || useShortestPath < -0.5) {
    source_world.x = mod(source_world.x + 180., 360.0) - 180.;
    target_world.x = mod(target_world.x + 180., 360.0) - 180.;
    float deltaLng = target_world.x - source_world.x;

    if (deltaLng * useShortestPath > 180.) {
      source_world.x += 360. * useShortestPath;
      source_world = splitLine(source_world, target_world, 180. * useShortestPath);
      source_world_64low = vec3(0.0);
    } else if (deltaLng * useShortestPath < -180.) {
      target_world.x += 360. * useShortestPath;
      target_world = splitLine(source_world, target_world, 180. * useShortestPath);
      target_world_64low = vec3(0.0);
    } else if (useShortestPath < 0.) {
      gl_Position = vec4(0.);
      return;
    }
  }
  vec4 source_commonspace;
  vec4 target_commonspace;
  vec4 source = project_position_to_clipspace(source_world, source_world_64low, vec3(0.), source_commonspace);
  vec4 target = project_position_to_clipspace(target_world, target_world_64low, vec3(0.), target_commonspace);
  float segmentIndex = positions.x;
  vec4 p = mix(source, target, segmentIndex);
  geometry.position = mix(source_commonspace, target_commonspace, segmentIndex);
  uv = positions.xy;
  geometry.uv = uv;
  geometry.pickingColor = instancePickingColors;
  float widthPixels = clamp(
    project_size_to_pixel(instanceWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels
  );
  vec3 offset = vec3(
    getExtrusionOffset(target.xy - source.xy, positions.y, widthPixels),
    0.0);
  DECKGL_FILTER_SIZE(offset, geometry);
  DECKGL_FILTER_GL_POSITION(p, geometry);
  gl_Position = p + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);
  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,Qxe=`#define SHADER_NAME line-layer-fragment-shader

precision highp float;

varying vec4 vColor;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,ewe=[0,0,0,255],twe={getSourcePosition:{type:"accessor",value:t=>t.sourcePosition},getTargetPosition:{type:"accessor",value:t=>t.targetPosition},getColor:{type:"accessor",value:ewe},getWidth:{type:"accessor",value:1},widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}};class Z2 extends Ka{getBounds(){var e;return(e=this.getAttributeManager())===null||e===void 0?void 0:e.getBounds(["instanceSourcePositions","instanceTargetPositions"])}getShaders(){return super.getShaders({vs:Jxe,fs:Qxe,modules:[pu,$h]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:i}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(i),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{widthUnits:n,widthScale:i,widthMinPixels:r,widthMaxPixels:o,wrapLongitude:l}=this.props;this.state.model.setUniforms(e).setUniforms({widthUnits:Al[n],widthScale:i,widthMinPixels:r,widthMaxPixels:o,useShortestPath:l?1:0}).draw(),l&&this.state.model.setUniforms({useShortestPath:-1}).draw()}_getModel(e){const n=[0,-1,0,0,1,0,1,-1,0,1,1,0];return new Il(e,{...this.getShaders(),id:this.props.id,geometry:new gc({drawMode:5,attributes:{positions:new Float32Array(n)}}),isInstanced:!0})}}q(Z2,"layerName","LineLayer");q(Z2,"defaultProps",twe);const nwe=`#define SHADER_NAME scatterplot-layer-vertex-shader

attribute vec3 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceRadius;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusScale;
uniform float radiusMinPixels;
uniform float radiusMaxPixels;
uniform float lineWidthScale;
uniform float lineWidthMinPixels;
uniform float lineWidthMaxPixels;
uniform float stroked;
uniform bool filled;
uniform bool antialiasing;
uniform bool billboard;
uniform int radiusUnits;
uniform int lineWidthUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;


void main(void) {
  geometry.worldPosition = instancePositions;
  outerRadiusPixels = clamp(
    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),
    radiusMinPixels, radiusMaxPixels
  );
  float lineWidthPixels = clamp(
    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),
    lineWidthMinPixels, lineWidthMaxPixels
  );
  outerRadiusPixels += stroked * lineWidthPixels / 2.0;
  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
  unitPosition = edgePadding * positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;

  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;
  
  if (billboard) {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = edgePadding * positions * outerRadiusPixels;
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,iwe=`#define SHADER_NAME scatterplot-layer-fragment-shader

precision highp float;

uniform bool filled;
uniform float stroked;
uniform bool antialiasing;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition) * outerRadiusPixels;
  float inCircle = antialiasing ? 
    smoothedge(distToCenter, outerRadiusPixels) : 
    step(distToCenter, outerRadiusPixels);

  if (inCircle == 0.0) {
    discard;
  }

  if (stroked > 0.5) {
    float isLine = antialiasing ? 
      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
      step(innerUnitRadius * outerRadiusPixels, distToCenter);

    if (filled) {
      gl_FragColor = mix(vFillColor, vLineColor, isLine);
    } else {
      if (isLine == 0.0) {
        discard;
      }
      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
    }
  } else if (!filled) {
    discard;
  } else {
    gl_FragColor = vFillColor;
  }

  gl_FragColor.a *= inCircle;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,xF=[0,0,0,255],rwe={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:xF},getLineColor:{type:"accessor",value:xF},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class D3 extends Ka{getShaders(){return super.getShaders({vs:nwe,fs:iwe,modules:[pu,$h]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:i}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(i),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{radiusUnits:n,radiusScale:i,radiusMinPixels:r,radiusMaxPixels:o,stroked:l,filled:s,billboard:d,antialiasing:p,lineWidthUnits:y,lineWidthScale:v,lineWidthMinPixels:w,lineWidthMaxPixels:T}=this.props;this.state.model.setUniforms(e).setUniforms({stroked:l?1:0,filled:s,billboard:d,antialiasing:p,radiusUnits:Al[n],radiusScale:i,radiusMinPixels:r,radiusMaxPixels:o,lineWidthUnits:Al[y],lineWidthScale:v,lineWidthMinPixels:w,lineWidthMaxPixels:T}).draw()}_getModel(e){const n=[-1,-1,0,1,-1,0,1,1,0,-1,1,0];return new Il(e,{...this.getShaders(),id:this.props.id,geometry:new gc({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array(n)}}}),isInstanced:!0})}}q(D3,"defaultProps",rwe);q(D3,"layerName","ScatterplotLayer");const k3={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function F3(t,e,n={}){return owe(t,n)!==e?(awe(t,n),!0):!1}function owe(t,e={}){return Math.sign(swe(t,e))}function swe(t,e={}){const{start:n=0,end:i=t.length}=e,r=e.size||2;let o=0;for(let l=n,s=i-r;l<i;l+=r)o+=(t[l]-t[s])*(t[l+1]+t[s+1]),s=l;return o/2}function awe(t,e){const{start:n=0,end:i=t.length,size:r=2}=e,o=(i-n)/r,l=Math.floor(o/2);for(let s=0;s<l;++s){const d=n+s*r,p=n+(o-1-s)*r;for(let y=0;y<r;++y){const v=t[d+y];t[d+y]=t[p+y],t[p+y]=v}}}function El(t,e){const n=e.length,i=t.length;if(i>0){let r=!0;for(let o=0;o<n;o++)if(t[i-n+o]!==e[o]){r=!1;break}if(r)return!1}for(let r=0;r<n;r++)t[i+r]=e[r];return!0}function $P(t,e){const n=e.length;for(let i=0;i<n;i++)t[i]=e[i]}function Ov(t,e,n,i,r=[]){const o=i+e*n;for(let l=0;l<n;l++)r[l]=t[o+l];return r}function GP(t,e,n,i,r=[]){let o,l;if(n&8)o=(i[3]-t[1])/(e[1]-t[1]),l=3;else if(n&4)o=(i[1]-t[1])/(e[1]-t[1]),l=1;else if(n&2)o=(i[2]-t[0])/(e[0]-t[0]),l=2;else if(n&1)o=(i[0]-t[0])/(e[0]-t[0]),l=0;else return null;for(let s=0;s<t.length;s++)r[s]=(l&1)===s?i[l]:o*(e[s]-t[s])+t[s];return r}function Vx(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function gV(t,e){const{size:n=2,broken:i=!1,gridResolution:r=10,gridOffset:o=[0,0],startIndex:l=0,endIndex:s=t.length}=e||{},d=(s-l)/n;let p=[];const y=[p],v=Ov(t,0,n,l);let w,T;const I=vV(v,r,o,[]),L=[];El(p,v);for(let k=1;k<d;k++){for(w=Ov(t,k,n,l,w),T=Vx(w,I);T;){GP(v,w,T,I,L);const F=Vx(L,I);F&&(GP(v,L,F,I,L),T=F),El(p,L),$P(v,L),cwe(I,r,T),i&&p.length>n&&(p=[],y.push(p),El(p,v)),T=Vx(w,I)}El(p,w),$P(v,w)}return i?y:y[0]}const wF=0,lwe=1;function Jb(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function yV(t,e=null,n){if(!t.length)return[];const{size:i=2,gridResolution:r=10,gridOffset:o=[0,0],edgeTypes:l=!1}=n||{},s=[],d=[{pos:t,types:l?new Array(t.length/i).fill(lwe):null,holes:e||[]}],p=[[],[]];let y=[];for(;d.length;){const{pos:v,types:w,holes:T}=d.shift();uwe(v,i,T[0]||v.length,p),y=vV(p[0],r,o,y);const I=Vx(p[1],y);if(I){let L=EF(v,w,i,0,T[0]||v.length,y,I);const k={pos:L[0].pos,types:L[0].types,holes:[]},F={pos:L[1].pos,types:L[1].types,holes:[]};d.push(k,F);for(let B=0;B<T.length;B++)L=EF(v,w,i,T[B],T[B+1]||v.length,y,I),L[0]&&(k.holes.push(k.pos.length),k.pos=Jb(k.pos,L[0].pos),l&&(k.types=Jb(k.types,L[0].types))),L[1]&&(F.holes.push(F.pos.length),F.pos=Jb(F.pos,L[1].pos),l&&(F.types=Jb(F.types,L[1].types)))}else{const L={positions:v};l&&(L.edgeTypes=w),T.length&&(L.holeIndices=T),s.push(L)}}return s}function EF(t,e,n,i,r,o,l){const s=(r-i)/n,d=[],p=[],y=[],v=[],w=[];let T,I,L;const k=Ov(t,s-1,n,i);let F=Math.sign(l&8?k[1]-o[3]:k[0]-o[2]),B=e&&e[s-1],G=0,U=0;for(let ee=0;ee<s;ee++)T=Ov(t,ee,n,i,T),I=Math.sign(l&8?T[1]-o[3]:T[0]-o[2]),L=e&&e[i/n+ee],I&&F&&F!==I&&(GP(k,T,l,o,w),El(d,w)&&y.push(B),El(p,w)&&v.push(B)),I<=0?(El(d,T)&&y.push(L),G-=I):y.length&&(y[y.length-1]=wF),I>=0?(El(p,T)&&v.push(L),U+=I):v.length&&(v[v.length-1]=wF),$P(k,T),F=I,B=L;return[G?{pos:d,types:e&&y}:null,U?{pos:p,types:e&&v}:null]}function vV(t,e,n,i){const r=Math.floor((t[0]-n[0])/e)*e+n[0],o=Math.floor((t[1]-n[1])/e)*e+n[1];return i[0]=r,i[1]=o,i[2]=r+e,i[3]=o+e,i}function cwe(t,e,n){n&8?(t[1]+=e,t[3]+=e):n&4?(t[1]-=e,t[3]-=e):n&2?(t[0]+=e,t[2]+=e):n&1&&(t[0]-=e,t[2]-=e)}function uwe(t,e,n,i){let r=1/0,o=-1/0,l=1/0,s=-1/0;for(let d=0;d<n;d+=e){const p=t[d],y=t[d+1];r=p<r?p:r,o=p>o?p:o,l=y<l?y:l,s=y>s?y:s}return i[0][0]=r,i[0][1]=l,i[1][0]=o,i[1][1]=s,i}const hwe=85.051129;function dwe(t,e){const{size:n=2,startIndex:i=0,endIndex:r=t.length,normalize:o=!0}=e||{},l=t.slice(i,r);_V(l,n,0,r-i);const s=gV(l,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(o)for(const d of s)bV(d,n);return s}function fwe(t,e=null,n){const{size:i=2,normalize:r=!0,edgeTypes:o=!1}=n||{};e=e||[];const l=[],s=[];let d=0,p=0;for(let v=0;v<=e.length;v++){const w=e[v]||t.length,T=p,I=pwe(t,i,d,w);for(let L=I;L<w;L++)l[p++]=t[L];for(let L=d;L<I;L++)l[p++]=t[L];_V(l,i,T,p),mwe(l,i,T,p,n==null?void 0:n.maxLatitude),d=w,s[v]=p}s.pop();const y=yV(l,s,{size:i,gridResolution:360,gridOffset:[-180,-180],edgeTypes:o});if(r)for(const v of y)bV(v.positions,i);return y}function pwe(t,e,n,i){let r=-1,o=-1;for(let l=n+1;l<i;l+=e){const s=Math.abs(t[l]);s>r&&(r=s,o=l-1)}return o}function mwe(t,e,n,i,r=hwe){const o=t[n],l=t[i-e];if(Math.abs(o-l)>180){const s=Ov(t,0,e,n);s[0]+=Math.round((l-o)/360)*360,El(t,s),s[1]=Math.sign(s[1])*r,El(t,s),s[0]=o,El(t,s)}}function _V(t,e,n,i){let r=t[0],o;for(let l=n;l<i;l+=e){o=t[l];const s=o-r;(s>180||s<-180)&&(o-=Math.round(s/360)*360),t[l]=r=o}}function bV(t,e){let n;const i=t.length/e;for(let o=0;o<i&&(n=t[o*e],(n+180)%360===0);o++);const r=-Math.round(n/360)*360;if(r!==0)for(let o=0;o<i;o++)t[o*e]+=r}class gwe extends gc{constructor(e){const{id:n=dc("column-geometry")}=e,{indices:i,attributes:r}=ywe(e);super({...e,id:n,indices:i,attributes:r})}}function ywe(t){const{radius:e,height:n=1,nradial:i=10}=t;let{vertices:r}=t;r&&(Ti.assert(r.length>=i),r=r.flatMap(T=>[T[0],T[1]]),F3(r,k3.COUNTER_CLOCKWISE));const o=n>0,l=i+1,s=o?l*3+1:i,d=Math.PI*2/i,p=new Uint16Array(o?i*3*2:0),y=new Float32Array(s*3),v=new Float32Array(s*3);let w=0;if(o){for(let T=0;T<l;T++){const I=T*d,L=T%i,k=Math.sin(I),F=Math.cos(I);for(let B=0;B<2;B++)y[w+0]=r?r[L*2]:F*e,y[w+1]=r?r[L*2+1]:k*e,y[w+2]=(1/2-B)*n,v[w+0]=r?r[L*2]:F,v[w+1]=r?r[L*2+1]:k,w+=3}y[w+0]=y[w-3],y[w+1]=y[w-2],y[w+2]=y[w-1],w+=3}for(let T=o?0:1;T<l;T++){const I=Math.floor(T/2)*Math.sign(.5-T%2),L=I*d,k=(I+i)%i,F=Math.sin(L),B=Math.cos(L);y[w+0]=r?r[k*2]:B*e,y[w+1]=r?r[k*2+1]:F*e,y[w+2]=n/2,v[w+2]=1,w+=3}if(o){let T=0;for(let I=0;I<i;I++)p[T++]=I*2+0,p[T++]=I*2+2,p[T++]=I*2+0,p[T++]=I*2+1,p[T++]=I*2+1,p[T++]=I*2+3}return{indices:p,attributes:{POSITION:{size:3,value:y},NORMAL:{size:3,value:v}}}}const vwe=`#version 300 es

#define SHADER_NAME column-layer-vertex-shader

in vec3 positions;
in vec3 normals;

in vec3 instancePositions;
in float instanceElevations;
in vec3 instancePositions64Low;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in float instanceStrokeWidths;

in vec3 instancePickingColors;
uniform float opacity;
uniform float radius;
uniform float angle;
uniform vec2 offset;
uniform bool extruded;
uniform bool stroked;
uniform bool isStroke;
uniform float coverage;
uniform float elevationScale;
uniform float edgeDistance;
uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform int radiusUnits;
uniform int widthUnits;
out vec4 vColor;
#ifdef FLAT_SHADING
out vec4 position_commonspace;
#endif

void main(void) {
  geometry.worldPosition = instancePositions;

  vec4 color = isStroke ? instanceLineColors : instanceFillColors;
  mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
  float elevation = 0.0;
  float strokeOffsetRatio = 1.0;

  if (extruded) {
    elevation = instanceElevations * (positions.z + 1.0) / 2.0 * elevationScale;
  } else if (stroked) {
    float widthPixels = clamp(
      project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
      widthMinPixels, widthMaxPixels) / 2.0;
    float halfOffset = project_pixel_size(widthPixels) / project_size(edgeDistance * coverage * radius);
    if (isStroke) {
      strokeOffsetRatio -= sign(positions.z) * halfOffset;
    } else {
      strokeOffsetRatio -= halfOffset;
    }
  }
  float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);
  float dotRadius = radius * coverage * shouldRender;

  geometry.pickingColor = instancePickingColors;
  vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);
  vec3 centroidPosition64Low = instancePositions64Low;
  vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + offset) * dotRadius;
  if (radiusUnits == UNIT_METERS) {
    offset = project_size(offset);
  }
  vec3 pos = vec3(offset, 0.);
  DECKGL_FILTER_SIZE(pos, geometry);

  gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);
  geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  if (extruded && !isStroke) {
#ifdef FLAT_SHADING
    position_commonspace = geometry.position;
    vColor = vec4(color.rgb, color.a * opacity);
#else
    vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);
    vColor = vec4(lightColor, color.a * opacity);
#endif
  } else {
    vColor = vec4(color.rgb, color.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,_we=`#version 300 es
#define SHADER_NAME column-layer-fragment-shader

precision highp float;

uniform vec3 project_uCameraPosition;
uniform bool extruded;
uniform bool isStroke;

out vec4 fragColor;

in vec4 vColor;
#ifdef FLAT_SHADING
in vec4 position_commonspace;
#endif

void main(void) {
  fragColor = vColor;
#ifdef FLAT_SHADING
  if (extruded && !isStroke && !picking_uActive) {
    vec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
    fragColor.rgb = lighting_getLightColor(vColor.rgb, project_uCameraPosition, position_commonspace.xyz, normal);
  }
#endif
  DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,jw=[0,0,0,255],bwe={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,getPosition:{type:"accessor",value:t=>t.position},getFillColor:{type:"accessor",value:jw},getLineColor:{type:"accessor",value:jw},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class B3 extends Ka{getShaders(){const{gl:e}=this.context,n=!bi(e),i={},r=this.props.flatShading&&R9(e,cr.GLSL_DERIVATIVES);return r&&(i.FLAT_SHADING=1),super.getShaders({vs:vwe,fs:_we,defines:i,transpileToGLSL100:n,modules:[pu,r?Wle:f7,$h]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getFillColor",defaultValue:jw},instanceLineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getLineColor",defaultValue:jw},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState(e){super.updateState(e);const{props:n,oldProps:i,changeFlags:r}=e,o=r.extensionsChanged||n.flatShading!==i.flatShading;if(o){var l;const{gl:s}=this.context;(l=this.state.model)===null||l===void 0||l.delete(),this.state.model=this._getModel(s),this.getAttributeManager().invalidateAll()}(o||n.diskResolution!==i.diskResolution||n.vertices!==i.vertices||(n.extruded||n.stroked)!==(i.extruded||i.stroked))&&this._updateGeometry(n)}getGeometry(e,n,i){const r=new gwe({radius:1,height:i?2:0,vertices:n,nradial:e});let o=0;if(n)for(let l=0;l<e;l++){const s=n[l],d=Math.sqrt(s[0]*s[0]+s[1]*s[1]);o+=d/e}else o=1;return this.setState({edgeDistance:Math.cos(Math.PI/e)*o}),r}_getModel(e){return new Il(e,{...this.getShaders(),id:this.props.id,isInstanced:!0})}_updateGeometry({diskResolution:e,vertices:n,extruded:i,stroked:r}){const o=this.getGeometry(e,n,i||r);this.setState({fillVertexCount:o.attributes.POSITION.value.length/3,wireframeVertexCount:o.indices.value.length}),this.state.model.setProps({geometry:o})}draw({uniforms:e}){const{lineWidthUnits:n,lineWidthScale:i,lineWidthMinPixels:r,lineWidthMaxPixels:o,radiusUnits:l,elevationScale:s,extruded:d,filled:p,stroked:y,wireframe:v,offset:w,coverage:T,radius:I,angle:L}=this.props,{model:k,fillVertexCount:F,wireframeVertexCount:B,edgeDistance:G}=this.state;k.setUniforms(e).setUniforms({radius:I,angle:L/180*Math.PI,offset:w,extruded:d,stroked:y,coverage:T,elevationScale:s,edgeDistance:G,radiusUnits:Al[l],widthUnits:Al[n],widthScale:i,widthMinPixels:r,widthMaxPixels:o}),d&&v&&(k.setProps({isIndexed:!0}),k.setVertexCount(B).setDrawMode(1).setUniforms({isStroke:!0}).draw()),p&&(k.setProps({isIndexed:!1}),k.setVertexCount(F).setDrawMode(5).setUniforms({isStroke:!1}).draw()),!d&&y&&(k.setProps({isIndexed:!1}),k.setVertexCount(F*2/3).setDrawMode(5).setUniforms({isStroke:!0}).draw())}}q(B3,"layerName","ColumnLayer");q(B3,"defaultProps",bwe);const xwe={cellSize:{type:"number",min:0,value:1e3},offset:{type:"array",value:[1,1]}};class q2 extends B3{getGeometry(e){return new bce}draw({uniforms:e}){const{elevationScale:n,extruded:i,offset:r,coverage:o,cellSize:l,angle:s,radiusUnits:d}=this.props;this.state.model.setUniforms(e).setUniforms({radius:l/2,radiusUnits:Al[d],angle:s,offset:r,extruded:i,coverage:o,elevationScale:n,edgeDistance:1,isWireframe:!1}).draw()}}q(q2,"layerName","GridCellLayer");q(q2,"defaultProps",xwe);function wwe(t,e,n,i){let r;if(Array.isArray(t[0])){const o=t.length*e;r=new Array(o);for(let l=0;l<t.length;l++)for(let s=0;s<e;s++)r[l*e+s]=t[l][s]||0}else r=t;return n?gV(r,{size:e,gridResolution:n}):i?dwe(r,{size:e}):r}const Ewe=1,Twe=2,RC=4;class Swe extends H7{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?wwe(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(TF(e)){let i=0;for(const r of e)i+=this.getGeometrySize(r);return i}const n=this.getPathLength(e);return n<2?0:this.isClosed(e)?n<3?0:n+2:n}updateGeometryAttributes(e,n){if(n.geometrySize!==0)if(e&&TF(e))for(const i of e){const r=this.getGeometrySize(i);n.geometrySize=r,this.updateGeometryAttributes(i,n),n.vertexStart+=r}else this._updateSegmentTypes(e,n),this._updatePositions(e,n)}_updateSegmentTypes(e,n){const i=this.attributes.segmentTypes,r=e?this.isClosed(e):!1,{vertexStart:o,geometrySize:l}=n;i.fill(0,o,o+l),r?(i[o]=RC,i[o+l-2]=RC):(i[o]+=Ewe,i[o+l-2]+=Twe),i[o+l-1]=RC}_updatePositions(e,n){const{positions:i}=this.attributes;if(!i||!e)return;const{vertexStart:r,geometrySize:o}=n,l=new Array(3);for(let s=r,d=0;d<o;s++,d++)this.getPointOnPath(e,d,l),i[s*3]=l[0],i[s*3+1]=l[1],i[s*3+2]=l[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,n,i=[]){const{positionSize:r}=this;n*r>=e.length&&(n+=1-e.length/r);const o=n*r;return i[0]=e[o],i[1]=e[o+1],i[2]=r===3&&e[o+2]||0,i}isClosed(e){if(!this.normalize)return!!this.opts.loop;const{positionSize:n}=this,i=e.length-n;return e[0]===e[i]&&e[1]===e[i+1]&&(n===2||e[2]===e[i+2])}}function TF(t){return Array.isArray(t[0])}const Cwe=`#define SHADER_NAME path-layer-vertex-shader

attribute vec2 positions;

attribute float instanceTypes;
attribute vec3 instanceStartPositions;
attribute vec3 instanceEndPositions;
attribute vec3 instanceLeftPositions;
attribute vec3 instanceRightPositions;
attribute vec3 instanceLeftPositions64Low;
attribute vec3 instanceStartPositions64Low;
attribute vec3 instanceEndPositions64Low;
attribute vec3 instanceRightPositions64Low;
attribute float instanceStrokeWidths;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;

uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;

uniform float opacity;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);

float flipIfTrue(bool flag) {
  return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
  vec2 width
) {
  bool isEnd = positions.x > 0.0;
  float sideOfPath = positions.y;
  float isJoint = float(sideOfPath == 0.0);

  vec3 deltaA3 = (currPoint - prevPoint);
  vec3 deltaB3 = (nextPoint - currPoint);

  mat3 rotationMatrix;
  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
  if (needsRotation) {
    deltaA3 = deltaA3 * rotationMatrix;
    deltaB3 = deltaB3 * rotationMatrix;
  }
  vec2 deltaA = deltaA3.xy / width;
  vec2 deltaB = deltaB3.xy / width;

  float lenA = length(deltaA);
  float lenB = length(deltaB);

  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);

  vec2 perpA = vec2(-dirA.y, dirA.x);
  vec2 perpB = vec2(-dirB.y, dirB.x);
  vec2 tangent = dirA + dirB;
  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
  vec2 miterVec = vec2(-tangent.y, tangent.x);
  vec2 dir = isEnd ? dirA : dirB;
  vec2 perp = isEnd ? perpA : perpB;
  float L = isEnd ? lenA : lenB;
  float sinHalfA = abs(dot(miterVec, perp));
  float cosHalfA = abs(dot(dirA, miterVec));
  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
  float cornerPosition = sideOfPath * turnDirection;

  float miterSize = 1.0 / max(sinHalfA, EPSILON);
  miterSize = mix(
    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
    miterSize,
    step(0.0, cornerPosition)
  );

  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
    * (sideOfPath + isJoint * turnDirection);
  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
  bool isCap = isStartCap || isEndCap;
  if (isCap) {
    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
    vJointType = capType;
  } else {
    vJointType = jointType;
  }
  vPathLength = L;
  vCornerOffset = offsetVec;
  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
  vMiterLength = isCap ? isJoint : vMiterLength;

  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
  vPathPosition = vec2(
    dot(offsetFromStartOfPath, perp),
    dot(offsetFromStartOfPath, dir)
  );
  geometry.uv = vPathPosition;

  float isValid = step(instanceTypes, 3.5);
  vec3 offset = vec3(offsetVec * width * isValid, 0.0);

  if (needsRotation) {
    offset = rotationMatrix * offset;
  }
  return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
  if (position.w < EPSILON) {
    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
    position = refPosition + (position - refPosition) * r;
  }
}

void main() {
  geometry.pickingColor = instancePickingColors;

  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);

  float isEnd = positions.x;

  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);

  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);

  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);

  geometry.worldPosition = currPosition;
  vec2 widthPixels = vec2(clamp(
    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels) / 2.0);
  vec3 width;

  if (billboard) {
    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);

    clipLine(prevPositionScreen, currPositionScreen);
    clipLine(nextPositionScreen, currPositionScreen);
    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));

    width = vec3(widthPixels, 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(
      prevPositionScreen.xyz / prevPositionScreen.w,
      currPositionScreen.xyz / currPositionScreen.w,
      nextPositionScreen.xyz / nextPositionScreen.w,
      project_pixel_size_to_clipspace(width.xy)
    );

    DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
    gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
  } else {
    prevPosition = project_position(prevPosition, prevPosition64Low);
    currPosition = project_position(currPosition, currPosition64Low);
    nextPosition = project_position(nextPosition, nextPosition64Low);

    width = vec3(project_pixel_size(widthPixels), 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
    geometry.position = vec4(currPosition + offset, 1.0);
    gl_Position = project_common_position_to_clipspace(geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,Awe=`#define SHADER_NAME path-layer-fragment-shader

precision highp float;

uniform float miterLimit;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

void main(void) {
  geometry.uv = vPathPosition;

  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
      discard;
    }
    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
      discard;
    }
  }
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,xV=[0,0,0,255],Pwe={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:xV},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},LC={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class D_ extends Ka{constructor(...e){super(...e),q(this,"state",void 0)}getShaders(){return super.getShaders({vs:Cwe,fs:Awe,modules:[pu,$h]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:LC,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:LC,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:LC,defaultValue:xV},instancePickingColors:{size:3,type:5121,accessor:(i,{index:r,target:o})=>this.encodePickingColor(i&&i.__source?i.__source.index:r,o)}}),this.setState({pathTesselator:new Swe({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:n,changeFlags:i}=e,r=this.getAttributeManager();if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPath)){const{pathTesselator:s}=this.state,d=n.data.attributes||{};s.updateGeometry({data:n.data,geometryBuffer:d.getPath,buffers:d,normalize:!n._pathType,loop:n._pathType==="loop",getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:i.dataChanged}),this.setState({numInstances:s.instanceCount,startIndices:s.vertexStarts}),i.dataChanged||r.invalidateAll()}if(i.extensionsChanged){var l;const{gl:s}=this.context;(l=this.state.model)===null||l===void 0||l.delete(),this.state.model=this._getModel(s),r.invalidateAll()}}getPickingInfo(e){const n=super.getPickingInfo(e),{index:i}=n,{data:r}=this.props;return r[0]&&r[0].__source&&(n.object=r.find(o=>o.__source.index===i)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let i=0;i<n.length;i++)n[i].__source.index===e&&this._disablePickingIndex(i);else super.disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:n,capRounded:i,billboard:r,miterLimit:o,widthUnits:l,widthScale:s,widthMinPixels:d,widthMaxPixels:p}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(n),capType:Number(i),billboard:r,widthUnits:Al[l],widthScale:s,miterLimit:o,widthMinPixels:d,widthMaxPixels:p}).draw()}_getModel(e){const n=[0,1,2,1,4,2,1,3,4,3,5,4],i=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new Il(e,{...this.getShaders(),id:this.props.id,geometry:new gc({drawMode:4,attributes:{indices:new Uint16Array(n),positions:{value:new Float32Array(i),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateSegmentTypes(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("segmentTypes")}}q(D_,"defaultProps",Pwe);q(D_,"layerName","PathLayer");var z3={exports:{}};z3.exports=Y2;z3.exports.default=Y2;function Y2(t,e,n){n=n||2;var i=e&&e.length,r=i?e[0]*n:t.length,o=wV(t,0,r,n,!0),l=[];if(!o||o.next===o.prev)return l;var s,d,p,y,v,w,T;if(i&&(o=Owe(t,e,o,n)),t.length>80*n){s=p=t[0],d=y=t[1];for(var I=n;I<r;I+=n)v=t[I],w=t[I+1],v<s&&(s=v),w<d&&(d=w),v>p&&(p=v),w>y&&(y=w);T=Math.max(p-s,y-d),T=T!==0?32767/T:0}return Dv(o,l,n,s,d,T,0),l}function wV(t,e,n,i,r){var o,l;if(r===KP(t,e,n,i)>0)for(o=e;o<n;o+=i)l=SF(o,t[o],t[o+1],l);else for(o=n-i;o>=e;o-=i)l=SF(o,t[o],t[o+1],l);return l&&J2(l,l.next)&&(Fv(l),l=l.next),l}function gf(t,e){if(!t)return t;e||(e=t);var n=t,i;do if(i=!1,!n.steiner&&(J2(n,n.next)||io(n.prev,n,n.next)===0)){if(Fv(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function Dv(t,e,n,i,r,o,l){if(t){!l&&o&&zwe(t,i,r,o);for(var s=t,d,p;t.prev!==t.next;){if(d=t.prev,p=t.next,o?Mwe(t,i,r,o):Iwe(t)){e.push(d.i/n|0),e.push(t.i/n|0),e.push(p.i/n|0),Fv(t),t=p.next,s=p.next;continue}if(t=p,t===s){l?l===1?(t=Rwe(gf(t),e,n),Dv(t,e,n,i,r,o,2)):l===2&&Lwe(t,e,n,i,r,o):Dv(gf(t),e,n,i,r,o,1);break}}}}function Iwe(t){var e=t.prev,n=t,i=t.next;if(io(e,n,i)>=0)return!1;for(var r=e.x,o=n.x,l=i.x,s=e.y,d=n.y,p=i.y,y=r<o?r<l?r:l:o<l?o:l,v=s<d?s<p?s:p:d<p?d:p,w=r>o?r>l?r:l:o>l?o:l,T=s>d?s>p?s:p:d>p?d:p,I=i.next;I!==e;){if(I.x>=y&&I.x<=w&&I.y>=v&&I.y<=T&&tm(r,s,o,d,l,p,I.x,I.y)&&io(I.prev,I,I.next)>=0)return!1;I=I.next}return!0}function Mwe(t,e,n,i){var r=t.prev,o=t,l=t.next;if(io(r,o,l)>=0)return!1;for(var s=r.x,d=o.x,p=l.x,y=r.y,v=o.y,w=l.y,T=s<d?s<p?s:p:d<p?d:p,I=y<v?y<w?y:w:v<w?v:w,L=s>d?s>p?s:p:d>p?d:p,k=y>v?y>w?y:w:v>w?v:w,F=HP(T,I,e,n,i),B=HP(L,k,e,n,i),G=t.prevZ,U=t.nextZ;G&&G.z>=F&&U&&U.z<=B;){if(G.x>=T&&G.x<=L&&G.y>=I&&G.y<=k&&G!==r&&G!==l&&tm(s,y,d,v,p,w,G.x,G.y)&&io(G.prev,G,G.next)>=0||(G=G.prevZ,U.x>=T&&U.x<=L&&U.y>=I&&U.y<=k&&U!==r&&U!==l&&tm(s,y,d,v,p,w,U.x,U.y)&&io(U.prev,U,U.next)>=0))return!1;U=U.nextZ}for(;G&&G.z>=F;){if(G.x>=T&&G.x<=L&&G.y>=I&&G.y<=k&&G!==r&&G!==l&&tm(s,y,d,v,p,w,G.x,G.y)&&io(G.prev,G,G.next)>=0)return!1;G=G.prevZ}for(;U&&U.z<=B;){if(U.x>=T&&U.x<=L&&U.y>=I&&U.y<=k&&U!==r&&U!==l&&tm(s,y,d,v,p,w,U.x,U.y)&&io(U.prev,U,U.next)>=0)return!1;U=U.nextZ}return!0}function Rwe(t,e,n){var i=t;do{var r=i.prev,o=i.next.next;!J2(r,o)&&EV(r,i,i.next,o)&&kv(r,o)&&kv(o,r)&&(e.push(r.i/n|0),e.push(i.i/n|0),e.push(o.i/n|0),Fv(i),Fv(i.next),i=t=o),i=i.next}while(i!==t);return gf(i)}function Lwe(t,e,n,i,r,o){var l=t;do{for(var s=l.next.next;s!==l.prev;){if(l.i!==s.i&&Vwe(l,s)){var d=TV(l,s);l=gf(l,l.next),d=gf(d,d.next),Dv(l,e,n,i,r,o,0),Dv(d,e,n,i,r,o,0);return}s=s.next}l=l.next}while(l!==t)}function Owe(t,e,n,i){var r=[],o,l,s,d,p;for(o=0,l=e.length;o<l;o++)s=e[o]*i,d=o<l-1?e[o+1]*i:t.length,p=wV(t,s,d,i,!1),p===p.next&&(p.steiner=!0),r.push(Uwe(p));for(r.sort(Dwe),o=0;o<r.length;o++)n=kwe(r[o],n);return n}function Dwe(t,e){return t.x-e.x}function kwe(t,e){var n=Fwe(t,e);if(!n)return e;var i=TV(n,t);return gf(i,i.next),gf(n,n.next)}function Fwe(t,e){var n=e,i=t.x,r=t.y,o=-1/0,l;do{if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){var s=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&s>o&&(o=s,l=n.x<n.next.x?n:n.next,s===i))return l}n=n.next}while(n!==e);if(!l)return null;var d=l,p=l.x,y=l.y,v=1/0,w;n=l;do i>=n.x&&n.x>=p&&i!==n.x&&tm(r<y?i:o,r,p,y,r<y?o:i,r,n.x,n.y)&&(w=Math.abs(r-n.y)/(i-n.x),kv(n,t)&&(w<v||w===v&&(n.x>l.x||n.x===l.x&&Bwe(l,n)))&&(l=n,v=w)),n=n.next;while(n!==d);return l}function Bwe(t,e){return io(t.prev,t,e.prev)<0&&io(e.next,t,t.next)<0}function zwe(t,e,n,i){var r=t;do r.z===0&&(r.z=HP(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,Nwe(r)}function Nwe(t){var e,n,i,r,o,l,s,d,p=1;do{for(n=t,t=null,o=null,l=0;n;){for(l++,i=n,s=0,e=0;e<p&&(s++,i=i.nextZ,!!i);e++);for(d=p;s>0||d>0&&i;)s!==0&&(d===0||!i||n.z<=i.z)?(r=n,n=n.nextZ,s--):(r=i,i=i.nextZ,d--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,p*=2}while(l>1);return t}function HP(t,e,n,i,r){return t=(t-n)*r|0,e=(e-i)*r|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function Uwe(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function tm(t,e,n,i,r,o,l,s){return(r-l)*(e-s)>=(t-l)*(o-s)&&(t-l)*(i-s)>=(n-l)*(e-s)&&(n-l)*(o-s)>=(r-l)*(i-s)}function Vwe(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!jwe(t,e)&&(kv(t,e)&&kv(e,t)&&$we(t,e)&&(io(t.prev,t,e.prev)||io(t,e.prev,e))||J2(t,e)&&io(t.prev,t,t.next)>0&&io(e.prev,e,e.next)>0)}function io(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function J2(t,e){return t.x===e.x&&t.y===e.y}function EV(t,e,n,i){var r=ex(io(t,e,n)),o=ex(io(t,e,i)),l=ex(io(n,i,t)),s=ex(io(n,i,e));return!!(r!==o&&l!==s||r===0&&Qb(t,n,e)||o===0&&Qb(t,i,e)||l===0&&Qb(n,t,i)||s===0&&Qb(n,e,i))}function Qb(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function ex(t){return t>0?1:t<0?-1:0}function jwe(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&EV(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function kv(t,e){return io(t.prev,t,t.next)<0?io(t,e,t.next)>=0&&io(t,t.prev,e)>=0:io(t,e,t.prev)<0||io(t,t.next,e)<0}function $we(t,e){var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==t);return i}function TV(t,e){var n=new WP(t.i,t.x,t.y),i=new WP(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function SF(t,e,n,i){var r=new WP(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Fv(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function WP(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Y2.deviation=function(t,e,n,i){var r=e&&e.length,o=r?e[0]*n:t.length,l=Math.abs(KP(t,0,o,n));if(r)for(var s=0,d=e.length;s<d;s++){var p=e[s]*n,y=s<d-1?e[s+1]*n:t.length;l-=Math.abs(KP(t,p,y,n))}var v=0;for(s=0;s<i.length;s+=3){var w=i[s]*n,T=i[s+1]*n,I=i[s+2]*n;v+=Math.abs((t[w]-t[I])*(t[T+1]-t[w+1])-(t[w]-t[T])*(t[I+1]-t[w+1]))}return l===0&&v===0?0:Math.abs((v-l)/l)};function KP(t,e,n,i){for(var r=0,o=e,l=n-i;o<n;o+=i)r+=(t[l]-t[o])*(t[o+1]+t[l+1]),l=o;return r}Y2.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var l=0;l<e;l++)n.vertices.push(t[r][o][l]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n};var Gwe=z3.exports;const Hwe=u_(Gwe),tx=k3.CLOCKWISE,CF=k3.COUNTER_CLOCKWISE,xh={isClosed:!0};function Wwe(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function f0(t){return"positions"in t?t.positions:t}function jx(t){return"holeIndices"in t?t.holeIndices:null}function Kwe(t){return Array.isArray(t[0])}function Xwe(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function Zwe(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function qwe(t,e,n,i){for(let r=0;r<e;r++)if(t[n+r]!==t[i-e+r])return!1;return!0}function AF(t,e,n,i,r){let o=e;const l=n.length;for(let s=0;s<l;s++)for(let d=0;d<i;d++)t[o++]=n[s][d]||0;if(!Zwe(n))for(let s=0;s<i;s++)t[o++]=n[0][s]||0;return xh.start=e,xh.end=o,xh.size=i,F3(t,r,xh),o}function PF(t,e,n,i,r=0,o,l){o=o||n.length;const s=o-r;if(s<=0)return e;let d=e;for(let p=0;p<s;p++)t[d++]=n[r+p];if(!qwe(n,i,r,o))for(let p=0;p<i;p++)t[d++]=n[r+p];return xh.start=e,xh.end=d,xh.size=i,F3(t,l,xh),d}function Ywe(t,e){Wwe(t);const n=[],i=[];if("positions"in t){const{positions:r,holeIndices:o}=t;if(o){let l=0;for(let s=0;s<=o.length;s++)l=PF(n,l,r,e,o[s-1],o[s],s===0?tx:CF),i.push(l);return i.pop(),{positions:n,holeIndices:i}}t=r}if(!Kwe(t))return PF(n,0,t,e,0,n.length,tx),n;if(!Xwe(t)){let r=0;for(const[o,l]of t.entries())r=AF(n,r,l,e,o===0?tx:CF),i.push(r);return i.pop(),{positions:n,holeIndices:i}}return AF(n,0,t,e,tx),n}function OC(t,e,n){const i=t.length/3;let r=0;for(let o=0;o<i;o++){const l=(o+1)%i;r+=t[o*3+e]*t[l*3+n],r-=t[l*3+e]*t[o*3+n]}return Math.abs(r/2)}function IF(t,e,n,i){const r=t.length/3;for(let o=0;o<r;o++){const l=o*3,s=t[l+0],d=t[l+1],p=t[l+2];t[l+e]=s,t[l+n]=d,t[l+i]=p}}function Jwe(t,e,n,i){let r=jx(t);r&&(r=r.map(s=>s/e));let o=f0(t);const l=i&&e===3;if(n){const s=o.length;o=o.slice();const d=[];for(let p=0;p<s;p+=e){d[0]=o[p],d[1]=o[p+1],l&&(d[2]=o[p+2]);const y=n(d);o[p]=y[0],o[p+1]=y[1],l&&(o[p+2]=y[2])}}if(l){const s=OC(o,0,1),d=OC(o,0,2),p=OC(o,1,2);if(!s&&!d&&!p)return[];s>d&&s>p||(d>p?(n||(o=o.slice()),IF(o,0,2,1)):(n||(o=o.slice()),IF(o,2,0,1)))}return Hwe(o,r,e)}class Qwe extends H7{constructor(e){const{fp64:n,IndexType:i=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:n?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:i,size:1}}})}get(e){const{attributes:n}=this;return e==="indices"?n.indices&&n.indices.subarray(0,this.vertexCount):n[e]}updateGeometry(e){super.updateGeometry(e);const n=this.buffers.indices;if(n)this.vertexCount=(n.value||n).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const n=Ywe(e,this.positionSize);return this.opts.resolution?yV(f0(n),jx(n),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?fwe(f0(n),jx(n),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):n}return e}getGeometrySize(e){if(MF(e)){let n=0;for(const i of e)n+=this.getGeometrySize(i);return n}return f0(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,n){if(e&&MF(e))for(const i of e){const r=this.getGeometrySize(i);n.geometrySize=r,this.updateGeometryAttributes(i,n),n.vertexStart+=r,n.indexStart=this.indexStarts[n.geometryIndex+1]}else this._updateIndices(e,n),this._updatePositions(e,n),this._updateVertexValid(e,n)}_updateIndices(e,{geometryIndex:n,vertexStart:i,indexStart:r}){const{attributes:o,indexStarts:l,typedArrayManager:s}=this;let d=o.indices;if(!d||!e)return;let p=r;const y=Jwe(e,this.positionSize,this.opts.preproject,this.opts.full3d);d=s.allocate(d,r+y.length,{copy:!0});for(let v=0;v<y.length;v++)d[p++]=y[v]+i;l[n+1]=r+y.length,o.indices=d}_updatePositions(e,{vertexStart:n,geometrySize:i}){const{attributes:{positions:r},positionSize:o}=this;if(!r||!e)return;const l=f0(e);for(let s=n,d=0;d<i;s++,d++){const p=l[d*o],y=l[d*o+1],v=o>2?l[d*o+2]:0;r[s*3]=p,r[s*3+1]=y,r[s*3+2]=v}}_updateVertexValid(e,{vertexStart:n,geometrySize:i}){const{positionSize:r}=this,o=this.attributes.vertexValid,l=e&&jx(e);if(e&&e.edgeTypes?o.set(e.edgeTypes,n):o.fill(1,n,n+i),l)for(let s=0;s<l.length;s++)o[n+l[s]/r-1]=0;o[n+i-1]=0}}function MF(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const SV=`
attribute vec2 vertexPositions;
attribute float vertexValid;

uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;

varying vec4 vColor;

struct PolygonProps {
  vec4 fillColors;
  vec4 lineColors;
  vec3 positions;
  vec3 nextPositions;
  vec3 pickingColors;
  vec3 positions64Low;
  vec3 nextPositions64Low;
  float elevations;
};

vec3 project_offset_normal(vec3 vector) {
  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
    return normalize(vector * project_uCommonUnitsPerWorldUnit);
  }
  return project_normal(vector);
}

void calculatePosition(PolygonProps props) {
#ifdef IS_SIDE_VERTEX
  if(vertexValid < 0.5){
    gl_Position = vec4(0.);
    return;
  }
#endif

  vec3 pos;
  vec3 pos64Low;
  vec3 normal;
  vec4 colors = isWireframe ? props.lineColors : props.fillColors;

  geometry.worldPosition = props.positions;
  geometry.worldPositionAlt = props.nextPositions;
  geometry.pickingColor = props.pickingColors;

#ifdef IS_SIDE_VERTEX
  pos = mix(props.positions, props.nextPositions, vertexPositions.x);
  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);
#else
  pos = props.positions;
  pos64Low = props.positions64Low;
#endif

  if (extruded) {
    pos.z += props.elevations * vertexPositions.y * elevationScale;
  }
  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  if (extruded) {
  #ifdef IS_SIDE_VERTEX
    normal = vec3(
      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),
      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),
      0.0);
    normal = project_offset_normal(normal);
  #else
    normal = project_normal(vec3(0.0, 0.0, 1.0));
  #endif
    geometry.normal = normal;
    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);
    vColor = vec4(lightColor, colors.a * opacity);
  } else {
    vColor = vec4(colors.rgb, colors.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,e2e=`#define SHADER_NAME solid-polygon-layer-vertex-shader

attribute vec3 positions;
attribute vec3 positions64Low;
attribute float elevations;
attribute vec4 fillColors;
attribute vec4 lineColors;
attribute vec3 pickingColors;

`.concat(SV,`

void main(void) {
  PolygonProps props;

  props.positions = positions;
  props.positions64Low = positions64Low;
  props.elevations = elevations;
  props.fillColors = fillColors;
  props.lineColors = lineColors;
  props.pickingColors = pickingColors;

  calculatePosition(props);
}
`),t2e=`#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX


attribute vec3 instancePositions;
attribute vec3 nextPositions;
attribute vec3 instancePositions64Low;
attribute vec3 nextPositions64Low;
attribute float instanceElevations;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

`.concat(SV,`

void main(void) {
  PolygonProps props;

  #if RING_WINDING_ORDER_CW == 1
    props.positions = instancePositions;
    props.positions64Low = instancePositions64Low;
    props.nextPositions = nextPositions;
    props.nextPositions64Low = nextPositions64Low;
  #else
    props.positions = nextPositions;
    props.positions64Low = nextPositions64Low;
    props.nextPositions = instancePositions;
    props.nextPositions64Low = instancePositions64Low;
  #endif
  props.elevations = instanceElevations;
  props.fillColors = instanceFillColors;
  props.lineColors = instanceLineColors;
  props.pickingColors = instancePickingColors;

  calculatePosition(props);
}
`),n2e=`#define SHADER_NAME solid-polygon-layer-fragment-shader

precision highp float;

varying vec4 vColor;

void main(void) {
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,$w=[0,0,0,255],i2e={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:$w},getLineColor:{type:"accessor",value:$w},material:!0},nx={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class N3 extends Ka{constructor(...e){super(...e),q(this,"state",void 0)}getShaders(e){return super.getShaders({vs:e==="top"?e2e:t2e,fs:n2e,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[pu,f7,$h]})}get wrapLongitude(){return!1}initializeState(){const{gl:e,viewport:n}=this.context;let{coordinateSystem:i}=this.props;const{_full3d:r}=this.props;n.isGeospatial&&i===Li.DEFAULT&&(i=Li.LNGLAT);let o;i===Li.LNGLAT&&(r?o=n.projectPosition.bind(n):o=n.projectFlat.bind(n)),this.setState({numInstances:0,polygonTesselator:new Qwe({preproject:o,fp64:this.use64bitPositions(),IndexType:!e||yv(e,cr.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const l=this.getAttributeManager(),s=!0;l.remove(["instancePickingColors"]),l.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:s},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:nx,accessor:"getPolygon",update:this.calculatePositions,noAlloc:s,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:s},elevations:{size:1,transition:nx,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:nx,accessor:"getFillColor",defaultValue:$w,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:nx,accessor:"getLineColor",defaultValue:$w,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(d,{index:p,target:y})=>this.encodePickingColor(d&&d.__source?d.__source.index:p,y),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:i}=n,{data:r}=this.props;return r[0]&&r[0].__source&&(n.object=r.find(o=>o.__source.index===i)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let i=0;i<n.length;i++)n[i].__source.index===e&&this._disablePickingIndex(i);else super.disablePickingIndex(e)}draw({uniforms:e}){const{extruded:n,filled:i,wireframe:r,elevationScale:o}=this.props,{topModel:l,sideModel:s,polygonTesselator:d}=this.state,p={...e,extruded:!!n,elevationScale:o};s&&(s.setInstanceCount(d.instanceCount-1),s.setUniforms(p),r&&(s.setDrawMode(3),s.setUniforms({isWireframe:!0}).draw()),i&&(s.setDrawMode(6),s.setUniforms({isWireframe:!1}).draw())),l&&(l.setVertexCount(d.vertexCount),l.setUniforms(p).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:n,oldProps:i,changeFlags:r}=e,o=this.getAttributeManager();if(r.extensionsChanged||n.filled!==i.filled||n.extruded!==i.extruded){var s;(s=this.state.models)===null||s===void 0||s.forEach(d=>d.delete()),this.setState(this._getModels(this.context.gl)),o.invalidateAll()}}updateGeometry({props:e,oldProps:n,changeFlags:i}){if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPolygon)){const{polygonTesselator:o}=this.state,l=e.data.attributes||{};o.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:l.getPolygon,buffers:l,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:i.dataChanged,full3d:e._full3d}),this.setState({numInstances:o.instanceCount,startIndices:o.vertexStarts}),i.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){const{id:n,filled:i,extruded:r}=this.props;let o,l;if(i){const s=this.getShaders("top");s.defines.NON_INSTANCED_MODEL=1,o=new Il(e,{...s,id:"".concat(n,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return r&&(l=new Il(e,{...this.getShaders("side"),id:"".concat(n,"-side"),geometry:new gc({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),l.userData.excludeAttributes={indices:!0}),{models:[l,o].filter(Boolean),topModel:o,sideModel:l}}calculateIndices(e){const{polygonTesselator:n}=this.state;e.startIndices=n.indexStarts,e.value=n.get("indices")}calculatePositions(e){const{polygonTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}q(N3,"defaultProps",i2e);q(N3,"layerName","SolidPolygonLayer");function r2e({data:t,getIndex:e,dataRange:n,replace:i}){const{startRow:r=0,endRow:o=1/0}=n,l=t.length;let s=l,d=l;for(let w=0;w<l;w++){const T=e(t[w]);if(s>w&&T>=r&&(s=w),T>=o){d=w;break}}let p=s;const v=d-s!==i.length?t.slice(d):void 0;for(let w=0;w<i.length;w++)t[p++]=i[w];if(v){for(let w=0;w<v.length;w++)t[p++]=v[w];t.length=p}return{startRow:s,endRow:s+i.length}}function o2e(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,i=t.featureIds.value[n];return n!==-1?s2e(t,i,n):null}function s2e(t,e,n){const i={properties:{...t.properties[e]}};for(const r in t.numericProps)i.properties[r]=t.numericProps[r].value[n];return i}function a2e(t,e){const n={points:null,lines:null,polygons:null};for(const i in n){const r=t[i].globalFeatureIds.value;n[i]=new Uint8ClampedArray(r.length*3);const o=[];for(let l=0;l<r.length;l++)e(r[l],o),n[i][l*3+0]=o[0],n[i][l*3+1]=o[1],n[i][l*3+2]=o[2]}return n}const l2e=`#define SHADER_NAME multi-icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float gamma;
uniform bool sdf;
uniform float alphaCutoff;
uniform float sdfBuffer;
uniform float outlineBuffer;
uniform vec4 outlineColor;

varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  if (!picking_uActive) {
    float alpha = texture2D(iconsTexture, vTextureCoords).a;
    vec4 color = vColor;
    if (sdf) {
      float distance = alpha;
      alpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);

      if (outlineBuffer > 0.0) {
        float inFill = alpha;
        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);
        color = mix(outlineColor, vColor, inFill);
        alpha = inBorder;
      }
    }
    float a = alpha * color.a;
    
    if (a < alphaCutoff) {
      discard;
    }

    gl_FragColor = vec4(color.rgb, a * opacity);
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,DC=192/256,RF=[],c2e={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};class U3 extends Gh{constructor(...e){super(...e),q(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:l2e}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(n,{index:i,target:r})=>this.encodePickingColor(i,r)}})}updateState(e){super.updateState(e);const{props:n,oldProps:i}=e;let{outlineColor:r}=n;r!==i.outlineColor&&(r=r.map(o=>o/255),r[3]=Number.isFinite(r[3])?r[3]:1,this.setState({outlineColor:r})),!n.sdf&&n.outlineWidth&&Ti.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){const{sdf:n,smoothing:i,outlineWidth:r}=this.props,{outlineColor:o}=this.state,l=r?Math.max(i,DC*(1-r)):-1;if(e.uniforms={...e.uniforms,sdfBuffer:DC,outlineBuffer:l,gamma:i,sdf:!!n,outlineColor:o},super.draw(e),n&&r){const{iconManager:s}=this.state;s.getTexture()&&this.state.model.draw({uniforms:{outlineBuffer:DC}})}}getInstanceOffset(e){return e?Array.from(e).flatMap(n=>super.getInstanceOffset(n)):RF}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(n=>super.getInstanceIconFrame(n)):RF}}q(U3,"defaultProps",c2e);q(U3,"layerName","MultiIconLayer");const $0=1e20;class u2e{constructor({fontSize:e=24,buffer:n=3,radius:i=8,cutoff:r=.25,fontFamily:o="sans-serif",fontWeight:l="normal",fontStyle:s="normal"}={}){this.buffer=n,this.cutoff=r,this.radius=i;const d=this.size=e+n*4,p=this._createCanvas(d),y=this.ctx=p.getContext("2d",{willReadFrequently:!0});y.font=`${s} ${l} ${e}px ${o}`,y.textBaseline="alphabetic",y.textAlign="left",y.fillStyle="black",this.gridOuter=new Float64Array(d*d),this.gridInner=new Float64Array(d*d),this.f=new Float64Array(d),this.z=new Float64Array(d+1),this.v=new Uint16Array(d)}_createCanvas(e){const n=document.createElement("canvas");return n.width=n.height=e,n}draw(e){const{width:n,actualBoundingBoxAscent:i,actualBoundingBoxDescent:r,actualBoundingBoxLeft:o,actualBoundingBoxRight:l}=this.ctx.measureText(e),s=Math.ceil(i),d=0,p=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(l-o))),y=Math.min(this.size-this.buffer,s+Math.ceil(r)),v=p+2*this.buffer,w=y+2*this.buffer,T=Math.max(v*w,0),I=new Uint8ClampedArray(T),L={data:I,width:v,height:w,glyphWidth:p,glyphHeight:y,glyphTop:s,glyphLeft:d,glyphAdvance:n};if(p===0||y===0)return L;const{ctx:k,buffer:F,gridInner:B,gridOuter:G}=this;k.clearRect(F,F,p,y),k.fillText(e,F,F+s);const U=k.getImageData(F,F,p,y);G.fill($0,0,T),B.fill(0,0,T);for(let ee=0;ee<y;ee++)for(let ne=0;ne<p;ne++){const ye=U.data[4*(ee*p+ne)+3]/255;if(ye===0)continue;const fe=(ee+F)*v+ne+F;if(ye===1)G[fe]=0,B[fe]=$0;else{const J=.5-ye;G[fe]=J>0?J*J:0,B[fe]=J<0?J*J:0}}LF(G,0,0,v,w,v,this.f,this.v,this.z),LF(B,F,F,p,y,v,this.f,this.v,this.z);for(let ee=0;ee<T;ee++){const ne=Math.sqrt(G[ee])-Math.sqrt(B[ee]);I[ee]=Math.round(255-255*(ne/this.radius+this.cutoff))}return L}}function LF(t,e,n,i,r,o,l,s,d){for(let p=e;p<e+i;p++)OF(t,n*o+p,o,r,l,s,d);for(let p=n;p<n+r;p++)OF(t,p*o+e,1,i,l,s,d)}function OF(t,e,n,i,r,o,l){o[0]=0,l[0]=-$0,l[1]=$0,r[0]=t[e];for(let s=1,d=0,p=0;s<i;s++){r[s]=t[e+s*n];const y=s*s;do{const v=o[d];p=(r[s]-r[v]+y-v*v)/(s-v)/2}while(p<=l[d]&&--d>-1);d++,o[d]=s,l[d]=p,l[d+1]=$0}for(let s=0,d=0;s<i;s++){for(;l[d+1]<s;)d++;const p=o[d],y=s-p;t[e+s*n]=r[p]+y*y}}const h2e=32,d2e=[];function f2e(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function p2e({characterSet:t,getFontWidth:e,fontHeight:n,buffer:i,maxCanvasWidth:r,mapping:o={},xOffset:l=0,yOffset:s=0}){let d=0,p=l;const y=n+i*2;for(const v of t)if(!o[v]){const w=e(v);p+w+i*2>r&&(p=0,d++),o[v]={x:p+i,y:s+d*y+i,width:w,height:y,layoutWidth:w,layoutHeight:n},p+=w+i*2}return{mapping:o,xOffset:p,yOffset:s+d*y,canvasHeight:f2e(s+(d+1)*y)}}function CV(t,e,n,i){let r=0;for(let l=e;l<n;l++){var o;const s=t[l];r+=((o=i[s])===null||o===void 0?void 0:o.layoutWidth)||0}return r}function AV(t,e,n,i,r,o){let l=e,s=0;for(let d=e;d<n;d++){const p=CV(t,d,d+1,r);s+p>i&&(l<d&&o.push(d),l=d,s=0),s+=p}return s}function m2e(t,e,n,i,r,o){let l=e,s=e,d=e,p=0;for(let y=e;y<n;y++)if((t[y]===" "||t[y+1]===" "||y+1===n)&&(d=y+1),d>s){let v=CV(t,s,d,r);p+v>i&&(l<s&&(o.push(s),l=s,p=0),v>i&&(v=AV(t,s,d,i,r,o),l=o[o.length-1])),s=d,p+=v}return p}function g2e(t,e,n,i,r=0,o){o===void 0&&(o=t.length);const l=[];return e==="break-all"?AV(t,r,o,n,i,l):m2e(t,r,o,n,i,l),l}function y2e(t,e,n,i,r,o){let l=0,s=0;for(let d=e;d<n;d++){const p=t[d],y=i[p];y?(s||(s=y.layoutHeight),r[d]=l+y.layoutWidth/2,l+=y.layoutWidth):(Ti.warn("Missing character: ".concat(p," (").concat(p.codePointAt(0),")"))(),r[d]=l,l+=h2e)}o[0]=l,o[1]=s}function v2e(t,e,n,i,r){const o=Array.from(t),l=o.length,s=new Array(l),d=new Array(l),p=new Array(l),y=(n==="break-word"||n==="break-all")&&isFinite(i)&&i>0,v=[0,0],w=[0,0];let T=0,I=0,L=0;for(let F=0;F<=l;F++){const B=o[F];if((B===`
`||F===l)&&(L=F),L>I){const G=y?g2e(o,n,i,r,I,L):d2e;for(let U=0;U<=G.length;U++){const ee=U===0?I:G[U-1],ne=U<G.length?G[U]:L;y2e(o,ee,ne,r,s,w);for(let ye=ee;ye<ne;ye++){var k;const fe=o[ye],J=((k=r[fe])===null||k===void 0?void 0:k.layoutOffsetY)||0;d[ye]=T+w[1]/2+J,p[ye]=w[0]}T=T+w[1]*e,v[0]=Math.max(v[0],w[0])}I=L}B===`
`&&(s[I]=0,d[I]=0,p[I]=0,I++)}return v[1]=T,{x:s,y:d,rowWidth:p,size:v}}function _2e({value:t,length:e,stride:n,offset:i,startIndices:r,characterSet:o}){const l=t.BYTES_PER_ELEMENT,s=n?n/l:1,d=i?i/l:0,p=r[e]||Math.ceil((t.length-d)/s),y=o&&new Set,v=new Array(e);let w=t;if(s>1||d>0){const T=t.constructor;w=new T(p);for(let I=0;I<p;I++)w[I]=t[I*s+d]}for(let T=0;T<e;T++){const I=r[T],L=r[T+1]||p,k=w.subarray(I,L);v[T]=String.fromCodePoint.apply(null,k),y&&k.forEach(y.add,y)}if(y)for(const T of y)o.add(String.fromCodePoint(T));return{texts:v,characterCount:p}}class PV{constructor(e=5){q(this,"limit",void 0),q(this,"_cache",{}),q(this,"_order",[]),this.limit=e}get(e){const n=this._cache[e];return n&&(this._deleteOrder(e),this._appendOrder(e)),n}set(e,n){this._cache[e]?(this.delete(e),this._cache[e]=n,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=n,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const n=this._order.indexOf(e);n>=0&&this._order.splice(n,1)}_appendOrder(e){this._order.push(e)}}function b2e(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}const xm={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:b2e(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},DF=1024,kF=.9,FF=1.2,IV=3;let Gw=new PV(IV);function x2e(t,e){let n;typeof e=="string"?n=new Set(Array.from(e)):n=new Set(e);const i=Gw.get(t);if(!i)return n;for(const r in i.mapping)n.has(r)&&n.delete(r);return n}function w2e(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function BF(t,e,n,i){t.font="".concat(i," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}function E2e(t){Ti.assert(Number.isFinite(t)&&t>=IV,"Invalid cache limit"),Gw=new PV(t)}class T2e{constructor(){q(this,"props",{...xm}),q(this,"_key",void 0),q(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:e,buffer:n}=this.props;return(e*FF+n*2)/e}setProps(e={}){Object.assign(this.props,e),this._key=this._getKey();const n=x2e(this._key,this.props.characterSet),i=Gw.get(this._key);if(i&&n.size===0){this._atlas!==i&&(this._atlas=i);return}const r=this._generateFontAtlas(n,i);this._atlas=r,Gw.set(this._key,r)}_generateFontAtlas(e,n){const{fontFamily:i,fontWeight:r,fontSize:o,buffer:l,sdf:s,radius:d,cutoff:p}=this.props;let y=n&&n.data;y||(y=document.createElement("canvas"),y.width=DF);const v=y.getContext("2d",{willReadFrequently:!0});BF(v,i,o,r);const{mapping:w,canvasHeight:T,xOffset:I,yOffset:L}=p2e({getFontWidth:k=>v.measureText(k).width,fontHeight:o*FF,buffer:l,characterSet:e,maxCanvasWidth:DF,...n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset}});if(y.height!==T){const k=v.getImageData(0,0,y.width,y.height);y.height=T,v.putImageData(k,0,0)}if(BF(v,i,o,r),s){const k=new u2e({fontSize:o,buffer:l,radius:d,cutoff:p,fontFamily:i,fontWeight:"".concat(r)});for(const F of e){const{data:B,width:G,height:U,glyphTop:ee}=k.draw(F);w[F].width=G,w[F].layoutOffsetY=o*kF-ee;const ne=v.createImageData(G,U);w2e(B,ne),v.putImageData(ne,w[F].x,w[F].y)}}else for(const k of e)v.fillText(k,w[k].x,w[k].y+l+o*kF);return{xOffset:I,yOffset:L,mapping:w,data:y,width:y.width,height:y.height}}_getKey(){const{fontFamily:e,fontWeight:n,fontSize:i,buffer:r,sdf:o,radius:l,cutoff:s}=this.props;return o?"".concat(e," ").concat(n," ").concat(i," ").concat(r," ").concat(l," ").concat(s):"".concat(e," ").concat(n," ").concat(i," ").concat(r)}}const S2e=`#define SHADER_NAME text-background-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec4 instanceRects;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec2 instancePixelOffsets;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform bool billboard;
uniform float opacity;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform vec4 padding;
uniform int sizeUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = radians(angle);
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;
  vLineWidth = instanceLineWidths;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
    sizeMinPixels, sizeMaxPixels
  );

  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;

  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
  pixelOffset += instancePixelOffsets;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,C2e=`#define SHADER_NAME text-background-layer-fragment-shader

precision highp float;

uniform bool stroked;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

void main(void) {
  geometry.uv = uv;

  vec2 pixelPosition = uv * dimensions;
  if (stroked) {
    float distToEdge = min(
      min(pixelPosition.x, dimensions.x - pixelPosition.x),
      min(pixelPosition.y, dimensions.y - pixelPosition.y)
    );
    float isBorder = smoothedge(distToEdge, vLineWidth);
    gl_FragColor = mix(vFillColor, vLineColor, isBorder);
  } else {
    gl_FragColor = vFillColor;
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,A2e={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class V3 extends Ka{constructor(...e){super(...e),q(this,"state",void 0)}getShaders(){return super.getShaders({vs:S2e,fs:C2e,modules:[pu,$h]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:n}=e;if(n.extensionsChanged){var i;const{gl:r}=this.context;(i=this.state.model)===null||i===void 0||i.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{billboard:n,sizeScale:i,sizeUnits:r,sizeMinPixels:o,sizeMaxPixels:l,getLineWidth:s}=this.props;let{padding:d}=this.props;d.length<4&&(d=[d[0],d[1],d[0],d[1]]),this.state.model.setUniforms(e).setUniforms({billboard:n,stroked:!!s,padding:d,sizeUnits:Al[r],sizeScale:i,sizeMinPixels:o,sizeMaxPixels:l}).draw()}_getModel(e){const n=[0,0,1,0,1,1,0,1];return new Il(e,{...this.getShaders(),id:this.props.id,geometry:new gc({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}}q(V3,"defaultProps",A2e);q(V3,"layerName","TextBackgroundLayer");const zF={start:1,middle:0,end:-1},NF={top:1,center:0,bottom:-1},kC=[0,0,0,255],P2e=1,I2e={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:kC},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:xm.characterSet},fontFamily:xm.fontFamily,fontWeight:xm.fontWeight,lineHeight:P2e,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:kC},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:kC},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class Q2 extends C_{constructor(...e){super(...e),q(this,"state",void 0),q(this,"getBoundingRect",(n,i)=>{let{size:[r,o]}=this.transformParagraph(n,i);const{fontSize:l}=this.state.fontAtlasManager.props;r/=l,o/=l;const{getTextAnchor:s,getAlignmentBaseline:d}=this.props,p=zF[typeof s=="function"?s(n,i):s],y=NF[typeof d=="function"?d(n,i):d];return[(p-1)*r/2,(y-1)*o/2,r,o]}),q(this,"getIconOffsets",(n,i)=>{const{getTextAnchor:r,getAlignmentBaseline:o}=this.props,{x:l,y:s,rowWidth:d,size:[p,y]}=this.transformParagraph(n,i),v=zF[typeof r=="function"?r(n,i):r],w=NF[typeof o=="function"?o(n,i):o],T=l.length,I=new Array(T*2);let L=0;for(let k=0;k<T;k++){const F=(1-v)*(p-d[k])/2;I[L++]=(v-1)*p/2+F+l[k],I[L++]=(w-1)*y/2+s[k]}return I})}initializeState(){this.state={styleVersion:0,fontAtlasManager:new T2e},this.props.maxWidth>0&&Ti.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){const{props:n,oldProps:i,changeFlags:r}=e;(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||n.lineHeight!==i.lineHeight||n.wordBreak!==i.wordBreak||n.maxWidth!==i.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:n,fontWeight:i}=this.props,{fontAtlasManager:r,characterSet:o}=this.state,l={...e,characterSet:o,fontFamily:n,fontWeight:i};if(!r.mapping)return r.setProps(l),!0;for(const s in l)if(l[s]!==r.props[s])return r.setProps(l),!0;return!1}_updateText(){var e;const{data:n,characterSet:i}=this.props,r=(e=n.attributes)===null||e===void 0?void 0:e.getText;let{getText:o}=this.props,l=n.startIndices,s;const d=i==="auto"&&new Set;if(r&&l){const{texts:p,characterCount:y}=_2e({...ArrayBuffer.isView(r)?{value:r}:r,length:n.length,startIndices:l,characterSet:d});s=y,o=(v,{index:w})=>p[w]}else{const{iterable:p,objectInfo:y}=z2(n);l=[0],s=0;for(const v of p){y.index++;const w=Array.from(o(v,y)||"");d&&w.forEach(d.add,d),s+=w.length,l.push(s)}}this.setState({getText:o,startIndices:l,numInstances:s,characterSet:d||i})}transformParagraph(e,n){const{fontAtlasManager:i}=this.state,r=i.mapping,o=this.state.getText,{wordBreak:l,lineHeight:s,maxWidth:d}=this.props,p=o(e,n)||"";return v2e(p,s,l,d*i.props.fontSize,r)}renderLayers(){const{startIndices:e,numInstances:n,getText:i,fontAtlasManager:{scale:r,texture:o,mapping:l},styleVersion:s}=this.state,{data:d,_dataDiff:p,getPosition:y,getColor:v,getSize:w,getAngle:T,getPixelOffset:I,getBackgroundColor:L,getBorderColor:k,getBorderWidth:F,backgroundPadding:B,background:G,billboard:U,fontSettings:ee,outlineWidth:ne,outlineColor:ye,sizeScale:fe,sizeUnits:J,sizeMinPixels:Ce,sizeMaxPixels:me,transitions:be,updateTriggers:Te}=this.props,ke=this.getSubLayerClass("characters",U3),ut=this.getSubLayerClass("background",V3);return[G&&new ut({getFillColor:L,getLineColor:k,getLineWidth:F,padding:B,getPosition:y,getSize:w,getAngle:T,getPixelOffset:I,billboard:U,sizeScale:fe,sizeUnits:J,sizeMinPixels:Ce,sizeMaxPixels:me,transitions:be&&{getPosition:be.getPosition,getAngle:be.getAngle,getSize:be.getSize,getFillColor:be.getBackgroundColor,getLineColor:be.getBorderColor,getLineWidth:be.getBorderWidth,getPixelOffset:be.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:Te.getPosition,getAngle:Te.getAngle,getSize:Te.getSize,getFillColor:Te.getBackgroundColor,getLineColor:Te.getBorderColor,getLineWidth:Te.getBorderWidth,getPixelOffset:Te.getPixelOffset,getBoundingRect:{getText:Te.getText,getTextAnchor:Te.getTextAnchor,getAlignmentBaseline:Te.getAlignmentBaseline,styleVersion:s}}}),{data:d.attributes&&d.attributes.background?{length:d.length,attributes:d.attributes.background}:d,_dataDiff:p,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new ke({sdf:ee.sdf,smoothing:Number.isFinite(ee.smoothing)?ee.smoothing:xm.smoothing,outlineWidth:ne/(ee.radius||xm.radius),outlineColor:ye,iconAtlas:o,iconMapping:l,getPosition:y,getColor:v,getSize:w,getAngle:T,getPixelOffset:I,billboard:U,sizeScale:fe*r,sizeUnits:J,sizeMinPixels:Ce*r,sizeMaxPixels:me*r,transitions:be&&{getPosition:be.getPosition,getAngle:be.getAngle,getColor:be.getColor,getSize:be.getSize,getPixelOffset:be.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:Te.getText,getPosition:Te.getPosition,getAngle:Te.getAngle,getColor:Te.getColor,getSize:Te.getSize,getPixelOffset:Te.getPixelOffset,getIconOffsets:{getTextAnchor:Te.getTextAnchor,getAlignmentBaseline:Te.getAlignmentBaseline,styleVersion:s}}}),{data:d,_dataDiff:p,startIndices:e,numInstances:n,getIconOffsets:this.getIconOffsets,getIcon:i})]}static set fontAtlasCacheLimit(e){E2e(e)}}q(Q2,"defaultProps",I2e);q(Q2,"layerName","TextLayer");const $x={circle:{type:D3,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:Gh,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:Q2,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},Gx={type:D_,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},XP={type:N3,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function Gy({type:t,props:e}){const n={};for(const i in e)n[i]=t.defaultProps[e[i]];return n}function FC(t,e){const{transitions:n,updateTriggers:i}=t.props,r={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const o in e){const l=e[o];let s=t.props[o];o.startsWith("get")&&(s=t.getSubLayerAccessor(s),r.updateTriggers[l]=i[o],n&&(r.transitions[l]=n[o])),r[l]=s}return r}function M2e(t){if(Array.isArray(t))return t;switch(Ti.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return Ti.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}function UF(t,e,n={}){const i={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:r=0,endRow:o=t.length}=n;for(let l=r;l<o;l++){const s=t[l],{geometry:d}=s;if(d)if(d.type==="GeometryCollection"){Ti.assert(Array.isArray(d.geometries),"GeoJSON does not have geometries array");const{geometries:p}=d;for(let y=0;y<p.length;y++){const v=p[y];VF(v,i,e,s,l)}}else VF(d,i,e,s,l)}return i}function VF(t,e,n,i,r){const{type:o,coordinates:l}=t,{pointFeatures:s,lineFeatures:d,polygonFeatures:p,polygonOutlineFeatures:y}=e;if(!L2e(o,l)){Ti.warn("".concat(o," coordinates are malformed"))();return}switch(o){case"Point":s.push(n({geometry:t},i,r));break;case"MultiPoint":l.forEach(v=>{s.push(n({geometry:{type:"Point",coordinates:v}},i,r))});break;case"LineString":d.push(n({geometry:t},i,r));break;case"MultiLineString":l.forEach(v=>{d.push(n({geometry:{type:"LineString",coordinates:v}},i,r))});break;case"Polygon":p.push(n({geometry:t},i,r)),l.forEach(v=>{y.push(n({geometry:{type:"LineString",coordinates:v}},i,r))});break;case"MultiPolygon":l.forEach(v=>{p.push(n({geometry:{type:"Polygon",coordinates:v}},i,r)),v.forEach(w=>{y.push(n({geometry:{type:"LineString",coordinates:w}},i,r))})});break}}const R2e={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function L2e(t,e){let n=R2e[t];for(Ti.assert(n,"Unknown GeoJSON type ".concat(t));e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}function MV(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function ix(t){return t.geometry.coordinates}function O2e(t,e){const n=MV(),{pointFeatures:i,lineFeatures:r,polygonFeatures:o,polygonOutlineFeatures:l}=t;return n.points.data=i,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=ix,n.lines.data=r,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=ix,n.polygons.data=o,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=ix,n.polygonsOutline.data=l,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=ix,n}function D2e(t,e){const n=MV(),{points:i,lines:r,polygons:o}=t,l=a2e(t,e);return n.points.data={length:i.positions.value.length/i.positions.size,attributes:{...i.attributes,getPosition:i.positions,instancePickingColors:{size:3,value:l.points}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines.data={length:r.pathIndices.value.length-1,startIndices:r.pathIndices.value,attributes:{...r.attributes,getPath:r.positions,instancePickingColors:{size:3,value:l.lines}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines._pathType="open",n.polygons.data={length:o.polygonIndices.value.length-1,startIndices:o.polygonIndices.value,attributes:{...o.attributes,getPolygon:o.positions,pickingColors:{size:3,value:l.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygons._normalize=!1,o.triangles&&(n.polygons.data.attributes.indices=o.triangles.value),n.polygonsOutline.data={length:o.primitivePolygonIndices.value.length-1,startIndices:o.primitivePolygonIndices.value,attributes:{...o.attributes,getPath:o.positions,instancePickingColors:{size:3,value:l.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygonsOutline._pathType="open",n}const k2e=["points","linestrings","polygons"],F2e={...Gy($x.circle),...Gy($x.icon),...Gy($x.text),...Gy(Gx),...Gy(XP),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class Gc extends C_{initializeState(){this.state={layerProps:{},features:{}}}updateState({props:e,changeFlags:n}){if(!n.dataChanged)return;const{data:i}=this.props,r=i&&"points"in i&&"polygons"in i&&"lines"in i;this.setState({binary:r}),r?this._updateStateBinary({props:e,changeFlags:n}):this._updateStateJSON({props:e,changeFlags:n})}_updateStateBinary({props:e,changeFlags:n}){const i=D2e(e.data,this.encodePickingColor);this.setState({layerProps:i})}_updateStateJSON({props:e,changeFlags:n}){const i=M2e(e.data),r=this.getSubLayerRow.bind(this);let o={};const l={};if(Array.isArray(n.dataChanged)){const d=this.state.features;for(const p in d)o[p]=d[p].slice(),l[p]=[];for(const p of n.dataChanged){const y=UF(i,r,p);for(const v in d)l[v].push(r2e({data:o[v],getIndex:w=>w.__source.index,dataRange:p,replace:y[v]}))}}else o=UF(i,r);const s=O2e(o,l);this.setState({features:o,featuresDiff:l,layerProps:s})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:i,sourceLayer:r}=n;return n.featureType=k2e.find(o=>r.id.startsWith("".concat(this.id,"-").concat(o,"-"))),i>=0&&r.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(n.index=this.props.data.points.globalFeatureIds.value[i]),n}_updateAutoHighlight(e){const n="".concat(this.id,"-points-"),i=e.featureType==="points";for(const r of this.getSubLayers())r.id.startsWith(n)===i&&r.updateAutoHighlight(e)}_renderPolygonLayer(){const{extruded:e,wireframe:n}=this.props,{layerProps:i}=this.state,r="polygons-fill",o=this.shouldRenderSubLayer(r,i.polygons.data)&&this.getSubLayerClass(r,XP.type);if(o){const l=FC(this,XP.props),s=e&&n;return s||delete l.getLineColor,l.updateTriggers.lineColors=s,new o(l,this.getSubLayerProps({id:r,updateTriggers:l.updateTriggers}),i.polygons)}return null}_renderLineLayers(){const{extruded:e,stroked:n}=this.props,{layerProps:i}=this.state,r="polygons-stroke",o="linestrings",l=!e&&n&&this.shouldRenderSubLayer(r,i.polygonsOutline.data)&&this.getSubLayerClass(r,Gx.type),s=this.shouldRenderSubLayer(o,i.lines.data)&&this.getSubLayerClass(o,Gx.type);if(l||s){const d=FC(this,Gx.props);return[l&&new l(d,this.getSubLayerProps({id:r,updateTriggers:d.updateTriggers}),i.polygonsOutline),s&&new s(d,this.getSubLayerProps({id:o,updateTriggers:d.updateTriggers}),i.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:n,binary:i}=this.state;let{highlightedObjectIndex:r}=this.props;!i&&Number.isFinite(r)&&(r=n.points.data.findIndex(s=>s.__source.index===r));const o=new Set(e.split("+")),l=[];for(const s of o){const d="points-".concat(s),p=$x[s],y=p&&this.shouldRenderSubLayer(d,n.points.data)&&this.getSubLayerClass(d,p.type);if(y){const v=FC(this,p.props);let w=n.points;if(s==="text"&&i){const{instancePickingColors:T,...I}=w.data.attributes;w={...w,data:{...w.data,attributes:I}}}l.push(new y(v,this.getSubLayerProps({id:d,updateTriggers:v.updateTriggers,highlightedObjectIndex:r}),w))}}return l}renderLayers(){const{extruded:e}=this.props,n=this._renderPolygonLayer(),i=this._renderLineLayers(),r=this._renderPointLayers();return[!e&&n,i,r,e&&n]}getSubLayerAccessor(e){const{binary:n}=this.state;return!n||typeof e!="function"?super.getSubLayerAccessor(e):(i,r)=>{const{data:o,index:l}=r,s=o2e(o,l);return e(s,r)}}}q(Gc,"layerName","GeoJsonLayer");q(Gc,"defaultProps",F2e);class j3 extends Gh{initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({})}updateState({props:e,oldProps:n,changeFlags:i}){super.updateState({props:e,oldProps:n,changeFlags:i})}draw(e){super.draw({...e})}}const B2e={};j3.defaultProps={...Gh.defaultProps,...B2e};class RV{constructor(e,n,i){this.useMapStore=Xa(),this.useDataStore=Rs(),this.attrs=s_(),this.mapParams=e,this.editorParams=n,this.animatedProps={},this.staticLayers=this.getAllStaticLayers(i),this.data={},this.parseData()}parseData(){let e=this.useDataStore.getData("water","unmetdemand"),n=this.useDataStore.getData("water","groundwater"),i=this.useDataStore.getData("water","shapes");i.demand_units.features=i.demand_units.features.filter(d=>d.properties.DU_ID in e.baseline);let r=i.demand_units.features.map(d=>({...d,properties:{unmetDemand:Object.values(e.baseline[d.properties.DU_ID])}})),o=i.demand_units.features.map(d=>({...d,properties:{unmetDemand:Object.values(e.scenario[d.properties.DU_ID])}})),l=i.demand_units.features.map(d=>{let p=Object.values(e.baseline[d.properties.DU_ID]);return{...d,properties:{difference:Object.values(e.scenario[d.properties.DU_ID]).map((y,v)=>y-p[v])}}}),s=i.groundwater.features.map(d=>({...d,properties:{groundwater:Object.values(n.baseline[d.properties.elem_id])}}));this.data.baseline=r,this.data.comparison=o,this.data.difference=l,this.data.baselineGroundwater=s}getAllStaticLayers(e){return[]}getCurrentStaticLayers(e){}getAllLayerProps(e,n,i,r,o,l,s){this.getCurrentStaticLayers(e);let d=[];e.forEach(G=>{G.animated&&G.visibility&&d.push(G.name)});let p=Object.entries(this.animatedProps).filter(([G,U])=>G.startsWith("Animated")?d.includes(U.id.split("_")[0]):!0),y=Object.fromEntries(p),v=Object.entries(y).map(([G,U])=>{if(G.startsWith("Icons")){if(r=="Viewing")return new Gh({...U,visible:n>=U.time,sizeScale:U.highlighted?8:4,updateTriggers:{iconAtlas:o.value,sizeScale:U.highlighted}});if(r=="Editing")return new j3({...U,sizeScale:U.highlighted?8:4,onDragStart:(ee,ne)=>{s.setProps({controller:{dragPan:!1}}),l.value=!0},onDragEnd:(ee,ne)=>{s.setProps({controller:!0}),l.value=!1},visible:n>=U.time,updateTriggers:{getPosition:l.value,sizeScale:U.highlighted}});throw"Unrecognized mapMode in getAllLayerProps"}else throw"Error in animate"});const w=G=>DP(jc().domain([-250,10]).range([1,0])(G)).replace(/[^\d,]/g,"").split(",").map(U=>Number(U)),T=G=>R1e(jc().domain([-250,700]).range([0,1])(G)).replace(/[^\d,]/g,"").split(",").map(U=>Number(U));let I=Math.round(n*1200),L=new Gc({id:"Baseline",data:this.data.baseline,filled:!0,extruded:!1,pickable:!0,getFillColor:G=>w(G.properties.unmetDemand[I]),getLineColor:[0,0,0,255],getLineWidth:100,opacity:.5,updateTriggers:{getFillColor:n}}),k=new Gc({id:"Comparison",data:this.data.comparison,filled:!0,extruded:!1,pickable:!0,getFillColor:G=>w(G.properties.unmetDemand[I]),getLineColor:[0,0,0,255],getLineWidth:100,opacity:.5,updateTriggers:{getFillColor:n}}),F=new Gc({id:"Difference",data:this.data.difference,filled:!0,extruded:!1,pickable:!0,getFillColor:[255,255,255,255],getLineColor:[0,0,0,255],getLineWidth:100,opacity:.5,updateTriggers:{getFillColor:n}}),B=new Gc({id:"BaselineGroundwater",data:this.data.baselineGroundwater,filled:!0,extruded:!1,pickable:!0,getFillColor:G=>T(G.properties.groundwater[I]),getLineColor:[255,255,255,0],getLineWidth:100,opacity:.5,updateTriggers:{getFillColor:n}});return d.includes("Baseline deliveries")&&v.push(L),d.includes("bl_h000 deliveries")&&v.push(k),d.includes("Difference in deliveries (bl_h000 - baseline)")&&v.push(F),d.includes("Baseline GW deliveries")&&v.push(B),v.concat(this.staticLayers)}getInitialViewState(){return{longitude:-122,latitude:39,zoom:9,pitch:60,bearing:30}}getTimeScales(){const e="10/31/1921",n="9/30/2021";let i=Qd().range([new Date(e),new Date(n)]).domain([0,1]),r=Qd().domain([new Date(e),new Date(n)]).range([0,1]);return[i,r]}buildSettings(){return{}}handleSettings(e,n,i,r){return i.value==!0&&(n=n.map(o=>o.id==r.value.id.toString()?o.clone({iconAtlas:"https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/icon-atlas.png"}):o)),n}setupSettings(){const e=gF;e.forEach(n=>{"options"in n&&n.options.forEach(i=>{e[i.emitVal]=i.default})})}getTimeSliderScaleParams(){const e="10/31/1921",n="9/30/2021";return[Qd().domain([new Date(e),new Date(n)]),Vh.every(5),"%Y"]}formatTimeString(e){return`${e.toLocaleString("default",{month:"short"})} ${e.getFullYear()}`}getInfoPanelSettings(){return gF}}const z2e={id:"fireComparison-container",class:"fireComparison-container"},N2e={class:"flex justify-center items-center fixed bottom-1 left-1/2 transform -translate-x-1/2 bg-gray-600 text-white px-4 rounded-md z-10"},U2e={class:"card flex justify-content-center"},V2e={class:"card flex justify-content-center"},j2e=pr({__name:"WaterComparison",props:{LeftMapParams:{type:Object,default(){return{mapType:"single-water",mapID:"0",annotations:[]}}},RightMapParams:{type:Object,default(){return{mapType:"single-water",mapID:"1",annotations:[]}}},leftPreselected:{type:String,default:""},rightPreselected:{type:String,default:""}},setup(t){const e=$n(!0);Os(ng,e);const n=()=>{e.value=!e.value},i=Xa(),r=kP.ComparisonRight,o=kP.ComparisonLeft,l=$n(!1),s=$n(!1);Os(V2,RV);const d=t;return Ds(()=>{const p=i.findActiveIDX(d.LeftMapParams.mapID,d.LeftMapParams.mapType),y=i.findActiveIDX(d.RightMapParams.mapID,d.RightMapParams.mapType);Ri(i.deckGLMapState[p]._viewState,v=>{l.value&&i.changeViewStateIDX(y,v)}),Ri(i.deckGLMapState[y]._viewState,v=>{l.value&&i.changeViewStateIDX(p,v)}),Ri(()=>i.deckGLMapState[p]._data.currentTime,v=>{s.value&&i.changeTimeIDX(y,v)}),Ri(()=>i.deckGLMapState[y]._data.currentTime,v=>{s.value&&i.changeTimeIDX(p,v)})}),(p,y)=>(le(),Ue(_n,null,[Qe("div",z2e,[Lt(Yt(mm),{style:{height:"100%"},onResizeend:n},{default:Cn(()=>[Lt(Yt(gl),{class:"leftDashboard"},{default:Cn(()=>[Lt(Yt(mm),{layout:"vertical"},{default:Cn(()=>[Lt(Yt(gl),{size:1},{default:Cn(()=>[Lt(jP,{mapParams:t.LeftMapParams,templateID:Yt(r),preselected:t.leftPreselected},null,8,["mapParams","templateID","preselected"])]),_:1}),Lt(Yt(gl),null,{default:Cn(()=>[Lt(FP,{"map-type":t.LeftMapParams.mapType,"map-i-d":t.LeftMapParams.mapID,"template-i-d":Yt(r),annotations:t.LeftMapParams.annotations,SM:!1},null,8,["map-type","map-i-d","template-i-d","annotations"])]),_:1})]),_:1})]),_:1}),Lt(Yt(gl),{class:"rightDashboard",size:50},{default:Cn(()=>[Lt(Yt(mm),{layout:"vertical"},{default:Cn(()=>[Lt(Yt(gl),{size:5},{default:Cn(()=>[Lt(jP,{mapParams:t.RightMapParams,templateID:Yt(o),preselected:t.rightPreselected},null,8,["mapParams","templateID","preselected"])]),_:1}),Lt(Yt(gl),null,{default:Cn(()=>[Lt(FP,{"map-type":t.RightMapParams.mapType,"map-i-d":t.RightMapParams.mapID,"template-i-d":Yt(o),annotations:t.RightMapParams.annotations,SM:!1},null,8,["map-type","map-i-d","template-i-d","annotations"])]),_:1})]),_:1})]),_:1})]),_:1})]),Qe("div",N2e,[vo(" Map Controls: "),Qe("div",U2e,[Lt(Yt(NA),{modelValue:l.value,"onUpdate:modelValue":y[0]||(y[0]=v=>l.value=v),"on-label":"Map Viewport Synced","off-label":"Viewport Sync Off"},null,8,["modelValue"])]),Qe("div",V2e,[Lt(Yt(NA),{modelValue:s.value,"onUpdate:modelValue":y[1]||(y[1]=v=>s.value=v),"on-label":"Map Time Synced","off-label":"Time Sync Off"},null,8,["modelValue"])])])],64))}});const $2e=po(j2e,[["__scopeId","data-v-c95a321f"]]);const G2e={},H2e=t=>(lu("data-v-81b96eca"),t=t(),cu(),t),W2e={id:"nofire"},K2e=H2e(()=>Qe("h1",{style:{width:"100%"}}," No Fire Selected ",-1)),X2e=[K2e];function Z2e(t,e){return le(),Ue("div",W2e,X2e)}const q2e=po(G2e,[["render",Z2e],["__scopeId","data-v-81b96eca"]]),Y2e=t=>(lu("data-v-d646f8cd"),t=t(),cu(),t),J2e={id:"singleFire-container",class:"h-full flex flex-col"},Q2e={id:"singleFire-label",class:"label-container"},eEe=Y2e(()=>Qe("p",{class:"labelStyle"}," Single Fire ",-1)),tEe={id:"singleFire-content",class:"flex-grow"},nEe="Single Fire",iEe=pr({__name:"SingleFire",props:{mapType:{},mapID:{},templateID:{},annotations:{}},setup(t){const e=t,n=Ea(),i=Xa(),r=n.fire[e.templateID],[o,l]=i.getMapStateComponents(e.mapID,e.mapType);let s=new ube(r.id,e.annotations);i.addDeckMapState(new hbe(o,l,s));const d=Ao({mapType:e.mapType,mapID:e.mapID,templateID:e.templateID,fireID:r.id,annotations:e.annotations});Os(mu,d);const p=ur(()=>i.isDataReady(e.mapID,e.mapType,"perimeter")&&i.isDataReady(e.mapID,e.mapType,"frp")&&i.isDataReady(e.mapID,e.mapType,"roads"));return bf(()=>{i.deactivateMapState(e.mapType,e.mapID),n.validFire[e.templateID]=!1}),(y,v)=>(le(),Ue("div",J2e,[Qe("div",Q2e,[eEe,Lt(m_,{direction:"topRight",description:nEe})]),Qe("div",tEe,[p.value?(le(),Rt(eV,{key:0})):(le(),Rt(tV,{key:1}))])]))}});const rEe=po(iEe,[["__scopeId","data-v-d646f8cd"]]);var LV={name:"ArrowDownIcon",extends:mo,computed:{pathId:function(){return"pv_icon_clip_".concat(Gr())}}},oEe=["clipPath"],sEe=Qe("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.99994 14C6.91097 14.0004 6.82281 13.983 6.74064 13.9489C6.65843 13.9148 6.58387 13.8646 6.52133 13.8013L1.10198 8.38193C0.982318 8.25351 0.917175 8.08367 0.920272 7.90817C0.923368 7.73267 0.994462 7.56523 1.11858 7.44111C1.24269 7.317 1.41014 7.2459 1.58563 7.2428C1.76113 7.23971 1.93098 7.30485 2.0594 7.42451L6.32263 11.6877V0.677419C6.32263 0.497756 6.394 0.325452 6.52104 0.198411C6.64808 0.0713706 6.82039 0 7.00005 0C7.17971 0 7.35202 0.0713706 7.47906 0.198411C7.6061 0.325452 7.67747 0.497756 7.67747 0.677419V11.6877L11.9407 7.42451C12.0691 7.30485 12.2389 7.23971 12.4144 7.2428C12.5899 7.2459 12.7574 7.317 12.8815 7.44111C13.0056 7.56523 13.0767 7.73267 13.0798 7.90817C13.0829 8.08367 13.0178 8.25351 12.8981 8.38193L7.47875 13.8013C7.41621 13.8646 7.34164 13.9148 7.25944 13.9489C7.17727 13.983 7.08912 14.0004 7.00015 14C7.00012 14 7.00009 14 7.00005 14C7.00001 14 6.99998 14 6.99994 14Z",fill:"currentColor"},null,-1),aEe=[sEe],lEe=["id"],cEe=Qe("rect",{width:"14",height:"14",fill:"white"},null,-1),uEe=[cEe];function hEe(t,e,n,i,r,o){return le(),Ue("svg",Le({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),[Qe("g",{clipPath:"url(#".concat(o.pathId,")")},aEe,8,oEe),Qe("defs",null,[Qe("clipPath",{id:"".concat(o.pathId)},uEe,8,lEe)])],16)}LV.render=hEe;var OV={name:"ArrowUpIcon",extends:mo,computed:{pathId:function(){return"pv_icon_clip_".concat(Gr())}}},dEe=["clipPath"],fEe=Qe("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.51551 13.799C6.64205 13.9255 6.813 13.9977 6.99193 14C7.17087 13.9977 7.34182 13.9255 7.46835 13.799C7.59489 13.6725 7.66701 13.5015 7.66935 13.3226V2.31233L11.9326 6.57554C11.9951 6.63887 12.0697 6.68907 12.1519 6.72319C12.2341 6.75731 12.3223 6.77467 12.4113 6.77425C12.5003 6.77467 12.5885 6.75731 12.6707 6.72319C12.7529 6.68907 12.8274 6.63887 12.89 6.57554C13.0168 6.44853 13.0881 6.27635 13.0881 6.09683C13.0881 5.91732 13.0168 5.74514 12.89 5.61812L7.48846 0.216594C7.48274 0.210436 7.4769 0.204374 7.47094 0.198411C7.3439 0.0713707 7.1716 0 6.99193 0C6.81227 0 6.63997 0.0713707 6.51293 0.198411C6.50704 0.204296 6.50128 0.210278 6.49563 0.216354L1.09386 5.61812C0.974201 5.74654 0.909057 5.91639 0.912154 6.09189C0.91525 6.26738 0.986345 6.43483 1.11046 6.55894C1.23457 6.68306 1.40202 6.75415 1.57752 6.75725C1.75302 6.76035 1.92286 6.6952 2.05128 6.57554L6.31451 2.31231V13.3226C6.31685 13.5015 6.38898 13.6725 6.51551 13.799Z",fill:"currentColor"},null,-1),pEe=[fEe],mEe=["id"],gEe=Qe("rect",{width:"14",height:"14",fill:"white"},null,-1),yEe=[gEe];function vEe(t,e,n,i,r,o){return le(),Ue("svg",Le({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),[Qe("g",{clipPath:"url(#".concat(o.pathId,")")},pEe,8,dEe),Qe("defs",null,[Qe("clipPath",{id:"".concat(o.pathId)},yEe,8,mEe)])],16)}OV.render=vEe;function Bv(t){"@babel/helpers - typeof";return Bv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bv(t)}function _Ee(t,e,n){return e=bEe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bEe(t){var e=xEe(t,"string");return Bv(e)==="symbol"?e:String(e)}function xEe(t,e){if(Bv(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Bv(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var wEe=`
@layer primevue {
    .p-paginator-default {
        display: flex;
    }

    .p-paginator {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-wrap: wrap;
    }

    .p-paginator-left-content {
        margin-right: auto;
    }

    .p-paginator-right-content {
        margin-left: auto;
    }

    .p-paginator-page,
    .p-paginator-next,
    .p-paginator-last,
    .p-paginator-first,
    .p-paginator-prev,
    .p-paginator-current {
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        line-height: 1;
        user-select: none;
        overflow: hidden;
        position: relative;
    }

    .p-paginator-element:focus {
        z-index: 1;
        position: relative;
    }
}
`,EEe={paginator:function(e){var n=e.instance,i=e.key;return["p-paginator p-component",_Ee({"p-paginator-default":!n.hasBreakpoints()},"p-paginator-".concat(i),n.hasBreakpoints())]},start:"p-paginator-left-content",end:"p-paginator-right-content",firstPageButton:function(e){var n=e.instance;return["p-paginator-first p-paginator-element p-link",{"p-disabled":n.$attrs.disabled}]},firstPageIcon:"p-paginator-icon",previousPageButton:function(e){var n=e.instance;return["p-paginator-prev p-paginator-element p-link",{"p-disabled":n.$attrs.disabled}]},previousPageIcon:"p-paginator-icon",nextPageButton:function(e){var n=e.instance;return["p-paginator-next p-paginator-element p-link",{"p-disabled":n.$attrs.disabled}]},nextPageIcon:"p-paginator-icon",lastPageButton:function(e){var n=e.instance;return["p-paginator-last p-paginator-element p-link",{"p-disabled":n.$attrs.disabled}]},lastPageIcon:"p-paginator-icon",pages:"p-paginator-pages",pageButton:function(e){var n=e.props,i=e.pageLink;return["p-paginator-page p-paginator-element p-link",{"p-highlight":i-1===n.page}]},current:"p-paginator-current",rowPerPageDropdown:"p-paginator-rpp-options",jumpToPageDropdown:"p-paginator-page-options",jumpToPageInput:"p-paginator-page-input"},TEe=_o.extend({name:"paginator",css:wEe,classes:EEe}),DV={name:"AngleDoubleLeftIcon",extends:mo},SEe=Qe("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M5.71602 11.164C5.80782 11.2021 5.9063 11.2215 6.00569 11.221C6.20216 11.2301 6.39427 11.1612 6.54025 11.0294C6.68191 10.8875 6.76148 10.6953 6.76148 10.4948C6.76148 10.2943 6.68191 10.1021 6.54025 9.96024L3.51441 6.9344L6.54025 3.90855C6.624 3.76126 6.65587 3.59011 6.63076 3.42254C6.60564 3.25498 6.525 3.10069 6.40175 2.98442C6.2785 2.86815 6.11978 2.79662 5.95104 2.7813C5.78229 2.76598 5.61329 2.80776 5.47112 2.89994L1.97123 6.39983C1.82957 6.54167 1.75 6.73393 1.75 6.9344C1.75 7.13486 1.82957 7.32712 1.97123 7.46896L5.47112 10.9991C5.54096 11.0698 5.62422 11.1259 5.71602 11.164ZM11.0488 10.9689C11.1775 11.1156 11.3585 11.2061 11.5531 11.221C11.7477 11.2061 11.9288 11.1156 12.0574 10.9689C12.1815 10.8302 12.25 10.6506 12.25 10.4645C12.25 10.2785 12.1815 10.0989 12.0574 9.96024L9.03158 6.93439L12.0574 3.90855C12.1248 3.76739 12.1468 3.60881 12.1204 3.45463C12.0939 3.30045 12.0203 3.15826 11.9097 3.04765C11.7991 2.93703 11.6569 2.86343 11.5027 2.83698C11.3486 2.81053 11.19 2.83252 11.0488 2.89994L7.51865 6.36957C7.37699 6.51141 7.29742 6.70367 7.29742 6.90414C7.29742 7.1046 7.37699 7.29686 7.51865 7.4387L11.0488 10.9689Z",fill:"currentColor"},null,-1),CEe=[SEe];function AEe(t,e,n,i,r,o){return le(),Ue("svg",Le({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),CEe,16)}DV.render=AEe;var kV={name:"AngleDownIcon",extends:mo},PEe=Qe("path",{d:"M3.58659 4.5007C3.68513 4.50023 3.78277 4.51945 3.87379 4.55723C3.9648 4.59501 4.04735 4.65058 4.11659 4.7207L7.11659 7.7207L10.1166 4.7207C10.2619 4.65055 10.4259 4.62911 10.5843 4.65956C10.7427 4.69002 10.8871 4.77074 10.996 4.88976C11.1049 5.00877 11.1726 5.15973 11.1889 5.32022C11.2052 5.48072 11.1693 5.6422 11.0866 5.7807L7.58659 9.2807C7.44597 9.42115 7.25534 9.50004 7.05659 9.50004C6.85784 9.50004 6.66722 9.42115 6.52659 9.2807L3.02659 5.7807C2.88614 5.64007 2.80725 5.44945 2.80725 5.2507C2.80725 5.05195 2.88614 4.86132 3.02659 4.7207C3.09932 4.64685 3.18675 4.58911 3.28322 4.55121C3.37969 4.51331 3.48305 4.4961 3.58659 4.5007Z",fill:"currentColor"},null,-1),IEe=[PEe];function MEe(t,e,n,i,r,o){return le(),Ue("svg",Le({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),IEe,16)}kV.render=MEe;var FV={name:"AngleUpIcon",extends:mo},REe=Qe("path",{d:"M10.4134 9.49931C10.3148 9.49977 10.2172 9.48055 10.1262 9.44278C10.0352 9.405 9.95263 9.34942 9.88338 9.27931L6.88338 6.27931L3.88338 9.27931C3.73811 9.34946 3.57409 9.3709 3.41567 9.34044C3.25724 9.30999 3.11286 9.22926 3.00395 9.11025C2.89504 8.99124 2.82741 8.84028 2.8111 8.67978C2.79478 8.51928 2.83065 8.35781 2.91338 8.21931L6.41338 4.71931C6.55401 4.57886 6.74463 4.49997 6.94338 4.49997C7.14213 4.49997 7.33276 4.57886 7.47338 4.71931L10.9734 8.21931C11.1138 8.35994 11.1927 8.55056 11.1927 8.74931C11.1927 8.94806 11.1138 9.13868 10.9734 9.27931C10.9007 9.35315 10.8132 9.41089 10.7168 9.44879C10.6203 9.48669 10.5169 9.5039 10.4134 9.49931Z",fill:"currentColor"},null,-1),LEe=[REe];function OEe(t,e,n,i,r,o){return le(),Ue("svg",Le({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),LEe,16)}FV.render=OEe;var DEe={root:function(e){var n=e.instance,i=e.props;return["p-inputtext p-component",{"p-filled":n.filled,"p-inputtext-sm":i.size==="small","p-inputtext-lg":i.size==="large"}]}},kEe=_o.extend({name:"inputtext",classes:DEe}),FEe={name:"BaseInputText",extends:Ni,props:{modelValue:null,size:{type:String,default:null}},style:kEe,provide:function(){return{$parentInstance:this}}},Hw={name:"InputText",extends:FEe,emits:["update:modelValue"],methods:{onInput:function(e){this.$emit("update:modelValue",e.target.value)}},computed:{filled:function(){return this.modelValue!=null&&this.modelValue.toString().length>0},ptmParams:function(){return{context:{filled:this.filled,disabled:this.$attrs.disabled||this.$attrs.disabled===""}}}}},BEe=["value"];function zEe(t,e,n,i,r,o){return le(),Ue("input",Le({class:t.cx("root"),value:t.modelValue,onInput:e[0]||(e[0]=function(){return o.onInput&&o.onInput.apply(o,arguments)})},t.ptm("root",o.ptmParams),{"data-pc-name":"inputtext"}),null,16,BEe)}Hw.render=zEe;var NEe=`
@layer primevue {
    .p-inputnumber {
        display: inline-flex;
    }

    .p-inputnumber-button {
        display: flex;
        align-items: center;
        justify-content: center;
        flex: 0 0 auto;
    }

    .p-inputnumber-buttons-stacked .p-button.p-inputnumber-button .p-button-label,
    .p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button .p-button-label {
        display: none;
    }

    .p-inputnumber-buttons-stacked .p-button.p-inputnumber-button-up {
        border-top-left-radius: 0;
        border-bottom-left-radius: 0;
        border-bottom-right-radius: 0;
        padding: 0;
    }

    .p-inputnumber-buttons-stacked .p-inputnumber-input {
        border-top-right-radius: 0;
        border-bottom-right-radius: 0;
    }

    .p-inputnumber-buttons-stacked .p-button.p-inputnumber-button-down {
        border-top-left-radius: 0;
        border-top-right-radius: 0;
        border-bottom-left-radius: 0;
        padding: 0;
    }

    .p-inputnumber-buttons-stacked .p-inputnumber-button-group {
        display: flex;
        flex-direction: column;
    }

    .p-inputnumber-buttons-stacked .p-inputnumber-button-group .p-button.p-inputnumber-button {
        flex: 1 1 auto;
    }

    .p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button-up {
        order: 3;
        border-top-left-radius: 0;
        border-bottom-left-radius: 0;
    }

    .p-inputnumber-buttons-horizontal .p-inputnumber-input {
        order: 2;
        border-radius: 0;
    }

    .p-inputnumber-buttons-horizontal .p-button.p-inputnumber-button-down {
        order: 1;
        border-top-right-radius: 0;
        border-bottom-right-radius: 0;
    }

    .p-inputnumber-buttons-vertical {
        flex-direction: column;
    }

    .p-inputnumber-buttons-vertical .p-button.p-inputnumber-button-up {
        order: 1;
        border-bottom-left-radius: 0;
        border-bottom-right-radius: 0;
        width: 100%;
    }

    .p-inputnumber-buttons-vertical .p-inputnumber-input {
        order: 2;
        border-radius: 0;
        text-align: center;
    }

    .p-inputnumber-buttons-vertical .p-button.p-inputnumber-button-down {
        order: 3;
        border-top-left-radius: 0;
        border-top-right-radius: 0;
        width: 100%;
    }

    .p-inputnumber-input {
        flex: 1 1 auto;
    }

    .p-fluid .p-inputnumber {
        width: 100%;
    }

    .p-fluid .p-inputnumber .p-inputnumber-input {
        width: 1%;
    }

    .p-fluid .p-inputnumber-buttons-vertical .p-inputnumber-input {
        width: 100%;
    }
}
`,UEe={root:function(e){var n=e.instance,i=e.props;return["p-inputnumber p-component p-inputwrapper",{"p-inputwrapper-filled":n.filled,"p-inputwrapper-focus":n.focused,"p-inputnumber-buttons-stacked":i.showButtons&&i.buttonLayout==="stacked","p-inputnumber-buttons-horizontal":i.showButtons&&i.buttonLayout==="horizontal","p-inputnumber-buttons-vertical":i.showButtons&&i.buttonLayout==="vertical"}]},input:"p-inputnumber-input",buttonGroup:"p-inputnumber-button-group",incrementButton:function(e){var n=e.instance,i=e.props;return["p-inputnumber-button p-inputnumber-button-up",{"p-disabled":i.showButtons&&i.max!==null&&n.maxBoundry()}]},decrementButton:function(e){var n=e.instance,i=e.props;return["p-inputnumber-button p-inputnumber-button-down",{"p-disabled":i.showButtons&&i.min!==null&&n.minBoundry()}]}},VEe=_o.extend({name:"inputnumber",css:NEe,classes:UEe}),jEe={name:"BaseInputNumber",extends:Ni,props:{modelValue:{type:Number,default:null},format:{type:Boolean,default:!0},showButtons:{type:Boolean,default:!1},buttonLayout:{type:String,default:"stacked"},incrementButtonClass:{type:String,default:null},decrementButtonClass:{type:String,default:null},incrementButtonIcon:{type:String,default:void 0},decrementButtonIcon:{type:String,default:void 0},locale:{type:String,default:void 0},localeMatcher:{type:String,default:void 0},mode:{type:String,default:"decimal"},prefix:{type:String,default:null},suffix:{type:String,default:null},currency:{type:String,default:void 0},currencyDisplay:{type:String,default:void 0},useGrouping:{type:Boolean,default:!0},minFractionDigits:{type:Number,default:void 0},maxFractionDigits:{type:Number,default:void 0},min:{type:Number,default:null},max:{type:Number,default:null},step:{type:Number,default:1},allowEmpty:{type:Boolean,default:!0},highlightOnFocus:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},placeholder:{type:String,default:null},inputId:{type:String,default:null},inputClass:{type:[String,Object],default:null},inputStyle:{type:Object,default:null},inputProps:{type:null,default:null},incrementButtonProps:{type:null,default:null},decrementButtonProps:{type:null,default:null},"aria-labelledby":{type:String,default:null},"aria-label":{type:String,default:null}},style:VEe,provide:function(){return{$parentInstance:this}}};function zv(t){"@babel/helpers - typeof";return zv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zv(t)}function jF(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function $F(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?jF(Object(n),!0).forEach(function(i){$Ee(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):jF(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function $Ee(t,e,n){return e=GEe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GEe(t){var e=HEe(t,"string");return zv(e)==="symbol"?e:String(e)}function HEe(t,e){if(zv(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(zv(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function WEe(t){return qEe(t)||ZEe(t)||XEe(t)||KEe()}function KEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XEe(t,e){if(t){if(typeof t=="string")return ZP(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ZP(t,e)}}function ZEe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function qEe(t){if(Array.isArray(t))return ZP(t)}function ZP(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var G0={name:"InputNumber",extends:jEe,emits:["update:modelValue","input","focus","blur"],numberFormat:null,_numeral:null,_decimal:null,_group:null,_minusSign:null,_currency:null,_suffix:null,_prefix:null,_index:null,groupChar:"",isSpecialChar:null,prefixChar:null,suffixChar:null,timer:null,data:function(){return{d_modelValue:this.modelValue,focused:!1}},watch:{modelValue:function(e){this.d_modelValue=e},locale:function(e,n){this.updateConstructParser(e,n)},localeMatcher:function(e,n){this.updateConstructParser(e,n)},mode:function(e,n){this.updateConstructParser(e,n)},currency:function(e,n){this.updateConstructParser(e,n)},currencyDisplay:function(e,n){this.updateConstructParser(e,n)},useGrouping:function(e,n){this.updateConstructParser(e,n)},minFractionDigits:function(e,n){this.updateConstructParser(e,n)},maxFractionDigits:function(e,n){this.updateConstructParser(e,n)},suffix:function(e,n){this.updateConstructParser(e,n)},prefix:function(e,n){this.updateConstructParser(e,n)}},created:function(){this.constructParser()},methods:{getOptions:function(){return{localeMatcher:this.localeMatcher,style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay,useGrouping:this.useGrouping,minimumFractionDigits:this.minFractionDigits,maximumFractionDigits:this.maxFractionDigits}},constructParser:function(){this.numberFormat=new Intl.NumberFormat(this.locale,this.getOptions());var e=WEe(new Intl.NumberFormat(this.locale,{useGrouping:!1}).format(9876543210)).reverse(),n=new Map(e.map(function(i,r){return[i,r]}));this._numeral=new RegExp("[".concat(e.join(""),"]"),"g"),this._group=this.getGroupingExpression(),this._minusSign=this.getMinusSignExpression(),this._currency=this.getCurrencyExpression(),this._decimal=this.getDecimalExpression(),this._suffix=this.getSuffixExpression(),this._prefix=this.getPrefixExpression(),this._index=function(i){return n.get(i)}},updateConstructParser:function(e,n){e!==n&&this.constructParser()},escapeRegExp:function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},getDecimalExpression:function(){var e=new Intl.NumberFormat(this.locale,$F($F({},this.getOptions()),{},{useGrouping:!1}));return new RegExp("[".concat(e.format(1.1).replace(this._currency,"").trim().replace(this._numeral,""),"]"),"g")},getGroupingExpression:function(){var e=new Intl.NumberFormat(this.locale,{useGrouping:!0});return this.groupChar=e.format(1e6).trim().replace(this._numeral,"").charAt(0),new RegExp("[".concat(this.groupChar,"]"),"g")},getMinusSignExpression:function(){var e=new Intl.NumberFormat(this.locale,{useGrouping:!1});return new RegExp("[".concat(e.format(-1).trim().replace(this._numeral,""),"]"),"g")},getCurrencyExpression:function(){if(this.currency){var e=new Intl.NumberFormat(this.locale,{style:"currency",currency:this.currency,currencyDisplay:this.currencyDisplay,minimumFractionDigits:0,maximumFractionDigits:0});return new RegExp("[".concat(e.format(1).replace(/\s/g,"").replace(this._numeral,"").replace(this._group,""),"]"),"g")}return new RegExp("[]","g")},getPrefixExpression:function(){if(this.prefix)this.prefixChar=this.prefix;else{var e=new Intl.NumberFormat(this.locale,{style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay});this.prefixChar=e.format(1).split("1")[0]}return new RegExp("".concat(this.escapeRegExp(this.prefixChar||"")),"g")},getSuffixExpression:function(){if(this.suffix)this.suffixChar=this.suffix;else{var e=new Intl.NumberFormat(this.locale,{style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay,minimumFractionDigits:0,maximumFractionDigits:0});this.suffixChar=e.format(1).split("1")[1]}return new RegExp("".concat(this.escapeRegExp(this.suffixChar||"")),"g")},formatValue:function(e){if(e!=null){if(e==="-")return e;if(this.format){var n=new Intl.NumberFormat(this.locale,this.getOptions()),i=n.format(e);return this.prefix&&(i=this.prefix+i),this.suffix&&(i=i+this.suffix),i}return e.toString()}return""},parseValue:function(e){var n=e.replace(this._suffix,"").replace(this._prefix,"").trim().replace(/\s/g,"").replace(this._currency,"").replace(this._group,"").replace(this._minusSign,"-").replace(this._decimal,".").replace(this._numeral,this._index);if(n){if(n==="-")return n;var i=+n;return isNaN(i)?null:i}return null},repeat:function(e,n,i){var r=this;if(!this.readonly){var o=n||500;this.clearTimer(),this.timer=setTimeout(function(){r.repeat(e,40,i)},o),this.spin(e,i)}},spin:function(e,n){if(this.$refs.input){var i=this.step*n,r=this.parseValue(this.$refs.input.$el.value)||0,o=this.validateValue(r+i);this.updateInput(o,null,"spin"),this.updateModel(e,o),this.handleOnInput(e,r,o)}},onUpButtonMouseDown:function(e){this.disabled||(this.$refs.input.$el.focus(),this.repeat(e,null,1),e.preventDefault())},onUpButtonMouseUp:function(){this.disabled||this.clearTimer()},onUpButtonMouseLeave:function(){this.disabled||this.clearTimer()},onUpButtonKeyUp:function(){this.disabled||this.clearTimer()},onUpButtonKeyDown:function(e){(e.keyCode===32||e.keyCode===13)&&this.repeat(e,null,1)},onDownButtonMouseDown:function(e){this.disabled||(this.$refs.input.$el.focus(),this.repeat(e,null,-1),e.preventDefault())},onDownButtonMouseUp:function(){this.disabled||this.clearTimer()},onDownButtonMouseLeave:function(){this.disabled||this.clearTimer()},onDownButtonKeyUp:function(){this.disabled||this.clearTimer()},onDownButtonKeyDown:function(e){(e.keyCode===32||e.keyCode===13)&&this.repeat(e,null,-1)},onUserInput:function(){this.isSpecialChar&&(this.$refs.input.$el.value=this.lastValue),this.isSpecialChar=!1},onInputKeyDown:function(e){if(!this.readonly){if(this.lastValue=e.target.value,e.shiftKey||e.altKey){this.isSpecialChar=!0;return}var n=e.target.selectionStart,i=e.target.selectionEnd,r=e.target.value,o=null;switch(e.altKey&&e.preventDefault(),e.code){case"ArrowUp":this.spin(e,1),e.preventDefault();break;case"ArrowDown":this.spin(e,-1),e.preventDefault();break;case"ArrowLeft":this.isNumeralChar(r.charAt(n-1))||e.preventDefault();break;case"ArrowRight":this.isNumeralChar(r.charAt(n))||e.preventDefault();break;case"Tab":case"Enter":case"NumpadEnter":o=this.validateValue(this.parseValue(r)),this.$refs.input.$el.value=this.formatValue(o),this.$refs.input.$el.setAttribute("aria-valuenow",o),this.updateModel(e,o);break;case"Backspace":{if(e.preventDefault(),n===i){var l=r.charAt(n-1),s=this.getDecimalCharIndexes(r),d=s.decimalCharIndex,p=s.decimalCharIndexWithoutPrefix;if(this.isNumeralChar(l)){var y=this.getDecimalLength(r);if(this._group.test(l))this._group.lastIndex=0,o=r.slice(0,n-2)+r.slice(n-1);else if(this._decimal.test(l))this._decimal.lastIndex=0,y?this.$refs.input.$el.setSelectionRange(n-1,n-1):o=r.slice(0,n-1)+r.slice(n);else if(d>0&&n>d){var v=this.isDecimalMode()&&(this.minFractionDigits||0)<y?"":"0";o=r.slice(0,n-1)+v+r.slice(n)}else p===1?(o=r.slice(0,n-1)+"0"+r.slice(n),o=this.parseValue(o)>0?o:""):o=r.slice(0,n-1)+r.slice(n)}this.updateValue(e,o,null,"delete-single")}else o=this.deleteRange(r,n,i),this.updateValue(e,o,null,"delete-range");break}case"Delete":if(e.preventDefault(),n===i){var w=r.charAt(n),T=this.getDecimalCharIndexes(r),I=T.decimalCharIndex,L=T.decimalCharIndexWithoutPrefix;if(this.isNumeralChar(w)){var k=this.getDecimalLength(r);if(this._group.test(w))this._group.lastIndex=0,o=r.slice(0,n)+r.slice(n+2);else if(this._decimal.test(w))this._decimal.lastIndex=0,k?this.$refs.input.$el.setSelectionRange(n+1,n+1):o=r.slice(0,n)+r.slice(n+1);else if(I>0&&n>I){var F=this.isDecimalMode()&&(this.minFractionDigits||0)<k?"":"0";o=r.slice(0,n)+F+r.slice(n+1)}else L===1?(o=r.slice(0,n)+"0"+r.slice(n+1),o=this.parseValue(o)>0?o:""):o=r.slice(0,n)+r.slice(n+1)}this.updateValue(e,o,null,"delete-back-single")}else o=this.deleteRange(r,n,i),this.updateValue(e,o,null,"delete-range");break;case"Home":this.min&&(this.updateModel(e,this.min),e.preventDefault());break;case"End":this.max&&(this.updateModel(e,this.max),e.preventDefault());break}}},onInputKeyPress:function(e){if(!this.readonly){e.preventDefault();var n=e.which||e.keyCode,i=String.fromCharCode(n),r=this.isDecimalSign(i),o=this.isMinusSign(i);(48<=n&&n<=57||o||r)&&this.insert(e,i,{isDecimalSign:r,isMinusSign:o})}},onPaste:function(e){e.preventDefault();var n=(e.clipboardData||window.clipboardData).getData("Text");if(n){var i=this.parseValue(n);i!=null&&this.insert(e,i.toString())}},allowMinusSign:function(){return this.min===null||this.min<0},isMinusSign:function(e){return this._minusSign.test(e)||e==="-"?(this._minusSign.lastIndex=0,!0):!1},isDecimalSign:function(e){return this._decimal.test(e)?(this._decimal.lastIndex=0,!0):!1},isDecimalMode:function(){return this.mode==="decimal"},getDecimalCharIndexes:function(e){var n=e.search(this._decimal);this._decimal.lastIndex=0;var i=e.replace(this._prefix,"").trim().replace(/\s/g,"").replace(this._currency,""),r=i.search(this._decimal);return this._decimal.lastIndex=0,{decimalCharIndex:n,decimalCharIndexWithoutPrefix:r}},getCharIndexes:function(e){var n=e.search(this._decimal);this._decimal.lastIndex=0;var i=e.search(this._minusSign);this._minusSign.lastIndex=0;var r=e.search(this._suffix);this._suffix.lastIndex=0;var o=e.search(this._currency);return this._currency.lastIndex=0,{decimalCharIndex:n,minusCharIndex:i,suffixCharIndex:r,currencyCharIndex:o}},insert:function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{isDecimalSign:!1,isMinusSign:!1},r=n.search(this._minusSign);if(this._minusSign.lastIndex=0,!(!this.allowMinusSign()&&r!==-1)){var o=this.$refs.input.$el.selectionStart,l=this.$refs.input.$el.selectionEnd,s=this.$refs.input.$el.value.trim(),d=this.getCharIndexes(s),p=d.decimalCharIndex,y=d.minusCharIndex,v=d.suffixCharIndex,w=d.currencyCharIndex,T;if(i.isMinusSign)o===0&&(T=s,(y===-1||l!==0)&&(T=this.insertText(s,n,0,l)),this.updateValue(e,T,n,"insert"));else if(i.isDecimalSign)p>0&&o===p?this.updateValue(e,s,n,"insert"):p>o&&p<l?(T=this.insertText(s,n,o,l),this.updateValue(e,T,n,"insert")):p===-1&&this.maxFractionDigits&&(T=this.insertText(s,n,o,l),this.updateValue(e,T,n,"insert"));else{var I=this.numberFormat.resolvedOptions().maximumFractionDigits,L=o!==l?"range-insert":"insert";if(p>0&&o>p){if(o+n.length-(p+1)<=I){var k=w>=o?w-1:v>=o?v:s.length;T=s.slice(0,o)+n+s.slice(o+n.length,k)+s.slice(k),this.updateValue(e,T,n,L)}}else T=this.insertText(s,n,o,l),this.updateValue(e,T,n,L)}}},insertText:function(e,n,i,r){var o=n==="."?n:n.split(".");if(o.length===2){var l=e.slice(i,r).search(this._decimal);return this._decimal.lastIndex=0,l>0?e.slice(0,i)+this.formatValue(n)+e.slice(r):e||this.formatValue(n)}else return r-i===e.length?this.formatValue(n):i===0?n+e.slice(r):r===e.length?e.slice(0,i)+n:e.slice(0,i)+n+e.slice(r)},deleteRange:function(e,n,i){var r;return i-n===e.length?r="":n===0?r=e.slice(i):i===e.length?r=e.slice(0,n):r=e.slice(0,n)+e.slice(i),r},initCursor:function(){var e=this.$refs.input.$el.selectionStart,n=this.$refs.input.$el.value,i=n.length,r=null,o=(this.prefixChar||"").length;n=n.replace(this._prefix,""),e=e-o;var l=n.charAt(e);if(this.isNumeralChar(l))return e+o;for(var s=e-1;s>=0;)if(l=n.charAt(s),this.isNumeralChar(l)){r=s+o;break}else s--;if(r!==null)this.$refs.input.$el.setSelectionRange(r+1,r+1);else{for(s=e;s<i;)if(l=n.charAt(s),this.isNumeralChar(l)){r=s+o;break}else s++;r!==null&&this.$refs.input.$el.setSelectionRange(r,r)}return r||0},onInputClick:function(){var e=this.$refs.input.$el.value;!this.readonly&&e!==He.getSelection()&&this.initCursor()},isNumeralChar:function(e){return e.length===1&&(this._numeral.test(e)||this._decimal.test(e)||this._group.test(e)||this._minusSign.test(e))?(this.resetRegex(),!0):!1},resetRegex:function(){this._numeral.lastIndex=0,this._decimal.lastIndex=0,this._group.lastIndex=0,this._minusSign.lastIndex=0},updateValue:function(e,n,i,r){var o=this.$refs.input.$el.value,l=null;n!=null&&(l=this.parseValue(n),l=!l&&!this.allowEmpty?0:l,this.updateInput(l,i,r,n),this.handleOnInput(e,o,l))},handleOnInput:function(e,n,i){this.isValueChanged(n,i)&&this.$emit("input",{originalEvent:e,value:i,formattedValue:n})},isValueChanged:function(e,n){if(n===null&&e!==null)return!0;if(n!=null){var i=typeof e=="string"?this.parseValue(e):e;return n!==i}return!1},validateValue:function(e){return e==="-"||e==null?null:this.min!=null&&e<this.min?this.min:this.max!=null&&e>this.max?this.max:e},updateInput:function(e,n,i,r){n=n||"";var o=this.$refs.input.$el.value,l=this.formatValue(e),s=o.length;if(l!==r&&(l=this.concatValues(l,r)),s===0){this.$refs.input.$el.value=l,this.$refs.input.$el.setSelectionRange(0,0);var d=this.initCursor(),p=d+n.length;this.$refs.input.$el.setSelectionRange(p,p)}else{var y=this.$refs.input.$el.selectionStart,v=this.$refs.input.$el.selectionEnd;this.$refs.input.$el.value=l;var w=l.length;if(i==="range-insert"){var T=this.parseValue((o||"").slice(0,y)),I=T!==null?T.toString():"",L=I.split("").join("(".concat(this.groupChar,")?")),k=new RegExp(L,"g");k.test(l);var F=n.split("").join("(".concat(this.groupChar,")?")),B=new RegExp(F,"g");B.test(l.slice(k.lastIndex)),v=k.lastIndex+B.lastIndex,this.$refs.input.$el.setSelectionRange(v,v)}else if(w===s)i==="insert"||i==="delete-back-single"?this.$refs.input.$el.setSelectionRange(v+1,v+1):i==="delete-single"?this.$refs.input.$el.setSelectionRange(v-1,v-1):(i==="delete-range"||i==="spin")&&this.$refs.input.$el.setSelectionRange(v,v);else if(i==="delete-back-single"){var G=o.charAt(v-1),U=o.charAt(v),ee=s-w,ne=this._group.test(U);ne&&ee===1?v+=1:!ne&&this.isNumeralChar(G)&&(v+=-1*ee+1),this._group.lastIndex=0,this.$refs.input.$el.setSelectionRange(v,v)}else if(o==="-"&&i==="insert"){this.$refs.input.$el.setSelectionRange(0,0);var ye=this.initCursor(),fe=ye+n.length+1;this.$refs.input.$el.setSelectionRange(fe,fe)}else v=v+(w-s),this.$refs.input.$el.setSelectionRange(v,v)}this.$refs.input.$el.setAttribute("aria-valuenow",e)},concatValues:function(e,n){if(e&&n){var i=n.search(this._decimal);return this._decimal.lastIndex=0,this.suffixChar?i!==-1?e.replace(this.suffixChar,"").split(this._decimal)[0]+n.replace(this.suffixChar,"").slice(i)+this.suffixChar:e:i!==-1?e.split(this._decimal)[0]+n.slice(i):e}return e},getDecimalLength:function(e){if(e){var n=e.split(this._decimal);if(n.length===2)return n[1].replace(this._suffix,"").trim().replace(/\s/g,"").replace(this._currency,"").length}return 0},updateModel:function(e,n){this.d_modelValue=n,this.$emit("update:modelValue",n)},onInputFocus:function(e){this.focused=!0,!this.disabled&&!this.readonly&&this.$refs.input.$el.value!==He.getSelection()&&this.highlightOnFocus&&e.target.select(),this.$emit("focus",e)},onInputBlur:function(e){this.focused=!1;var n=e.target,i=this.validateValue(this.parseValue(n.value));this.$emit("blur",{originalEvent:e,value:n.value}),n.value=this.formatValue(i),n.setAttribute("aria-valuenow",i),this.updateModel(e,i)},clearTimer:function(){this.timer&&clearInterval(this.timer)},maxBoundry:function(){return this.d_modelValue>=this.max},minBoundry:function(){return this.d_modelValue<=this.min}},computed:{filled:function(){return this.modelValue!=null&&this.modelValue.toString().length>0},upButtonListeners:function(){var e=this;return{mousedown:function(i){return e.onUpButtonMouseDown(i)},mouseup:function(i){return e.onUpButtonMouseUp(i)},mouseleave:function(i){return e.onUpButtonMouseLeave(i)},keydown:function(i){return e.onUpButtonKeyDown(i)},keyup:function(i){return e.onUpButtonKeyUp(i)}}},downButtonListeners:function(){var e=this;return{mousedown:function(i){return e.onDownButtonMouseDown(i)},mouseup:function(i){return e.onDownButtonMouseUp(i)},mouseleave:function(i){return e.onDownButtonMouseLeave(i)},keydown:function(i){return e.onDownButtonKeyDown(i)},keyup:function(i){return e.onDownButtonKeyUp(i)}}},formattedValue:function(){var e=!this.modelValue&&!this.allowEmpty?0:this.modelValue;return this.formatValue(e)},getFormatter:function(){return this.numberFormat}},components:{INInputText:Hw,INButton:zh,AngleUpIcon:FV,AngleDownIcon:kV}};function Nv(t){"@babel/helpers - typeof";return Nv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nv(t)}function GF(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function ql(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?GF(Object(n),!0).forEach(function(i){YEe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):GF(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function YEe(t,e,n){return e=JEe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JEe(t){var e=QEe(t,"string");return Nv(e)==="symbol"?e:String(e)}function QEe(t,e){if(Nv(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Nv(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eTe(t,e,n,i,r,o){var l=Gn("INInputText"),s=Gn("INButton");return le(),Ue("span",Le({class:t.cx("root")},t.ptm("root"),{"data-pc-name":"inputnumber"}),[Lt(l,Le({ref:"input",id:t.inputId,role:"spinbutton",class:[t.cx("input"),t.inputClass],style:t.inputStyle,value:o.formattedValue,"aria-valuemin":t.min,"aria-valuemax":t.max,"aria-valuenow":t.modelValue,disabled:t.disabled,readonly:t.readonly,placeholder:t.placeholder,"aria-labelledby":t.ariaLabelledby,"aria-label":t.ariaLabel,onInput:o.onUserInput,onKeydown:o.onInputKeyDown,onKeypress:o.onInputKeyPress,onPaste:o.onPaste,onClick:o.onInputClick,onFocus:o.onInputFocus,onBlur:o.onInputBlur},ql(ql({},t.inputProps),t.ptm("input")),{unstyled:t.unstyled,"data-pc-section":"input"}),null,16,["id","class","style","value","aria-valuemin","aria-valuemax","aria-valuenow","disabled","readonly","placeholder","aria-labelledby","aria-label","onInput","onKeydown","onKeypress","onPaste","onClick","onFocus","onBlur","unstyled"]),t.showButtons&&t.buttonLayout==="stacked"?(le(),Ue("span",Le({key:0,class:t.cx("buttonGroup")},t.ptm("buttonGroup")),[Lt(s,Le({class:[t.cx("incrementButton"),t.incrementButtonClass]},e0(o.upButtonListeners),{disabled:t.disabled,tabindex:-1,"aria-hidden":"true"},ql(ql({},t.incrementButtonProps),t.ptm("incrementButton")),{unstyled:t.unstyled,"data-pc-section":"incrementbutton"}),{icon:Cn(function(){return[Xn(t.$slots,"incrementbuttonicon",{},function(){return[(le(),Rt(Zn(t.incrementButtonIcon?"span":"AngleUpIcon"),Le({class:t.incrementButtonIcon},t.ptm("incrementButton").icon,{"data-pc-section":"incrementbuttonicon"}),null,16,["class"]))]})]}),_:3},16,["class","disabled","unstyled"]),Lt(s,Le({class:[t.cx("decrementButton"),t.decrementButtonClass]},e0(o.downButtonListeners),{disabled:t.disabled,tabindex:-1,"aria-hidden":"true"},ql(ql({},t.decrementButtonProps),t.ptm("decrementButton")),{unstyled:t.unstyled,"data-pc-section":"decrementbutton"}),{icon:Cn(function(){return[Xn(t.$slots,"decrementbuttonicon",{},function(){return[(le(),Rt(Zn(t.decrementButtonIcon?"span":"AngleDownIcon"),Le({class:t.decrementButtonIcon},t.ptm("decrementButton").icon,{"data-pc-section":"decrementbuttonicon"}),null,16,["class"]))]})]}),_:3},16,["class","disabled","unstyled"])],16)):Jt("",!0),t.showButtons&&t.buttonLayout!=="stacked"?(le(),Rt(s,Le({key:1,class:[t.cx("incrementButton"),t.incrementButtonClass]},e0(o.upButtonListeners),{disabled:t.disabled,tabindex:-1,"aria-hidden":"true"},ql(ql({},t.incrementButtonProps),t.ptm("incrementButton")),{unstyled:t.unstyled,"data-pc-section":"incrementbutton"}),{icon:Cn(function(){return[Xn(t.$slots,"incrementbuttonicon",{},function(){return[(le(),Rt(Zn(t.incrementButtonIcon?"span":"AngleUpIcon"),Le({class:t.incrementButtonIcon},t.ptm("incrementButton").icon,{"data-pc-section":"incrementbuttonicon"}),null,16,["class"]))]})]}),_:3},16,["class","disabled","unstyled"])):Jt("",!0),t.showButtons&&t.buttonLayout!=="stacked"?(le(),Rt(s,Le({key:2,class:[t.cx("decrementButton"),t.decrementButtonClass]},e0(o.downButtonListeners),{disabled:t.disabled,tabindex:-1,"aria-hidden":"true"},ql(ql({},t.decrementButtonProps),t.ptm("decrementButton")),{unstyled:t.unstyled,"data-pc-section":"decrementbutton"}),{icon:Cn(function(){return[Xn(t.$slots,"decrementbuttonicon",{},function(){return[(le(),Rt(Zn(t.decrementButtonIcon?"span":"AngleDownIcon"),Le({class:t.decrementButtonIcon},t.ptm("decrementButton").icon,{"data-pc-section":"decrementbuttonicon"}),null,16,["class"]))]})]}),_:3},16,["class","disabled","unstyled"])):Jt("",!0)],16)}G0.render=eTe;var BV={name:"AngleDoubleRightIcon",extends:mo},tTe=Qe("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M7.68757 11.1451C7.7791 11.1831 7.8773 11.2024 7.9764 11.2019C8.07769 11.1985 8.17721 11.1745 8.26886 11.1312C8.36052 11.088 8.44238 11.0265 8.50943 10.9505L12.0294 7.49085C12.1707 7.34942 12.25 7.15771 12.25 6.95782C12.25 6.75794 12.1707 6.56622 12.0294 6.42479L8.50943 2.90479C8.37014 2.82159 8.20774 2.78551 8.04633 2.80192C7.88491 2.81833 7.73309 2.88635 7.6134 2.99588C7.4937 3.10541 7.41252 3.25061 7.38189 3.40994C7.35126 3.56927 7.37282 3.73423 7.44337 3.88033L10.4605 6.89748L7.44337 9.91463C7.30212 10.0561 7.22278 10.2478 7.22278 10.4477C7.22278 10.6475 7.30212 10.8393 7.44337 10.9807C7.51301 11.0512 7.59603 11.1071 7.68757 11.1451ZM1.94207 10.9505C2.07037 11.0968 2.25089 11.1871 2.44493 11.2019C2.63898 11.1871 2.81949 11.0968 2.94779 10.9505L6.46779 7.49085C6.60905 7.34942 6.68839 7.15771 6.68839 6.95782C6.68839 6.75793 6.60905 6.56622 6.46779 6.42479L2.94779 2.90479C2.80704 2.83757 2.6489 2.81563 2.49517 2.84201C2.34143 2.86839 2.19965 2.94178 2.08936 3.05207C1.97906 3.16237 1.90567 3.30415 1.8793 3.45788C1.85292 3.61162 1.87485 3.76975 1.94207 3.9105L4.95922 6.92765L1.94207 9.9448C1.81838 10.0831 1.75 10.2621 1.75 10.4477C1.75 10.6332 1.81838 10.8122 1.94207 10.9505Z",fill:"currentColor"},null,-1),nTe=[tTe];function iTe(t,e,n,i,r,o){return le(),Ue("svg",Le({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),nTe,16)}BV.render=iTe;var zV={name:"AngleLeftIcon",extends:mo},rTe=Qe("path",{d:"M8.75 11.185C8.65146 11.1854 8.55381 11.1662 8.4628 11.1284C8.37179 11.0906 8.28924 11.0351 8.22 10.965L4.72 7.46496C4.57955 7.32433 4.50066 7.13371 4.50066 6.93496C4.50066 6.73621 4.57955 6.54558 4.72 6.40496L8.22 2.93496C8.36095 2.84357 8.52851 2.80215 8.69582 2.81733C8.86312 2.83252 9.02048 2.90344 9.14268 3.01872C9.26487 3.134 9.34483 3.28696 9.36973 3.4531C9.39463 3.61924 9.36303 3.78892 9.28 3.93496L6.28 6.93496L9.28 9.93496C9.42045 10.0756 9.49934 10.2662 9.49934 10.465C9.49934 10.6637 9.42045 10.8543 9.28 10.995C9.13526 11.1257 8.9448 11.1939 8.75 11.185Z",fill:"currentColor"},null,-1),oTe=[rTe];function sTe(t,e,n,i,r,o){return le(),Ue("svg",Le({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),oTe,16)}zV.render=sTe;var aTe={name:"BasePaginator",extends:Ni,props:{totalRecords:{type:Number,default:0},rows:{type:Number,default:0},first:{type:Number,default:0},pageLinkSize:{type:Number,default:5},rowsPerPageOptions:{type:Array,default:null},template:{type:[Object,String],default:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown"},currentPageReportTemplate:{type:null,default:"({currentPage} of {totalPages})"},alwaysShow:{type:Boolean,default:!0}},style:TEe,provide:function(){return{$parentInstance:this}}},NV={name:"CurrentPageReport",hostName:"Paginator",extends:Ni,props:{pageCount:{type:Number,default:0},currentPage:{type:Number,default:0},page:{type:Number,default:0},first:{type:Number,default:0},rows:{type:Number,default:0},totalRecords:{type:Number,default:0},template:{type:String,default:"({currentPage} of {totalPages})"}},computed:{text:function(){var e=this.template.replace("{currentPage}",this.currentPage).replace("{totalPages}",this.pageCount).replace("{first}",this.pageCount>0?this.first+1:0).replace("{last}",Math.min(this.first+this.rows,this.totalRecords)).replace("{rows}",this.rows).replace("{totalRecords}",this.totalRecords);return e}}};function lTe(t,e,n,i,r,o){return le(),Ue("span",Le({class:t.cx("current")},t.ptm("current")),ki(o.text),17)}NV.render=lTe;var UV={name:"FirstPageLink",hostName:"Paginator",extends:Ni,props:{template:{type:Function,default:null}},methods:{getPTOptions:function(e){return this.ptm(e,{context:{disabled:this.$attrs.disabled}})}},components:{AngleDoubleLeftIcon:DV},directives:{ripple:Rl}};function cTe(t,e,n,i,r,o){var l=ea("ripple");return fo((le(),Ue("button",Le({class:t.cx("firstPageButton"),type:"button"},o.getPTOptions("firstPageButton"),{"data-pc-group-section":"pagebutton"}),[(le(),Rt(Zn(n.template||"AngleDoubleLeftIcon"),Le({class:t.cx("firstPageIcon")},o.getPTOptions("firstPageIcon")),null,16,["class"]))],16)),[[l]])}UV.render=cTe;var VV={name:"JumpToPageDropdown",hostName:"Paginator",extends:Ni,emits:["page-change"],props:{page:Number,pageCount:Number,disabled:Boolean,templates:null},methods:{onChange:function(e){this.$emit("page-change",e)}},computed:{pageOptions:function(){for(var e=[],n=0;n<this.pageCount;n++)e.push({label:String(n+1),value:n});return e}},components:{JTPDropdown:ig}};function uTe(t,e,n,i,r,o){var l=Gn("JTPDropdown");return le(),Rt(l,{modelValue:n.page,options:o.pageOptions,optionLabel:"label",optionValue:"value","onUpdate:modelValue":e[0]||(e[0]=function(s){return o.onChange(s)}),class:ri(t.cx("jumpToPageDropdown")),disabled:n.disabled,unstyled:t.unstyled,pt:t.ptm("jumpToPageDropdown"),"data-pc-section":"jumptopagedropdown","data-pc-group-section":"pagedropdown"},Pm({_:2},[n.templates.jumptopagedropdownicon?{name:"dropdownicon",fn:Cn(function(s){return[(le(),Rt(Zn(n.templates.jumptopagedropdownicon),{class:ri(s.class)},null,8,["class"]))]}),key:"0"}:void 0]),1032,["modelValue","options","class","disabled","unstyled","pt"])}VV.render=uTe;var jV={name:"JumpToPageInput",hostName:"Paginator",extends:Ni,inheritAttrs:!1,emits:["page-change"],props:{page:Number,pageCount:Number,disabled:Boolean},data:function(){return{d_page:this.page}},watch:{page:function(e){this.d_page=e}},methods:{onChange:function(e){e!==this.page&&(this.d_page=e,this.$emit("page-change",e-1))}},computed:{inputArialabel:function(){return this.$primevue.config.locale.aria?this.$primevue.config.locale.aria.jumpToPageInputLabel:void 0}},components:{JTPInput:G0}};function hTe(t,e,n,i,r,o){var l=Gn("JTPInput");return le(),Rt(l,{ref:"jtpInput",modelValue:r.d_page,class:ri(t.cx("jumpToPageInput")),"aria-label":o.inputArialabel,disabled:n.disabled,"onUpdate:modelValue":o.onChange,unstyled:t.unstyled,pt:t.ptm("jumpToPageInput"),"data-pc-section":"jumptopageinput"},null,8,["modelValue","class","aria-label","disabled","onUpdate:modelValue","unstyled","pt"])}jV.render=hTe;var $V={name:"LastPageLink",hostName:"Paginator",extends:Ni,props:{template:{type:Function,default:null}},methods:{getPTOptions:function(e){return this.ptm(e,{context:{disabled:this.$attrs.disabled}})}},components:{AngleDoubleRightIcon:BV},directives:{ripple:Rl}};function dTe(t,e,n,i,r,o){var l=ea("ripple");return fo((le(),Ue("button",Le({class:t.cx("lastPageButton"),type:"button"},o.getPTOptions("lastPageButton"),{"data-pc-group-section":"pagebutton"}),[(le(),Rt(Zn(n.template||"AngleDoubleRightIcon"),Le({class:t.cx("lastPageIcon")},o.getPTOptions("lastPageIcon")),null,16,["class"]))],16)),[[l]])}$V.render=dTe;var GV={name:"NextPageLink",hostName:"Paginator",extends:Ni,props:{template:{type:Function,default:null}},methods:{getPTOptions:function(e){return this.ptm(e,{context:{disabled:this.$attrs.disabled}})}},components:{AngleRightIcon:n3},directives:{ripple:Rl}};function fTe(t,e,n,i,r,o){var l=ea("ripple");return fo((le(),Ue("button",Le({class:t.cx("nextPageButton"),type:"button"},o.getPTOptions("nextPageButton"),{"data-pc-group-section":"pagebutton"}),[(le(),Rt(Zn(n.template||"AngleRightIcon"),Le({class:t.cx("nextPageIcon")},o.getPTOptions("nextPageIcon")),null,16,["class"]))],16)),[[l]])}GV.render=fTe;var HV={name:"PageLinks",hostName:"Paginator",extends:Ni,inheritAttrs:!1,emits:["click"],props:{value:Array,page:Number},methods:{getPTOptions:function(e,n){return this.ptm(n,{context:{active:e===this.page}})},onPageLinkClick:function(e,n){this.$emit("click",{originalEvent:e,value:n})},ariaPageLabel:function(e){return this.$primevue.config.locale.aria?this.$primevue.config.locale.aria.pageLabel.replace(/{page}/g,e):void 0}},directives:{ripple:Rl}},pTe=["aria-label","aria-current","onClick","data-p-highlight"];function mTe(t,e,n,i,r,o){var l=ea("ripple");return le(),Ue("span",Le({class:t.cx("pages")},t.ptm("pages")),[(le(!0),Ue(_n,null,or(n.value,function(s){return fo((le(),Ue("button",Le({key:s,class:t.cx("pageButton",{pageLink:s}),type:"button","aria-label":o.ariaPageLabel(s),"aria-current":s-1===n.page?"page":void 0,onClick:function(p){return o.onPageLinkClick(p,s)}},o.getPTOptions(s-1,"pageButton"),{"data-p-highlight":s-1===n.page}),[vo(ki(s),1)],16,pTe)),[[l]])}),128))],16)}HV.render=mTe;var WV={name:"PrevPageLink",hostName:"Paginator",extends:Ni,props:{template:{type:Function,default:null}},methods:{getPTOptions:function(e){return this.ptm(e,{context:{disabled:this.$attrs.disabled}})}},components:{AngleLeftIcon:zV},directives:{ripple:Rl}};function gTe(t,e,n,i,r,o){var l=ea("ripple");return fo((le(),Ue("button",Le({class:t.cx("previousPageButton"),type:"button"},o.getPTOptions("previousPageButton"),{"data-pc-group-section":"pagebutton"}),[(le(),Rt(Zn(n.template||"AngleLeftIcon"),Le({class:t.cx("previousPageIcon")},o.getPTOptions("previousPageIcon")),null,16,["class"]))],16)),[[l]])}WV.render=gTe;var KV={name:"RowsPerPageDropdown",hostName:"Paginator",extends:Ni,emits:["rows-change"],props:{options:Array,rows:Number,disabled:Boolean,templates:null},methods:{onChange:function(e){this.$emit("rows-change",e)}},computed:{rowsOptions:function(){var e=[];if(this.options)for(var n=0;n<this.options.length;n++)e.push({label:String(this.options[n]),value:this.options[n]});return e}},components:{RPPDropdown:ig}};function yTe(t,e,n,i,r,o){var l=Gn("RPPDropdown");return le(),Rt(l,{modelValue:n.rows,options:o.rowsOptions,optionLabel:"label",optionValue:"value","onUpdate:modelValue":e[0]||(e[0]=function(s){return o.onChange(s)}),class:ri(t.cx("rowPerPageDropdown")),disabled:n.disabled,unstyled:t.unstyled,pt:t.ptm("rowPerPageDropdown"),"data-pc-section":"rowperpagedropdown","data-pc-group-section":"pagedropdown"},Pm({_:2},[n.templates.rowsperpagedropdownicon?{name:"dropdownicon",fn:Cn(function(s){return[(le(),Rt(Zn(n.templates.rowsperpagedropdownicon),{class:ri(s.class)},null,8,["class"]))]}),key:"0"}:void 0]),1032,["modelValue","options","class","disabled","unstyled","pt"])}KV.render=yTe;function vTe(t){return xTe(t)||bTe(t)||XV(t)||_Te()}function _Te(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bTe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function xTe(t){if(Array.isArray(t))return YP(t)}function qP(t){"@babel/helpers - typeof";return qP=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qP(t)}function HF(t,e){return TTe(t)||ETe(t,e)||XV(t,e)||wTe()}function wTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XV(t,e){if(t){if(typeof t=="string")return YP(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return YP(t,e)}}function YP(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function ETe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,o,l,s=[],d=!0,p=!1;try{if(o=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;d=!1}else for(;!(d=(i=o.call(n)).done)&&(s.push(i.value),s.length!==e);d=!0);}catch(y){p=!0,r=y}finally{try{if(!d&&n.return!=null&&(l=n.return(),Object(l)!==l))return}finally{if(p)throw r}}return s}}function TTe(t){if(Array.isArray(t))return t}var ZV={name:"Paginator",extends:aTe,emits:["update:first","update:rows","page"],data:function(){return{d_first:this.first,d_rows:this.rows}},watch:{first:function(e){this.d_first=e},rows:function(e){this.d_rows=e},totalRecords:function(e){this.page>0&&e&&this.d_first>=e&&this.changePage(this.pageCount-1)}},mounted:function(){this.setPaginatorAttribute(),this.createStyle()},methods:{changePage:function(e){var n=this.pageCount;if(e>=0&&e<n){this.d_first=this.d_rows*e;var i={page:e,first:this.d_first,rows:this.d_rows,pageCount:n};this.$emit("update:first",this.d_first),this.$emit("update:rows",this.d_rows),this.$emit("page",i)}},changePageToFirst:function(e){this.isFirstPage||this.changePage(0),e.preventDefault()},changePageToPrev:function(e){this.changePage(this.page-1),e.preventDefault()},changePageLink:function(e){this.changePage(e.value-1),e.originalEvent.preventDefault()},changePageToNext:function(e){this.changePage(this.page+1),e.preventDefault()},changePageToLast:function(e){this.isLastPage||this.changePage(this.pageCount-1),e.preventDefault()},onRowChange:function(e){this.d_rows=e,this.changePage(this.page)},createStyle:function(){var e=this;if(this.hasBreakpoints()&&!this.isUnstyled){var n;this.styleElement=document.createElement("style"),this.styleElement.type="text/css",He.setAttribute(this.styleElement,"nonce",(n=this.$primevue)===null||n===void 0||(n=n.config)===null||n===void 0||(n=n.csp)===null||n===void 0?void 0:n.nonce),document.head.appendChild(this.styleElement);var i="",r=Object.keys(this.template),o={};r.sort(function(T,I){return parseInt(T)-parseInt(I)}).forEach(function(T){o[T]=e.template[T]});for(var l=0,s=Object.entries(Object.entries(o));l<s.length;l++){var d=HF(s[l],2),p=d[0],y=HF(d[1],1),v=y[0],w=Object.entries(o)[p-1]?"and (min-width:".concat(Object.keys(o)[p-1],")"):"";v==="default"?i+=`
                            @media screen `.concat(w,` {
                                .paginator[`).concat(this.attributeSelector,`],
                                .p-paginator-default{
                                    display: flex !important;
                                }
                            }
                        `):i+=`
                        .paginator[`.concat(this.attributeSelector,"], .p-paginator-").concat(v,` {
                                display: none !important;
                            }
                        @media screen `).concat(w," and (max-width: ").concat(v,`) {
                            .paginator[`).concat(this.attributeSelector,"], .p-paginator-").concat(v,` {
                                display: flex !important;
                            }
                            .paginator[`).concat(this.attributeSelector,`],
                            .p-paginator-default{
                                display: none !important;
                            }
                        }
                    `)}this.styleElement.innerHTML=i}},hasBreakpoints:function(){return qP(this.template)==="object"},setPaginatorAttribute:function(){var e=this;this.$refs.paginator&&this.$refs.paginator.length>=0&&vTe(this.$refs.paginator).forEach(function(n){n.setAttribute(e.attributeSelector,"")})},getAriaLabel:function(e){return this.$primevue.config.locale.aria?this.$primevue.config.locale.aria[e]:void 0}},computed:{templateItems:function(){var e={};if(this.hasBreakpoints()){e=this.template,e.default||(e.default="FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown");for(var n in e)e[n]=this.template[n].split(" ").map(function(i){return i.trim()});return e}return e.default=this.template.split(" ").map(function(i){return i.trim()}),e},page:function(){return Math.floor(this.d_first/this.d_rows)},pageCount:function(){return Math.ceil(this.totalRecords/this.d_rows)},isFirstPage:function(){return this.page===0},isLastPage:function(){return this.page===this.pageCount-1},calculatePageLinkBoundaries:function(){var e=this.pageCount,n=Math.min(this.pageLinkSize,e),i=Math.max(0,Math.ceil(this.page-n/2)),r=Math.min(e-1,i+n-1),o=this.pageLinkSize-(r-i+1);return i=Math.max(0,i-o),[i,r]},pageLinks:function(){for(var e=[],n=this.calculatePageLinkBoundaries,i=n[0],r=n[1],o=i;o<=r;o++)e.push(o+1);return e},currentState:function(){return{page:this.page,first:this.d_first,rows:this.d_rows}},empty:function(){return this.pageCount===0},currentPage:function(){return this.pageCount>0?this.page+1:0},attributeSelector:function(){return Gr()}},components:{CurrentPageReport:NV,FirstPageLink:UV,LastPageLink:$V,NextPageLink:GV,PageLinks:HV,PrevPageLink:WV,RowsPerPageDropdown:KV,JumpToPageDropdown:VV,JumpToPageInput:jV}};function STe(t,e,n,i,r,o){var l=Gn("FirstPageLink"),s=Gn("PrevPageLink"),d=Gn("NextPageLink"),p=Gn("LastPageLink"),y=Gn("PageLinks"),v=Gn("CurrentPageReport"),w=Gn("RowsPerPageDropdown"),T=Gn("JumpToPageDropdown"),I=Gn("JumpToPageInput");return t.alwaysShow||o.pageLinks&&o.pageLinks.length>1?(le(),Ue("nav",um(Le({key:0},t.ptm("paginatorWrapper"))),[(le(!0),Ue(_n,null,or(o.templateItems,function(L,k){return le(),Ue("div",Le({key:k,ref_for:!0,ref:"paginator",class:t.cx("paginator",{key:k})},t.ptm("root"),{"data-pc-name":"paginator"}),[t.$slots.start?(le(),Ue("div",Le({key:0,class:t.cx("start")},t.ptm("start")),[Xn(t.$slots,"start",{state:o.currentState})],16)):Jt("",!0),(le(!0),Ue(_n,null,or(L,function(F){return le(),Ue(_n,{key:F},[F==="FirstPageLink"?(le(),Rt(l,{key:0,"aria-label":o.getAriaLabel("firstPageLabel"),template:t.$slots.firstpagelinkicon,onClick:e[0]||(e[0]=function(B){return o.changePageToFirst(B)}),disabled:o.isFirstPage||o.empty,unstyled:t.unstyled,pt:t.pt},null,8,["aria-label","template","disabled","unstyled","pt"])):F==="PrevPageLink"?(le(),Rt(s,{key:1,"aria-label":o.getAriaLabel("prevPageLabel"),template:t.$slots.prevpagelinkicon,onClick:e[1]||(e[1]=function(B){return o.changePageToPrev(B)}),disabled:o.isFirstPage||o.empty,unstyled:t.unstyled,pt:t.pt},null,8,["aria-label","template","disabled","unstyled","pt"])):F==="NextPageLink"?(le(),Rt(d,{key:2,"aria-label":o.getAriaLabel("nextPageLabel"),template:t.$slots.nextpagelinkicon,onClick:e[2]||(e[2]=function(B){return o.changePageToNext(B)}),disabled:o.isLastPage||o.empty,unstyled:t.unstyled,pt:t.pt},null,8,["aria-label","template","disabled","unstyled","pt"])):F==="LastPageLink"?(le(),Rt(p,{key:3,"aria-label":o.getAriaLabel("lastPageLabel"),template:t.$slots.lastpagelinkicon,onClick:e[3]||(e[3]=function(B){return o.changePageToLast(B)}),disabled:o.isLastPage||o.empty,unstyled:t.unstyled,pt:t.pt},null,8,["aria-label","template","disabled","unstyled","pt"])):F==="PageLinks"?(le(),Rt(y,{key:4,"aria-label":o.getAriaLabel("pageLabel"),value:o.pageLinks,page:o.page,onClick:e[4]||(e[4]=function(B){return o.changePageLink(B)}),pt:t.pt},null,8,["aria-label","value","page","pt"])):F==="CurrentPageReport"?(le(),Rt(v,{key:5,"aria-live":"polite",template:t.currentPageReportTemplate,currentPage:o.currentPage,page:o.page,pageCount:o.pageCount,first:r.d_first,rows:r.d_rows,totalRecords:t.totalRecords,unstyled:t.unstyled,pt:t.pt},null,8,["template","currentPage","page","pageCount","first","rows","totalRecords","unstyled","pt"])):F==="RowsPerPageDropdown"&&t.rowsPerPageOptions?(le(),Rt(w,{key:6,"aria-label":o.getAriaLabel("rowsPerPageLabel"),rows:r.d_rows,options:t.rowsPerPageOptions,onRowsChange:e[5]||(e[5]=function(B){return o.onRowChange(B)}),disabled:o.empty,templates:t.$slots,unstyled:t.unstyled,pt:t.pt},null,8,["aria-label","rows","options","disabled","templates","unstyled","pt"])):F==="JumpToPageDropdown"?(le(),Rt(T,{key:7,"aria-label":o.getAriaLabel("jumpToPageDropdownLabel"),page:o.page,pageCount:o.pageCount,onPageChange:e[6]||(e[6]=function(B){return o.changePage(B)}),disabled:o.empty,templates:t.$slots,unstyled:t.unstyled,pt:t.pt},null,8,["aria-label","page","pageCount","disabled","templates","unstyled","pt"])):F==="JumpToPageInput"?(le(),Rt(I,{key:8,page:o.currentPage,onPageChange:e[7]||(e[7]=function(B){return o.changePage(B)}),disabled:o.empty,unstyled:t.unstyled,pt:t.pt},null,8,["page","disabled","unstyled","pt"])):Jt("",!0)],64)}),128)),t.$slots.end?(le(),Ue("div",Le({key:1,class:t.cx("end")},t.ptm("end")),[Xn(t.$slots,"end",{state:o.currentState})],16)):Jt("",!0)],16)}),128))],16)):Jt("",!0)}ZV.render=STe;var CTe=`
@layer primevue {
    .p-datatable {
        position: relative;
    }

    .p-datatable-table {
        border-spacing: 0px;
        width: 100%;
    }

    .p-datatable .p-sortable-column {
        cursor: pointer;
        user-select: none;
    }

    .p-datatable .p-sortable-column .p-column-title,
    .p-datatable .p-sortable-column .p-sortable-column-icon,
    .p-datatable .p-sortable-column .p-sortable-column-badge {
        vertical-align: middle;
    }

    .p-datatable .p-sortable-column .p-sortable-column-badge {
        display: inline-flex;
        align-items: center;
        justify-content: center;
    }

    .p-datatable-hoverable-rows .p-selectable-row {
        cursor: pointer;
    }

    /* Scrollable */
    .p-datatable-scrollable > .p-datatable-wrapper {
        position: relative;
    }

    .p-datatable-scrollable-table > .p-datatable-thead {
        top: 0;
        z-index: 1;
    }

    .p-datatable-scrollable-table > .p-datatable-frozen-tbody {
        position: sticky;
        z-index: 1;
    }

    .p-datatable-scrollable-table > .p-datatable-tfoot {
        bottom: 0;
        z-index: 1;
    }

    .p-datatable-scrollable .p-frozen-column {
        position: sticky;
        background: inherit;
    }

    .p-datatable-scrollable th.p-frozen-column {
        z-index: 1;
    }

    .p-datatable-flex-scrollable {
        display: flex;
        flex-direction: column;
        height: 100%;
    }

    .p-datatable-flex-scrollable > .p-datatable-wrapper {
        display: flex;
        flex-direction: column;
        flex: 1;
        height: 100%;
    }

    .p-datatable-scrollable-table > .p-datatable-tbody > .p-rowgroup-header {
        position: sticky;
        z-index: 1;
    }

    /* Resizable */
    .p-datatable-resizable-table > .p-datatable-thead > tr > th,
    .p-datatable-resizable-table > .p-datatable-tfoot > tr > td,
    .p-datatable-resizable-table > .p-datatable-tbody > tr > td {
        overflow: hidden;
        white-space: nowrap;
    }

    .p-datatable-resizable-table > .p-datatable-thead > tr > th.p-resizable-column:not(.p-frozen-column) {
        background-clip: padding-box;
        position: relative;
    }

    .p-datatable-resizable-table-fit > .p-datatable-thead > tr > th.p-resizable-column:last-child .p-column-resizer {
        display: none;
    }

    .p-datatable .p-column-resizer {
        display: block;
        position: absolute !important;
        top: 0;
        right: 0;
        margin: 0;
        width: 0.5rem;
        height: 100%;
        padding: 0px;
        cursor: col-resize;
        border: 1px solid transparent;
    }

    .p-datatable .p-column-header-content {
        display: flex;
        align-items: center;
    }

    .p-datatable .p-column-resizer-helper {
        width: 1px;
        position: absolute;
        z-index: 10;
        display: none;
    }

    .p-datatable .p-row-editor-init,
    .p-datatable .p-row-editor-save,
    .p-datatable .p-row-editor-cancel {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
        position: relative;
    }

    /* Expand */
    .p-datatable .p-row-toggler {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
        position: relative;
    }

    /* Reorder */
    .p-datatable-reorder-indicator-up,
    .p-datatable-reorder-indicator-down {
        position: absolute;
        display: none;
    }

    .p-reorderable-column,
    .p-datatable-reorderablerow-handle {
        cursor: move;
    }

    /* Loader */
    .p-datatable .p-datatable-loading-overlay {
        position: absolute;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 2;
    }

    /* Filter */
    .p-column-filter-row {
        display: flex;
        align-items: center;
        width: 100%;
    }

    .p-column-filter-menu {
        display: inline-flex;
        margin-left: auto;
    }

    .p-column-filter-row .p-column-filter-element {
        flex: 1 1 auto;
        width: 1%;
    }

    .p-column-filter-menu-button,
    .p-column-filter-clear-button {
        display: inline-flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        text-decoration: none;
        overflow: hidden;
        position: relative;
    }

    .p-column-filter-row-items {
        margin: 0;
        padding: 0;
        list-style: none;
    }

    .p-column-filter-row-item {
        cursor: pointer;
    }

    .p-column-filter-add-button,
    .p-column-filter-remove-button {
        justify-content: center;
    }

    .p-column-filter-add-button .p-button-label,
    .p-column-filter-remove-button .p-button-label {
        flex-grow: 0;
    }

    .p-column-filter-buttonbar {
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .p-column-filter-buttonbar .p-button:not(.p-button-icon-only) {
        width: auto;
    }

    /* Responsive */
    .p-datatable .p-datatable-tbody > tr > td > .p-column-title {
        display: none;
    }

    /* VirtualScroller */
    .p-datatable-virtualscroller-spacer {
        display: flex;
    }

    .p-datatable .p-virtualscroller .p-virtualscroller-loading {
        transform: none !important;
        min-height: 0;
        position: sticky;
        top: 0;
        left: 0;
    }
}
`,ATe={root:function(e){var n=e.instance,i=e.props;return["p-datatable p-component",{"p-datatable-hoverable-rows":i.rowHover||i.selectionMode,"p-datatable-resizable":i.resizableColumns,"p-datatable-resizable-fit":i.resizableColumns&&i.columnResizeMode==="fit","p-datatable-scrollable":i.scrollable,"p-datatable-flex-scrollable":i.scrollable&&i.scrollHeight==="flex","p-datatable-responsive-stack":i.responsiveLayout==="stack","p-datatable-responsive-scroll":i.responsiveLayout==="scroll","p-datatable-striped":i.stripedRows,"p-datatable-gridlines":i.showGridlines,"p-datatable-grouped-header":n.headerColumnGroup!=null,"p-datatable-grouped-footer":n.footerColumnGroup!=null,"p-datatable-sm":i.size==="small","p-datatable-lg":i.size==="large"}]},loadingOverlay:"p-datatable-loading-overlay p-component-overlay",loadingIcon:"p-datatable-loading-icon",header:"p-datatable-header",paginator:function(e){var n=e.instance;return n.paginatorTop?"p-paginator-top":n.paginatorBottom?"p-paginator-bottom":""},wrapper:"p-datatable-wrapper",table:function(e){var n=e.props;return["p-datatable-table",{"p-datatable-scrollable-table":n.scrollable,"p-datatable-resizable-table":n.resizableColumns,"p-datatable-resizable-table-fit":n.resizableColumns&&n.columnResizeMode==="fit"}]},thead:"p-datatable-thead",headerCell:function(e){var n=e.instance,i=e.props,r=e.column;return r&&!n.columnProp(r,"hidden")&&(i.rowGroupMode!=="subheader"||i.groupRowsBy!==n.columnProp(r,"field"))?["p-filter-column",{"p-frozen-column":n.columnProp(r,"frozen")}]:[{"p-sortable-column":n.columnProp("sortable"),"p-resizable-column":n.resizableColumns,"p-highlight":n.isColumnSorted(),"p-filter-column":i.filterColumn,"p-frozen-column":n.columnProp("frozen"),"p-reorderable-column":i.reorderableColumns}]},columnResizer:"p-column-resizer",headerContent:"p-column-header-content",headerTitle:"p-column-title",sortIcon:"p-sortable-column-icon",sortBadge:"p-sortable-column-badge",headerCheckboxWrapper:function(e){var n=e.instance;return["p-checkbox p-component",{"p-checkbox-focused":n.focused,"p-disabled":n.disabled}]},headerCheckbox:function(e){var n=e.instance;return["p-checkbox-box p-component",{"p-highlight":n.checked,"p-disabled":n.disabled,"p-focus":n.focused}]},headerCheckboxIcon:"p-checkbox-icon",columnFilter:function(e){var n=e.props;return["p-column-filter p-fluid",{"p-column-filter-row":n.display==="row","p-column-filter-menu":n.display==="menu"}]},filterInput:"p-fluid p-column-filter-element",filterMenuButton:function(e){var n=e.instance;return["p-column-filter-menu-button p-link",{"p-column-filter-menu-button-open":n.overlayVisible,"p-column-filter-menu-button-active":n.hasFilter()}]},headerFilterClearButton:function(e){var n=e.instance;return["p-column-filter-clear-button p-link",{"p-hidden-space":!n.hasRowFilter()}]},filterOverlay:function(e){var n=e.instance,i=e.props;return[{"p-column-filter-overlay p-component p-fluid":!0,"p-column-filter-overlay-menu":i.display==="menu","p-input-filled":n.$primevue.config.inputStyle==="filled","p-ripple-disabled":n.$primevue.config.ripple===!1}]},filterRowItems:"p-column-filter-row-items",filterRowItem:function(e){var n=e.instance,i=e.matchMode;return["p-column-filter-row-item",{"p-highlight":i&&n.isRowMatchModeSelected(i.value)}]},filterSeparator:"p-column-filter-separator",filterOperator:"p-column-filter-operator",filterOperatorDropdown:"p-column-filter-operator-dropdown",filterConstraints:"p-column-filter-constraints",filterConstraint:"p-column-filter-constraint",filterMatchModeDropdown:"p-column-filter-matchmode-dropdown",filterRemoveButton:"p-column-filter-remove-button p-button-text p-button-danger p-button-sm",filterAddRule:"p-column-filter-add-rule",filterAddRuleButton:"p-column-filter-add-button p-button-text p-button-sm",filterButtonbar:"p-column-filter-buttonbar",filterClearButton:"p-button-outlined p-button-sm",filterApplyButton:"p-button-sm",tbody:function(e){var n=e.props;return n.frozenRow?"p-datatable-tbody p-datatable-frozen-tbody":"p-datatable-tbody"},rowgroupHeader:"p-rowgroup-header",rowGroupToggler:"p-row-toggler p-link",rowGroupTogglerIcon:"p-row-toggler-icon",row:function(e){var n=e.instance,i=e.props,r=e.rowData,o=[];return i.selectionMode&&o.push("p-selectable-row"),i.selection&&o.push({"p-highlight":n.isSelected(r)}),i.contextMenuSelection&&o.push({"p-highlight-contextmenu":n.isSelectedWithContextMenu(r)}),o},rowExpansion:"p-datatable-row-expansion",rowgroupFooter:"p-rowgroup-footer",emptyMessage:"p-datatable-emptymessage",bodyCell:function(e){var n=e.instance;return[{"p-selection-column":n.columnProp("selectionMode")!=null,"p-editable-column":n.isEditable(),"p-cell-editing":n.d_editing,"p-frozen-column":n.columnProp("frozen")}]},columnTitle:"p-column-title",rowReorderIcon:"p-datatable-reorderablerow-handle",rowToggler:"p-row-toggler p-link",rowTogglerIcon:"p-row-toggler-icon",rowEditorInitButton:"p-row-editor-init p-link",rowEditorInitIcon:"p-row-editor-init-icon",rowEditorSaveButton:"p-row-editor-save p-link",rowEditorSaveIcon:"p-row-editor-save-icon",rowEditorCancelButton:"p-row-editor-cancel p-link",rowEditorCancelIcon:"p-row-editor-cancel-icon",checkboxWrapper:function(e){var n=e.instance;return["p-checkbox p-component",{"p-checkbox-focused":n.focused}]},checkbox:function(e){var n=e.instance;return["p-checkbox-box p-component",{"p-highlight":n.checked,"p-disabled":n.$attrs.disabled,"p-focus":n.focused}]},checkboxIcon:"p-checkbox-icon",radiobuttonWrapper:function(e){var n=e.instance;return["p-radiobutton p-component",{"p-radiobutton-focused":n.focused}]},radiobutton:function(e){var n=e.instance;return["p-radiobutton-box p-component",{"p-highlight":n.checked,"p-disabled":n.$attrs.disabled,"p-focus":n.focused}]},radiobuttonIcon:"p-radiobutton-icon",tfoot:"p-datatable-tfoot",footerCell:function(e){var n=e.instance;return[{"p-frozen-column":n.columnProp("frozen")}]},virtualScrollerSpacer:"p-datatable-virtualscroller-spacer",footer:"p-datatable-footer",resizeHelper:"p-column-resizer-helper",reorderIndicatorUp:"p-datatable-reorder-indicator-up",reorderIndicatorDown:"p-datatable-reorder-indicator-down"},PTe={wrapper:{overflow:"auto"},thead:{position:"sticky"},tfoot:{position:"sticky"}},ITe=_o.extend({name:"datatable",css:CTe,classes:ATe,inlineStyles:PTe}),$3={name:"ChevronRightIcon",extends:mo},MTe=Qe("path",{d:"M4.38708 13C4.28408 13.0005 4.18203 12.9804 4.08691 12.9409C3.99178 12.9014 3.9055 12.8433 3.83313 12.7701C3.68634 12.6231 3.60388 12.4238 3.60388 12.2161C3.60388 12.0084 3.68634 11.8091 3.83313 11.6622L8.50507 6.99022L3.83313 2.31827C3.69467 2.16968 3.61928 1.97313 3.62287 1.77005C3.62645 1.56698 3.70872 1.37322 3.85234 1.22959C3.99596 1.08597 4.18972 1.00371 4.3928 1.00012C4.59588 0.996539 4.79242 1.07192 4.94102 1.21039L10.1669 6.43628C10.3137 6.58325 10.3962 6.78249 10.3962 6.99022C10.3962 7.19795 10.3137 7.39718 10.1669 7.54416L4.94102 12.7701C4.86865 12.8433 4.78237 12.9014 4.68724 12.9409C4.59212 12.9804 4.49007 13.0005 4.38708 13Z",fill:"currentColor"},null,-1),RTe=[MTe];function LTe(t,e,n,i,r,o){return le(),Ue("svg",Le({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),RTe,16)}$3.render=LTe;var qV={name:"BarsIcon",extends:mo},OTe=Qe("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M13.3226 3.6129H0.677419C0.497757 3.6129 0.325452 3.54152 0.198411 3.41448C0.0713707 3.28744 0 3.11514 0 2.93548C0 2.75581 0.0713707 2.58351 0.198411 2.45647C0.325452 2.32943 0.497757 2.25806 0.677419 2.25806H13.3226C13.5022 2.25806 13.6745 2.32943 13.8016 2.45647C13.9286 2.58351 14 2.75581 14 2.93548C14 3.11514 13.9286 3.28744 13.8016 3.41448C13.6745 3.54152 13.5022 3.6129 13.3226 3.6129ZM13.3226 7.67741H0.677419C0.497757 7.67741 0.325452 7.60604 0.198411 7.479C0.0713707 7.35196 0 7.17965 0 6.99999C0 6.82033 0.0713707 6.64802 0.198411 6.52098C0.325452 6.39394 0.497757 6.32257 0.677419 6.32257H13.3226C13.5022 6.32257 13.6745 6.39394 13.8016 6.52098C13.9286 6.64802 14 6.82033 14 6.99999C14 7.17965 13.9286 7.35196 13.8016 7.479C13.6745 7.60604 13.5022 7.67741 13.3226 7.67741ZM0.677419 11.7419H13.3226C13.5022 11.7419 13.6745 11.6706 13.8016 11.5435C13.9286 11.4165 14 11.2442 14 11.0645C14 10.8848 13.9286 10.7125 13.8016 10.5855C13.6745 10.4585 13.5022 10.3871 13.3226 10.3871H0.677419C0.497757 10.3871 0.325452 10.4585 0.198411 10.5855C0.0713707 10.7125 0 10.8848 0 11.0645C0 11.2442 0.0713707 11.4165 0.198411 11.5435C0.325452 11.6706 0.497757 11.7419 0.677419 11.7419Z",fill:"currentColor"},null,-1),DTe=[OTe];function kTe(t,e,n,i,r,o){return le(),Ue("svg",Le({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),DTe,16)}qV.render=kTe;var YV={name:"PencilIcon",extends:mo,computed:{pathId:function(){return"pv_icon_clip_".concat(Gr())}}},FTe=["clipPath"],BTe=Qe("path",{d:"M0.609628 13.959C0.530658 13.9599 0.452305 13.9451 0.379077 13.9156C0.305849 13.8861 0.239191 13.8424 0.18294 13.787C0.118447 13.7234 0.0688234 13.6464 0.0376166 13.5614C0.00640987 13.4765 -0.00560954 13.3857 0.00241768 13.2956L0.25679 10.1501C0.267698 10.0041 0.331934 9.86709 0.437312 9.76516L9.51265 0.705715C10.0183 0.233014 10.6911 -0.0203041 11.3835 0.00127367C12.0714 0.00660201 12.7315 0.27311 13.2298 0.746671C13.7076 1.23651 13.9824 1.88848 13.9992 2.57201C14.0159 3.25554 13.7733 3.92015 13.32 4.4327L4.23648 13.5331C4.13482 13.6342 4.0017 13.6978 3.85903 13.7133L0.667067 14L0.609628 13.959ZM1.43018 10.4696L1.25787 12.714L3.50619 12.5092L12.4502 3.56444C12.6246 3.35841 12.7361 3.10674 12.7714 2.83933C12.8067 2.57193 12.7644 2.30002 12.6495 2.05591C12.5346 1.8118 12.3519 1.60575 12.1231 1.46224C11.8943 1.31873 11.6291 1.2438 11.3589 1.24633C11.1813 1.23508 11.0033 1.25975 10.8355 1.31887C10.6677 1.37798 10.5136 1.47033 10.3824 1.59036L1.43018 10.4696Z",fill:"currentColor"},null,-1),zTe=[BTe],NTe=["id"],UTe=Qe("rect",{width:"14",height:"14",fill:"white"},null,-1),VTe=[UTe];function jTe(t,e,n,i,r,o){return le(),Ue("svg",Le({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),[Qe("g",{clipPath:"url(#".concat(o.pathId,")")},zTe,8,FTe),Qe("defs",null,[Qe("clipPath",{id:"".concat(o.pathId)},VTe,8,NTe)])],16)}YV.render=jTe;var $Te={},GTe=lr.extend({style:$Te}),HTe=GTe.extend("focustrap",{mounted:function(e,n){var i=n.value||{},r=i.disabled;r||(this.createHiddenFocusableElements(e,n),this.bind(e,n),this.autoFocus(e,n)),e.setAttribute("data-pd-focustrap",!0),this.$el=e},updated:function(e,n){var i=n.value||{},r=i.disabled;r&&this.unbind(e)},unmounted:function(e){this.unbind(e)},methods:{getComputedSelector:function(e){return':not(.p-hidden-focusable):not([data-p-hidden-focusable="true"])'.concat(e??"")},bind:function(e,n){var i=this,r=n.value||{},o=r.onFocusIn,l=r.onFocusOut;e.$_pfocustrap_mutationobserver=new MutationObserver(function(s){s.forEach(function(d){if(d.type==="childList"&&!e.contains(document.activeElement)){var p=function y(v){var w=He.isFocusableElement(v)?He.isFocusableElement(v,i.getComputedSelector(e.$_pfocustrap_focusableselector))?v:He.getFirstFocusableElement(e,i.getComputedSelector(e.$_pfocustrap_focusableselector)):He.getFirstFocusableElement(v);return At.isNotEmpty(w)?w:y(v.nextSibling)};He.focus(p(d.nextSibling))}})}),e.$_pfocustrap_mutationobserver.disconnect(),e.$_pfocustrap_mutationobserver.observe(e,{childList:!0}),e.$_pfocustrap_focusinlistener=function(s){return o&&o(s)},e.$_pfocustrap_focusoutlistener=function(s){return l&&l(s)},e.addEventListener("focusin",e.$_pfocustrap_focusinlistener),e.addEventListener("focusout",e.$_pfocustrap_focusoutlistener)},unbind:function(e){e.$_pfocustrap_mutationobserver&&e.$_pfocustrap_mutationobserver.disconnect(),e.$_pfocustrap_focusinlistener&&e.removeEventListener("focusin",e.$_pfocustrap_focusinlistener)&&(e.$_pfocustrap_focusinlistener=null),e.$_pfocustrap_focusoutlistener&&e.removeEventListener("focusout",e.$_pfocustrap_focusoutlistener)&&(e.$_pfocustrap_focusoutlistener=null)},autoFocus:function(e,n){var i=n.value||{},r=i.autoFocusSelector,o=r===void 0?"":r,l=i.firstFocusableSelector,s=l===void 0?"":l,d=i.autoFocus,p=d===void 0?!1:d,y=He.getFirstFocusableElement(e,"[autofocus]".concat(this.getComputedSelector(o)));p&&!y&&(y=He.getFirstFocusableElement(e,this.getComputedSelector(s))),He.focus(y)},onFirstHiddenElementFocus:function(e){var n,i=e.currentTarget,r=e.relatedTarget,o=r===i.$_pfocustrap_lasthiddenfocusableelement||!((n=this.$el)!==null&&n!==void 0&&n.contains(r))?He.getFirstFocusableElement(i.parentElement,this.getComputedSelector(i.$_pfocustrap_focusableselector)):i.$_pfocustrap_lasthiddenfocusableelement;He.focus(o)},onLastHiddenElementFocus:function(e){var n,i=e.currentTarget,r=e.relatedTarget,o=r===i.$_pfocustrap_firsthiddenfocusableelement||!((n=this.$el)!==null&&n!==void 0&&n.contains(r))?He.getLastFocusableElement(i.parentElement,this.getComputedSelector(i.$_pfocustrap_focusableselector)):i.$_pfocustrap_firsthiddenfocusableelement;He.focus(o)},createHiddenFocusableElements:function(e,n){var i=this,r=n.value||{},o=r.tabIndex,l=o===void 0?0:o,s=r.firstFocusableSelector,d=s===void 0?"":s,p=r.lastFocusableSelector,y=p===void 0?"":p,v=function(L){return He.createElement("span",{class:"p-hidden-accessible p-hidden-focusable",tabIndex:l,role:"presentation","aria-hidden":!0,"data-p-hidden-accessible":!0,"data-p-hidden-focusable":!0,onFocus:L==null?void 0:L.bind(i)})},w=v(this.onFirstHiddenElementFocus),T=v(this.onLastHiddenElementFocus);w.$_pfocustrap_lasthiddenfocusableelement=T,w.$_pfocustrap_focusableselector=d,w.setAttribute("data-pc-section","firstfocusableelement"),T.$_pfocustrap_firsthiddenfocusableelement=w,T.$_pfocustrap_focusableselector=y,T.setAttribute("data-pc-section","lastfocusableelement"),e.prepend(w),e.append(T)}}}),JV={name:"FilterSlashIcon",extends:mo,computed:{pathId:function(){return"pv_icon_clip_".concat(Gr())}}},WTe=["clipPath"],KTe=Qe("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M13.4994 0.0920138C13.5967 0.151519 13.6758 0.236453 13.7283 0.337647C13.7807 0.439133 13.8031 0.553448 13.7929 0.667208C13.7827 0.780968 13.7403 0.889466 13.6707 0.98L11.406 4.06823C11.3099 4.19928 11.1656 4.28679 11.005 4.3115C10.8444 4.33621 10.6805 4.2961 10.5495 4.2C10.4184 4.1039 10.3309 3.95967 10.3062 3.79905C10.2815 3.63843 10.3216 3.47458 10.4177 3.34353L11.9412 1.23529H7.41184C7.24803 1.23529 7.09093 1.17022 6.97509 1.05439C6.85926 0.938558 6.79419 0.781457 6.79419 0.617647C6.79419 0.453837 6.85926 0.296736 6.97509 0.180905C7.09093 0.0650733 7.24803 0 7.41184 0H13.1765C13.2905 0.000692754 13.4022 0.0325088 13.4994 0.0920138ZM4.20008 0.181168H4.24126L13.2013 9.03411C13.3169 9.14992 13.3819 9.3069 13.3819 9.47058C13.3819 9.63426 13.3169 9.79124 13.2013 9.90705C13.1445 9.96517 13.0766 10.0112 13.0016 10.0423C12.9266 10.0735 12.846 10.0891 12.7648 10.0882C12.6836 10.0886 12.6032 10.0728 12.5283 10.0417C12.4533 10.0106 12.3853 9.96479 12.3283 9.90705L9.3142 6.92587L9.26479 6.99999V13.3823C9.26265 13.5455 9.19689 13.7014 9.08152 13.8167C8.96615 13.9321 8.81029 13.9979 8.64714 14H5.35302C5.18987 13.9979 5.03401 13.9321 4.91864 13.8167C4.80327 13.7014 4.73751 13.5455 4.73537 13.3823V6.99999L0.329492 1.02117C0.259855 0.930634 0.21745 0.822137 0.207241 0.708376C0.197031 0.594616 0.21944 0.480301 0.271844 0.378815C0.324343 0.277621 0.403484 0.192687 0.500724 0.133182C0.597964 0.073677 0.709609 0.041861 0.823609 0.0411682H3.86243C3.92448 0.0461551 3.9855 0.060022 4.04361 0.0823446C4.10037 0.10735 4.15311 0.140655 4.20008 0.181168ZM8.02949 6.79411C8.02884 6.66289 8.07235 6.53526 8.15302 6.43176L8.42478 6.05293L3.55773 1.23529H2.0589L5.84714 6.43176C5.92781 6.53526 5.97132 6.66289 5.97067 6.79411V12.7647H8.02949V6.79411Z",fill:"currentColor"},null,-1),XTe=[KTe],ZTe=["id"],qTe=Qe("rect",{width:"14",height:"14",fill:"white"},null,-1),YTe=[qTe];function JTe(t,e,n,i,r,o){return le(),Ue("svg",Le({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),[Qe("g",{clipPath:"url(#".concat(o.pathId,")")},XTe,8,WTe),Qe("defs",null,[Qe("clipPath",{id:"".concat(o.pathId)},YTe,8,ZTe)])],16)}JV.render=JTe;var QV={name:"PlusIcon",extends:mo,computed:{pathId:function(){return"pv_icon_clip_".concat(Gr())}}},QTe=["clipPath"],eSe=Qe("path",{d:"M7.67742 6.32258V0.677419C7.67742 0.497757 7.60605 0.325452 7.47901 0.198411C7.35197 0.0713707 7.17966 0 7 0C6.82034 0 6.64803 0.0713707 6.52099 0.198411C6.39395 0.325452 6.32258 0.497757 6.32258 0.677419V6.32258H0.677419C0.497757 6.32258 0.325452 6.39395 0.198411 6.52099C0.0713707 6.64803 0 6.82034 0 7C0 7.17966 0.0713707 7.35197 0.198411 7.47901C0.325452 7.60605 0.497757 7.67742 0.677419 7.67742H6.32258V13.3226C6.32492 13.5015 6.39704 13.6725 6.52358 13.799C6.65012 13.9255 6.82106 13.9977 7 14C7.17966 14 7.35197 13.9286 7.47901 13.8016C7.60605 13.6745 7.67742 13.5022 7.67742 13.3226V7.67742H13.3226C13.5022 7.67742 13.6745 7.60605 13.8016 7.47901C13.9286 7.35197 14 7.17966 14 7C13.9977 6.82106 13.9255 6.65012 13.799 6.52358C13.6725 6.39704 13.5015 6.32492 13.3226 6.32258H7.67742Z",fill:"currentColor"},null,-1),tSe=[eSe],nSe=["id"],iSe=Qe("rect",{width:"14",height:"14",fill:"white"},null,-1),rSe=[iSe];function oSe(t,e,n,i,r,o){return le(),Ue("svg",Le({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),[Qe("g",{clipPath:"url(#".concat(o.pathId,")")},tSe,8,QTe),Qe("defs",null,[Qe("clipPath",{id:"".concat(o.pathId)},rSe,8,nSe)])],16)}QV.render=oSe;var ej={name:"TrashIcon",extends:mo,computed:{pathId:function(){return"pv_icon_clip_".concat(Gr())}}},sSe=["clipPath"],aSe=Qe("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3.44802 13.9955H10.552C10.8056 14.0129 11.06 13.9797 11.3006 13.898C11.5412 13.8163 11.7632 13.6877 11.9537 13.5196C12.1442 13.3515 12.2995 13.1473 12.4104 12.9188C12.5213 12.6903 12.5858 12.442 12.6 12.1884V4.36041H13.4C13.5591 4.36041 13.7117 4.29722 13.8243 4.18476C13.9368 4.07229 14 3.91976 14 3.76071C14 3.60166 13.9368 3.44912 13.8243 3.33666C13.7117 3.22419 13.5591 3.16101 13.4 3.16101H12.0537C12.0203 3.1557 11.9863 3.15299 11.952 3.15299C11.9178 3.15299 11.8838 3.1557 11.8503 3.16101H11.2285C11.2421 3.10893 11.2487 3.05513 11.248 3.00106V1.80966C11.2171 1.30262 10.9871 0.828306 10.608 0.48989C10.229 0.151475 9.73159 -0.0236625 9.22402 0.00257442H4.77602C4.27251 -0.0171866 3.78126 0.160868 3.40746 0.498617C3.03365 0.836366 2.807 1.30697 2.77602 1.80966V3.00106C2.77602 3.0556 2.78346 3.10936 2.79776 3.16101H0.6C0.521207 3.16101 0.443185 3.17652 0.37039 3.20666C0.297595 3.2368 0.231451 3.28097 0.175736 3.33666C0.120021 3.39235 0.0758251 3.45846 0.0456722 3.53121C0.0155194 3.60397 0 3.68196 0 3.76071C0 3.83946 0.0155194 3.91744 0.0456722 3.9902C0.0758251 4.06296 0.120021 4.12907 0.175736 4.18476C0.231451 4.24045 0.297595 4.28462 0.37039 4.31476C0.443185 4.3449 0.521207 4.36041 0.6 4.36041H1.40002V12.1884C1.41426 12.442 1.47871 12.6903 1.58965 12.9188C1.7006 13.1473 1.85582 13.3515 2.04633 13.5196C2.23683 13.6877 2.45882 13.8163 2.69944 13.898C2.94005 13.9797 3.1945 14.0129 3.44802 13.9955ZM2.60002 4.36041H11.304V12.1884C11.304 12.5163 10.952 12.7961 10.504 12.7961H3.40002C2.97602 12.7961 2.60002 12.5163 2.60002 12.1884V4.36041ZM3.95429 3.16101C3.96859 3.10936 3.97602 3.0556 3.97602 3.00106V1.80966C3.97602 1.48183 4.33602 1.20197 4.77602 1.20197H9.24802C9.66403 1.20197 10.048 1.48183 10.048 1.80966V3.00106C10.0473 3.05515 10.054 3.10896 10.0678 3.16101H3.95429ZM5.57571 10.997C5.41731 10.995 5.26597 10.9311 5.15395 10.8191C5.04193 10.7071 4.97808 10.5558 4.97601 10.3973V6.77517C4.97601 6.61612 5.0392 6.46359 5.15166 6.35112C5.26413 6.23866 5.41666 6.17548 5.57571 6.17548C5.73476 6.17548 5.8873 6.23866 5.99976 6.35112C6.11223 6.46359 6.17541 6.61612 6.17541 6.77517V10.3894C6.17647 10.4688 6.16174 10.5476 6.13208 10.6213C6.10241 10.695 6.05841 10.762 6.00261 10.8186C5.94682 10.8751 5.88035 10.92 5.80707 10.9506C5.73378 10.9813 5.65514 10.9971 5.57571 10.997ZM7.99968 10.8214C8.11215 10.9339 8.26468 10.997 8.42373 10.997C8.58351 10.9949 8.73604 10.93 8.84828 10.8163C8.96052 10.7025 9.02345 10.5491 9.02343 10.3894V6.77517C9.02343 6.61612 8.96025 6.46359 8.84778 6.35112C8.73532 6.23866 8.58278 6.17548 8.42373 6.17548C8.26468 6.17548 8.11215 6.23866 7.99968 6.35112C7.88722 6.46359 7.82404 6.61612 7.82404 6.77517V10.3973C7.82404 10.5564 7.88722 10.7089 7.99968 10.8214Z",fill:"currentColor"},null,-1),lSe=[aSe],cSe=["id"],uSe=Qe("rect",{width:"14",height:"14",fill:"white"},null,-1),hSe=[uSe];function dSe(t,e,n,i,r,o){return le(),Ue("svg",Le({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),[Qe("g",{clipPath:"url(#".concat(o.pathId,")")},lSe,8,sSe),Qe("defs",null,[Qe("clipPath",{id:"".concat(o.pathId)},hSe,8,cSe)])],16)}ej.render=dSe;var JP={name:"SortAltIcon",extends:mo,computed:{pathId:function(){return"pv_icon_clip_".concat(Gr())}}},fSe=["clipPath"],pSe=Qe("path",{d:"M5.64515 3.61291C5.47353 3.61291 5.30192 3.54968 5.16644 3.4142L3.38708 1.63484L1.60773 3.4142C1.34579 3.67613 0.912244 3.67613 0.650309 3.4142C0.388374 3.15226 0.388374 2.71871 0.650309 2.45678L2.90837 0.198712C3.17031 -0.0632236 3.60386 -0.0632236 3.86579 0.198712L6.12386 2.45678C6.38579 2.71871 6.38579 3.15226 6.12386 3.4142C5.98837 3.54968 5.81676 3.61291 5.64515 3.61291Z",fill:"currentColor"},null,-1),mSe=Qe("path",{d:"M3.38714 14C3.01681 14 2.70972 13.6929 2.70972 13.3226V0.677419C2.70972 0.307097 3.01681 0 3.38714 0C3.75746 0 4.06456 0.307097 4.06456 0.677419V13.3226C4.06456 13.6929 3.75746 14 3.38714 14Z",fill:"currentColor"},null,-1),gSe=Qe("path",{d:"M10.6129 14C10.4413 14 10.2697 13.9368 10.1342 13.8013L7.87611 11.5432C7.61418 11.2813 7.61418 10.8477 7.87611 10.5858C8.13805 10.3239 8.5716 10.3239 8.83353 10.5858L10.6129 12.3652L12.3922 10.5858C12.6542 10.3239 13.0877 10.3239 13.3497 10.5858C13.6116 10.8477 13.6116 11.2813 13.3497 11.5432L11.0916 13.8013C10.9561 13.9368 10.7845 14 10.6129 14Z",fill:"currentColor"},null,-1),ySe=Qe("path",{d:"M10.6129 14C10.2426 14 9.93552 13.6929 9.93552 13.3226V0.677419C9.93552 0.307097 10.2426 0 10.6129 0C10.9833 0 11.2904 0.307097 11.2904 0.677419V13.3226C11.2904 13.6929 10.9832 14 10.6129 14Z",fill:"currentColor"},null,-1),vSe=[pSe,mSe,gSe,ySe],_Se=["id"],bSe=Qe("rect",{width:"14",height:"14",fill:"white"},null,-1),xSe=[bSe];function wSe(t,e,n,i,r,o){return le(),Ue("svg",Le({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),[Qe("g",{clipPath:"url(#".concat(o.pathId,")")},vSe,8,fSe),Qe("defs",null,[Qe("clipPath",{id:"".concat(o.pathId)},xSe,8,_Se)])],16)}JP.render=wSe;var QP={name:"SortAmountDownIcon",extends:mo,computed:{pathId:function(){return"pv_icon_clip_".concat(Gr())}}},ESe=["clipPath"],TSe=WI('<path d="M2.59836 13.2009C2.44634 13.2009 2.29432 13.1449 2.1743 13.0248L0.174024 11.0246C-0.0580081 10.7925 -0.0580081 10.4085 0.174024 10.1764C0.406057 9.94441 0.79011 9.94441 1.02214 10.1764L2.59836 11.7527L4.17458 10.1764C4.40662 9.94441 4.79067 9.94441 5.0227 10.1764C5.25473 10.4085 5.25473 10.7925 5.0227 11.0246L3.02242 13.0248C2.90241 13.1449 2.75038 13.2009 2.59836 13.2009Z" fill="currentColor"></path><path d="M2.59836 13.2009C2.27032 13.2009 1.99833 12.9288 1.99833 12.6008V1.39922C1.99833 1.07117 2.27036 0.799133 2.59841 0.799133C2.92646 0.799133 3.19849 1.07117 3.19849 1.39922V12.6008C3.19849 12.9288 2.92641 13.2009 2.59836 13.2009Z" fill="currentColor"></path><path d="M13.3999 11.2006H6.99902C6.67098 11.2006 6.39894 10.9285 6.39894 10.6005C6.39894 10.2725 6.67098 10.0004 6.99902 10.0004H13.3999C13.728 10.0004 14 10.2725 14 10.6005C14 10.9285 13.728 11.2006 13.3999 11.2006Z" fill="currentColor"></path><path d="M10.1995 6.39991H6.99902C6.67098 6.39991 6.39894 6.12788 6.39894 5.79983C6.39894 5.47179 6.67098 5.19975 6.99902 5.19975H10.1995C10.5275 5.19975 10.7996 5.47179 10.7996 5.79983C10.7996 6.12788 10.5275 6.39991 10.1995 6.39991Z" fill="currentColor"></path><path d="M8.59925 3.99958H6.99902C6.67098 3.99958 6.39894 3.72754 6.39894 3.3995C6.39894 3.07145 6.67098 2.79941 6.99902 2.79941H8.59925C8.92729 2.79941 9.19933 3.07145 9.19933 3.3995C9.19933 3.72754 8.92729 3.99958 8.59925 3.99958Z" fill="currentColor"></path><path d="M11.7997 8.80025H6.99902C6.67098 8.80025 6.39894 8.52821 6.39894 8.20017C6.39894 7.87212 6.67098 7.60008 6.99902 7.60008H11.7997C12.1277 7.60008 12.3998 7.87212 12.3998 8.20017C12.3998 8.52821 12.1277 8.80025 11.7997 8.80025Z" fill="currentColor"></path>',6),SSe=[TSe],CSe=["id"],ASe=Qe("rect",{width:"14",height:"14",fill:"white"},null,-1),PSe=[ASe];function ISe(t,e,n,i,r,o){return le(),Ue("svg",Le({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),[Qe("g",{clipPath:"url(#".concat(o.pathId,")")},SSe,8,ESe),Qe("defs",null,[Qe("clipPath",{id:"".concat(o.pathId)},PSe,8,CSe)])],16)}QP.render=ISe;var eI={name:"SortAmountUpAltIcon",extends:mo,computed:{pathId:function(){return"pv_icon_clip_".concat(Gr())}}},MSe=["clipPath"],RSe=WI('<path d="M4.59864 3.99958C4.44662 3.99958 4.2946 3.94357 4.17458 3.82356L2.59836 2.24734L1.02214 3.82356C0.79011 4.05559 0.406057 4.05559 0.174024 3.82356C-0.0580081 3.59152 -0.0580081 3.20747 0.174024 2.97544L2.1743 0.97516C2.40634 0.743127 2.79039 0.743127 3.02242 0.97516L5.0227 2.97544C5.25473 3.20747 5.25473 3.59152 5.0227 3.82356C4.90268 3.94357 4.75066 3.99958 4.59864 3.99958Z" fill="currentColor"></path><path d="M2.59841 13.2009C2.27036 13.2009 1.99833 12.9288 1.99833 12.6008V1.39922C1.99833 1.07117 2.27036 0.799133 2.59841 0.799133C2.92646 0.799133 3.19849 1.07117 3.19849 1.39922V12.6008C3.19849 12.9288 2.92646 13.2009 2.59841 13.2009Z" fill="currentColor"></path><path d="M13.3999 11.2006H6.99902C6.67098 11.2006 6.39894 10.9285 6.39894 10.6005C6.39894 10.2725 6.67098 10.0004 6.99902 10.0004H13.3999C13.728 10.0004 14 10.2725 14 10.6005C14 10.9285 13.728 11.2006 13.3999 11.2006Z" fill="currentColor"></path><path d="M10.1995 6.39991H6.99902C6.67098 6.39991 6.39894 6.12788 6.39894 5.79983C6.39894 5.47179 6.67098 5.19975 6.99902 5.19975H10.1995C10.5275 5.19975 10.7996 5.47179 10.7996 5.79983C10.7996 6.12788 10.5275 6.39991 10.1995 6.39991Z" fill="currentColor"></path><path d="M8.59925 3.99958H6.99902C6.67098 3.99958 6.39894 3.72754 6.39894 3.3995C6.39894 3.07145 6.67098 2.79941 6.99902 2.79941H8.59925C8.92729 2.79941 9.19933 3.07145 9.19933 3.3995C9.19933 3.72754 8.92729 3.99958 8.59925 3.99958Z" fill="currentColor"></path><path d="M11.7997 8.80025H6.99902C6.67098 8.80025 6.39894 8.52821 6.39894 8.20017C6.39894 7.87212 6.67098 7.60008 6.99902 7.60008H11.7997C12.1277 7.60008 12.3998 7.87212 12.3998 8.20017C12.3998 8.52821 12.1277 8.80025 11.7997 8.80025Z" fill="currentColor"></path>',6),LSe=[RSe],OSe=["id"],DSe=Qe("rect",{width:"14",height:"14",fill:"white"},null,-1),kSe=[DSe];function FSe(t,e,n,i,r,o){return le(),Ue("svg",Le({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),[Qe("g",{clipPath:"url(#".concat(o.pathId,")")},LSe,8,MSe),Qe("defs",null,[Qe("clipPath",{id:"".concat(o.pathId)},kSe,8,OSe)])],16)}eI.render=FSe;var BSe={name:"BaseDataTable",extends:Ni,props:{value:{type:Array,default:null},dataKey:{type:[String,Function],default:null},rows:{type:Number,default:0},first:{type:Number,default:0},totalRecords:{type:Number,default:0},paginator:{type:Boolean,default:!1},paginatorPosition:{type:String,default:"bottom"},alwaysShowPaginator:{type:Boolean,default:!0},paginatorTemplate:{type:[Object,String],default:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown"},pageLinkSize:{type:Number,default:5},rowsPerPageOptions:{type:Array,default:null},currentPageReportTemplate:{type:String,default:"({currentPage} of {totalPages})"},lazy:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},loadingIcon:{type:String,default:void 0},sortField:{type:[String,Function],default:null},sortOrder:{type:Number,default:null},defaultSortOrder:{type:Number,default:1},nullSortOrder:{type:Number,default:1},multiSortMeta:{type:Array,default:null},sortMode:{type:String,default:"single"},removableSort:{type:Boolean,default:!1},filters:{type:Object,default:null},filterDisplay:{type:String,default:null},globalFilterFields:{type:Array,default:null},filterLocale:{type:String,default:void 0},selection:{type:[Array,Object],default:null},selectionMode:{type:String,default:null},compareSelectionBy:{type:String,default:"deepEquals"},metaKeySelection:{type:Boolean,default:!0},contextMenu:{type:Boolean,default:!1},contextMenuSelection:{type:Object,default:null},selectAll:{type:Boolean,default:null},rowHover:{type:Boolean,default:!1},csvSeparator:{type:String,default:","},exportFilename:{type:String,default:"download"},exportFunction:{type:Function,default:null},resizableColumns:{type:Boolean,default:!1},columnResizeMode:{type:String,default:"fit"},reorderableColumns:{type:Boolean,default:!1},expandedRows:{type:Array,default:null},expandedRowIcon:{type:String,default:void 0},collapsedRowIcon:{type:String,default:void 0},rowGroupMode:{type:String,default:null},groupRowsBy:{type:[Array,String,Function],default:null},expandableRowGroups:{type:Boolean,default:!1},expandedRowGroups:{type:Array,default:null},stateStorage:{type:String,default:"session"},stateKey:{type:String,default:null},editMode:{type:String,default:null},editingRows:{type:Array,default:null},rowClass:{type:null,default:null},rowStyle:{type:null,default:null},scrollable:{type:Boolean,default:!1},virtualScrollerOptions:{type:Object,default:null},scrollHeight:{type:String,default:null},frozenValue:{type:Array,default:null},responsiveLayout:{type:String,default:"scroll"},breakpoint:{type:String,default:"960px"},showGridlines:{type:Boolean,default:!1},stripedRows:{type:Boolean,default:!1},size:{type:String,default:null},tableStyle:{type:null,default:null},tableClass:{type:String,default:null},tableProps:{type:null,default:null},filterInputProps:{type:null,default:null}},style:ITe,provide:function(){return{$parentInstance:this}}},tj={name:"RowCheckbox",hostName:"DataTable",extends:Ni,emits:["change"],props:{value:null,checked:null,column:null,rowCheckboxIconTemplate:{type:Function,default:null},index:{type:Number,default:null}},data:function(){return{focused:!1}},methods:{getColumnPT:function(e){var n={props:this.column.props,parent:{props:this.$props,state:this.$data},context:{index:this.index,checked:this.checked,focused:this.focused,disabled:this.$attrs.disabled}};return Le(this.ptm("column.".concat(e),{column:n}),this.ptm("column.".concat(e),n),this.ptmo(this.getColumnProp(),e,n))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},onClick:function(e){this.$attrs.disabled||(this.$emit("change",{originalEvent:e,data:this.value}),He.focus(this.$refs.input)),e.preventDefault()},onFocus:function(){this.focused=!0},onBlur:function(){this.focused=!1},onKeydown:function(e){switch(e.code){case"Space":{this.onClick(e);break}}}},computed:{checkboxAriaLabel:function(){return this.$primevue.config.locale.aria?this.checked?this.$primevue.config.locale.aria.selectRow:this.$primevue.config.locale.aria.unselectRow:void 0}},components:{CheckIcon:P_}},zSe=["checked","disabled","tabindex","aria-label"];function NSe(t,e,n,i,r,o){var l=Gn("CheckIcon");return le(),Ue("div",Le({class:t.cx("checkboxWrapper"),onClick:e[3]||(e[3]=function(){return o.onClick&&o.onClick.apply(o,arguments)})},o.getColumnPT("checkboxWrapper")),[Qe("div",Le({class:"p-hidden-accessible"},o.getColumnPT("hiddenInputWrapper"),{"data-p-hidden-accessible":!0}),[Qe("input",Le({ref:"input",type:"checkbox",checked:n.checked,disabled:t.$attrs.disabled,tabindex:t.$attrs.disabled?null:"0","aria-label":o.checkboxAriaLabel,onFocus:e[0]||(e[0]=function(s){return o.onFocus(s)}),onBlur:e[1]||(e[1]=function(s){return o.onBlur(s)}),onKeydown:e[2]||(e[2]=function(){return o.onKeydown&&o.onKeydown.apply(o,arguments)})},o.getColumnPT("hiddenInput")),null,16,zSe)],16),Qe("div",Le({ref:"box",class:t.cx("checkbox")},o.getColumnPT("checkbox")),[n.rowCheckboxIconTemplate?(le(),Rt(Zn(n.rowCheckboxIconTemplate),{key:0,checked:n.checked,class:ri(t.cx("checkboxIcon"))},null,8,["checked","class"])):!n.rowCheckboxIconTemplate&&n.checked?(le(),Rt(l,Le({key:1,class:t.cx("checkboxIcon")},o.getColumnPT("checkboxIcon")),null,16,["class"])):Jt("",!0)],16)],16)}tj.render=NSe;var nj={name:"RowRadioButton",hostName:"DataTable",extends:Ni,inheritAttrs:!1,emits:["change"],props:{value:null,checked:null,name:null,column:null,index:{type:Number,default:null}},data:function(){return{focused:!1}},methods:{getColumnPT:function(e){var n={props:this.column.props,parent:{props:this.$props,state:this.$data},context:{index:this.index,checked:this.checked,focused:this.focused,disabled:this.$attrs.disabled}};return Le(this.ptm("column.".concat(e),{column:n}),this.ptm("column.".concat(e),n),this.ptmo(this.getColumnProp(),e,n))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},onClick:function(e){this.disabled||this.checked||(this.$emit("change",{originalEvent:e,data:this.value}),He.focus(this.$refs.input))},onFocus:function(){this.focused=!0},onBlur:function(){this.focused=!1}}},USe=["checked","disabled","name"];function VSe(t,e,n,i,r,o){return le(),Ue("div",Le({class:t.cx("radiobuttonWrapper"),onClick:e[3]||(e[3]=function(){return o.onClick&&o.onClick.apply(o,arguments)})},o.getColumnPT("radiobuttonWrapper")),[Qe("div",Le({class:"p-hidden-accessible"},o.getColumnPT("hiddenInputWrapper"),{"data-p-hidden-accessible":!0}),[Qe("input",Le({ref:"input",type:"radio",checked:n.checked,disabled:t.$attrs.disabled,name:n.name,tabindex:"0",onFocus:e[0]||(e[0]=function(l){return o.onFocus(l)}),onBlur:e[1]||(e[1]=function(l){return o.onBlur(l)}),onKeydown:e[2]||(e[2]=fm(c_(function(){return o.onClick&&o.onClick.apply(o,arguments)},["prevent"]),["space"]))},o.getColumnPT("hiddenInput")),null,16,USe)],16),Qe("div",Le({ref:"box",class:t.cx("radiobutton")},o.getColumnPT("radiobutton")),[Qe("div",Le({class:t.cx("radiobuttonIcon")},o.getColumnPT("radiobuttonIcon")),null,16)],16)],16)}nj.render=VSe;var ij={name:"BodyCell",hostName:"DataTable",extends:Ni,emits:["cell-edit-init","cell-edit-complete","cell-edit-cancel","row-edit-init","row-edit-save","row-edit-cancel","row-toggle","radio-change","checkbox-change","editing-meta-change"],props:{rowData:{type:Object,default:null},column:{type:Object,default:null},frozenRow:{type:Boolean,default:!1},rowIndex:{type:Number,default:null},index:{type:Number,default:null},isRowExpanded:{type:Boolean,default:!1},selected:{type:Boolean,default:!1},editing:{type:Boolean,default:!1},editingMeta:{type:Object,default:null},editMode:{type:String,default:null},responsiveLayout:{type:String,default:"stack"},virtualScrollerContentProps:{type:Object,default:null},ariaControls:{type:String,default:null},name:{type:String,default:null},expandedRowIcon:{type:String,default:null},collapsedRowIcon:{type:String,default:null}},documentEditListener:null,selfClick:!1,overlayEventListener:null,data:function(){return{d_editing:this.editing,styleObject:{}}},watch:{editing:function(e){this.d_editing=e},"$data.d_editing":function(e){this.$emit("editing-meta-change",{data:this.rowData,field:this.field||"field_".concat(this.index),index:this.rowIndex,editing:e})}},mounted:function(){this.columnProp("frozen")&&this.updateStickyPosition()},updated:function(){var e=this;this.columnProp("frozen")&&this.updateStickyPosition(),this.d_editing&&(this.editMode==="cell"||this.editMode==="row"&&this.columnProp("rowEditor"))&&setTimeout(function(){var n=He.getFirstFocusableElement(e.$el);n&&n.focus()},1)},beforeUnmount:function(){this.overlayEventListener&&(_h.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null)},methods:{columnProp:function(e){return At.getVNodeProp(this.column,e)},getColumnPT:function(e){var n,i,r={props:this.column.props,parent:{props:this.$props,state:this.$data},context:{index:this.index,size:(n=this.$parentInstance)===null||n===void 0||(n=n.$parentInstance)===null||n===void 0?void 0:n.size,showGridlines:(i=this.$parentInstance)===null||i===void 0||(i=i.$parentInstance)===null||i===void 0?void 0:i.showGridlines}};return Le(this.ptm("column.".concat(e),{column:r}),this.ptm("column.".concat(e),r),this.ptmo(this.getColumnProp(),e,r))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},resolveFieldData:function(){return At.resolveFieldData(this.rowData,this.field)},toggleRow:function(e){this.$emit("row-toggle",{originalEvent:e,data:this.rowData})},toggleRowWithRadio:function(e,n){this.$emit("radio-change",{originalEvent:e.originalEvent,index:n,data:e.data})},toggleRowWithCheckbox:function(e,n){this.$emit("checkbox-change",{originalEvent:e.originalEvent,index:n,data:e.data})},isEditable:function(){return this.column.children&&this.column.children.editor!=null},bindDocumentEditListener:function(){var e=this;this.documentEditListener||(this.documentEditListener=function(n){e.selfClick||e.completeEdit(n,"outside"),e.selfClick=!1},document.addEventListener("click",this.documentEditListener))},unbindDocumentEditListener:function(){this.documentEditListener&&(document.removeEventListener("click",this.documentEditListener),this.documentEditListener=null,this.selfClick=!1)},switchCellToViewMode:function(){this.d_editing=!1,this.unbindDocumentEditListener(),_h.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null},onClick:function(e){var n=this;this.editMode==="cell"&&this.isEditable()&&(this.selfClick=!0,this.d_editing||(this.d_editing=!0,this.bindDocumentEditListener(),this.$emit("cell-edit-init",{originalEvent:e,data:this.rowData,field:this.field,index:this.rowIndex}),this.overlayEventListener=function(i){n.$el&&n.$el.contains(i.target)&&(n.selfClick=!0)},_h.on("overlay-click",this.overlayEventListener)))},completeEdit:function(e,n){var i={originalEvent:e,data:this.rowData,newData:this.editingRowData,value:this.rowData[this.field],newValue:this.editingRowData[this.field],field:this.field,index:this.rowIndex,type:n,defaultPrevented:!1,preventDefault:function(){this.defaultPrevented=!0}};this.$emit("cell-edit-complete",i),i.defaultPrevented||this.switchCellToViewMode()},onKeyDown:function(e){if(this.editMode==="cell")switch(e.code){case"Enter":case"NumpadEnter":this.completeEdit(e,"enter");break;case"Escape":this.switchCellToViewMode(),this.$emit("cell-edit-cancel",{originalEvent:e,data:this.rowData,field:this.field,index:this.rowIndex});break;case"Tab":this.completeEdit(e,"tab"),e.shiftKey?this.moveToPreviousCell(e):this.moveToNextCell(e);break}},moveToPreviousCell:function(e){var n=this.findCell(e.target),i=this.findPreviousEditableColumn(n);i&&(He.invokeElementMethod(i,"click"),e.preventDefault())},moveToNextCell:function(e){var n=this.findCell(e.target),i=this.findNextEditableColumn(n);i&&(He.invokeElementMethod(i,"click"),e.preventDefault())},findCell:function(e){if(e){for(var n=e;n&&!He.getAttribute(n,"data-p-cell-editing");)n=n.parentElement;return n}else return null},findPreviousEditableColumn:function(e){var n=e.previousElementSibling;if(!n){var i=e.parentElement.previousElementSibling;i&&(n=i.lastElementChild)}return n?He.getAttribute(n,"data-p-editable-column")?n:this.findPreviousEditableColumn(n):null},findNextEditableColumn:function(e){var n=e.nextElementSibling;if(!n){var i=e.parentElement.nextElementSibling;i&&(n=i.firstElementChild)}return n?He.getAttribute(n,"data-p-editable-column")?n:this.findNextEditableColumn(n):null},isEditingCellValid:function(){return He.find(this.$el,".p-invalid").length===0},onRowEditInit:function(e){this.$emit("row-edit-init",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex})},onRowEditSave:function(e){this.$emit("row-edit-save",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex})},onRowEditCancel:function(e){this.$emit("row-edit-cancel",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex})},editorInitCallback:function(e){this.$emit("row-edit-init",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex})},editorSaveCallback:function(e){this.editMode==="row"?this.$emit("row-edit-save",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex}):this.completeEdit(e,"enter")},editorCancelCallback:function(e){this.editMode==="row"?this.$emit("row-edit-cancel",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex}):(this.switchCellToViewMode(),this.$emit("cell-edit-cancel",{originalEvent:e,data:this.rowData,field:this.field,index:this.rowIndex}))},updateStickyPosition:function(){if(this.columnProp("frozen")){var e=this.columnProp("alignFrozen");if(e==="right"){var n=0,i=this.$el.nextElementSibling;i&&(n=He.getOuterWidth(i)+parseFloat(i.style.right||0)),this.styleObject.right=n+"px"}else{var r=0,o=this.$el.previousElementSibling;o&&(r=He.getOuterWidth(o)+parseFloat(o.style.left||0)),this.styleObject.left=r+"px"}}},getVirtualScrollerProp:function(e){return this.virtualScrollerContentProps?this.virtualScrollerContentProps[e]:null}},computed:{editingRowData:function(){return this.editingMeta[this.rowIndex]?this.editingMeta[this.rowIndex].data:this.rowData},field:function(){return this.columnProp("field")},containerClass:function(){return[this.columnProp("bodyClass"),this.columnProp("class"),this.cx("bodyCell")]},containerStyle:function(){var e=this.columnProp("bodyStyle"),n=this.columnProp("style");return this.columnProp("frozen")?[n,e,this.styleObject]:[n,e]},loading:function(){return this.getVirtualScrollerProp("loading")},loadingOptions:function(){var e=this.getVirtualScrollerProp("getLoaderOptions");return e&&e(this.rowIndex,{cellIndex:this.index,cellFirst:this.index===0,cellLast:this.index===this.getVirtualScrollerProp("columns").length-1,cellEven:this.index%2===0,cellOdd:this.index%2!==0,column:this.column,field:this.field})},expandButtonAriaLabel:function(){return this.$primevue.config.locale.aria?this.isRowExpanded?this.$primevue.config.locale.aria.expandRow:this.$primevue.config.locale.aria.collapseRow:void 0},initButtonAriaLabel:function(){return this.$primevue.config.locale.aria?this.$primevue.config.locale.aria.editRow:void 0},saveButtonAriaLabel:function(){return this.$primevue.config.locale.aria?this.$primevue.config.locale.aria.saveEdit:void 0},cancelButtonAriaLabel:function(){return this.$primevue.config.locale.aria?this.$primevue.config.locale.aria.cancelEdit:void 0}},components:{DTRadioButton:nj,DTCheckbox:tj,ChevronDownIcon:j2,ChevronRightIcon:$3,BarsIcon:qV,PencilIcon:YV,CheckIcon:P_,TimesIcon:a3},directives:{ripple:Rl}};function Uv(t){"@babel/helpers - typeof";return Uv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uv(t)}function WF(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function rx(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?WF(Object(n),!0).forEach(function(i){jSe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):WF(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function jSe(t,e,n){return e=$Se(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $Se(t){var e=GSe(t,"string");return Uv(e)==="symbol"?e:String(e)}function GSe(t,e){if(Uv(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Uv(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var HSe=["colspan","rowspan","data-p-selection-column","data-p-editable-column","data-p-cell-editing","data-p-frozen-column"],WSe=["aria-expanded","aria-controls","aria-label"],KSe=["aria-label"],XSe=["aria-label"],ZSe=["aria-label"];function qSe(t,e,n,i,r,o){var l=Gn("DTRadioButton"),s=Gn("DTCheckbox"),d=Gn("BarsIcon"),p=Gn("ChevronDownIcon"),y=Gn("ChevronRightIcon"),v=ea("ripple");return o.loading?(le(),Ue("td",Le({key:0,style:o.containerStyle,class:o.containerClass,role:"cell"},rx(rx({},o.getColumnPT("root")),o.getColumnPT("bodyCell"))),[(le(),Rt(Zn(n.column.children.loading),{data:n.rowData,column:n.column,field:o.field,index:n.rowIndex,frozenRow:n.frozenRow,loadingOptions:o.loadingOptions},null,8,["data","column","field","index","frozenRow","loadingOptions"]))],16)):(le(),Ue("td",Le({key:1,style:o.containerStyle,class:o.containerClass,colspan:o.columnProp("colspan"),rowspan:o.columnProp("rowspan"),onClick:e[6]||(e[6]=function(){return o.onClick&&o.onClick.apply(o,arguments)}),onKeydown:e[7]||(e[7]=function(){return o.onKeyDown&&o.onKeyDown.apply(o,arguments)}),role:"cell"},rx(rx({},o.getColumnPT("root")),o.getColumnPT("bodyCell")),{"data-p-selection-column":o.columnProp("selectionMode")!=null,"data-p-editable-column":o.isEditable(),"data-p-cell-editing":r.d_editing,"data-p-frozen-column":o.columnProp("frozen")}),[n.responsiveLayout==="stack"?(le(),Ue("span",Le({key:0,class:t.cx("columnTitle")},o.getColumnPT("columnTitle")),ki(o.columnProp("header")),17)):Jt("",!0),n.column.children&&n.column.children.body&&!r.d_editing?(le(),Rt(Zn(n.column.children.body),{key:1,data:n.rowData,column:n.column,field:o.field,index:n.rowIndex,frozenRow:n.frozenRow,editorInitCallback:o.editorInitCallback},null,8,["data","column","field","index","frozenRow","editorInitCallback"])):n.column.children&&n.column.children.editor&&r.d_editing?(le(),Rt(Zn(n.column.children.editor),{key:2,data:o.editingRowData,column:n.column,field:o.field,index:n.rowIndex,frozenRow:n.frozenRow,editorSaveCallback:o.editorSaveCallback,editorCancelCallback:o.editorCancelCallback},null,8,["data","column","field","index","frozenRow","editorSaveCallback","editorCancelCallback"])):n.column.children&&n.column.children.body&&!n.column.children.editor&&r.d_editing?(le(),Rt(Zn(n.column.children.body),{key:3,data:o.editingRowData,column:n.column,field:o.field,index:n.rowIndex,frozenRow:n.frozenRow},null,8,["data","column","field","index","frozenRow"])):o.columnProp("selectionMode")?(le(),Ue(_n,{key:4},[o.columnProp("selectionMode")==="single"?(le(),Rt(l,{key:0,value:n.rowData,name:n.name,checked:n.selected,onChange:e[0]||(e[0]=function(w){return o.toggleRowWithRadio(w,n.rowIndex)}),column:n.column,index:n.index,unstyled:t.unstyled,pt:t.pt},null,8,["value","name","checked","column","index","unstyled","pt"])):o.columnProp("selectionMode")==="multiple"?(le(),Rt(s,{key:1,value:n.rowData,checked:n.selected,rowCheckboxIconTemplate:n.column.children&&n.column.children.rowcheckboxicon,"aria-selected":n.selected?!0:void 0,onChange:e[1]||(e[1]=function(w){return o.toggleRowWithCheckbox(w,n.rowIndex)}),column:n.column,index:n.index,unstyled:t.unstyled,pt:t.pt},null,8,["value","checked","rowCheckboxIconTemplate","aria-selected","column","index","unstyled","pt"])):Jt("",!0)],64)):o.columnProp("rowReorder")?(le(),Ue(_n,{key:5},[n.column.children&&n.column.children.rowreordericon?(le(),Rt(Zn(n.column.children.rowreordericon),{key:0,class:ri(t.cx("rowReorderIcon"))},null,8,["class"])):o.columnProp("rowReorderIcon")?(le(),Ue("i",Le({key:1,class:[t.cx("rowReorderIcon"),o.columnProp("rowReorderIcon")]},o.getColumnPT("rowReorderIcon")),null,16)):(le(),Rt(d,Le({key:2,class:t.cx("rowReorderIcon")},o.getColumnPT("rowReorderIcon")),null,16,["class"]))],64)):o.columnProp("expander")?fo((le(),Ue("button",Le({key:6,class:t.cx("rowToggler"),type:"button","aria-expanded":n.isRowExpanded,"aria-controls":n.ariaControls,"aria-label":o.expandButtonAriaLabel,onClick:e[2]||(e[2]=function(){return o.toggleRow&&o.toggleRow.apply(o,arguments)})},o.getColumnPT("rowToggler"),{"data-pc-group-section":"rowactionbutton"}),[n.column.children&&n.column.children.rowtogglericon?(le(),Rt(Zn(n.column.children.rowtogglericon),{key:0,class:ri(t.cx("rowTogglerIcon")),rowExpanded:n.isRowExpanded},null,8,["class","rowExpanded"])):(le(),Ue(_n,{key:1},[n.isRowExpanded&&n.expandedRowIcon?(le(),Ue("span",{key:0,class:ri([t.cx("rowTogglerIcon"),n.expandedRowIcon])},null,2)):n.isRowExpanded&&!n.expandedRowIcon?(le(),Rt(p,Le({key:1,class:t.cx("rowTogglerIcon")},o.getColumnPT("rowTogglerIcon")),null,16,["class"])):!n.isRowExpanded&&n.collapsedRowIcon?(le(),Ue("span",{key:2,class:ri([t.cx("rowTogglerIcon"),n.collapsedRowIcon])},null,2)):!n.isRowExpanded&&!n.collapsedRowIcon?(le(),Rt(y,Le({key:3,class:t.cx("rowTogglerIcon")},o.getColumnPT("rowTogglerIcon")),null,16,["class"])):Jt("",!0)],64))],16,WSe)),[[v]]):n.editMode==="row"&&o.columnProp("rowEditor")?(le(),Ue(_n,{key:7},[r.d_editing?Jt("",!0):fo((le(),Ue("button",Le({key:0,class:t.cx("rowEditorInitButton"),type:"button","aria-label":o.initButtonAriaLabel,onClick:e[3]||(e[3]=function(){return o.onRowEditInit&&o.onRowEditInit.apply(o,arguments)})},o.getColumnPT("rowEditorInitButton"),{"data-pc-group-section":"rowactionbutton"}),[(le(),Rt(Zn(n.column.children&&n.column.children.roweditoriniticon||"PencilIcon"),Le({class:t.cx("rowEditorInitIcon")},o.getColumnPT("rowEditorInitIcon")),null,16,["class"]))],16,KSe)),[[v]]),r.d_editing?fo((le(),Ue("button",Le({key:1,class:t.cx("rowEditorSaveButton"),type:"button","aria-label":o.saveButtonAriaLabel,onClick:e[4]||(e[4]=function(){return o.onRowEditSave&&o.onRowEditSave.apply(o,arguments)})},o.getColumnPT("rowEditorSaveButton"),{"data-pc-group-section":"rowactionbutton"}),[(le(),Rt(Zn(n.column.children&&n.column.children.roweditorsaveicon||"CheckIcon"),Le({class:t.cx("rowEditorSaveIcon")},o.getColumnPT("rowEditorSaveIcon")),null,16,["class"]))],16,XSe)),[[v]]):Jt("",!0),r.d_editing?fo((le(),Ue("button",Le({key:2,class:t.cx("rowEditorCancelButton"),type:"button","aria-label":o.cancelButtonAriaLabel,onClick:e[5]||(e[5]=function(){return o.onRowEditCancel&&o.onRowEditCancel.apply(o,arguments)})},o.getColumnPT("rowEditorCancelButton"),{"data-pc-group-section":"rowactionbutton"}),[(le(),Rt(Zn(n.column.children&&n.column.children.roweditorcancelicon||"TimesIcon"),Le({class:t.cx("rowEditorCancelIcon")},o.getColumnPT("rowEditorCancelIcon")),null,16,["class"]))],16,ZSe)),[[v]]):Jt("",!0)],64)):(le(),Ue(_n,{key:8},[vo(ki(o.resolveFieldData()),1)],64))],16,HSe))}ij.render=qSe;var rj={name:"TableBody",hostName:"DataTable",extends:Ni,emits:["rowgroup-toggle","row-click","row-dblclick","row-rightclick","row-touchend","row-keydown","row-mousedown","row-dragstart","row-dragover","row-dragleave","row-dragend","row-drop","row-toggle","radio-change","checkbox-change","cell-edit-init","cell-edit-complete","cell-edit-cancel","row-edit-init","row-edit-save","row-edit-cancel","editing-meta-change"],props:{value:{type:Array,default:null},columns:{type:null,default:null},frozenRow:{type:Boolean,default:!1},empty:{type:Boolean,default:!1},rowGroupMode:{type:String,default:null},groupRowsBy:{type:[Array,String,Function],default:null},expandableRowGroups:{type:Boolean,default:!1},expandedRowGroups:{type:Array,default:null},first:{type:Number,default:0},dataKey:{type:[String,Function],default:null},expandedRowIcon:{type:String,default:null},collapsedRowIcon:{type:String,default:null},expandedRows:{type:Array,default:null},expandedRowKeys:{type:null,default:null},selection:{type:[Array,Object],default:null},selectionKeys:{type:null,default:null},selectionMode:{type:String,default:null},contextMenu:{type:Boolean,default:!1},contextMenuSelection:{type:Object,default:null},rowClass:{type:null,default:null},rowStyle:{type:null,default:null},editMode:{type:String,default:null},compareSelectionBy:{type:String,default:"deepEquals"},editingRows:{type:Array,default:null},editingRowKeys:{type:null,default:null},editingMeta:{type:Object,default:null},templates:{type:null,default:null},scrollable:{type:Boolean,default:!1},responsiveLayout:{type:String,default:"stack"},virtualScrollerContentProps:{type:Object,default:null},isVirtualScrollerDisabled:{type:Boolean,default:!1}},data:function(){return{rowGroupHeaderStyleObject:{},tabindexArray:[],isARowSelected:!1}},mounted:function(){this.frozenRow&&this.updateFrozenRowStickyPosition(),this.scrollable&&this.rowGroupMode==="subheader"&&this.updateFrozenRowGroupHeaderStickyPosition()},updated:function(){this.frozenRow&&this.updateFrozenRowStickyPosition(),this.scrollable&&this.rowGroupMode==="subheader"&&this.updateFrozenRowGroupHeaderStickyPosition()},methods:{columnProp:function(e,n){return At.getVNodeProp(e,n)},getColumnPT:function(e){var n={parent:{props:this.$props,state:this.$data}};return Le(this.ptm("column.".concat(e),{column:n}),this.ptm("column.".concat(e),n),this.ptmo(this.getColumnProp({}),e,n))},getColumnProp:function(e){return e.props&&e.props.pt?e.props.pt:void 0},getBodyRowPTOptions:function(e,n,i){var r,o,l;return this.ptm(e,{context:{index:i,selectable:((r=this.$parentInstance)===null||r===void 0||(r=r.$parentInstance)===null||r===void 0?void 0:r.rowHover)||((o=this.$parentInstance)===null||o===void 0||(o=o.$parentInstance)===null||o===void 0?void 0:o.selectionMode),selected:this.isSelected(n),stripedRows:((l=this.$parentInstance)===null||l===void 0||(l=l.$parentInstance)===null||l===void 0?void 0:l.stripedRows)||!1}})},shouldRenderRowGroupHeader:function(e,n,i){var r=At.resolveFieldData(n,this.groupRowsBy),o=e[i-1];if(o){var l=At.resolveFieldData(o,this.groupRowsBy);return r!==l}else return!0},getRowKey:function(e,n){return this.dataKey?At.resolveFieldData(e,this.dataKey):this.getRowIndex(n)},getRowIndex:function(e){var n=this.getVirtualScrollerProp("getItemOptions");return n?n(e).index:e},getRowStyle:function(e){if(this.rowStyle)return this.rowStyle(e)},getRowClass:function(e){var n=[];if(this.rowClass){var i=this.rowClass(e);i&&n.push(i)}return[this.cx("row",{rowData:e}),n]},shouldRenderRowGroupFooter:function(e,n,i){if(this.expandableRowGroups&&!this.isRowGroupExpanded(n))return!1;var r=At.resolveFieldData(n,this.groupRowsBy),o=e[i+1];if(o){var l=At.resolveFieldData(o,this.groupRowsBy);return r!==l}else return!0},shouldRenderBodyCell:function(e,n,i){if(this.rowGroupMode){if(this.rowGroupMode==="subheader")return this.groupRowsBy!==this.columnProp(n,"field");if(this.rowGroupMode==="rowspan")if(this.isGrouped(n)){var r=e[i-1];if(r){var o=At.resolveFieldData(e[i],this.columnProp(n,"field")),l=At.resolveFieldData(r,this.columnProp(n,"field"));return o!==l}else return!0}else return!0}else return!this.columnProp(n,"hidden")},calculateRowGroupSize:function(e,n,i){if(this.isGrouped(n)){for(var r=At.resolveFieldData(e[i],this.columnProp(n,"field")),o=r,l=0;r===o;){l++;var s=e[++i];if(s)o=At.resolveFieldData(s,this.columnProp(n,"field"));else break}return l===1?null:l}else return null},isGrouped:function(e){return this.groupRowsBy&&this.columnProp(e,"field")?Array.isArray(this.groupRowsBy)?this.groupRowsBy.indexOf(e.props.field)>-1:this.groupRowsBy===e.props.field:!1},isRowEditing:function(e){return e&&this.editingRows?this.dataKey?this.editingRowKeys?this.editingRowKeys[At.resolveFieldData(e,this.dataKey)]!==void 0:!1:this.findIndex(e,this.editingRows)>-1:!1},isRowExpanded:function(e){return e&&this.expandedRows?this.dataKey?this.expandedRowKeys?this.expandedRowKeys[At.resolveFieldData(e,this.dataKey)]!==void 0:!1:this.findIndex(e,this.expandedRows)>-1:!1},isRowGroupExpanded:function(e){if(this.expandableRowGroups&&this.expandedRowGroups){var n=At.resolveFieldData(e,this.groupRowsBy);return this.expandedRowGroups.indexOf(n)>-1}return!1},isSelected:function(e){return e&&this.selection?this.dataKey?this.selectionKeys?this.selectionKeys[At.resolveFieldData(e,this.dataKey)]!==void 0:!1:this.selection instanceof Array?this.findIndexInSelection(e)>-1:this.equals(e,this.selection):!1},isSelectedWithContextMenu:function(e){return e&&this.contextMenuSelection?this.equals(e,this.contextMenuSelection,this.dataKey):!1},findIndexInSelection:function(e){return this.findIndex(e,this.selection)},findIndex:function(e,n){var i=-1;if(n&&n.length){for(var r=0;r<n.length;r++)if(this.equals(e,n[r])){i=r;break}}return i},equals:function(e,n){return this.compareSelectionBy==="equals"?e===n:At.equals(e,n,this.dataKey)},onRowGroupToggle:function(e,n){this.$emit("rowgroup-toggle",{originalEvent:e,data:n})},onRowClick:function(e,n,i){this.$emit("row-click",{originalEvent:e,data:n,index:i})},onRowDblClick:function(e,n,i){this.$emit("row-dblclick",{originalEvent:e,data:n,index:i})},onRowRightClick:function(e,n,i){this.$emit("row-rightclick",{originalEvent:e,data:n,index:i})},onRowTouchEnd:function(e){this.$emit("row-touchend",e)},onRowKeyDown:function(e,n,i){this.$emit("row-keydown",{originalEvent:e,data:n,index:i})},onRowMouseDown:function(e){this.$emit("row-mousedown",e)},onRowDragStart:function(e,n){this.$emit("row-dragstart",{originalEvent:e,index:n})},onRowDragOver:function(e,n){this.$emit("row-dragover",{originalEvent:e,index:n})},onRowDragLeave:function(e){this.$emit("row-dragleave",e)},onRowDragEnd:function(e){this.$emit("row-dragend",e)},onRowDrop:function(e){this.$emit("row-drop",e)},onRowToggle:function(e){this.$emit("row-toggle",e)},onRadioChange:function(e){this.$emit("radio-change",e)},onCheckboxChange:function(e){this.$emit("checkbox-change",e)},onCellEditInit:function(e){this.$emit("cell-edit-init",e)},onCellEditComplete:function(e){this.$emit("cell-edit-complete",e)},onCellEditCancel:function(e){this.$emit("cell-edit-cancel",e)},onRowEditInit:function(e){this.$emit("row-edit-init",e)},onRowEditSave:function(e){this.$emit("row-edit-save",e)},onRowEditCancel:function(e){this.$emit("row-edit-cancel",e)},onEditingMetaChange:function(e){this.$emit("editing-meta-change",e)},updateFrozenRowStickyPosition:function(){this.$el.style.top=He.getOuterHeight(this.$el.previousElementSibling)+"px"},updateFrozenRowGroupHeaderStickyPosition:function(){var e=He.getOuterHeight(this.$el.previousElementSibling);this.rowGroupHeaderStyleObject.top=e+"px"},getVirtualScrollerProp:function(e,n){return n=n||this.virtualScrollerContentProps,n?n[e]:null},bodyRef:function(e){var n=this.getVirtualScrollerProp("contentRef");n&&n(e)},setRowTabindex:function(e){return this.selection===null&&(this.selectionMode==="single"||this.selectionMode==="multiple")&&e===0?0:-1}},computed:{columnsLength:function(){var e=this,n=0;return this.columns.forEach(function(i){e.columnProp(i,"selectionMode")==="single"&&n--,e.columnProp(i,"hidden")&&n++}),this.columns?this.columns.length-n:0},rowGroupHeaderStyle:function(){return this.scrollable?{top:this.rowGroupHeaderStyleObject.top}:null},bodyStyle:function(){return this.getVirtualScrollerProp("contentStyle")},expandedRowId:function(){return Gr()},nameAttributeSelector:function(){return Gr()},ptmTBodyOptions:function(){var e;return{context:{scrollable:(e=this.$parentInstance)===null||e===void 0||(e=e.$parentInstance)===null||e===void 0?void 0:e.scrollable}}}},components:{DTBodyCell:ij,ChevronDownIcon:j2,ChevronRightIcon:$3}};function Vv(t){"@babel/helpers - typeof";return Vv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vv(t)}function KF(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function sh(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?KF(Object(n),!0).forEach(function(i){YSe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):KF(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function YSe(t,e,n){return e=JSe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JSe(t){var e=QSe(t,"string");return Vv(e)==="symbol"?e:String(e)}function QSe(t,e){if(Vv(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Vv(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var eCe=["colspan"],tCe=["onClick"],nCe=["tabindex","aria-selected","onClick","onDblclick","onContextmenu","onKeydown","onDragstart","onDragover","data-p-selectable-row","data-p-highlight","data-p-highlight-contextmenu"],iCe=["id"],rCe=["colspan"],oCe=["colspan"],sCe=["colspan"];function aCe(t,e,n,i,r,o){var l=Gn("ChevronDownIcon"),s=Gn("ChevronRightIcon"),d=Gn("DTBodyCell");return le(),Ue("tbody",Le({ref:o.bodyRef,class:t.cx("tbody"),role:"rowgroup",style:o.bodyStyle},t.ptm("tbody",o.ptmTBodyOptions)),[n.empty?(le(),Ue("tr",Le({key:1,class:t.cx("emptyMessage"),role:"row"},t.ptm("emptyMessage")),[Qe("td",Le({colspan:o.columnsLength},sh(sh({},o.getColumnPT("bodycell")),t.ptm("emptyMessageCell"))),[n.templates.empty?(le(),Rt(Zn(n.templates.empty),{key:0})):Jt("",!0)],16,sCe)],16)):(le(!0),Ue(_n,{key:0},or(n.value,function(p,y){return le(),Ue(_n,null,[n.templates.groupheader&&n.rowGroupMode==="subheader"&&o.shouldRenderRowGroupHeader(n.value,p,o.getRowIndex(y))?(le(),Ue("tr",Le({key:o.getRowKey(p,o.getRowIndex(y))+"_subheader",class:t.cx("rowGroupHeader"),style:o.rowGroupHeaderStyle,role:"row"},t.ptm("rowGroupHeader")),[Qe("td",Le({colspan:o.columnsLength-1},sh(sh({},o.getColumnPT("bodycell")),t.ptm("rowGroupHeaderCell"))),[n.expandableRowGroups?(le(),Ue("button",Le({key:0,class:t.cx("rowGroupToggler"),onClick:function(w){return o.onRowGroupToggle(w,p)},type:"button"},t.ptm("rowGroupToggler")),[n.templates.rowgrouptogglericon?(le(),Rt(Zn(n.templates.rowgrouptogglericon),{key:0,expanded:o.isRowGroupExpanded(p)},null,8,["expanded"])):(le(),Ue(_n,{key:1},[o.isRowGroupExpanded(p)&&n.expandedRowIcon?(le(),Ue("span",Le({key:0,class:[t.cx("rowGroupTogglerIcon"),n.expandedRowIcon]},t.ptm("rowGroupTogglerIcon")),null,16)):o.isRowGroupExpanded(p)&&!n.expandedRowIcon?(le(),Rt(l,Le({key:1,class:t.cx("rowGroupTogglerIcon")},t.ptm("rowGroupTogglerIcon")),null,16,["class"])):!o.isRowGroupExpanded(p)&&n.collapsedRowIcon?(le(),Ue("span",Le({key:2,class:[t.cx("rowGroupTogglerIcon"),n.collapsedRowIcon]},t.ptm("rowGroupTogglerIcon")),null,16)):!o.isRowGroupExpanded(p)&&!n.collapsedRowIcon?(le(),Rt(s,Le({key:3,class:t.cx("rowGroupTogglerIcon")},t.ptm("rowGroupTogglerIcon")),null,16,["class"])):Jt("",!0)],64))],16,tCe)):Jt("",!0),(le(),Rt(Zn(n.templates.groupheader),{data:p,index:o.getRowIndex(y)},null,8,["data","index"]))],16,eCe)],16)):Jt("",!0),!n.expandableRowGroups||o.isRowGroupExpanded(p)?(le(),Ue("tr",Le({key:o.getRowKey(p,o.getRowIndex(y)),class:o.getRowClass(p),style:o.getRowStyle(p),tabindex:o.setRowTabindex(y),role:"row","aria-selected":n.selectionMode?o.isSelected(p):null,onClick:function(w){return o.onRowClick(w,p,o.getRowIndex(y))},onDblclick:function(w){return o.onRowDblClick(w,p,o.getRowIndex(y))},onContextmenu:function(w){return o.onRowRightClick(w,p,o.getRowIndex(y))},onTouchend:e[9]||(e[9]=function(v){return o.onRowTouchEnd(v)}),onKeydown:c_(function(v){return o.onRowKeyDown(v,p,o.getRowIndex(y))},["self"]),onMousedown:e[10]||(e[10]=function(v){return o.onRowMouseDown(v)}),onDragstart:function(w){return o.onRowDragStart(w,o.getRowIndex(y))},onDragover:function(w){return o.onRowDragOver(w,o.getRowIndex(y))},onDragleave:e[11]||(e[11]=function(v){return o.onRowDragLeave(v)}),onDragend:e[12]||(e[12]=function(v){return o.onRowDragEnd(v)}),onDrop:e[13]||(e[13]=function(v){return o.onRowDrop(v)})},o.getBodyRowPTOptions("bodyRow",p,y),{"data-p-selectable-row":!!n.selectionMode,"data-p-highlight":n.selection&&o.isSelected(p),"data-p-highlight-contextmenu":n.contextMenuSelection&&o.isSelectedWithContextMenu(p)}),[(le(!0),Ue(_n,null,or(n.columns,function(v,w){return le(),Ue(_n,null,[o.shouldRenderBodyCell(n.value,v,o.getRowIndex(y))?(le(),Rt(d,{key:o.columnProp(v,"columnKey")||o.columnProp(v,"field")||w,rowData:p,column:v,rowIndex:o.getRowIndex(y),index:w,selected:o.isSelected(p),frozenRow:n.frozenRow,rowspan:n.rowGroupMode==="rowspan"?o.calculateRowGroupSize(n.value,v,o.getRowIndex(y)):null,editMode:n.editMode,editing:n.editMode==="row"&&o.isRowEditing(p),editingMeta:n.editingMeta,responsiveLayout:n.responsiveLayout,virtualScrollerContentProps:n.virtualScrollerContentProps,ariaControls:o.expandedRowId+"_"+y+"_expansion",name:o.nameAttributeSelector,isRowExpanded:o.isRowExpanded(p),expandedRowIcon:n.expandedRowIcon,collapsedRowIcon:n.collapsedRowIcon,onRadioChange:e[0]||(e[0]=function(T){return o.onRadioChange(T)}),onCheckboxChange:e[1]||(e[1]=function(T){return o.onCheckboxChange(T)}),onRowToggle:e[2]||(e[2]=function(T){return o.onRowToggle(T)}),onCellEditInit:e[3]||(e[3]=function(T){return o.onCellEditInit(T)}),onCellEditComplete:e[4]||(e[4]=function(T){return o.onCellEditComplete(T)}),onCellEditCancel:e[5]||(e[5]=function(T){return o.onCellEditCancel(T)}),onRowEditInit:e[6]||(e[6]=function(T){return o.onRowEditInit(T)}),onRowEditSave:e[7]||(e[7]=function(T){return o.onRowEditSave(T)}),onRowEditCancel:e[8]||(e[8]=function(T){return o.onRowEditCancel(T)}),onEditingMetaChange:o.onEditingMetaChange,unstyled:t.unstyled,pt:t.pt},null,8,["rowData","column","rowIndex","index","selected","frozenRow","rowspan","editMode","editing","editingMeta","responsiveLayout","virtualScrollerContentProps","ariaControls","name","isRowExpanded","expandedRowIcon","collapsedRowIcon","onEditingMetaChange","unstyled","pt"])):Jt("",!0)],64)}),256))],16,nCe)):Jt("",!0),n.templates.expansion&&n.expandedRows&&o.isRowExpanded(p)?(le(),Ue("tr",Le({key:o.getRowKey(p,o.getRowIndex(y))+"_expansion",id:o.expandedRowId+"_"+y+"_expansion",class:t.cx("rowExpansion"),role:"row"},t.ptm("rowExpansion")),[Qe("td",Le({colspan:o.columnsLength},sh(sh({},o.getColumnPT("bodycell")),t.ptm("rowExpansionCell"))),[(le(),Rt(Zn(n.templates.expansion),{data:p,index:o.getRowIndex(y)},null,8,["data","index"]))],16,rCe)],16,iCe)):Jt("",!0),n.templates.groupfooter&&n.rowGroupMode==="subheader"&&o.shouldRenderRowGroupFooter(n.value,p,o.getRowIndex(y))?(le(),Ue("tr",Le({key:o.getRowKey(p,o.getRowIndex(y))+"_subfooter",class:t.cx("rowGroupFooter"),role:"row"},t.ptm("rowGroupFooter")),[Qe("td",Le({colspan:o.columnsLength-1},sh(sh({},o.getColumnPT("bodycell")),t.ptm("rowGroupFooterCell"))),[(le(),Rt(Zn(n.templates.groupfooter),{data:p,index:o.getRowIndex(y)},null,8,["data","index"]))],16,oCe)],16)):Jt("",!0)],64)}),256))],16)}rj.render=aCe;var oj={name:"FooterCell",hostName:"DataTable",extends:Ni,props:{column:{type:Object,default:null},index:{type:Number,default:null}},data:function(){return{styleObject:{}}},mounted:function(){this.columnProp("frozen")&&this.updateStickyPosition()},updated:function(){this.columnProp("frozen")&&this.updateStickyPosition()},methods:{columnProp:function(e){return At.getVNodeProp(this.column,e)},getColumnPT:function(e){var n,i,r={props:this.column.props,parent:{props:this.$props,state:this.$data},context:{index:this.index,size:(n=this.$parentInstance)===null||n===void 0||(n=n.$parentInstance)===null||n===void 0?void 0:n.size,showGridlines:((i=this.$parentInstance)===null||i===void 0||(i=i.$parentInstance)===null||i===void 0?void 0:i.showGridlines)||!1}};return Le(this.ptm("column.".concat(e),{column:r}),this.ptm("column.".concat(e),r),this.ptmo(this.getColumnProp(),e,r))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},updateStickyPosition:function(){if(this.columnProp("frozen")){var e=this.columnProp("alignFrozen");if(e==="right"){var n=0,i=this.$el.nextElementSibling;i&&(n=He.getOuterWidth(i)+parseFloat(i.style.right||0)),this.styleObject.right=n+"px"}else{var r=0,o=this.$el.previousElementSibling;o&&(r=He.getOuterWidth(o)+parseFloat(o.style.left||0)),this.styleObject.left=r+"px"}}}},computed:{containerClass:function(){return[this.columnProp("footerClass"),this.columnProp("class"),this.cx("footerCell")]},containerStyle:function(){var e=this.columnProp("footerStyle"),n=this.columnProp("style");return this.columnProp("frozen")?[n,e,this.styleObject]:[n,e]}}};function jv(t){"@babel/helpers - typeof";return jv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jv(t)}function XF(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function ZF(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?XF(Object(n),!0).forEach(function(i){lCe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):XF(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function lCe(t,e,n){return e=cCe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cCe(t){var e=uCe(t,"string");return jv(e)==="symbol"?e:String(e)}function uCe(t,e){if(jv(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(jv(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var hCe=["colspan","rowspan"];function dCe(t,e,n,i,r,o){return le(),Ue("td",Le({style:o.containerStyle,class:o.containerClass,role:"cell",colspan:o.columnProp("colspan"),rowspan:o.columnProp("rowspan")},ZF(ZF({},o.getColumnPT("root")),o.getColumnPT("footerCell"))),[n.column.children&&n.column.children.footer?(le(),Rt(Zn(n.column.children.footer),{key:0,column:n.column},null,8,["column"])):Jt("",!0),vo(" "+ki(o.columnProp("footer")),1)],16,hCe)}oj.render=dCe;function qF(t){return mCe(t)||pCe(t)||sj(t)||fCe()}function fCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pCe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function mCe(t){if(Array.isArray(t))return tI(t)}function YF(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=sj(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(p){throw p},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,l=!1,s;return{s:function(){n=n.call(t)},n:function(){var p=n.next();return o=p.done,p},e:function(p){l=!0,s=p},f:function(){try{!o&&n.return!=null&&n.return()}finally{if(l)throw s}}}}function sj(t,e){if(t){if(typeof t=="string")return tI(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tI(t,e)}}function tI(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var aj={name:"TableFooter",hostName:"DataTable",extends:Ni,props:{columnGroup:{type:null,default:null},columns:{type:Object,default:null}},methods:{columnProp:function(e,n){return At.getVNodeProp(e,n)},getColumnGroupPT:function(e){var n={props:this.getColumnGroupProps(),parent:{props:this.$props,state:this.$data},context:{type:"footer",scrollable:this.ptmTFootOptions.context.scrollable}};return Le(this.ptm("columnGroup.".concat(e),{columnGroup:n}),this.ptm("columnGroup.".concat(e),n),this.ptmo(this.getColumnGroupProps(),e,n))},getColumnGroupProps:function(){return this.columnGroup&&this.columnGroup.props&&this.columnGroup.props.pt?this.columnGroup.props.pt:void 0},getRowPT:function(e,n,i){var r={props:e.props,parent:{props:this.$props,state:this.$data},context:{index:i}};return Le(this.ptm("row.".concat(n),{row:r}),this.ptm("row.".concat(n),r),this.ptmo(this.getRowProp(e),n,r))},getRowProp:function(e){return e.props&&e.props.pt?e.props.pt:void 0},getFooterRows:function(){var e=[],n=this.columnGroup;if(n.children&&n.children.default){var i=YF(n.children.default()),r;try{for(i.s();!(r=i.n()).done;){var o=r.value;o.type.name==="Row"?e.push(o):o.children&&o.children instanceof Array&&(e=o.children)}}catch(l){i.e(l)}finally{i.f()}return e}},getFooterColumns:function(e){var n=[];if(e.children&&e.children.default)return e.children.default().forEach(function(i){i.children&&i.children instanceof Array?n=[].concat(qF(n),qF(i.children)):i.type.name==="Column"&&n.push(i)}),n}},computed:{hasFooter:function(){var e=!1;if(this.columnGroup)e=!0;else if(this.columns){var n=YF(this.columns),i;try{for(n.s();!(i=n.n()).done;){var r=i.value;if(this.columnProp(r,"footer")||r.children&&r.children.footer){e=!0;break}}}catch(o){n.e(o)}finally{n.f()}}return e},ptmTFootOptions:function(){var e;return{context:{scrollable:(e=this.$parentInstance)===null||e===void 0||(e=e.$parentInstance)===null||e===void 0?void 0:e.scrollable}}}},components:{DTFooterCell:oj}};function $v(t){"@babel/helpers - typeof";return $v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$v(t)}function JF(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function ox(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?JF(Object(n),!0).forEach(function(i){gCe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):JF(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function gCe(t,e,n){return e=yCe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yCe(t){var e=vCe(t,"string");return $v(e)==="symbol"?e:String(e)}function vCe(t,e){if($v(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if($v(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _Ce(t,e,n,i,r,o){var l=Gn("DTFooterCell");return o.hasFooter?(le(),Ue("tfoot",Le({key:0,class:t.cx("tfoot"),style:t.sx("tfoot"),role:"rowgroup"},n.columnGroup?ox(ox({},t.ptm("tfoot",o.ptmTFootOptions)),o.getColumnGroupPT("root")):t.ptm("tfoot",o.ptmTFootOptions),{"data-pc-section":"tfoot"}),[n.columnGroup?(le(!0),Ue(_n,{key:1},or(o.getFooterRows(),function(s,d){return le(),Ue("tr",Le({key:d,role:"row"},ox(ox({},t.ptm("footerRow")),o.getRowPT(s,"root",d))),[(le(!0),Ue(_n,null,or(o.getFooterColumns(s),function(p,y){return le(),Ue(_n,{key:o.columnProp(p,"columnKey")||o.columnProp(p,"field")||y},[o.columnProp(p,"hidden")?Jt("",!0):(le(),Rt(l,{key:0,column:p,index:d,pt:t.pt},null,8,["column","index","pt"]))],64)}),128))],16)}),128)):(le(),Ue("tr",Le({key:0,role:"row"},t.ptm("footerRow")),[(le(!0),Ue(_n,null,or(n.columns,function(s,d){return le(),Ue(_n,{key:o.columnProp(s,"columnKey")||o.columnProp(s,"field")||d},[o.columnProp(s,"hidden")?Jt("",!0):(le(),Rt(l,{key:0,column:s,pt:t.pt},null,8,["column","pt"]))],64)}),128))],16))],16)):Jt("",!0)}aj.render=_Ce;function Gv(t){"@babel/helpers - typeof";return Gv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gv(t)}function QF(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Dd(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?QF(Object(n),!0).forEach(function(i){bCe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):QF(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function bCe(t,e,n){return e=xCe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xCe(t){var e=wCe(t,"string");return Gv(e)==="symbol"?e:String(e)}function wCe(t,e){if(Gv(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Gv(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var G3={name:"ColumnFilter",hostName:"DataTable",extends:Ni,emits:["filter-change","filter-apply","operator-change","matchmode-change","constraint-add","constraint-remove","filter-clear","apply-click"],props:{field:{type:String,default:null},type:{type:String,default:"text"},display:{type:String,default:null},showMenu:{type:Boolean,default:!0},matchMode:{type:String,default:null},showOperator:{type:Boolean,default:!0},showClearButton:{type:Boolean,default:!0},showApplyButton:{type:Boolean,default:!0},showMatchModes:{type:Boolean,default:!0},showAddButton:{type:Boolean,default:!0},matchModeOptions:{type:Array,default:null},maxConstraints:{type:Number,default:2},filterElement:{type:Function,default:null},filterHeaderTemplate:{type:Function,default:null},filterFooterTemplate:{type:Function,default:null},filterClearTemplate:{type:Function,default:null},filterApplyTemplate:{type:Function,default:null},filterIconTemplate:{type:Function,default:null},filterAddIconTemplate:{type:Function,default:null},filterRemoveIconTemplate:{type:Function,default:null},filterClearIconTemplate:{type:Function,default:null},filters:{type:Object,default:null},filtersStore:{type:Object,default:null},filterMenuClass:{type:String,default:null},filterMenuStyle:{type:null,default:null},filterInputProps:{type:null,default:null},column:null},data:function(){return{overlayVisible:!1,defaultMatchMode:null,defaultOperator:null}},overlay:null,selfClick:!1,overlayEventListener:null,beforeUnmount:function(){this.overlayEventListener&&(_h.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null),this.overlay&&(Sl.clear(this.overlay),this.onOverlayHide())},mounted:function(){if(this.filters&&this.filters[this.field]){var e=this.filters[this.field];e.operator?(this.defaultMatchMode=e.constraints[0].matchMode,this.defaultOperator=e.operator):this.defaultMatchMode=this.filters[this.field].matchMode}},methods:{getColumnPT:function(e,n){var i=Dd({props:this.column.props,parent:{props:this.$props,state:this.$data}},n);return Le(this.ptm("column.".concat(e),{column:i}),this.ptm("column.".concat(e),i),this.ptmo(this.getColumnProp(),e,i))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},ptmFilterRowItemOptions:function(e){return{context:{highlighted:e&&this.isRowMatchModeSelected(e.value)}}},clearFilter:function(){var e=Dd({},this.filters);e[this.field].operator?(e[this.field].constraints.splice(1),e[this.field].operator=this.defaultOperator,e[this.field].constraints[0]={value:null,matchMode:this.defaultMatchMode}):(e[this.field].value=null,e[this.field].matchMode=this.defaultMatchMode),this.$emit("filter-clear"),this.$emit("filter-change",e),this.$emit("filter-apply"),this.hide()},applyFilter:function(){this.$emit("apply-click",{field:this.field,constraints:this.filters[this.field]}),this.$emit("filter-apply"),this.hide()},hasFilter:function(){if(this.filtersStore){var e=this.filtersStore[this.field];if(e)return e.operator?!this.isFilterBlank(e.constraints[0].value):!this.isFilterBlank(e.value)}return!1},hasRowFilter:function(){return this.filters[this.field]&&!this.isFilterBlank(this.filters[this.field].value)},isFilterBlank:function(e){return e!=null?typeof e=="string"&&e.trim().length==0||e instanceof Array&&e.length==0:!0},toggleMenu:function(e){this.overlayVisible=!this.overlayVisible,e.preventDefault()},onToggleButtonKeyDown:function(e){switch(e.code){case"Enter":case"Space":this.toggleMenu(e);break;case"Escape":this.overlayVisible=!1;break}},onRowMatchModeChange:function(e){var n=Dd({},this.filters);n[this.field].matchMode=e,this.$emit("matchmode-change",{field:this.field,matchMode:e}),this.$emit("filter-change",n),this.$emit("filter-apply"),this.hide()},onRowMatchModeKeyDown:function(e){var n=e.target;switch(e.code){case"ArrowDown":var i=this.findNextItem(n);i&&(n.removeAttribute("tabindex"),i.tabIndex="0",i.focus()),e.preventDefault();break;case"ArrowUp":var r=this.findPrevItem(n);r&&(n.removeAttribute("tabindex"),r.tabIndex="0",r.focus()),e.preventDefault();break}},isRowMatchModeSelected:function(e){return this.filters[this.field].matchMode===e},onOperatorChange:function(e){var n=Dd({},this.filters);n[this.field].operator=e,this.$emit("filter-change",n),this.$emit("operator-change",{field:this.field,operator:e}),this.showApplyButton||this.$emit("filter-apply")},onMenuMatchModeChange:function(e,n){var i=Dd({},this.filters);i[this.field].constraints[n].matchMode=e,this.$emit("matchmode-change",{field:this.field,matchMode:e,index:n}),this.showApplyButton||this.$emit("filter-apply")},addConstraint:function(){var e=Dd({},this.filters),n={value:null,matchMode:this.defaultMatchMode};e[this.field].constraints.push(n),this.$emit("constraint-add",{field:this.field,constraing:n}),this.$emit("filter-change",e),this.showApplyButton||this.$emit("filter-apply")},removeConstraint:function(e){var n=Dd({},this.filters),i=n[this.field].constraints.splice(e,1);this.$emit("constraint-remove",{field:this.field,constraing:i}),this.$emit("filter-change",n),this.showApplyButton||this.$emit("filter-apply")},filterCallback:function(){this.$emit("filter-apply")},findNextItem:function(e){var n=e.nextElementSibling;return n?He.getAttribute(n,"data-pc-section")==="filterseparator"?this.findNextItem(n):n:e.parentElement.firstElementChild},findPrevItem:function(e){var n=e.previousElementSibling;return n?He.getAttribute(n,"data-pc-section")==="filterseparator"?this.findPrevItem(n):n:e.parentElement.lastElementChild},hide:function(){this.overlayVisible=!1,He.focus(this.$refs.icon)},onContentClick:function(e){this.selfClick=!0,_h.emit("overlay-click",{originalEvent:e,target:this.overlay})},onContentMouseDown:function(){this.selfClick=!0},onOverlayEnter:function(e){var n=this;this.filterMenuStyle&&He.applyStyle(this.overlay,this.filterMenuStyle),Sl.set("overlay",e,this.$primevue.config.zIndex.overlay),He.addStyles(e,{position:"absolute",top:"0",left:"0"}),He.absolutePosition(this.overlay,this.$refs.icon),this.bindOutsideClickListener(),this.bindScrollListener(),this.bindResizeListener(),this.overlayEventListener=function(i){n.isOutsideClicked(i.target)||(n.selfClick=!0)},_h.on("overlay-click",this.overlayEventListener)},onOverlayLeave:function(){this.onOverlayHide()},onOverlayAfterLeave:function(e){Sl.clear(e)},onOverlayHide:function(){this.unbindOutsideClickListener(),this.unbindResizeListener(),this.unbindScrollListener(),this.overlay=null,_h.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null},overlayRef:function(e){this.overlay=e},isOutsideClicked:function(e){return!this.isTargetClicked(e)&&this.overlay&&!(this.overlay.isSameNode(e)||this.overlay.contains(e))},isTargetClicked:function(e){return this.$refs.icon&&(this.$refs.icon.isSameNode(e)||this.$refs.icon.contains(e))},bindOutsideClickListener:function(){var e=this;this.outsideClickListener||(this.outsideClickListener=function(n){e.overlayVisible&&!e.selfClick&&e.isOutsideClicked(n.target)&&(e.overlayVisible=!1),e.selfClick=!1},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener:function(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null,this.selfClick=!1)},bindScrollListener:function(){var e=this;this.scrollHandler||(this.scrollHandler=new rM(this.$refs.icon,function(){e.overlayVisible&&e.hide()})),this.scrollHandler.bindScrollListener()},unbindScrollListener:function(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener:function(){var e=this;this.resizeListener||(this.resizeListener=function(){e.overlayVisible&&!He.isTouchDevice()&&e.hide()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener:function(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)}},computed:{showMenuButton:function(){return this.showMenu&&(this.display==="row"?this.type!=="boolean":!0)},overlayId:function(){return Gr()},matchModes:function(){var e=this;return this.matchModeOptions||this.$primevue.config.filterMatchModeOptions[this.type].map(function(n){return{label:e.$primevue.config.locale[n],value:n}})},isShowMatchModes:function(){return this.type!=="boolean"&&this.showMatchModes&&this.matchModes},operatorOptions:function(){return[{label:this.$primevue.config.locale.matchAll,value:za.AND},{label:this.$primevue.config.locale.matchAny,value:za.OR}]},noFilterLabel:function(){return this.$primevue.config.locale?this.$primevue.config.locale.noFilter:void 0},isShowOperator:function(){return this.showOperator&&this.filters[this.field].operator},operator:function(){return this.filters[this.field].operator},fieldConstraints:function(){return this.filters[this.field].constraints||[this.filters[this.field]]},showRemoveIcon:function(){return this.fieldConstraints.length>1},removeRuleButtonLabel:function(){return this.$primevue.config.locale?this.$primevue.config.locale.removeRule:void 0},addRuleButtonLabel:function(){return this.$primevue.config.locale?this.$primevue.config.locale.addRule:void 0},isShowAddConstraint:function(){return this.showAddButton&&this.filters[this.field].operator&&this.fieldConstraints&&this.fieldConstraints.length<this.maxConstraints},clearButtonLabel:function(){return this.$primevue.config.locale?this.$primevue.config.locale.clear:void 0},applyButtonLabel:function(){return this.$primevue.config.locale?this.$primevue.config.locale.apply:void 0},filterMenuButtonAriaLabel:function(){return this.$primevue.config.locale?this.overlayVisible?this.$primevue.config.locale.showFilterMenu:this.$primevue.config.locale.hideFilterMenu:void 0},filterOperatorAriaLabel:function(){return this.$primevue.config.locale?this.$primevue.config.locale.filterOperator:void 0},filterConstraintAriaLabel:function(){return this.$primevue.config.locale?this.$primevue.config.locale.filterConstraint:void 0},ptmHeaderFilterClearParams:function(){return{context:{hidden:this.hasRowFilter()}}},ptmFilterMenuParams:function(){return{context:{overlayVisible:this.overlayVisible,active:this.hasFilter()}}}},components:{CFDropdown:ig,CFButton:zh,Portal:N2,FilterSlashIcon:JV,FilterIcon:s3,TrashIcon:ej,PlusIcon:QV},directives:{focustrap:HTe}};function Hv(t){"@babel/helpers - typeof";return Hv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hv(t)}function e8(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function t8(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?e8(Object(n),!0).forEach(function(i){ECe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e8(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function ECe(t,e,n){return e=TCe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TCe(t){var e=SCe(t,"string");return Hv(e)==="symbol"?e:String(e)}function SCe(t,e){if(Hv(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Hv(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var CCe=["aria-label","aria-expanded","aria-controls"],ACe=["id","aria-modal"],PCe=["onClick","onKeydown","tabindex"];function ICe(t,e,n,i,r,o){var l=Gn("CFDropdown"),s=Gn("CFButton"),d=Gn("Portal"),p=ea("focustrap");return le(),Ue("div",Le({class:t.cx("columnFilter")},o.getColumnPT("columnFilter")),[n.display==="row"?(le(),Ue("div",Le({key:0,class:t.cx("filterInput")},t8(t8({},n.filterInputProps),o.getColumnPT("filterInput"))),[(le(),Rt(Zn(n.filterElement),{field:n.field,filterModel:n.filters[n.field],filterCallback:o.filterCallback},null,8,["field","filterModel","filterCallback"]))],16)):Jt("",!0),o.showMenuButton?(le(),Ue("button",Le({key:1,ref:"icon",type:"button","aria-label":o.filterMenuButtonAriaLabel,"aria-haspopup":"true","aria-expanded":r.overlayVisible,"aria-controls":o.overlayId,class:t.cx("filterMenuButton"),onClick:e[0]||(e[0]=function(y){return o.toggleMenu(y)}),onKeydown:e[1]||(e[1]=function(y){return o.onToggleButtonKeyDown(y)})},o.getColumnPT("filterMenuButton",o.ptmFilterMenuParams)),[(le(),Rt(Zn(n.filterIconTemplate||"FilterIcon"),um(E0(o.getColumnPT("filterMenuIcon"))),null,16))],16,CCe)):Jt("",!0),n.showClearButton&&n.display==="row"?(le(),Ue("button",Le({key:2,class:t.cx("headerFilterClearButton"),type:"button",onClick:e[2]||(e[2]=function(y){return o.clearFilter()})},o.getColumnPT("headerFilterClearButton",o.ptmHeaderFilterClearParams)),[(le(),Rt(Zn(n.filterClearIconTemplate||"FilterSlashIcon"),um(E0(o.getColumnPT("filterClearIcon"))),null,16))],16)):Jt("",!0),Lt(d,null,{default:Cn(function(){return[Lt(xf,Le({name:"p-connected-overlay",onEnter:o.onOverlayEnter,onLeave:o.onOverlayLeave,onAfterLeave:o.onOverlayAfterLeave},o.getColumnPT("transition")),{default:Cn(function(){return[r.overlayVisible?fo((le(),Ue("div",Le({key:0,ref:o.overlayRef,id:o.overlayId,"aria-modal":r.overlayVisible,role:"dialog",class:[t.cx("filterOverlay"),n.filterMenuClass],onKeydown:e[10]||(e[10]=fm(function(){return o.hide&&o.hide.apply(o,arguments)},["escape"])),onClick:e[11]||(e[11]=function(){return o.onContentClick&&o.onContentClick.apply(o,arguments)}),onMousedown:e[12]||(e[12]=function(){return o.onContentMouseDown&&o.onContentMouseDown.apply(o,arguments)})},o.getColumnPT("filterOverlay")),[(le(),Rt(Zn(n.filterHeaderTemplate),{field:n.field,filterModel:n.filters[n.field],filterCallback:o.filterCallback},null,8,["field","filterModel","filterCallback"])),n.display==="row"?(le(),Ue("ul",Le({key:0,class:t.cx("filterRowItems")},o.getColumnPT("filterRowItems")),[(le(!0),Ue(_n,null,or(o.matchModes,function(y,v){return le(),Ue("li",Le({key:y.label,class:t.cx("filterRowItem",{matchMode:y}),onClick:function(T){return o.onRowMatchModeChange(y.value)},onKeydown:[e[3]||(e[3]=function(w){return o.onRowMatchModeKeyDown(w)}),fm(c_(function(w){return o.onRowMatchModeChange(y.value)},["prevent"]),["enter"])],tabindex:v===0?"0":null},o.getColumnPT("filterRowItem",o.ptmFilterRowItemOptions(y))),ki(y.label),17,PCe)}),128)),Qe("li",Le({class:t.cx("filterSeparator")},o.getColumnPT("filterSeparator")),null,16),Qe("li",Le({class:t.cx("filterRowItem"),onClick:e[4]||(e[4]=function(y){return o.clearFilter()}),onKeydown:[e[5]||(e[5]=function(y){return o.onRowMatchModeKeyDown(y)}),e[6]||(e[6]=fm(function(y){return t.onRowClearItemClick()},["enter"]))]},o.getColumnPT("filterRowItem")),ki(o.noFilterLabel),17)],16)):(le(),Ue(_n,{key:1},[o.isShowOperator?(le(),Ue("div",Le({key:0,class:t.cx("filterOperator")},o.getColumnPT("filterOperator")),[Lt(l,{options:o.operatorOptions,modelValue:o.operator,"aria-label":o.filterOperatorAriaLabel,class:ri(t.cx("filterOperatorDropdown")),optionLabel:"label",optionValue:"value","onUpdate:modelValue":e[7]||(e[7]=function(y){return o.onOperatorChange(y)}),unstyled:t.unstyled,pt:o.getColumnPT("filterOperatorDropdown"),"data-pc-section":"filteroperatordropdown"},null,8,["options","modelValue","aria-label","class","unstyled","pt"])],16)):Jt("",!0),Qe("div",Le({class:t.cx("filterConstraints")},o.getColumnPT("filterConstraints")),[(le(!0),Ue(_n,null,or(o.fieldConstraints,function(y,v){return le(),Ue("div",Le({key:v,class:t.cx("filterConstraint")},o.getColumnPT("filterConstraint")),[o.isShowMatchModes?(le(),Rt(l,{key:0,options:o.matchModes,modelValue:y.matchMode,class:ri(t.cx("filterMatchModeDropdown")),optionLabel:"label",optionValue:"value","aria-label":o.filterConstraintAriaLabel,"onUpdate:modelValue":function(T){return o.onMenuMatchModeChange(T,v)},unstyled:t.unstyled,pt:o.getColumnPT("filterMatchModeDropdown"),"data-pc-section":"filtermatchmodedropdown"},null,8,["options","modelValue","class","aria-label","onUpdate:modelValue","unstyled","pt"])):Jt("",!0),n.display==="menu"?(le(),Rt(Zn(n.filterElement),{key:1,field:n.field,filterModel:y,filterCallback:o.filterCallback,applyFilter:o.applyFilter},null,8,["field","filterModel","filterCallback","applyFilter"])):Jt("",!0),Qe("div",um(E0(o.getColumnPT("filterRemove"))),[o.showRemoveIcon?(le(),Rt(s,{key:0,type:"button",class:ri(t.cx("filterRemoveButton")),onClick:function(T){return o.removeConstraint(v)},label:o.removeRuleButtonLabel,unstyled:t.unstyled,text:"",severity:"danger",size:"small",pt:o.getColumnPT("filterRemoveButton"),"data-pc-section":"filterremovebutton"},{icon:Cn(function(w){return[(le(),Rt(Zn(n.filterRemoveIconTemplate||"TrashIcon"),Le({class:w.class},o.getColumnPT("filterRemoveButton").icon),null,16,["class"]))]}),_:2},1032,["class","onClick","label","unstyled","pt"])):Jt("",!0)],16)],16)}),128))],16),o.isShowAddConstraint?(le(),Ue("div",Le({key:1,class:t.cx("filterAddRule")},o.getColumnPT("filterAddRule")),[Lt(s,{type:"button",label:o.addRuleButtonLabel,iconPos:"left",class:ri(t.cx("filterAddRuleButton")),onClick:e[8]||(e[8]=function(y){return o.addConstraint()}),unstyled:t.unstyled,text:"",severity:"info",size:"small",pt:o.getColumnPT("filterAddRuleButton"),"data-pc-section":"filteraddrulebutton"},{icon:Cn(function(y){return[(le(),Rt(Zn(n.filterAddIconTemplate||"PlusIcon"),Le({class:y.class},o.getColumnPT("filterAddRuleButton").icon),null,16,["class"]))]}),_:1},8,["label","class","unstyled","pt"])],16)):Jt("",!0),Qe("div",Le({class:t.cx("filterButtonbar")},o.getColumnPT("filterButtonbar")),[!n.filterClearTemplate&&n.showClearButton?(le(),Rt(s,{key:0,type:"button",class:ri(t.cx("filterClearButton")),label:o.clearButtonLabel,onClick:o.clearFilter,unstyled:t.unstyled,size:"small",outlined:"",pt:o.getColumnPT("filterClearButton"),"data-pc-section":"filterclearbutton"},null,8,["class","label","onClick","unstyled","pt"])):(le(),Rt(Zn(n.filterClearTemplate),{key:1,field:n.field,filterModel:n.filters[n.field],filterCallback:o.clearFilter},null,8,["field","filterModel","filterCallback"])),n.showApplyButton?(le(),Ue(_n,{key:2},[n.filterApplyTemplate?(le(),Rt(Zn(n.filterApplyTemplate),{key:1,field:n.field,filterModel:n.filters[n.field],filterCallback:o.applyFilter},null,8,["field","filterModel","filterCallback"])):(le(),Rt(s,{key:0,type:"button",class:ri(t.cx("filterApplyButton")),label:o.applyButtonLabel,onClick:e[9]||(e[9]=function(y){return o.applyFilter()}),unstyled:t.unstyled,size:"small",pt:o.getColumnPT("filterApplyButton"),"data-pc-section":"filterapplybutton"},null,8,["class","label","unstyled","pt"]))],64)):Jt("",!0)],16)],64)),(le(),Rt(Zn(n.filterFooterTemplate),{field:n.field,filterModel:n.filters[n.field],filterCallback:o.filterCallback},null,8,["field","filterModel","filterCallback"]))],16,ACe)),[[p,{autoFocus:!0}]]):Jt("",!0)]}),_:1},16,["onEnter","onLeave","onAfterLeave"])]}),_:1})],16)}G3.render=ICe;var H3={name:"HeaderCheckbox",hostName:"DataTable",extends:Ni,emits:["change"],props:{checked:null,disabled:null,column:null,headerCheckboxIconTemplate:{type:Function,default:null}},data:function(){return{focused:!1}},methods:{getColumnPT:function(e){var n={props:this.column.props,parent:{props:this.$props,state:this.$data},context:{checked:this.checked,focused:this.focused,disabled:this.disabled}};return Le(this.ptm("column.".concat(e),{column:n}),this.ptm("column.".concat(e),n),this.ptmo(this.getColumnProp(),e,n))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},onClick:function(e){this.disabled||(this.$emit("change",{originalEvent:e,checked:!this.checked}),He.focus(this.$refs.input))},onFocus:function(){this.focused=!0},onBlur:function(){this.focused=!1}},computed:{headerCheckboxAriaLabel:function(){return this.$primevue.config.locale.aria?this.checked?this.$primevue.config.locale.aria.selectAll:this.$primevue.config.locale.aria.unselectAll:void 0}},components:{CheckIcon:P_}},MCe=["checked","disabled","tabindex","aria-label"];function RCe(t,e,n,i,r,o){var l=Gn("CheckIcon");return le(),Ue("div",Le({class:t.cx("headerCheckboxWrapper"),onClick:e[2]||(e[2]=function(){return o.onClick&&o.onClick.apply(o,arguments)}),onKeydown:e[3]||(e[3]=fm(c_(function(){return o.onClick&&o.onClick.apply(o,arguments)},["prevent"]),["space"]))},o.getColumnPT("headerCheckboxWrapper")),[Qe("div",Le({class:"p-hidden-accessible"},o.getColumnPT("hiddenHeaderInputWrapper"),{"data-p-hidden-accessible":!0}),[Qe("input",Le({ref:"input",type:"checkbox",checked:n.checked,disabled:n.disabled,tabindex:n.disabled?null:"0","aria-label":o.headerCheckboxAriaLabel,onFocus:e[0]||(e[0]=function(s){return o.onFocus(s)}),onBlur:e[1]||(e[1]=function(s){return o.onBlur(s)})},o.getColumnPT("hiddenHeaderInput")),null,16,MCe)],16),Qe("div",Le({ref:"box",class:t.cx("headerCheckbox")},o.getColumnPT("headerCheckbox")),[n.headerCheckboxIconTemplate?(le(),Rt(Zn(n.headerCheckboxIconTemplate),{key:0,checked:n.checked,class:ri(t.cx("headerCheckboxIcon"))},null,8,["checked","class"])):!n.headerCheckboxIconTemplate&&n.checked?(le(),Rt(l,Le({key:1,class:t.cx("headerCheckboxIcon")},o.getColumnPT("headerCheckboxIcon")),null,16,["class"])):Jt("",!0)],16)],16)}H3.render=RCe;var lj={name:"HeaderCell",hostName:"DataTable",extends:Ni,emits:["column-click","column-mousedown","column-dragstart","column-dragover","column-dragleave","column-drop","column-resizestart","checkbox-change","filter-change","filter-apply","operator-change","matchmode-change","constraint-add","constraint-remove","filter-clear","apply-click"],props:{column:{type:Object,default:null},index:{type:Number,default:null},resizableColumns:{type:Boolean,default:!1},groupRowsBy:{type:[Array,String,Function],default:null},sortMode:{type:String,default:"single"},groupRowSortField:{type:[String,Function],default:null},sortField:{type:[String,Function],default:null},sortOrder:{type:Number,default:null},multiSortMeta:{type:Array,default:null},allRowsSelected:{type:Boolean,default:!1},empty:{type:Boolean,default:!1},filterDisplay:{type:String,default:null},filters:{type:Object,default:null},filtersStore:{type:Object,default:null},filterColumn:{type:Boolean,default:!1},reorderableColumns:{type:Boolean,default:!1},filterInputProps:{type:null,default:null}},data:function(){return{styleObject:{}}},mounted:function(){this.columnProp("frozen")&&this.updateStickyPosition()},updated:function(){this.columnProp("frozen")&&this.updateStickyPosition()},methods:{columnProp:function(e){return At.getVNodeProp(this.column,e)},getColumnPT:function(e){var n,i,r={props:this.column.props,parent:{props:this.$props,state:this.$data},context:{index:this.index,sorted:this.isColumnSorted(),resizable:this.resizableColumns,size:(n=this.$parentInstance)===null||n===void 0||(n=n.$parentInstance)===null||n===void 0?void 0:n.size,showGridlines:((i=this.$parentInstance)===null||i===void 0||(i=i.$parentInstance)===null||i===void 0?void 0:i.showGridlines)||!1}};return Le(this.ptm("column.".concat(e),{column:r}),this.ptm("column.".concat(e),r),this.ptmo(this.getColumnProp(),e,r))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},onClick:function(e){this.$emit("column-click",{originalEvent:e,column:this.column})},onKeyDown:function(e){(e.code==="Enter"||e.code==="Space")&&e.currentTarget.nodeName==="TH"&&He.getAttribute(e.currentTarget,"data-p-sortable-column")&&(this.$emit("column-click",{originalEvent:e,column:this.column}),e.preventDefault())},onMouseDown:function(e){this.$emit("column-mousedown",{originalEvent:e,column:this.column})},onDragStart:function(e){this.$emit("column-dragstart",e)},onDragOver:function(e){this.$emit("column-dragover",e)},onDragLeave:function(e){this.$emit("column-dragleave",e)},onDrop:function(e){this.$emit("column-drop",e)},onResizeStart:function(e){this.$emit("column-resizestart",e)},getMultiSortMetaIndex:function(){var e=this;return this.multiSortMeta.findIndex(function(n){return n.field===e.columnProp("field")||n.field===e.columnProp("sortField")})},getBadgeValue:function(){var e=this.getMultiSortMetaIndex();return this.groupRowsBy&&this.groupRowsBy===this.groupRowSortField&&e>-1?e:e+1},isMultiSorted:function(){return this.sortMode==="multiple"&&this.columnProp("sortable")&&this.getMultiSortMetaIndex()>-1},isColumnSorted:function(){return this.sortMode==="single"?this.sortField&&(this.sortField===this.columnProp("field")||this.sortField===this.columnProp("sortField")):this.isMultiSorted()},updateStickyPosition:function(){if(this.columnProp("frozen")){var e=this.columnProp("alignFrozen");if(e==="right"){var n=0,i=this.$el.nextElementSibling;i&&(n=He.getOuterWidth(i)+parseFloat(i.style.right||0)),this.styleObject.right=n+"px"}else{var r=0,o=this.$el.previousElementSibling;o&&(r=He.getOuterWidth(o)+parseFloat(o.style.left||0)),this.styleObject.left=r+"px"}var l=this.$el.parentElement.nextElementSibling;if(l){var s=He.index(this.$el);l.children[s].style.left=this.styleObject.left,l.children[s].style.right=this.styleObject.right}}},onHeaderCheckboxChange:function(e){this.$emit("checkbox-change",e)}},computed:{containerClass:function(){return[this.cx("headerCell"),this.filterColumn?this.columnProp("filterHeaderClass"):this.columnProp("headerClass"),this.columnProp("class")]},containerStyle:function(){var e=this.filterColumn?this.columnProp("filterHeaderStyle"):this.columnProp("headerStyle"),n=this.columnProp("style");return this.columnProp("frozen")?[n,e,this.styleObject]:[n,e]},sortState:function(){var e=!1,n=null;if(this.sortMode==="single")e=this.sortField&&(this.sortField===this.columnProp("field")||this.sortField===this.columnProp("sortField")),n=e?this.sortOrder:0;else if(this.sortMode==="multiple"){var i=this.getMultiSortMetaIndex();i>-1&&(e=!0,n=this.multiSortMeta[i].order)}return{sorted:e,sortOrder:n}},sortableColumnIcon:function(){var e=this.sortState,n=e.sorted,i=e.sortOrder;if(n){if(n&&i>0)return eI;if(n&&i<0)return QP}else return JP;return null},ariaSort:function(){if(this.columnProp("sortable")){var e=this.sortState,n=e.sorted,i=e.sortOrder;return n&&i<0?"descending":n&&i>0?"ascending":"none"}else return null}},components:{DTHeaderCheckbox:H3,DTColumnFilter:G3,SortAltIcon:JP,SortAmountUpAltIcon:eI,SortAmountDownIcon:QP}};function Wv(t){"@babel/helpers - typeof";return Wv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wv(t)}function n8(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function i8(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?n8(Object(n),!0).forEach(function(i){LCe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):n8(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function LCe(t,e,n){return e=OCe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OCe(t){var e=DCe(t,"string");return Wv(e)==="symbol"?e:String(e)}function DCe(t,e){if(Wv(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Wv(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var kCe=["tabindex","colspan","rowspan","aria-sort","data-p-sortable-column","data-p-resizable-column","data-p-highlight","data-p-filter-column","data-p-frozen-column","data-p-reorderable-column"];function FCe(t,e,n,i,r,o){var l=Gn("DTHeaderCheckbox"),s=Gn("DTColumnFilter");return le(),Ue("th",Le({style:o.containerStyle,class:o.containerClass,tabindex:o.columnProp("sortable")?"0":null,role:"columnheader",colspan:o.columnProp("colspan"),rowspan:o.columnProp("rowspan"),"aria-sort":o.ariaSort,onClick:e[8]||(e[8]=function(){return o.onClick&&o.onClick.apply(o,arguments)}),onKeydown:e[9]||(e[9]=function(){return o.onKeyDown&&o.onKeyDown.apply(o,arguments)}),onMousedown:e[10]||(e[10]=function(){return o.onMouseDown&&o.onMouseDown.apply(o,arguments)}),onDragstart:e[11]||(e[11]=function(){return o.onDragStart&&o.onDragStart.apply(o,arguments)}),onDragover:e[12]||(e[12]=function(){return o.onDragOver&&o.onDragOver.apply(o,arguments)}),onDragleave:e[13]||(e[13]=function(){return o.onDragLeave&&o.onDragLeave.apply(o,arguments)}),onDrop:e[14]||(e[14]=function(){return o.onDrop&&o.onDrop.apply(o,arguments)})},i8(i8({},o.getColumnPT("root")),o.getColumnPT("headerCell")),{"data-p-sortable-column":o.columnProp("sortable"),"data-p-resizable-column":n.resizableColumns,"data-p-highlight":o.isColumnSorted(),"data-p-filter-column":n.filterColumn,"data-p-frozen-column":o.columnProp("frozen"),"data-p-reorderable-column":n.reorderableColumns}),[n.resizableColumns&&!o.columnProp("frozen")?(le(),Ue("span",Le({key:0,class:t.cx("columnResizer"),onMousedown:e[0]||(e[0]=function(){return o.onResizeStart&&o.onResizeStart.apply(o,arguments)})},o.getColumnPT("columnResizer")),null,16)):Jt("",!0),Qe("div",Le({class:t.cx("headerContent")},o.getColumnPT("headerContent")),[n.column.children&&n.column.children.header?(le(),Rt(Zn(n.column.children.header),{key:0,column:n.column},null,8,["column"])):Jt("",!0),o.columnProp("header")?(le(),Ue("span",Le({key:1,class:t.cx("headerTitle")},o.getColumnPT("headerTitle")),ki(o.columnProp("header")),17)):Jt("",!0),o.columnProp("sortable")?(le(),Ue("span",um(Le({key:2},o.getColumnPT("sort"))),[(le(),Rt(Zn(n.column.children&&n.column.children.sorticon||o.sortableColumnIcon),Le({sorted:o.sortState.sorted,sortOrder:o.sortState.sortOrder,"data-pc-section":"sorticon",class:t.cx("sortIcon")},o.getColumnPT("sorticon")),null,16,["sorted","sortOrder","class"]))],16)):Jt("",!0),o.isMultiSorted()?(le(),Ue("span",Le({key:3,class:t.cx("sortBadge")},o.getColumnPT("sortBadge")),ki(o.getBadgeValue()),17)):Jt("",!0),o.columnProp("selectionMode")==="multiple"&&n.filterDisplay!=="row"?(le(),Rt(l,{key:4,checked:n.allRowsSelected,onChange:o.onHeaderCheckboxChange,disabled:n.empty,headerCheckboxIconTemplate:n.column.children&&n.column.children.headercheckboxicon,column:n.column,pt:t.pt},null,8,["checked","onChange","disabled","headerCheckboxIconTemplate","column","pt"])):Jt("",!0),n.filterDisplay==="menu"&&n.column.children&&n.column.children.filter?(le(),Rt(s,{key:5,field:o.columnProp("filterField")||o.columnProp("field"),type:o.columnProp("dataType"),display:"menu",showMenu:o.columnProp("showFilterMenu"),filterElement:n.column.children&&n.column.children.filter,filterHeaderTemplate:n.column.children&&n.column.children.filterheader,filterFooterTemplate:n.column.children&&n.column.children.filterfooter,filterClearTemplate:n.column.children&&n.column.children.filterclear,filterApplyTemplate:n.column.children&&n.column.children.filterapply,filterIconTemplate:n.column.children&&n.column.children.filtericon,filterAddIconTemplate:n.column.children&&n.column.children.filteraddicon,filterRemoveIconTemplate:n.column.children&&n.column.children.filterremoveicon,filterClearIconTemplate:n.column.children&&n.column.children.filterclearicon,filters:n.filters,filtersStore:n.filtersStore,filterInputProps:n.filterInputProps,onFilterChange:e[1]||(e[1]=function(d){return t.$emit("filter-change",d)}),onFilterApply:e[2]||(e[2]=function(d){return t.$emit("filter-apply")}),filterMenuStyle:o.columnProp("filterMenuStyle"),filterMenuClass:o.columnProp("filterMenuClass"),showOperator:o.columnProp("showFilterOperator"),showClearButton:o.columnProp("showClearButton"),showApplyButton:o.columnProp("showApplyButton"),showMatchModes:o.columnProp("showFilterMatchModes"),showAddButton:o.columnProp("showAddButton"),matchModeOptions:o.columnProp("filterMatchModeOptions"),maxConstraints:o.columnProp("maxConstraints"),onOperatorChange:e[3]||(e[3]=function(d){return t.$emit("operator-change",d)}),onMatchmodeChange:e[4]||(e[4]=function(d){return t.$emit("matchmode-change",d)}),onConstraintAdd:e[5]||(e[5]=function(d){return t.$emit("constraint-add",d)}),onConstraintRemove:e[6]||(e[6]=function(d){return t.$emit("constraint-remove",d)}),onApplyClick:e[7]||(e[7]=function(d){return t.$emit("apply-click",d)}),column:n.column,unstyled:t.unstyled,pt:t.pt},null,8,["field","type","showMenu","filterElement","filterHeaderTemplate","filterFooterTemplate","filterClearTemplate","filterApplyTemplate","filterIconTemplate","filterAddIconTemplate","filterRemoveIconTemplate","filterClearIconTemplate","filters","filtersStore","filterInputProps","filterMenuStyle","filterMenuClass","showOperator","showClearButton","showApplyButton","showMatchModes","showAddButton","matchModeOptions","maxConstraints","column","unstyled","pt"])):Jt("",!0)],16)],16,kCe)}lj.render=FCe;function r8(t){return NCe(t)||zCe(t)||cj(t)||BCe()}function BCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zCe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function NCe(t){if(Array.isArray(t))return nI(t)}function UCe(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=cj(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(p){throw p},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,l=!1,s;return{s:function(){n=n.call(t)},n:function(){var p=n.next();return o=p.done,p},e:function(p){l=!0,s=p},f:function(){try{!o&&n.return!=null&&n.return()}finally{if(l)throw s}}}}function cj(t,e){if(t){if(typeof t=="string")return nI(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nI(t,e)}}function nI(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var uj={name:"TableHeader",hostName:"DataTable",extends:Ni,emits:["column-click","column-mousedown","column-dragstart","column-dragover","column-dragleave","column-drop","column-resizestart","checkbox-change","filter-change","filter-apply","operator-change","matchmode-change","constraint-add","constraint-remove","filter-clear","apply-click"],props:{columnGroup:{type:null,default:null},columns:{type:null,default:null},rowGroupMode:{type:String,default:null},groupRowsBy:{type:[Array,String,Function],default:null},resizableColumns:{type:Boolean,default:!1},allRowsSelected:{type:Boolean,default:!1},empty:{type:Boolean,default:!1},sortMode:{type:String,default:"single"},groupRowSortField:{type:[String,Function],default:null},sortField:{type:[String,Function],default:null},sortOrder:{type:Number,default:null},multiSortMeta:{type:Array,default:null},filterDisplay:{type:String,default:null},filters:{type:Object,default:null},filtersStore:{type:Object,default:null},reorderableColumns:{type:Boolean,default:!1},filterInputProps:{type:null,default:null}},methods:{columnProp:function(e,n){return At.getVNodeProp(e,n)},getColumnGroupPT:function(e){var n,i={props:this.getColumnGroupProps(),parent:{props:this.$props,state:this.$data},context:{type:"header",scrollable:(n=this.$parentInstance)===null||n===void 0||(n=n.$parentInstance)===null||n===void 0?void 0:n.scrollable}};return Le(this.ptm("columnGroup.".concat(e),{columnGroup:i}),this.ptm("columnGroup.".concat(e),i),this.ptmo(this.getColumnGroupProps(),e,i))},getColumnGroupProps:function(){return this.columnGroup&&this.columnGroup.props&&this.columnGroup.props.pt?this.columnGroup.props.pt:void 0},getRowPT:function(e,n,i){var r={props:e.props,parent:{props:this.$props,state:this.$data},context:{index:i}};return Le(this.ptm("row.".concat(n),{row:r}),this.ptm("row.".concat(n),r),this.ptmo(this.getRowProp(e),n,r))},getRowProp:function(e){return e.props&&e.props.pt?e.props.pt:void 0},getColumnPT:function(e,n,i){var r={props:e.props,parent:{props:this.$props,state:this.$data},context:{index:i}};return Le(this.ptm("column.".concat(n),{column:r}),this.ptm("column.".concat(n),r),this.ptmo(this.getColumnProp(e),n,r))},getColumnProp:function(e){return e.props&&e.props.pt?e.props.pt:void 0},getFilterColumnHeaderClass:function(e){return[this.cx("headerCell",{column:e}),this.columnProp(e,"filterHeaderClass"),this.columnProp(e,"class")]},getFilterColumnHeaderStyle:function(e){return[this.columnProp(e,"filterHeaderStyle"),this.columnProp(e,"style")]},getHeaderRows:function(){var e=[],n=this.columnGroup;if(n.children&&n.children.default){var i=UCe(n.children.default()),r;try{for(i.s();!(r=i.n()).done;){var o=r.value;o.type.name==="Row"?e.push(o):o.children&&o.children instanceof Array&&(e=o.children)}}catch(l){i.e(l)}finally{i.f()}return e}},getHeaderColumns:function(e){var n=[];if(e.children&&e.children.default)return e.children.default().forEach(function(i){i.children&&i.children instanceof Array?n=[].concat(r8(n),r8(i.children)):i.type.name==="Column"&&n.push(i)}),n}},computed:{ptmTHeadOptions:function(){var e;return{context:{scrollable:(e=this.$parentInstance)===null||e===void 0||(e=e.$parentInstance)===null||e===void 0?void 0:e.scrollable}}}},components:{DTHeaderCell:lj,DTHeaderCheckbox:H3,DTColumnFilter:G3}};function Kv(t){"@babel/helpers - typeof";return Kv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kv(t)}function o8(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Np(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?o8(Object(n),!0).forEach(function(i){VCe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o8(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function VCe(t,e,n){return e=jCe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jCe(t){var e=$Ce(t,"string");return Kv(e)==="symbol"?e:String(e)}function $Ce(t,e){if(Kv(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Kv(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function GCe(t,e,n,i,r,o){var l=Gn("DTHeaderCell"),s=Gn("DTHeaderCheckbox"),d=Gn("DTColumnFilter");return le(),Ue("thead",Le({class:t.cx("thead"),style:t.sx("thead"),role:"rowgroup"},n.columnGroup?Np(Np({},t.ptm("thead",o.ptmTHeadOptions)),o.getColumnGroupPT("root")):t.ptm("thead",o.ptmTHeadOptions),{"data-pc-section":"thead"}),[n.columnGroup?(le(!0),Ue(_n,{key:1},or(o.getHeaderRows(),function(p,y){return le(),Ue("tr",Le({key:y,role:"row"},Np(Np({},t.ptm("headerRow")),o.getRowPT(p,"root",y))),[(le(!0),Ue(_n,null,or(o.getHeaderColumns(p),function(v,w){return le(),Ue(_n,{key:o.columnProp(v,"columnKey")||o.columnProp(v,"field")||w},[!o.columnProp(v,"hidden")&&(n.rowGroupMode!=="subheader"||n.groupRowsBy!==o.columnProp(v,"field"))&&typeof v.children!="string"?(le(),Rt(l,{key:0,column:v,onColumnClick:e[23]||(e[23]=function(T){return t.$emit("column-click",T)}),onColumnMousedown:e[24]||(e[24]=function(T){return t.$emit("column-mousedown",T)}),groupRowsBy:n.groupRowsBy,groupRowSortField:n.groupRowSortField,sortMode:n.sortMode,sortField:n.sortField,sortOrder:n.sortOrder,multiSortMeta:n.multiSortMeta,allRowsSelected:n.allRowsSelected,empty:n.empty,onCheckboxChange:e[25]||(e[25]=function(T){return t.$emit("checkbox-change",T)}),filters:n.filters,filterDisplay:n.filterDisplay,filtersStore:n.filtersStore,onFilterChange:e[26]||(e[26]=function(T){return t.$emit("filter-change",T)}),onFilterApply:e[27]||(e[27]=function(T){return t.$emit("filter-apply")}),onOperatorChange:e[28]||(e[28]=function(T){return t.$emit("operator-change",T)}),onMatchmodeChange:e[29]||(e[29]=function(T){return t.$emit("matchmode-change",T)}),onConstraintAdd:e[30]||(e[30]=function(T){return t.$emit("constraint-add",T)}),onConstraintRemove:e[31]||(e[31]=function(T){return t.$emit("constraint-remove",T)}),onApplyClick:e[32]||(e[32]=function(T){return t.$emit("apply-click",T)}),pt:t.pt},null,8,["column","groupRowsBy","groupRowSortField","sortMode","sortField","sortOrder","multiSortMeta","allRowsSelected","empty","filters","filterDisplay","filtersStore","pt"])):Jt("",!0)],64)}),128))],16)}),128)):(le(),Ue(_n,{key:0},[Qe("tr",Le({role:"row"},t.ptm("headerRow")),[(le(!0),Ue(_n,null,or(n.columns,function(p,y){return le(),Ue(_n,{key:o.columnProp(p,"columnKey")||o.columnProp(p,"field")||y},[!o.columnProp(p,"hidden")&&(n.rowGroupMode!=="subheader"||n.groupRowsBy!==o.columnProp(p,"field"))?(le(),Rt(l,{key:0,column:p,index:y,onColumnClick:e[0]||(e[0]=function(v){return t.$emit("column-click",v)}),onColumnMousedown:e[1]||(e[1]=function(v){return t.$emit("column-mousedown",v)}),onColumnDragstart:e[2]||(e[2]=function(v){return t.$emit("column-dragstart",v)}),onColumnDragover:e[3]||(e[3]=function(v){return t.$emit("column-dragover",v)}),onColumnDragleave:e[4]||(e[4]=function(v){return t.$emit("column-dragleave",v)}),onColumnDrop:e[5]||(e[5]=function(v){return t.$emit("column-drop",v)}),groupRowsBy:n.groupRowsBy,groupRowSortField:n.groupRowSortField,reorderableColumns:n.reorderableColumns,resizableColumns:n.resizableColumns,onColumnResizestart:e[6]||(e[6]=function(v){return t.$emit("column-resizestart",v)}),sortMode:n.sortMode,sortField:n.sortField,sortOrder:n.sortOrder,multiSortMeta:n.multiSortMeta,allRowsSelected:n.allRowsSelected,empty:n.empty,onCheckboxChange:e[7]||(e[7]=function(v){return t.$emit("checkbox-change",v)}),filters:n.filters,filterDisplay:n.filterDisplay,filtersStore:n.filtersStore,filterInputProps:n.filterInputProps,onFilterChange:e[8]||(e[8]=function(v){return t.$emit("filter-change",v)}),onFilterApply:e[9]||(e[9]=function(v){return t.$emit("filter-apply")}),onOperatorChange:e[10]||(e[10]=function(v){return t.$emit("operator-change",v)}),onMatchmodeChange:e[11]||(e[11]=function(v){return t.$emit("matchmode-change",v)}),onConstraintAdd:e[12]||(e[12]=function(v){return t.$emit("constraint-add",v)}),onConstraintRemove:e[13]||(e[13]=function(v){return t.$emit("constraint-remove",v)}),onApplyClick:e[14]||(e[14]=function(v){return t.$emit("apply-click",v)}),pt:t.pt},null,8,["column","index","groupRowsBy","groupRowSortField","reorderableColumns","resizableColumns","sortMode","sortField","sortOrder","multiSortMeta","allRowsSelected","empty","filters","filterDisplay","filtersStore","filterInputProps","pt"])):Jt("",!0)],64)}),128))],16),n.filterDisplay==="row"?(le(),Ue("tr",Le({key:0,role:"row"},t.ptm("headerRow")),[(le(!0),Ue(_n,null,or(n.columns,function(p,y){return le(),Ue(_n,{key:o.columnProp(p,"columnKey")||o.columnProp(p,"field")||y},[!o.columnProp(p,"hidden")&&(n.rowGroupMode!=="subheader"||n.groupRowsBy!==o.columnProp(p,"field"))?(le(),Ue("th",Le({key:0,style:o.getFilterColumnHeaderStyle(p),class:o.getFilterColumnHeaderClass(p)},Np(Np({},o.getColumnPT(p,"root",y)),o.getColumnPT(p,"headerCell",y))),[o.columnProp(p,"selectionMode")==="multiple"?(le(),Rt(s,{key:0,checked:n.allRowsSelected,disabled:n.empty,onChange:e[15]||(e[15]=function(v){return t.$emit("checkbox-change",v)}),column:p,pt:t.pt},null,8,["checked","disabled","column","pt"])):Jt("",!0),p.children&&p.children.filter?(le(),Rt(d,{key:1,field:o.columnProp(p,"filterField")||o.columnProp(p,"field"),type:o.columnProp(p,"dataType"),display:"row",showMenu:o.columnProp(p,"showFilterMenu"),filterElement:p.children&&p.children.filter,filterHeaderTemplate:p.children&&p.children.filterheader,filterFooterTemplate:p.children&&p.children.filterfooter,filterClearTemplate:p.children&&p.children.filterclear,filterApplyTemplate:p.children&&p.children.filterapply,filterIconTemplate:p.children&&p.children.filtericon,filterAddIconTemplate:p.children&&p.children.filteraddicon,filterRemoveIconTemplate:p.children&&p.children.filterremoveicon,filterClearIconTemplate:p.children&&p.children.filterclearicon,filters:n.filters,filtersStore:n.filtersStore,filterInputProps:n.filterInputProps,onFilterChange:e[16]||(e[16]=function(v){return t.$emit("filter-change",v)}),onFilterApply:e[17]||(e[17]=function(v){return t.$emit("filter-apply")}),filterMenuStyle:o.columnProp(p,"filterMenuStyle"),filterMenuClass:o.columnProp(p,"filterMenuClass"),showOperator:o.columnProp(p,"showFilterOperator"),showClearButton:o.columnProp(p,"showClearButton"),showApplyButton:o.columnProp(p,"showApplyButton"),showMatchModes:o.columnProp(p,"showFilterMatchModes"),showAddButton:o.columnProp(p,"showAddButton"),matchModeOptions:o.columnProp(p,"filterMatchModeOptions"),maxConstraints:o.columnProp(p,"maxConstraints"),onOperatorChange:e[18]||(e[18]=function(v){return t.$emit("operator-change",v)}),onMatchmodeChange:e[19]||(e[19]=function(v){return t.$emit("matchmode-change",v)}),onConstraintAdd:e[20]||(e[20]=function(v){return t.$emit("constraint-add",v)}),onConstraintRemove:e[21]||(e[21]=function(v){return t.$emit("constraint-remove",v)}),onApplyClick:e[22]||(e[22]=function(v){return t.$emit("apply-click",v)}),column:p,unstyled:t.unstyled,pt:t.pt},null,8,["field","type","showMenu","filterElement","filterHeaderTemplate","filterFooterTemplate","filterClearTemplate","filterApplyTemplate","filterIconTemplate","filterAddIconTemplate","filterRemoveIconTemplate","filterClearIconTemplate","filters","filtersStore","filterInputProps","filterMenuStyle","filterMenuClass","showOperator","showClearButton","showApplyButton","showMatchModes","showAddButton","matchModeOptions","maxConstraints","column","unstyled","pt"])):Jt("",!0)],16)):Jt("",!0)],64)}),128))],16)):Jt("",!0)],64))],16)}uj.render=GCe;function Xv(t){"@babel/helpers - typeof";return Xv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xv(t)}function s8(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Up(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?s8(Object(n),!0).forEach(function(i){HCe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s8(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function HCe(t,e,n){return e=WCe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WCe(t){var e=KCe(t,"string");return Xv(e)==="symbol"?e:String(e)}function KCe(t,e){if(Xv(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Xv(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function a8(t,e){return qCe(t)||ZCe(t,e)||W3(t,e)||XCe()}function XCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZCe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,o,l,s=[],d=!0,p=!1;try{if(o=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;d=!1}else for(;!(d=(i=o.call(n)).done)&&(s.push(i.value),s.length!==e);d=!0);}catch(y){p=!0,r=y}finally{try{if(!d&&n.return!=null&&(l=n.return(),Object(l)!==l))return}finally{if(p)throw r}}return s}}function qCe(t){if(Array.isArray(t))return t}function ah(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=W3(t))||e&&t&&typeof t.length=="number"){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(p){throw p},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,l=!1,s;return{s:function(){n=n.call(t)},n:function(){var p=n.next();return o=p.done,p},e:function(p){l=!0,s=p},f:function(){try{!o&&n.return!=null&&n.return()}finally{if(l)throw s}}}}function ao(t){return QCe(t)||JCe(t)||W3(t)||YCe()}function YCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function W3(t,e){if(t){if(typeof t=="string")return iI(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return iI(t,e)}}function JCe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function QCe(t){if(Array.isArray(t))return iI(t)}function iI(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var hj={name:"DataTable",extends:BSe,emits:["value-change","update:first","update:rows","page","update:sortField","update:sortOrder","update:multiSortMeta","sort","filter","row-click","row-dblclick","update:selection","row-select","row-unselect","update:contextMenuSelection","row-contextmenu","row-unselect-all","row-select-all","select-all-change","column-resize-end","column-reorder","row-reorder","update:expandedRows","row-collapse","row-expand","update:expandedRowGroups","rowgroup-collapse","rowgroup-expand","update:filters","state-restore","state-save","cell-edit-init","cell-edit-complete","cell-edit-cancel","update:editingRows","row-edit-init","row-edit-save","row-edit-cancel"],data:function(){return{d_first:this.first,d_rows:this.rows,d_sortField:this.sortField,d_sortOrder:this.sortOrder,d_nullSortOrder:this.nullSortOrder,d_multiSortMeta:this.multiSortMeta?ao(this.multiSortMeta):[],d_groupRowsSortMeta:null,d_selectionKeys:null,d_expandedRowKeys:null,d_columnOrder:null,d_editingRowKeys:null,d_editingMeta:{},d_filters:this.cloneFilters(this.filters)}},rowTouched:!1,anchorRowIndex:null,rangeRowIndex:null,documentColumnResizeListener:null,documentColumnResizeEndListener:null,lastResizeHelperX:null,resizeColumnElement:null,columnResizing:!1,colReorderIconWidth:null,colReorderIconHeight:null,draggedColumn:null,draggedRowIndex:null,droppedRowIndex:null,rowDragging:null,columnWidthsState:null,tableWidthState:null,columnWidthsRestored:!1,watch:{first:function(e){this.d_first=e},rows:function(e){this.d_rows=e},sortField:function(e){this.d_sortField=e},sortOrder:function(e){this.d_sortOrder=e},nullSortOrder:function(e){this.d_nullSortOrder=e},multiSortMeta:function(e){this.d_multiSortMeta=e},selection:{immediate:!0,handler:function(e){this.dataKey&&this.updateSelectionKeys(e)}},expandedRows:function(e){this.dataKey&&this.updateExpandedRowKeys(e)},editingRows:{deep:!0,handler:function(e){this.dataKey&&this.updateEditingRowKeys(e)}},filters:{deep:!0,handler:function(e){this.d_filters=this.cloneFilters(e)}}},beforeMount:function(){this.isStateful()&&this.restoreState()},mounted:function(){this.$el.setAttribute(this.attributeSelector,""),this.responsiveLayout==="stack"&&!this.scrollable&&!this.unstyled&&this.createResponsiveStyle(),this.isStateful()&&this.resizableColumns&&this.restoreColumnWidths(),this.editMode==="row"&&this.dataKey&&!this.d_editingRowKeys&&this.updateEditingRowKeys(this.editingRows)},beforeUnmount:function(){this.unbindColumnResizeEvents(),this.destroyStyleElement(),this.destroyResponsiveStyle()},updated:function(){this.isStateful()&&this.saveState(),this.editMode==="row"&&this.dataKey&&!this.d_editingRowKeys&&this.updateEditingRowKeys(this.editingRows)},methods:{columnProp:function(e,n){return At.getVNodeProp(e,n)},onPage:function(e){this.clearEditingMetaData(),this.d_first=e.first,this.d_rows=e.rows;var n=this.createLazyLoadEvent(e);n.pageCount=e.pageCount,n.page=e.page,this.$emit("update:first",this.d_first),this.$emit("update:rows",this.d_rows),this.$emit("page",n),this.$emit("value-change",this.processedData)},onColumnHeaderClick:function(e){var n=e.originalEvent,i=e.column;if(this.columnProp(i,"sortable")){var r=n.target,o=this.columnProp(i,"sortField")||this.columnProp(i,"field");if(He.getAttribute(r,"data-p-sortable-column")===!0||He.getAttribute(r,"data-pc-section")==="headertitle"||He.getAttribute(r,"data-pc-section")==="headercontent"||He.getAttribute(r,"data-pc-section")==="sorticon"||He.getAttribute(r.parentElement,"data-pc-section")==="sorticon"||He.getAttribute(r.parentElement.parentElement,"data-pc-section")==="sorticon"||r.closest('[data-p-sortable-column="true"]')&&!r.closest('[data-pc-section="filtermenubutton"]')){if(He.clearSelection(),this.sortMode==="single")this.d_sortField===o?this.removableSort&&this.d_sortOrder*-1===this.defaultSortOrder?(this.d_sortOrder=null,this.d_sortField=null):this.d_sortOrder=this.d_sortOrder*-1:(this.d_sortOrder=this.defaultSortOrder,this.d_sortField=o),this.$emit("update:sortField",this.d_sortField),this.$emit("update:sortOrder",this.d_sortOrder),this.resetPage();else if(this.sortMode==="multiple"){var l=n.metaKey||n.ctrlKey;l||(this.d_multiSortMeta=this.d_multiSortMeta.filter(function(s){return s.field===o})),this.addMultiSortField(o),this.$emit("update:multiSortMeta",this.d_multiSortMeta)}this.$emit("sort",this.createLazyLoadEvent(n)),this.$emit("value-change",this.processedData)}}},sortSingle:function(e){var n=this;if(this.clearEditingMetaData(),this.groupRowsBy&&this.groupRowsBy===this.sortField)return this.d_multiSortMeta=[{field:this.sortField,order:this.sortOrder||this.defaultSortOrder},{field:this.d_sortField,order:this.d_sortOrder}],this.sortMultiple(e);var i=ao(e),r=new Map,o=ah(i),l;try{for(o.s();!(l=o.n()).done;){var s=l.value;r.set(s,At.resolveFieldData(s,this.d_sortField))}}catch(p){o.e(p)}finally{o.f()}var d=At.localeComparator();return i.sort(function(p,y){var v=r.get(p),w=r.get(y);return At.sort(v,w,n.d_sortOrder,d,n.d_nullSortOrder)}),i},sortMultiple:function(e){var n=this;if(this.clearEditingMetaData(),this.groupRowsBy&&(this.d_groupRowsSortMeta||this.d_multiSortMeta.length&&this.groupRowsBy===this.d_multiSortMeta[0].field)){var i=this.d_multiSortMeta[0];!this.d_groupRowsSortMeta&&(this.d_groupRowsSortMeta=i),i.field!==this.d_groupRowsSortMeta.field&&(this.d_multiSortMeta=[this.d_groupRowsSortMeta].concat(ao(this.d_multiSortMeta)))}var r=ao(e);return r.sort(function(o,l){return n.multisortField(o,l,0)}),r},multisortField:function(e,n,i){var r=At.resolveFieldData(e,this.d_multiSortMeta[i].field),o=At.resolveFieldData(n,this.d_multiSortMeta[i].field),l=At.localeComparator();return r===o?this.d_multiSortMeta.length-1>i?this.multisortField(e,n,i+1):0:At.sort(r,o,this.d_multiSortMeta[i].order,l,this.d_nullSortOrder)},addMultiSortField:function(e){var n=this.d_multiSortMeta.findIndex(function(i){return i.field===e});n>=0?this.removableSort&&this.d_multiSortMeta[n].order*-1===this.defaultSortOrder?this.d_multiSortMeta.splice(n,1):this.d_multiSortMeta[n]={field:e,order:this.d_multiSortMeta[n].order*-1}:this.d_multiSortMeta.push({field:e,order:this.defaultSortOrder}),this.d_multiSortMeta=ao(this.d_multiSortMeta)},getActiveFilters:function(e){var n=function(l){var s=a8(l,2),d=s[0],p=s[1];if(p.constraints){var y=p.constraints.filter(function(v){return v.value!==null});if(y.length>0)return[d,Up(Up({},p),{},{constraints:y})]}else if(p.value!==null)return[d,p]},i=function(l){return l!==void 0},r=Object.entries(e).map(n).filter(i);return Object.fromEntries(r)},filter:function(e){var n=this;if(e){this.clearEditingMetaData();var i=this.getActiveFilters(this.filters),r;i.global&&(r=this.globalFilterFields||this.columns.map(function(U){return n.columnProp(U,"filterField")||n.columnProp(U,"field")}));for(var o=[],l=0;l<e.length;l++){var s=!0,d=!1,p=!1;for(var y in i)if(Object.prototype.hasOwnProperty.call(i,y)&&y!=="global"){p=!0;var v=y,w=i[v];if(w.operator){var T=ah(w.constraints),I;try{for(T.s();!(I=T.n()).done;){var L=I.value;if(s=this.executeLocalFilter(v,e[l],L),w.operator===za.OR&&s||w.operator===za.AND&&!s)break}}catch(U){T.e(U)}finally{T.f()}}else s=this.executeLocalFilter(v,e[l],w);if(!s)break}if(s&&i.global&&!d&&r)for(var k=0;k<r.length;k++){var F=r[k];if(d=_A.filters[i.global.matchMode||vr.CONTAINS](At.resolveFieldData(e[l],F),i.global.value,this.filterLocale),d)break}var B=void 0;i.global?B=p?p&&s&&d:d:B=p&&s,B&&o.push(e[l])}(o.length===this.value.length||Object.keys(i).length==0)&&(o=e);var G=this.createLazyLoadEvent();return G.filteredValue=o,this.$emit("filter",G),this.$emit("value-change",o),o}},executeLocalFilter:function(e,n,i){var r=i.value,o=i.matchMode||vr.STARTS_WITH,l=At.resolveFieldData(n,e),s=_A.filters[o];return s(l,r,this.filterLocale)},onRowClick:function(e){var n=e.originalEvent,i=this.$refs.bodyRef&&this.$refs.bodyRef.$el,r=He.findSingle(i,'tr[data-p-selectable-row="true"][tabindex="0"]');if(!He.isClickable(n.target)){if(this.$emit("row-click",e),this.selectionMode){var o=e.data,l=this.d_first+e.index;if(this.isMultipleSelectionMode()&&n.shiftKey&&this.anchorRowIndex!=null)He.clearSelection(),this.rangeRowIndex=l,this.selectRange(n);else{var s=this.isSelected(o),d=this.rowTouched?!1:this.metaKeySelection;if(this.anchorRowIndex=l,this.rangeRowIndex=l,d){var p=n.metaKey||n.ctrlKey;if(s&&p){if(this.isSingleSelectionMode())this.$emit("update:selection",null);else{var y=this.findIndexInSelection(o),v=this.selection.filter(function(F,B){return B!=y});this.$emit("update:selection",v)}this.$emit("row-unselect",{originalEvent:n,data:o,index:l,type:"row"})}else{if(this.isSingleSelectionMode())this.$emit("update:selection",o);else if(this.isMultipleSelectionMode()){var w=p?this.selection||[]:[];w=[].concat(ao(w),[o]),this.$emit("update:selection",w)}this.$emit("row-select",{originalEvent:n,data:o,index:l,type:"row"})}}else if(this.selectionMode==="single")s?(this.$emit("update:selection",null),this.$emit("row-unselect",{originalEvent:n,data:o,index:l,type:"row"})):(this.$emit("update:selection",o),this.$emit("row-select",{originalEvent:n,data:o,index:l,type:"row"}));else if(this.selectionMode==="multiple")if(s){var T=this.findIndexInSelection(o),I=this.selection.filter(function(F,B){return B!=T});this.$emit("update:selection",I),this.$emit("row-unselect",{originalEvent:n,data:o,index:l,type:"row"})}else{var L=this.selection?[].concat(ao(this.selection),[o]):[o];this.$emit("update:selection",L),this.$emit("row-select",{originalEvent:n,data:o,index:l,type:"row"})}}}if(this.rowTouched=!1,r){var k=e.originalEvent.target.closest('tr[data-p-selectable-row="true"]');r.tabIndex="-1",k.tabIndex="0"}}},onRowDblClick:function(e){var n=e.originalEvent;He.isClickable(n.target)||this.$emit("row-dblclick",e)},onRowRightClick:function(e){this.contextMenu&&(He.clearSelection(),e.originalEvent.target.focus()),this.$emit("update:contextMenuSelection",e.data),this.$emit("row-contextmenu",e)},onRowTouchEnd:function(){this.rowTouched=!0},onRowKeyDown:function(e,n){var i=e.originalEvent,r=e.data,o=e.index,l=i.metaKey||i.ctrlKey;if(this.selectionMode){var s=i.target;switch(i.code){case"ArrowDown":this.onArrowDownKey(i,s,o,n);break;case"ArrowUp":this.onArrowUpKey(i,s,o,n);break;case"Home":this.onHomeKey(i,s,o,n);break;case"End":this.onEndKey(i,s,o,n);break;case"Enter":this.onEnterKey(i,r,o);break;case"Space":this.onSpaceKey(i,r,o,n);break;case"Tab":this.onTabKey(i,o);break;default:if(i.code==="KeyA"&&l){var d=this.dataToRender(n.rows);this.$emit("update:selection",d)}break}}},onArrowDownKey:function(e,n,i,r){var o=this.findNextSelectableRow(n);if(o&&this.focusRowChange(n,o),e.shiftKey){var l=this.dataToRender(r.rows),s=i+1>=l.length?l.length-1:i+1;this.onRowClick({originalEvent:e,data:l[s],index:s})}e.preventDefault()},onArrowUpKey:function(e,n,i,r){var o=this.findPrevSelectableRow(n);if(o&&this.focusRowChange(n,o),e.shiftKey){var l=this.dataToRender(r.rows),s=i-1<=0?0:i-1;this.onRowClick({originalEvent:e,data:l[s],index:s})}e.preventDefault()},onHomeKey:function(e,n,i,r){var o=this.findFirstSelectableRow();if(o&&this.focusRowChange(n,o),e.ctrlKey&&e.shiftKey){var l=this.dataToRender(r.rows);this.$emit("update:selection",l.slice(0,i+1))}e.preventDefault()},onEndKey:function(e,n,i,r){var o=this.findLastSelectableRow();if(o&&this.focusRowChange(n,o),e.ctrlKey&&e.shiftKey){var l=this.dataToRender(r.rows);this.$emit("update:selection",l.slice(i,l.length))}e.preventDefault()},onEnterKey:function(e,n,i){this.onRowClick({originalEvent:e,data:n,index:i}),e.preventDefault()},onSpaceKey:function(e,n,i,r){if(this.onEnterKey(e,n,i),e.shiftKey&&this.selection!==null){var o=this.dataToRender(r.rows),l;if(this.selection.length>0){var s,d;s=At.findIndexInList(this.selection[0],o),d=At.findIndexInList(this.selection[this.selection.length-1],o),l=i<=s?d:s}else l=At.findIndexInList(this.selection,o);var p=l!==i?o.slice(Math.min(l,i),Math.max(l,i)+1):n;this.$emit("update:selection",p)}},onTabKey:function(e,n){var i=this.$refs.bodyRef&&this.$refs.bodyRef.$el,r=He.find(i,'tr[data-p-selectable-row="true"]');if(e.code==="Tab"&&r&&r.length>0){var o=He.findSingle(i,'tr[data-p-highlight="true"]'),l=He.findSingle(i,'tr[data-p-selectable-row="true"][tabindex="0"]');o?(o.tabIndex="0",l&&l!==o&&(l.tabIndex="-1")):(r[0].tabIndex="0",l!==r[0]&&(r[n].tabIndex="-1"))}},findNextSelectableRow:function(e){var n=e.nextElementSibling;return n?He.getAttribute(n,"data-p-selectable-row")===!0?n:this.findNextSelectableRow(n):null},findPrevSelectableRow:function(e){var n=e.previousElementSibling;return n?He.getAttribute(n,"data-p-selectable-row")===!0?n:this.findPrevSelectableRow(n):null},findFirstSelectableRow:function(){var e=He.findSingle(this.$refs.table,'tr[data-p-selectable-row="true"]');return e},findLastSelectableRow:function(){var e=He.find(this.$refs.table,'tr[data-p-selectable-row="true"]');return e?e[e.length-1]:null},focusRowChange:function(e,n){e.tabIndex="-1",n.tabIndex="0",He.focus(n)},toggleRowWithRadio:function(e){var n=e.data;this.isSelected(n)?(this.$emit("update:selection",null),this.$emit("row-unselect",{originalEvent:e.originalEvent,data:n,index:e.index,type:"radiobutton"})):(this.$emit("update:selection",n),this.$emit("row-select",{originalEvent:e.originalEvent,data:n,index:e.index,type:"radiobutton"}))},toggleRowWithCheckbox:function(e){var n=e.data;if(this.isSelected(n)){var i=this.findIndexInSelection(n),r=this.selection.filter(function(l,s){return s!=i});this.$emit("update:selection",r),this.$emit("row-unselect",{originalEvent:e.originalEvent,data:n,index:e.index,type:"checkbox"})}else{var o=this.selection?ao(this.selection):[];o=[].concat(ao(o),[n]),this.$emit("update:selection",o),this.$emit("row-select",{originalEvent:e.originalEvent,data:n,index:e.index,type:"checkbox"})}},toggleRowsWithCheckbox:function(e){if(this.selectAll!==null)this.$emit("select-all-change",e);else{var n=e.originalEvent,i=e.checked,r=[];i?(r=this.frozenValue?[].concat(ao(this.frozenValue),ao(this.processedData)):this.processedData,this.$emit("row-select-all",{originalEvent:n,data:r})):this.$emit("row-unselect-all",{originalEvent:n}),this.$emit("update:selection",r)}},isSingleSelectionMode:function(){return this.selectionMode==="single"},isMultipleSelectionMode:function(){return this.selectionMode==="multiple"},isSelected:function(e){return e&&this.selection?this.dataKey?this.d_selectionKeys?this.d_selectionKeys[At.resolveFieldData(e,this.dataKey)]!==void 0:!1:this.selection instanceof Array?this.findIndexInSelection(e)>-1:this.equals(e,this.selection):!1},findIndexInSelection:function(e){return this.findIndex(e,this.selection)},findIndex:function(e,n){var i=-1;if(n&&n.length){for(var r=0;r<n.length;r++)if(this.equals(e,n[r])){i=r;break}}return i},updateSelectionKeys:function(e){if(this.d_selectionKeys={},Array.isArray(e)){var n=ah(e),i;try{for(n.s();!(i=n.n()).done;){var r=i.value;this.d_selectionKeys[String(At.resolveFieldData(r,this.dataKey))]=1}}catch(o){n.e(o)}finally{n.f()}}else this.d_selectionKeys[String(At.resolveFieldData(e,this.dataKey))]=1},updateExpandedRowKeys:function(e){if(e&&e.length){this.d_expandedRowKeys={};var n=ah(e),i;try{for(n.s();!(i=n.n()).done;){var r=i.value;this.d_expandedRowKeys[String(At.resolveFieldData(r,this.dataKey))]=1}}catch(o){n.e(o)}finally{n.f()}}else this.d_expandedRowKeys=null},updateEditingRowKeys:function(e){if(e&&e.length){this.d_editingRowKeys={};var n=ah(e),i;try{for(n.s();!(i=n.n()).done;){var r=i.value;this.d_editingRowKeys[String(At.resolveFieldData(r,this.dataKey))]=1}}catch(o){n.e(o)}finally{n.f()}}else this.d_editingRowKeys=null},equals:function(e,n){return this.compareSelectionBy==="equals"?e===n:At.equals(e,n,this.dataKey)},selectRange:function(e){var n,i;this.rangeRowIndex>this.anchorRowIndex?(n=this.anchorRowIndex,i=this.rangeRowIndex):this.rangeRowIndex<this.anchorRowIndex?(n=this.rangeRowIndex,i=this.anchorRowIndex):(n=this.rangeRowIndex,i=this.rangeRowIndex),this.lazy&&this.paginator&&(n-=this.first,i-=this.first);for(var r=this.processedData,o=[],l=n;l<=i;l++){var s=r[l];o.push(s),this.$emit("row-select",{originalEvent:e,data:s,type:"row"})}this.$emit("update:selection",o)},exportCSV:function(e,n){var i=this,r="\uFEFF";n||(n=this.processedData,e&&e.selectionOnly?n=this.selection||[]:this.frozenValue&&(n=n?[].concat(ao(this.frozenValue),ao(n)):this.frozenValue));for(var o=!1,l=0;l<this.columns.length;l++){var s=this.columns[l];this.columnProp(s,"exportable")!==!1&&this.columnProp(s,"field")&&(o?r+=this.csvSeparator:o=!0,r+='"'+(this.columnProp(s,"exportHeader")||this.columnProp(s,"header")||this.columnProp(s,"field"))+'"')}n&&n.forEach(function(v){r+=`
`;for(var w=!1,T=0;T<i.columns.length;T++){var I=i.columns[T];if(i.columnProp(I,"exportable")!==!1&&i.columnProp(I,"field")){w?r+=i.csvSeparator:w=!0;var L=At.resolveFieldData(v,i.columnProp(I,"field"));L!=null?i.exportFunction?L=i.exportFunction({data:L,field:i.columnProp(I,"field")}):L=String(L).replace(/"/g,'""'):L="",r+='"'+L+'"'}}});for(var d=!1,p=0;p<this.columns.length;p++){var y=this.columns[p];p===0&&(r+=`
`),this.columnProp(y,"exportable")!==!1&&this.columnProp(y,"exportFooter")&&(d?r+=this.csvSeparator:d=!0,r+='"'+(this.columnProp(y,"exportFooter")||this.columnProp(y,"footer")||this.columnProp(y,"field"))+'"')}He.exportCSV(r,this.exportFilename)},resetPage:function(){this.d_first=0,this.$emit("update:first",this.d_first)},onColumnResizeStart:function(e){var n=He.getOffset(this.$el).left;this.resizeColumnElement=e.target.parentElement,this.columnResizing=!0,this.lastResizeHelperX=e.pageX-n+this.$el.scrollLeft,this.bindColumnResizeEvents()},onColumnResize:function(e){var n=He.getOffset(this.$el).left;this.$el.setAttribute("data-p-unselectable-text","true"),!this.isUnstyled&&He.addClass(this.$el,"p-unselectable-text"),this.$refs.resizeHelper.style.height=this.$el.offsetHeight+"px",this.$refs.resizeHelper.style.top="0px",this.$refs.resizeHelper.style.left=e.pageX-n+this.$el.scrollLeft+"px",this.$refs.resizeHelper.style.display="block"},onColumnResizeEnd:function(){var e=this.$refs.resizeHelper.offsetLeft-this.lastResizeHelperX,n=this.resizeColumnElement.offsetWidth,i=n+e,r=this.resizeColumnElement.style.minWidth||15;if(n+e>parseInt(r,10)){if(this.columnResizeMode==="fit"){var o=this.resizeColumnElement.nextElementSibling,l=o.offsetWidth-e;i>15&&l>15&&this.resizeTableCells(i,l)}else if(this.columnResizeMode==="expand"){var s=this.$refs.table.offsetWidth+e+"px",d=function(w){w&&(w.style.width=w.style.minWidth=s)};if(this.resizeTableCells(i),d(this.$refs.table),!this.virtualScrollerDisabled){var p=this.$refs.bodyRef&&this.$refs.bodyRef.$el,y=this.$refs.frozenBodyRef&&this.$refs.frozenBodyRef.$el;d(p),d(y)}}this.$emit("column-resize-end",{element:this.resizeColumnElement,delta:e})}this.$refs.resizeHelper.style.display="none",this.resizeColumn=null,this.$el.setAttribute("data-p-unselectable-text","true"),!this.isUnstyled&&He.removeClass(this.$el,"p-unselectable-text"),this.unbindColumnResizeEvents(),this.isStateful()&&this.saveState()},resizeTableCells:function(e,n){var i=He.index(this.resizeColumnElement),r=[],o=He.find(this.$refs.table,'thead[data-pc-section="thead"] > tr > th');o.forEach(function(d){return r.push(He.getOuterWidth(d))}),this.destroyStyleElement(),this.createStyleElement();var l="",s='[data-pc-name="datatable"]['.concat(this.attributeSelector,'] > [data-pc-section="wrapper"] ').concat(this.virtualScrollerDisabled?"":'> [data-pc-section="virtualscroller"]',' > table[data-pc-section="table"]');r.forEach(function(d,p){var y=p===i?e:n&&p===i+1?n:d,v="width: ".concat(y,"px !important; max-width: ").concat(y,"px !important");l+=`
                    `.concat(s,' > thead[data-pc-section="thead"] > tr > th:nth-child(').concat(p+1,`),
                    `).concat(s,' > tbody[data-pc-section="tbody"] > tr > td:nth-child(').concat(p+1,`),
                    `).concat(s,' > tfoot[data-pc-section="tfoot"] > tr > td:nth-child(').concat(p+1,`) {
                        `).concat(v,`
                    }
                `)}),this.styleElement.innerHTML=l},bindColumnResizeEvents:function(){var e=this;this.documentColumnResizeListener||(this.documentColumnResizeListener=document.addEventListener("mousemove",function(){e.columnResizing&&e.onColumnResize(event)})),this.documentColumnResizeEndListener||(this.documentColumnResizeEndListener=document.addEventListener("mouseup",function(){e.columnResizing&&(e.columnResizing=!1,e.onColumnResizeEnd())}))},unbindColumnResizeEvents:function(){this.documentColumnResizeListener&&(document.removeEventListener("document",this.documentColumnResizeListener),this.documentColumnResizeListener=null),this.documentColumnResizeEndListener&&(document.removeEventListener("document",this.documentColumnResizeEndListener),this.documentColumnResizeEndListener=null)},onColumnHeaderMouseDown:function(e){var n=e.originalEvent,i=e.column;this.reorderableColumns&&this.columnProp(i,"reorderableColumn")!==!1&&(n.target.nodeName==="INPUT"||n.target.nodeName==="TEXTAREA"||He.getAttribute(n.target,'[data-pc-section="columnresizer"]')?n.currentTarget.draggable=!1:n.currentTarget.draggable=!0)},onColumnHeaderDragStart:function(e){if(this.columnResizing){e.preventDefault();return}this.colReorderIconWidth=He.getHiddenElementOuterWidth(this.$refs.reorderIndicatorUp),this.colReorderIconHeight=He.getHiddenElementOuterHeight(this.$refs.reorderIndicatorUp),this.draggedColumn=this.findParentHeader(e.target),e.dataTransfer.setData("text","b")},onColumnHeaderDragOver:function(e){var n=this.findParentHeader(e.target);if(this.reorderableColumns&&this.draggedColumn&&n){e.preventDefault();var i=He.getOffset(this.$el),r=He.getOffset(n);if(this.draggedColumn!==n){var o=r.left-i.left,l=r.left+n.offsetWidth/2;this.$refs.reorderIndicatorUp.style.top=r.top-i.top-(this.colReorderIconHeight-1)+"px",this.$refs.reorderIndicatorDown.style.top=r.top-i.top+n.offsetHeight+"px",e.pageX>l?(this.$refs.reorderIndicatorUp.style.left=o+n.offsetWidth-Math.ceil(this.colReorderIconWidth/2)+"px",this.$refs.reorderIndicatorDown.style.left=o+n.offsetWidth-Math.ceil(this.colReorderIconWidth/2)+"px",this.dropPosition=1):(this.$refs.reorderIndicatorUp.style.left=o-Math.ceil(this.colReorderIconWidth/2)+"px",this.$refs.reorderIndicatorDown.style.left=o-Math.ceil(this.colReorderIconWidth/2)+"px",this.dropPosition=-1),this.$refs.reorderIndicatorUp.style.display="block",this.$refs.reorderIndicatorDown.style.display="block"}}},onColumnHeaderDragLeave:function(e){this.reorderableColumns&&this.draggedColumn&&(e.preventDefault(),this.$refs.reorderIndicatorUp.style.display="none",this.$refs.reorderIndicatorDown.style.display="none")},onColumnHeaderDrop:function(e){if(e.preventDefault(),this.draggedColumn){var n=He.index(this.draggedColumn),i=He.index(this.findParentHeader(e.target)),r=n!==i;r&&(i-n===1&&this.dropPosition===-1||i-n===-1&&this.dropPosition===1)&&(r=!1),r&&(At.reorderArray(this.columns,n,i),this.updateReorderableColumns(),this.$emit("column-reorder",{originalEvent:e,dragIndex:n,dropIndex:i})),this.$refs.reorderIndicatorUp.style.display="none",this.$refs.reorderIndicatorDown.style.display="none",this.draggedColumn.draggable=!1,this.draggedColumn=null,this.dropPosition=null}},findParentHeader:function(e){if(e.nodeName==="TH")return e;for(var n=e.parentElement;n.nodeName!=="TH"&&(n=n.parentElement,!!n););return n},findColumnByKey:function(e,n){if(e&&e.length)for(var i=0;i<e.length;i++){var r=e[i];if(this.columnProp(r,"columnKey")===n||this.columnProp(r,"field")===n)return r}return null},onRowMouseDown:function(e){He.getAttribute(e.target,"data-pc-section")==="rowreordericon"||He.getAttribute(e.target.parentElement,"data-pc-section")==="rowreordericon"?e.currentTarget.draggable=!0:e.currentTarget.draggable=!1},onRowDragStart:function(e){var n=e.originalEvent,i=e.index;this.rowDragging=!0,this.draggedRowIndex=i,n.dataTransfer.setData("text","b")},onRowDragOver:function(e){var n=e.originalEvent,i=e.index;if(this.rowDragging&&this.draggedRowIndex!==i){var r=n.currentTarget,o=He.getOffset(r).top+He.getWindowScrollTop(),l=n.pageY,s=o+He.getOuterHeight(r)/2,d=r.previousElementSibling;l<s?(r.setAttribute("data-p-datatable-dragpoint-bottom","false"),!this.isUnstyled&&He.removeClass(r,"p-datatable-dragpoint-bottom"),this.droppedRowIndex=i,d?(d.setAttribute("data-p-datatable-dragpoint-bottom","true"),!this.isUnstyled&&He.addClass(d,"p-datatable-dragpoint-bottom")):(r.setAttribute("data-p-datatable-dragpoint-top","true"),!this.isUnstyled&&He.addClass(r,"p-datatable-dragpoint-top"))):(d?(d.setAttribute("data-p-datatable-dragpoint-bottom","false"),!this.isUnstyled&&He.removeClass(d,"p-datatable-dragpoint-bottom")):(r.setAttribute("data-p-datatable-dragpoint-top","true"),!this.isUnstyled&&He.addClass(r,"p-datatable-dragpoint-top")),this.droppedRowIndex=i+1,r.setAttribute("data-p-datatable-dragpoint-bottom","true"),!this.isUnstyled&&He.addClass(r,"p-datatable-dragpoint-bottom")),n.preventDefault()}},onRowDragLeave:function(e){var n=e.currentTarget,i=n.previousElementSibling;i&&(i.setAttribute("data-p-datatable-dragpoint-bottom","false"),!this.isUnstyled&&He.removeClass(i,"p-datatable-dragpoint-bottom")),n.setAttribute("data-p-datatable-dragpoint-bottom","false"),!this.isUnstyled&&He.removeClass(n,"p-datatable-dragpoint-bottom"),n.setAttribute("data-p-datatable-dragpoint-top","false"),!this.isUnstyled&&He.removeClass(n,"p-datatable-dragpoint-top")},onRowDragEnd:function(e){this.rowDragging=!1,this.draggedRowIndex=null,this.droppedRowIndex=null,e.currentTarget.draggable=!1},onRowDrop:function(e){if(this.droppedRowIndex!=null){var n=this.draggedRowIndex>this.droppedRowIndex?this.droppedRowIndex:this.droppedRowIndex===0?0:this.droppedRowIndex-1,i=ao(this.processedData);At.reorderArray(i,this.draggedRowIndex+this.d_first,n+this.d_first),this.$emit("row-reorder",{originalEvent:e,dragIndex:this.draggedRowIndex,dropIndex:n,value:i})}this.onRowDragLeave(e),this.onRowDragEnd(e),e.preventDefault()},toggleRow:function(e){var n=e.data,i,r,o=this.expandedRows?ao(this.expandedRows):[];this.dataKey?i=this.d_expandedRowKeys?this.d_expandedRowKeys[At.resolveFieldData(n,this.dataKey)]!==void 0:!1:(r=this.findIndex(n,this.expandedRows),i=r>-1),i?(r==null&&(r=this.findIndex(n,this.expandedRows)),o.splice(r,1),this.$emit("update:expandedRows",o),this.$emit("row-collapse",e)):(o.push(n),this.$emit("update:expandedRows",o),this.$emit("row-expand",e))},toggleRowGroup:function(e){var n=e.originalEvent,i=e.data,r=At.resolveFieldData(i,this.groupRowsBy),o=this.expandedRowGroups?ao(this.expandedRowGroups):[];this.isRowGroupExpanded(i)?(o=o.filter(function(l){return l!==r}),this.$emit("update:expandedRowGroups",o),this.$emit("rowgroup-collapse",{originalEvent:n,data:r})):(o.push(r),this.$emit("update:expandedRowGroups",o),this.$emit("rowgroup-expand",{originalEvent:n,data:r}))},isRowGroupExpanded:function(e){if(this.expandableRowGroups&&this.expandedRowGroups){var n=At.resolveFieldData(e,this.groupRowsBy);return this.expandedRowGroups.indexOf(n)>-1}return!1},isStateful:function(){return this.stateKey!=null},getStorage:function(){switch(this.stateStorage){case"local":return window.localStorage;case"session":return window.sessionStorage;default:throw new Error(this.stateStorage+' is not a valid value for the state storage, supported values are "local" and "session".')}},saveState:function(){var e=this.getStorage(),n={};this.paginator&&(n.first=this.d_first,n.rows=this.d_rows),this.d_sortField&&(n.sortField=this.d_sortField,n.sortOrder=this.d_sortOrder),this.d_multiSortMeta&&(n.multiSortMeta=this.d_multiSortMeta),this.hasFilters&&(n.filters=this.filters),this.resizableColumns&&this.saveColumnWidths(n),this.reorderableColumns&&(n.columnOrder=this.d_columnOrder),this.expandedRows&&(n.expandedRows=this.expandedRows,n.expandedRowKeys=this.d_expandedRowKeys),this.expandedRowGroups&&(n.expandedRowGroups=this.expandedRowGroups),this.selection&&(n.selection=this.selection,n.selectionKeys=this.d_selectionKeys),Object.keys(n).length&&e.setItem(this.stateKey,JSON.stringify(n)),this.$emit("state-save",n)},restoreState:function(){var e=this.getStorage(),n=e.getItem(this.stateKey),i=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/,r=function(s,d){return typeof d=="string"&&i.test(d)?new Date(d):d};if(n){var o=JSON.parse(n,r);this.paginator&&(this.d_first=o.first,this.d_rows=o.rows),o.sortField&&(this.d_sortField=o.sortField,this.d_sortOrder=o.sortOrder),o.multiSortMeta&&(this.d_multiSortMeta=o.multiSortMeta),o.filters&&this.$emit("update:filters",o.filters),this.resizableColumns&&(this.columnWidthsState=o.columnWidths,this.tableWidthState=o.tableWidth),this.reorderableColumns&&(this.d_columnOrder=o.columnOrder),o.expandedRows&&(this.d_expandedRowKeys=o.expandedRowKeys,this.$emit("update:expandedRows",o.expandedRows)),o.expandedRowGroups&&this.$emit("update:expandedRowGroups",o.expandedRowGroups),o.selection&&(this.d_selectionKeys=o.d_selectionKeys,this.$emit("update:selection",o.selection)),this.$emit("state-restore",o)}},saveColumnWidths:function(e){var n=[],i=He.find(this.$el,'thead[data-pc-section="thead"] > tr > th');i.forEach(function(r){return n.push(He.getOuterWidth(r))}),e.columnWidths=n.join(","),this.columnResizeMode==="expand"&&(e.tableWidth=He.getOuterWidth(this.$refs.table)+"px")},restoreColumnWidths:function(){if(this.columnWidthsState){var e=this.columnWidthsState.split(",");if(this.columnResizeMode==="expand"&&this.tableWidthState&&(this.$refs.table.style.width=this.tableWidthState,this.$refs.table.style.minWidth=this.tableWidthState,this.$el.style.width=this.tableWidthState),At.isNotEmpty(e)){this.createStyleElement();var n="",i='[data-pc-name="datatable"]['.concat(this.attributeSelector,'] > [data-pc-section="wrapper"] ').concat(this.virtualScrollerDisabled?"":'> [data-pc-section="virtualscroller"]',' > table[data-pc-section="table"]');e.forEach(function(r,o){var l="width: ".concat(r,"px !important; max-width: ").concat(r,"px !important");n+=`
                            `.concat(i,' > thead[data-pc-section="thead"] > tr > th:nth-child(').concat(o+1,`),
                            `).concat(i,' > tbody[data-pc-section="tbody"] > tr > td:nth-child(').concat(o+1,`),
                            `).concat(i,' > tfoot[data-pc-section="tfoot"] > tr > td:nth-child(').concat(o+1,`) {
                                `).concat(l,`
                            }
                        `)}),this.styleElement.innerHTML=n}}},onCellEditInit:function(e){this.$emit("cell-edit-init",e)},onCellEditComplete:function(e){this.$emit("cell-edit-complete",e)},onCellEditCancel:function(e){this.$emit("cell-edit-cancel",e)},onRowEditInit:function(e){var n=this.editingRows?ao(this.editingRows):[];n.push(e.data),this.$emit("update:editingRows",n),this.$emit("row-edit-init",e)},onRowEditSave:function(e){var n=ao(this.editingRows);n.splice(this.findIndex(e.data,n),1),this.$emit("update:editingRows",n),this.$emit("row-edit-save",e)},onRowEditCancel:function(e){var n=ao(this.editingRows);n.splice(this.findIndex(e.data,n),1),this.$emit("update:editingRows",n),this.$emit("row-edit-cancel",e)},onEditingMetaChange:function(e){var n=e.data,i=e.field,r=e.index,o=e.editing,l=Up({},this.d_editingMeta),s=l[r];if(o)!s&&(s=l[r]={data:Up({},n),fields:[]}),s.fields.push(i);else if(s){var d=s.fields.filter(function(p){return p!==i});d.length?s.fields=d:delete l[r]}this.d_editingMeta=l},clearEditingMetaData:function(){this.editMode&&(this.d_editingMeta={})},createLazyLoadEvent:function(e){return{originalEvent:e,first:this.d_first,rows:this.d_rows,sortField:this.d_sortField,sortOrder:this.d_sortOrder,multiSortMeta:this.d_multiSortMeta,filters:this.d_filters}},hasGlobalFilter:function(){return this.filters&&Object.prototype.hasOwnProperty.call(this.filters,"global")},getChildren:function(){return this.$slots.default?this.$slots.default():null},onFilterChange:function(e){this.d_filters=e},onFilterApply:function(){this.d_first=0,this.$emit("update:first",this.d_first),this.$emit("update:filters",this.d_filters),this.lazy&&this.$emit("filter",this.createLazyLoadEvent())},cloneFilters:function(){var e={};return this.filters&&Object.entries(this.filters).forEach(function(n){var i=a8(n,2),r=i[0],o=i[1];e[r]=o.operator?{operator:o.operator,constraints:o.constraints.map(function(l){return Up({},l)})}:Up({},o)}),e},updateReorderableColumns:function(){var e=this,n=[];this.columns.forEach(function(i){return n.push(e.columnProp(i,"columnKey")||e.columnProp(i,"field"))}),this.d_columnOrder=n},createStyleElement:function(){var e;this.styleElement=document.createElement("style"),this.styleElement.type="text/css",He.setAttribute(this.styleElement,"nonce",(e=this.$primevue)===null||e===void 0||(e=e.config)===null||e===void 0||(e=e.csp)===null||e===void 0?void 0:e.nonce),document.head.appendChild(this.styleElement)},createResponsiveStyle:function(){if(!this.responsiveStyleElement){var e;this.responsiveStyleElement=document.createElement("style"),this.responsiveStyleElement.type="text/css",He.setAttribute(this.responsiveStyleElement,"nonce",(e=this.$primevue)===null||e===void 0||(e=e.config)===null||e===void 0||(e=e.csp)===null||e===void 0?void 0:e.nonce),document.head.appendChild(this.responsiveStyleElement);var n=".p-datatable-wrapper ".concat(this.virtualScrollerDisabled?"":"> .p-virtualscroller"," > .p-datatable-table"),i=".p-datatable[".concat(this.attributeSelector,"] > ").concat(n),r=".p-datatable[".concat(this.attributeSelector,"].p-datatable-gridlines > ").concat(n),o=`
@media screen and (max-width: `.concat(this.breakpoint,`) {
    `).concat(i,` > .p-datatable-thead > tr > th,
    `).concat(i,` > .p-datatable-tfoot > tr > td {
        display: none !important;
    }

    `).concat(i,` > .p-datatable-tbody > tr > td {
        display: flex;
        width: 100% !important;
        align-items: center;
        justify-content: space-between;
    }

    `).concat(i,` > .p-datatable-tbody > tr > td:not(:last-child) {
        border: 0 none;
    }

    `).concat(r,` > .p-datatable-tbody > tr > td:last-child {
        border-top: 0;
        border-right: 0;
        border-left: 0;
    }

    `).concat(i,` > .p-datatable-tbody > tr > td > .p-column-title {
        display: block;
    }
}
`);this.responsiveStyleElement.innerHTML=o}},destroyResponsiveStyle:function(){this.responsiveStyleElement&&(document.head.removeChild(this.responsiveStyleElement),this.responsiveStyleElement=null)},destroyStyleElement:function(){this.styleElement&&(document.head.removeChild(this.styleElement),this.styleElement=null)},recursiveGetChildren:function(e,n){var i=this;return n||(n=[]),e&&e.length&&e.forEach(function(r){r.children instanceof Array?n.concat(i.recursiveGetChildren(r.children,n)):r.type.name=="Column"&&n.push(r)}),n},dataToRender:function(e){var n=e||this.processedData;if(n&&this.paginator){var i=this.lazy?0:this.d_first;return n.slice(i,i+this.d_rows)}return n},getVirtualScrollerRef:function(){return this.$refs.virtualScroller},hasSpacerStyle:function(e){return At.isNotEmpty(e)}},computed:{columns:function(){var e=this.getChildren();if(e){var n=this.recursiveGetChildren(e,[]);if(this.reorderableColumns&&this.d_columnOrder){var i=[],r=ah(this.d_columnOrder),o;try{for(r.s();!(o=r.n()).done;){var l=o.value,s=this.findColumnByKey(n,l);s&&!this.columnProp(s,"hidden")&&i.push(s)}}catch(d){r.e(d)}finally{r.f()}return[].concat(i,ao(n.filter(function(d){return i.indexOf(d)<0})))}return n}},headerColumnGroup:function(){var e=this.getChildren();if(e){var n=ah(e),i;try{for(n.s();!(i=n.n()).done;){var r=i.value;if(r.type.name==="ColumnGroup"&&this.columnProp(r,"type")==="header")return r}}catch(o){n.e(o)}finally{n.f()}}return null},footerColumnGroup:function(){var e=this.getChildren();if(e){var n=ah(e),i;try{for(n.s();!(i=n.n()).done;){var r=i.value;if(r.type.name==="ColumnGroup"&&this.columnProp(r,"type")==="footer")return r}}catch(o){n.e(o)}finally{n.f()}}return null},hasFilters:function(){return this.filters&&Object.keys(this.filters).length>0&&this.filters.constructor===Object},processedData:function(){var e=this.value||[];return this.lazy||e&&e.length&&(this.hasFilters&&(e=this.filter(e)),this.sorted&&(this.sortMode==="single"?e=this.sortSingle(e):this.sortMode==="multiple"&&(e=this.sortMultiple(e)))),e},totalRecordsLength:function(){if(this.lazy)return this.totalRecords;var e=this.processedData;return e?e.length:0},empty:function(){var e=this.processedData;return!e||e.length===0},paginatorTop:function(){return this.paginator&&(this.paginatorPosition!=="bottom"||this.paginatorPosition==="both")},paginatorBottom:function(){return this.paginator&&(this.paginatorPosition!=="top"||this.paginatorPosition==="both")},sorted:function(){return this.d_sortField||this.d_multiSortMeta&&this.d_multiSortMeta.length>0},allRowsSelected:function(){var e=this;if(this.selectAll!==null)return this.selectAll;var n=this.frozenValue?[].concat(ao(this.frozenValue),ao(this.processedData)):this.processedData;return At.isNotEmpty(n)&&this.selection&&Array.isArray(this.selection)&&n.every(function(i){return e.selection.some(function(r){return e.equals(r,i)})})},attributeSelector:function(){return Gr()},groupRowSortField:function(){return this.sortMode==="single"?this.sortField:this.d_groupRowsSortMeta?this.d_groupRowsSortMeta.field:null},virtualScrollerDisabled:function(){return At.isEmpty(this.virtualScrollerOptions)||!this.scrollable}},components:{DTPaginator:ZV,DTTableHeader:uj,DTTableBody:rj,DTTableFooter:aj,DTVirtualScroller:l3,ArrowDownIcon:LV,ArrowUpIcon:OV,SpinnerIcon:A_}};function Zv(t){"@babel/helpers - typeof";return Zv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zv(t)}function l8(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function c8(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?l8(Object(n),!0).forEach(function(i){eAe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l8(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function eAe(t,e,n){return e=tAe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tAe(t){var e=nAe(t,"string");return Zv(e)==="symbol"?e:String(e)}function nAe(t,e){if(Zv(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Zv(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function iAe(t,e,n,i,r,o){var l=Gn("SpinnerIcon"),s=Gn("DTPaginator"),d=Gn("DTTableHeader"),p=Gn("DTTableBody"),y=Gn("DTTableFooter"),v=Gn("DTVirtualScroller");return le(),Ue("div",Le({class:t.cx("root"),"data-scrollselectors":".p-datatable-wrapper"},t.ptm("root"),{"data-pc-name":"datatable"}),[Xn(t.$slots,"default"),t.loading?(le(),Ue("div",Le({key:0,class:t.cx("loadingOverlay")},t.ptm("loadingOverlay")),[t.$slots.loading?Xn(t.$slots,"loading",{key:0}):(le(),Ue(_n,{key:1},[t.$slots.loadingicon?(le(),Rt(Zn(t.$slots.loadingicon),{key:0,class:ri(t.cx("loadingIcon"))},null,8,["class"])):t.loadingIcon?(le(),Ue("i",Le({key:1,class:[t.cx("loadingIcon"),"pi-spin",t.loadingIcon]},t.ptm("loadingIcon")),null,16)):(le(),Rt(l,Le({key:2,spin:"",class:t.cx("loadingIcon")},t.ptm("loadingIcon")),null,16,["class"]))],64))],16)):Jt("",!0),t.$slots.header?(le(),Ue("div",Le({key:1,class:t.cx("header")},t.ptm("header")),[Xn(t.$slots,"header")],16)):Jt("",!0),o.paginatorTop?(le(),Rt(s,{key:2,rows:r.d_rows,first:r.d_first,totalRecords:o.totalRecordsLength,pageLinkSize:t.pageLinkSize,template:t.paginatorTemplate,rowsPerPageOptions:t.rowsPerPageOptions,currentPageReportTemplate:t.currentPageReportTemplate,class:ri(t.cx("paginator")),onPage:e[0]||(e[0]=function(w){return o.onPage(w)}),alwaysShow:t.alwaysShowPaginator,unstyled:t.unstyled,pt:t.ptm("paginator")},Pm({_:2},[t.$slots.paginatorstart?{name:"start",fn:Cn(function(){return[Xn(t.$slots,"paginatorstart")]}),key:"0"}:void 0,t.$slots.paginatorend?{name:"end",fn:Cn(function(){return[Xn(t.$slots,"paginatorend")]}),key:"1"}:void 0,t.$slots.paginatorfirstpagelinkicon?{name:"firstpagelinkicon",fn:Cn(function(w){return[Xn(t.$slots,"paginatorfirstpagelinkicon",{class:ri(w.class)})]}),key:"2"}:void 0,t.$slots.paginatorprevpagelinkicon?{name:"prevpagelinkicon",fn:Cn(function(w){return[Xn(t.$slots,"paginatorprevpagelinkicon",{class:ri(w.class)})]}),key:"3"}:void 0,t.$slots.paginatornextpagelinkicon?{name:"nextpagelinkicon",fn:Cn(function(w){return[Xn(t.$slots,"paginatornextpagelinkicon",{class:ri(w.class)})]}),key:"4"}:void 0,t.$slots.paginatorlastpagelinkicon?{name:"lastpagelinkicon",fn:Cn(function(w){return[Xn(t.$slots,"paginatorlastpagelinkicon",{class:ri(w.class)})]}),key:"5"}:void 0,t.$slots.paginatorjumptopagedropdownicon?{name:"jumptopagedropdownicon",fn:Cn(function(w){return[Xn(t.$slots,"paginatorjumptopagedropdownicon",{class:ri(w.class)})]}),key:"6"}:void 0,t.$slots.paginatorrowsperpagedropdownicon?{name:"rowsperpagedropdownicon",fn:Cn(function(w){return[Xn(t.$slots,"paginatorrowsperpagedropdownicon",{class:ri(w.class)})]}),key:"7"}:void 0]),1032,["rows","first","totalRecords","pageLinkSize","template","rowsPerPageOptions","currentPageReportTemplate","class","alwaysShow","unstyled","pt"])):Jt("",!0),Qe("div",Le({class:t.cx("wrapper"),style:[t.sx("wrapper"),{maxHeight:o.virtualScrollerDisabled?t.scrollHeight:""}]},t.ptm("wrapper")),[Lt(v,Le({ref:"virtualScroller"},t.virtualScrollerOptions,{items:o.processedData,columns:o.columns,style:t.scrollHeight!=="flex"?{height:t.scrollHeight}:void 0,scrollHeight:t.scrollHeight!=="flex"?void 0:"100%",disabled:o.virtualScrollerDisabled,loaderDisabled:"",inline:"",autoSize:"",showSpacer:!1,pt:t.ptm("virtualScroller")}),{content:Cn(function(w){return[Qe("table",Le({ref:"table",role:"table",class:[t.cx("table"),t.tableClass],style:[t.tableStyle,w.spacerStyle]},c8(c8({},t.tableProps),t.ptm("table"))),[Lt(d,{columnGroup:o.headerColumnGroup,columns:w.columns,rowGroupMode:t.rowGroupMode,groupRowsBy:t.groupRowsBy,groupRowSortField:o.groupRowSortField,reorderableColumns:t.reorderableColumns,resizableColumns:t.resizableColumns,allRowsSelected:o.allRowsSelected,empty:o.empty,sortMode:t.sortMode,sortField:r.d_sortField,sortOrder:r.d_sortOrder,multiSortMeta:r.d_multiSortMeta,filters:r.d_filters,filtersStore:t.filters,filterDisplay:t.filterDisplay,filterInputProps:t.filterInputProps,onColumnClick:e[1]||(e[1]=function(T){return o.onColumnHeaderClick(T)}),onColumnMousedown:e[2]||(e[2]=function(T){return o.onColumnHeaderMouseDown(T)}),onFilterChange:o.onFilterChange,onFilterApply:o.onFilterApply,onColumnDragstart:e[3]||(e[3]=function(T){return o.onColumnHeaderDragStart(T)}),onColumnDragover:e[4]||(e[4]=function(T){return o.onColumnHeaderDragOver(T)}),onColumnDragleave:e[5]||(e[5]=function(T){return o.onColumnHeaderDragLeave(T)}),onColumnDrop:e[6]||(e[6]=function(T){return o.onColumnHeaderDrop(T)}),onColumnResizestart:e[7]||(e[7]=function(T){return o.onColumnResizeStart(T)}),onCheckboxChange:e[8]||(e[8]=function(T){return o.toggleRowsWithCheckbox(T)}),unstyled:t.unstyled,pt:t.pt},null,8,["columnGroup","columns","rowGroupMode","groupRowsBy","groupRowSortField","reorderableColumns","resizableColumns","allRowsSelected","empty","sortMode","sortField","sortOrder","multiSortMeta","filters","filtersStore","filterDisplay","filterInputProps","onFilterChange","onFilterApply","unstyled","pt"]),t.frozenValue?(le(),Rt(p,{key:0,ref:"frozenBodyRef",value:t.frozenValue,frozenRow:!0,columns:w.columns,first:r.d_first,dataKey:t.dataKey,selection:t.selection,selectionKeys:r.d_selectionKeys,selectionMode:t.selectionMode,contextMenu:t.contextMenu,contextMenuSelection:t.contextMenuSelection,rowGroupMode:t.rowGroupMode,groupRowsBy:t.groupRowsBy,expandableRowGroups:t.expandableRowGroups,rowClass:t.rowClass,rowStyle:t.rowStyle,editMode:t.editMode,compareSelectionBy:t.compareSelectionBy,scrollable:t.scrollable,expandedRowIcon:t.expandedRowIcon,collapsedRowIcon:t.collapsedRowIcon,expandedRows:t.expandedRows,expandedRowKeys:r.d_expandedRowKeys,expandedRowGroups:t.expandedRowGroups,editingRows:t.editingRows,editingRowKeys:r.d_editingRowKeys,templates:t.$slots,responsiveLayout:t.responsiveLayout,isVirtualScrollerDisabled:!0,onRowgroupToggle:o.toggleRowGroup,onRowClick:e[9]||(e[9]=function(T){return o.onRowClick(T)}),onRowDblclick:e[10]||(e[10]=function(T){return o.onRowDblClick(T)}),onRowRightclick:e[11]||(e[11]=function(T){return o.onRowRightClick(T)}),onRowTouchend:o.onRowTouchEnd,onRowKeydown:o.onRowKeyDown,onRowMousedown:o.onRowMouseDown,onRowDragstart:e[12]||(e[12]=function(T){return o.onRowDragStart(T)}),onRowDragover:e[13]||(e[13]=function(T){return o.onRowDragOver(T)}),onRowDragleave:e[14]||(e[14]=function(T){return o.onRowDragLeave(T)}),onRowDragend:e[15]||(e[15]=function(T){return o.onRowDragEnd(T)}),onRowDrop:e[16]||(e[16]=function(T){return o.onRowDrop(T)}),onRowToggle:e[17]||(e[17]=function(T){return o.toggleRow(T)}),onRadioChange:e[18]||(e[18]=function(T){return o.toggleRowWithRadio(T)}),onCheckboxChange:e[19]||(e[19]=function(T){return o.toggleRowWithCheckbox(T)}),onCellEditInit:e[20]||(e[20]=function(T){return o.onCellEditInit(T)}),onCellEditComplete:e[21]||(e[21]=function(T){return o.onCellEditComplete(T)}),onCellEditCancel:e[22]||(e[22]=function(T){return o.onCellEditCancel(T)}),onRowEditInit:e[23]||(e[23]=function(T){return o.onRowEditInit(T)}),onRowEditSave:e[24]||(e[24]=function(T){return o.onRowEditSave(T)}),onRowEditCancel:e[25]||(e[25]=function(T){return o.onRowEditCancel(T)}),editingMeta:r.d_editingMeta,onEditingMetaChange:o.onEditingMetaChange,unstyled:t.unstyled,pt:t.pt},null,8,["value","columns","first","dataKey","selection","selectionKeys","selectionMode","contextMenu","contextMenuSelection","rowGroupMode","groupRowsBy","expandableRowGroups","rowClass","rowStyle","editMode","compareSelectionBy","scrollable","expandedRowIcon","collapsedRowIcon","expandedRows","expandedRowKeys","expandedRowGroups","editingRows","editingRowKeys","templates","responsiveLayout","onRowgroupToggle","onRowTouchend","onRowKeydown","onRowMousedown","editingMeta","onEditingMetaChange","unstyled","pt"])):Jt("",!0),Lt(p,{ref:"bodyRef",value:o.dataToRender(w.rows),class:ri(w.styleClass),columns:w.columns,empty:o.empty,first:r.d_first,dataKey:t.dataKey,selection:t.selection,selectionKeys:r.d_selectionKeys,selectionMode:t.selectionMode,contextMenu:t.contextMenu,contextMenuSelection:t.contextMenuSelection,rowGroupMode:t.rowGroupMode,groupRowsBy:t.groupRowsBy,expandableRowGroups:t.expandableRowGroups,rowClass:t.rowClass,rowStyle:t.rowStyle,editMode:t.editMode,compareSelectionBy:t.compareSelectionBy,scrollable:t.scrollable,expandedRowIcon:t.expandedRowIcon,collapsedRowIcon:t.collapsedRowIcon,expandedRows:t.expandedRows,expandedRowKeys:r.d_expandedRowKeys,expandedRowGroups:t.expandedRowGroups,editingRows:t.editingRows,editingRowKeys:r.d_editingRowKeys,templates:t.$slots,responsiveLayout:t.responsiveLayout,virtualScrollerContentProps:w,isVirtualScrollerDisabled:o.virtualScrollerDisabled,onRowgroupToggle:o.toggleRowGroup,onRowClick:e[26]||(e[26]=function(T){return o.onRowClick(T)}),onRowDblclick:e[27]||(e[27]=function(T){return o.onRowDblClick(T)}),onRowRightclick:e[28]||(e[28]=function(T){return o.onRowRightClick(T)}),onRowTouchend:o.onRowTouchEnd,onRowKeydown:function(I){return o.onRowKeyDown(I,w)},onRowMousedown:o.onRowMouseDown,onRowDragstart:e[29]||(e[29]=function(T){return o.onRowDragStart(T)}),onRowDragover:e[30]||(e[30]=function(T){return o.onRowDragOver(T)}),onRowDragleave:e[31]||(e[31]=function(T){return o.onRowDragLeave(T)}),onRowDragend:e[32]||(e[32]=function(T){return o.onRowDragEnd(T)}),onRowDrop:e[33]||(e[33]=function(T){return o.onRowDrop(T)}),onRowToggle:e[34]||(e[34]=function(T){return o.toggleRow(T)}),onRadioChange:e[35]||(e[35]=function(T){return o.toggleRowWithRadio(T)}),onCheckboxChange:e[36]||(e[36]=function(T){return o.toggleRowWithCheckbox(T)}),onCellEditInit:e[37]||(e[37]=function(T){return o.onCellEditInit(T)}),onCellEditComplete:e[38]||(e[38]=function(T){return o.onCellEditComplete(T)}),onCellEditCancel:e[39]||(e[39]=function(T){return o.onCellEditCancel(T)}),onRowEditInit:e[40]||(e[40]=function(T){return o.onRowEditInit(T)}),onRowEditSave:e[41]||(e[41]=function(T){return o.onRowEditSave(T)}),onRowEditCancel:e[42]||(e[42]=function(T){return o.onRowEditCancel(T)}),editingMeta:r.d_editingMeta,onEditingMetaChange:o.onEditingMetaChange,unstyled:t.unstyled,pt:t.pt},null,8,["value","class","columns","empty","first","dataKey","selection","selectionKeys","selectionMode","contextMenu","contextMenuSelection","rowGroupMode","groupRowsBy","expandableRowGroups","rowClass","rowStyle","editMode","compareSelectionBy","scrollable","expandedRowIcon","collapsedRowIcon","expandedRows","expandedRowKeys","expandedRowGroups","editingRows","editingRowKeys","templates","responsiveLayout","virtualScrollerContentProps","isVirtualScrollerDisabled","onRowgroupToggle","onRowTouchend","onRowKeydown","onRowMousedown","editingMeta","onEditingMetaChange","unstyled","pt"]),o.hasSpacerStyle(w.spacerStyle)?(le(),Ue("tbody",Le({key:1,class:t.cx("virtualScrollerSpacer"),style:{height:"calc(".concat(w.spacerStyle.height," - ").concat(w.rows.length*w.itemSize,"px)")}},t.ptm("virtualScrollerSpacer")),null,16)):Jt("",!0),Lt(y,{columnGroup:o.footerColumnGroup,columns:w.columns,pt:t.pt},null,8,["columnGroup","columns","pt"])],16)]}),_:1},16,["items","columns","style","scrollHeight","disabled","pt"])],16),t.$slots.footer?(le(),Ue("div",Le({key:3,class:t.cx("footer")},t.ptm("footer")),[Xn(t.$slots,"footer")],16)):Jt("",!0),o.paginatorBottom?(le(),Rt(s,{key:4,rows:r.d_rows,first:r.d_first,totalRecords:o.totalRecordsLength,pageLinkSize:t.pageLinkSize,template:t.paginatorTemplate,rowsPerPageOptions:t.rowsPerPageOptions,currentPageReportTemplate:t.currentPageReportTemplate,class:ri(t.cx("paginator")),onPage:e[43]||(e[43]=function(w){return o.onPage(w)}),alwaysShow:t.alwaysShowPaginator,unstyled:t.unstyled,pt:t.ptm("paginator")},Pm({_:2},[t.$slots.paginatorstart?{name:"start",fn:Cn(function(){return[Xn(t.$slots,"paginatorstart")]}),key:"0"}:void 0,t.$slots.paginatorend?{name:"end",fn:Cn(function(){return[Xn(t.$slots,"paginatorend")]}),key:"1"}:void 0,t.$slots.paginatorfirstpagelinkicon?{name:"firstpagelinkicon",fn:Cn(function(w){return[Xn(t.$slots,"paginatorfirstpagelinkicon",{class:ri(w.class)})]}),key:"2"}:void 0,t.$slots.paginatorprevpagelinkicon?{name:"prevpagelinkicon",fn:Cn(function(w){return[Xn(t.$slots,"paginatorprevpagelinkicon",{class:ri(w.class)})]}),key:"3"}:void 0,t.$slots.paginatornextpagelinkicon?{name:"nextpagelinkicon",fn:Cn(function(w){return[Xn(t.$slots,"paginatornextpagelinkicon",{class:ri(w.class)})]}),key:"4"}:void 0,t.$slots.paginatorlastpagelinkicon?{name:"lastpagelinkicon",fn:Cn(function(w){return[Xn(t.$slots,"paginatorlastpagelinkicon",{class:ri(w.class)})]}),key:"5"}:void 0,t.$slots.paginatorjumptopagedropdownicon?{name:"jumptopagedropdownicon",fn:Cn(function(w){return[Xn(t.$slots,"paginatorjumptopagedropdownicon",{class:ri(w.class)})]}),key:"6"}:void 0,t.$slots.paginatorrowsperpagedropdownicon?{name:"rowsperpagedropdownicon",fn:Cn(function(w){return[Xn(t.$slots,"paginatorrowsperpagedropdownicon",{class:ri(w.class)})]}),key:"7"}:void 0]),1032,["rows","first","totalRecords","pageLinkSize","template","rowsPerPageOptions","currentPageReportTemplate","class","alwaysShow","unstyled","pt"])):Jt("",!0),Qe("div",Le({ref:"resizeHelper",class:t.cx("resizeHelper"),style:{display:"none"}},t.ptm("resizeHelper")),null,16),t.reorderableColumns?(le(),Ue("span",Le({key:5,ref:"reorderIndicatorUp",class:t.cx("reorderIndicatorUp"),style:{position:"absolute",display:"none"}},t.ptm("reorderIndicatorUp")),[(le(),Rt(Zn(t.$slots.reorderindicatorupicon||"ArrowDownIcon")))],16)):Jt("",!0),t.reorderableColumns?(le(),Ue("span",Le({key:6,ref:"reorderIndicatorDown",class:t.cx("reorderIndicatorDown"),style:{position:"absolute",display:"none"}},t.ptm("reorderIndicatorDown")),[(le(),Rt(Zn(t.$slots.reorderindicatordownicon||"ArrowUpIcon")))],16)):Jt("",!0)],16)}hj.render=iAe;var rAe={},oAe={name:"BaseColumn",extends:Ni,props:{columnKey:{type:null,default:null},field:{type:[String,Function],default:null},sortField:{type:[String,Function],default:null},filterField:{type:[String,Function],default:null},dataType:{type:String,default:"text"},sortable:{type:Boolean,default:!1},header:{type:null,default:null},footer:{type:null,default:null},style:{type:null,default:null},class:{type:String,default:null},headerStyle:{type:null,default:null},headerClass:{type:String,default:null},bodyStyle:{type:null,default:null},bodyClass:{type:String,default:null},footerStyle:{type:null,default:null},footerClass:{type:String,default:null},showFilterMenu:{type:Boolean,default:!0},showFilterOperator:{type:Boolean,default:!0},showClearButton:{type:Boolean,default:!0},showApplyButton:{type:Boolean,default:!0},showFilterMatchModes:{type:Boolean,default:!0},showAddButton:{type:Boolean,default:!0},filterMatchModeOptions:{type:Array,default:null},maxConstraints:{type:Number,default:2},excludeGlobalFilter:{type:Boolean,default:!1},filterHeaderClass:{type:String,default:null},filterHeaderStyle:{type:null,default:null},filterMenuClass:{type:String,default:null},filterMenuStyle:{type:null,default:null},selectionMode:{type:String,default:null},expander:{type:Boolean,default:!1},colspan:{type:Number,default:null},rowspan:{type:Number,default:null},rowReorder:{type:Boolean,default:!1},rowReorderIcon:{type:String,default:void 0},reorderableColumn:{type:Boolean,default:!0},rowEditor:{type:Boolean,default:!1},frozen:{type:Boolean,default:!1},alignFrozen:{type:String,default:"left"},exportable:{type:Boolean,default:!0},exportHeader:{type:String,default:null},exportFooter:{type:String,default:null},filterMatchMode:{type:String,default:null},hidden:{type:Boolean,default:!1}},style:rAe,provide:function(){return{$parentInstance:this}}},Hy={name:"Column",extends:oAe,render:function(){return null}};const sAe=t=>(lu("data-v-2b1a3706"),t=t(),cu(),t),aAe={id:"fireTableList",class:"fireList"},lAe={class:"headerTable"},cAe={class:"p-input-icon-left"},uAe=sAe(()=>Qe("i",{class:"pi pi-search"},null,-1)),hAe=pr({__name:"FireTable",props:{options:{},mapParams:{},templateID:{},preselected:{}},setup(t){const e=$n(),n=Xa(),i=t;i.preselected!==""&&Ys(()=>{e.value=i.options.filter(s=>s.id==i.preselected)[0]}),$r(U2);const r=$n(i.options),o=$n({global:{value:null,matchMode:vr.CONTAINS},name:{operator:za.AND,constraints:[{value:null,matchMode:vr.STARTS_WITH}]},year:{operator:za.AND,constraints:[{value:null,matchMode:vr.EQUALS}]},acres:{operator:za.AND,constraints:[{value:null,matchMode:vr.EQUALS}]},perimeters:{operator:za.AND,constraints:[{value:null,matchMode:vr.EQUALS}]}}),l=()=>{o.value={global:{value:null,matchMode:vr.CONTAINS},name:{operator:za.AND,constraints:[{value:null,matchMode:vr.STARTS_WITH}]},year:{operator:za.AND,constraints:[{value:null,matchMode:vr.EQUALS}]},acres:{operator:za.AND,constraints:[{value:null,matchMode:vr.EQUALS}]},perimeters:{operator:za.AND,constraints:[{value:null,matchMode:vr.EQUALS}]}}};return Ri(e,()=>{console.log("table_selection changed",e.value),console.log(e.value);let s=Ea().fire[i.templateID];e.value&&s&&s.id!=e.value.id&&(Ea().validFire[i.templateID]=!1),Ys(()=>{if(Ea().fire[i.templateID]=e.value,e.value.year!=null&&(e.value.year!==-1&&(Ea().validFire[i.templateID]=!0),i.templateID==Wd.mapIdentifier.Overview)){console.log("DO I EXIST AS AN ICON YET");let d=n.deckGLMapState.findIndex(p=>p._metaData.mType=="overview"&&p._metaData.active==!0);n.deckGLMapState[d]._data.selectedFire.data=[JSON.parse(e.value.centroid)]}}),n.$patch(d=>{})}),(s,d)=>(le(),Ue("div",aAe,[Lt(Yt(hj),{value:r.value,"row-hover":!0,scrollable:!0,"scroll-height":"flex",selection:e.value,"onUpdate:selection":d[2]||(d[2]=p=>e.value=p),"sort-field":"perimeters",filters:o.value,"onUpdate:filters":d[3]||(d[3]=p=>o.value=p),"sort-order":-1,"state-storage":"session","state-key":`state-key-${i.mapParams.mapID}`,rows:8,paginator:!0,class:"p-datatable-sm","data-key":"id","filter-display":"menu","paginator-template":"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink","global-filter-fields":["name","year","acres","perimeters"]},{header:Cn(()=>[Qe("div",lAe,[Lt(Yt(zh),{type:"button",icon:"pi pi-filter-slash",label:"Clear",class:"p-button-outlined",onClick:d[0]||(d[0]=p=>l())}),Qe("span",cAe,[uAe,Lt(Yt(Hw),{modelValue:o.value.global.value,"onUpdate:modelValue":d[1]||(d[1]=p=>o.value.global.value=p),placeholder:"Keyword Search"},null,8,["modelValue"])])])]),empty:Cn(()=>[vo(" No fires found. ")]),loading:Cn(()=>[vo(" Loading fire data. Please wait. ")]),default:Cn(()=>[Lt(Yt(Hy),{"selection-mode":"single"}),Lt(Yt(Hy),{field:"name",header:"Name"},{body:Cn(({data:p})=>[vo(ki(p.name),1)]),filter:Cn(({filterModel:p})=>[Lt(Yt(Hw),{modelValue:p.value,"onUpdate:modelValue":y=>p.value=y,type:"text",class:"p-column-filter",placeholder:"Search by name"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),Lt(Yt(Hy),{"filter-field":"year","data-type":"numeric",header:"Year"},{body:Cn(({data:p})=>[vo(ki(p.year),1)]),filter:Cn(({filterModel:p})=>[Lt(Yt(G0),{modelValue:p.value,"onUpdate:modelValue":y=>p.value=y},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),Lt(Yt(Hy),{"filter-field":"acres","data-type":"numeric",header:"Acres"},{body:Cn(({data:p})=>[vo(ki(p.acres),1)]),filter:Cn(({filterModel:p})=>[Lt(Yt(G0),{modelValue:p.value,"onUpdate:modelValue":y=>p.value=y,mode:"decimal","min-fraction-digits":2},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),Lt(Yt(Hy),{"filter-field":"perimeters","data-type":"numeric",header:"Perimeters"},{body:Cn(({data:p})=>[vo(ki(p.perimeters),1)]),filter:Cn(({filterModel:p})=>[Lt(Yt(G0),{modelValue:p.value,"onUpdate:modelValue":y=>p.value=y},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["value","selection","filters","state-key"])]))}});const dAe=po(hAe,[["__scopeId","data-v-2b1a3706"]]);const fAe={name:"RoundSlider",props:{},data:()=>({selectedYear:null,optionsYear:[],numOfFireRange:[],arcesRange:[],margin:{left:30,right:30,top:20,bottom:15}}),computed:{},watch:{selected(t,e){console.log(this.selected)},numOfFireRange(t,e){this.onChange()},arcesRange(t,e){this.onChange()}},created(){console.log("fire names",this.$store.getters["selectfire/getWildFirePrettifyList"]())},mounted(){this.init(),this.draw()},methods:{init(){this.drawBackGroundBar(),this.initWildfireYearSlider(),this.initPerimeterSlider(),this.initAcreageBurnedSlider()},drawBackGroundBar(){const t=this.initArc();Nh("#slider-svg").append("g").attr("transform","translate(80, 10)").append("path").attr("class","arc").attr("d",t).attr("fill","green")},initArc(){return j1e().innerRadius(102).outerRadius(98).startAngle(0).endAngle(180).cornerRadius(10)},initDrag(){S6().on("start",dragMinStarted).on("dragged",minDragged).on("end",dragMinEnded),S6().on("start",dragMaxStarted).on("dragged",maxDragged).on("end",dragMaxEnded)},dragMinStarted(t,e,n){sourceEvent.stopPropagation(),Nh(this).classed("dragging",!0)},minDragged(t,e,n){d_from_origin=Math.sqrt(Math.pow(n.x,2)+Math.pow(n.y,2))},initWildfireYearSlider(){const t=this.$store.getters["selectfire/getWildFiresYearRange"]();console.log("YEAR DATA",t),this.optionsYear=["All Years"].concat(t),this.selectedYear=this.optionsYear[0]},initPerimeterSlider(){const t=this.$store.getters["selectfire/getWildFirePerimeters"]();console.log("Perimeter",Va(t))},initAcreageBurnedSlider(){const t=this.$store.getters["selectfire/getWildFiresAcresRange"]();console.log("Acreage",x3(".2s")(Va(t)[1]))},draw(){}}},pAe={id:"slider-svg",class:"sliderSVG"};function mAe(t,e,n,i,r,o){return le(),Ue("svg",pAe)}const gAe=po(fAe,[["render",mAe],["__scopeId","data-v-64ce6013"]]);const yAe={name:"Slider",props:{},data:()=>({selectedYear:null,yearRange:[],arcesRange:[],perimeterRange:[],years:[],acres:[],perimeters:[]}),computed:{...yx(Ea,["getWildFiresYearRange"]),...yx(Ea,["getWildFiresAcresRange"]),...yx(Ea,["getWildFirePerimeters"])},watch:{},created(){},mounted(){this.init()},methods:{init(){let t=this.getWildFiresYearRange;t[t.length-1]===-1&&t.pop(),this.yearRange=Va(t),this.years=this.yearRange;const e=this.getWildFirePerimeters;this.perimeterRange=Va(e),this.perimeters=this.perimeterRange;const n=this.getWildFiresAcresRange;this.arcesRange=Va(n),this.acres=this.arcesRange},changeYear(){this.$emit("updateYearRange",this.years)},changeAcres(){this.$emit("updateAcreageRange",this.acres)},changePerimeters(){this.$emit("updatePerimeterRange",this.perimeters)},selectYearRange(){},selectAcresRange(){},selectPerimeterRange(){}}},rg=t=>(lu("data-v-efe5d9e0"),t=t(),cu(),t),vAe={class:"selections"},_Ae={class:"selectionInput"},bAe=rg(()=>Qe("p",null,"Year:  ",-1)),xAe=rg(()=>Qe("p",null," - ",-1)),wAe={class:"selectionInput"},EAe=rg(()=>Qe("p",null,"Acres: ",-1)),TAe=rg(()=>Qe("p",null," - ",-1)),SAe={class:"selectionInput"},CAe=rg(()=>Qe("p",null,"Perimeter: ",-1)),AAe=rg(()=>Qe("p",null," - ",-1));function PAe(t,e,n,i,r,o){const l=Gn("a-input-number"),s=Gn("a-slider");return le(),Ue("div",vAe,[Qe("div",_Ae,[bAe,Lt(l,{value:t.years[0],"onUpdate:value":e[0]||(e[0]=d=>t.years[0]=d),min:t.yearRange[0],max:t.yearRange[1],size:"small",onPressEnter:o.changeYear},null,8,["value","min","max","onPressEnter"]),xAe,Lt(l,{value:t.years[1],"onUpdate:value":e[1]||(e[1]=d=>t.years[1]=d),min:t.yearRange[0],max:t.yearRange[1],size:"small",onPressEnter:o.changeYear},null,8,["value","min","max","onPressEnter"])]),Lt(s,{id:"selectionSlider1",value:t.years,"onUpdate:value":e[2]||(e[2]=d=>t.years=d),range:"",min:t.yearRange[0],max:t.yearRange[1],onAfterChange:o.changeYear},null,8,["value","min","max","onAfterChange"]),Qe("div",wAe,[EAe,Lt(l,{value:t.acres[0],"onUpdate:value":e[3]||(e[3]=d=>t.acres[0]=d),min:t.arcesRange[0],max:t.arcesRange[1],size:"small",onPressEnter:o.changeAcres},null,8,["value","min","max","onPressEnter"]),TAe,Lt(l,{value:t.acres[1],"onUpdate:value":e[4]||(e[4]=d=>t.acres[1]=d),min:t.arcesRange[0],max:t.arcesRange[1],size:"small",onPressEnter:o.changeAcres},null,8,["value","min","max","onPressEnter"])]),Lt(s,{id:"selectionSlider2",value:t.acres,"onUpdate:value":e[5]||(e[5]=d=>t.acres=d),range:"",min:t.arcesRange[0],max:t.arcesRange[1],onAfterChange:o.changeAcres},null,8,["value","min","max","onAfterChange"]),Qe("div",SAe,[CAe,Lt(l,{value:t.perimeters[0],"onUpdate:value":e[6]||(e[6]=d=>t.perimeters[0]=d),min:t.perimeterRange[0],max:t.perimeterRange[1],size:"small",onPressEnter:o.changePerimeters},null,8,["value","min","max","onPressEnter"]),AAe,Lt(l,{value:t.perimeters[1],"onUpdate:value":e[7]||(e[7]=d=>t.perimeters[1]=d),min:t.perimeterRange[0],max:t.perimeterRange[1],size:"small",onPressEnter:o.changePerimeters},null,8,["value","min","max","onPressEnter"])]),Lt(s,{id:"selectionSlider3",value:t.perimeters,"onUpdate:value":e[8]||(e[8]=d=>t.perimeters=d),range:"",min:t.perimeterRange[0],max:t.perimeterRange[1],onAfterChange:o.changePerimeters},null,8,["value","min","max","onAfterChange"])])}const IAe=po(yAe,[["render",PAe],["__scopeId","data-v-efe5d9e0"]]);const MAe={name:"SelectFire",components:{Tooltip:m_,FireTable:dAe,RoundSlider:gAe,Slider:IAe},props:{mapParams:Object,templateID:String,preselected:String},data:()=>({description:"Select a fire to explore.",selected:null,options:[],fire_list_name:[],selectedYear:"All Years",yearRange:[],perimeterRange:[],arcesRange:[],fireName:""}),computed:{...yx(Ea,["getWildFirePrettifyList"])},watch:{selected(t,e){}},created(){this.fire_list_name=this.getWildFirePrettifyList,this.options=this.fire_list_name,console.log("THE OPTIONS",this.options)},mounted(){},methods:{updateYearRange(t){this.yearRange=t,this.updateOptionsAndSelected("year")},updateAcreageRange(t){this.arcesRange=t,this.updateOptionsAndSelected("acres")},updatePerimeterRange(t){this.perimeterRange=t,this.updateOptionsAndSelected("perimeters")},searchByFireName(){if(this.fireName===""){console.log("empty fire name"),this.options=this.fire_list_name;return}this.fireName=this.fireName.replace(this.fireName[0],this.fireName[0].toUpperCase());let t=this.fire_list_name.find(e=>e.name===this.fireName);t!==void 0?this.options=[t]:this.options=[],this.options.length==0?this.selected=="":this.selected=this.options[0]},updateOptionsAndSelected(t){console.log(this.selectedYear,this.arcesRange,this.perimeterRange),this.options=this.fire_list_name,this.yearRange.length===2&&(this.options=this.options.filter(e=>e.year>=this.yearRange[0]&&e.year<=this.yearRange[1])),this.arcesRange.length===2&&(this.options=this.options.filter(e=>e.acres>=this.arcesRange[0]&&e.acres<=this.arcesRange[1])),this.perimeterRange.length===2&&(this.options=this.options.filter(e=>e.perimeters>=this.perimeterRange[0]&&e.perimeters<=this.perimeterRange[1])),this.options.length===0?this.selected:this.selected=this.options[0]},resetAll(){this.options=this.fire_list_name,this.$refs.child.init()},clearSearchKey(){this.fireName.length===0&&this.updateOptionsAndSelected()}}},RAe=t=>(lu("data-v-025a4d36"),t=t(),cu(),t),LAe={id:"selectFire-container",class:"selectFire-container"},OAe={id:"label",class:"label-container"},DAe=RAe(()=>Qe("p",{class:"labelStyle"}," Wildfire Selection ",-1)),kAe={id:"display-area"};function FAe(t,e,n,i,r,o){const l=Gn("Tooltip"),s=Gn("FireTable");return le(),Ue("div",LAe,[Qe("div",OAe,[DAe,Lt(l,{direction:"topRight",description:t.description},null,8,["description"])]),Qe("div",kAe,[Lt(s,{class:"table",options:t.options,"map-params":n.mapParams,"template-i-d":n.templateID,preselected:n.preselected},null,8,["options","map-params","template-i-d","preselected"])])])}const BAe=po(MAe,[["render",FAe],["__scopeId","data-v-025a4d36"]]),zAe={class:"h-full flex flex-col"},NAe={class:"flex-grow"},UAe=pr({__name:"TabMenu",props:{mapParams:{},templateID:{},preselected:{type:Function}},setup(t){const e=t,n=Ea(),i=$n([{label:"Select a Fire",icon:"pi pi-fw pi-list"},{label:"Select Map Layers",icon:"pi pi-fw pi-map"}]),r=$n(!0),o=$n(!1);function l(s){s.index==0?(r.value=!0,o.value=!1):s.index==1&&(o.value=!0,r.value=!1)}return(s,d)=>(le(),Ue("div",zAe,[Lt(Yt(P3),{model:i.value,class:"h-auto",onTabChange:d[0]||(d[0]=p=>l(p))},null,8,["model"]),Qe("div",NAe,[r.value&&Yt(n).isFireListReady?(le(),Rt(BAe,{key:0,"map-params":e.mapParams,"template-i-d":e.templateID,preselected:e.preselected},null,8,["map-params","template-i-d","preselected"])):Jt("",!0),o.value?(le(),Rt(pV,{key:1,"map-params":e.mapParams},null,8,["map-params"])):Jt("",!0)])]))}}),u8=[{type:"checkbox",id:"perimeter",title:"Perimeter Layer",info:"The perimeter layer visualizes the progession of the selected wildfire as animation over time. We provide the option to smooth each perimeter to highlight general trends.",options:[{name:"Smooth Perimeters",emitVal:"Perimeter_Smooth",default:!0}]},{type:"checkbox-dropdown",id:"wind",title:"Wind Layer",info:"The wind layer visualizes wind data in the area of the selected wildfire. We provide two options to visualize this data.",options:[{type:"dropdown",name:"Particle Advection Color Setting",emitVal:"Wind_Particle_Colors",values:["No Color","Temperature","Humidity"],default:"No Color"}],scales:[{variable:"Temperature in Celsius",colorRange:[[59,76,192],[98,130,234],[141,176,254],[184,208,249],[221,221,221],[245,196,173],[244,154,123],[222,96,77],[180,4,38]],labels:["20","25","30","35","40"]},{variable:"Humidity in Percentage",colorRange:[[59,76,192],[98,130,234],[141,176,254],[184,208,249],[221,221,221],[245,196,173],[244,154,123],[222,96,77],[180,4,38]],labels:["0","25","50","75","100"]}]},{type:"text",id:"satellite",title:"Satellite Layer",info:"Satellite data provides the confidence of a fire and the power of the fire at each geographic location. (as logitude/latitude)",scales:[{variable:"Satellite-measured power of fire",colorRange:[[255,245,240],[254,225,211],[253,196,173],[252,161,131],[251,125,94],[246,87,63],[227,50,41],[197,25,28],[159,14,21],[108,1,14]],labels:["Weakest","","","","Strongest"]}]},{type:"text",id:"fbfm",title:"Fire Behavior Fuel Model (FBFM) Layer",info:"Scott and Burgans (2005) FBFM model identified 40 fuel model based on their terrain qualities. More info <a href='https://iftdss.firenet.gov/firenetHelp/help/pageHelp/content/10-mapstudio/files/fbfmsummaries.htm'>here</a>."},{type:"text",id:"Roads",title:"Roads Layer",info:"Roads around the selected wildfire is rendered as a line."},{type:"text",id:"Aspect",title:"Aspect Layer",info:"Aspect is the direction of the slope of the land?"},{type:"text",id:"Elevation",title:"Elevation Layer",info:"Elevation is the height of the land above sea level?"}],VAe={headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json"}},jAe=E2("overviewMap",{state:()=>({overviewClusters:[],isClusterDataReady:!1,error:""}),getters:{getOverviewClusters(){return this.overviewClusters}},actions:{async fetchOverviewClusters(){this.isClusterDataReady=!1;try{const t=await ps.post("http://infovis.cs.ucdavis.edu/wildfire/api/firedash/perimeters/aggregate",{state:"CA"},VAe);this.overviewClusters=t.data,this.isClusterDataReady=!0,console.log("Clusters Are Ready")}catch(t){throw console.log("error :>> ",t),t.message}}}});class $Ae{constructor(e){q(this,"index",void 0),q(this,"isVisible",void 0),q(this,"isSelected",void 0),q(this,"parent",void 0),q(this,"children",void 0),q(this,"content",void 0),q(this,"state",void 0),q(this,"layers",void 0),q(this,"id",void 0),q(this,"zoom",void 0),q(this,"userData",void 0),q(this,"boundingBox",void 0),q(this,"_abortController",void 0),q(this,"_loader",void 0),q(this,"_loaderId",void 0),q(this,"_isLoaded",void 0),q(this,"_isCancelled",void 0),q(this,"_needsReload",void 0),q(this,"_bbox",void 0),this.index=e,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get bbox(){return this._bbox}set bbox(e){this._bbox||(this._bbox=e,"west"in e?this.boundingBox=[[e.west,e.south],[e.east,e.north]]:this.boundingBox=[[e.left,e.top],[e.right,e.bottom]])}get data(){return this.isLoading&&this._loader?this._loader.then(()=>this.data):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return!!this._loader&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){const e=this.content?this.content.byteLength:0;return Number.isFinite(e)||console.error("byteLength not defined in tile data"),e}async _loadData({getData:e,requestScheduler:n,onLoad:i,onError:r}){const{index:o,id:l,bbox:s,userData:d,zoom:p}=this,y=this._loaderId;this._abortController=new AbortController;const{signal:v}=this._abortController,w=await n.scheduleRequest(this,L=>L.isSelected?1:-1);if(!w){this._isCancelled=!0;return}if(this._isCancelled){w.done();return}let T=null,I;try{T=await e({index:o,id:l,bbox:s,userData:d,zoom:p,signal:v})}catch(L){I=L||!0}finally{w.done()}if(y===this._loaderId){if(this._loader=void 0,this.content=T,this._isCancelled&&!T){this._isLoaded=!1;return}this._isLoaded=!0,this._isCancelled=!1,I?r(I,this):i(this)}}loadData(e){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(e),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){var e;this.isLoaded||(this._isCancelled=!0,(e=this._abortController)===null||e===void 0||e.abort())}}const gs={OUTSIDE:-1,INTERSECTING:0,INSIDE:1},h8=new Mn,GAe=new Mn;class K3{constructor(e=[0,0,0],n=[0,0,0],i){q(this,"center",void 0),q(this,"halfDiagonal",void 0),q(this,"minimum",void 0),q(this,"maximum",void 0),i=i||h8.copy(e).add(n).scale(.5),this.center=new Mn(i),this.halfDiagonal=new Mn(n).subtract(this.center),this.minimum=new Mn(e),this.maximum=new Mn(n)}clone(){return new K3(this.minimum,this.maximum,this.center)}equals(e){return this===e||!!e&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}transform(e){return this.center.transformAsPoint(e),this.halfDiagonal.transform(e),this.minimum.transform(e),this.maximum.transform(e),this}intersectPlane(e){const{halfDiagonal:n}=this,i=GAe.from(e.normal),r=n.x*Math.abs(i.x)+n.y*Math.abs(i.y)+n.z*Math.abs(i.z),o=this.center.dot(i)+e.distance;return o-r>0?gs.INSIDE:o+r<0?gs.OUTSIDE:gs.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=h8.from(e).subtract(this.center),{halfDiagonal:i}=this;let r=0,o;return o=Math.abs(n.x)-i.x,o>0&&(r+=o*o),o=Math.abs(n.y)-i.y,o>0&&(r+=o*o),o=Math.abs(n.z)-i.z,o>0&&(r+=o*o),r}}const Wy=new Mn,d8=new Mn;class X3{constructor(e=[0,0,0],n=0){q(this,"center",void 0),q(this,"radius",void 0),this.radius=-0,this.center=new Mn,this.fromCenterRadius(e,n)}fromCenterRadius(e,n){return this.center.from(e),this.radius=n,this}fromCornerPoints(e,n){return n=Wy.from(n),this.center=new Mn().from(e).add(n).scale(.5),this.radius=this.center.distance(n),this}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new X3(this.center,this.radius)}union(e){const n=this.center,i=this.radius,r=e.center,o=e.radius,l=Wy.copy(r).subtract(n),s=l.magnitude();if(i>=s+o)return this.clone();if(o>=s+i)return e.clone();const d=(i+s+o)*.5;return d8.copy(l).scale((-i+d)/s).add(n),this.center.copy(d8),this.radius=d,this}expand(e){const i=Wy.from(e).subtract(this.center).magnitude();return i>this.radius&&(this.radius=i),this}transform(e){this.center.transform(e);const n=Qae(Wy,e);return this.radius=Math.max(n[0],Math.max(n[1],n[2]))*this.radius,this}distanceSquaredTo(e){const n=this.distanceTo(e);return n*n}distanceTo(e){const i=Wy.from(e).subtract(this.center);return Math.max(0,i.len()-this.radius)}intersectPlane(e){const n=this.center,i=this.radius,o=e.normal.dot(n)+e.distance;return o<-i?gs.OUTSIDE:o<i?gs.INTERSECTING:gs.INSIDE}}const HAe=new Mn,WAe=new Mn,sx=new Mn,ax=new Mn,lx=new Mn,KAe=new Mn,XAe=new Mn,Fc={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8};class Z3{constructor(e=[0,0,0],n=[0,0,0,0,0,0,0,0,0]){q(this,"center",void 0),q(this,"halfAxes",void 0),this.center=new Mn().from(e),this.halfAxes=new ns(n)}get halfSize(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2);return[new Mn(e).len(),new Mn(n).len(),new Mn(i).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2),r=new Mn(e).normalize(),o=new Mn(n).normalize(),l=new Mn(i).normalize();return new S5().fromMatrix3(new ns([...r,...o,...l]))}fromCenterHalfSizeQuaternion(e,n,i){const r=new S5(i),o=new ns().fromQuaternion(r);return o[0]=o[0]*n[0],o[1]=o[1]*n[0],o[2]=o[2]*n[0],o[3]=o[3]*n[1],o[4]=o[4]*n[1],o[5]=o[5]*n[1],o[6]=o[6]*n[2],o[7]=o[7]*n[2],o[8]=o[8]*n[2],this.center=new Mn().from(e),this.halfAxes=o,this}clone(){return new Z3(this.center,this.halfAxes)}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new X3){const n=this.halfAxes,i=n.getColumn(0,sx),r=n.getColumn(1,ax),o=n.getColumn(2,lx),l=HAe.copy(i).add(r).add(o);return e.center.copy(this.center),e.radius=l.magnitude(),e}intersectPlane(e){const n=this.center,i=e.normal,r=this.halfAxes,o=i.x,l=i.y,s=i.z,d=Math.abs(o*r[Fc.COLUMN0ROW0]+l*r[Fc.COLUMN0ROW1]+s*r[Fc.COLUMN0ROW2])+Math.abs(o*r[Fc.COLUMN1ROW0]+l*r[Fc.COLUMN1ROW1]+s*r[Fc.COLUMN1ROW2])+Math.abs(o*r[Fc.COLUMN2ROW0]+l*r[Fc.COLUMN2ROW1]+s*r[Fc.COLUMN2ROW2]),p=i.dot(n)+e.distance;return p<=-d?gs.OUTSIDE:p>=d?gs.INSIDE:gs.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=WAe.from(e).subtract(this.center),i=this.halfAxes,r=i.getColumn(0,sx),o=i.getColumn(1,ax),l=i.getColumn(2,lx),s=r.magnitude(),d=o.magnitude(),p=l.magnitude();r.normalize(),o.normalize(),l.normalize();let y=0,v;return v=Math.abs(n.dot(r))-s,v>0&&(y+=v*v),v=Math.abs(n.dot(o))-d,v>0&&(y+=v*v),v=Math.abs(n.dot(l))-p,v>0&&(y+=v*v),y}computePlaneDistances(e,n,i=[-0,-0]){let r=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;const l=this.center,s=this.halfAxes,d=s.getColumn(0,sx),p=s.getColumn(1,ax),y=s.getColumn(2,lx),v=KAe.copy(d).add(p).add(y).add(l),w=XAe.copy(v).subtract(e);let T=n.dot(w);return r=Math.min(T,r),o=Math.max(T,o),v.copy(l).add(d).add(p).subtract(y),w.copy(v).subtract(e),T=n.dot(w),r=Math.min(T,r),o=Math.max(T,o),v.copy(l).add(d).subtract(p).add(y),w.copy(v).subtract(e),T=n.dot(w),r=Math.min(T,r),o=Math.max(T,o),v.copy(l).add(d).subtract(p).subtract(y),w.copy(v).subtract(e),T=n.dot(w),r=Math.min(T,r),o=Math.max(T,o),l.copy(v).subtract(d).add(p).add(y),w.copy(v).subtract(e),T=n.dot(w),r=Math.min(T,r),o=Math.max(T,o),l.copy(v).subtract(d).add(p).subtract(y),w.copy(v).subtract(e),T=n.dot(w),r=Math.min(T,r),o=Math.max(T,o),l.copy(v).subtract(d).subtract(p).add(y),w.copy(v).subtract(e),T=n.dot(w),r=Math.min(T,r),o=Math.max(T,o),l.copy(v).subtract(d).subtract(p).subtract(y),w.copy(v).subtract(e),T=n.dot(w),r=Math.min(T,r),o=Math.max(T,o),i[0]=r,i[1]=o,i}transform(e){this.center.transformAsPoint(e);const n=this.halfAxes.getColumn(0,sx);n.transformAsPoint(e);const i=this.halfAxes.getColumn(1,ax);i.transformAsPoint(e);const r=this.halfAxes.getColumn(2,lx);return r.transformAsPoint(e),this.halfAxes=new ns([...n,...i,...r]),this}getTransform(){throw new Error("not implemented")}}const f8=new Mn,p8=new Mn;class Km{constructor(e=[0,0,1],n=0){q(this,"normal",void 0),q(this,"distance",void 0),this.normal=new Mn,this.distance=-0,this.fromNormalDistance(e,n)}fromNormalDistance(e,n){return bv(Number.isFinite(n)),this.normal.from(e).normalize(),this.distance=n,this}fromPointNormal(e,n){e=f8.from(e),this.normal.from(n).normalize();const i=-this.normal.dot(e);return this.distance=i,this}fromCoefficients(e,n,i,r){return this.normal.set(e,n,i),bv(qc(this.normal.len(),1)),this.distance=r,this}clone(){return new Km(this.normal,this.distance)}equals(e){return qc(this.distance,e.distance)&&qc(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const n=p8.copy(this.normal).transformAsVector(e).normalize(),i=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(i,n)}projectPointOntoPlane(e,n=[0,0,0]){e=f8.from(e);const i=this.getPointDistance(e),r=p8.copy(this.normal).scale(i);return e.subtract(r).to(n)}}const m8=[new Mn([1,0,0]),new Mn([0,1,0]),new Mn([0,0,1])],g8=new Mn,ZAe=new Mn;new Km(new Mn(1,0,0),0);class Hc{constructor(e=[]){q(this,"planes",void 0),this.planes=e}fromBoundingSphere(e){this.planes.length=2*m8.length;const n=e.center,i=e.radius;let r=0;for(const o of m8){let l=this.planes[r],s=this.planes[r+1];l||(l=this.planes[r]=new Km),s||(s=this.planes[r+1]=new Km);const d=g8.copy(o).scale(-i).add(n);-o.dot(d),l.fromPointNormal(d,o);const p=g8.copy(o).scale(i).add(n),y=ZAe.copy(o).negate();-y.dot(p),s.fromPointNormal(p,y),r+=2}return this}computeVisibility(e){let n=gs.INSIDE;for(const i of this.planes)switch(e.intersectPlane(i)){case gs.OUTSIDE:return gs.OUTSIDE;case gs.INTERSECTING:n=gs.INTERSECTING;break}return n}computeVisibilityWithPlaneMask(e,n){if(bv(Number.isFinite(n),"parentPlaneMask is required."),n===Hc.MASK_OUTSIDE||n===Hc.MASK_INSIDE)return n;let i=Hc.MASK_INSIDE;const r=this.planes;for(let o=0;o<this.planes.length;++o){const l=o<31?1<<o:0;if(o<31&&!(n&l))continue;const s=r[o],d=e.intersectPlane(s);if(d===gs.OUTSIDE)return Hc.MASK_OUTSIDE;d===gs.INTERSECTING&&(i|=l)}return i}}q(Hc,"MASK_OUTSIDE",4294967295);q(Hc,"MASK_INSIDE",0);q(Hc,"MASK_INDETERMINATE",2147483647);new Mn;new Mn;new Mn;new Mn;new Mn;new Mn;new Mn;new Mn;new Mn;new Mn;new Mn;new Mn;new Mn;new Mn;new Mn;new Mn;new Mn;const Jl=new ns,qAe=new ns,YAe=new ns,cx=new ns,y8=new ns;function JAe(t,e={}){const n=l7.EPSILON20,i=10;let r=0,o=0;const l=qAe,s=YAe;l.identity(),s.copy(t);const d=n*QAe(s);for(;o<i&&ePe(s)>d;)tPe(s,cx),y8.copy(cx).transpose(),s.multiplyRight(cx),s.multiplyLeft(y8),l.multiplyRight(cx),++r>2&&(++o,r=0);return e.unitary=l.toTarget(e.unitary),e.diagonal=s.toTarget(e.diagonal),e}function QAe(t){let e=0;for(let n=0;n<9;++n){const i=t[n];e+=i*i}return Math.sqrt(e)}const rI=[1,0,0],oI=[2,2,1];function ePe(t){let e=0;for(let n=0;n<3;++n){const i=t[Jl.getElementIndex(oI[n],rI[n])];e+=2*i*i}return Math.sqrt(e)}function tPe(t,e){const n=l7.EPSILON15;let i=0,r=1;for(let p=0;p<3;++p){const y=Math.abs(t[Jl.getElementIndex(oI[p],rI[p])]);y>i&&(r=p,i=y)}const o=rI[r],l=oI[r];let s=1,d=0;if(Math.abs(t[Jl.getElementIndex(l,o)])>n){const p=t[Jl.getElementIndex(l,l)],y=t[Jl.getElementIndex(o,o)],v=t[Jl.getElementIndex(l,o)],w=(p-y)/2/v;let T;w<0?T=-1/(-w+Math.sqrt(1+w*w)):T=1/(w+Math.sqrt(1+w*w)),s=1/Math.sqrt(1+T*T),d=T*s}return ns.IDENTITY.to(e),e[Jl.getElementIndex(o,o)]=e[Jl.getElementIndex(l,l)]=s,e[Jl.getElementIndex(l,o)]=d,e[Jl.getElementIndex(o,l)]=-d,e}const lh=new Mn,nPe=new Mn,iPe=new Mn,rPe=new Mn,oPe=new Mn,sPe=new ns,aPe={diagonal:new ns,unitary:new ns};function lPe(t,e=new Z3){if(!t||t.length===0)return e.halfAxes=new ns([0,0,0,0,0,0,0,0,0]),e.center=new Mn,e;const n=t.length,i=new Mn(0,0,0);for(const J of t)i.add(J);const r=1/n;i.multiplyByScalar(r);let o=0,l=0,s=0,d=0,p=0,y=0;for(const J of t){const Ce=lh.copy(J).subtract(i);o+=Ce.x*Ce.x,l+=Ce.x*Ce.y,s+=Ce.x*Ce.z,d+=Ce.y*Ce.y,p+=Ce.y*Ce.z,y+=Ce.z*Ce.z}o*=r,l*=r,s*=r,d*=r,p*=r,y*=r;const v=sPe;v[0]=o,v[1]=l,v[2]=s,v[3]=l,v[4]=d,v[5]=p,v[6]=s,v[7]=p,v[8]=y;const{unitary:w}=JAe(v,aPe),T=e.halfAxes.copy(w);let I=T.getColumn(0,iPe),L=T.getColumn(1,rPe),k=T.getColumn(2,oPe),F=-Number.MAX_VALUE,B=-Number.MAX_VALUE,G=-Number.MAX_VALUE,U=Number.MAX_VALUE,ee=Number.MAX_VALUE,ne=Number.MAX_VALUE;for(const J of t)lh.copy(J),F=Math.max(lh.dot(I),F),B=Math.max(lh.dot(L),B),G=Math.max(lh.dot(k),G),U=Math.min(lh.dot(I),U),ee=Math.min(lh.dot(L),ee),ne=Math.min(lh.dot(k),ne);I=I.multiplyByScalar(.5*(U+F)),L=L.multiplyByScalar(.5*(ee+B)),k=k.multiplyByScalar(.5*(ne+G)),e.center.copy(I).add(L).add(k);const ye=nPe.set(F-U,B-ee,G-ne).multiplyByScalar(.5),fe=new ns([ye[0],0,0,0,ye[1],0,0,0,ye[2]]);return e.halfAxes.multiplyRight(fe),e}const nm=512,v8=3,dj=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],fj=dj.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),cPe=fj.concat([[.25,.5],[.75,.5]]);class im{constructor(e,n,i){q(this,"x",void 0),q(this,"y",void 0),q(this,"z",void 0),q(this,"childVisible",void 0),q(this,"selected",void 0),q(this,"_children",void 0),this.x=e,this.y=n,this.z=i}get children(){if(!this._children){const e=this.x*2,n=this.y*2,i=this.z+1;this._children=[new im(e,n,i),new im(e,n+1,i),new im(e+1,n,i),new im(e+1,n+1,i)]}return this._children}update(e){const{viewport:n,cullingVolume:i,elevationBounds:r,minZ:o,maxZ:l,bounds:s,offset:d,project:p}=e,y=this.getBoundingVolume(r,d,p);if(s&&!this.insideBounds(s)||i.computeVisibility(y)<0)return!1;if(!this.childVisible){let{z:w}=this;if(w<l&&w>=o){const T=y.distanceTo(n.cameraPosition)*n.scale/n.height;w+=Math.floor(Math.log2(T))}if(w>=l)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const w of this.children)w.update(e);return!0}getSelected(e=[]){if(this.selected&&e.push(this),this._children)for(const n of this._children)n.getSelected(e);return e}insideBounds([e,n,i,r]){const o=Math.pow(2,this.z),l=nm/o;return this.x*l<i&&this.y*l<r&&(this.x+1)*l>e&&(this.y+1)*l>n}getBoundingVolume(e,n,i){if(i){const d=this.z<1?cPe:this.z<2?fj:dj,p=[];for(const y of d){const v=aI(this.x+y[0],this.y+y[1],this.z);v[2]=e[0],p.push(i(v)),e[0]!==e[1]&&(v[2]=e[1],p.push(i(v)))}return lPe(p)}const r=Math.pow(2,this.z),o=nm/r,l=this.x*o+n*nm,s=nm-(this.y+1)*o;return new K3([l,s,e[0]],[l+o,s+o,e[1]])}}function uPe(t,e,n,i){const r=t instanceof pfe&&t.resolution?t.projectPosition:null,o=Object.values(t.getFrustumPlanes()).map(({normal:T,distance:I})=>new Km(T.clone().negate(),I)),l=new Hc(o),s=t.distanceScales.unitsPerMeter[2],d=n&&n[0]*s||0,p=n&&n[1]*s||0,y=t instanceof Bh&&t.pitch<=60?e:0;if(i){const[T,I,L,k]=i,F=Fh([T,k]),B=Fh([L,I]);i=[F[0],nm-F[1],B[0],nm-B[1]]}const v=new im(0,0,0),w={viewport:t,project:r,cullingVolume:l,elevationBounds:[d,p],minZ:y,maxZ:e,bounds:i,offset:0};if(v.update(w),t instanceof Bh&&t.subViewports&&t.subViewports.length>1){for(w.offset=-1;v.update(w)&&!(--w.offset<-v8););for(w.offset=1;v.update(w)&&!(++w.offset>v8););}return v.getSelected()}const ou=512,hPe=[-1/0,-1/0,1/0,1/0],dPe={type:"object",value:null,validate:(t,e)=>e.optional&&t===null||typeof t=="string"||Array.isArray(t)&&t.every(n=>typeof n=="string"),equal:(t,e)=>{if(t===e)return!0;if(!Array.isArray(t)||!Array.isArray(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}};function pj(t,e){const n=[e.transformAsPoint([t[0],t[1]]),e.transformAsPoint([t[2],t[1]]),e.transformAsPoint([t[0],t[3]]),e.transformAsPoint([t[2],t[3]])];return[Math.min(...n.map(r=>r[0])),Math.min(...n.map(r=>r[1])),Math.max(...n.map(r=>r[0])),Math.max(...n.map(r=>r[1]))]}function fPe(t){return Math.abs(t.split("").reduce((e,n)=>(e<<5)-e+n.charCodeAt(0)|0,0))}function pPe(t,e){if(!t||!t.length)return null;const{index:n,id:i}=e;if(Array.isArray(t)){const o=fPe(i)%t.length;t=t[o]}let r=t;for(const o of Object.keys(n)){const l=new RegExp("{".concat(o,"}"),"g");r=r.replace(l,String(n[o]))}return Number.isInteger(n.y)&&Number.isInteger(n.z)&&(r=r.replace(/\{-y\}/g,String(Math.pow(2,n.z)-n.y-1))),r}function mPe(t,e,n){let i;if(e&&e.length===2){const[r,o]=e,l=t.getBounds({z:r}),s=t.getBounds({z:o});i=[Math.min(l[0],s[0]),Math.min(l[1],s[1]),Math.max(l[2],s[2]),Math.max(l[3],s[3])]}else i=t.getBounds();return t.isGeospatial?[Math.max(i[0],n[0]),Math.max(i[1],n[1]),Math.min(i[2],n[2]),Math.min(i[3],n[3])]:[Math.max(Math.min(i[0],n[2]),n[0]),Math.max(Math.min(i[1],n[3]),n[1]),Math.min(Math.max(i[2],n[0]),n[2]),Math.min(Math.max(i[3],n[1]),n[3])]}function gPe({viewport:t,z:e=0,cullRect:n}){return(t.subViewports||[t]).map(r=>sI(r,e,n))}function sI(t,e,n){if(!Array.isArray(e)){const o=n.x-t.x,l=n.y-t.y,{width:s,height:d}=n,p={targetZ:e},y=t.unproject([o,l],p),v=t.unproject([o+s,l],p),w=t.unproject([o,l+d],p),T=t.unproject([o+s,l+d],p);return[Math.min(y[0],v[0],w[0],T[0]),Math.min(y[1],v[1],w[1],T[1]),Math.max(y[0],v[0],w[0],T[0]),Math.max(y[1],v[1],w[1],T[1])]}const i=sI(t,e[0],n),r=sI(t,e[1],n);return[Math.min(i[0],r[0]),Math.min(i[1],r[1]),Math.max(i[2],r[2]),Math.max(i[3],r[3])]}function yPe(t,e,n){return n?pj(t,n).map(r=>r*e/ou):t.map(i=>i*e/ou)}function q3(t,e){return Math.pow(2,t)*ou/e}function aI(t,e,n){const i=q3(n,ou),r=t/i*360-180,o=Math.PI-2*Math.PI*e/i,l=180/Math.PI*Math.atan(.5*(Math.exp(o)-Math.exp(-o)));return[r,l]}function _8(t,e,n,i){const r=q3(n,i);return[t/r*ou,e/r*ou]}function vPe(t,e,n,i,r=ou){if(t.isGeospatial){const[p,y]=aI(e,n,i),[v,w]=aI(e+1,n+1,i);return{west:p,north:y,east:v,south:w}}const[o,l]=_8(e,n,i,r),[s,d]=_8(e+1,n+1,i,r);return{left:o,top:l,right:s,bottom:d}}function _Pe(t,e,n,i,r){const o=mPe(t,null,i),l=q3(e,n),[s,d,p,y]=yPe(o,l,r),v=[];for(let w=Math.floor(s);w<p;w++)for(let T=Math.floor(d);T<y;T++)v.push({x:w,y:T,z:e});return v}function bPe({viewport:t,maxZoom:e,minZoom:n,zRange:i,extent:r,tileSize:o=ou,modelMatrix:l,modelMatrixInverse:s,zoomOffset:d=0}){let p=t.isGeospatial?Math.round(t.zoom+Math.log2(ou/o))+d:Math.ceil(t.zoom)+d;if(typeof n=="number"&&Number.isFinite(n)&&p<n){if(!r)return[];p=n}typeof e=="number"&&Number.isFinite(e)&&p>e&&(p=e);let y=r;return l&&s&&r&&!t.isGeospatial&&(y=pj(r,l)),t.isGeospatial?uPe(t,p,i,r):_Pe(t,p,o,y||hPe,s)}function xPe(t){let e={},n;return i=>{for(const r in i)if(!wPe(i[r],e[r])){n=t(i),e=i;break}return n}}function wPe(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}return!1}const b8=1,eE=2,EPe="never",TPe="no-overlap",Y3="best-available",SPe=5,CPe={[Y3]:IPe,[TPe]:MPe,[EPe]:()=>{}},APe={extent:null,tileSize:512,maxZoom:null,minZoom:null,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:6,zoomOffset:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{}};class PPe{constructor(e){q(this,"opts",void 0),q(this,"_requestScheduler",void 0),q(this,"_cache",void 0),q(this,"_dirty",void 0),q(this,"_tiles",void 0),q(this,"_cacheByteSize",void 0),q(this,"_viewport",void 0),q(this,"_zRange",void 0),q(this,"_selectedTiles",void 0),q(this,"_frameNumber",void 0),q(this,"_modelMatrix",void 0),q(this,"_modelMatrixInverse",void 0),q(this,"_maxZoom",void 0),q(this,"_minZoom",void 0),q(this,"onTileLoad",void 0),q(this,"_getCullBounds",xPe(gPe)),this.opts={...APe,...e},this.onTileLoad=n=>{var i,r;(i=(r=this.opts).onTileLoad)===null||i===void 0||i.call(r,n),this.opts.maxCacheByteSize&&(this._cacheByteSize+=n.byteLength,this._resizeCache())},this._requestScheduler=new wte({maxRequests:e.maxRequests,throttleRequests:!!(e.maxRequests&&e.maxRequests>0)}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new Js,this._modelMatrixInverse=new Js,this.setOptions(e)}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return this._selectedTiles!==null&&this._selectedTiles.every(e=>e.isLoaded)}get needsReload(){return this._selectedTiles!==null&&this._selectedTiles.some(e=>e.needsReload)}setOptions(e){Object.assign(this.opts,e),Number.isFinite(e.maxZoom)&&(this._maxZoom=Math.floor(e.maxZoom)),Number.isFinite(e.minZoom)&&(this._minZoom=Math.ceil(e.minZoom))}finalize(){for(const e of this._cache.values())e.isLoading&&e.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(const e of this._cache.keys()){const n=this._cache.get(e);!this._selectedTiles||!this._selectedTiles.includes(n)?this._cache.delete(e):n.setNeedsReload()}}update(e,{zRange:n,modelMatrix:i}={}){const r=new Js(i),o=!r.equals(this._modelMatrix);if(!this._viewport||!e.equals(this._viewport)||!qc(this._zRange,n)||o){o&&(this._modelMatrixInverse=r.clone().invert(),this._modelMatrix=r),this._viewport=e,this._zRange=n;const s=this.getTileIndices({viewport:e,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:n,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=s.map(d=>this._getTile(d,!0)),this._dirty&&this._rebuildTree()}else this.needsReload&&(this._selectedTiles=this._selectedTiles.map(s=>this._getTile(s.index,!0)));const l=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),l&&this._frameNumber++,this._frameNumber}isTileVisible(e,n){if(!e.isVisible)return!1;if(n&&this._viewport){const i=this._getCullBounds({viewport:this._viewport,z:this._zRange,cullRect:n}),{bbox:r}=e;for(const[o,l,s,d]of i){let p;if("west"in r)p=r.west<s&&r.east>o&&r.south<d&&r.north>l;else{const y=Math.min(r.top,r.bottom),v=Math.max(r.top,r.bottom);p=r.left<s&&r.right>o&&y<d&&v>l}if(p)return!0}return!1}return!0}getTileIndices({viewport:e,maxZoom:n,minZoom:i,zRange:r,modelMatrix:o,modelMatrixInverse:l}){const{tileSize:s,extent:d,zoomOffset:p}=this.opts;return bPe({viewport:e,maxZoom:n,minZoom:i,zRange:r,tileSize:s,extent:d,modelMatrix:o,modelMatrixInverse:l,zoomOffset:p})}getTileId(e){return"".concat(e.x,"-").concat(e.y,"-").concat(e.z)}getTileZoom(e){return e.z}getTileMetadata(e){const{tileSize:n}=this.opts;return{bbox:vPe(this._viewport,e.x,e.y,e.z,n)}}getParentIndex(e){const n=Math.floor(e.x/2),i=Math.floor(e.y/2),r=e.z-1;return{x:n,y:i,z:r}}updateTileStates(){const e=this.opts.refinementStrategy||Y3,n=new Array(this._cache.size);let i=0;for(const r of this._cache.values())n[i++]=r.isVisible,r.isSelected=!1,r.isVisible=!1;for(const r of this._selectedTiles)r.isSelected=!0,r.isVisible=!0;(typeof e=="function"?e:CPe[e])(Array.from(this._cache.values())),i=0;for(const r of this._cache.values())if(n[i++]!==r.isVisible)return!0;return!1}_pruneRequests(){const{maxRequests:e=0}=this.opts,n=[];let i=0;for(const r of this._cache.values())r.isLoading&&(i++,!r.isSelected&&!r.isVisible&&n.push(r));for(;e>0&&i>e&&n.length>0;)n.shift().abort(),i--}_rebuildTree(){const{_cache:e}=this;for(const n of e.values())n.parent=null,n.children&&(n.children.length=0);for(const n of e.values()){const i=this._getNearestAncestor(n);n.parent=i,i!=null&&i.children&&i.children.push(n)}}_resizeCache(){const{_cache:e,opts:n}=this,i=n.maxCacheSize||(n.maxCacheByteSize?1/0:SPe*this.selectedTiles.length),r=n.maxCacheByteSize||1/0;if(e.size>i||this._cacheByteSize>r){for(const[d,p]of e){if(!p.isVisible&&!p.isSelected){var l,s;this._cacheByteSize-=n.maxCacheByteSize?p.byteLength:0,e.delete(d),(l=(s=this.opts).onTileUnload)===null||l===void 0||l.call(s,p)}if(e.size<=i&&this._cacheByteSize<=r)break}this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((d,p)=>d.zoom-p.zoom),this._dirty=!1)}_getTile(e,n){const i=this.getTileId(e);let r=this._cache.get(i),o=!1;return!r&&n?(r=new $Ae(e),Object.assign(r,this.getTileMetadata(r.index)),Object.assign(r,{id:i,zoom:this.getTileZoom(r.index)}),o=!0,this._cache.set(i,r),this._dirty=!0):r&&r.needsReload&&(o=!0),r&&o&&r.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),r}_getNearestAncestor(e){const{_minZoom:n=0}=this;let i=e.index;for(;this.getTileZoom(i)>n;){i=this.getParentIndex(i);const r=this._getTile(i);if(r)return r}return null}}function IPe(t){for(const e of t)e.state=0;for(const e of t)e.isSelected&&!mj(e)&&J3(e);for(const e of t)e.isVisible=!!(e.state&eE)}function MPe(t){for(const n of t)n.state=0;for(const n of t)n.isSelected&&mj(n);const e=Array.from(t).sort((n,i)=>n.zoom-i.zoom);for(const n of e)if(n.isVisible=!!(n.state&eE),n.children&&(n.isVisible||n.state&b8))for(const i of n.children)i.state=b8;else n.isSelected&&J3(n)}function mj(t){let e=t;for(;e;){if(e.isLoaded||e.content)return e.state|=eE,!0;e=e.parent}return!1}function J3(t){for(const e of t.children)e.isLoaded||e.content?e.state|=eE:J3(e)}const RPe={TilesetClass:PPe,data:{type:"data",value:[]},dataComparator:dPe.equal,renderSubLayers:{type:"function",value:t=>new Gc(t)},getTileData:{type:"function",optional:!0,value:null},onViewportLoad:{type:"function",optional:!0,value:null},onTileLoad:{type:"function",value:t=>{}},onTileUnload:{type:"function",value:t=>{}},onTileError:{type:"function",value:t=>console.error(t)},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:Y3,zRange:null,maxRequests:6,zoomOffset:0};class Q3 extends C_{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){var e,n;(e=this.state)===null||e===void 0||(n=e.tileset)===null||n===void 0||n.finalize()}get isLoaded(){var e,n,i;return(e=this.state)===null||e===void 0||(n=e.tileset)===null||n===void 0||(i=n.selectedTiles)===null||i===void 0?void 0:i.every(r=>r.isLoaded&&r.layers&&r.layers.every(o=>o.isLoaded))}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({changeFlags:e}){let{tileset:n}=this.state;const i=e.propsOrDataChanged||e.updateTriggersChanged,r=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getTileData);n?i&&(n.setOptions(this._getTilesetOptions()),r?n.reloadAll():this.state.tileset.tiles.forEach(o=>{o.layers=null})):(n=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:n})),this._updateTileset()}_getTilesetOptions(){const{tileSize:e,maxCacheSize:n,maxCacheByteSize:i,refinementStrategy:r,extent:o,maxZoom:l,minZoom:s,maxRequests:d,zoomOffset:p}=this.props;return{maxCacheSize:n,maxCacheByteSize:i,maxZoom:l,minZoom:s,tileSize:e,refinementStrategy:r,extent:o,maxRequests:d,zoomOffset:p,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){const{tileset:e}=this.state,{zRange:n,modelMatrix:i}=this.props,r=e.update(this.context.viewport,{zRange:n,modelMatrix:i}),{isLoaded:o}=e,l=this.state.isLoaded!==o,s=this.state.frameNumber!==r;o&&(l||s)&&this._onViewportLoad(),s&&this.setState({frameNumber:r}),this.state.isLoaded=o}_onViewportLoad(){const{tileset:e}=this.state,{onViewportLoad:n}=this.props;n&&n(e.selectedTiles)}_onTileLoad(e){this.props.onTileLoad(e),e.layers=null,this.setNeedsUpdate()}_onTileError(e,n){this.props.onTileError(e),n.layers=null,this.setNeedsUpdate()}_onTileUnload(e){this.props.onTileUnload(e)}getTileData(e){const{data:n,getTileData:i,fetch:r}=this.props,{signal:o}=e;return e.url=typeof n=="string"||Array.isArray(n)?pPe(n,e):null,i?i(e):r&&e.url?r(e.url,{propName:"data",layer:this,signal:o}):null}renderSubLayers(e){return this.props.renderSubLayers(e)}getSubLayerPropsByTile(e){return null}getPickingInfo({info:e,sourceLayer:n}){const i=n.props.tile;return e.picked&&(e.tile=i),e.sourceTile=i,e}_updateAutoHighlight(e){const n=e.sourceTile;if(n&&n.layers)for(const i of n.layers)i.updateAutoHighlight(e)}renderLayers(){return this.state.tileset.tiles.map(e=>{const n=this.getSubLayerPropsByTile(e);if(!(!e.isLoaded&&!e.content))if(e.layers)n&&e.layers[0]&&Object.keys(n).some(i=>e.layers[0].props[i]!==n[i])&&(e.layers=e.layers.map(i=>i.clone(n)));else{const i=this.renderSubLayers({...this.props,...this.getSubLayerProps({id:e.id,updateTriggers:this.props.updateTriggers}),data:e.content,_offset:0,tile:e});e.layers=F2(i,Boolean).map(r=>r.clone({tile:e,...n}))}return e.layers})}filterSubLayer({layer:e,cullRect:n}){const{tile:i}=e.props;return this.state.tileset.isTileVisible(i,n)}}q(Q3,"defaultProps",RPe);q(Q3,"layerName","TileLayer");class LPe{constructor(e,n,i){e!==void 0&&(this.url=e),this.attrs=n,this.name=i}validateError(e){return!0}create(e,n=.3){return new Q3({layerName:this.name,id:this.name,loadOptions:{imagebitmap:{imageOrientation:"flipY"}},getTileData:r=>{let{x:o,y:l,z:s}=r.index;const p=this.url+`/${s}/${o}/${l}.png`;return mv(p)},onTileError:r=>this.validateError(r),minZoom:0,maxZoom:19,tileSize:256,opacity:n,visible:e,transparentColor:[0,0,0,150],renderSubLayers:r=>{const{bbox:{west:o,south:l,east:s,north:d}}=r.tile;return new O3(r,{data:null,image:r.data,bounds:[o,l,s,d]})},...this.attrs})}}function gj(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function OPe(t){return t.length===1&&(t=DPe(t)),{left:function(e,n,i,r){for(i==null&&(i=0),r==null&&(r=e.length);i<r;){var o=i+r>>>1;t(e[o],n)<0?i=o+1:r=o}return i},right:function(e,n,i,r){for(i==null&&(i=0),r==null&&(r=e.length);i<r;){var o=i+r>>>1;t(e[o],n)>0?r=o:i=o+1}return i}}}function DPe(t){return function(e,n){return gj(t(e),n)}}var kPe=OPe(gj),FPe=kPe.right,lI=Math.sqrt(50),cI=Math.sqrt(10),uI=Math.sqrt(2);function BPe(t,e,n){var i,r=-1,o,l,s;if(e=+e,t=+t,n=+n,t===e&&n>0)return[t];if((i=e<t)&&(o=t,t=e,e=o),(s=Hx(t,e,n))===0||!isFinite(s))return[];if(s>0)for(t=Math.ceil(t/s),e=Math.floor(e/s),l=new Array(o=Math.ceil(e-t+1));++r<o;)l[r]=(t+r)*s;else for(t=Math.floor(t*s),e=Math.ceil(e*s),l=new Array(o=Math.ceil(t-e+1));++r<o;)l[r]=(t-r)/s;return i&&l.reverse(),l}function Hx(t,e,n){var i=(e-t)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),o=i/Math.pow(10,r);return r>=0?(o>=lI?10:o>=cI?5:o>=uI?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(o>=lI?10:o>=cI?5:o>=uI?2:1)}function zPe(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),o=i/r;return o>=lI?r*=10:o>=cI?r*=5:o>=uI&&(r*=2),e<t?-r:r}var NPe={value:function(){}};function yj(){for(var t=0,e=arguments.length,n={},i;t<e;++t){if(!(i=arguments[t]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new Wx(n)}function Wx(t){this._=t}function UPe(t,e){return t.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}Wx.prototype=yj.prototype={constructor:Wx,on:function(t,e){var n=this._,i=UPe(t+"",n),r,o=-1,l=i.length;if(arguments.length<2){for(;++o<l;)if((r=(t=i[o]).type)&&(r=VPe(n[r],t.name)))return r;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<l;)if(r=(t=i[o]).type)n[r]=x8(n[r],t.name,e);else if(e==null)for(r in n)n[r]=x8(n[r],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Wx(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,o;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],i=0,r=o.length;i<r;++i)o[i].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,o=i.length;r<o;++r)i[r].value.apply(e,n)}};function VPe(t,e){for(var n=0,i=t.length,r;n<i;++n)if((r=t[n]).name===e)return r.value}function x8(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=NPe,t=t.slice(0,i).concat(t.slice(i+1));break}return n!=null&&t.push({name:e,value:n}),t}var hI="http://www.w3.org/1999/xhtml";const w8={svg:"http://www.w3.org/2000/svg",xhtml:hI,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function tE(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),w8.hasOwnProperty(e)?{space:w8[e],local:t}:t}function jPe(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===hI&&e.documentElement.namespaceURI===hI?e.createElement(t):e.createElementNS(n,t)}}function $Pe(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function vj(t){var e=tE(t);return(e.local?$Pe:jPe)(e)}function GPe(){}function eR(t){return t==null?GPe:function(){return this.querySelector(t)}}function HPe(t){typeof t!="function"&&(t=eR(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o=e[r],l=o.length,s=i[r]=new Array(l),d,p,y=0;y<l;++y)(d=o[y])&&(p=t.call(d,d.__data__,y,o))&&("__data__"in d&&(p.__data__=d.__data__),s[y]=p);return new Ml(i,this._parents)}function WPe(){return[]}function _j(t){return t==null?WPe:function(){return this.querySelectorAll(t)}}function KPe(t){typeof t!="function"&&(t=_j(t));for(var e=this._groups,n=e.length,i=[],r=[],o=0;o<n;++o)for(var l=e[o],s=l.length,d,p=0;p<s;++p)(d=l[p])&&(i.push(t.call(d,d.__data__,p,l)),r.push(d));return new Ml(i,r)}function bj(t){return function(){return this.matches(t)}}function XPe(t){typeof t!="function"&&(t=bj(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o=e[r],l=o.length,s=i[r]=[],d,p=0;p<l;++p)(d=o[p])&&t.call(d,d.__data__,p,o)&&s.push(d);return new Ml(i,this._parents)}function xj(t){return new Array(t.length)}function ZPe(){return new Ml(this._enter||this._groups.map(xj),this._parents)}function Ww(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Ww.prototype={constructor:Ww,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function qPe(t){return function(){return t}}var E8="$";function YPe(t,e,n,i,r,o){for(var l=0,s,d=e.length,p=o.length;l<p;++l)(s=e[l])?(s.__data__=o[l],i[l]=s):n[l]=new Ww(t,o[l]);for(;l<d;++l)(s=e[l])&&(r[l]=s)}function JPe(t,e,n,i,r,o,l){var s,d,p={},y=e.length,v=o.length,w=new Array(y),T;for(s=0;s<y;++s)(d=e[s])&&(w[s]=T=E8+l.call(d,d.__data__,s,e),T in p?r[s]=d:p[T]=d);for(s=0;s<v;++s)T=E8+l.call(t,o[s],s,o),(d=p[T])?(i[s]=d,d.__data__=o[s],p[T]=null):n[s]=new Ww(t,o[s]);for(s=0;s<y;++s)(d=e[s])&&p[w[s]]===d&&(r[s]=d)}function QPe(t,e){if(!t)return T=new Array(this.size()),p=-1,this.each(function(ne){T[++p]=ne}),T;var n=e?JPe:YPe,i=this._parents,r=this._groups;typeof t!="function"&&(t=qPe(t));for(var o=r.length,l=new Array(o),s=new Array(o),d=new Array(o),p=0;p<o;++p){var y=i[p],v=r[p],w=v.length,T=t.call(y,y&&y.__data__,p,i),I=T.length,L=s[p]=new Array(I),k=l[p]=new Array(I),F=d[p]=new Array(w);n(y,v,L,k,F,T,e);for(var B=0,G=0,U,ee;B<I;++B)if(U=L[B]){for(B>=G&&(G=B+1);!(ee=k[G])&&++G<I;);U._next=ee||null}}return l=new Ml(l,i),l._enter=s,l._exit=d,l}function eIe(){return new Ml(this._exit||this._groups.map(xj),this._parents)}function tIe(t,e,n){var i=this.enter(),r=this,o=this.exit();return i=typeof t=="function"?t(i):i.append(t+""),e!=null&&(r=e(r)),n==null?o.remove():n(o),i&&r?i.merge(r).order():r}function nIe(t){for(var e=this._groups,n=t._groups,i=e.length,r=n.length,o=Math.min(i,r),l=new Array(i),s=0;s<o;++s)for(var d=e[s],p=n[s],y=d.length,v=l[s]=new Array(y),w,T=0;T<y;++T)(w=d[T]||p[T])&&(v[T]=w);for(;s<i;++s)l[s]=e[s];return new Ml(l,this._parents)}function iIe(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i=t[e],r=i.length-1,o=i[r],l;--r>=0;)(l=i[r])&&(o&&l.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(l,o),o=l);return this}function rIe(t){t||(t=oIe);function e(v,w){return v&&w?t(v.__data__,w.__data__):!v-!w}for(var n=this._groups,i=n.length,r=new Array(i),o=0;o<i;++o){for(var l=n[o],s=l.length,d=r[o]=new Array(s),p,y=0;y<s;++y)(p=l[y])&&(d[y]=p);d.sort(e)}return new Ml(r,this._parents).order()}function oIe(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function sIe(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function aIe(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t}function lIe(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,o=i.length;r<o;++r){var l=i[r];if(l)return l}return null}function cIe(){var t=0;return this.each(function(){++t}),t}function uIe(){return!this.node()}function hIe(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r=e[n],o=0,l=r.length,s;o<l;++o)(s=r[o])&&t.call(s,s.__data__,o,r);return this}function dIe(t){return function(){this.removeAttribute(t)}}function fIe(t){return function(){this.removeAttributeNS(t.space,t.local)}}function pIe(t,e){return function(){this.setAttribute(t,e)}}function mIe(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function gIe(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function yIe(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function vIe(t,e){var n=tE(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((e==null?n.local?fIe:dIe:typeof e=="function"?n.local?yIe:gIe:n.local?mIe:pIe)(n,e))}function wj(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function _Ie(t){return function(){this.style.removeProperty(t)}}function bIe(t,e,n){return function(){this.style.setProperty(t,e,n)}}function xIe(t,e,n){return function(){var i=e.apply(this,arguments);i==null?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function wIe(t,e,n){return arguments.length>1?this.each((e==null?_Ie:typeof e=="function"?xIe:bIe)(t,e,n??"")):Xm(this.node(),t)}function Xm(t,e){return t.style.getPropertyValue(e)||wj(t).getComputedStyle(t,null).getPropertyValue(e)}function EIe(t){return function(){delete this[t]}}function TIe(t,e){return function(){this[t]=e}}function SIe(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function CIe(t,e){return arguments.length>1?this.each((e==null?EIe:typeof e=="function"?SIe:TIe)(t,e)):this.node()[t]}function Ej(t){return t.trim().split(/^|\s+/)}function tR(t){return t.classList||new Tj(t)}function Tj(t){this._node=t,this._names=Ej(t.getAttribute("class")||"")}Tj.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Sj(t,e){for(var n=tR(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function Cj(t,e){for(var n=tR(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function AIe(t){return function(){Sj(this,t)}}function PIe(t){return function(){Cj(this,t)}}function IIe(t,e){return function(){(e.apply(this,arguments)?Sj:Cj)(this,t)}}function MIe(t,e){var n=Ej(t+"");if(arguments.length<2){for(var i=tR(this.node()),r=-1,o=n.length;++r<o;)if(!i.contains(n[r]))return!1;return!0}return this.each((typeof e=="function"?IIe:e?AIe:PIe)(n,e))}function RIe(){this.textContent=""}function LIe(t){return function(){this.textContent=t}}function OIe(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function DIe(t){return arguments.length?this.each(t==null?RIe:(typeof t=="function"?OIe:LIe)(t)):this.node().textContent}function kIe(){this.innerHTML=""}function FIe(t){return function(){this.innerHTML=t}}function BIe(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function zIe(t){return arguments.length?this.each(t==null?kIe:(typeof t=="function"?BIe:FIe)(t)):this.node().innerHTML}function NIe(){this.nextSibling&&this.parentNode.appendChild(this)}function UIe(){return this.each(NIe)}function VIe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function jIe(){return this.each(VIe)}function $Ie(t){var e=typeof t=="function"?t:vj(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function GIe(){return null}function HIe(t,e){var n=typeof t=="function"?t:vj(t),i=e==null?GIe:typeof e=="function"?e:eR(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function WIe(){var t=this.parentNode;t&&t.removeChild(this)}function KIe(){return this.each(WIe)}function XIe(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ZIe(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function qIe(t){return this.select(t?ZIe:XIe)}function YIe(t){return arguments.length?this.property("__data__",t):this.node().__data__}var Aj={};if(typeof document<"u"){var JIe=document.documentElement;"onmouseenter"in JIe||(Aj={mouseenter:"mouseover",mouseleave:"mouseout"})}function QIe(t,e,n){return t=Pj(t,e,n),function(i){var r=i.relatedTarget;(!r||r!==this&&!(r.compareDocumentPosition(this)&8))&&t.call(this,i)}}function Pj(t,e,n){return function(i){try{t.call(this,this.__data__,e,n)}finally{}}}function eMe(t){return t.trim().split(/^|\s+/).map(function(e){var n="",i=e.indexOf(".");return i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),{type:e,name:n}})}function tMe(t){return function(){var e=this.__on;if(e){for(var n=0,i=-1,r=e.length,o;n<r;++n)o=e[n],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.capture):e[++i]=o;++i?e.length=i:delete this.__on}}}function nMe(t,e,n){var i=Aj.hasOwnProperty(t.type)?QIe:Pj;return function(r,o,l){var s=this.__on,d,p=i(e,o,l);if(s){for(var y=0,v=s.length;y<v;++y)if((d=s[y]).type===t.type&&d.name===t.name){this.removeEventListener(d.type,d.listener,d.capture),this.addEventListener(d.type,d.listener=p,d.capture=n),d.value=e;return}}this.addEventListener(t.type,p,n),d={type:t.type,name:t.name,value:e,listener:p,capture:n},s?s.push(d):this.__on=[d]}}function iMe(t,e,n){var i=eMe(t+""),r,o=i.length,l;if(arguments.length<2){var s=this.node().__on;if(s){for(var d=0,p=s.length,y;d<p;++d)for(r=0,y=s[d];r<o;++r)if((l=i[r]).type===y.type&&l.name===y.name)return y.value}return}for(s=e?nMe:tMe,n==null&&(n=!1),r=0;r<o;++r)this.each(s(i[r],e,n));return this}function Ij(t,e,n){var i=wj(t),r=i.CustomEvent;typeof r=="function"?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function rMe(t,e){return function(){return Ij(this,t,e)}}function oMe(t,e){return function(){return Ij(this,t,e.apply(this,arguments))}}function sMe(t,e){return this.each((typeof e=="function"?oMe:rMe)(t,e))}var aMe=[null];function Ml(t,e){this._groups=t,this._parents=e}function k_(){return new Ml([[document.documentElement]],aMe)}Ml.prototype=k_.prototype={constructor:Ml,select:HPe,selectAll:KPe,filter:XPe,data:QPe,enter:ZPe,exit:eIe,join:tIe,merge:nIe,order:iIe,sort:rIe,call:sIe,nodes:aIe,node:lIe,size:cIe,empty:uIe,each:hIe,attr:vIe,style:wIe,property:CIe,classed:MIe,text:DIe,html:zIe,raise:UIe,lower:jIe,append:$Ie,insert:HIe,remove:KIe,clone:qIe,datum:YIe,on:iMe,dispatch:sMe};function F_(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function nE(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function Pf(){}var qv=.7,Kw=1/qv,wm="\\s*([+-]?\\d+)\\s*",Yv="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",cc="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",lMe=/^#([0-9a-f]{3,8})$/,cMe=new RegExp("^rgb\\("+[wm,wm,wm]+"\\)$"),uMe=new RegExp("^rgb\\("+[cc,cc,cc]+"\\)$"),hMe=new RegExp("^rgba\\("+[wm,wm,wm,Yv]+"\\)$"),dMe=new RegExp("^rgba\\("+[cc,cc,cc,Yv]+"\\)$"),fMe=new RegExp("^hsl\\("+[Yv,cc,cc]+"\\)$"),pMe=new RegExp("^hsla\\("+[Yv,cc,cc,Yv]+"\\)$"),T8={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};F_(Pf,su,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:S8,formatHex:S8,formatHsl:mMe,formatRgb:C8,toString:C8});function S8(){return this.rgb().formatHex()}function mMe(){return Rj(this).formatHsl()}function C8(){return this.rgb().formatRgb()}function su(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=lMe.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?A8(e):n===3?new Ls(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?ux(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?ux(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=cMe.exec(t))?new Ls(e[1],e[2],e[3],1):(e=uMe.exec(t))?new Ls(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=hMe.exec(t))?ux(e[1],e[2],e[3],e[4]):(e=dMe.exec(t))?ux(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=fMe.exec(t))?M8(e[1],e[2]/100,e[3]/100,1):(e=pMe.exec(t))?M8(e[1],e[2]/100,e[3]/100,e[4]):T8.hasOwnProperty(t)?A8(T8[t]):t==="transparent"?new Ls(NaN,NaN,NaN,0):null}function A8(t){return new Ls(t>>16&255,t>>8&255,t&255,1)}function ux(t,e,n,i){return i<=0&&(t=e=n=NaN),new Ls(t,e,n,i)}function Mj(t){return t instanceof Pf||(t=su(t)),t?(t=t.rgb(),new Ls(t.r,t.g,t.b,t.opacity)):new Ls}function dI(t,e,n,i){return arguments.length===1?Mj(t):new Ls(t,e,n,i??1)}function Ls(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}F_(Ls,dI,nE(Pf,{brighter:function(t){return t=t==null?Kw:Math.pow(Kw,t),new Ls(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?qv:Math.pow(qv,t),new Ls(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:P8,formatHex:P8,formatRgb:I8,toString:I8}));function P8(){return"#"+BC(this.r)+BC(this.g)+BC(this.b)}function I8(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}function BC(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function M8(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new ic(t,e,n,i)}function Rj(t){if(t instanceof ic)return new ic(t.h,t.s,t.l,t.opacity);if(t instanceof Pf||(t=su(t)),!t)return new ic;if(t instanceof ic)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),o=Math.max(e,n,i),l=NaN,s=o-r,d=(o+r)/2;return s?(e===o?l=(n-i)/s+(n<i)*6:n===o?l=(i-e)/s+2:l=(e-n)/s+4,s/=d<.5?o+r:2-o-r,l*=60):s=d>0&&d<1?0:l,new ic(l,s,d,t.opacity)}function fI(t,e,n,i){return arguments.length===1?Rj(t):new ic(t,e,n,i??1)}function ic(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}F_(ic,fI,nE(Pf,{brighter:function(t){return t=t==null?Kw:Math.pow(Kw,t),new ic(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?qv:Math.pow(qv,t),new ic(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new Ls(zC(t>=240?t-240:t+120,r,i),zC(t,r,i),zC(t<120?t+240:t-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(t===1?")":", "+t+")")}}));function zC(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}var gMe=Math.PI/180,yMe=180/Math.PI,Xw=18,Lj=.96422,Oj=1,Dj=.82521,kj=4/29,Em=6/29,Fj=3*Em*Em,vMe=Em*Em*Em;function Bj(t){if(t instanceof uc)return new uc(t.l,t.a,t.b,t.opacity);if(t instanceof Wc)return zj(t);t instanceof Ls||(t=Mj(t));var e=jC(t.r),n=jC(t.g),i=jC(t.b),r=NC((.2225045*e+.7168786*n+.0606169*i)/Oj),o,l;return e===n&&n===i?o=l=r:(o=NC((.4360747*e+.3850649*n+.1430804*i)/Lj),l=NC((.0139322*e+.0971045*n+.7141733*i)/Dj)),new uc(116*r-16,500*(o-r),200*(r-l),t.opacity)}function Jv(t,e,n,i){return arguments.length===1?Bj(t):new uc(t,e,n,i??1)}function uc(t,e,n,i){this.l=+t,this.a=+e,this.b=+n,this.opacity=+i}F_(uc,Jv,nE(Pf,{brighter:function(t){return new uc(this.l+Xw*(t??1),this.a,this.b,this.opacity)},darker:function(t){return new uc(this.l-Xw*(t??1),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return e=Lj*UC(e),t=Oj*UC(t),n=Dj*UC(n),new Ls(VC(3.1338561*e-1.6168667*t-.4906146*n),VC(-.9787684*e+1.9161415*t+.033454*n),VC(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}}));function NC(t){return t>vMe?Math.pow(t,1/3):t/Fj+kj}function UC(t){return t>Em?t*t*t:Fj*(t-kj)}function VC(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function jC(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function _Me(t){if(t instanceof Wc)return new Wc(t.h,t.c,t.l,t.opacity);if(t instanceof uc||(t=Bj(t)),t.a===0&&t.b===0)return new Wc(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*yMe;return new Wc(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function bMe(t,e,n,i){return arguments.length===1?_Me(t):new Wc(t,e,n,i??1)}function Wc(t,e,n,i){this.h=+t,this.c=+e,this.l=+n,this.opacity=+i}function zj(t){if(isNaN(t.h))return new uc(t.l,0,0,t.opacity);var e=t.h*gMe;return new uc(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}F_(Wc,bMe,nE(Pf,{brighter:function(t){return new Wc(this.h,this.c,this.l+Xw*(t??1),this.opacity)},darker:function(t){return new Wc(this.h,this.c,this.l-Xw*(t??1),this.opacity)},rgb:function(){return zj(this).rgb()}}));function nR(t){return function(){return t}}function xMe(t,e){return function(n){return t+n*e}}function wMe(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function EMe(t){return(t=+t)==1?rm:function(e,n){return n-e?wMe(e,n,t):nR(isNaN(e)?n:e)}}function rm(t,e){var n=e-t;return n?xMe(t,n):nR(isNaN(t)?e:t)}const Zw=function t(e){var n=EMe(e);function i(r,o){var l=n((r=dI(r)).r,(o=dI(o)).r),s=n(r.g,o.g),d=n(r.b,o.b),p=rm(r.opacity,o.opacity);return function(y){return r.r=l(y),r.g=s(y),r.b=d(y),r.opacity=p(y),r+""}}return i.gamma=t,i}(1);function TMe(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,i=e.slice(),r;return function(o){for(r=0;r<n;++r)i[r]=t[r]*(1-o)+e[r]*o;return i}}function SMe(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function CMe(t,e){var n=e?e.length:0,i=t?Math.min(n,t.length):0,r=new Array(i),o=new Array(n),l;for(l=0;l<i;++l)r[l]=iR(t[l],e[l]);for(;l<n;++l)o[l]=e[l];return function(s){for(l=0;l<i;++l)o[l]=r[l](s);return o}}function AMe(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function yl(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function PMe(t,e){var n={},i={},r;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in t?n[r]=iR(t[r],e[r]):i[r]=e[r];return function(o){for(r in n)i[r]=n[r](o);return i}}var pI=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,$C=new RegExp(pI.source,"g");function IMe(t){return function(){return t}}function MMe(t){return function(e){return t(e)+""}}function Nj(t,e){var n=pI.lastIndex=$C.lastIndex=0,i,r,o,l=-1,s=[],d=[];for(t=t+"",e=e+"";(i=pI.exec(t))&&(r=$C.exec(e));)(o=r.index)>n&&(o=e.slice(n,o),s[l]?s[l]+=o:s[++l]=o),(i=i[0])===(r=r[0])?s[l]?s[l]+=r:s[++l]=r:(s[++l]=null,d.push({i:l,x:yl(i,r)})),n=$C.lastIndex;return n<e.length&&(o=e.slice(n),s[l]?s[l]+=o:s[++l]=o),s.length<2?d[0]?MMe(d[0].x):IMe(e):(e=d.length,function(p){for(var y=0,v;y<e;++y)s[(v=d[y]).i]=v.x(p);return s.join("")})}function iR(t,e){var n=typeof e,i;return e==null||n==="boolean"?nR(e):(n==="number"?yl:n==="string"?(i=su(e))?(e=i,Zw):Nj:e instanceof su?Zw:e instanceof Date?AMe:SMe(e)?TMe:Array.isArray(e)?CMe:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?PMe:yl)(t,e)}function RMe(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var R8=180/Math.PI,mI={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Uj(t,e,n,i,r,o){var l,s,d;return(l=Math.sqrt(t*t+e*e))&&(t/=l,e/=l),(d=t*n+e*i)&&(n-=t*d,i-=e*d),(s=Math.sqrt(n*n+i*i))&&(n/=s,i/=s,d/=s),t*i<e*n&&(t=-t,e=-e,d=-d,l=-l),{translateX:r,translateY:o,rotate:Math.atan2(e,t)*R8,skewX:Math.atan(d)*R8,scaleX:l,scaleY:s}}var Ky,GC,L8,hx;function LMe(t){return t==="none"?mI:(Ky||(Ky=document.createElement("DIV"),GC=document.documentElement,L8=document.defaultView),Ky.style.transform=t,t=L8.getComputedStyle(GC.appendChild(Ky),null).getPropertyValue("transform"),GC.removeChild(Ky),t=t.slice(7,-1).split(","),Uj(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}function OMe(t){return t==null||(hx||(hx=document.createElementNS("http://www.w3.org/2000/svg","g")),hx.setAttribute("transform",t),!(t=hx.transform.baseVal.consolidate()))?mI:(t=t.matrix,Uj(t.a,t.b,t.c,t.d,t.e,t.f))}function Vj(t,e,n,i){function r(p){return p.length?p.pop()+" ":""}function o(p,y,v,w,T,I){if(p!==v||y!==w){var L=T.push("translate(",null,e,null,n);I.push({i:L-4,x:yl(p,v)},{i:L-2,x:yl(y,w)})}else(v||w)&&T.push("translate("+v+e+w+n)}function l(p,y,v,w){p!==y?(p-y>180?y+=360:y-p>180&&(p+=360),w.push({i:v.push(r(v)+"rotate(",null,i)-2,x:yl(p,y)})):y&&v.push(r(v)+"rotate("+y+i)}function s(p,y,v,w){p!==y?w.push({i:v.push(r(v)+"skewX(",null,i)-2,x:yl(p,y)}):y&&v.push(r(v)+"skewX("+y+i)}function d(p,y,v,w,T,I){if(p!==v||y!==w){var L=T.push(r(T)+"scale(",null,",",null,")");I.push({i:L-4,x:yl(p,v)},{i:L-2,x:yl(y,w)})}else(v!==1||w!==1)&&T.push(r(T)+"scale("+v+","+w+")")}return function(p,y){var v=[],w=[];return p=t(p),y=t(y),o(p.translateX,p.translateY,y.translateX,y.translateY,v,w),l(p.rotate,y.rotate,v,w),s(p.skewX,y.skewX,v,w),d(p.scaleX,p.scaleY,y.scaleX,y.scaleY,v,w),p=y=null,function(T){for(var I=-1,L=w.length,k;++I<L;)v[(k=w[I]).i]=k.x(T);return v.join("")}}}var DMe=Vj(LMe,"px, ","px)","deg)"),kMe=Vj(OMe,", ",")",")");function FMe(t,e){var n=rm((t=Jv(t)).l,(e=Jv(e)).l),i=rm(t.a,e.a),r=rm(t.b,e.b),o=rm(t.opacity,e.opacity);return function(l){return t.l=n(l),t.a=i(l),t.b=r(l),t.opacity=o(l),t+""}}var Zm=0,p0=0,Xy=0,jj=1e3,qw,m0,Yw=0,yf=0,iE=0,Qv=typeof performance=="object"&&performance.now?performance:Date,$j=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function rE(){return yf||($j(BMe),yf=Qv.now()+iE)}function BMe(){yf=0}function Jw(){this._call=this._time=this._next=null}Jw.prototype=Gj.prototype={constructor:Jw,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?rE():+n)+(e==null?0:+e),!this._next&&m0!==this&&(m0?m0._next=this:qw=this,m0=this),this._call=t,this._time=n,gI()},stop:function(){this._call&&(this._call=null,this._time=1/0,gI())}};function Gj(t,e,n){var i=new Jw;return i.restart(t,e,n),i}function zMe(){rE(),++Zm;for(var t=qw,e;t;)(e=yf-t._time)>=0&&t._call.call(null,e),t=t._next;--Zm}function O8(){yf=(Yw=Qv.now())+iE,Zm=p0=0;try{zMe()}finally{Zm=0,UMe(),yf=0}}function NMe(){var t=Qv.now(),e=t-Yw;e>jj&&(iE-=e,Yw=t)}function UMe(){for(var t,e=qw,n,i=1/0;e;)e._call?(i>e._time&&(i=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:qw=n);m0=t,gI(i)}function gI(t){if(!Zm){p0&&(p0=clearTimeout(p0));var e=t-yf;e>24?(t<1/0&&(p0=setTimeout(O8,t-Qv.now()-iE)),Xy&&(Xy=clearInterval(Xy))):(Xy||(Yw=Qv.now(),Xy=setInterval(NMe,jj)),Zm=1,$j(O8))}}function D8(t,e,n){var i=new Jw;return e=e==null?0:+e,i.restart(function(r){i.stop(),t(r+e)},e,n),i}var VMe=yj("start","end","cancel","interrupt"),jMe=[],Hj=0,k8=1,yI=2,Kx=3,F8=4,vI=5,Xx=6;function oE(t,e,n,i,r,o){var l=t.__transition;if(!l)t.__transition={};else if(n in l)return;$Me(t,n,{name:e,index:i,group:r,on:VMe,tween:jMe,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:Hj})}function rR(t,e){var n=Ol(t,e);if(n.state>Hj)throw new Error("too late; already scheduled");return n}function yu(t,e){var n=Ol(t,e);if(n.state>Kx)throw new Error("too late; already running");return n}function Ol(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function $Me(t,e,n){var i=t.__transition,r;i[e]=n,n.timer=Gj(o,0,n.time);function o(p){n.state=k8,n.timer.restart(l,n.delay,n.time),n.delay<=p&&l(p-n.delay)}function l(p){var y,v,w,T;if(n.state!==k8)return d();for(y in i)if(T=i[y],T.name===n.name){if(T.state===Kx)return D8(l);T.state===F8?(T.state=Xx,T.timer.stop(),T.on.call("interrupt",t,t.__data__,T.index,T.group),delete i[y]):+y<e&&(T.state=Xx,T.timer.stop(),T.on.call("cancel",t,t.__data__,T.index,T.group),delete i[y])}if(D8(function(){n.state===Kx&&(n.state=F8,n.timer.restart(s,n.delay,n.time),s(p))}),n.state=yI,n.on.call("start",t,t.__data__,n.index,n.group),n.state===yI){for(n.state=Kx,r=new Array(w=n.tween.length),y=0,v=-1;y<w;++y)(T=n.tween[y].value.call(t,t.__data__,n.index,n.group))&&(r[++v]=T);r.length=v+1}}function s(p){for(var y=p<n.duration?n.ease.call(null,p/n.duration):(n.timer.restart(d),n.state=vI,1),v=-1,w=r.length;++v<w;)r[v].call(t,y);n.state===vI&&(n.on.call("end",t,t.__data__,n.index,n.group),d())}function d(){n.state=Xx,n.timer.stop(),delete i[e];for(var p in i)return;delete t.__transition}}function GMe(t,e){var n=t.__transition,i,r,o=!0,l;if(n){e=e==null?null:e+"";for(l in n){if((i=n[l]).name!==e){o=!1;continue}r=i.state>yI&&i.state<vI,i.state=Xx,i.timer.stop(),i.on.call(r?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete n[l]}o&&delete t.__transition}}function HMe(t){return this.each(function(){GMe(this,t)})}function WMe(t,e){var n,i;return function(){var r=yu(this,t),o=r.tween;if(o!==n){i=n=o;for(var l=0,s=i.length;l<s;++l)if(i[l].name===e){i=i.slice(),i.splice(l,1);break}}r.tween=i}}function KMe(t,e,n){var i,r;if(typeof n!="function")throw new Error;return function(){var o=yu(this,t),l=o.tween;if(l!==i){r=(i=l).slice();for(var s={name:e,value:n},d=0,p=r.length;d<p;++d)if(r[d].name===e){r[d]=s;break}d===p&&r.push(s)}o.tween=r}}function XMe(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i=Ol(this.node(),n).tween,r=0,o=i.length,l;r<o;++r)if((l=i[r]).name===t)return l.value;return null}return this.each((e==null?WMe:KMe)(n,t,e))}function oR(t,e,n){var i=t._id;return t.each(function(){var r=yu(this,i);(r.value||(r.value={}))[e]=n.apply(this,arguments)}),function(r){return Ol(r,i).value[e]}}function Wj(t,e){var n;return(typeof e=="number"?yl:e instanceof su?Zw:(n=su(e))?(e=n,Zw):Nj)(t,e)}function ZMe(t){return function(){this.removeAttribute(t)}}function qMe(t){return function(){this.removeAttributeNS(t.space,t.local)}}function YMe(t,e,n){var i,r=n+"",o;return function(){var l=this.getAttribute(t);return l===r?null:l===i?o:o=e(i=l,n)}}function JMe(t,e,n){var i,r=n+"",o;return function(){var l=this.getAttributeNS(t.space,t.local);return l===r?null:l===i?o:o=e(i=l,n)}}function QMe(t,e,n){var i,r,o;return function(){var l,s=n(this),d;return s==null?void this.removeAttribute(t):(l=this.getAttribute(t),d=s+"",l===d?null:l===i&&d===r?o:(r=d,o=e(i=l,s)))}}function e3e(t,e,n){var i,r,o;return function(){var l,s=n(this),d;return s==null?void this.removeAttributeNS(t.space,t.local):(l=this.getAttributeNS(t.space,t.local),d=s+"",l===d?null:l===i&&d===r?o:(r=d,o=e(i=l,s)))}}function t3e(t,e){var n=tE(t),i=n==="transform"?kMe:Wj;return this.attrTween(t,typeof e=="function"?(n.local?e3e:QMe)(n,i,oR(this,"attr."+t,e)):e==null?(n.local?qMe:ZMe)(n):(n.local?JMe:YMe)(n,i,e))}function n3e(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function i3e(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function r3e(t,e){var n,i;function r(){var o=e.apply(this,arguments);return o!==i&&(n=(i=o)&&i3e(t,o)),n}return r._value=e,r}function o3e(t,e){var n,i;function r(){var o=e.apply(this,arguments);return o!==i&&(n=(i=o)&&n3e(t,o)),n}return r._value=e,r}function s3e(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var i=tE(t);return this.tween(n,(i.local?r3e:o3e)(i,e))}function a3e(t,e){return function(){rR(this,t).delay=+e.apply(this,arguments)}}function l3e(t,e){return e=+e,function(){rR(this,t).delay=e}}function c3e(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?a3e:l3e)(e,t)):Ol(this.node(),e).delay}function u3e(t,e){return function(){yu(this,t).duration=+e.apply(this,arguments)}}function h3e(t,e){return e=+e,function(){yu(this,t).duration=e}}function d3e(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?u3e:h3e)(e,t)):Ol(this.node(),e).duration}function f3e(t,e){if(typeof e!="function")throw new Error;return function(){yu(this,t).ease=e}}function p3e(t){var e=this._id;return arguments.length?this.each(f3e(e,t)):Ol(this.node(),e).ease}function m3e(t){typeof t!="function"&&(t=bj(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o=e[r],l=o.length,s=i[r]=[],d,p=0;p<l;++p)(d=o[p])&&t.call(d,d.__data__,p,o)&&s.push(d);return new au(i,this._parents,this._name,this._id)}function g3e(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,o=Math.min(i,r),l=new Array(i),s=0;s<o;++s)for(var d=e[s],p=n[s],y=d.length,v=l[s]=new Array(y),w,T=0;T<y;++T)(w=d[T]||p[T])&&(v[T]=w);for(;s<i;++s)l[s]=e[s];return new au(l,this._parents,this._name,this._id)}function y3e(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function v3e(t,e,n){var i,r,o=y3e(e)?rR:yu;return function(){var l=o(this,t),s=l.on;s!==i&&(r=(i=s).copy()).on(e,n),l.on=r}}function _3e(t,e){var n=this._id;return arguments.length<2?Ol(this.node(),n).on.on(t):this.each(v3e(n,t,e))}function b3e(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function x3e(){return this.on("end.remove",b3e(this._id))}function w3e(t){var e=this._name,n=this._id;typeof t!="function"&&(t=eR(t));for(var i=this._groups,r=i.length,o=new Array(r),l=0;l<r;++l)for(var s=i[l],d=s.length,p=o[l]=new Array(d),y,v,w=0;w<d;++w)(y=s[w])&&(v=t.call(y,y.__data__,w,s))&&("__data__"in y&&(v.__data__=y.__data__),p[w]=v,oE(p[w],e,n,w,p,Ol(y,n)));return new au(o,this._parents,e,n)}function E3e(t){var e=this._name,n=this._id;typeof t!="function"&&(t=_j(t));for(var i=this._groups,r=i.length,o=[],l=[],s=0;s<r;++s)for(var d=i[s],p=d.length,y,v=0;v<p;++v)if(y=d[v]){for(var w=t.call(y,y.__data__,v,d),T,I=Ol(y,n),L=0,k=w.length;L<k;++L)(T=w[L])&&oE(T,e,n,L,w,I);o.push(w),l.push(y)}return new au(o,l,e,n)}var T3e=k_.prototype.constructor;function S3e(){return new T3e(this._groups,this._parents)}function C3e(t,e){var n,i,r;return function(){var o=Xm(this,t),l=(this.style.removeProperty(t),Xm(this,t));return o===l?null:o===n&&l===i?r:r=e(n=o,i=l)}}function Kj(t){return function(){this.style.removeProperty(t)}}function A3e(t,e,n){var i,r=n+"",o;return function(){var l=Xm(this,t);return l===r?null:l===i?o:o=e(i=l,n)}}function P3e(t,e,n){var i,r,o;return function(){var l=Xm(this,t),s=n(this),d=s+"";return s==null&&(d=s=(this.style.removeProperty(t),Xm(this,t))),l===d?null:l===i&&d===r?o:(r=d,o=e(i=l,s))}}function I3e(t,e){var n,i,r,o="style."+e,l="end."+o,s;return function(){var d=yu(this,t),p=d.on,y=d.value[o]==null?s||(s=Kj(e)):void 0;(p!==n||r!==y)&&(i=(n=p).copy()).on(l,r=y),d.on=i}}function M3e(t,e,n){var i=(t+="")=="transform"?DMe:Wj;return e==null?this.styleTween(t,C3e(t,i)).on("end.style."+t,Kj(t)):typeof e=="function"?this.styleTween(t,P3e(t,i,oR(this,"style."+t,e))).each(I3e(this._id,t)):this.styleTween(t,A3e(t,i,e),n).on("end.style."+t,null)}function R3e(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function L3e(t,e,n){var i,r;function o(){var l=e.apply(this,arguments);return l!==r&&(i=(r=l)&&R3e(t,l,n)),i}return o._value=e,o}function O3e(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,L3e(t,e,n??""))}function D3e(t){return function(){this.textContent=t}}function k3e(t){return function(){var e=t(this);this.textContent=e??""}}function F3e(t){return this.tween("text",typeof t=="function"?k3e(oR(this,"text",t)):D3e(t==null?"":t+""))}function B3e(t){return function(e){this.textContent=t.call(this,e)}}function z3e(t){var e,n;function i(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&B3e(r)),e}return i._value=t,i}function N3e(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,z3e(t))}function U3e(){for(var t=this._name,e=this._id,n=Xj(),i=this._groups,r=i.length,o=0;o<r;++o)for(var l=i[o],s=l.length,d,p=0;p<s;++p)if(d=l[p]){var y=Ol(d,e);oE(d,t,n,p,l,{time:y.time+y.delay+y.duration,delay:0,duration:y.duration,ease:y.ease})}return new au(i,this._parents,t,n)}function V3e(){var t,e,n=this,i=n._id,r=n.size();return new Promise(function(o,l){var s={value:l},d={value:function(){--r===0&&o()}};n.each(function(){var p=yu(this,i),y=p.on;y!==t&&(e=(t=y).copy(),e._.cancel.push(s),e._.interrupt.push(s),e._.end.push(d)),p.on=e})})}var j3e=0;function au(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function Xj(){return++j3e}var Vp=k_.prototype;au.prototype={constructor:au,select:w3e,selectAll:E3e,filter:m3e,merge:g3e,selection:S3e,transition:U3e,call:Vp.call,nodes:Vp.nodes,node:Vp.node,size:Vp.size,empty:Vp.empty,each:Vp.each,on:_3e,attr:t3e,attrTween:s3e,style:M3e,styleTween:O3e,text:F3e,textTween:N3e,remove:x3e,tween:XMe,delay:c3e,duration:d3e,ease:p3e,end:V3e};function $3e(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var _I={time:null,delay:0,duration:250,ease:$3e};function G3e(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return _I.time=rE(),_I;return n}function H3e(t){var e,n;t instanceof au?(e=t._id,t=t._name):(e=Xj(),(n=_I).time=rE(),t=t==null?null:t+"");for(var i=this._groups,r=i.length,o=0;o<r;++o)for(var l=i[o],s=l.length,d,p=0;p<s;++p)(d=l[p])&&oE(d,t,e,p,l,n||G3e(d,e));return new au(i,this._parents,t,e)}k_.prototype.interrupt=HMe;k_.prototype.transition=H3e;var Ba="$";function Qw(){}Qw.prototype=Zj.prototype={constructor:Qw,has:function(t){return Ba+t in this},get:function(t){return this[Ba+t]},set:function(t,e){return this[Ba+t]=e,this},remove:function(t){var e=Ba+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===Ba&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===Ba&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===Ba&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===Ba&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===Ba&&++t;return t},empty:function(){for(var t in this)if(t[0]===Ba)return!1;return!0},each:function(t){for(var e in this)e[0]===Ba&&t(this[e],e.slice(1),this)}};function Zj(t,e){var n=new Qw;if(t instanceof Qw)t.each(function(s,d){n.set(d,s)});else if(Array.isArray(t)){var i=-1,r=t.length,o;if(e==null)for(;++i<r;)n.set(i,t[i]);else for(;++i<r;)n.set(e(o=t[i],i,t),o)}else if(t)for(var l in t)n.set(l,t[l]);return n}function B8(){}var kd=Zj.prototype;B8.prototype={constructor:B8,has:kd.has,add:function(t){return t+="",this[Ba+t]=t,this},remove:kd.remove,clear:kd.clear,values:kd.keys,size:kd.size,empty:kd.empty,each:kd.each};function W3e(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function e2(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function qm(t){return t=e2(Math.abs(t)),t?t[1]:NaN}function K3e(t,e){return function(n,i){for(var r=n.length,o=[],l=0,s=t[0],d=0;r>0&&s>0&&(d+s+1>i&&(s=Math.max(1,i-d)),o.push(n.substring(r-=s,r+s)),!((d+=s+1)>i));)s=t[l=(l+1)%t.length];return o.reverse().join(e)}}function X3e(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var Z3e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function t2(t){if(!(e=Z3e.exec(t)))throw new Error("invalid format: "+t);var e;return new sR({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}t2.prototype=sR.prototype;function sR(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}sR.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function q3e(t){e:for(var e=t.length,n=1,i=-1,r;n<e;++n)switch(t[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+t[n])break e;i>0&&(i=0);break}return i>0?t.slice(0,i)+t.slice(r+1):t}var qj;function Y3e(t,e){var n=e2(t,e);if(!n)return t+"";var i=n[0],r=n[1],o=r-(qj=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,l=i.length;return o===l?i:o>l?i+new Array(o-l+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+e2(t,Math.max(0,e+o-1))[0]}function z8(t,e){var n=e2(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const N8={"%":function(t,e){return(t*100).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:W3e,e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return z8(t*100,e)},r:z8,s:Y3e,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function U8(t){return t}var V8=Array.prototype.map,j8=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function J3e(t){var e=t.grouping===void 0||t.thousands===void 0?U8:K3e(V8.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",i=t.currency===void 0?"":t.currency[1]+"",r=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?U8:X3e(V8.call(t.numerals,String)),l=t.percent===void 0?"%":t.percent+"",s=t.minus===void 0?"-":t.minus+"",d=t.nan===void 0?"NaN":t.nan+"";function p(v){v=t2(v);var w=v.fill,T=v.align,I=v.sign,L=v.symbol,k=v.zero,F=v.width,B=v.comma,G=v.precision,U=v.trim,ee=v.type;ee==="n"?(B=!0,ee="g"):N8[ee]||(G===void 0&&(G=12),U=!0,ee="g"),(k||w==="0"&&T==="=")&&(k=!0,w="0",T="=");var ne=L==="$"?n:L==="#"&&/[boxX]/.test(ee)?"0"+ee.toLowerCase():"",ye=L==="$"?i:/[%p]/.test(ee)?l:"",fe=N8[ee],J=/[defgprs%]/.test(ee);G=G===void 0?6:/[gprs]/.test(ee)?Math.max(1,Math.min(21,G)):Math.max(0,Math.min(20,G));function Ce(me){var be=ne,Te=ye,ke,ut,et;if(ee==="c")Te=fe(me)+Te,me="";else{me=+me;var Et=me<0||1/me<0;if(me=isNaN(me)?d:fe(Math.abs(me),G),U&&(me=q3e(me)),Et&&+me==0&&I!=="+"&&(Et=!1),be=(Et?I==="("?I:s:I==="-"||I==="("?"":I)+be,Te=(ee==="s"?j8[8+qj/3]:"")+Te+(Et&&I==="("?")":""),J){for(ke=-1,ut=me.length;++ke<ut;)if(et=me.charCodeAt(ke),48>et||et>57){Te=(et===46?r+me.slice(ke+1):me.slice(ke))+Te,me=me.slice(0,ke);break}}}B&&!k&&(me=e(me,1/0));var bt=be.length+me.length+Te.length,Qt=bt<F?new Array(F-bt+1).join(w):"";switch(B&&k&&(me=e(Qt+me,Qt.length?F-Te.length:1/0),Qt=""),T){case"<":me=be+me+Te+Qt;break;case"=":me=be+Qt+me+Te;break;case"^":me=Qt.slice(0,bt=Qt.length>>1)+be+me+Te+Qt.slice(bt);break;default:me=Qt+be+me+Te;break}return o(me)}return Ce.toString=function(){return v+""},Ce}function y(v,w){var T=p((v=t2(v),v.type="f",v)),I=Math.max(-8,Math.min(8,Math.floor(qm(w)/3)))*3,L=Math.pow(10,-I),k=j8[8+I/3];return function(F){return T(L*F)+k}}return{format:p,formatPrefix:y}}var dx,Yj,Jj;Q3e({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function Q3e(t){return dx=J3e(t),Yj=dx.format,Jj=dx.formatPrefix,dx}function eRe(t){return Math.max(0,-qm(Math.abs(t)))}function tRe(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(qm(e)/3)))*3-qm(Math.abs(t)))}function nRe(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,qm(e)-qm(t))+1}function og(){return Math.random()}(function t(e){function n(i,r){return i=i==null?0:+i,r=r==null?1:+r,arguments.length===1?(r=i,i=0):r-=i,function(){return e()*r+i}}return n.source=t,n})(og);const iRe=function t(e){function n(i,r){var o,l;return i=i==null?0:+i,r=r==null?1:+r,function(){var s;if(o!=null)s=o,o=null;else do o=e()*2-1,s=e()*2-1,l=o*o+s*s;while(!l||l>1);return i+r*s*Math.sqrt(-2*Math.log(l)/l)}}return n.source=t,n}(og);(function t(e){function n(){var i=iRe.source(e).apply(this,arguments);return function(){return Math.exp(i())}}return n.source=t,n})(og);const rRe=function t(e){function n(i){return function(){for(var r=0,o=0;o<i;++o)r+=e();return r}}return n.source=t,n}(og);(function t(e){function n(i){var r=rRe.source(e)(i);return function(){return r()/i}}return n.source=t,n})(og);(function t(e){function n(i){return function(){return-Math.log(1-e())/i}}return n.source=t,n})(og);function oRe(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}var Qj=Array.prototype,sRe=Qj.map,$8=Qj.slice;function aRe(t){return function(){return t}}function lRe(t){return+t}var G8=[0,1];function om(t){return t}function bI(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:aRe(isNaN(e)?NaN:.5)}function H8(t){var e=t[0],n=t[t.length-1],i;return e>n&&(i=e,e=n,n=i),function(r){return Math.max(e,Math.min(n,r))}}function cRe(t,e,n){var i=t[0],r=t[1],o=e[0],l=e[1];return r<i?(i=bI(r,i),o=n(l,o)):(i=bI(i,r),o=n(o,l)),function(s){return o(i(s))}}function uRe(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),o=new Array(i),l=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++l<i;)r[l]=bI(t[l],t[l+1]),o[l]=n(e[l],e[l+1]);return function(s){var d=FPe(t,s,1,i)-1;return o[d](r[d](s))}}function hRe(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function dRe(){var t=G8,e=G8,n=iR,i,r,o,l=om,s,d,p;function y(){return s=Math.min(t.length,e.length)>2?uRe:cRe,d=p=null,v}function v(w){return isNaN(w=+w)?o:(d||(d=s(t.map(i),e,n)))(i(l(w)))}return v.invert=function(w){return l(r((p||(p=s(e,t.map(i),yl)))(w)))},v.domain=function(w){return arguments.length?(t=sRe.call(w,lRe),l===om||(l=H8(t)),y()):t.slice()},v.range=function(w){return arguments.length?(e=$8.call(w),y()):e.slice()},v.rangeRound=function(w){return e=$8.call(w),n=RMe,y()},v.clamp=function(w){return arguments.length?(l=w?H8(t):om,v):l!==om},v.interpolate=function(w){return arguments.length?(n=w,y()):n},v.unknown=function(w){return arguments.length?(o=w,v):o},function(w,T){return i=w,r=T,y()}}function fRe(t,e){return dRe()(t,e)}function pRe(t,e,n,i){var r=zPe(t,e,n),o;switch(i=t2(i??",f"),i.type){case"s":{var l=Math.max(Math.abs(t),Math.abs(e));return i.precision==null&&!isNaN(o=tRe(r,l))&&(i.precision=o),Jj(i,l)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(o=nRe(r,Math.max(Math.abs(t),Math.abs(e))))&&(i.precision=o-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(o=eRe(r))&&(i.precision=o-(i.type==="%")*2);break}}return Yj(i)}function mRe(t){var e=t.domain;return t.ticks=function(n){var i=e();return BPe(i[0],i[i.length-1],n??10)},t.tickFormat=function(n,i){var r=e();return pRe(r[0],r[r.length-1],n??10,i)},t.nice=function(n){n==null&&(n=10);var i=e(),r=0,o=i.length-1,l=i[r],s=i[o],d;return s<l&&(d=l,l=s,s=d,d=r,r=o,o=d),d=Hx(l,s,n),d>0?(l=Math.floor(l/d)*d,s=Math.ceil(s/d)*d,d=Hx(l,s,n)):d<0&&(l=Math.ceil(l*d)/d,s=Math.floor(s*d)/d,d=Hx(l,s,n)),d>0?(i[r]=Math.floor(l/d)*d,i[o]=Math.ceil(s/d)*d,e(i)):d<0&&(i[r]=Math.ceil(l*d)/d,i[o]=Math.floor(s*d)/d,e(i)),t},t}function Kd(){var t=fRe(om,om);return t.copy=function(){return hRe(t,Kd())},oRe.apply(t,arguments),mRe(t)}function sE(t){for(var e=t.length/6|0,n=new Array(e),i=0;i<e;)n[i]="#"+t.slice(i*6,++i*6);return n}function aE(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}const gRe=aE(sE("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));aE(sE("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf"));aE(sE("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4"));aE(sE("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function n2(){this._=null}function lE(t){t.U=t.C=t.L=t.R=t.P=t.N=null}n2.prototype={constructor:n2,insert:function(t,e){var n,i,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=W8(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)i=n.U,n===i.L?(r=i.R,r&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.R&&(Zy(this,n),t=n,n=t.U),n.C=!1,i.C=!0,qy(this,i))):(r=i.L,r&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.L&&(qy(this,n),t=n,n=t.U),n.C=!1,i.C=!0,Zy(this,i))),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e=t.U,n,i=t.L,r=t.R,o,l;if(i?r?o=W8(r):o=i:o=r,e?e.L===t?e.L=o:e.R=o:this._=o,i&&r?(l=o.C,o.C=t.C,o.L=i,i.U=o,o!==r?(e=o.U,o.U=t.U,t=o.R,e.L=t,o.R=r,r.U=o):(o.U=e,e=o,t=o.R)):(l=t.C,t=o),t&&(t.U=e),!l){if(t&&t.C){t.C=!1;return}do{if(t===this._)break;if(t===e.L){if(n=e.R,n.C&&(n.C=!1,e.C=!0,Zy(this,e),n=e.R),n.L&&n.L.C||n.R&&n.R.C){(!n.R||!n.R.C)&&(n.L.C=!1,n.C=!0,qy(this,n),n=e.R),n.C=e.C,e.C=n.R.C=!1,Zy(this,e),t=this._;break}}else if(n=e.L,n.C&&(n.C=!1,e.C=!0,qy(this,e),n=e.L),n.L&&n.L.C||n.R&&n.R.C){(!n.L||!n.L.C)&&(n.R.C=!1,n.C=!0,Zy(this,n),n=e.L),n.C=e.C,e.C=n.L.C=!1,qy(this,e),t=this._;break}n.C=!0,t=e,e=e.U}while(!t.C);t&&(t.C=!1)}}};function Zy(t,e){var n=e,i=e.R,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function qy(t,e){var n=e,i=e.L,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function W8(t){for(;t.L;)t=t.L;return t}function g0(t,e,n,i){var r=[null,null],o=fs.push(r)-1;return r.left=t,r.right=e,n&&i2(r,t,e,n),i&&i2(r,e,t,i),xa[t.index].halfedges.push(o),xa[e.index].halfedges.push(o),r}function Yy(t,e,n){var i=[e,n];return i.left=t,i}function i2(t,e,n,i){!t[0]&&!t[1]?(t[0]=i,t.left=e,t.right=n):t.left===n?t[1]=i:t[0]=i}function yRe(t,e,n,i,r){var o=t[0],l=t[1],s=o[0],d=o[1],p=l[0],y=l[1],v=0,w=1,T=p-s,I=y-d,L;if(L=e-s,!(!T&&L>0)){if(L/=T,T<0){if(L<v)return;L<w&&(w=L)}else if(T>0){if(L>w)return;L>v&&(v=L)}if(L=i-s,!(!T&&L<0)){if(L/=T,T<0){if(L>w)return;L>v&&(v=L)}else if(T>0){if(L<v)return;L<w&&(w=L)}if(L=n-d,!(!I&&L>0)){if(L/=I,I<0){if(L<v)return;L<w&&(w=L)}else if(I>0){if(L>w)return;L>v&&(v=L)}if(L=r-d,!(!I&&L<0)){if(L/=I,I<0){if(L>w)return;L>v&&(v=L)}else if(I>0){if(L<v)return;L<w&&(w=L)}return!(v>0)&&!(w<1)||(v>0&&(t[0]=[s+v*T,d+v*I]),w<1&&(t[1]=[s+w*T,d+w*I])),!0}}}}}function vRe(t,e,n,i,r){var o=t[1];if(o)return!0;var l=t[0],s=t.left,d=t.right,p=s[0],y=s[1],v=d[0],w=d[1],T=(p+v)/2,I=(y+w)/2,L,k;if(w===y){if(T<e||T>=i)return;if(p>v){if(!l)l=[T,n];else if(l[1]>=r)return;o=[T,r]}else{if(!l)l=[T,r];else if(l[1]<n)return;o=[T,n]}}else if(L=(p-v)/(w-y),k=I-L*T,L<-1||L>1)if(p>v){if(!l)l=[(n-k)/L,n];else if(l[1]>=r)return;o=[(r-k)/L,r]}else{if(!l)l=[(r-k)/L,r];else if(l[1]<n)return;o=[(n-k)/L,n]}else if(y<w){if(!l)l=[e,L*e+k];else if(l[0]>=i)return;o=[i,L*i+k]}else{if(!l)l=[i,L*i+k];else if(l[0]<e)return;o=[e,L*e+k]}return t[0]=l,t[1]=o,!0}function _Re(t,e,n,i){for(var r=fs.length,o;r--;)(!vRe(o=fs[r],t,e,n,i)||!yRe(o,t,e,n,i)||!(Math.abs(o[0][0]-o[1][0])>Vr||Math.abs(o[0][1]-o[1][1])>Vr))&&delete fs[r]}function bRe(t){return xa[t.index]={site:t,halfedges:[]}}function xRe(t,e){var n=t.site,i=e.left,r=e.right;return n===r&&(r=i,i=n),r?Math.atan2(r[1]-i[1],r[0]-i[0]):(n===i?(i=e[1],r=e[0]):(i=e[0],r=e[1]),Math.atan2(i[0]-r[0],r[1]-i[1]))}function e$(t,e){return e[+(e.left!==t.site)]}function wRe(t,e){return e[+(e.left===t.site)]}function ERe(){for(var t=0,e=xa.length,n,i,r,o;t<e;++t)if((n=xa[t])&&(o=(i=n.halfedges).length)){var l=new Array(o),s=new Array(o);for(r=0;r<o;++r)l[r]=r,s[r]=xRe(n,fs[i[r]]);for(l.sort(function(d,p){return s[p]-s[d]}),r=0;r<o;++r)s[r]=i[l[r]];for(r=0;r<o;++r)i[r]=s[r]}}function TRe(t,e,n,i){var r=xa.length,o,l,s,d,p,y,v,w,T,I,L,k,F=!0;for(o=0;o<r;++o)if(l=xa[o]){for(s=l.site,p=l.halfedges,d=p.length;d--;)fs[p[d]]||p.splice(d,1);for(d=0,y=p.length;d<y;)I=wRe(l,fs[p[d]]),L=I[0],k=I[1],v=e$(l,fs[p[++d%y]]),w=v[0],T=v[1],(Math.abs(L-w)>Vr||Math.abs(k-T)>Vr)&&(p.splice(d,0,fs.push(Yy(s,I,Math.abs(L-t)<Vr&&i-k>Vr?[t,Math.abs(w-t)<Vr?T:i]:Math.abs(k-i)<Vr&&n-L>Vr?[Math.abs(T-i)<Vr?w:n,i]:Math.abs(L-n)<Vr&&k-e>Vr?[n,Math.abs(w-n)<Vr?T:e]:Math.abs(k-e)<Vr&&L-t>Vr?[Math.abs(T-e)<Vr?w:t,e]:null))-1),++y);y&&(F=!1)}if(F){var B,G,U,ee=1/0;for(o=0,F=null;o<r;++o)(l=xa[o])&&(s=l.site,B=s[0]-t,G=s[1]-e,U=B*B+G*G,U<ee&&(ee=U,F=l));if(F){var ne=[t,e],ye=[t,i],fe=[n,i],J=[n,e];F.halfedges.push(fs.push(Yy(s=F.site,ne,ye))-1,fs.push(Yy(s,ye,fe))-1,fs.push(Yy(s,fe,J))-1,fs.push(Yy(s,J,ne))-1)}}for(o=0;o<r;++o)(l=xa[o])&&(l.halfedges.length||delete xa[o])}var t$=[],aR;function SRe(){lE(this),this.x=this.y=this.arc=this.site=this.cy=null}function sm(t){var e=t.P,n=t.N;if(!(!e||!n)){var i=e.site,r=t.site,o=n.site;if(i!==o){var l=r[0],s=r[1],d=i[0]-l,p=i[1]-s,y=o[0]-l,v=o[1]-s,w=2*(d*v-p*y);if(!(w>=-MRe)){var T=d*d+p*p,I=y*y+v*v,L=(v*T-p*I)/w,k=(d*I-y*T)/w,F=t$.pop()||new SRe;F.arc=t,F.site=r,F.x=L+l,F.y=(F.cy=k+s)+Math.sqrt(L*L+k*k),t.circle=F;for(var B=null,G=e_._;G;)if(F.y<G.y||F.y===G.y&&F.x<=G.x)if(G.L)G=G.L;else{B=G.P;break}else if(G.R)G=G.R;else{B=G;break}e_.insert(B,F),B||(aR=F)}}}}function Tm(t){var e=t.circle;e&&(e.P||(aR=e.N),e_.remove(e),t$.push(e),lE(e),t.circle=null)}var n$=[];function CRe(){lE(this),this.edge=this.site=this.circle=null}function K8(t){var e=n$.pop()||new CRe;return e.site=t,e}function HC(t){Tm(t),Sm.remove(t),n$.push(t),lE(t)}function ARe(t){var e=t.circle,n=e.x,i=e.cy,r=[n,i],o=t.P,l=t.N,s=[t];HC(t);for(var d=o;d.circle&&Math.abs(n-d.circle.x)<Vr&&Math.abs(i-d.circle.cy)<Vr;)o=d.P,s.unshift(d),HC(d),d=o;s.unshift(d),Tm(d);for(var p=l;p.circle&&Math.abs(n-p.circle.x)<Vr&&Math.abs(i-p.circle.cy)<Vr;)l=p.N,s.push(p),HC(p),p=l;s.push(p),Tm(p);var y=s.length,v;for(v=1;v<y;++v)p=s[v],d=s[v-1],i2(p.edge,d.site,p.site,r);d=s[0],p=s[y-1],p.edge=g0(d.site,p.site,null,r),sm(d),sm(p)}function PRe(t){for(var e=t[0],n=t[1],i,r,o,l,s=Sm._;s;)if(o=i$(s,n)-e,o>Vr)s=s.L;else if(l=e-IRe(s,n),l>Vr){if(!s.R){i=s;break}s=s.R}else{o>-Vr?(i=s.P,r=s):l>-Vr?(i=s,r=s.N):i=r=s;break}bRe(t);var d=K8(t);if(Sm.insert(i,d),!(!i&&!r)){if(i===r){Tm(i),r=K8(i.site),Sm.insert(d,r),d.edge=r.edge=g0(i.site,d.site),sm(i),sm(r);return}if(!r){d.edge=g0(i.site,d.site);return}Tm(i),Tm(r);var p=i.site,y=p[0],v=p[1],w=t[0]-y,T=t[1]-v,I=r.site,L=I[0]-y,k=I[1]-v,F=2*(w*k-T*L),B=w*w+T*T,G=L*L+k*k,U=[(k*B-T*G)/F+y,(w*G-L*B)/F+v];i2(r.edge,p,I,U),d.edge=g0(p,t,null,U),r.edge=g0(t,I,null,U),sm(i),sm(r)}}function i$(t,e){var n=t.site,i=n[0],r=n[1],o=r-e;if(!o)return i;var l=t.P;if(!l)return-1/0;n=l.site;var s=n[0],d=n[1],p=d-e;if(!p)return s;var y=s-i,v=1/o-1/p,w=y/p;return v?(-w+Math.sqrt(w*w-2*v*(y*y/(-2*p)-d+p/2+r-o/2)))/v+i:(i+s)/2}function IRe(t,e){var n=t.N;if(n)return i$(n,e);var i=t.site;return i[1]===e?i[0]:1/0}var Vr=1e-6,MRe=1e-12,Sm,xa,e_,fs;function RRe(t,e,n){return(t[0]-n[0])*(e[1]-t[1])-(t[0]-e[0])*(n[1]-t[1])}function LRe(t,e){return e[1]-t[1]||e[0]-t[0]}function X8(t,e){var n=t.sort(LRe).pop(),i,r,o;for(fs=[],xa=new Array(t.length),Sm=new n2,e_=new n2;;)if(o=aR,n&&(!o||n[1]<o.y||n[1]===o.y&&n[0]<o.x))(n[0]!==i||n[1]!==r)&&(PRe(n),i=n[0],r=n[1]),n=t.pop();else if(o)ARe(o.arc);else break;if(ERe(),e){var l=+e[0][0],s=+e[0][1],d=+e[1][0],p=+e[1][1];_Re(l,s,d,p),TRe(l,s,d,p)}this.edges=fs,this.cells=xa,Sm=e_=fs=xa=null}X8.prototype={constructor:X8,polygons:function(){var t=this.edges;return this.cells.map(function(e){var n=e.halfedges.map(function(i){return e$(e,t[i])});return n.data=e.site.data,n})},triangles:function(){var t=[],e=this.edges;return this.cells.forEach(function(n,i){if(s=(o=n.halfedges).length)for(var r=n.site,o,l=-1,s,d,p=e[o[s-1]],y=p.left===r?p.right:p.left;++l<s;)d=y,p=e[o[l]],y=p.left===r?p.right:p.left,d&&y&&i<d.index&&i<y.index&&RRe(r,d,y)<0&&t.push([r.data,d.data,y.data])}),t},links:function(){return this.edges.filter(function(t){return t.right}).map(function(t){return{source:t.left.data,target:t.right.data}})},find:function(t,e,n){for(var i=this,r,o=i._found||0,l=i.cells.length,s;!(s=i.cells[o]);)if(++o>=l)return null;var d=t-s.site[0],p=e-s.site[1],y=d*d+p*p;do s=i.cells[r=o],o=null,s.halfedges.forEach(function(v){var w=i.edges[v],T=w.left;if(!((T===s.site||!T)&&!(T=w.right))){var I=t-T[0],L=e-T[1],k=I*I+L*L;k<y&&(y=k,o=T.index)}});while(o!==null);return i._found=r,n==null||y<=n*n?s.site:null}};function y0(t,e,n){this.k=t,this.x=e,this.y=n}y0.prototype={constructor:y0,scale:function(t){return t===1?this:new y0(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new y0(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};y0.prototype;var ORe=1e-9;function DRe(t,e){var n=t||2,i=e||2,r=Kd(),o=Kd(),l=d();function s(p,y){for(var v=y??p.u,w=y!=null?p:p.v,T=0;T<l.length-1&&r(v)<1-(T+1)/i-ORe;)T++;for(var I=l[T].length>1?(l[T][1].v-l[T][0].v)/2:0,L=0;L<l[T].length-1&&w>l[T][L].v+I;)L++;return l[T][L]}function d(){var p=[],y;o.nice(Math.pow(n,i-1)),r.nice(i),p[0]=[],p[0].push({u:r.invert((i-1)/i),v:o.invert(.5)});for(var v=1;v<i;v++){p[v]=[],y=2*Math.pow(n,v);for(var w=1;w<y;w+=2)p[v].push({u:r.invert(1-(v+1)/i),v:o.invert(w/y)})}return p}return s.range=function(){return[].concat.apply([],l)},s.tree=function(){return l},s.data=s.tree,s.branching=function(p){return arguments.length?(n=Math.max(1,p),l=d(),s):n},s.layers=function(p){return arguments.length?(i=Math.max(1,p),l=d(),s):i},s.uncertaintyDomain=function(p){return arguments.length?(r.domain(p),l=d(),s):r.domain()},s.valueDomain=function(p){return arguments.length?(o.domain(p),l=d(),s):o.domain()},s}function kRe(t,e,n){var i=e||gRe,r=n||function(d,p){var y=p!=null?{v:d,u:p}:{v:d.v,u:d.u};return y},o=t;function l(d,p){var y=Jv(su(d)),v=Jv(su(p));return Math.sqrt(Math.pow(y.l-v.l,2)+Math.pow(y.a-v.a,2)+Math.pow(y.b-v.b,2))}function s(d,p){var y=r(d,p),v=[0,1],w=[0,1];r.uncertaintyDomain&&(v=r.uncertaintyDomain()),r.valueDomain&&(w=r.valueDomain());var T=Kd().domain(v).range([0,1]),I=Kd().domain(w).range([0,1]),L=i(I(y.v));switch(o){case"usl":default:L=FMe(L,"#fff")(T(y.u));break;case"us":L=fI(L);var k=Kd().domain([0,1]).range([L.s,0]);L.s=k(T(y.u));break;case"ul":L=fI(L);var F=Kd().domain([0,1]).range([L.l,1]);L.l=F(T(y.u));break}return L}return s.colorList=function(){return this.quantize().range().map(function(d){return s(d)})},s.colorDists=function(){for(var d=this.colorList(),p=new Array(d.length),y,v=new Array(2),w,T=0;T<p.length;T++){p[T]=new Array(d.length);for(var I=0;I<p[T].length;I++)w=l(d[T],d[I]),p[T][I]=w,T!=I&&(T==0&&I==1||w<y)&&(y=w,v=[d[T],d[I]])}return p.minDist=y,p.minPair=v,p},s.mode=function(d){return arguments.length?(o=d,s):o},s.range=function(d){return arguments.length?(i=d,s):i},s.quantize=function(d){return arguments.length?(r=d,s):r},s}const ds={DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,FUNC_ADD:32774,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,BLEND_COLOR:32773,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,VENDOR:7936,RENDERER:7937,VERSION:7938,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,BROWSER_DEFAULT_WEBGL:37444,STATIC_DRAW:35044,STREAM_DRAW:35040,DYNAMIC_DRAW:35048,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,CULL_FACE:2884,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,BLEND:3042,DEPTH_TEST:2929,DITHER:3024,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,SCISSOR_TEST:3089,STENCIL_TEST:2960,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CONTEXT_LOST_WEBGL:37442,CW:2304,CCW:2305,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,COMPILE_STATUS:35713,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_ATTRIBUTES:35721,ACTIVE_UNIFORMS:35718,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,ALWAYS:519,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,GEQUAL:518,NOTEQUAL:517,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,TEXTURE_WIDTH:4096,TEXTURE_HEIGHT:4097,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,MAX_3D_TEXTURE_SIZE:32883,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,MAX_TEXTURE_LOD_BIAS:34045,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,RASTERIZER_DISCARD:35977,VERTEX_ARRAY_BINDING:34229,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,MAX_ELEMENT_INDEX:36203,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,RGB9_E5:35901,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,RGB10_A2UI:36975,TEXTURE_IMMUTABLE_FORMAT:37167,TEXTURE_IMMUTABLE_LEVELS:33503,UNSIGNED_INT_2_10_10_10_REV:33640,UNSIGNED_INT_10F_11F_11F_REV:35899,UNSIGNED_INT_5_9_9_9_REV:35902,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,UNSIGNED_INT_24_8:34042,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,INT_2_10_10_10_REV:36255,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,MAX_SAMPLES:36183,SAMPLER_BINDING:35097,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,UNSIGNED_NORMALIZED:35863,SIGNED_NORMALIZED:36764,VERTEX_ATTRIB_ARRAY_INTEGER:35069,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,DEPTH24_STENCIL8:35056,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,COLOR:6144,DEPTH:6145,STENCIL:6146,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,INVALID_INDEX:4294967295,TIMEOUT_IGNORED:-1,MAX_CLIENT_WAIT_TIMEOUT_WEBGL:37447,VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,UNMASKED_VENDOR_WEBGL:37445,UNMASKED_RENDERER_WEBGL:37446,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047,TEXTURE_MAX_ANISOTROPY_EXT:34046,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35986,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,UNSIGNED_INT_24_8_WEBGL:34042,HALF_FLOAT_OES:36193,RGBA32F_EXT:34836,RGB32F_EXT:34837,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT:33297,UNSIGNED_NORMALIZED_EXT:35863,MIN_EXT:32775,MAX_EXT:32776,SRGB_EXT:35904,SRGB_ALPHA_EXT:35906,SRGB8_ALPHA8_EXT:35907,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT:33296,FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723,COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067,COLOR_ATTACHMENT4_WEBGL:36068,COLOR_ATTACHMENT5_WEBGL:36069,COLOR_ATTACHMENT6_WEBGL:36070,COLOR_ATTACHMENT7_WEBGL:36071,COLOR_ATTACHMENT8_WEBGL:36072,COLOR_ATTACHMENT9_WEBGL:36073,COLOR_ATTACHMENT10_WEBGL:36074,COLOR_ATTACHMENT11_WEBGL:36075,COLOR_ATTACHMENT12_WEBGL:36076,COLOR_ATTACHMENT13_WEBGL:36077,COLOR_ATTACHMENT14_WEBGL:36078,COLOR_ATTACHMENT15_WEBGL:36079,DRAW_BUFFER0_WEBGL:34853,DRAW_BUFFER1_WEBGL:34854,DRAW_BUFFER2_WEBGL:34855,DRAW_BUFFER3_WEBGL:34856,DRAW_BUFFER4_WEBGL:34857,DRAW_BUFFER5_WEBGL:34858,DRAW_BUFFER6_WEBGL:34859,DRAW_BUFFER7_WEBGL:34860,DRAW_BUFFER8_WEBGL:34861,DRAW_BUFFER9_WEBGL:34862,DRAW_BUFFER10_WEBGL:34863,DRAW_BUFFER11_WEBGL:34864,DRAW_BUFFER12_WEBGL:34865,DRAW_BUFFER13_WEBGL:34866,DRAW_BUFFER14_WEBGL:34867,DRAW_BUFFER15_WEBGL:34868,MAX_COLOR_ATTACHMENTS_WEBGL:36063,MAX_DRAW_BUFFERS_WEBGL:34852,VERTEX_ARRAY_BINDING_OES:34229,QUERY_COUNTER_BITS_EXT:34916,CURRENT_QUERY_EXT:34917,QUERY_RESULT_EXT:34918,QUERY_RESULT_AVAILABLE_EXT:34919,TIME_ELAPSED_EXT:35007,TIMESTAMP_EXT:36392,GPU_DISJOINT_EXT:36795};class FRe{constructor(e){this.fireID=e,this.perimeterData=[],this.frpData=null,this.hasWindData=!0;const n=Rs().getPerimeterData(e);let i=this.standardizeTemporalResolution(n,12),r=i.length;this.timeScale=Qd().domain([new Date(i[0].perimeter_date),new Date(i[r-1].perimeter_date)]).range([0,1]),i.slice(0,-1).forEach((d,p)=>{let y=new Date(d.perimeter_date);this.perimeterData.push({path:d.perimeter,startTime:this.timeScale(y),endTime:this.timeScale(new Date(i[p+1].perimeter_date)),timeString:y.toLocaleString("ja-JP").slice(5,9),time:y})}),this.smoothPerimeter(this.perimeterData);const o=Rs().getData(e,"frp"),[l,s]=this.formattedHeatMapCollection(o,this.timeScale);this.frpData=l}standardizeTemporalResolution(e,n){let i=[e[0]],r=e[0].perimeter_date;return e.forEach(o=>{new Date(new Date(o.perimeter_date)-new Date(r))/36e5*.9>n&&(i.push(o),r=o.perimeter_date)}),i}smoothPerimeter(e){function n(r,o){return(r%o+o)%o}let i=JSON.parse(JSON.stringify(e));for(let r=0;r<e.length;r++){let o=i[r].path;e[r].smoothed_path=JSON.parse(JSON.stringify(i[r].path)),o.pop();let l=e[r].path.length/1e3,s=-1.66*l*l+20.02*l+6.64;s=Math.round(s);for(let d=0;d<o.length;d++){let p=o[d][0],y=o[d][1];for(let v=0;v<s;v++)p+=o[n(d+v,o.length)][0],y+=o[n(d+v,o.length)][1],p+=o[n(d-v,o.length)][0],y+=o[n(d-v,o.length)][1];e[r].smoothed_path[d]=[p/(s*2+1),y/(s*2+1)]}e[r].smoothed_path[e[r].smoothed_path.length-1]=e[r].smoothed_path[0]}}formattedHeatMapCollection(e,n){let i=[],r=Va(e.map(p=>parseFloat(p.power))),o=DRe().branching(2).layers(4).valueDomain(r).uncertaintyDomain([0,100]),l=kRe().quantize(o).range(DP),s=jc().domain(Va(e.map(p=>parseFloat(p.power)))).range(["white","red"]),d=jc().domain(Va(e.map(p=>parseFloat(p.power)))).range([0,1]);return Va(e.map(p=>p.power)),e.forEach(p=>{let y=DP(d(parseFloat(p.power))).replace(/[^\d,]/g,"").split(",").map(T=>Number(T)),v=l(parseFloat(p.power),100-parseFloat(p.processed_confidence)).replace(/[^\d,]/g,"").split(",").map(T=>Number(T));y.push(255),v.push(255);let w={coordinate:[p.centroid[0],p.centroid[1]],processed_confidence:p.processed_confidence,power:parseFloat(p.power),color_gridcell:y,color_heatm:v,time:n(new Date(p.date))};i.push(w)}),[i,s]}prepareWindParticleLayer(){const e=Rs().getData(this.fireID,"wind"),n=e.length,i=e[0].nGridX,r=e[0].nGridY;if(e[0].weather_variables.length==0){this.hasWindData=!1;return}let o={width:i*n,height:r,type:ds.UNSIGNED_BYTE,data:null,format:ds.RGBA,dataFormat:ds.RGBA,parameters:{[ds.TEXTURE_MAG_FILTER]:ds.NEAREST,[ds.TEXTURE_MIN_FILTER]:ds.NEAREST},pixelStore:{[ds.UNPACK_FLIP_Y_WEBGL]:!0}},l={width:i*n,height:r,type:ds.UNSIGNED_BYTE,data:null,format:ds.RGBA,dataFormat:ds.RGBA,parameters:{[ds.TEXTURE_MAG_FILTER]:ds.NEAREST,[ds.TEXTURE_MIN_FILTER]:ds.NEAREST},pixelStore:{[ds.UNPACK_FLIP_Y_WEBGL]:!0}},s=[],d=[],p=[];e.forEach(k=>{s=s.concat(k.grids.wind_speed),d=d.concat(k.grids.air_temp),p=p.concat(k.grids.relative_humidity)}),console.log("extent",Va(s));const y=jc().domain(Va(s)).range([.3,1]),v=jc().domain([20,40]).range([0,255]),w=jc().domain([0,100]).range([0,255]);let T=[],I=[];for(let k=0;k<r;k++)for(let F=0;F<n;F++)for(let B=0;B<i;B++){let G=k*i+B,U=y(e[F].grids.wind_speed[G]);T.push(Math.sin(e[F].grids.wind_direction[G]*(Math.PI/180))*U*128+128),T.push(Math.cos(e[F].grids.wind_direction[G]*(Math.PI/180))*U*128+128),T.push(0),T.push(255),I.push(v(e[F].grids.air_temp[G])),I.push(w(e[F].grids.relative_humidity[G])),I.push(0),I.push(255)}o.data=new Uint8Array([...T]),l.data=new Uint8Array([...I]);const L=[e[0].bounds[0][0],e[0].bounds[0][1],e[0].bounds[2][0],e[0].bounds[1][1]];this.coolwarmReds=[.2298057,.26623388,.30386891,.342804478,.38301334,.424369608,.46666708,.509635204,.552953156,.596262162,.639176211,.681291281,.722193294,.761464949,.798691636,.833466556,.865395197,.897787179,.924127593,.944468518,.958852946,.96732803,.969954137,.966811177,.958003065,.943660866,.923944917,.89904617,.869186849,.834620542,.795631745,.752534934,.705673158],this.coolwarmBlues=[.753683153,.801466763,.84495867,.883725899,.917387822,.945619588,.968154911,.98478814,.995375608,.999836203,.998151185,.990363227,.976574709,.956945269,.931688648,.901068838,.865395561,.820880546,.774508472,.726736146,.678007945,.628751763,.579375448,.530263762,.481775914,.434243684,.387970225,.343229596,.300267182,.259301199,.220525627,.184115123,.150232812],this.coolwarmGreens=[.298717966,.353094838,.406535296,.458757618,.50941904,.558148092,.604562568,.648280772,.688929332,.726149107,.759599947,.788964712,.813952739,.834302879,.849786142,.860207984,.86541021,.848937047,.827384882,.800927443,.769767752,.734132809,.694266682,.650421156,.602842431,.551750968,.49730856,.439559467,.378313092,.312874446,.24128379,.157246067,.01555616],this.windParticleTextureData=o,this.windParticleTextureDataTempHumidity=l,this.windParticleBounds=L}getAnimatedProps(){let e={};return e={...e,AnimatedPath:{id:"Perimeter",data:this.perimeterData,getWidth:n=>200,radiusPixels:100,getColor:n=>[255,0,0,255],positionFormat:"XY",pointDuration:.05,getStartTime:n=>n.startTime,getEndTime:n=>n.endTime,getNorm:n=>n.normals,getSpread:n=>n.spread,pickable:!0,parameters:{depthTest:!1}}},e={...e,AnimatedGridCell:{id:"Satellite_1",data:this.frpData,getPosition:n=>n.coordinate,getElevation:n=>n.power,getFillColor:n=>n.color_gridcell,getTime:n=>n.time,getConfidence:n=>parseFloat(n.processed_confidence),evalationScale:100,cellSize:400,parameters:{depthTest:!0},pickable:!0}},this.hasWindData&&(e={...e,AnimatedWind:{id:"Wind_Particle",image:this.windParticleTextureData,tempHumidityImage:this.windParticleTextureDataTempHumidity,coolwarmBlues:this.coolwarmBlues,coolwarmGreens:this.coolwarmGreens,coolwarmReds:this.coolwarmReds,colorSetting:0,imageUnscale:[-50,50],bounds:this.windParticleBounds,numParticles:1e3,maxAge:10,speedFactor:50,color:[0,0,0],width:2,opacity:1}}),e}}class BRe{constructor(e,n,i,r){e!==void 0&&(this.url=e),this.attrs=n,this.name=i,this.data=r,this.useDataStore=Rs()}validateError(e){}create(e,n="PLACEHOLDER"){if(this.name=="OverviewClusters"){const i=this.formatOverviewClustersGeoJSON();return new Gc({id:this.name,data:i,opacity:.75,visible:e,pickable:!0,getFillColor:o=>{let l=this.burnScale(Number(o.properties.max)).replace(/[^\d,]/g,"").split(",").map(s=>Number(s));return l.push(255),l},onHover:o=>{console.log(o)},...this.attrs})}else if(this.name=="Roads"){const i=this.useDataStore.getData(n,"roads");this.data=i;const r=this.formatRoadsGeoJSON();return new Gc({id:this.name,data:r,visible:e,getLineWidth:100,getLineColor:[0,0,0,155],parameters:{depthTest:!1}})}else throw new Error("Layer name not recognized")}formatOverviewClustersGeoJSON(){let e={type:"FeatureCollection",features:[]};const n=this.data.map(i=>Number(i.max));return this.data.forEach(i=>{let r={type:"Feature",properties:{max:i.max,maxdate:i.maxdate,mindate:i.mindate},geometry:i.hull};e.features.push(r)}),this.burnScale=jc().domain(Va(n)).range(["white","orange"]),e}formatRoadsGeoJSON(){let e={type:"FeatureCollection",features:[]},n=[];this.data.forEach(r=>{n.push(r.coordinates[0])});let i={type:"Feature",geometry:{type:"MultiLineString",coordinates:n}};return e.features.push(i),e}}class lR extends D_{initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({startTime:{size:1,accessor:"getStartTime"},endTime:{size:1,accessor:"getEndTime"}})}getShaders(){return{...super.getShaders(),inject:{"vs:#decl":`
                attribute float startTime;
                attribute float endTime;
                attribute float spread;
                attribute vec2 normals;

                uniform float animationProgress;
                varying float instanceAnimationProgress;
                varying float done;
                // varying float o_x_norm;
                // varying float o_y_norm;
                // varying float o_spread;

                float getInstanceAnimationProgress(float animationProgress){
                    return abs(clamp((animationProgress - startTime) / (endTime - startTime), 0.0, 1.0) * 2. - 1.) * -1. + 1.;
                }

                float getDone(float animationProgress){
                    if (animationProgress > endTime) { return 1.; } else { return 0.; }
                }
                `,"vs:#main-end":`
                instanceAnimationProgress = getInstanceAnimationProgress(animationProgress);
                done = getDone(animationProgress);
                // o_x_norm = normals.x;
                // o_y_norm = normals.y;
                // o_spread = spread;
                `,"fs:#decl":`
                varying float instanceAnimationProgress;
                varying float done;
                // varying float o_x_norm;
                // varying float o_y_norm;
                // varying float o_spread;
                `,"fs:#main-end":`
                // gl_FragColor = vec4(gl_FragColor.xyx*instanceAnimationProgress, 1.0);

                vec3 RED = vec3(1,0,0);
                vec3 GREEN = vec3(0,1,0);

                if (done == 1.) {
                // if (o_spread == 0.) {
                    gl_FragColor = vec4(0.8, 0.8, 0.8, 1.);
                    // discard;
                }
                else {
                    // gl_FragColor = vec4(1, 0, 0, instanceAnimationProgress);
                    // gl_FragColor = vec4(o_x_norm/2. + 0.5, (o_y_norm/2. + 0.5), 0, 1.);
                    // gl_FragColor = vec4(clamp(o_spread*8., 0., 1.), 0, 0, instanceAnimationProgress);
                    gl_FragColor = vec4(0.2, 0.2, 0.2, instanceAnimationProgress);
                    // gl_FragColor = vec4(o_x_norm/2. + 0.5, 0, 0, 1.);
                    // gl_FragColor = vec4(mix(RED, GREEN, o_y_norm/2. + 0.5), 1.0);
                    // gl_FragColor = vec4(o_y_norm/2. + 0.5, 0, 0, 1.0);
                    // gl_FragColor = vec4(o_x_norm/2. + 0.5, 0, 0, 1.0);
                    // gl_FragColor = vec4(1.0, 0, 0,o_x_norm/2. + 0.5);
                }
                // gl_FragColor = vec4(0, 0, 0, 1.0);
                // DECKGL_FILTER_COLOR(gl_FragColor, geometry);
                `}}}draw(e){const{animationProgress:n=0,animationDuration:i=0}=this.props,r={...e.uniforms,animationProgress:n,animationDuration:i};super.draw({...e,uniforms:r})}}const zRe={};lR.layerName="AnimatedPathLayer";lR.defaultProps={...D_.defaultProps,...zRe};class r$ extends q2{initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({time:{size:1,accessor:"getTime"},confidence:{size:1,accessor:"getConfidence"}})}getShaders(){return{...super.getShaders(),inject:{"vs:#decl":`
                attribute float time;
                attribute float confidence;

                // Should probably scale the elevationScale here
                uniform float animationProgress;
                varying float instanceAnimationProgress;

                float getInstanceAnimationProgress(float animationProgress, float time){
                    float temp = abs(animationProgress - time);
                    // float temp = animationProgress - time;
                    // temp = temp / 0.3;
                    temp = temp / 0.05;
                    temp = 1. - clamp(temp, 0.0, 1.0);
                    return temp;

                    // return abs(clamp((animationProgress - startTime) / (endTime - startTime), 0.0, 1.0) * 2. - 1.) * -1. + 1.;
                }
                `,"vs:#main-start":`
                instanceAnimationProgress = getInstanceAnimationProgress(animationProgress, time);
                // elevationScale = elevationScale * instanceAnimationProgress;

                `,"vs:DECKGL_FILTER_SIZE":`
                size.x *= confidence / 100.;
                size.y *= confidence / 100.;
                `,"vs:#main-end":`
                centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation * instanceAnimationProgress);
                centroidPosition64Low = instancePositions64Low;
                gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);
                `,"fs:#decl":`
                varying float instanceAnimationProgress;
                `,"fs:#main-start":`
                if (instanceAnimationProgress == 0.){
                    discard;
                }
                `}}}draw(e){const{animationProgress:n=0,animationDuration:i=0}=this.props,r={...e.uniforms,animationProgress:n,animationDuration:i};super.draw({...e,uniforms:r})}}const NRe={};r$.defaultProps={...q2.defaultProps,...NRe};const URe=[[255,255,178],[254,217,118],[254,178,76],[253,141,60],[240,59,32],[189,0,38]];function VRe(t,e=!1,n=Float32Array){let i;if(Number.isFinite(t[0]))i=new n(t);else{i=new n(t.length*4);let r=0;for(let o=0;o<t.length;o++){const l=t[o];i[r++]=l[0],i[r++]=l[1],i[r++]=l[2],i[r++]=Number.isFinite(l[3])?l[3]:255}}if(e)for(let r=0;r<i.length;r++)i[r]/=255;return i}function jRe(t,e){const n={};for(const i in t)e.includes(i)||(n[i]=t[i]);return n}class o$ extends C_{constructor(...e){super(...e),q(this,"state",void 0)}initializeAggregationLayer(e){super.initializeState(this.context),this.setState({ignoreProps:jRe(this.constructor._propTypes,e.data.props),dimensions:e})}updateState(e){super.updateState(e);const{changeFlags:n}=e;if(n.extensionsChanged){const i=this.getShaders({});i&&i.defines&&(i.defines.NON_INSTANCED_MODEL=1),this.updateShaders(i)}this._updateAttributes()}updateAttributes(e){this.setState({changedAttributes:e})}getAttributes(){return this.getAttributeManager().getShaderAttributes()}getModuleSettings(){const{viewport:e,mousePosition:n,gl:i}=this.context;return Object.assign(Object.create(this.props),{viewport:e,mousePosition:n,pickingActive:0,devicePixelRatio:cf(i)})}updateShaders(e){}isAggregationDirty(e,n={}){const{props:i,oldProps:r,changeFlags:o}=e,{compareAll:l=!1,dimension:s}=n,{ignoreProps:d}=this.state,{props:p,accessors:y=[]}=s,{updateTriggersChanged:v}=o;if(o.dataChanged)return!0;if(v){if(v.all)return!0;for(const w of y)if(v[w])return!0}if(l)return o.extensionsChanged?!0:QM({oldProps:r,newProps:i,ignoreProps:d,propTypes:this.constructor._propTypes});for(const w of p)if(i[w]!==r[w])return!0;return!1}isAttributeChanged(e){const{changedAttributes:n}=this.state;return e?n&&n[e]!==void 0:!$Re(n)}_getAttributeManager(){return new JM(this.context.gl,{id:this.props.id,stats:this.context.stats})}}q(o$,"layerName","AggregationLayer");function $Re(t){let e=!0;for(const n in t){e=!1;break}return e}function GRe(t){const e=t.map(s=>s[0]),n=t.map(s=>s[1]),i=Math.min.apply(null,e),r=Math.max.apply(null,e),o=Math.min.apply(null,n),l=Math.max.apply(null,n);return[i,o,r,l]}function HRe(t,e){return e[0]>=t[0]&&e[2]<=t[2]&&e[1]>=t[1]&&e[3]<=t[3]}const Z8=new Float32Array(12);function q8(t,e=2){let n=0;for(const i of t)for(let r=0;r<e;r++)Z8[n++]=i[r]||0;return Z8}function WRe(t,e,n){const[i,r,o,l]=t,s=o-i,d=l-r;let p=s,y=d;s/d<e/n?p=e/n*d:y=n/e*s,p<e&&(p=e,y=n);const v=(o+i)/2,w=(l+r)/2;return[v-p/2,w-y/2,v+p/2,w+y/2]}function KRe(t,e){const[n,i,r,o]=e;return[(t[0]-n)/(r-n),(t[1]-i)/(o-i)]}function XRe({gl:t,floatTargetSupport:e}){return e?{format:bi(t)?34836:6408,type:5126}:{format:6408,type:5121}}const ZRe=`#define SHADER_NAME heatp-map-layer-vertex-shader

uniform sampler2D maxTexture;
uniform float intensity;
uniform vec2 colorDomain;
uniform float threshold;
uniform float aggregationMode;

attribute vec3 positions;
attribute vec2 texCoords;

varying vec2 vTexCoords;
varying float vIntensityMin;
varying float vIntensityMax;

void main(void) {
  gl_Position = project_position_to_clipspace(positions, vec3(0.0), vec3(0.0));
  vTexCoords = texCoords;
  vec4 maxTexture = texture2D(maxTexture, vec2(0.5));
  float maxValue = aggregationMode < 0.5 ? maxTexture.r : maxTexture.g;
  float minValue = maxValue * threshold;
  if (colorDomain[1] > 0.) {
    maxValue = colorDomain[1];
    minValue = colorDomain[0];
  }
  vIntensityMax = intensity / maxValue;
  vIntensityMin = intensity / minValue;
}
`,qRe=`#define SHADER_NAME triangle-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D texture;
uniform sampler2D colorTexture;
uniform float aggregationMode;

varying vec2 vTexCoords;
varying float vIntensityMin;
varying float vIntensityMax;

vec4 getLinearColor(float value) {
  float factor = clamp(value * vIntensityMax, 0., 1.);
  vec4 color = texture2D(colorTexture, vec2(factor, 0.5));
  color.a *= min(value * vIntensityMin, 1.0);
  return color;
}

void main(void) {
  vec4 weights = texture2D(texture, vTexCoords);
  float weight = weights.r;

  if (aggregationMode > 0.5) {
    weight /= max(1.0, weights.a);
  }
  if (weight <= 0.) {
     discard;
  }

  vec4 linearColor = getLinearColor(weight);
  linearColor.a *= opacity;
  gl_FragColor =linearColor;
}
`;class s$ extends Ka{getShaders(){return{vs:ZRe,fs:qRe,modules:[pu]}}initializeState({gl:e}){this.getAttributeManager().add({positions:{size:3,noAlloc:!0},texCoords:{size:2,noAlloc:!0}}),this.setState({model:this._getModel(e)})}_getModel(e){const{vertexCount:n}=this.props;return new Il(e,{...this.getShaders(),id:this.props.id,geometry:new gc({drawMode:6,vertexCount:n})})}draw({uniforms:e}){const{model:n}=this.state,{texture:i,maxTexture:r,colorTexture:o,intensity:l,threshold:s,aggregationMode:d,colorDomain:p}=this.props;n.setUniforms({...e,texture:i,maxTexture:r,colorTexture:o,intensity:l,threshold:s,aggregationMode:d,colorDomain:p}).draw()}}q(s$,"layerName","TriangleLayer");const YRe=`attribute vec3 positions;
attribute vec3 positions64Low;
attribute float weights;
varying vec4 weightsTexture;
uniform float radiusPixels;
uniform float textureWidth;
uniform vec4 commonBounds;
uniform float weightsScale;
void main()
{
  weightsTexture = vec4(weights * weightsScale, 0., 0., 1.);

  float radiusTexels  = project_pixel_size(radiusPixels) * textureWidth / (commonBounds.z - commonBounds.x);
  gl_PointSize = radiusTexels * 2.;

  vec3 commonPosition = project_position(positions, positions64Low);
  gl_Position.xy = (commonPosition.xy - commonBounds.xy) / (commonBounds.zw - commonBounds.xy) ;
  gl_Position.xy = (gl_Position.xy * 2.) - (1.);
}
`,JRe=`varying vec4 weightsTexture;
float gaussianKDE(float u){
  return pow(2.71828, -u*u/0.05555)/(1.77245385*0.166666);
}
void main()
{
  float dist = length(gl_PointCoord - vec2(0.5, 0.5));
  if (dist > 0.5) {
    discard;
  }
  gl_FragColor = weightsTexture * gaussianKDE(2. * dist);
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,QRe=`attribute vec4 inTexture;
varying vec4 outTexture;

void main()
{
outTexture = inTexture;
gl_Position = vec4(0, 0, 0, 1.);
gl_PointSize = 1.0;
}
`,eLe=`varying vec4 outTexture;
void main() {
  gl_FragColor = outTexture;
  gl_FragColor.g = outTexture.r / max(1.0, outTexture.a);
}
`,tLe=2,WC={mipmaps:!1,parameters:{10240:9729,10241:9729,10242:33071,10243:33071},dataFormat:6408},Y8=[0,0],nLe={SUM:0,MEAN:1},iLe={getPosition:{type:"accessor",value:t=>t.position},getWeight:{type:"accessor",value:1},intensity:{type:"number",min:0,value:1},radiusPixels:{type:"number",min:1,max:100,value:50},colorRange:URe,threshold:{type:"number",min:0,max:1,value:.05},colorDomain:{type:"array",value:null,optional:!0},aggregation:"SUM",weightsTextureSize:{type:"number",min:128,max:2048,value:2048},debounceTimeout:{type:"number",min:0,max:1e3,value:500}},rLe=[cr.BLEND_EQUATION_MINMAX,cr.TEXTURE_FLOAT],oLe=[cr.COLOR_ATTACHMENT_RGBA32F,cr.FLOAT_BLEND],sLe={data:{props:["radiusPixels"]}};class cE extends o${constructor(...e){super(...e),q(this,"state",void 0)}initializeState(){const{gl:e}=this.context;if(!yv(e,rLe)){this.setState({supported:!1}),Ti.error("HeatmapLayer: ".concat(this.id," is not supported on this browser"))();return}super.initializeAggregationLayer(sLe),this.setState({supported:!0,colorDomain:Y8}),this._setupTextureParams(),this._setupAttributes(),this._setupResources()}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState(e){this.state.supported&&(super.updateState(e),this._updateHeatmapState(e))}_updateHeatmapState(e){const{props:n,oldProps:i}=e,r=this._getChangeFlags(e);(r.dataChanged||r.viewportChanged)&&(r.boundsChanged=this._updateBounds(r.dataChanged),this._updateTextureRenderingBounds()),r.dataChanged||r.boundsChanged?(clearTimeout(this.state.updateTimer),this.setState({isWeightMapDirty:!0})):r.viewportZoomChanged&&this._debouncedUpdateWeightmap(),n.colorRange!==i.colorRange&&this._updateColorTexture(e),this.state.isWeightMapDirty&&this._updateWeightmap(),this.setState({zoom:e.context.viewport.zoom})}renderLayers(){if(!this.state.supported)return[];const{weightsTexture:e,triPositionBuffer:n,triTexCoordBuffer:i,maxWeightsTexture:r,colorTexture:o,colorDomain:l}=this.state,{updateTriggers:s,intensity:d,threshold:p,aggregation:y}=this.props,v=this.getSubLayerClass("triangle",s$);return new v(this.getSubLayerProps({id:"triangle-layer",updateTriggers:s}),{coordinateSystem:Li.DEFAULT,data:{attributes:{positions:n,texCoords:i}},vertexCount:4,maxTexture:r,colorTexture:o,aggregationMode:nLe[y]||0,texture:e,intensity:d,threshold:p,colorDomain:l})}finalizeState(e){super.finalizeState(e);const{weightsTransform:n,weightsTexture:i,maxWeightTransform:r,maxWeightsTexture:o,triPositionBuffer:l,triTexCoordBuffer:s,colorTexture:d,updateTimer:p}=this.state;n==null||n.delete(),i==null||i.delete(),r==null||r.delete(),o==null||o.delete(),l==null||l.delete(),s==null||s.delete(),d==null||d.delete(),p&&clearTimeout(p)}_getAttributeManager(){return new JM(this.context.gl,{id:this.props.id,stats:this.context.stats})}_getChangeFlags(e){const n={},{dimensions:i}=this.state;n.dataChanged=this.isAttributeChanged()||this.isAggregationDirty(e,{compareAll:!0,dimension:i.data}),n.viewportChanged=e.changeFlags.viewportChanged;const{zoom:r}=this.state;return(!e.context.viewport||e.context.viewport.zoom!==r)&&(n.viewportZoomChanged=!0),n}_createTextures(){const{gl:e}=this.context,{textureSize:n,format:i,type:r}=this.state;this.setState({weightsTexture:new ws(e,{width:n,height:n,format:i,type:r,...WC}),maxWeightsTexture:new ws(e,{format:i,type:r,...WC})})}_setupAttributes(){this.getAttributeManager().add({positions:{size:3,type:5130,accessor:"getPosition"},weights:{size:1,accessor:"getWeight"}}),this.setState({positionAttributeName:"positions"})}_setupTextureParams(){const{gl:e}=this.context,{weightsTextureSize:n}=this.props,i=Math.min(n,b9(e,3379)),r=yv(e,oLe),{format:o,type:l}=XRe({gl:e,floatTargetSupport:r}),s=r?1:1/255;this.setState({textureSize:i,format:o,type:l,weightsScale:s}),r||Ti.warn("HeatmapLayer: ".concat(this.id," rendering to float texture not supported, fallingback to low precession format"))()}getShaders(e){return super.getShaders(e==="max-weights-transform"?{vs:QRe,_fs:eLe}:{vs:YRe,_fs:JRe})}_createWeightsTransform(e={}){var n;const{gl:i}=this.context;let{weightsTransform:r}=this.state;const{weightsTexture:o}=this.state;(n=r)===null||n===void 0||n.delete(),r=new Bm(i,{id:"".concat(this.id,"-weights-transform"),elementCount:1,_targetTexture:o,_targetTextureVarying:"weightsTexture",...e}),this.setState({weightsTransform:r})}_setupResources(){const{gl:e}=this.context;this._createTextures();const{textureSize:n,weightsTexture:i,maxWeightsTexture:r}=this.state,o=this.getShaders("weights-transform");this._createWeightsTransform(o);const l=this.getShaders("max-weights-transform"),s=new Bm(e,{id:"".concat(this.id,"-max-weights-transform"),_sourceTextures:{inTexture:i},_targetTexture:r,_targetTextureVarying:"outTexture",...l,elementCount:n*n});this.setState({weightsTexture:i,maxWeightsTexture:r,maxWeightTransform:s,zoom:null,triPositionBuffer:new $i(e,{byteLength:48,accessor:{size:3}}),triTexCoordBuffer:new $i(e,{byteLength:48,accessor:{size:2}})})}updateShaders(e){this._createWeightsTransform(e)}_updateMaxWeightValue(){const{maxWeightTransform:e}=this.state;e.run({parameters:{blend:!0,depthTest:!1,blendFunc:[1,1],blendEquation:32776}})}_updateBounds(e=!1){const{viewport:n}=this.context,i=[n.unproject([0,0]),n.unproject([n.width,0]),n.unproject([n.width,n.height]),n.unproject([0,n.height])].map(s=>s.map(Math.fround)),r=GRe(i),o={visibleWorldBounds:r,viewportCorners:i};let l=!1;if(e||!this.state.worldBounds||!HRe(this.state.worldBounds,r)){const s=this._worldToCommonBounds(r),d=this._commonToWorldBounds(s);this.props.coordinateSystem===Li.LNGLAT&&(d[1]=Math.max(d[1],-85.051129),d[3]=Math.min(d[3],85.051129),d[0]=Math.max(d[0],-360),d[2]=Math.min(d[2],360));const p=this._worldToCommonBounds(d);o.worldBounds=d,o.normalizedCommonBounds=p,l=!0}return this.setState(o),l}_updateTextureRenderingBounds(){const{triPositionBuffer:e,triTexCoordBuffer:n,normalizedCommonBounds:i,viewportCorners:r}=this.state,{viewport:o}=this.context;e.subData(q8(r,3));const l=r.map(s=>KRe(o.projectPosition(s),i));n.subData(q8(l,2))}_updateColorTexture(e){const{colorRange:n}=e.props;let{colorTexture:i}=this.state;const r=VRe(n,!1,Uint8Array);i?i.setImageData({data:r,width:n.length}):i=new ws(this.context.gl,{data:r,width:n.length,height:1,...WC}),this.setState({colorTexture:i})}_updateWeightmap(){const{radiusPixels:e,colorDomain:n,aggregation:i}=this.props,{weightsTransform:r,worldBounds:o,textureSize:l,weightsTexture:s,weightsScale:d}=this.state;this.state.isWeightMapDirty=!1;const p=this._worldToCommonBounds(o,{useLayerCoordinateSystem:!0});if(n&&i==="SUM"){const{viewport:v}=this.context,w=v.distanceScales.metersPerUnit[2]*(p[2]-p[0])/l;this.state.colorDomain=n.map(T=>T*w*d)}else this.state.colorDomain=n||Y8;const y={radiusPixels:e,commonBounds:p,textureWidth:l,weightsScale:d};r.update({elementCount:this.getNumInstances()}),Ga(this.context.gl,{clearColor:[0,0,0,0]},()=>{r.run({uniforms:y,parameters:{blend:!0,depthTest:!1,blendFunc:[1,1],blendEquation:32774},clearRenderTarget:!0,attributes:this.getAttributes(),moduleSettings:this.getModuleSettings()})}),this._updateMaxWeightValue(),s.setParameters({10240:9729,10241:9729})}_debouncedUpdateWeightmap(e=!1){let{updateTimer:n}=this.state;const{debounceTimeout:i}=this.props;e?(n=null,this._updateBounds(!0),this._updateTextureRenderingBounds(),this.setState({isWeightMapDirty:!0})):(this.setState({isWeightMapDirty:!1}),clearTimeout(n),n=setTimeout(this._debouncedUpdateWeightmap.bind(this,!0),i)),this.setState({updateTimer:n})}_worldToCommonBounds(e,n={}){const{useLayerCoordinateSystem:i=!1}=n,[r,o,l,s]=e,{viewport:d}=this.context,{textureSize:p}=this.state,{coordinateSystem:y}=this.props,v=i&&(y===Li.LNGLAT_OFFSETS||y===Li.METER_OFFSETS),w=v?d.projectPosition(this.props.coordinateOrigin):[0,0],T=p*tLe/d.scale;let I,L;return i&&!v?(I=this.projectPosition([r,o,0]),L=this.projectPosition([l,s,0])):(I=d.projectPosition([r,o,0]),L=d.projectPosition([l,s,0])),WRe([I[0]-w[0],I[1]-w[1],L[0]-w[0],L[1]-w[1]],T,T)}_commonToWorldBounds(e){const[n,i,r,o]=e,{viewport:l}=this.context,s=l.unprojectPosition([n,i]),d=l.unprojectPosition([r,o]);return s.slice(0,2).concat(d.slice(0,2))}}q(cE,"layerName","HeatmapLayer");q(cE,"defaultProps",iLe);class a$ extends cE{initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({})}draw(e){const{animationProgress:n=0,animationDuration:i=0}=this.props,r={...e.uniforms,animationProgress:n,animationDuration:i};super.draw({...e,uniforms:r})}}const aLe={};a$.defaultProps={...cE.defaultProps,...aLe};const lLe=6370972;function fx(t){return t/180*Math.PI}function Yl(t,e){const n=lLe,i=fx(t[1]),r=fx(t[0]),o=fx(e[1]),l=fx(e[0]),s=o-i,d=l-r,p=Math.sin(s/2)*Math.sin(s/2)+Math.cos(i)*Math.cos(o)*Math.sin(d/2)*Math.sin(d/2),y=2*Math.atan2(Math.sqrt(p),Math.sqrt(1-p));return n*y}function cLe(t,e){return(t%e+e)%e}function J8(t,e=void 0){let n=cLe(t+180,360)-180;return typeof e=="number"&&n<e&&(n+=360),n}function uLe(t){const e=t[2]-t[0]<360?J8(t[0]):-180,n=t[2]-t[0]<360?J8(t[2],e):180,i=Math.max(t[1],-85.051129),r=Math.min(t[3],85.051129);return[e,i,n,r]}function uE(t){return!!t.resolution}function l$(t){return uE(t)?[t.longitude,t.latitude]:null}function hLe(t){if(!uE(t))return null;const e=l$(t);return Math.max(Yl(e,t.unproject([t.width/2,0])),Yl(e,t.unproject([0,t.height/2])),...t.width>t.height?[Yl(e,t.unproject([t.width/2-t.height/4*1,t.height/2])),Yl(e,t.unproject([t.width/2-t.height/2*1,t.height/2])),Yl(e,t.unproject([t.width/2-t.height/4*3,t.height/2])),Yl(e,t.unproject([t.width/2-t.height,t.height/2]))]:[Yl(e,t.unproject([t.width/2,t.height/2-t.width/4*1])),Yl(e,t.unproject([t.width/2,t.height/2-t.width/2*1])),Yl(e,t.unproject([t.width/2,t.height/2-t.width/4*3])),Yl(e,t.unproject([t.width/2,t.height/2-t.width]))])}function dLe(t){return uE(t)?null:uLe(t.getBounds())}const fLe=`#version 300 es
#define SHADER_NAME particle-layer-update-transform-vertex-shader

precision highp float;

in vec3 sourcePosition;
out vec3 targetPosition;

uniform bool viewportGlobe;
uniform vec2 viewportGlobeCenter;
uniform float viewportGlobeRadius;
uniform vec4 viewportBounds;
uniform float viewportZoomChangeFactor;

uniform sampler2D bitmapTexture;
uniform vec2 imageUnscale;
uniform vec4 bounds;

uniform float numParticles;
uniform float maxAge;
uniform float speedFactor;

uniform float time;
uniform float seed;

uniform float animationProgress;

const vec2 DROP_POSITION = vec2(0);

bool isNaN(float value) {
  return !(value <= 0. || 0. <= value);
}

// see https://stackoverflow.com/a/27228836/1823988
float atan2(float y, float x) {
  return x == 0. ? sign(y) * PI / 2. : atan(y, x);
}

// see https://github.com/chrisveness/geodesy/blob/master/latlon-spherical.js#L187
float distanceTo(vec2 from, vec2 point) {
  float y1 = radians(from.y);
  float x1 = radians(from.x);
  float y2 = radians(point.y);
  float x2 = radians(point.x);
  float dy = y2 - y1;
  float dx = x2 - x1;

  float a = sin(dy / 2.) * sin(dy / 2.) + cos(y1) * cos(y2) * sin(dx / 2.) * sin(dx / 2.);
  float c = 2. * atan2(sqrt(a), sqrt(1. - a));
  float d = EARTH_RADIUS * c;

  return d;
}

// see https://github.com/chrisveness/geodesy/blob/master/latlon-spherical.js#L360
vec2 destinationPoint(vec2 from, float dist, float bearing) {
  float d = dist / EARTH_RADIUS;
  float r = radians(bearing);

  float y1 = radians(from.y);
  float x1 = radians(from.x);

  float siny2 = sin(y1) * cos(d) + cos(y1) * sin(d) * cos(r);
  float y2 = asin(siny2);
  float y = sin(r) * sin(d) * cos(y1);
  float x = cos(d) - sin(y1) * siny2;
  float x2 = x1 + atan2(y, x);

  float lat = degrees(y2);
  float lon = degrees(x2);

  return vec2(lon, lat);
}

// longitude wrapping allows rendering in a repeated MapView
float wrapLongitude(float lng) {
  float wrappedLng = mod(lng + 180., 360.) - 180.;
  return wrappedLng;
}

float wrapLongitude(float lng, float minLng) {
  float wrappedLng = wrapLongitude(lng);
  if (wrappedLng < minLng) {
    wrappedLng += 360.;
  }
  return wrappedLng;
}

float randFloat(vec2 seed) {
  return fract(sin(dot(seed.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

vec2 randPoint(vec2 seed) {
  return vec2(randFloat(seed + 1.3), randFloat(seed + 2.1));
}

vec2 pointToPosition(vec2 point) {
  if (viewportGlobe) {
    point.x += 0.0001; // prevent generating point in the center
    float dist = sqrt(point.x) * viewportGlobeRadius;
    float bearing = point.y * 360.;
    return destinationPoint(viewportGlobeCenter, dist, bearing);
  } else {
    vec2 viewportBoundsMin = viewportBounds.xy;
    vec2 viewportBoundsMax = viewportBounds.zw;
    return mix(viewportBoundsMin, viewportBoundsMax, point);
  }
}

bool isPositionInBounds(vec2 position, vec4 bounds) {
  vec2 boundsMin = bounds.xy;
  vec2 boundsMax = bounds.zw;
  float lng = wrapLongitude(position.x, boundsMin.x);
  float lat = position.y;
  return (
    boundsMin.x <= lng && lng <= boundsMax.x &&
    boundsMin.y <= lat && lat <= boundsMax.y
  );
}

bool isPositionInViewport(vec2 position) {
  if (viewportGlobe) {
    return distanceTo(viewportGlobeCenter, position) <= viewportGlobeRadius;
  } else {
    return isPositionInBounds(position, viewportBounds);
  }
}

// bitmapTexture is in COORDINATE_SYSTEM.LNGLAT
// no coordinate conversion needed
vec2 getUV(vec2 pos) {
  return vec2(
    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),
    (pos.y - bounds[3]) / (bounds[1] - bounds[3])
  );
}

bool raster_has_values(vec4 values) {
  if (imageUnscale[0] < imageUnscale[1]) {
    return values.a == 1.;
  } else {
    return !isNaN(values.x);
  }
}

vec2 raster_get_values(vec4 color) {
  if (imageUnscale[0] < imageUnscale[1]) {
    return mix(vec2(imageUnscale[0]), vec2(imageUnscale[1]), color.xy);
  } else {
    return color.xy;
  }
}

// src: https://webglfundamentals.org/webgl/lessons/webgl-qna-how-to-simulate-a-3d-texture-in-webgl.html
vec4 sampleAs3DTexture(sampler2D tex, vec3 texCoord, float size) {
    float sliceSize = 1.0 / size;                         // space of 1 slice
    float slicePixelSize = sliceSize / size;              // space of 1 pixel
    float sliceInnerSize = slicePixelSize * (size - 1.0); // space of size pixels
    float zSlice0 = min(floor(texCoord.z * size), size - 1.0);
    float zSlice1 = min(zSlice0 + 1.0, size - 1.0);
    float xOffset = slicePixelSize * 0.5 + texCoord.x * sliceInnerSize;
    float s0 = xOffset + (zSlice0 * sliceSize);
    float s1 = xOffset + (zSlice1 * sliceSize);
    vec4 slice0Color = texture2D(tex, vec2(s0, texCoord.y));
    vec4 slice1Color = texture2D(tex, vec2(s1, texCoord.y));
    float zOffset = mod(texCoord.z * size, 1.0);
    return mix(slice0Color, slice1Color, zOffset);
}

void main() {
  float particleIndex = mod(float(gl_VertexID), numParticles);
  float particleAge = floor(float(gl_VertexID) / numParticles);

  // update particles age0
  // older particles age1-age(N-1) are copied with buffer.copyData
  if (particleAge > 0.) {
    return;
  }

  if (sourcePosition.xy == DROP_POSITION) {
    // generate random position to prevent converging particles
    vec2 particleSeed = vec2(particleIndex * seed / numParticles);
    vec2 point = randPoint(particleSeed);
    vec2 position = pointToPosition(point);
    targetPosition.xy = position;
    targetPosition.x = wrapLongitude(targetPosition.x);
    return;
  }

  if (!isPositionInBounds(sourcePosition.xy, bounds)) {
    // drop out of bounds
    targetPosition.xy = DROP_POSITION;
    return;
  }

  if (!isPositionInViewport(sourcePosition.xy)) {
    // drop out of viewport
    targetPosition.xy = DROP_POSITION;
    return;
  }

  if (viewportZoomChangeFactor > 1. && mod(particleIndex, viewportZoomChangeFactor) >= 1.) {
    // drop when zooming out
    targetPosition.xy = DROP_POSITION;
    return;
  }

  if (abs(mod(particleIndex, maxAge + 2.) - mod(time, maxAge + 2.)) < 1.) {
    // drop by maxAge, +2 because only non-randomized pairs are rendered
    targetPosition.xy = DROP_POSITION;
    return;
  }

  vec2 uv = getUV(sourcePosition.xy);
  //vec4 bitmapColor = texture2D(bitmapTexture, uv);
  vec4 bitmapColor = sampleAs3DTexture(bitmapTexture, vec3(uv, animationProgress), 4.0);

  if (!raster_has_values(bitmapColor)) {
    // drop nodata
    targetPosition.xy = DROP_POSITION;
    return;
  }

  // update position
  vec2 speed = raster_get_values(bitmapColor) * speedFactor;
  //vec2 speed = vec2(animationProgress, animationProgress) * speedFactor * 100.;
  //vec2 speed = bitmapColor.xy * speedFactor;
  //vec2 speed = vec2(100., -100.);
  // float dist = sqrt(speed.x * speed.x + speed.y + speed.y) * 10000.;
  // float bearing = degrees(-atan2(speed.y, speed.x));
  // targetPosition.xy = destinationPoint(sourcePosition.xy, dist, bearing);
  float distortion = cos(radians(sourcePosition.y));
  //float distortion = 1.;
  vec2 offset = vec2(speed.x / distortion, speed.y);
  targetPosition.xy = sourcePosition.xy + offset;
  targetPosition.x = wrapLongitude(targetPosition.x);
}
`,pLe=30,mLe=[255,255,255,255],gLe={...Z2.defaultProps,image:{type:"image",value:null,async:!0},tempHumidityImage:{type:"image",value:null,async:!0},imageUnscale:{type:"array",value:null},numParticles:{type:"number",min:1,max:1e6,value:5e3},maxAge:{type:"number",min:1,max:255,value:100},speedFactor:{type:"number",min:0,max:1,value:1},animationProgress:{type:"number",min:0,max:1,value:0},color:{type:"color",value:mLe},colorSetting:{type:"number",min:0,max:2,value:0},width:{type:"number",value:1},animate:!0,bounds:{type:"array",value:[-180,-90,180,90],compare:!0},coolwarmReds:{type:"array",value:null},coolwarmGreens:{type:"array",value:null},coolwarmBlues:{type:"array",value:null},wrapLongitude:!0};class cR extends Z2{getShaders(){return{...super.getShaders(),inject:{"vs:#decl":`
          varying float drop;
          const vec2 DROP_POSITION = vec2(0);
          uniform sampler2D tempHumidityImage;
          uniform vec4 bounds;
          uniform float animationProgress;
          uniform float colorSetting;

          // For the coolwam color palette
          uniform float coolwarmReds[33];
          uniform float coolwarmGreens[33];
          uniform float coolwarmBlues[33];

          // src: https://webglfundamentals.org/webgl/lessons/webgl-qna-how-to-simulate-a-3d-texture-in-webgl.html
          vec4 sampleAs3DTexture(sampler2D tex, vec3 texCoord, float size) {
              float sliceSize = 1.0 / size;                         // space of 1 slice
              float slicePixelSize = sliceSize / size;              // space of 1 pixel
              float sliceInnerSize = slicePixelSize * (size - 1.0); // space of size pixels
              float zSlice0 = min(floor(texCoord.z * size), size - 1.0);
              float zSlice1 = min(zSlice0 + 1.0, size - 1.0);
              float xOffset = slicePixelSize * 0.5 + texCoord.x * sliceInnerSize;
              float s0 = xOffset + (zSlice0 * sliceSize);
              float s1 = xOffset + (zSlice1 * sliceSize);
              vec4 slice0Color = texture2D(tex, vec2(s0, texCoord.y));
              vec4 slice1Color = texture2D(tex, vec2(s1, texCoord.y));
              float zOffset = mod(texCoord.z * size, 1.0);
              return mix(slice0Color, slice1Color, zOffset);
          }

           vec2 getUV(vec2 pos) {
             return vec2(
               (pos.x - bounds[0]) / (bounds[2] - bounds[0]),
               (pos.y - bounds[3]) / (bounds[1] - bounds[3])
             );
           }
           vec3 hsl2rgb(vec3 c){
               vec3 rgb = clamp( abs(mod(c.x*6.0+vec3(0.0,4.0,2.0),6.0)-3.0)-1.0, 0.0, 1.0  );
               return c.z + c.y * (rgb-0.5)*(1.0-abs(2.0*c.z-1.0));
           }
           vec3 coolwarm(float t) {
               float index = floor( t / ( 1.0 / 32.0 ) );
               float index2 = min(index + 1.0, 32.0);
               return mix(
                    vec3(coolwarmReds[int(index)], coolwarmGreens[int(index)], coolwarmBlues[int(index)]),
                    vec3(coolwarmReds[int(index2)], coolwarmGreens[int(index2)], coolwarmBlues[int(index2)]),
                    t - (index * (1.0 / 32.0)));
           }
        `,"vs:#main-start":`


          drop = float(instanceSourcePositions.xy == DROP_POSITION || instanceTargetPositions.xy == DROP_POSITION);
        `,"vs:#main-end":`
          vec2 uv = getUV(instanceTargetPositions.xy);
          vec4 tempHumidity = sampleAs3DTexture(tempHumidityImage, vec3(uv, animationProgress), 4.0);

          // vec3 hsl = vec3(0.0, 1.0, -tempHumidity.r/2.0+1.0);
          // vColor = vec4(hsl2rgb(hsl), instanceColors.a * opacity);
          if (colorSetting == 1.0) {
            vColor = vec4(coolwarm(tempHumidity.r), instanceColors.a * opacity);
          }
          if (colorSetting == 2.0) {
            vColor = vec4(coolwarm(tempHumidity.g), instanceColors.a * opacity);
          }
                `,"fs:#decl":`
          varying float drop;
        `,"fs:#main-start":`
          if (drop > 0.5) discard;
        `}}}initializeState(){const{gl:e}=this.context;if(!bi(e))throw new Error("WebGL 2 is required");super.initializeState({}),this._setupTransformFeedback(),this.getAttributeManager().remove(["instanceSourcePositions","instanceTargetPositions","instanceColors","instanceWidths"])}updateState({props:e,oldProps:n,changeFlags:i}){const{numParticles:r,maxAge:o,color:l,width:s}=e;if(super.updateState({props:e,oldProps:n,changeFlags:i}),!r||!o||!s){this._deleteTransformFeedback();return}(r!==n.numParticles||o!==n.maxAge||l[0]!==n.color[0]||l[1]!==n.color[1]||l[2]!==n.color[2]||l[3]!==n.color[3]||s!==n.width)&&this._setupTransformFeedback()}finalizeState(){this._deleteTransformFeedback(),super.finalizeState()}draw({uniforms:e}){const{gl:n}=this.context;if(!bi(n))return;const{initialized:i}=this.state;if(!i)return;const{animate:r,tempHumidityImage:o,bounds:l,animationProgress:s,coolwarmReds:d,coolwarmGreens:p,coolwarmBlues:y,colorSetting:v}=this.props,{sourcePositions:w,targetPositions:T,sourcePositions64Low:I,targetPositions64Low:L,colors:k,widths:F,model:B}=this.state;B.setAttributes({instanceSourcePositions:w,instanceTargetPositions:T,instanceSourcePositions64Low:I,instanceTargetPositions64Low:L,instanceColors:k,instanceWidths:F}),e={...e,tempHumidityImage:o,bounds:l,animationProgress:s,coolwarmReds:d,coolwarmGreens:p,coolwarmBlues:y,colorSetting:v},super.draw({uniforms:e}),r&&this.requestStep()}_setupTransformFeedback(){const{gl:e}=this.context;if(!bi(e))return;const{initialized:n}=this.state;n&&this._deleteTransformFeedback();const{numParticles:i,maxAge:r,color:o,width:l}=this.props,s=i*r,d=i*(r-1),p=new $i(e,new Float32Array(s*3)),y=new $i(e,new Float32Array(s*3)),v=new Float32Array([0,0,0]),w=new Float32Array([0,0,0]),T=new $i(e,new Float32Array(new Array(s).fill(void 0).map((k,F)=>{const B=Math.floor(F/i);return[o[0],o[1],o[2],(o[3]??255)*(1-B/r)].map(G=>G/255)}).flat())),I=new Float32Array([l]);new $i(e,4);const L=new Bm(e,{sourceBuffers:{sourcePosition:p},feedbackBuffers:{targetPosition:y},feedbackMap:{sourcePosition:"targetPosition"},vs:fLe,elementCount:i});this.setState({initialized:!0,numInstances:s,numAgedInstances:d,sourcePositions:p,targetPositions:y,sourcePositions64Low:v,targetPositions64Low:w,colors:T,widths:I,transform:L})}_runTransformFeedback(){const{gl:e}=this.context;if(!bi(e))return;const{initialized:n}=this.state;if(!n)return;const{viewport:i,timeline:r}=this.context,{image:o,imageUnscale:l,bounds:s,numParticles:d,speedFactor:p,maxAge:y,animationProgress:v}=this.props,{numAgedInstances:w,transform:T,previousViewportZoom:I,previousTime:L}=this.state,k=r.getTime();if(!o||k===L)return;b_(o);const F=uE(i),B=l$(i),G=hLe(i),U=dLe(i),ee=2**((I-i.zoom)*4),ne=p/2**(i.zoom+7),ye={viewportGlobe:F,viewportGlobeCenter:B||[0,0],viewportGlobeRadius:G||0,viewportBounds:U||[0,0,0,0],viewportZoomChangeFactor:ee||0,bitmapTexture:o,imageUnscale:l||[0,0],bounds:s,numParticles:d,maxAge:y,speedFactor:ne,time:k,seed:Math.random()};T.run({uniforms:ye});const fe=T.bufferTransform.bindings[T.bufferTransform.currentIndex].sourceBuffers.sourcePosition,J=T.bufferTransform.bindings[T.bufferTransform.currentIndex].feedbackBuffers.targetPosition;fe.copyData({sourceBuffer:J,readOffset:0,writeOffset:d*4*3,size:w*4*3}),T.swap(),this.state.previousViewportZoom=i.zoom,this.state.previousTime=k}_resetTransformFeedback(){const{gl:e}=this.context;if(!bi(e))return;const{initialized:n}=this.state;if(!n)return;const{numInstances:i,sourcePositions:r,targetPositions:o}=this.state;r.subData({data:new Float32Array(i*3)}),o.subData({data:new Float32Array(i*3)})}_deleteTransformFeedback(){const{gl:e}=this.context;if(!bi(e))return;const{initialized:n}=this.state;if(!n)return;const{sourcePositions:i,targetPositions:r,colors:o,transform:l}=this.state;i.delete(),r.delete(),o.delete(),l.delete(),this.setState({initialized:!1,sourcePositions:void 0,targetPositions:void 0,sourcePositions64Low:void 0,targetPositions64Low:void 0,colors:void 0,widths:void 0,transform:void 0})}requestStep(){const{stepRequested:e}=this.state;e||(this.state.stepRequested=!0,setTimeout(()=>{this.step(),this.state.stepRequested=!1},1e3/pLe))}step(){this._runTransformFeedback(),this.setNeedsRedraw()}clear(){this._resetTransformFeedback(),this.setNeedsRedraw()}}cR.layerName="ParticleLayer";cR.defaultProps=gLe;class yLe{constructor(e,n,i){this.overviewStore=jAe(),this.useMapStore=Xa(),this.useDataStore=Rs(),this.perimeterData=this.useDataStore.getPerimeterData(e.fireID),this.attrs=s_(),this.mapParams=e,this.editorParams=n;let r=new FRe(e.fireID);this.animatedProps=r.getAnimatedProps(),this.staticLayers=this.getAllStaticLayers(i)}getAllStaticLayers(e){let n=[];return e.forEach(i=>{if(i.type=="TileLayer"){let r=new LPe(i.parameters.url,this.attrs,i.name);n.push(r.create(!0))}else if(i.type=="GeoJSON"){let r=new BRe(i.parameters.url,this.attrs,i.name,this.overviewStore.getOverviewClusters);n.push(r.create(!0,this.mapParams.fireID))}else i.type=="Wind"}),n}getCurrentStaticLayers(e){e.forEach(n=>{this.staticLayers=this.staticLayers.map(i=>n.name==i.id&&n.visibility?i.clone({visible:!0}):n.name==i.id&&!n.visibility?i.clone({visible:!1}):i)})}getAllLayerProps(e,n,i,r,o,l,s){this.getCurrentStaticLayers(e);let d=[];e.forEach(w=>{w.animated&&w.visibility&&d.push(w.name)});let p=Object.entries(this.animatedProps).filter(([w,T])=>w.startsWith("Animated")?d.includes(T.id.split("_")[0]):!0),y=Object.fromEntries(p);return Object.entries(y).map(([w,T])=>{if(w=="AnimatedPath")return new lR({...T,animationProgress:n,getPath:I=>I.path,updateTriggers:{getPath:i.Perimeter_Smooth}});if(w=="AnimatedGridCell")return new r$({...T,animationProgress:n});if(w=="AnimatedHeatmap")return new a$(T);if(w=="AnimatedTextIcons")return new Q2(T);if(w.startsWith("Icons")){if(r=="Viewing")return new Gh({...T,visible:n>=T.time,sizeScale:T.highlighted?8:4,updateTriggers:{iconAtlas:o.value,sizeScale:T.highlighted}});if(r=="Editing")return new j3({...T,sizeScale:T.highlighted?8:4,onDragStart:(I,L)=>{s.setProps({controller:{dragPan:!1}}),l.value=!0},onDrag:(I,L)=>{this.updateAnnotationLocation(I)},onDragEnd:(I,L)=>{s.setProps({controller:!0}),l.value=!1},visible:n>=T.time,updateTriggers:{getPosition:l.value,sizeScale:T.highlighted}});throw"Unrecognized mapMode in getAllLayerProps"}else{if(w=="AnimatedWind")return console.log("AnimatedWind",T),new cR({...T,animationProgress:n,updateTriggers:{colorSetting:i.Wind_Particle_Colors}});throw"Error in animate"}}).concat(this.staticLayers)}getInitialViewState(){return{longitude:this.perimeterData[0].centroid[0],latitude:this.perimeterData[0].centroid[1],zoom:11,pitch:0,bearing:0}}getTimeScales(){let e=Qd().domain([0,1]).range([this.animatedProps.AnimatedPath.data[0].time,this.animatedProps.AnimatedPath.data[this.animatedProps.AnimatedPath.data.length-1].time]),n=Qd().range([0,1]).domain([this.animatedProps.AnimatedPath.data[0].time,this.animatedProps.AnimatedPath.data[this.animatedProps.AnimatedPath.data.length-1].time]);return[e,n]}buildSettings(){return{}}handleSettings(e,n,i,r){return e.Wind_Arrows==!1&&(n=n.map(o=>o.id=="Wind_Arrows"?o.clone({visible:!1}):o)),e.Wind_Particle==!1&&(n=n.map(o=>o.id=="Wind_Particle"?o.clone({visible:!1}):o)),e.Perimeter_Smooth==!0&&(n=n.map(o=>o.id=="Perimeter"?o.clone({getPath:l=>l.smoothed_path}):o)),e.Wind_Particle_Colors=="No Color"&&(n=n.map(o=>o.id=="Wind_Particle"?o.clone({colorSetting:0}):o)),e.Wind_Particle_Colors=="Temperature"&&(n=n.map(o=>o.id=="Wind_Particle"?o.clone({colorSetting:1}):o)),e.Wind_Particle_Colors=="Humidity"&&(n=n.map(o=>o.id=="Wind_Particle"?o.clone({colorSetting:2}):o)),i.value==!0&&(n=n.map(o=>o.id==r.value.id.toString()?o.clone({iconAtlas:"https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/icon-atlas.png"}):o)),n}updateAnnotationLocation(e){const n=this.useMapStore.deckGLMapState.findIndex(l=>l._metaData.id==this.mapParams.mapID&&l._metaData.active);let i=this.useMapStore.deckGLMapState[n]._data,r=e.layer.props.annotationID,o=this.useEditorStore.currentPresentation[this.editorParams.slideID];o.annotations?this.useEditorStore.currentPresentation[this.editorParams.slideID].annotations.find(l=>l.id==r).location=e.coordinate:(this.mapParams.mapID==o.LeftMapParams.mapID&&(this.useEditorStore.currentPresentation[this.editorParams.slideID].annotations_left.find(l=>l.id==r).location=e.coordinate),this.mapParams.mapID==o.RightMapParams.mapID&&(this.useEditorStore.currentPresentation[this.editorParams.slideID].annotations_right.find(l=>l.id==r).location=e.coordinate)),i.annotations.find(l=>l.id==r).location=e.coordinate}setupSettings(){const e=u8;e.forEach(n=>{"options"in n&&n.options.forEach(i=>{e[i.emitVal]=i.default})})}getTimeSliderScaleParams(){return[Qd().domain([this.animatedProps.AnimatedPath.data[0].time,this.animatedProps.AnimatedPath.data[this.animatedProps.AnimatedPath.data.length-1].time]),R_.every(1),"%b %d"]}formatTimeString(e){return`${e.toLocaleString("default",{month:"short"})} ${e.getDate()} ${e.getHours()}:00`}getInfoPanelSettings(){return u8}}const vLe={id:"singleFireTemplate-container",class:"singleFireTemplate-container"},_Le=pr({__name:"SingleFirePage",props:{mapParams:{type:Object,default(){return{mapType:"single-fire",mapID:"0",annotations:[]}}},preselected:{type:String,default:""}},setup(t){const e=$n(!0);Os(ng,e),Os(U2,"Viewing"),Os(V2,yLe);const n=()=>{e.value=!e.value},i=Ea();i.fetchFireList();const r=Wd.mapIdentifier.Single,o=ur(()=>i.validFire[r]);return(l,s)=>(le(),Ue("div",vLe,[Lt(Yt(mm),{style:{height:"100%"},onResizeend:n},{default:Cn(()=>[Lt(Yt(gl),{size:15},{default:Cn(()=>[Lt(UAe,{mapParams:t.mapParams,templateID:Yt(r),preselected:t.preselected},null,8,["mapParams","templateID","preselected"])]),_:1}),Lt(Yt(gl),null,{default:Cn(()=>[o.value?(le(),Rt(rEe,{key:0,mapType:t.mapParams.mapType,mapID:t.mapParams.mapID,templateID:Yt(r),annotations:t.mapParams.annotations},null,8,["mapType","mapID","templateID","annotations"])):(le(),Rt(q2e,{key:1}))]),_:1})]),_:1})]))}});const bLe=po(_Le,[["__scopeId","data-v-4378942d"]]),xLe={class:"singleWaterTemplate-container"},wLe=pr({__name:"SingleWaterPage",props:{mapParams:{type:Object,default(){return{mapType:"single-water",mapID:"0",annotations:[]}}},preselected:{type:String,default:""}},setup(t){const e=Wd.mapIdentifier.Single,n=$n(!1),i=$n(!0);$n(["1/1/1925","8/22/1933","1/1/1965","1/1/1990","1/1/2010","1/1/2020"]),Os(ng,i),Os(V2,RV),Os(U2,"Viewing");const r=()=>{i.value=!i.value};return $n([{label:"Temporal SM",icon:"pi pi-fw pi-exclamation-triangle",command:()=>{n.value=!n.value,Ys(()=>{i.value=!i.value}),console.log("Temporal SM")}}]),(o,l)=>(le(),Ue("div",xLe,[fo(Lt(Yt(mm),{style:{height:"100%"},onResizeend:r},{default:Cn(()=>[Lt(Yt(gl),{size:15},{default:Cn(()=>[Lt(jP,{mapParams:t.mapParams,templateID:Yt(e),preselected:t.preselected},null,8,["mapParams","templateID","preselected"])]),_:1}),Lt(Yt(gl),null,{default:Cn(()=>[Lt(FP,{mapType:t.mapParams.mapType,mapID:t.mapParams.mapID,annotations:t.mapParams.annotations,SM:!1},null,8,["mapType","mapID","annotations"])]),_:1})]),_:1},512),[[l_,!n.value]])]))}});const ELe=po(wLe,[["__scopeId","data-v-3aa47ddf"]]),TLe=[{path:"/",name:"Home",component:eee},{path:"/singlefire",name:"SingleFire",component:bLe},{path:"/water",component:ELe},{path:"/watercomparison",component:$2e}],uR=WQ({history:lQ({}.BASE_URL),routes:TLe}),SLe={id:"innerApp"},CLe=Qe("i",{class:"pi pi-fw pi-home"},null,-1),ALe=pr({__name:"App",setup(t){const e=()=>{uR.push("/")};return(n,i)=>{const r=Gn("router-view");return le(),Ue("div",SLe,[Lt(r),Qe("div",{onClick:e,class:"fixed text-xl bottom-4 left-4 bg-transparent text-black hover:bg-gray-600 hover:text-white p-4 rounded-full cursor-pointer transition-all duration-300"},[vo(" Go Home "),CLe])])}}});var px=nN(),PLe=Symbol(),ILe={install:function(e){var n={add:function(r){px.emit("add",r)},remove:function(r){px.emit("remove",r)},removeGroup:function(r){px.emit("remove-group",r)},removeAllGroups:function(){px.emit("remove-all-groups")}};e.config.globalProperties.$toast=n,e.provide(PLe,n)}},MLe={prefix:"fas",iconName:"info",icon:[192,512,[],"f129","M48 80a48 48 0 1 1 96 0A48 48 0 1 1 48 80zM0 224c0-17.7 14.3-32 32-32H96c17.7 0 32 14.3 32 32V448h32c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H64V256H32c-17.7 0-32-14.3-32-32z"]},RLe={prefix:"fas",iconName:"circle-info",icon:[512,512,["info-circle"],"f05a","M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM216 336h24V272H216c-13.3 0-24-10.7-24-24s10.7-24 24-24h48c13.3 0 24 10.7 24 24v88h8c13.3 0 24 10.7 24 24s-10.7 24-24 24H216c-13.3 0-24-10.7-24-24s10.7-24 24-24zm40-208a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"]};OJ.add(RLe,MLe);const LLe=zX(),Hh=Oz(ALe);Hh.use(LLe);Hh.use(bx,ps);Hh.use(wq);Hh.use(uR);Hh.use(ILe);Hh.component("FontAwesomeIcon",GJ);Hh.directive("tooltip",eY);Hh.mount("#app");
